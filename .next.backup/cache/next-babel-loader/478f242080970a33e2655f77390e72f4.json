{"ast":null,"code":"function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}/*!\n * Doka Image Editor 7.8.0\n * (c) 2018-2021 PQINA Inc. - All Rights Reserved\n * License: https://pqina.nl/doka/license/\n */ /* eslint-disable */const backup='__doka_webapi__';var getNativeAPIRef=API=>window[backup]?window[backup][API]:window[API];var createProgressEvent=(loaded,lengthComputable=true)=>{// assigning 0 to 1 somehow doesn't work\nconst type='progress';const data={loaded:loaded*100,total:100,lengthComputable};try{return new(getNativeAPIRef('ProgressEvent'))(type,data);}catch(err){// IE11\nreturn _objectSpread({type},data);}};var noop=(...args)=>{};const FileReaderDataFormat={ArrayBuffer:'readAsArrayBuffer'};var readFile=(file,onprogress=noop,options={})=>new Promise((resolve,reject)=>{const{dataFormat=FileReaderDataFormat.ArrayBuffer}=options;const reader=new(getNativeAPIRef('FileReader'))();reader.onload=()=>resolve(reader.result);reader.onerror=reject;reader.onprogress=onprogress;reader[dataFormat](file);});const readExifOrientation=(view,offset)=>{// Missing 0x45786966 Marker? No Exif Header, stop here\nif(view.getUint32(offset+=2,false)!==0x45786966)return-1;// First 2bytes defines byte align of TIFF data.\n// If it is 0x4949=\"I I\", it means \"Intel\" type byte align\nconst intelByteAligned=view.getUint16(offset+=6,false)===0x4949;offset+=view.getUint32(offset+4,intelByteAligned);const tags=view.getUint16(offset,intelByteAligned);offset+=2;// find Orientation tag\nfor(let i=0;i<tags;i++){if(view.getUint16(offset+i*12,intelByteAligned)===0x0112)return view.getUint16(offset+i*12+8,intelByteAligned);}};const readData=data=>{const view=new DataView(data);// Every JPEG file starts from binary value '0xFFD8', so if it's not present, exit here\nif(view.getUint16(0,false)!=0xffd8)return null;const length=view.byteLength;let offset=2;let marker;while(offset<length){if(view.getUint16(offset+2,false)<=8)return-1;marker=view.getUint16(offset,false);offset+=2;// Exif Marker found\nif(marker===0xffe1)return readExifOrientation(view,offset);// Invalid marker, exit here\nelse if((marker&0xff00)!==0xff00)return null;// Next!\nelse offset+=view.getUint16(offset,false);}};var getImageOrientationFromFile=async(file,onprogress=noop)=>{onprogress(createProgressEvent(0));const result=await readFile(file.slice(0,256*1024));return readData(result)||1;};let result=null;var isBrowser=()=>{if(result===null)result=false&&typeof window.document!=='undefined';return result;};let result$1=null;var canOrientImages=()=>new Promise(resolve=>{if(result$1===null){// 2x1 pixel image 90CW rotated with orientation EXIF header\nconst testSrc='data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=';let testImage=isBrowser()?new Image():{};testImage.onload=()=>{// should correct orientation if is presented in landscape,\n// in which case the browser doesn't autocorrect\nresult$1=testImage.naturalWidth===1;testImage=undefined;resolve(result$1);};testImage.src=testSrc;return;}return resolve(result$1);});var canvasToImageData=canvas=>{const imageData=canvas.getContext('2d').getImageData(0,0,canvas.width,canvas.height);return imageData;};var h=(name,attributes,children=[])=>{const el=document.createElement(name);// @ts-ignore\nconst descriptors=Object.getOwnPropertyDescriptors(el.__proto__);for(const key in attributes){if(key==='style'){el.style.cssText=attributes[key];}else if(descriptors[key]&&descriptors[key].set||/textContent|innerHTML/.test(key)||typeof attributes[key]==='function'){el[key]=attributes[key];}else{el.setAttribute(key,attributes[key]);}}children.forEach(child=>el.appendChild(child));return el;};const MATRICES={1:()=>[1,0,0,1,0,0],2:width=>[-1,0,0,1,width,0],3:(width,height)=>[-1,0,0,-1,width,height],4:(width,height)=>[1,0,0,-1,0,height],5:()=>[0,1,1,0,0,0],6:(width,height)=>[0,1,-1,0,height,0],7:(width,height)=>[0,-1,-1,0,height,width],8:width=>[0,-1,1,0,0,width]};var getImageOrientationMatrix=(width,height,orientation=-1)=>{if(orientation===-1)orientation=1;return MATRICES[orientation](width,height);};var releaseCanvas=canvas=>{canvas.width=1;canvas.height=1;const ctx=canvas.getContext('2d');ctx&&ctx.clearRect(0,0,1,1);};var isImageData=obj=>'data'in obj;var imageDataToCanvas=async(imageData,orientation=1)=>{const[width,height]=(await canOrientImages())||orientation<5?[imageData.width,imageData.height]:[imageData.height,imageData.width];const canvas=h('canvas',{width,height});const ctx=canvas.getContext('2d');// transform image data ojects into in memory canvas elements so we can transform them (putImageData isn't affect by transforms)\nif(isImageData(imageData)&&!(await canOrientImages())&&orientation>1){const inMemoryCanvas=h('canvas',imageData);const ctx=inMemoryCanvas.getContext('2d');ctx.putImageData(imageData,0,0);imageData=inMemoryCanvas;}// get base transformation matrix\nif(!(await canOrientImages())&&orientation>1){ctx.transform.apply(ctx,getImageOrientationMatrix(imageData.width,imageData.height,orientation));}// can't test for instanceof ImageBitmap as Safari doesn't support it\n// if still imageData object by this point, we'll use put\nif(isImageData(imageData)){ctx.putImageData(imageData,0,0);}else{ctx.drawImage(imageData,0,0);}// if image data is of type canvas, clean it up\nif(imageData instanceof HTMLCanvasElement)releaseCanvas(imageData);return canvas;};var orientImageData=async(imageData,orientation=1)=>{if(orientation===1)return imageData;// correct image data for when the browser does not correctly read exif orientation headers\nif(!(await canOrientImages()))return canvasToImageData(await imageDataToCanvas(imageData,orientation));return imageData;};var imageToCanvas=(image,canvasMemoryLimit)=>{// if these are 0 it's possible that we're trying to convert an SVG that doesn't have width or height attributes\n// https://bugzilla.mozilla.org/show_bug.cgi?id=1328124\nlet canvasWidth=image.naturalWidth;let canvasHeight=image.naturalHeight;// determine if requires more memory than limit, if so limit target size\nconst requiredCanvasMemory=canvasWidth*canvasHeight;if(canvasMemoryLimit&&requiredCanvasMemory>canvasMemoryLimit){const canvasScalar=Math.sqrt(canvasMemoryLimit)/Math.sqrt(requiredCanvasMemory);canvasWidth=Math.floor(canvasWidth*canvasScalar);canvasHeight=Math.floor(canvasHeight*canvasScalar);}// create new canvas element\nconst canvas=h('canvas');canvas.width=canvasWidth;canvas.height=canvasHeight;const ctx=canvas.getContext('2d');ctx.drawImage(image,0,0,canvasWidth,canvasHeight);return canvas;};// turns image into canvas only after it's fully loaded\nvar imageToCanvasSafe=(image,canvasMemoryLimit)=>new Promise((resolve,reject)=>{const ready=()=>resolve(imageToCanvas(image,canvasMemoryLimit));if(image.complete&&image.width){// need to test for image.width, on ie11 it will be 0 for object urls\nready();}else{image.onload=ready;image.onerror=reject;}});var blobToCanvas=async(imageBlob,canvasMemoryLimit)=>{const imageElement=h('img',{src:URL.createObjectURL(imageBlob)});const canvas=await imageToCanvasSafe(imageElement,canvasMemoryLimit);URL.revokeObjectURL(imageElement.src);return canvas;};var canCreateImageBitmap=()=>'createImageBitmap'in window;var canCreateOffscreenCanvas=()=>'OffscreenCanvas'in window;var isSVGFile=blob=>/svg/.test(blob.type);var getUniqueId=()=>Math.random().toString(36).substr(2,9);var functionToBlob=fn=>new Blob(['(',typeof fn==='function'?fn.toString():fn,')()'],{type:'application/javascript'});const wrapFunction=fn=>`function () {self.onmessage = function (message) {(${fn.toString()}).apply(null, message.data.content.concat([function (err, response) {\n    response = response || {};\n    const transfer = 'data' in response ? [response.data.buffer] : 'width' in response ? [response] : [];\n    return self.postMessage({ id: message.data.id, content: response, error: err }, transfer);\n}]))}}`;const workerPool=new Map();var thread=(fn,args,transferList)=>new Promise((resolve,reject)=>{let workerKey=fn.toString();let pooledWorker=workerPool.get(workerKey);if(!pooledWorker){// create worker for this function\nconst workerFn=wrapFunction(fn);// create a new web worker\nconst url=URL.createObjectURL(functionToBlob(workerFn));const messages=new Map();const worker=new Worker(url);// create a pooled worker, this object will contain the worker and active messages\npooledWorker={url,worker,messages,terminate:()=>{pooledWorker.worker.terminate();URL.revokeObjectURL(url);}};// handle received messages\nworker.onmessage=function(e){// should receive message id and message\nconst{id,content,error}=e.data;// message route no longer valid\nif(!messages.has(id))return;// get related thread and resolve with returned content\nconst message=messages.get(id);// remove thread from threads cache\nmessages.delete(id);// resolve or reject message based on response from worker\nerror!=null?message.reject(error):message.resolve(content);};// pool this worker\nworkerPool.set(workerKey,pooledWorker);}// we need a way to remember this message so we generate a unique id and use that as a key for this request, that way we can link the response back to request in the pooledWorker.onmessage handler\nconst messageId=getUniqueId();pooledWorker.messages.set(messageId,{resolve,reject});// use pooled worker and await response\npooledWorker.worker.postMessage({id:messageId,content:args},transferList);});var blobToImageData=async(imageBlob,canvasMemoryLimit)=>{let imageData;// if can use OffscreenCanvas let's go for it as it will mean we can run this operation on a separate thread\nif(canCreateImageBitmap()&&!isSVGFile(imageBlob)&&canCreateOffscreenCanvas()){try{imageData=await thread((file,canvasMemoryLimit,done)=>{createImageBitmap(file).then(bitmap=>{let canvasWidth=bitmap.width;let canvasHeight=bitmap.height;// determine if requires more memory than limit, if so limit target size\nconst requiredCanvasMemory=canvasWidth*canvasHeight;if(canvasMemoryLimit&&requiredCanvasMemory>canvasMemoryLimit){const canvasScalar=Math.sqrt(canvasMemoryLimit)/Math.sqrt(requiredCanvasMemory);canvasWidth=Math.floor(canvasWidth*canvasScalar);canvasHeight=Math.floor(canvasHeight*canvasScalar);}const canvas=new OffscreenCanvas(canvasWidth,canvasHeight);const ctx=canvas.getContext('2d');ctx.drawImage(bitmap,0,0);const imageData=ctx.getImageData(0,0,canvas.width,canvas.height);done(null,imageData);}).catch(err=>{// fail silently\ndone(err);});},[imageBlob,canvasMemoryLimit]);}catch(err){// fails silently on purpose, we'll try to turn the blob into image data in the main thread\n// console.error(err);\n}}// use main thread to generate ImageData\nif(!imageData||!imageData.width){const canvas=await blobToCanvas(imageBlob,canvasMemoryLimit);imageData=canvasToImageData(canvas);releaseCanvas(canvas);}return imageData;};var canvasToBlob=(canvas,mimeType=undefined,quality=undefined)=>new Promise((resolve,reject)=>{try{canvas.toBlob(blob=>{resolve(blob);},mimeType,quality);}catch(err){reject(err);}});var imageDataToBlob=async(imageData,mimeType,quality)=>{try{const canvas=await imageDataToCanvas(imageData);const blob=await canvasToBlob(canvas,mimeType,quality);releaseCanvas(canvas);return blob;}catch(err){throw err;}};var blobReadSection=async(blob,slice=[0,blob.size],onprogress)=>await readFile(blob.slice(...slice),onprogress);var blobWriteSection=(blob,section,slice=[0,blob.size])=>{if(!section)return blob;return new Blob([section,blob.slice(...slice)],{type:blob.type});};var getExtensionFromMimeType=mimeType=>mimeType.match(/\\/([a-z]+)/)[1];var getFilenameWithoutExtension=name=>name.substr(0,name.lastIndexOf('.'))||name;var getExtensionFromFilename=filename=>filename.split('.').pop();const ImageExtensionsRegex=/avif|bmp|gif|jpg|jpeg|jpe|jif|jfif|png|svg|tiff|webp/;/*\nSupport image mime types\n- image/webp\n- image/gif\n- image/avif\n- image/jpeg\n- image/png\n- image/bmp\n- image/svg+xml\n*/var getMimeTypeFromExtension=ext=>{// empty string returned if extension not found\nif(!ImageExtensionsRegex.test(ext))return'';// return MimeType for this extension\nreturn'image/'+(/jfif|jif|jpe|jpg/.test(ext)?'jpeg':ext==='svg'?'svg+xml':ext);};var getMimeTypeFromFilename=name=>name&&getMimeTypeFromExtension(getExtensionFromFilename(name).toLowerCase());var matchFilenameToMimeType=(filename,mimeType)=>{// get the mime type that matches this extension\nconst fileMimeType=getMimeTypeFromFilename(filename);// test if type already matches current mime type, no need to change name\nif(fileMimeType===mimeType)return filename;// get the extension for this mimetype (gets all characters after the \"image/\" part)\nconst targetMimeTypeExtension=getExtensionFromMimeType(mimeType);return`${getFilenameWithoutExtension(filename)}.${targetMimeTypeExtension}`;};var blobToFile=(blob,filename,mimetype)=>{const lastModified=new Date().getTime();const blobHasMimeType=blob.type.length&&blob.type!=='null';const blobMimeType=blobHasMimeType?blob.type:mimetype;const name=matchFilenameToMimeType(filename,blobMimeType);try{return new(getNativeAPIRef('File'))([blob],name,{lastModified,type:blobHasMimeType?blob.type:blobMimeType});}catch(err){const file=blobHasMimeType?blob.slice():blob.slice(0,blob.size,blobMimeType);file.lastModified=lastModified;file.name=name;return file;}};var getAspectRatio=(w,h)=>w/h;var passthrough=v=>v;const PI=Math.PI;const HALF_PI=Math.PI/2;const QUART_PI=HALF_PI/2;var isRotatedSideways=a=>{const rotationLimited=Math.abs(a)%Math.PI;return rotationLimited>QUART_PI&&rotationLimited<Math.PI-QUART_PI;};//\n// generic\n//\nconst scale=(value,scalar,pivot)=>pivot+(value-pivot)*scalar;const ellipseCreateFromRect=rect=>({x:rect.x+rect.width*0.5,y:rect.y+rect.height*0.5,rx:rect.width*0.5,ry:rect.height*0.5});//\n// vector\n//\nconst vectorCreateEmpty=()=>vectorCreate(0,0);const vectorCreate=(x,y)=>({x,y});const vectorCreateFromSize=size=>vectorCreate(size.width,size.height);const vectorCreateFromPointerEvent=e=>vectorCreate(e.pageX,e.pageY);const vectorCreateFromPointerEventOffset=e=>vectorCreate(e.offsetX,e.offsetY);const vectorClone=v=>vectorCreate(v.x,v.y);const vectorInvert=v=>{v.x=-v.x;v.y=-v.y;return v;};const vectorPerpendicular=v=>{const x=v.x;v.x=-v.y;v.y=x;return v;};const vectorRotate=(v,radians,pivot=vectorCreateEmpty())=>{const cos=Math.cos(radians);const sin=Math.sin(radians);const tx=v.x-pivot.x;const ty=v.y-pivot.y;v.x=pivot.x+cos*tx-sin*ty;v.y=pivot.y+sin*tx+cos*ty;return v;};const vectorLength=v=>Math.sqrt(v.x*v.x+v.y*v.y);const vectorNormalize=v=>{const length=Math.sqrt(v.x*v.x+v.y*v.y);if(length===0)return vectorCreateEmpty();v.x/=length;v.y/=length;return v;};const vectorAngle=v=>Math.atan2(v.y,v.x);const vectorAngleBetween=(a,b)=>Math.atan2(b.y-a.y,b.x-a.x);const vectorEqual=(a,b)=>a.x===b.x&&a.y===b.y;const vectorApply=(v,fn)=>{v.x=fn(v.x);v.y=fn(v.y);return v;};const vectorAdd=(a,b)=>{a.x+=b.x;a.y+=b.y;return a;};const vectorSubtract=(a,b)=>{a.x-=b.x;a.y-=b.y;return a;};const vectorMultiply=(v,f)=>{v.x*=f;v.y*=f;return v;};const vectorDot=(a,b)=>a.x*b.x+a.y*b.y;const vectorDistanceSquared=(a,b=vectorCreateEmpty())=>{const x=a.x-b.x;const y=a.y-b.y;return x*x+y*y;};const vectorDistance=(a,b=vectorCreateEmpty())=>Math.sqrt(vectorDistanceSquared(a,b));const vectorCenter=v=>{let x=0;let y=0;v.forEach(v=>{x+=v.x;y+=v.y;});return vectorCreate(x/v.length,y/v.length);};const vectorsFlip=(points,flipX,flipY,cx,cy)=>{points.forEach(point=>{point.x=flipX?cx-(point.x-cx):point.x;point.y=flipY?cy-(point.y-cy):point.y;});return points;};const vectorsRotate=(points,angle,cx,cy)=>{const s=Math.sin(angle);const c=Math.cos(angle);points.forEach(p=>{p.x-=cx;p.y-=cy;const rx=p.x*c-p.y*s;const ry=p.x*s+p.y*c;p.x=cx+rx;p.y=cy+ry;});return points;};//\n// size\n//\nconst toSize=(width,height)=>({width,height});const sizeClone=size=>toSize(size.width,size.height);const sizeCreateFromAny=obj=>toSize(obj.width,obj.height);const sizeCreateFromRect=r=>toSize(r.width,r.height);const sizeCreateFromArray=a=>toSize(a[0],a[1]);const sizeCreate=(width,height)=>toSize(width,height);const sizeEqual=(a,b,format=passthrough)=>format(a.width)===format(b.width)&&format(a.height)===format(b.height);const sizeScale=(size,scalar)=>{size.width*=scalar;size.height*=scalar;return size;};const sizeCenter=size=>vectorCreate(size.width*0.5,size.height*0.5);const sizeRotate=(size,radians)=>{const cos=Math.cos(radians);const sin=Math.sin(radians);const w=cos*size.width+sin*size.height;const h=sin*size.width+cos*size.height;size.width=w;size.height=h;return size;};const sizeTurn=(size,radians)=>{const w=size.width;const h=size.height;if(isRotatedSideways(radians)){size.width=h;size.height=w;}return size;};const sizeContains=(a,b)=>a.width>=b.width&&a.height>=b.height;const sizeApply=(size,fn)=>{size.width=fn(size.width);size.height=fn(size.height);return size;};const sizeHypotenuse=size=>Math.sqrt(size.width*size.width+size.height*size.height);const sizeMin=(a,b)=>sizeCreate(Math.min(a.width,b.width),Math.min(a.height,b.height));//\n// line\n//\nconst lineCreate=(start,end)=>({start,end});const lineClone=line=>lineCreate(vectorClone(line.start),vectorClone(line.end));const lineExtend=(line,amount)=>{const v=vectorCreate(line.start.x-line.end.x,line.start.y-line.end.y);const vn=vectorNormalize(v);const vm=vectorMultiply(vn,amount);line.start.x+=vm.x;line.start.y+=vm.y;line.end.x-=vm.x;line.end.y-=vm.y;return line;};const lineMultiply=(line,amount)=>{const v=vectorCreate(line.start.x-line.end.x,line.start.y-line.end.y);const vn=vectorNormalize(v);const vm=vectorMultiply(vn,amount);line.end.x+=vm.x;line.end.y+=vm.y;return line;};//\n// rect\n//\nconst CornerSigns=[vectorCreate(-1,-1),vectorCreate(-1,1),vectorCreate(1,1),vectorCreate(1,-1)];const toRect=(x,y,width,height)=>({x,y,width,height});const rectClone=rect=>toRect(rect.x,rect.y,rect.width,rect.height);const rectCreateEmpty=()=>toRect(0,0,0,0);const rectCreateFromDimensions=(width,height)=>toRect(0,0,width,height);const rectCreateFromSize=size=>toRect(0,0,size.width,size.height);const rectCreateFromAny=obj=>toRect(obj.x||0,obj.y||0,obj.width||0,obj.height||0);const rectCreateFromPoints=(...args)=>{const pts=Array.isArray(args[0])?args[0]:args;let xMin=pts[0].x;let xMax=pts[0].x;let yMin=pts[0].y;let yMax=pts[0].y;pts.forEach(point=>{xMin=Math.min(xMin,point.x);xMax=Math.max(xMax,point.x);yMin=Math.min(yMin,point.y);yMax=Math.max(yMax,point.y);});return toRect(xMin,yMin,xMax-xMin,yMax-yMin);};const rectCreateFromEllipse=ellipse=>rectCreate(ellipse.x-ellipse.rx,ellipse.y-ellipse.ry,ellipse.rx*2,ellipse.ry*2);const rectCreateWithCenter=(center,size)=>toRect(center.x-size.width*0.5,center.y-size.height*0.5,size.width,size.height);const rectCreate=(x,y,width,height)=>toRect(x,y,width,height);const rectCenter=rect=>vectorCreate(rect.x+rect.width*0.5,rect.y+rect.height*0.5);const rectTranslate=(rect,t)=>{rect.x+=t.x;rect.y+=t.y;return rect;};const rectScale=(rect,scalar,pivot)=>{pivot=pivot||rectCenter(rect);rect.x=scalar*(rect.x-pivot.x)+pivot.x;rect.y=scalar*(rect.y-pivot.y)+pivot.y;rect.width=scalar*rect.width;rect.height=scalar*rect.height;return rect;};const rectMultiply=(rect,factor)=>{rect.x*=factor;rect.y*=factor;rect.width*=factor;rect.height*=factor;return rect;};const rectDivide=(rect,factor)=>{rect.x/=factor;rect.y/=factor;rect.width/=factor;rect.height/=factor;return rect;};const rectSubtract=(a,b)=>{a.x-=b.x;a.y-=b.y;a.width-=b.width;a.height-=b.height;return a;};const rectAdd=(a,b)=>{a.x+=b.x;a.y+=b.y;a.width+=b.width;a.height+=b.height;return a;};const rectEqual=(a,b,format=passthrough)=>format(a.x)===format(b.x)&&format(a.y)===format(b.y)&&format(a.width)===format(b.width)&&format(a.height)===format(b.height);const rectAspectRatio=rect=>getAspectRatio(rect.width,rect.height);const rectUpdate=(rect,x,y,width,height)=>{rect.x=x;rect.y=y;rect.width=width;rect.height=height;return rect;};const rectUpdateWithRect=(a,b)=>{a.x=b.x;a.y=b.y;a.width=b.width;a.height=b.height;return a;};const rectRotate=(rect,radians,pivot)=>{if(!pivot)pivot=rectCenter(rect);return rectGetCorners(rect).map(vertex=>vectorRotate(vertex,radians,pivot));};const rectCenterRect=(a,b)=>toRect(a.width*0.5-b.width*0.5,a.height*0.5-b.height*0.5,b.width,b.height);const rectContainsPoint=(rect,point)=>{if(point.x<rect.x)return false;if(point.y<rect.y)return false;if(point.x>rect.x+rect.width)return false;if(point.y>rect.y+rect.height)return false;return true;};const rectCoverRect=(rect,aspectRatio,offset=vectorCreateEmpty())=>{if(rect.width===0||rect.height===0)return rectCreateEmpty();const inputAspectRatio=rectAspectRatio(rect);if(!aspectRatio)aspectRatio=inputAspectRatio;let width=rect.width;let height=rect.height;if(aspectRatio>inputAspectRatio){// height remains the same, width is expanded\nwidth=height*aspectRatio;}else{// width remains the same, height is expanded\nheight=width/aspectRatio;}return toRect(offset.x+(rect.width-width)*0.5,offset.y+(rect.height-height)*0.5,width,height);};const rectContainRect=(rect,aspectRatio=rectAspectRatio(rect),offset=vectorCreateEmpty())=>{if(rect.width===0||rect.height===0)return rectCreateEmpty();let width=rect.width;let height=width/aspectRatio;if(height>rect.height){height=rect.height;width=height*aspectRatio;}return toRect(offset.x+(rect.width-width)*0.5,offset.y+(rect.height-height)*0.5,width,height);};const rectToBounds=rect=>[Math.min(rect.y,rect.y+rect.height),Math.max(rect.x,rect.x+rect.width),Math.max(rect.y,rect.y+rect.height),Math.min(rect.x,rect.x+rect.width)];const rectGetCorners=rect=>[vectorCreate(rect.x,rect.y),vectorCreate(rect.x+rect.width,rect.y),vectorCreate(rect.x+rect.width,rect.y+rect.height),vectorCreate(rect.x,rect.y+rect.height)];const rectApply=(rect,fn)=>{if(!rect)return;rect.x=fn(rect.x);rect.y=fn(rect.y);rect.width=fn(rect.width);rect.height=fn(rect.height);return rect;};const rectApplyPerspective=(rect,perspective,pivot=rectCenter(rect))=>rectGetCorners(rect).map((corner,index)=>{const sign=CornerSigns[index];return vectorCreate(scale(corner.x,1.0+sign.x*perspective.x,pivot.x),scale(corner.y,1.0+sign.y*perspective.y,pivot.y));});const rectNormalizeOffset=rect=>{rect.x=0;rect.y=0;return rect;};// https://stackoverflow.com/questions/9692448/how-can-you-find-the-centroid-of-a-concave-irregular-polygon-in-javascript\nconst quadCentroid=points=>{const pts=points.map(vectorClone);const first=pts[0];const last=pts[pts.length-1];if(first.x!=last.x||first.y!=last.y){pts.push(first);}let twicearea=0;let x=0;let y=0;let nPts=pts.length;let p1;let p2;let f;for(let i=0,j=nPts-1;i<nPts;j=i++){p1=pts[i];p2=pts[j];f=(p1.y-first.y)*(p2.x-first.x)-(p2.y-first.y)*(p1.x-first.x);twicearea+=f;x+=(p1.x+p2.x-2*first.x)*f;y+=(p1.y+p2.y-2*first.y)*f;}f=twicearea*3;return vectorCreate(x/f+first.x,y/f+first.y);};const lineLineIntersection=(a,b)=>_lineLineIntersection(a.start,a.end,b.start,b.end);const _lineLineIntersection=(a,b,c,d)=>{const uA=((d.x-c.x)*(a.y-c.y)-(d.y-c.y)*(a.x-c.x))/((d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y));const uB=((b.x-a.x)*(a.y-c.y)-(b.y-a.y)*(a.x-c.x))/((d.y-c.y)*(b.x-a.x)-(d.x-c.x)*(b.y-a.y));if(uA>=0&&uA<=1&&uB>=0&&uB<=1){return vectorCreate(a.x+uA*(b.x-a.x),a.y+uA*(b.y-a.y));}return undefined;};const linePointsIntersection=(line,points)=>{const vertices=[...points,points[0]];const l=vertices.length;const intersections=[];for(let i=0;i<l-1;i++){const intersection=_lineLineIntersection(line.start,line.end,vectorCreate(vertices[i].x,vertices[i].y),vectorCreate(vertices[i+1].x,vertices[i+1].y));if(!intersection)continue;intersections.push(intersection);}return intersections.length?intersections:undefined;};// First translate the polygon so that `point` is the origin. Then, for each\n// edge, get the angle between two vectors: 1) the edge vector and 2) the\n// vector of the first vertex of the edge. If all of the angles are the same\n// sign (which is negative since they will be counter-clockwise) then the\n// point is inside the polygon; otherwise, the point is outside.\nconst polyPointIntersectionConvex=(point,vertices)=>{let i,a,b,ax,ay,bx,by,edgex,edgey,x;const l=vertices.length;for(i=0;i<l;i++){a=vertices[i];b=vertices[i+1>l-1?0:i+1];ax=a.x-point.x;ay=a.y-point.y;bx=b.x-point.x;by=b.y-point.y;edgex=ax-bx;edgey=ay-by;x=edgex*ay-edgey*ax;// 0 is ON the edge, but we check for -0.00001 to fix floating point errors\nif(x<-0.00001)return false;}return true;};const quadLines=vertices=>{const arr=[];for(let i=0;i<vertices.length;i++){let next=i+1;if(next===vertices.length)next=0;arr.push(lineCreate(vectorClone(vertices[i]),vectorClone(vertices[next])));}return arr;};var getImageTransformedRect=(imageSize,imageRotation)=>{const imageRect=rectCreateFromSize(imageSize);const imageCenter=rectCenter(imageRect);const imageTransformedVertices=rectRotate(imageRect,imageRotation,imageCenter);return rectNormalizeOffset(rectCreateFromPoints(imageTransformedVertices));};var isElement=(v,name)=>v instanceof HTMLElement&&(name?new RegExp(`^${name}$`,'i').test(v.nodeName):true);var isFile=v=>v instanceof File;var isString=v=>typeof v==='string';var canvasToFile=async(canvas,mimeType,quality)=>{const blob=await canvasToBlob(canvas,mimeType,quality);return blobToFile(blob,'canvas');};var getFilenameFromURL=url=>url.split('/').pop().split(/\\?|\\#/).shift();let isSafari=null;var isSafari$1=()=>{if(isSafari===null)isSafari=isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return isSafari;};var getImageElementSize=imageElement=>new Promise((resolve,reject)=>{let shouldAutoRemove=false;// test if image is attached to DOM, if not attached, attach so measurement is correct on Safari\nif(!imageElement.parentNode&&isSafari$1()){shouldAutoRemove=true;// has width 0 and height 0 to prevent rendering very big SVGs (without width and height) that will for one frame overflow the window and show a scrollbar\nimageElement.style.cssText=`position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;`;document.body.appendChild(imageElement);}// start testing size\nconst measure=()=>{const width=imageElement.naturalWidth;const height=imageElement.naturalHeight;const hasSize=width&&height;if(!hasSize)return;// clean up image if was attached for measuring\nif(shouldAutoRemove)imageElement.parentNode.removeChild(imageElement);clearInterval(intervalId);resolve({width,height});};imageElement.onerror=err=>{clearInterval(intervalId);reject(err);};const intervalId=setInterval(measure,1);measure();});var getImageSize=async image=>{// the image element we'll use to load the image\nlet imageElement=image;// if is not an image element, it must be a valid image source\nif(!imageElement.src){imageElement=new Image();imageElement.src=isString(image)?image:URL.createObjectURL(image);}let size;try{size=await getImageElementSize(imageElement);}catch(err){throw err;}finally{isFile(image)&&URL.revokeObjectURL(imageElement.src);}return size;};const awaitComplete=image=>new Promise((resolve,reject)=>{if(image.complete)return resolve(image);image.onload=()=>resolve(image);image.onerror=reject;});var imageToFile=async imageElement=>{try{const size=await getImageSize(imageElement);const image=await awaitComplete(imageElement);const canvas=document.createElement('canvas');canvas.width=size.width;canvas.height=size.height;const ctx=canvas.getContext('2d');ctx.drawImage(image,0,0);const blob=await canvasToBlob(canvas);return blobToFile(blob,getFilenameFromURL(image.src));}catch(err){throw err;}};var isDataURI=str=>/^data:/.test(str);var isUserAgent=test=>isBrowser()?RegExp(test).test(window.navigator.userAgent):undefined;let result$2=null;var isInternetExplorer=()=>{if(result$2===null)result$2=isUserAgent(/MSIE|Trident/);return result$2;};// IE11 does not support getting blobs with fetch, so we use this fallback method\nconst dataURIToBlob=dataURI=>{const parts=dataURI.split(',');const type=parts[0].substr(4);const byteString=atob(parts[1]);const l=byteString.length;const ab=new ArrayBuffer(byteString.length);const ia=new Uint8Array(ab);for(var i=0;i<l;i++){ia[i]=byteString.charCodeAt(i);}return new Blob([ab],{type:type});};var dataURIToFile=async(dataURI,filename='data-uri',onprogress=noop)=>{// basic loader, no size info\nonprogress(createProgressEvent(0));let blob;if(isInternetExplorer()){blob=dataURIToBlob(dataURI);onprogress(createProgressEvent(0.5));}else{const res=await fetch(dataURI);onprogress(createProgressEvent(0.33));blob=await res.blob();onprogress(createProgressEvent(0.66));}const file=blobToFile(blob,filename);onprogress(createProgressEvent(1));return file;};var getResponseHeader=(xhr,header,parse=header=>header)=>xhr.getAllResponseHeaders().indexOf(header)>=0?parse(xhr.getResponseHeader(header)):undefined;var getFilenameFromContentDisposition=header=>{if(!header)return null;const matches=header.split(/filename=|filename\\*=.+''/).splice(1).map(name=>name.trim().replace(/^[\"']|[;\"']{0,2}$/g,'')).filter(name=>name.length);return matches.length?decodeURI(matches[matches.length-1]):null;};const DokaErrorCode={URL_REQUEST:'URL_REQUEST',DOCTYPE_MISSING:'DOCTYPE_MISSING'};class DokaError extends Error{constructor(message,code,metadata){super(message);this.name='DokaError';this.code=code;this.metadata=metadata;}}var fetchFile=(url,onprogress)=>new Promise((resolve,reject)=>{const handleError=()=>reject(new DokaError('Error fetching image',DokaErrorCode.URL_REQUEST,xhr));const xhr=new XMLHttpRequest();xhr.onprogress=onprogress;xhr.onerror=handleError,xhr.onload=()=>{if(!xhr.response||xhr.status>=300||xhr.status<200)return handleError();// we store the response mime type so we can add it to the blob later on, if it's missing (happens on Safari 10)\nconst mimetype=getResponseHeader(xhr,'Content-Type');// try to get filename and any file instructions as well\nconst filename=getResponseHeader(xhr,'Content-Disposition',getFilenameFromContentDisposition)||getFilenameFromURL(url);// convert to actual file if possible\nresolve(blobToFile(xhr.response,filename,mimetype||getMimeTypeFromFilename(filename)));};xhr.open('GET',url);xhr.responseType='blob';xhr.send();});var urlToFile=(url,onprogress)=>{// use fetch to create blob from data uri\nif(isDataURI(url))return dataURIToFile(url,undefined,onprogress);// load file from url\nreturn fetchFile(url,onprogress);};var isBlob=v=>v instanceof Blob&&!(v instanceof File);var srcToFile=async(src,onprogress)=>{if(isFile(src)||isBlob(src))return src;else if(isString(src))return await urlToFile(src,onprogress);else if(isElement(src,'canvas'))return await canvasToFile(src);else if(isElement(src,'img'))return await imageToFile(src);else{throw new DokaError('Invalid image source','invalid-image-source');}};var orientImageSize=async(size,orientation=1)=>{// browser can handle image orientation\nif(await canOrientImages())return size;// no need to fix orientation\nif(orientation<5)return size;// correct image size\nreturn sizeCreate(size.height,size.width);};var arrayBufferReadImageHead=data=>{const view=new DataView(data);// Every JPEG file starts from binary value '0xFFD8', so if it's not present, exit here\nif(view.getUint16(0)!==0xffd8)return null;let offset=2;// Start at 2 as we skipped two bytes (FFD8)\nlet marker;let markerLength;while(offset<view.byteLength){marker=view.getUint16(offset,false);markerLength=view.getUint16(offset+2,false)+2;// Test if is APP and COM markers\nconst isData=marker>=0xffe0&&marker<=0xffef||marker===0xfffe;if(!isData)break;if(offset+markerLength>view.byteLength)break;offset+=markerLength;}return data.slice(0,offset);};const readExifOrientation$1=(view,offset)=>{// Missing 0x45786966 Marker? No Exif Header, stop here\nif(view.getUint32(offset+=2,false)!==0x45786966)return-1;// First 2bytes defines byte align of TIFF data.\n// If it is 0x4949=\"I I\", it means \"Intel\" type byte align\nconst intelByteAligned=view.getUint16(offset+=6,false)===0x4949;offset+=view.getUint32(offset+4,intelByteAligned);const tags=view.getUint16(offset,intelByteAligned);offset+=2;// find Orientation tag\nfor(let i=0;i<tags;i++){if(view.getUint16(offset+i*12,intelByteAligned)===0x0112)return view.getUint16(offset+i*12+8,intelByteAligned);}};var arrayBufferReadExifOrientationTag=data=>{if(!data)return;const view=new DataView(data);// Every JPEG file starts from binary value '0xFFD8', so if it's not present, exit here\nif(view.getUint16(0,false)!=0xffd8)return;const length=view.byteLength;let offset=2;let marker;while(offset<length){if(view.getUint16(offset+2,false)<=8)return;marker=view.getUint16(offset,false);offset+=2;// Exif Marker found\nif(marker===0xffe1)return readExifOrientation$1(view,offset);// Invalid marker, exit here\nelse if((marker&0xff00)!==0xff00)return;// Next!\nelse offset+=view.getUint16(offset,false);}};var arrayBufferWriteExifOrientationTag=(data,value=1)=>{if(!data)return false;const view=new DataView(data);// Every JPEG file starts from binary value '0xFFD8', so if it's not present, exit here\nif(view.getUint16(0)!==0xffd8)return false;let offset=2;// Start at 2 as we skipped two bytes (FFD8)\nlet marker;let markerLength;let orientationCorrected=false;while(offset<view.byteLength){marker=view.getUint16(offset,false);markerLength=view.getUint16(offset+2,false)+2;// Test if is APP and COM markers\nconst isData=marker>=0xffe0&&marker<=0xffef||marker===0xfffe;if(!isData)break;if(!orientationCorrected)orientationCorrected=writeExifOrientation(view,offset,value);if(offset+markerLength>view.byteLength)break;offset+=markerLength;}return orientationCorrected;};const writeExifOrientation=(view,offset,orientation)=>{// Missing 0x45786966 Marker? No Exif Header, stop here\nif(view.getUint32(offset+4,false)!==0x45786966)return;// next byte!\noffset+=4;// First 2bytes defines byte align of TIFF data.\n// If it is 0x4949=\"I I\", it means \"Intel\" type byte align\nconst intelByteAligned=view.getUint16(offset+=6,false)===0x4949;offset+=view.getUint32(offset+4,intelByteAligned);const tags=view.getUint16(offset,intelByteAligned);offset+=2;// find Orientation tag and overwrite with orientation value\nfor(let i=0;i<tags;i++){if(view.getUint16(offset+i*12,intelByteAligned)===0x0112){view.setUint16(offset+i*12+8,orientation,intelByteAligned);return true;}}return false;};var isJPEG=file=>/jpeg/.test(file.type);var isPlainObject=obj=>typeof obj=='object'&&obj.constructor==Object;var stringify=value=>!isPlainObject(value)?value:JSON.stringify(value);var post=(url,dataset,options)=>new Promise((resolve,reject)=>{const{token={},beforeSend=noop,onprogress=noop}=options;token.cancel=()=>request.abort();const request=new XMLHttpRequest();request.upload.onprogress=onprogress;request.onload=()=>request.status>=200&&request.status<300?resolve(request):reject(request);request.onerror=()=>reject(request);request.ontimeout=()=>reject(request);request.open('POST',encodeURI(url));beforeSend(request);request.send(dataset.reduce((formData,args)=>{// @ts-ignore\nformData.append(...args.map(stringify));return formData;},new FormData()));});var ctxRotate=(ctx,rotation=0,pivot)=>{if(rotation===0)return ctx;ctx.translate(pivot.x,pivot.y);ctx.rotate(rotation);ctx.translate(-pivot.x,-pivot.y);return ctx;};var ctxTranslate=(ctx,x,y)=>{ctx.translate(x,y);return ctx;};var ctxScale=(ctx,x,y)=>{ctx.scale(x,y);return ctx;};var cropImageData=async(imageData,options={})=>{const{flipX,flipY,rotation,crop}=options;const imageSize=sizeCreateFromAny(imageData);const shouldFlip=flipX||flipY;const shouldRotate=!!rotation;const cropDefined=crop&&(crop.x||crop.y||crop.width||crop.height);const cropCoversImage=cropDefined&&rectEqual(crop,rectCreateFromSize(imageSize));const shouldCrop=cropDefined&&!cropCoversImage;// skip!\nif(!shouldFlip&&!shouldRotate&&!shouldCrop)return imageData;// create drawing context\nlet imageDataOut;let image=h('canvas',{width:imageData.width,height:imageData.height});image.getContext('2d').putImageData(imageData,0,0);// flip image data\nif(shouldFlip){const ctx=h('canvas',{width:image.width,height:image.height}).getContext('2d');ctxScale(ctx,flipX?-1:1,flipY?-1:1);ctx.drawImage(image,flipX?-image.width:0,flipY?-image.height:0);ctx.restore();releaseCanvas(image);image=ctx.canvas;}// rotate image data\nif(shouldRotate){// if shouldRotate is true we also receive a crop rect\nconst outputSize=sizeApply(sizeCreateFromRect(rectCreateFromPoints(rectRotate(rectCreateFromAny(image),rotation))),Math.floor);const ctx=h('canvas',{width:crop.width,height:crop.height}).getContext('2d');ctxTranslate(ctx,-crop.x,-crop.y);ctxRotate(ctx,rotation,sizeCenter(outputSize));ctx.drawImage(image,(outputSize.width-image.width)*0.5,(outputSize.height-image.height)*0.5);ctx.restore();releaseCanvas(image);image=ctx.canvas;}// crop image data\nelse if(shouldCrop){const ctx=image.getContext('2d');imageDataOut=ctx.getImageData(crop.x,crop.y,crop.width,crop.height);releaseCanvas(image);return imageDataOut;}// done, return resulting image data\nconst ctx=image.getContext('2d');imageDataOut=ctx.getImageData(0,0,image.width,image.height);releaseCanvas(image);return imageDataOut;};var resizeTransform=(options,done)=>{const{imageData,width,height}=options;const originWidth=imageData.width;const originHeight=imageData.height;const targetWidth=Math.round(width);const targetHeight=Math.round(height);const inputData=imageData.data;const outputData=new Uint8ClampedArray(targetWidth*targetHeight*4);const ratioWidth=originWidth/targetWidth;const ratioHeight=originHeight/targetHeight;const ratioWidthHalf=Math.ceil(ratioWidth*0.5);const ratioHeightHalf=Math.ceil(ratioHeight*0.5);for(let j=0;j<targetHeight;j++){for(let i=0;i<targetWidth;i++){const x2=(i+j*targetWidth)*4;let weight=0;let weights=0;let weightsAlpha=0;let r=0;let g=0;let b=0;let a=0;const centerY=(j+0.5)*ratioHeight;for(let yy=Math.floor(j*ratioHeight);yy<(j+1)*ratioHeight;yy++){const dy=Math.abs(centerY-(yy+0.5))/ratioHeightHalf;const centerX=(i+0.5)*ratioWidth;const w0=dy*dy;for(let xx=Math.floor(i*ratioWidth);xx<(i+1)*ratioWidth;xx++){let dx=Math.abs(centerX-(xx+0.5))/ratioWidthHalf;const w=Math.sqrt(w0+dx*dx);if(w>=-1&&w<=1){weight=2*w*w*w-3*w*w+1;if(weight>0){dx=4*(xx+yy*originWidth);const ref=inputData[dx+3];a+=weight*ref;weightsAlpha+=weight;if(ref<255){weight=weight*ref/250;}r+=weight*inputData[dx];g+=weight*inputData[dx+1];b+=weight*inputData[dx+2];weights+=weight;}}}}outputData[x2]=r/weights;outputData[x2+1]=g/weights;outputData[x2+2]=b/weights;outputData[x2+3]=a/weightsAlpha;}}done(null,{data:outputData,width:targetWidth,height:targetHeight});};var imageDataObjectToImageData=obj=>{if(obj instanceof ImageData){return obj;}let imageData;try{imageData=new ImageData(obj.width,obj.height);}catch(err){// IE + Old EDGE (tested on 12)\nconst canvas=h('canvas');imageData=canvas.getContext('2d').createImageData(obj.width,obj.height);}imageData.data.set(obj.data);return imageData;};var resizeImageData=async(imageData,options={})=>{const{width,height,fit,upscale}=options;// no need to rescale\nif(!width&&!height)return imageData;let targetWidth=width;let targetHeight=height;if(!width){targetWidth=height;}else if(!height){targetHeight=width;}if(fit!=='force'){let scalarWidth=targetWidth/imageData.width;let scalarHeight=targetHeight/imageData.height;let scalar=1;if(fit==='cover'){scalar=Math.max(scalarWidth,scalarHeight);}else if(fit==='contain'){scalar=Math.min(scalarWidth,scalarHeight);}// if image is too small, exit here with original image\nif(scalar>1&&upscale===false)return imageData;targetWidth=Math.round(imageData.width*scalar);targetHeight=Math.round(imageData.height*scalar);}// no need to resize?\nif(imageData.width===targetWidth&&imageData.height===targetHeight)return imageData;// let's resize!\nimageData=await thread(resizeTransform,[{imageData:imageData,width:targetWidth,height:targetHeight}],[imageData.data.buffer]);// the resizer returns a plain object, not an actual image data object, lets create one\nreturn imageDataObjectToImageData(imageData);};var colorEffect=(options,done)=>{const{imageData,matrix}=options;if(!matrix)return done(null,imageData);const outputData=new Uint8ClampedArray(imageData.width*imageData.height*4);const data=imageData.data;const l=data.length;const m11=matrix[0];const m12=matrix[1];const m13=matrix[2];const m14=matrix[3];const m15=matrix[4];const m21=matrix[5];const m22=matrix[6];const m23=matrix[7];const m24=matrix[8];const m25=matrix[9];const m31=matrix[10];const m32=matrix[11];const m33=matrix[12];const m34=matrix[13];const m35=matrix[14];const m41=matrix[15];const m42=matrix[16];const m43=matrix[17];const m44=matrix[18];const m45=matrix[19];let index=0;let r=0.0;let g=0.0;let b=0.0;let a=0.0;let mr=0.0;let mg=0.0;let mb=0.0;let ma=0.0;let or=0.0;let og=0.0;let ob=0.0;for(;index<l;index+=4){r=data[index]/255;g=data[index+1]/255;b=data[index+2]/255;a=data[index+3]/255;mr=r*m11+g*m12+b*m13+a*m14+m15;mg=r*m21+g*m22+b*m23+a*m24+m25;mb=r*m31+g*m32+b*m33+a*m34+m35;ma=r*m41+g*m42+b*m43+a*m44+m45;or=Math.max(0,mr*ma)+(1.0-ma);og=Math.max(0,mg*ma)+(1.0-ma);ob=Math.max(0,mb*ma)+(1.0-ma);outputData[index]=Math.max(0.0,Math.min(1.0,or))*255;outputData[index+1]=Math.max(0.0,Math.min(1.0,og))*255;outputData[index+2]=Math.max(0.0,Math.min(1.0,ob))*255;outputData[index+3]=a*255;}done(null,{data:outputData,width:imageData.width,height:imageData.height});};var convolutionEffect=(options,done)=>{const{imageData,matrix}=options;if(!matrix)return done(null,imageData);// calculate kernel weight\nlet kernelWeight=matrix.reduce((prev,curr)=>prev+curr);// input info\nconst inputWidth=imageData.width;const inputHeight=imageData.height;const inputData=imageData.data;let i=0;let x=0;let y=0;const side=Math.round(Math.sqrt(matrix.length));const sideHalf=Math.floor(side/2);let r=0,g=0,b=0,a=0,cx=0,cy=0,scy=0,scx=0,srcOff=0,weight=0;const outputData=new Uint8ClampedArray(inputWidth*inputHeight*4);for(y=0;y<inputHeight;y++){for(x=0;x<inputWidth;x++){// calculate the weighed sum of the source image pixels that\n// fall under the convolution matrix\nr=0;g=0;b=0;a=0;for(cy=0;cy<side;cy++){for(cx=0;cx<side;cx++){scy=y+cy-sideHalf;scx=x+cx-sideHalf;if(scy<0||scy>=inputHeight||scx<0||scx>=inputWidth)continue;srcOff=(scy*inputWidth+scx)*4;weight=matrix[cy*side+cx];r+=inputData[srcOff]*weight;g+=inputData[srcOff+1]*weight;b+=inputData[srcOff+2]*weight;a+=inputData[srcOff+3]*weight;}}outputData[i]=r/kernelWeight;outputData[i+1]=g/kernelWeight;outputData[i+2]=b/kernelWeight;outputData[i+3]=a/kernelWeight;i+=4;}}done(null,{data:outputData,width:inputWidth,height:inputHeight});};var vignetteEffect=(options,done)=>{const{imageData,strength}=options;if(!strength)return done(null,imageData);const outputData=new Uint8ClampedArray(imageData.width*imageData.height*4);const inputWidth=imageData.width;const inputHeight=imageData.height;const data=imageData.data;const dist=(x,y)=>{dx=x-cx;dy=y-cy;return Math.sqrt(dx*dx+dy*dy);};let index=0;let x=0;let y=0;let cx=inputWidth*0.5;let cy=inputHeight*0.5;let dx;let dy;let f;let dm=dist(0,0);for(y=0;y<inputHeight;y++){for(x=0;x<inputWidth;x++){index=(x+y*inputWidth)*4;f=dist(x,y)*strength/dm;if(strength>0){outputData[index]=data[index]*(1-f);outputData[index+1]=data[index+1]*(1-f);outputData[index+2]=data[index+2]*(1-f);}else{outputData[index]=data[index]+f*-(255-data[index]);outputData[index+1]=data[index+1]+f*-(255-data[index+1]);outputData[index+2]=data[index+2]+f*-(255-data[index+2]);}outputData[index+3]=data[index+3];}}done(null,{data:outputData,width:imageData.width,height:imageData.height});};var noiseEffect=(options,done)=>{const{imageData,level,monochrome=false}=options;if(!level)return done(null,imageData);const outputData=new Uint8ClampedArray(imageData.width*imageData.height*4);const data=imageData.data;const l=data.length;let index=0;let r;let g;let b;let average;const rand=()=>(-1+Math.random()*2)*255*level;for(;index<l;index+=4){if(monochrome){average=rand();r=average;g=average;b=average;}else{r=rand();g=rand();b=rand();}outputData[index]=data[index]+r;outputData[index+1]=data[index+1]+g;outputData[index+2]=data[index+2]+b;outputData[index+3]=data[index+3];}done(null,{data:outputData,width:imageData.width,height:imageData.height});};var gammaEffect=(options,done)=>{const{imageData,level}=options;if(!level)return done(null,imageData);const outputData=new Uint8ClampedArray(imageData.width*imageData.height*4);const data=imageData.data;const l=data.length;let index=0;let r;let g;let b;for(;index<l;index+=4){r=data[index]/255;g=data[index+1]/255;b=data[index+2]/255;outputData[index]=Math.pow(r,level)*255;outputData[index+1]=Math.pow(g,level)*255;outputData[index+2]=Math.pow(b,level)*255;outputData[index+3]=data[index+3];}done(null,{data:outputData,width:imageData.width,height:imageData.height});};var isIdentityMatrix=matrix=>{/*\n    [\n        1, 0, 0, 0, 0\n        0, 1, 0, 0, 0\n        0, 0, 1, 0, 0\n        0, 0, 0, 1, 0\n    ]\n    */const l=matrix.length;let v;let s=l>=20?6:l>=16?5:3;for(let i=0;i<l;i++){v=matrix[i];if(v===1&&i%s!==0)return false;else if(v!==0&&v!==1)return false;}return true;};var filterImageData=async(imageData,options={})=>{const{colorMatrix,convolutionMatrix,gamma:gammaLevel,noise:noiseLevel,vignette:vignetteStrength}=options;// filters\nconst filters=[];// apply convolution matrix\nif(convolutionMatrix){filters.push([convolutionEffect,{matrix:convolutionMatrix.clarity}]);}// apply noise\nif(gammaLevel>0){filters.push([gammaEffect,{level:1.0/gammaLevel}]);}// apply color matrix\nif(colorMatrix&&!isIdentityMatrix(colorMatrix)){filters.push([colorEffect,{matrix:colorMatrix}]);}// apply noise\nif(noiseLevel>0||noiseLevel<0){filters.push([noiseEffect,{level:noiseLevel}]);}// apply vignette\nif(vignetteStrength>0||vignetteStrength<0){filters.push([vignetteEffect,{strength:vignetteStrength}]);}// no changes\nif(!filters.length)return imageData;// builds effect chain\nconst chain=(transforms,i)=>`(err, imageData) => {\n            (${transforms[i][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${i}]), \n                ${transforms[i+1]?chain(transforms,i+1):'done'})\n        }`;const filterChain=`function (options, done) {\n        const filterInstructions = options.filterInstructions;\n        const imageData = options.imageData;\n        (${chain(filters,0)})(null, imageData)\n    }`;imageData=await thread(filterChain,[{imageData:imageData,filterInstructions:filters.map(t=>t[1])}],[imageData.data.buffer]);// the resizer returns a plain object, not an actual image data object, lets create one\nreturn imageDataObjectToImageData(imageData);};var isNumber=v=>typeof v==='number';var isEmoji=str=>isString(str)&&str.match(/(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g)!==null;var hasProp=(obj,key)=>obj.hasOwnProperty(key);var isObject=v=>typeof v==='object';const copy=val=>isObject(val)?deepCopy(val):val;const deepCopy=src=>{let dst;if(Array.isArray(src)){dst=[];src.forEach((val,i)=>{dst[i]=copy(val);});}else{dst={};Object.keys(src).forEach(key=>{const val=src[key];dst[key]=copy(val);});}return dst;};var isFunction=v=>typeof v==='function';var isArray=arr=>Array.isArray(arr);let result$3=null;var isMac=()=>{if(result$3===null)result$3=isBrowser()&&/^mac/i.test(navigator.platform);return result$3;};let result$4=null;var isIOS=()=>{if(result$4===null)// first part is for iPhones and iPads iOS 12 and below second part is for iPads with iOS 13 and up\nresult$4=isBrowser()&&(isUserAgent(/iPhone|iPad|iPod/)||isMac()&&navigator.maxTouchPoints>=1);return result$4;};var isApple=()=>isIOS()||isMac();var isWindows=()=>/^win/i.test(navigator.platform);// macos:   font-size: 123, x: 63.5, y: 110\n// windows: font-size: 112, x: 64, y: 103\n// android: font-size: 112, x: 64, y: 102\nlet x=64;let y=102;let fontSize=112;let hasSetValues=false;var getEmojiSVG=(emoji,alt)=>{if(!hasSetValues&&isBrowser()){if(isWindows())y=103;if(isApple()){x=63.5;y=110;fontSize=123;}hasSetValues=true;}return`<svg${alt?` aria-label=\"${alt}\"`:''} width=\"128\" height=\"128\" viewBox=\"0 0 128 128\" preserveAspectRatio=\"xMinYMin meet\" xmlns=\"http://www.w3.org/2000/svg\"><text x=\"${x}\" y=\"${y}\" alignment-baseline=\"text-top\" dominant-baseline=\"text-top\" text-anchor=\"middle\" font-size=\"${fontSize}px\">${emoji}</text></svg>`;};var SVGToDataURL=svg=>`data:image/svg+xml,${svg.replace('<','%3C').replace('>','%3E')}`;var isBinary=v=>v instanceof Blob;var toPercentage=(value,total)=>`${value/total*100}%`;var loadImage=(image,onsize=undefined)=>new Promise((resolve,reject)=>{// the image element we'll use to load the image\nlet imageElement=image;let sizeCalculated=false;const reportSize=()=>{if(sizeCalculated)return;sizeCalculated=true;isFunction(onsize)&&/* Use Promise.resolve to make async but place before resolve of parent promise */Promise.resolve().then(()=>onsize(sizeCreate(imageElement.naturalWidth,imageElement.naturalHeight)));};// if is not an image element, it must be a valid image source\nif(!imageElement.src){imageElement=new Image();imageElement.src=isString(image)?image:URL.createObjectURL(image);}if(imageElement.complete){reportSize();return resolve(imageElement);}// try to calculate size faster\nif(isFunction(onsize))getImageElementSize(imageElement).then(reportSize).catch(reject);imageElement.onload=()=>{reportSize();resolve(imageElement);};imageElement.onerror=reject;});var colorArrayToRGBA=color=>`rgba(${Math.round(color[0]*255)}, ${Math.round(color[1]*255)}, ${Math.round(color[2]*255)}, ${isNumber(color[3])?color[3]:1})`;const textPadding=20;// font offset\n// font size 16 -> 2, 4\n// font size 32 -> 4, 6\n// font size 64 -> 8, 12\n// font size 128 -> 16, 24\n// font size 256 -> 32, 48\nlet fontOffsetBrowser=undefined;const getBrowserFontOffset=fontSize=>{if(!fontOffsetBrowser){// size\nconst size=32;// let's calculate it\nconst ctx=createSimpleContext(size,size);updateTextContext(ctx,{fontSize:100,color:'#fff'});ctx.fillText('F',0,0);// get pixel data so we can find the white pixels\nconst data=ctx.getImageData(0,0,size,size).data;// find x offset\nlet p=0;let step=4;let to=data.length;let from=to-size*4;for(p=from;p<to;p+=step){if(data[p])break;}const x=(p-from)/step;// find y offset\nfrom=(size-1)*4;step=size*4;for(p=from;p<to;p+=step){if(data[p])break;}const y=(p-from)/step;fontOffsetBrowser=vectorCreate(x,y);// done with canvas\nreleaseCanvas(ctx.canvas);}return vectorCreate(-fontOffsetBrowser.x*fontSize*0.01,-fontOffsetBrowser.y*fontSize*0.01);};const createSimpleContext=(width=1,height=1)=>{const canvas=h('canvas');const ctx=canvas.getContext('2d');ctx.canvas.width=width;ctx.canvas.height=height;return ctx;};const updateTextContext=(ctx,options)=>{const{fontSize=16,fontFamily='sans-serif',fontWeight='normal',fontVariant='normal',fontStyle='normal',textAlign='left',color='#000'}=options;ctx.font=`${fontStyle} ${fontVariant} ${fontWeight} ${fontSize}px ${fontFamily}`;ctx.textBaseline='top';ctx.textAlign=textAlign;ctx.fillStyle=Array.isArray(color)?colorArrayToRGBA(color):color;};const createSimpleTextContext=options=>{const ctx=createSimpleContext();updateTextContext(ctx,options);return ctx;};const computeLineHeight=(fontSize,lineHeight)=>isFunction(lineHeight)?lineHeight(fontSize):lineHeight;const getMeasureVisibleWidth=measure=>Math.abs(measure.actualBoundingBoxLeft)+Math.abs(measure.actualBoundingBoxRight);const resizeContextToFitText=(ctx,text,options)=>{const{width,height}=measureTextContext(ctx,text,computeLineHeight(options.fontSize,options.lineHeight));ctx.canvas.width=Math.ceil(width);ctx.canvas.height=Math.ceil(height);return ctx;};const measureTextContext=(ctx,text,computedLineHeight)=>{const storedTextAlign=ctx.textAlign;ctx.textAlign='left';// calculate width\nconst lines=text.split('\\n');const width=lines.reduce((prev,curr)=>{const lineWidth=getMeasureVisibleWidth(ctx.measureText(curr));if(lineWidth>prev){prev=lineWidth;}return prev;},1);ctx.textAlign=storedTextAlign;// calculate height\nconst height=computedLineHeight*lines.length;return sizeCreate(Math.ceil(width),Math.ceil(height));};const TextSizeCache=new Map();const createTextSizeHash=(text,{fontSize,fontFamily,lineHeight,fontWeight,fontStyle,fontVariant})=>`${[text,fontSize,fontWeight,fontStyle,fontVariant,fontFamily].join('_')}_${isFunction(lineHeight)?lineHeight(fontSize):lineHeight}`;const textSize=(text,options)=>{const ctx=createSimpleTextContext(options);if(options.width)text=wrapText(ctx,text,options.width);const hash=createTextSizeHash(text,options);let size=TextSizeCache.get(hash);if(size)return _objectSpread({},size);size=measureTextContext(ctx,text,computeLineHeight(options.fontSize,options.lineHeight));TextSizeCache.set(hash,size);return _objectSpread({},size);};const wrapText=(ctx,text,lineWidth)=>{// exit if no text\nif(text.length===0)return'';const res=[];let lineBuffer='';let lineIndex=0;let measureWidth;const paragraphs=text.split('\\n\\n');// draw the current line\nconst pushLine=()=>{if(!lineBuffer.length)return;if(!res[lineIndex]){res[lineIndex]=[];}res[lineIndex].push(lineBuffer);// clear buffer\nlineBuffer='';};const fitChar=char=>{const testLine=lineBuffer+char;// measure width of entire line if adding these chars\nmeasureWidth=ctx.measureText(testLine).width;// fits on line?\nif(measureWidth<lineWidth){lineBuffer=testLine;}else{// doesn't fit but line buffer is empty, just print the character and move to next line\nif(!lineBuffer.length){lineBuffer=testLine;pushLine();}// fits, lets print current line and move char to next line\nelse{pushLine();lineBuffer=char;}lineIndex++;}};const fitWord=word=>{const testLine=lineBuffer.length?lineBuffer+' '+word:word;// measure width of entire line if adding these chars\nmeasureWidth=ctx.measureText(testLine).width;// fits on line?\nif(measureWidth<lineWidth){lineBuffer=testLine;}// wrap to next line\nelse{// if line buffer is empty, whole word doesn't fit, need to cut it up\nif(!lineBuffer.length){word.split('').forEach(fitChar);}// there are words in the buffer that do fit, let's draw the line and move this word to the next line\nelse{// draw current buffer\npushLine();lineIndex++;// retry to fit this word\nfitWord(word);}}};paragraphs.forEach(p=>{const lines=p.split('\\n');lines.forEach(l=>{l.split(' ').forEach(fitWord);// end of line reached, if we have words in our buffer\n// at this point we need to draw them and then move to the next line\nif(lineBuffer.length)pushLine();// forced new line\nlineIndex++;});// forced new line\nlineIndex++;});return res.map(line=>line.join(' ')).join('\\n');};const drawText=(ctx,text='',options={})=>{// exit if no text\nif(text.length===0)return ctx;const{x=0,y=0,lineWidth=0,textAlign,fontSize,lineHeight}=options;// determine where the browser will render the font and correct for browser differences\nconst browserFontOffset=vectorAdd(getBrowserFontOffset(fontSize),vectorCreate(fontSize/12,fontSize/3.75));const fontOffsetX=x+browserFontOffset.x;const fontOffsetY=y+browserFontOffset.y;const lineHeightComputed=isFunction(lineHeight)?lineHeight(fontSize):lineHeight;let offset=textAlign==='right'?lineWidth:textAlign==='center'?lineWidth*0.5:0;text.split('\\n').forEach((line,i)=>{ctx.fillText(line,fontOffsetX+offset,fontOffsetY+i*lineHeightComputed);});return ctx;};//#region shape generic\nconst shapeContain=(shape,parentRect)=>{const shapeAspectRatio=shape.width/shape.height;const containedShape=rectContainRect(parentRect,shapeAspectRatio);if(shape.width>containedShape.width||shape.height>containedShape.height){shape.width=containedShape.width;shape.height=containedShape.height;}return shape;};const shapeCenter=(shape,position)=>{shape.x=position.x-shape.width*0.5;shape.y=position.y-shape.height*0.5;return shape;};const shapeDeepCopy=shape=>{// don't attempt to clone background image element\n// TODO: MOVE IMAGE ELEMENT TO SOME INTERNAL CACHE\nconst shapeShallowCopy=_objectSpread({},shape);shapeShallowCopy.backgroundImageElement=undefined;const shapeDeepCopy=deepCopy(shapeShallowCopy);// we don't want a million image elements so we'll reference the original one\nif(shape.backgroundImageElement)shapeDeepCopy.backgroundImageElement=shape.backgroundImageElement;return shapeDeepCopy;};const getContextSize=(context,size={})=>{const contextAspectRatio=rectAspectRatio(context);let width;let height;if(size.width&&size.height)return sizeClone(size);if(size.width||size.height){width=parseFloat(size.width||Number.MAX_SAFE_INTEGER);height=parseFloat(size.height||Number.MAX_SAFE_INTEGER);const min=Math.min(width,height);if(isString(size.width)||isString(size.height)){width=`${min}%`;height=`${min*contextAspectRatio}%`;}else{width=min;height=min;}}else{const min=10;width=`${min}%`;height=`${min*contextAspectRatio}%`;}return{width,height};};const shapeCreateFromEmoji=(emoji,props={})=>{return _objectSpread(_objectSpread({width:undefined,height:undefined},props),{},{aspectRatio:1,backgroundImage:SVGToDataURL(getEmojiSVG(emoji))});};const shapeCreateFromImage=(src,oncomplete,props={})=>{const shape=_objectSpread(_objectSpread({// required/default image shape props\nwidth:undefined,height:undefined,aspectRatio:undefined,backgroundColor:[0,0,0,0]},props),{},{// set image\nbackgroundImage:isString(src)?src:URL.createObjectURL(src)});return shapeLoadResources(shape,oncomplete);};const shapeLoadResources=(shape,oncomplete=noop)=>{if(shape.backgroundImage){// done loading\nif(shape.isComplete){oncomplete(shape.isError,shape);return shape;}// is still loading\nif(shape.isLoading)return shape;// default state before loading\nshape.isComplete=false;shape.isError=false;shape.isLoading=true;// updates the size of the shape relative to the image\nconst updateShapeSize=imageSize=>{// if background size is not set the shape is not locked to the image aspect ratio\nif(shape.backgroundSize)return;// always locked to aspect ratio\nconst aspectRatio=imageSize.width/imageSize.height;// check if width has been defined, if so, we update height to match aspect ratio\nconst width=shape.width||imageSize.width;const height=width/aspectRatio;// set final dimensions\nshape.width=width;shape.height=height;shape.aspectRatio=imageSize.width/imageSize.height;};// now loading\nloadImage(shape.backgroundImage,updateShapeSize).then(image=>{shape.backgroundImageElement=image;}).catch(error=>{shape.isError=error;}).finally(()=>{shape.isLoading=false;shape.isComplete=true;oncomplete(shape.isError,shape);});}return shape;};const shapeCreateFromPreset=(preset,parentRect,oncomplete)=>{let shape;if(isString(preset)||isBinary(preset)){// if is emoji, create default markup,\nif(isEmoji(preset)){// create markup\nshape=shapeCreateFromEmoji(preset,getContextSize(parentRect));setTimeout(()=>oncomplete(undefined,shape),0);}// is URL, create default markup for image\nelse{shape=shapeCreateFromImage(preset,oncomplete,_objectSpread({},getContextSize(parentRect)));}}else{// is using src shortcut\nif(preset.src){// shape options\nconst shapeOptions=_objectSpread(_objectSpread({},preset.shape),getContextSize(parentRect,preset.shape||preset));// emoji markup\nif(isEmoji(preset.src)){shape=shapeCreateFromEmoji(preset.src,shapeOptions);setTimeout(()=>oncomplete(undefined,shape),0);}// is url\nelse if(isString(preset.src)){shape=shapeCreateFromImage(preset.src,oncomplete,shapeOptions);}}// should have markup defined\nelse if(preset.shape){shape=shapeDeepCopy(preset.shape);}}if(hasProp(shape,'backgroundImage')){// set transparent background if no background color defined\nif(!hasProp(shape,'backgroundColor')){shape.backgroundColor=[0,0,0,0];}// for image presets, disable styles by default\nif(!hasProp(shape,'disableStyle')){shape.disableStyle=true;}// by default don't allow flipping\nif(!hasProp(shape,'disableFlip')){shape.disableFlip=true;}}return parentRect?shapeComputeDisplay(shape,parentRect):shape;};const shapeLineGetStartPoint=line=>vectorCreate(line.x1,line.y1);const shapeLineGetEndPoint=line=>vectorCreate(line.x2,line.y2);const shapeTextUID=({text,textAlign,fontSize,fontFamily,lineHeight,fontWeight,fontStyle,fontVariant})=>`${[text,textAlign,fontSize,fontWeight,fontStyle,fontVariant,fontFamily].join('_')}_${isFunction(lineHeight)?lineHeight(fontSize):lineHeight}`;//#endregion\n//#region shape testing\n// shape types\nconst shapeIsText=shape=>hasProp(shape,'text');const shapeIsTextLine=shape=>shapeIsText(shape)&&!(shapeHasRelativeSize(shape)||hasProp(shape,'width'));const shapeIsTextBox=shape=>shapeIsText(shape)&&(shapeHasRelativeSize(shape)||hasProp(shape,'width'));const shapeIsRect=shape=>!shapeIsText(shape)&&shapeHasComputedSize(shape);const shapeIsEllipse=shape=>hasProp(shape,'rx');const shapeIsLine=shape=>hasProp(shape,'x1')&&!shapeIsTriangle(shape);const shapeIsTriangle=shape=>hasProp(shape,'x3');const shapeIsPath=shape=>hasProp(shape,'points');// shape state\nconst shapeIsTextEmpty=shape=>shapeIsText(shape)&&!shape.text.length;const shapeIsTextEditing=shape=>shapeIsText(shape)&&shape.isEditing;const shapeIsVisible=shape=>hasProp(shape,'opacity')?shape.opacity>0:true;const shapeIsSelected=shape=>shape.isSelected;const shapeIsDraft=shape=>shape.isDraft;const shapeHasSize=shape=>hasProp(shape,'width')&&hasProp(shape,'height');const shapeHasNumericStroke=shape=>isNumber(shape.strokeWidth)&&shape.strokeWidth>0;// only relevant if is bigger than 0\nconst shapeHasRelativePosition=shape=>{const hasRight=hasProp(shape,'right');const hasBottom=hasProp(shape,'bottom');return hasRight||hasBottom;};const shapeHasTexture=shape=>hasProp(shape,'backgroundImage')||hasProp(shape,'text');const shapeHasRelativeSize=shape=>(hasProp(shape,'x')||hasProp(shape,'left'))&&hasProp(shape,'right')||(hasProp(shape,'y')||hasProp(shape,'top'))&&hasProp(shape,'bottom');const shapeHasComputedSize=shape=>shapeHasSize(shape)||shapeHasRelativeSize(shape);// actions\nconst shapeSelect=shape=>{shape.isSelected=true;return shape;};const shapeMakeDraft=shape=>{shape.isDraft=true;return shape;};// rights\nconst shapeCanStyle=(shape,style)=>{if(shape.disableStyle===true)return false;if(isArray(shape.disableStyle)){return!shape.disableStyle.includes(style);}return true;};const shapeCanErase=shape=>shape.disableErase!==true;const shapeCanSelect=shape=>shape.disableSelect!==true&&!shapeIsPath(shape)&&!shapeIsTriangle(shape);const shapeCanRemove=shape=>shape.disableRemove!==true;const shapeCanDuplicate=shape=>shape.disableDuplicate!==true&&shapeCanMove(shape);const shapeCanReorder=shape=>shape.disableReorder!==true;const shapeCanFlip=shape=>{if(shape.disableFlip)return false;if(shapeIsDraft(shape)||shapeHasRelativePosition(shape))return false;return shapeHasTexture(shape);};const shapeCanInput=(shape,input)=>{if(!shapeIsText(shape))return false;if(shape.disableInput===true)return false;if(isFunction(shape.disableInput))return shape.disableInput(input!=null?input:shape.text);return input||true;};const shapeCanMove=shape=>shape.disableMove!==true&&!shapeIsDraft(shape)&&!shapeIsPath(shape)&&!shapeHasRelativePosition(shape);const shapeCanResize=shape=>shape.disableResize!==true&&!shapeIsDraft(shape)&&(shapeHasSize(shape)||shapeIsTextBox(shape)||shapeIsEllipse(shape)||shapeIsLine(shape))&&!shapeHasRelativePosition(shape)&&shapeCanMove(shape);const shapeCanRotate=shape=>shape.disableRotate!==true&&!shapeIsDraft(shape)&&(shapeHasSize(shape)||hasProp(shape,'text')||shapeIsEllipse(shape))&&!shapeHasRelativePosition(shape);//#endregion\n//#region shape formatting\nconst shapeDeleteRelativeProps=shape=>{delete shape.left;delete shape.right;delete shape.top;delete shape.bottom;return shape;};const shapeDeleteTransformProps=shape=>{delete shape.rotation;return shape;};const shapeFormatStroke=shape=>{shape.strokeWidth=shape.strokeWidth||1;shape.strokeColor=shape.strokeColor||[0,0,0];return shape;};const shapeFormatFill=shape=>{shape.backgroundColor=shape.backgroundColor?shape.backgroundColor:shape.strokeWidth||shape.backgroundImage?undefined:[0,0,0];return shape;};const autoLineHeight=fontSize=>fontSize*1.2;const shapeFormatText=shape=>{shape.fontSize=shape.fontSize||16;shape.fontFamily=shape.fontFamily||'sans-serif';shape.fontWeight=shape.fontWeight||'normal';shape.fontStyle=shape.fontStyle||'normal';shape.fontVariant=shape.fontVariant||'normal';shape.lineHeight=isNumber(shape.lineHeight)?shape.lineHeight:autoLineHeight;shape.color=shape.color||[0,0,0];return shapeIsTextLine(shape)?shapeFormatTextLine(shape):shapeFormatTextBox(shape);};const shapeFormatTextLine=shape=>{delete shape.textAlign;return shapeDeleteRelativeProps(shape);};const shapeFormatTextBox=shape=>{shape.textAlign=shape.textAlign||'left';return shape;};const shapeFormatRect=shape=>{shape.cornerRadius=shape.cornerRadius||0;shape.strokeWidth=shape.strokeWidth||0;shape.strokeColor=shape.strokeColor||[0,0,0];return shapeFormatFill(shape);};const shapeFormatTriangle=shape=>{shape.strokeWidth=shape.strokeWidth||0;shape.strokeColor=shape.strokeColor||[0,0,0];shapeFormatFill(shape);return shapeDeleteRelativeProps(shape);};const shapeFormatEllipse=shape=>{shape.strokeWidth=shape.strokeWidth||0;shape.strokeColor=shape.strokeColor||[0,0,0];return shapeFormatFill(shape);};const shapeFormatPath=shape=>{shapeFormatStroke(shape);shapeDeleteTransformProps(shape);return shapeDeleteRelativeProps(shape);};const shapeFormatLine=shape=>{shapeFormatStroke(shape);shape.lineStart=shape.lineStart||undefined;shape.lineEnd=shape.lineEnd||undefined;shapeDeleteTransformProps(shape);return shapeDeleteRelativeProps(shape);};const shapeFormatDefaults=shape=>{if(!isString(shape.id))shape.id=getUniqueId();if(!hasProp(shape,'rotation'))shape.rotation=0;if(!hasProp(shape,'opacity'))shape.opacity=1;if(!hasProp(shape,'disableErase'))shape.disableErase=true;};const shapeFormat=shape=>{shapeFormatDefaults(shape);if(shapeIsText(shape)){shapeFormatText(shape);}else if(shapeIsRect(shape)){shapeFormatRect(shape);}else if(shapeIsPath(shape)){shapeFormatPath(shape);}else if(shapeIsLine(shape)){shapeFormatLine(shape);}else if(shapeIsEllipse(shape)){shapeFormatEllipse(shape);}else if(shapeIsTriangle(shape)){shapeFormatTriangle(shape);}shapeLoadResources(shape);return shape;};const shapeGetDescription=shape=>{if(shapeIsText(shape)){return'text';}else if(shapeIsRect(shape)){return'rectangle';}else if(shapeIsPath(shape)){return'path';}else if(shapeIsLine(shape)){return'line';}else if(shapeIsEllipse(shape)){return'ellipse';}else if(shapeIsTriangle(shape)){return'triangle';}return;};//#endregion\nconst toPixelValue=(percentage,total)=>parseFloat(percentage)/100*total;//#region shape transforming\nconst shapeComputeValue=(shape,prop,{width,height})=>{if(!hasProp(shape,prop))return;let value=shape[prop];if(/points/.test(prop)){const arr=shape[prop];if(!isString(arr[0].x))return;shape[prop]=arr.map(p=>vectorCreate(toPixelValue(p.x,width),toPixelValue(p.y,height)));}else if(isString(value)){const f=parseFloat(value)/100;if(/^x|left|width|rx|fontSize|cornerRadius|strokeWidth/.test(prop))shape[prop]=width*f;else if(/^right/.test(prop))shape[prop]=width-width*f;else if(/^y|top|height|ry/.test(prop))shape[prop]=height*f;else if(/^bottom/.test(prop))shape[prop]=height-height*f;}};const displayProps=['width','height','left','top','right','bottom','x','y','rx','ry','points','fontSize','strokeWidth','lineHeight','x1','y1','x2','y2','x3','y3'];const shapeComputeDisplay=(shape,parentRect)=>{displayProps.forEach(prop=>shapeComputeValue(shape,prop,parentRect));shapeComputeRect(shape,parentRect);return shape;};const shapeGetPropPixelTotal=(prop,parentRect)=>{let total;if(/^x|width|rx|fontSize|strokeWidth|cornerRadius/.test(prop)){total=parentRect.width;}else if(/^y|height|ry/.test(prop)){total=parentRect.height;}return total;};const shapeUpdateProp=(shape,prop,value,parentRect)=>{if(!isString(shape[prop]))return shape[prop]=value;let total=shapeGetPropPixelTotal(prop,parentRect);shape[prop]=toPercentage(value,total);return shape;};const shapeGetPropPixelValue=(shape,prop,parentRect)=>{if(!isString(shape[prop]))return shape[prop];return toPixelValue(shape[prop],shapeGetPropPixelTotal(prop,parentRect));};const shapeGetPropsPixelValues=(shape,props,parentRect)=>{return props.reduce((prev,prop)=>{const value=shapeGetPropPixelValue(shape,prop,parentRect);prev[prop]=value;return prev;},{});};const shapeUpdateProps=(shape,props,parentRect)=>{Object.keys(props).forEach(key=>shapeUpdateProp(shape,key,props[key],parentRect));return shape;};const shapeComputeRect=(shape,parentRect)=>{if(hasProp(shape,'left'))shape.x=shape.left;if(hasProp(shape,'right')){const r=parentRect.width-shape.right;if(hasProp(shape,'left')){shape.x=shape.left;shape.width=Math.max(0,r-shape.left);}else if(hasProp(shape,'width')){shape.x=r-shape.width;}}if(hasProp(shape,'top'))shape.y=shape.top;if(hasProp(shape,'bottom')){const b=parentRect.height-shape.bottom;if(hasProp(shape,'top')){shape.y=shape.top;shape.height=Math.max(0,b-shape.top);}else if(hasProp(shape,'height')){shape.y=b-shape.height;}}return shape;};const shapeComputeTransform=(shape,translate,scale)=>{if(shapeIsPath(shape)){shape.points.filter(point=>isNumber(point.x)).forEach(point=>{point.x*=scale;point.y*=scale;point.x+=translate.x;point.y+=translate.y;});}if(shapeIsTriangle(shape)&&isNumber(shape.x1)){shape.x1*=scale;shape.y1*=scale;shape.x2*=scale;shape.y2*=scale;shape.x3*=scale;shape.y3*=scale;shape.x1+=translate.x;shape.y1+=translate.y;shape.x2+=translate.x;shape.y2+=translate.y;shape.x3+=translate.x;shape.y3+=translate.y;}if(shapeIsLine(shape)&&isNumber(shape.x1)){shape.x1*=scale;shape.y1*=scale;shape.x2*=scale;shape.y2*=scale;shape.x1+=translate.x;shape.y1+=translate.y;shape.x2+=translate.x;shape.y2+=translate.y;}if(isNumber(shape.x)&&isNumber(shape.y)){shape.x*=scale;shape.y*=scale;shape.x+=translate.x;shape.y+=translate.y;}if(isNumber(shape.width)&&isNumber(shape.height)){shape.width*=scale;shape.height*=scale;}if(isNumber(shape.rx)&&isNumber(shape.ry)){shape.rx*=scale;shape.ry*=scale;}if(shapeHasNumericStroke(shape)){shape.strokeWidth*=scale;}if(shapeIsText(shape)&&isNumber(shape.fontSize)){shape.fontSize*=scale;if(isNumber(shape.width))shape.width*=scale;}if(hasProp(shape,'cornerRadius')&&isNumber(shape.cornerRadius)){shape.cornerRadius*=scale;}return shape;};const shapeGetCenter=shape=>{if(shapeIsRect(shape)){return vectorCreate(shape.x+shape.width*0.5,shape.y+shape.height*0.5);}if(shapeIsEllipse(shape)){return vectorCreate(shape.x,shape.y);}if(shapeIsTextBox(shape)){const height=shape.height||textSize(shape.text,shape).height;return vectorCreate(shape.x+shape.width*0.5,shape.y+height*0.5);}if(shapeIsTextLine(shape)){const size=textSize(shape.text,shape);return vectorCreate(shape.x+size.width*0.5,shape.y+size.height*0.5);}if(shapeIsPath(shape)){return vectorCenter(shape.points);}if(shapeIsLine(shape)){return vectorCenter([shapeLineGetStartPoint(shape),shapeLineGetEndPoint(shape)]);}return undefined;};const shapeComputeLineEnd=(position,strokeWidth,color,style,direction)=>{let shape={};const isSolid=/solid/.test(style);const scaledSize=5*strokeWidth;const s=isSolid?scaledSize:scaledSize-1;const sh=isSolid?s*0.5:Math.ceil(s*0.5);const normal=vectorNormalize(direction);const offset=vectorMultiply(vectorClone(normal),sh);const anchor=vectorClone(position);const positionUpdated=vectorClone(position);if(/arrow/.test(style)){let x=position.x;let y=position.y;const tipOffset=vectorMultiply(vectorClone(normal),scaledSize);const inset=vectorCreate(x+tipOffset.x,y+tipOffset.y);vectorMultiply(tipOffset,0.55);if(isSolid){const arrowOffset=vectorMultiply(vectorClone(normal),sh*0.5);x-=arrowOffset.x;y-=arrowOffset.y;shape={points:[vectorCreate(x,y),vectorCreate(inset.x-tipOffset.y,inset.y+tipOffset.x),vectorCreate(inset.x+tipOffset.y,inset.y-tipOffset.x)],backgroundColor:color};// move back so arrow triangle overlaps with end of line (otherwise line sticks out of triangle tip)\npositionUpdated.x+=offset.x;positionUpdated.y+=offset.y;}else{// this prevents trouble with sharp line rendering in webgl\nconst p=vectorMultiply(vectorPerpendicular(vectorClone(normal)),0.5);const tipLeft=vectorCreate(x-p.x,y-p.y);const tipRight=vectorCreate(x+p.x,y+p.y);shape={points:[vectorCreate(inset.x+tipOffset.y,inset.y-tipOffset.x),tipLeft,vectorCreate(x,y),tipRight,vectorCreate(inset.x-tipOffset.y,inset.y+tipOffset.x)],strokeWidth:strokeWidth,strokeColor:color};}}else if(/circle/.test(style)){// adjust line point offset\npositionUpdated.x+=offset.x;positionUpdated.y+=offset.y;// add line cap\nshape={x:anchor.x,y:anchor.y,rx:sh,ry:sh,backgroundColor:isSolid?color:undefined,strokeWidth:isSolid?undefined:strokeWidth,strokeColor:isSolid?undefined:color};}else if(/square/.test(style)){// adjust line point offset\npositionUpdated.x+=offset.x;positionUpdated.y+=offset.y;shape={x:anchor.x-sh,y:anchor.y-sh,width:sh*2,height:sh*2,rotation:vectorAngle(normal),backgroundColor:isSolid?color:undefined,strokeWidth:isSolid?undefined:strokeWidth,strokeColor:isSolid?undefined:color};}else if(style==='bar'){shape={points:[vectorCreate(anchor.x-offset.y,anchor.y+offset.x),vectorCreate(anchor.x+offset.y,anchor.y-offset.x)],strokeWidth:strokeWidth,strokeColor:color};}return{position:positionUpdated,shape};};//#endregion\nvar ctxRoundRect=(ctx,x,y,width,height,radius)=>{if(width<2*radius)radius=width/2;if(height<2*radius)radius=height/2;ctx.beginPath();ctx.moveTo(x+radius,y);ctx.arcTo(x+width,y,x+width,y+height,radius);ctx.arcTo(x+width,y+height,x,y+height,radius);ctx.arcTo(x,y+height,x,y,radius);ctx.arcTo(x,y,x+width,y,radius);ctx.closePath();return ctx;};const defineRectShape=(ctx,shape)=>{shape.cornerRadius>0?ctxRoundRect(ctx,shape.x,shape.y,shape.width,shape.height,shape.cornerRadius):ctx.rect(shape.x,shape.y,shape.width,shape.height);return ctx;};const fillRectShape=(ctx,shape)=>{shape.backgroundColor&&ctx.fill();return ctx;};const strokeRectShape=(ctx,shape)=>{shape.strokeWidth&&ctx.stroke();return ctx;};var drawRect=async(ctx,shape)=>new Promise((resolve,reject)=>{ctx.lineWidth=shape.strokeWidth?shape.strokeWidth:1;// 1 is default value for lineWidth prop\nctx.strokeStyle=shape.strokeColor?colorArrayToRGBA(shape.strokeColor):'none';ctx.fillStyle=shape.backgroundColor?colorArrayToRGBA(shape.backgroundColor):'none';ctx.globalAlpha=shape.opacity;if(shape.backgroundImage){shapeLoadResources(shape,(error,shape)=>{if(error)return reject(error);let sX=0;let sY=0;let sWidth=shape.backgroundImageElement.naturalWidth;let sHeight=shape.backgroundImageElement.naturalHeight;let dX=shape.x;let dY=shape.y;let dWidth=shape.width;let dHeight=shape.height;if(shape.backgroundSize==='contain'){const rect=rectContainRect(shape,sWidth/sHeight);dWidth=rect.width;dHeight=rect.height;dX+=rect.x;dY+=rect.y;}else if(shape.backgroundSize==='cover'){const rect=rectContainRect(rectCreate(0,0,sWidth,sHeight),dWidth/dHeight);sWidth=rect.width;sHeight=rect.height;sX=rect.x;sY=rect.y;}defineRectShape(ctx,shape);fillRectShape(ctx,shape);ctx.save();ctx.clip();ctx.drawImage(shape.backgroundImageElement,sX,sY,sWidth,sHeight,dX,dY,dWidth,dHeight);ctx.restore();strokeRectShape(ctx,shape);resolve([]);});}else{defineRectShape(ctx,shape);fillRectShape(ctx,shape);strokeRectShape(ctx,shape);resolve([]);}});var drawEllipse=async(ctx,shape)=>new Promise((resolve,reject)=>{ctx.lineWidth=shape.strokeWidth||1;// 1 is default value for lineWidth prop\nctx.strokeStyle=shape.strokeColor?colorArrayToRGBA(shape.strokeColor):'none';ctx.fillStyle=shape.backgroundColor?colorArrayToRGBA(shape.backgroundColor):'none';ctx.globalAlpha=shape.opacity;ctx.ellipse(shape.x,shape.y,shape.rx,shape.ry,0,0,Math.PI*2);shape.backgroundColor&&ctx.fill();if(shape.backgroundImage){shapeLoadResources(shape,(error,image)=>{if(error)return reject(error);ctx.drawImage(image.backgroundImageElement,shape.x,shape.y,shape.width,shape.height);shape.strokeWidth&&ctx.stroke();resolve([]);});}else{shape.strokeWidth&&ctx.stroke();}resolve([]);});var drawText$1=async(ctx,shape)=>{const size=shape.width&&shape.height?sizeCreateFromAny(shape):textSize(shape.text,shape);const rect={x:shape.x,y:shape.y,width:shape.width||size.width,height:size.height};drawRect(ctx,_objectSpread(_objectSpread({},shape),rect));updateTextContext(ctx,shape);let tx=0;if(shape.textAlign=='center'){tx=-textPadding*0.5;}else if(shape.textAlign==='right'){tx=-textPadding;}ctx.rect(shape.x+tx,shape.y,shape.width+textPadding*2,shape.height);ctx.save();ctx.clip();drawText(ctx,shape.width?wrapText(ctx,shape.text,shape.width):shape.text,{x:shape.x,y:shape.y,fontSize:shape.fontSize,textAlign:shape.textAlign,lineHeight:shape.lineHeight,lineWidth:shape.width});ctx.restore();return[];};var drawLine=async(ctx,shape)=>new Promise(async(resolve,reject)=>{ctx.lineWidth=shape.strokeWidth||1;// 1 is default value for lineWidth prop\nctx.strokeStyle=shape.strokeColor?colorArrayToRGBA(shape.strokeColor):'none';ctx.globalAlpha=shape.opacity;let lineStartPosition=shapeLineGetStartPoint(shape);let lineEndPosition=shapeLineGetEndPoint(shape);const lineStartDescription=shape.lineStart&&shapeComputeLineEnd(lineStartPosition,shape.strokeWidth,shape.strokeColor,shape.lineStart,vectorCreate(lineEndPosition.x-lineStartPosition.x,lineEndPosition.y-lineStartPosition.y));const lineEndDescription=shape.lineEnd&&shapeComputeLineEnd(lineEndPosition,shape.strokeWidth,shape.strokeColor,shape.lineEnd,vectorCreate(lineStartPosition.x-lineEndPosition.x,lineStartPosition.y-lineEndPosition.y));// update start and end position of line if required to draw caps\nlineStartPosition=lineStartDescription?lineStartDescription.position:lineStartPosition;lineEndPosition=lineEndDescription?lineEndDescription.position:lineEndPosition;// draw line\nctx.moveTo(lineStartPosition.x,lineStartPosition.y);ctx.lineTo(lineEndPosition.x,lineEndPosition.y);shape.strokeWidth&&ctx.stroke();// draw other shapes\nresolve([lineStartDescription&&lineStartDescription.shape,lineEndDescription&&lineEndDescription.shape].filter(Boolean));});var drawPath=async(ctx,shape)=>new Promise((resolve,reject)=>{ctx.lineWidth=shape.strokeWidth||1;// 1 is default value for lineWidth prop\nctx.strokeStyle=shape.strokeColor?colorArrayToRGBA(shape.strokeColor):'none';ctx.fillStyle=shape.backgroundColor?colorArrayToRGBA(shape.backgroundColor):'none';ctx.globalAlpha=shape.opacity;// draw line\nconst{points}=shape;ctx.moveTo(points[0].x,points[0].y);const l=points.length;for(let i=1;i<l;i++){ctx.lineTo(points[i].x,points[i].y);}shape.strokeWidth&&ctx.stroke();shape.backgroundColor&&ctx.fill();resolve([]);});var ctxFlip=(ctx,flipX,flipY,pivot)=>{if(!flipX&&!flipY)return ctx;ctx.translate(pivot.x,pivot.y);ctx.scale(flipX?-1:1,flipY?-1:1);ctx.translate(-pivot.x,-pivot.y);return ctx;};const drawShape=async(ctx,shape)=>{// center, needed for transforms\nconst center=shapeGetCenter(shape);// rotate context\nctxRotate(ctx,shape.rotation,center);// flip context\nctxFlip(ctx,shape.flipX,shape.flipY,center);let fn;if(shapeIsRect(shape)){fn=drawRect;}else if(shapeIsEllipse(shape)){fn=drawEllipse;}else if(shapeIsLine(shape)){fn=drawLine;}else if(shapeIsPath(shape)){fn=drawPath;}else if(shapeIsText(shape)){fn=drawText$1;}// get shapes\nreturn[shape,...(await drawShapes(ctx,await fn(ctx,shape)))];};var drawShapes=async(ctx,shapes)=>{let drawnShapes=[];for(const shape of shapes){ctx.save();// clears previous shape's path\nctx.beginPath();// wait for shape to draw before drawing next shape\ndrawnShapes=[...drawnShapes,...(await drawShape(ctx,shape))];ctx.restore();}return drawnShapes;};var drawImageData=async(imageData,options={})=>{const{shapes=[],context=imageData,transform=noop}=options;// no shapes to draw\nif(!shapes.length)return imageData;// output\nlet imageDataOut;// create drawing context\nconst canvas=h('canvas');canvas.width=imageData.width;canvas.height=imageData.height;const ctx=canvas.getContext('2d');ctx.putImageData(imageData,0,0);// compute the position of all shapes\nconst computedShapes=shapes.map(shapeDeepCopy).map(shape=>shapeComputeDisplay(shape,{x:0,y:0,width:context.width,height:context.height}));// compute transforms for all shapes\ntransform(ctx);// draw shapes to canvas\nawait drawShapes(ctx,computedShapes);imageDataOut=ctx.getImageData(0,0,canvas.width,canvas.height);releaseCanvas(canvas);return imageDataOut;};var fillImageData=async(imageData,options={})=>{const{backgroundColor}=options;// no background color set or is fully transparent background color\nif(!backgroundColor||backgroundColor&&backgroundColor[3]===0)return imageData;// fill\nlet imageDataOut;let image=h('canvas');image.width=imageData.width;image.height=imageData.height;const ctx=image.getContext('2d');ctx.putImageData(imageData,0,0);// fill behind image\nctx.globalCompositeOperation='destination-over';ctx.fillStyle=colorArrayToRGBA(backgroundColor);ctx.fillRect(0,0,image.width,image.height);imageDataOut=ctx.getImageData(0,0,image.width,image.height);releaseCanvas(image);return imageDataOut;};var dotColorMatrix=(a,b)=>{const res=new Array(20);// R\nres[0]=a[0]*b[0]+a[1]*b[5]+a[2]*b[10]+a[3]*b[15];res[1]=a[0]*b[1]+a[1]*b[6]+a[2]*b[11]+a[3]*b[16];res[2]=a[0]*b[2]+a[1]*b[7]+a[2]*b[12]+a[3]*b[17];res[3]=a[0]*b[3]+a[1]*b[8]+a[2]*b[13]+a[3]*b[18];res[4]=a[0]*b[4]+a[1]*b[9]+a[2]*b[14]+a[3]*b[19]+a[4];// G\nres[5]=a[5]*b[0]+a[6]*b[5]+a[7]*b[10]+a[8]*b[15];res[6]=a[5]*b[1]+a[6]*b[6]+a[7]*b[11]+a[8]*b[16];res[7]=a[5]*b[2]+a[6]*b[7]+a[7]*b[12]+a[8]*b[17];res[8]=a[5]*b[3]+a[6]*b[8]+a[7]*b[13]+a[8]*b[18];res[9]=a[5]*b[4]+a[6]*b[9]+a[7]*b[14]+a[8]*b[19]+a[9];// B\nres[10]=a[10]*b[0]+a[11]*b[5]+a[12]*b[10]+a[13]*b[15];res[11]=a[10]*b[1]+a[11]*b[6]+a[12]*b[11]+a[13]*b[16];res[12]=a[10]*b[2]+a[11]*b[7]+a[12]*b[12]+a[13]*b[17];res[13]=a[10]*b[3]+a[11]*b[8]+a[12]*b[13]+a[13]*b[18];res[14]=a[10]*b[4]+a[11]*b[9]+a[12]*b[14]+a[13]*b[19]+a[14];// A\nres[15]=a[15]*b[0]+a[16]*b[5]+a[17]*b[10]+a[18]*b[15];res[16]=a[15]*b[1]+a[16]*b[6]+a[17]*b[11]+a[18]*b[16];res[17]=a[15]*b[2]+a[16]*b[7]+a[17]*b[12]+a[18]*b[17];res[18]=a[15]*b[3]+a[16]*b[8]+a[17]*b[13]+a[18]*b[18];res[19]=a[15]*b[4]+a[16]*b[9]+a[17]*b[14]+a[18]*b[19]+a[19];return res;};var getColorMatrixFromColorMatrices=colorMatrices=>colorMatrices.length?colorMatrices.reduce((previous,current)=>dotColorMatrix([...previous],current),colorMatrices.shift()):[];// connect function in process chain\nconst connect=(fn,getter=(...args)=>args,setter)=>async(state,options,onprogress)=>{// will hold function result\nlet res;// at this point we don't know if the length of this task can be computed\nonprogress(createProgressEvent(0,false));// try to run the function\nlet progressUpdated=false;try{res=await fn(...getter(state,options,event=>{progressUpdated=true;onprogress(event);}));}catch(err){throw err;}// a setter isn't required\nsetter&&setter(state,res);// if progress was updated, we expect the connected function to fire the 1/1 event, else we fire it here\nif(!progressUpdated)onprogress(createProgressEvent(1,false));return state;};//\n// Reader/Writer Presets\n//\nconst AnyToFile=({srcProp='src',destProp='dest'}={})=>[connect(srcToFile,(state,options,onprogress)=>[state[srcProp],onprogress],(state,file)=>state[destProp]=file),'any-to-file'];const BlobReadImageSize=({srcProp='src',destProp='size'}={})=>[connect(getImageSize,(state,options)=>[state[srcProp]],(state,size)=>state[destProp]=size),'read-image-size'];const ImageSizeMatchOrientation=({srcSize='size',srcOrientation='orientation',destSize='size'}={})=>[connect(orientImageSize,state=>[state[srcSize],state[srcOrientation]],(state,size)=>state[destSize]=size),'image-size-match-orientation'];const BlobReadImageHead=({srcProp='src',destProp='head'}={})=>[connect((blob,slice)=>isJPEG(blob)?blobReadSection(blob,slice):undefined,// 64 * 1024 should be enough bytes to find orientation header in next step\n// Exif metadata are restricted in size to 64 kB in JPEG images because according to the specification this information must be contained within a single JPEG APP1 segment.\nstate=>[state[srcProp],[0,64*1024],onprogress],(state,head)=>state[destProp]=head),'read-image-head'];const ImageHeadReadExifOrientationTag=({srcProp='head',destProp='orientation'}={})=>[connect(arrayBufferReadExifOrientationTag,state=>[state[srcProp]],(state,orientation)=>state[destProp]=orientation),'read-exif-orientation-tag'];const ImageHeadClearExifOrientationTag=({srcProp='head'}={})=>[connect(arrayBufferWriteExifOrientationTag,state=>[state[srcProp],1]),'clear-exif-orientation-tag'];const ApplyCanvasScalar=({srcImageSize='size',srcCanvasSize='imageData',srcImageState='imageState',destImageSize='size',destScalar='scalar'}={})=>[connect((naturalSize,canvasSize,imageState)=>{// calculate canvas scalar\nconst scalar=Math.min(canvasSize.width/naturalSize.width,canvasSize.height/naturalSize.height);// done because not scaling\nif(scalar!==1){const{crop,annotation,decoration}=imageState;// origin to scale to\nconst origin=vectorCreateEmpty();// scale select.crop\nif(crop)imageState.crop=rectScale(crop,scalar,origin);// scale annotation\nconst translate=vectorCreateEmpty();imageState.annotation=annotation.map(shape=>shapeComputeTransform(shape,translate,scalar));// scale decoration\nimageState.decoration=decoration.map(shape=>shapeComputeTransform(shape,translate,scalar));}return[scalar,sizeCreateFromAny(canvasSize)];},state=>[state[srcImageSize],state[srcCanvasSize],state[srcImageState]],(state,[scalar,imageSize])=>{state[destScalar]=scalar;state[destImageSize]=imageSize;}),'calculate-canvas-scalar'];const BlobToImageData=({srcProp='src',destProp='imageData',canvasMemoryLimit=undefined})=>[connect(blobToImageData,state=>[state[srcProp],canvasMemoryLimit],(state,imageData)=>state[destProp]=imageData),'blob-to-image-data'];const ImageDataMatchOrientation=({srcImageData='imageData',srcOrientation='orientation'}={})=>[connect(orientImageData,state=>[state[srcImageData],state[srcOrientation]],(state,imageData)=>state.imageData=imageData),'image-data-match-orientation'];const ImageDataFill=({srcImageData='imageData',srcImageState='imageState'}={})=>[connect(fillImageData,state=>[state[srcImageData],{backgroundColor:state[srcImageState].backgroundColor}],(state,imageData)=>state.imageData=imageData),'image-data-fill'];const ImageDataCrop=({srcImageData='imageData',srcImageState='imageState'}={})=>[connect(cropImageData,state=>[state[srcImageData],{crop:state[srcImageState].crop,rotation:state[srcImageState].rotation,flipX:state[srcImageState].flipX,flipY:state[srcImageState].flipY}],(state,imageData)=>state.imageData=imageData),'image-data-crop'];const ImageDataResize=({resize={width:undefined,height:undefined,fit:undefined,upscale:undefined},srcProp='imageData',srcImageState='imageState',destImageScaledSize='imageScaledSize'})=>[connect(resizeImageData,state=>[state[srcProp],{width:Math.min(resize.width||Number.MAX_SAFE_INTEGER,state[srcImageState].targetSize&&state[srcImageState].targetSize.width||Number.MAX_SAFE_INTEGER),height:Math.min(resize.height||Number.MAX_SAFE_INTEGER,state[srcImageState].targetSize&&state[srcImageState].targetSize.height||Number.MAX_SAFE_INTEGER),fit:resize.fit||'contain',upscale:resize.upscale||false}],(state,imageData)=>{if(!sizeEqual(state.imageData,imageData))state[destImageScaledSize]=sizeCreateFromAny(imageData);state.imageData=imageData;}),'image-data-resize'];const ImageDataFilter=({srcImageData='imageData',srcImageState='imageState',destImageData='imageData'}={})=>[connect(filterImageData,state=>{const{colorMatrix}=state[srcImageState];const colorMatrices=colorMatrix&&Object.keys(colorMatrix).map(name=>colorMatrix[name]).filter(Boolean);return[state[srcImageData],{colorMatrix:colorMatrices&&getColorMatrixFromColorMatrices(colorMatrices),convolutionMatrix:state[srcImageState].convolutionMatrix,gamma:state[srcImageState].gamma,noise:state[srcImageState].noise,vignette:state[srcImageState].vignette}];},(state,imageData)=>state[destImageData]=imageData),'image-data-filter'];const ImageDataAnnotate=({srcImageData='imageData',srcSize='size',srcImageState='imageState',destImageData='imageData',destImageScaledSize='imageScaledSize'}={})=>[connect(drawImageData,state=>[state[srcImageData],{shapes:state[srcImageState].annotation,context:state[srcSize],transform:ctx=>{const imageSize=state[srcSize];const{crop=rectCreateFromSize(imageSize),rotation=0,flipX,flipY}=state[srcImageState];const rotatedRect=getImageTransformedRect(imageSize,rotation);const rotatedSize={width:rotatedRect.width,height:rotatedRect.height};// calculate image scalar so we can scale annotations accordingly\nconst scaledSize=state[destImageScaledSize];const scalar=scaledSize?Math.min(scaledSize.width/crop.width,scaledSize.height/crop.height):1;// calculate center\nconst dx=imageSize.width*0.5-rotatedSize.width*0.5;const dy=imageSize.height*0.5-rotatedSize.height*0.5;const center=sizeCenter(imageSize);// image scalar\nctx.scale(scalar,scalar);// offset\nctx.translate(-dx,-dy);ctx.translate(-crop.x,-crop.y);// rotation\nctx.translate(center.x,center.y);ctx.rotate(rotation);ctx.translate(-center.x,-center.y);// flipping\nctx.scale(flipX?-1:1,flipY?-1:1);ctx.translate(flipX?-imageSize.width:0,flipY?-imageSize.height:0);// annotations are clipped clip to image\nctx.rect(0,0,imageSize.width,imageSize.height);ctx.clip();}}],(state,imageData)=>state[destImageData]=imageData),'image-data-annotate'];const ImageDataDecorate=({srcImageData='imageData',srcImageState='imageState',destImageData='imageData',destImageScaledSize='imageScaledSize'}={})=>[connect(drawImageData,state=>[state[srcImageData],{shapes:state[srcImageState].decoration,context:state[srcImageState].crop,transform:ctx=>{// calculate image scalar so we can scale decoration accordingly\nconst{crop}=state.imageState;const scaledSize=state[destImageScaledSize];const scalar=scaledSize?Math.min(scaledSize.width/crop.width,scaledSize.height/crop.height):1;ctx.scale(scalar,scalar);}}],(state,imageData)=>state[destImageData]=imageData),'image-data-decorate'];const ImageDataToBlob=({mimeType=undefined,quality=undefined,srcImageData='imageData',srcFile='src',destBlob='blob'}={})=>[connect(imageDataToBlob,state=>[state[srcImageData],mimeType||getMimeTypeFromFilename(state[srcFile].name)||state[srcFile].type,quality],(state,blob)=>state[destBlob]=blob),'image-data-to-blob'];const BlobWriteImageHead=(srcBlob='blob',srcHead='head',destBlob='blob')=>[connect((blob,head)=>isJPEG(blob)&&head?blobWriteSection(blob,arrayBufferReadImageHead(head),// location and size of the JPEG header\n[20]):blob,state=>[state[srcBlob],state[srcHead]],(state,blob)=>state[destBlob]=blob),'blob-write-image-head'];const BlobToFile=({renameFile=undefined,srcBlob='blob',srcFile='src',destFile='dest',defaultFilename=undefined}={})=>[connect(blobToFile,state=>[state[srcBlob],renameFile?renameFile(state[srcFile]):state[srcFile].name||`${defaultFilename}.${getExtensionFromMimeType(state[srcBlob].type)}`],(state,file)=>state[destFile]=file),'blob-to-file'];const Store=({url='./',dataset=state=>[['dest',state.dest,state.dest.name],['imageState',state.imageState]],destStore='store'})=>[connect(// upload function\nasync(dataset,onprogress)=>{try{return await post(url,dataset,{onprogress});}catch(err){throw err;}},// get state values\n(state,options,onprogress)=>[dataset(state),onprogress],// set state values\n(state,xhr)=>state[destStore]=xhr// logs XHR request returned by `post`\n),'store'];const PropFilter=allowlist=>[connect(state=>{// if no allowlist suppleid or is empty array we don't filter\nif(!allowlist||!allowlist.length)return state;// else we only allow the props defined in the list and delete non matching props\nObject.keys(state).forEach(key=>{if(allowlist.includes(key))return;delete state[key];});return state;}),'prop-filter'];// Generic image reader, suitable for most use cases\nconst createDefaultImageReader=(options={})=>{const{orientImage=true,outputProps=['src','dest','size'],preprocessImageFile}=options;return[// can read most source files and turn them into blobs\nAnyToFile(),// TODO: test if supported mime/type\n// called when file created, can be used to read unrecognized files\npreprocessImageFile&&[connect(preprocessImageFile,(state,options,onprogress)=>[state.dest,options,onprogress],(state,file)=>state.dest=file),'preprocess-image-file'],// quickly read size (only reads first part of image)\nBlobReadImageSize({srcProp:'dest'}),// fix image orientation\norientImage&&BlobReadImageHead({srcProp:'dest'}),orientImage&&ImageHeadReadExifOrientationTag(),orientImage&&ImageSizeMatchOrientation(),// remove unwanted props\nPropFilter(outputProps)].filter(Boolean);};// Generic image writer, suitable for most use cases\nconst createDefaultImageWriter=(options={})=>{const{canvasMemoryLimit=isIOS()?4096*4096:Infinity,orientImage=true,copyImageHead=true,mimeType=undefined,quality=undefined,renameFile=undefined,targetSize=undefined,store=undefined,outputProps=['src','dest','imageState','store'],preprocessImageState,postprocessImageData}=options;return[// get orientation info (if is jpeg)\n(orientImage||copyImageHead)&&BlobReadImageHead(),orientImage&&ImageHeadReadExifOrientationTag(),// get image size\nBlobReadImageSize(),// allow preproccesing of image state for example to replace placeholders\npreprocessImageState&&[connect(preprocessImageState,(state,options,onprogress)=>[state.imageState,options,onprogress],(state,imageState)=>state.imageState=imageState),'preprocess-image-state'],// get image data\nBlobToImageData({canvasMemoryLimit}),// get canvas scalar for when scaled down\nApplyCanvasScalar(),// fix image orientation\norientImage&&ImageSizeMatchOrientation(),orientImage&&ImageDataMatchOrientation(),// apply image state\nImageDataCrop(),ImageDataResize({resize:targetSize}),ImageDataFilter(),ImageDataFill(),ImageDataAnnotate(),ImageDataDecorate(),// run post processing on image data, for example to apply circular crop\npostprocessImageData&&[connect(postprocessImageData,(state,options,onprogress)=>[state.imageData,options,onprogress],(state,imageData)=>state.imageData=imageData),'postprocess-image-data'],// convert to file\nImageDataToBlob({mimeType,quality}),// we overwite the exif orientation tag so the image is oriented correctly\norientImage&&ImageHeadClearExifOrientationTag(),// we write the new image head to the target blob\ncopyImageHead&&BlobWriteImageHead(),// turn the image blob into a file, will also rename the file\nBlobToFile({defaultFilename:'image',renameFile}),// upload or process data\nstore&&(isString(store)?// a basic store to post to\nStore({url:store}):// see if is fully custom or store config\nisFunction(store)?// fully custom store function\n[store,'store']:// a store configuration object\nStore(store)),// remove unwanted props\nPropFilter(outputProps)].filter(Boolean);};function noop$1(){}const identity=x=>x;function assign(tar,src){// @ts-ignore\nfor(const k in src)tar[k]=src[k];return tar;}function run(fn){return fn();}function blank_object(){return Object.create(null);}function run_all(fns){fns.forEach(run);}function is_function(thing){return typeof thing==='function';}function safe_not_equal(a,b){return a!=a?b==b:a!==b||a&&typeof a==='object'||typeof a==='function';}function is_empty(obj){return Object.keys(obj).length===0;}function subscribe(store,...callbacks){if(store==null){return noop$1;}const unsub=store.subscribe(...callbacks);return unsub.unsubscribe?()=>unsub.unsubscribe():unsub;}function get_store_value(store){let value;subscribe(store,_=>value=_)();return value;}function component_subscribe(component,store,callback){component.$$.on_destroy.push(subscribe(store,callback));}function create_slot(definition,ctx,$$scope,fn){if(definition){const slot_ctx=get_slot_context(definition,ctx,$$scope,fn);return definition[0](slot_ctx);}}function get_slot_context(definition,ctx,$$scope,fn){return definition[1]&&fn?assign($$scope.ctx.slice(),definition[1](fn(ctx))):$$scope.ctx;}function get_slot_changes(definition,$$scope,dirty,fn){if(definition[2]&&fn){const lets=definition[2](fn(dirty));if($$scope.dirty===undefined){return lets;}if(typeof lets==='object'){const merged=[];const len=Math.max($$scope.dirty.length,lets.length);for(let i=0;i<len;i+=1){merged[i]=$$scope.dirty[i]|lets[i];}return merged;}return $$scope.dirty|lets;}return $$scope.dirty;}function update_slot(slot,slot_definition,ctx,$$scope,dirty,get_slot_changes_fn,get_slot_context_fn){const slot_changes=get_slot_changes(slot_definition,$$scope,dirty,get_slot_changes_fn);if(slot_changes){const slot_context=get_slot_context(slot_definition,ctx,$$scope,get_slot_context_fn);slot.p(slot_context,slot_changes);}}function exclude_internal_props(props){const result={};for(const k in props)if(k[0]!=='$')result[k]=props[k];return result;}function set_store_value(store,ret,value=ret){store.set(value);return ret;}function action_destroyer(action_result){return action_result&&is_function(action_result.destroy)?action_result.destroy:noop$1;}const is_client=false;let now=is_client?()=>window.performance.now():()=>Date.now();let raf=is_client?cb=>requestAnimationFrame(cb):noop$1;const tasks=new Set();function run_tasks(now){tasks.forEach(task=>{if(!task.c(now)){tasks.delete(task);task.f();}});if(tasks.size!==0)raf(run_tasks);}/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */function loop(callback){let task;if(tasks.size===0)raf(run_tasks);return{promise:new Promise(fulfill=>{tasks.add(task={c:callback,f:fulfill});}),abort(){tasks.delete(task);}};}function append(target,node){target.appendChild(node);}function insert(target,node,anchor){target.insertBefore(node,anchor||null);}function detach(node){node.parentNode.removeChild(node);}function element(name){return document.createElement(name);}function svg_element(name){return document.createElementNS('http://www.w3.org/2000/svg',name);}function text(data){return document.createTextNode(data);}function space(){return text(' ');}function empty(){return text('');}function listen(node,event,handler,options){node.addEventListener(event,handler,options);return()=>node.removeEventListener(event,handler,options);}function prevent_default(fn){return function(event){event.preventDefault();// @ts-ignore\nreturn fn.call(this,event);};}function stop_propagation(fn){return function(event){event.stopPropagation();// @ts-ignore\nreturn fn.call(this,event);};}function attr(node,attribute,value){if(value==null)node.removeAttribute(attribute);else if(node.getAttribute(attribute)!==value)node.setAttribute(attribute,value);}function set_attributes(node,attributes){// @ts-ignore\nconst descriptors=Object.getOwnPropertyDescriptors(node.__proto__);for(const key in attributes){if(attributes[key]==null){node.removeAttribute(key);}else if(key==='style'){node.style.cssText=attributes[key];}else if(key==='__value'){node.value=node[key]=attributes[key];}else if(descriptors[key]&&descriptors[key].set){node[key]=attributes[key];}else{attr(node,key,attributes[key]);}}}function children(element){return Array.from(element.childNodes);}function set_data(text,data){data=''+data;if(text.wholeText!==data)text.data=data;}function set_input_value(input,value){input.value=value==null?'':value;}function set_style(node,key,value,important){node.style.setProperty(key,value,important?'important':'');}function custom_event(type,detail){const e=document.createEvent('CustomEvent');e.initCustomEvent(type,false,false,detail);return e;}const active_docs=new Set();let active=0;// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str){let hash=5381;let i=str.length;while(i--)hash=(hash<<5)-hash^str.charCodeAt(i);return hash>>>0;}function create_rule(node,a,b,duration,delay,ease,fn,uid=0){const step=16.666/duration;let keyframes='{\\n';for(let p=0;p<=1;p+=step){const t=a+(b-a)*ease(p);keyframes+=p*100+`%{${fn(t,1-t)}}\\n`;}const rule=keyframes+`100% {${fn(b,1-b)}}\\n}`;const name=`__svelte_${hash(rule)}_${uid}`;const doc=node.ownerDocument;active_docs.add(doc);const stylesheet=doc.__svelte_stylesheet||(doc.__svelte_stylesheet=doc.head.appendChild(element('style')).sheet);const current_rules=doc.__svelte_rules||(doc.__svelte_rules={});if(!current_rules[name]){current_rules[name]=true;stylesheet.insertRule(`@keyframes ${name} ${rule}`,stylesheet.cssRules.length);}const animation=node.style.animation||'';node.style.animation=`${animation?`${animation}, `:''}${name} ${duration}ms linear ${delay}ms 1 both`;active+=1;return name;}function delete_rule(node,name){const previous=(node.style.animation||'').split(', ');const next=previous.filter(name?anim=>anim.indexOf(name)<0// remove specific animation\n:anim=>anim.indexOf('__svelte')===-1// remove all Svelte animations\n);const deleted=previous.length-next.length;if(deleted){node.style.animation=next.join(', ');active-=deleted;if(!active)clear_rules();}}function clear_rules(){raf(()=>{if(active)return;active_docs.forEach(doc=>{const stylesheet=doc.__svelte_stylesheet;let i=stylesheet.cssRules.length;while(i--)stylesheet.deleteRule(i);doc.__svelte_rules={};});active_docs.clear();});}let current_component;function set_current_component(component){current_component=component;}function get_current_component(){if(!current_component)throw new Error('Function called outside component initialization');return current_component;}function onMount(fn){get_current_component().$$.on_mount.push(fn);}function afterUpdate(fn){get_current_component().$$.after_update.push(fn);}function onDestroy(fn){get_current_component().$$.on_destroy.push(fn);}function createEventDispatcher(){const component=get_current_component();return(type,detail)=>{const callbacks=component.$$.callbacks[type];if(callbacks){// TODO are there situations where events could be dispatched\n// in a server (non-DOM) environment?\nconst event=custom_event(type,detail);callbacks.slice().forEach(fn=>{fn.call(component,event);});}};}function setContext(key,context){get_current_component().$$.context.set(key,context);}function getContext(key){return get_current_component().$$.context.get(key);}// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component,event){const callbacks=component.$$.callbacks[event.type];if(callbacks){callbacks.slice().forEach(fn=>fn(event));}}const dirty_components=[];const binding_callbacks=[];const render_callbacks=[];const flush_callbacks=[];const resolved_promise=Promise.resolve();let update_scheduled=false;function schedule_update(){if(!update_scheduled){update_scheduled=true;resolved_promise.then(flush);}}function add_render_callback(fn){render_callbacks.push(fn);}function add_flush_callback(fn){flush_callbacks.push(fn);}let flushing=false;const seen_callbacks=new Set();function flush(){if(flushing)return;flushing=true;do{// first, call beforeUpdate functions\n// and update components\nfor(let i=0;i<dirty_components.length;i+=1){const component=dirty_components[i];set_current_component(component);update(component.$$);}set_current_component(null);dirty_components.length=0;while(binding_callbacks.length)binding_callbacks.pop()();// then, once components are updated, call\n// afterUpdate functions. This may cause\n// subsequent updates...\nfor(let i=0;i<render_callbacks.length;i+=1){const callback=render_callbacks[i];if(!seen_callbacks.has(callback)){// ...so guard against infinite loops\nseen_callbacks.add(callback);callback();}}render_callbacks.length=0;}while(dirty_components.length);while(flush_callbacks.length){flush_callbacks.pop()();}update_scheduled=false;flushing=false;seen_callbacks.clear();}function update($$){if($$.fragment!==null){$$.update();run_all($$.before_update);const dirty=$$.dirty;$$.dirty=[-1];$$.fragment&&$$.fragment.p($$.ctx,dirty);$$.after_update.forEach(add_render_callback);}}let promise;function wait(){if(!promise){promise=Promise.resolve();promise.then(()=>{promise=null;});}return promise;}function dispatch(node,direction,kind){node.dispatchEvent(custom_event(`${direction?'intro':'outro'}${kind}`));}const outroing=new Set();let outros;function group_outros(){outros={r:0,c:[],p:outros// parent group\n};}function check_outros(){if(!outros.r){run_all(outros.c);}outros=outros.p;}function transition_in(block,local){if(block&&block.i){outroing.delete(block);block.i(local);}}function transition_out(block,local,detach,callback){if(block&&block.o){if(outroing.has(block))return;outroing.add(block);outros.c.push(()=>{outroing.delete(block);if(callback){if(detach)block.d(1);callback();}});block.o(local);}}const null_transition={duration:0};function create_bidirectional_transition(node,fn,params,intro){let config=fn(node,params);let t=intro?0:1;let running_program=null;let pending_program=null;let animation_name=null;function clear_animation(){if(animation_name)delete_rule(node,animation_name);}function init(program,duration){const d=program.b-t;duration*=Math.abs(d);return{a:t,b:program.b,d,duration,start:program.start,end:program.start+duration,group:program.group};}function go(b){const{delay=0,duration=300,easing=identity,tick=noop$1,css}=config||null_transition;const program={start:now()+delay,b};if(!b){// @ts-ignore todo: improve typings\nprogram.group=outros;outros.r+=1;}if(running_program||pending_program){pending_program=program;}else{// if this is an intro, and there's a delay, we need to do\n// an initial tick and/or apply CSS animation immediately\nif(css){clear_animation();animation_name=create_rule(node,t,b,duration,delay,easing,css);}if(b)tick(0,1);running_program=init(program,duration);add_render_callback(()=>dispatch(node,b,'start'));loop(now=>{if(pending_program&&now>pending_program.start){running_program=init(pending_program,duration);pending_program=null;dispatch(node,running_program.b,'start');if(css){clear_animation();animation_name=create_rule(node,t,running_program.b,running_program.duration,0,easing,config.css);}}if(running_program){if(now>=running_program.end){tick(t=running_program.b,1-t);dispatch(node,running_program.b,'end');if(!pending_program){// we're done\nif(running_program.b){// intro  we can tidy up immediately\nclear_animation();}else{// outro  needs to be coordinated\nif(! --running_program.group.r)run_all(running_program.group.c);}}running_program=null;}else if(now>=running_program.start){const p=now-running_program.start;t=running_program.a+running_program.d*easing(p/running_program.duration);tick(t,1-t);}}return!!(running_program||pending_program);});}}return{run(b){if(is_function(config)){wait().then(()=>{// @ts-ignore\nconfig=config();go(b);});}else{go(b);}},end(){clear_animation();running_program=pending_program=null;}};}const globals=false?window:typeof globalThis!=='undefined'?globalThis:global;function destroy_block(block,lookup){block.d(1);lookup.delete(block.key);}function outro_and_destroy_block(block,lookup){transition_out(block,1,1,()=>{lookup.delete(block.key);});}function update_keyed_each(old_blocks,dirty,get_key,dynamic,ctx,list,lookup,node,destroy,create_each_block,next,get_context){let o=old_blocks.length;let n=list.length;let i=o;const old_indexes={};while(i--)old_indexes[old_blocks[i].key]=i;const new_blocks=[];const new_lookup=new Map();const deltas=new Map();i=n;while(i--){const child_ctx=get_context(ctx,list,i);const key=get_key(child_ctx);let block=lookup.get(key);if(!block){block=create_each_block(key,child_ctx);block.c();}else if(dynamic){block.p(child_ctx,dirty);}new_lookup.set(key,new_blocks[i]=block);if(key in old_indexes)deltas.set(key,Math.abs(i-old_indexes[key]));}const will_move=new Set();const did_move=new Set();function insert(block){transition_in(block,1);block.m(node,next);lookup.set(block.key,block);next=block.first;n--;}while(o&&n){const new_block=new_blocks[n-1];const old_block=old_blocks[o-1];const new_key=new_block.key;const old_key=old_block.key;if(new_block===old_block){// do nothing\nnext=new_block.first;o--;n--;}else if(!new_lookup.has(old_key)){// remove old block\ndestroy(old_block,lookup);o--;}else if(!lookup.has(new_key)||will_move.has(new_key)){insert(new_block);}else if(did_move.has(old_key)){o--;}else if(deltas.get(new_key)>deltas.get(old_key)){did_move.add(new_key);insert(new_block);}else{will_move.add(old_key);o--;}}while(o--){const old_block=old_blocks[o];if(!new_lookup.has(old_block.key))destroy(old_block,lookup);}while(n)insert(new_blocks[n-1]);return new_blocks;}function get_spread_update(levels,updates){const update={};const to_null_out={};const accounted_for={$$scope:1};let i=levels.length;while(i--){const o=levels[i];const n=updates[i];if(n){for(const key in o){if(!(key in n))to_null_out[key]=1;}for(const key in n){if(!accounted_for[key]){update[key]=n[key];accounted_for[key]=1;}}levels[i]=n;}else{for(const key in o){accounted_for[key]=1;}}}for(const key in to_null_out){if(!(key in update))update[key]=undefined;}return update;}function get_spread_object(spread_props){return typeof spread_props==='object'&&spread_props!==null?spread_props:{};}function bind(component,name,callback){const index=component.$$.props[name];if(index!==undefined){component.$$.bound[index]=callback;callback(component.$$.ctx[index]);}}function create_component(block){block&&block.c();}function mount_component(component,target,anchor){const{fragment,on_mount,on_destroy,after_update}=component.$$;fragment&&fragment.m(target,anchor);// onMount happens before the initial afterUpdate\nadd_render_callback(()=>{const new_on_destroy=on_mount.map(run).filter(is_function);if(on_destroy){on_destroy.push(...new_on_destroy);}else{// Edge case - component was destroyed immediately,\n// most likely as a result of a binding initialising\nrun_all(new_on_destroy);}component.$$.on_mount=[];});after_update.forEach(add_render_callback);}function destroy_component(component,detaching){const $$=component.$$;if($$.fragment!==null){run_all($$.on_destroy);$$.fragment&&$$.fragment.d(detaching);// TODO null out other refs, including component.$$ (but need to\n// preserve final state?)\n$$.on_destroy=$$.fragment=null;$$.ctx=[];}}function make_dirty(component,i){if(component.$$.dirty[0]===-1){dirty_components.push(component);schedule_update();component.$$.dirty.fill(0);}component.$$.dirty[i/31|0]|=1<<i%31;}function init(component,options,instance,create_fragment,not_equal,props,dirty=[-1]){const parent_component=current_component;set_current_component(component);const prop_values=options.props||{};const $$=component.$$={fragment:null,ctx:null,// state\nprops,update:noop$1,not_equal,bound:blank_object(),// lifecycle\non_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(parent_component?parent_component.$$.context:[]),// everything else\ncallbacks:blank_object(),dirty,skip_bound:false};let ready=false;$$.ctx=instance?instance(component,prop_values,(i,ret,...rest)=>{const value=rest.length?rest[0]:ret;if($$.ctx&&not_equal($$.ctx[i],$$.ctx[i]=value)){if(!$$.skip_bound&&$$.bound[i])$$.bound[i](value);if(ready)make_dirty(component,i);}return ret;}):[];$$.update();ready=true;run_all($$.before_update);// `false` as a special case of no DOM component\n$$.fragment=create_fragment?create_fragment($$.ctx):false;if(options.target){if(options.hydrate){const nodes=children(options.target);// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n$$.fragment&&$$.fragment.l(nodes);nodes.forEach(detach);}else{// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n$$.fragment&&$$.fragment.c();}if(options.intro)transition_in(component.$$.fragment);mount_component(component,options.target,options.anchor);flush();}set_current_component(parent_component);}class SvelteComponent{$destroy(){destroy_component(this,1);this.$destroy=noop$1;}$on(type,callback){const callbacks=this.$$.callbacks[type]||(this.$$.callbacks[type]=[]);callbacks.push(callback);return()=>{const index=callbacks.indexOf(callback);if(index!==-1)callbacks.splice(index,1);};}$set($$props){if(this.$$set&&!is_empty($$props)){this.$$.skip_bound=true;this.$$set($$props);this.$$.skip_bound=false;}}}const subscriber_queue=[];/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */function readable(value,start){return{subscribe:writable(value,start).subscribe};}/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */function writable(value,start=noop$1){let stop;const subscribers=[];function set(new_value){if(safe_not_equal(value,new_value)){value=new_value;if(stop){// store is ready\nconst run_queue=!subscriber_queue.length;for(let i=0;i<subscribers.length;i+=1){const s=subscribers[i];s[1]();subscriber_queue.push(s,value);}if(run_queue){for(let i=0;i<subscriber_queue.length;i+=2){subscriber_queue[i][0](subscriber_queue[i+1]);}subscriber_queue.length=0;}}}}function update(fn){set(fn(value));}function subscribe(run,invalidate=noop$1){const subscriber=[run,invalidate];subscribers.push(subscriber);if(subscribers.length===1){stop=start(set)||noop$1;}run(value);return()=>{const index=subscribers.indexOf(subscriber);if(index!==-1){subscribers.splice(index,1);}if(subscribers.length===0){stop();stop=null;}};}return{set,update,subscribe};}function derived(stores,fn,initial_value){const single=!Array.isArray(stores);const stores_array=single?[stores]:stores;const auto=fn.length<2;return readable(initial_value,set=>{let inited=false;const values=[];let pending=0;let cleanup=noop$1;const sync=()=>{if(pending){return;}cleanup();const result=fn(single?values[0]:values,set);if(auto){set(result);}else{cleanup=is_function(result)?result:noop$1;}};const unsubscribers=stores_array.map((store,i)=>subscribe(store,value=>{values[i]=value;pending&=~(1<<i);if(inited){sync();}},()=>{pending|=1<<i;}));inited=true;sync();return function stop(){run_all(unsubscribers);cleanup();};});}var mergeObjects=objects=>objects.reduce((prev,curr)=>Object.assign(prev,curr),{});// @ts-ignore\nconst UPDATE_VALUE=updateValue=>({updateValue});const DEFAULT_VALUE=defaultValue=>({defaultValue});const CUSTOM_STORE=fn=>({store:fn});// @ts-ignore\nconst DERIVED_STORE=fn=>({store:(defaultValue,stores)=>derived(...fn(stores))});const UNIQUE_DERIVED_STORE=fn=>({store:(defaultValue,stores)=>{const[selectedStores,update,isEqual=()=>false]=fn(stores);let isFirst=true;let currentValue;return derived(selectedStores,(storeValues,set)=>{update(storeValues,value=>{if(!isFirst&&isEqual(currentValue,value))return;currentValue=value;isFirst=false;set(value);});});}});const MAP_STORE=fn=>({store:(defaultValue,stores)=>{const[valueMapper,paramStores={}]=fn(stores);let storedItems=[];let $paramStores={};const mapValue=item=>valueMapper(item,$paramStores);// set default properties for each shape\nconst setValue=items=>{// was empty, still empty\nif(!storedItems.length&&!items.length)return;// update value\nstoredItems=items;updateValue();};const updateValue=()=>{const mappedItems=storedItems.map(mapValue);storedItems=mappedItems;set(mappedItems);};Object.keys(paramStores).forEach(name=>{const store=paramStores[name];store.subscribe(value=>{$paramStores[name]=value;if(!value)return;updateValue();});});const{subscribe,set}=writable(defaultValue);return{set:setValue,update:fn=>setValue(fn(null)),subscribe};}});const createStore=(accessors,stores,options)=>{const{store=defaultValue=>writable(defaultValue),defaultValue=noop,// should be a function returning the default value\nupdateValue=undefined}=options;// create our private store\nconst storeInstance=store(defaultValue(),stores,accessors);const{subscribe,update=noop}=storeInstance;// update = noop because not all stores can be updated\n// on update private store\nlet unsub;const onUpdate=cb=>{let ignoreFirstCallback=true;if(unsub)unsub();unsub=subscribe(value=>{// need to ignore first callback because that returns current value\nif(ignoreFirstCallback)return ignoreFirstCallback=false;// now we have the newly assigned value\ncb(value);unsub();unsub=undefined;});};// create the value updater function, needs access to stores so can read all store values\nconst updateStoreValue=updateValue?updateValue(accessors):passthrough;// set and validate value\nstoreInstance.set=nextValue=>update(previousValue=>updateStoreValue(nextValue,previousValue,onUpdate));// set default value for external reference\nstoreInstance.defaultValue=defaultValue;// expose store api\nreturn storeInstance;};var createStores=props=>{const stores={};const accessors={};props.forEach(([name,...options])=>{const opts=mergeObjects(options);const store=stores[name]=createStore(accessors,stores,opts);const property={get:()=>get_store_value(store),set:store.set};Object.defineProperty(accessors,name,property);});return{stores,accessors};};var props=[// io\n['src'],['imageReader'],['imageWriter'],// current images\n['images',DEFAULT_VALUE(()=>[])]];var pubsub=()=>{let subs=[];return{sub:(event,callback)=>{subs.push({event,callback});return()=>subs=subs.filter(subscriber=>subscriber.event!==event||subscriber.callback!==callback);},pub:(event,value)=>{subs.filter(sub=>sub.event===event).forEach(sub=>sub.callback(value));}};};var capitalizeFirstLetter=str=>str.charAt(0).toUpperCase()+str.slice(1);var defineMethods=(object,api)=>{Object.keys(api).forEach(name=>{const descriptor=isFunction(api[name])?{value:api[name],writable:false}:api[name];Object.defineProperty(object,name,descriptor);});};var fixPrecision=(value,precision=12)=>parseFloat(value.toFixed(precision));const scalar=10000;var offsetRectToFitPolygon=(rect,poly)=>{const polyLines=quadLines(poly);const offset=vectorCreateEmpty();const rectVertexes=rectGetCorners(rect);// we can fit it\nrectVertexes.forEach(vertex=>{// we update each corner by adding the current offset\nvectorAdd(vertex,offset);// test if point lies in polygon, if so, all is fine and we can exit\nif(polyPointIntersectionConvex(vertex,poly))return;polyLines.forEach(line=>{// get angle of edge and draw a ray from the corner perpendicular to the edge\nconst a=Math.atan2(line.start.y-line.end.y,line.start.x-line.end.x);const x=Math.sin(Math.PI-a)*scalar;const y=Math.cos(Math.PI-a)*scalar;const ray=vectorCreate(vertex.x+x,vertex.y+y);// extend the poly line so even if we overshoot the polygon we hit it\nconst lineExtended=lineExtend(lineClone(line),scalar);// get the resulting intersection (there's always an intersection)\nconst intersection=lineLineIntersection(lineCreate(vertex,ray),lineExtended);// no intersection, no need to do anything\nif(!intersection)return;// update offset to move towards image\nvectorAdd(offset,vectorSubtract(vectorClone(intersection),vertex));});});// test if any vertexes still fall outside of poly, if so, we can't fit the rect\nconst rectOffset=rectClone(rect);vectorAdd(rectOffset,offset);const rectOffsetVertices=rectGetCorners(rectOffset);const fits=rectOffsetVertices.every(vertex=>polyPointIntersectionConvex(vertex,poly));if(fits){rectUpdateWithRect(rect,rectOffset);return true;}return false;};var limitCropRectToImage=(rect,poly)=>{// get crop rect polygon vertexes\nconst rectVertexes=rectGetCorners(rect);// if we end up here it doesn't fit, we might need to adjust\nconst polyLines=quadLines(poly)// extend the poly lines a tiny bit so we\n// don't shoot rays between line gaps at corners\n// this caused one intersection to be missing resulting\n// in error while manipulating crop edges\n// (rotate image 90degrees -> drag bottom edge) (2021-04-09)\n.map(line=>lineExtend(line,5));const rectCenterPosition=rectCenter(rect);const intersections=[];rectVertexes.forEach(rectVertex=>{const ray=lineMultiply(lineCreate(vectorClone(rectCenterPosition),vectorClone(rectVertex)),1000000);let intersectionFound=false;polyLines.map(lineClone).forEach(line=>{const intersection=lineLineIntersection(ray,line);if(!intersection||intersectionFound)return;intersections.push(intersection);intersectionFound=true;});});// top left -> bottom right\nconst tlbr=vectorDistance(intersections[0],intersections[2]);// top right -> bottom left\nconst trbl=vectorDistance(intersections[1],intersections[3]);// calculate smallest rectangle we can make, use that\nconst rectLimitedVertices=tlbr<trbl?[intersections[0],intersections[2]]:[intersections[1],intersections[3]];const rectLimitedToImage=rectCreateFromPoints(rectLimitedVertices);// only use our fitted crop rectangle if it's smaller than our current rectangle,\n// this would mean that our current rectangle couldn't be moved to make it fit\nif(rectLimitedToImage.width<rect.width){// need to center on previous rect\nrectUpdateWithRect(rect,rectLimitedToImage);return true;}return false;};var getImagePolygon=(image,imageRotation,imagePerspective={x:0,y:0})=>{const imageRect=rectCreateFromSize(image);const imageCenter=rectCenter(imageRect);const imagePoly=rectApplyPerspective(imageRect,imagePerspective,imageCenter).map(imageVertex=>vectorRotate(imageVertex,imageRotation,imageCenter));// get image poly bounds, we need this to offset the poly vertices from 0,0\nconst imagePolyBounds=rectCreateFromPoints(imagePoly);// get image polygon vertexes\nreturn imagePoly.map(imageVertex=>vectorSubtract(imageVertex,imagePolyBounds));};var getMaxSizeInRect=(size,rotation=0,aspectRatio=rectAspectRatio(size))=>{let width;let height;if(rotation!==0){const innerAngle=Math.atan2(1,aspectRatio);const rotationSigned=Math.sign(rotation)*rotation;const rotationSignedMod=rotationSigned%Math.PI;const rotationSignedModHalf=rotationSigned%HALF_PI;// determine if is turned on side\nlet hyp;let r;if(rotationSignedMod>QUART_PI&&rotationSignedMod<HALF_PI+QUART_PI){r=rotationSignedModHalf>QUART_PI?rotationSigned:HALF_PI-rotationSignedModHalf;}else{r=rotationSignedModHalf>QUART_PI?HALF_PI-rotationSignedModHalf:rotationSigned;}hyp=Math.min(Math.abs(size.height/Math.sin(innerAngle+r)),Math.abs(size.width/Math.cos(innerAngle-r)));width=Math.cos(innerAngle)*hyp;height=width/aspectRatio;}else{width=size.width;height=width/aspectRatio;if(height>size.height){height=size.height;width=height*aspectRatio;}}return sizeCreate(width,height);};var limitRectToImage=(rect,imageSize,imageRotation=0,imagePerspective=vectorCreateEmpty(),minSize)=>{// rotation and/or perspective, let's use the \"advanced\" collision detection method\nif(isNumber(imageRotation)&&imageRotation!==0||imagePerspective.x||imagePerspective.y){const inputAspectRatio=rectAspectRatio(rect);// test if crop can fit image, if it can, offset the crop so it fits\nconst imagePolygon=getImagePolygon(imageSize,imageRotation,imagePerspective);const maxSizeInRect=getMaxSizeInRect(imageSize,imageRotation,inputAspectRatio);const canFit=rect.width<maxSizeInRect.width&&rect.height<maxSizeInRect.height;if(!canFit){const dx=rect.width*0.5-maxSizeInRect.width*0.5;const dy=rect.height*0.5-maxSizeInRect.height*0.5;// adjust crop rect to max size\nif(rect.width>maxSizeInRect.width){rect.width=maxSizeInRect.width;rect.x+=dx;}if(rect.height>maxSizeInRect.height){rect.height=maxSizeInRect.height;rect.y+=dy;}// test if has exceeded min size, if so we need to limit the size and recalculate the other edge\n/*\n                        -\\\n                       /  ---\\\n                      h2      ---\\\n                     /            ---\\\n                    +--------w---------+\\\n                   /|                  | ---\\\n                  / |                  |     ---\\\n                 /  |                  |         ---\\\n                /   |                  |             --\n               h1   |                  |             /\n              /     |                  |            /\n             /      |                  |           /\n            -\\      |                  |          /\n              ---\\  |                  |         /\n                  --+------------------+        /\n                      ---\\                     /\n                          --\\                 /\n                             ---\\            /\n                                 ---\\       /\n                                     ---\\  /\n                                         --\n            */}offsetRectToFitPolygon(rect,imagePolygon);const wasLimited=limitCropRectToImage(rect,imagePolygon);// this makes sure that after limiting the size, the crop rect is moved to a position that is inside the image\nif(wasLimited)offsetRectToFitPolygon(rect,imagePolygon);}// no rotation, no perspective, use simple bounds method\nelse{// remember intended aspect ratio so we can try and recreate it\nlet intendedAspectRatio=rectAspectRatio(rect);// limit to image size first, can never exceed that\nrect.width=Math.min(rect.width,imageSize.width);rect.height=Math.min(rect.height,imageSize.height);// reposition rect so it's always inside image bounds\nrect.x=Math.max(rect.x,0);if(rect.x+rect.width>imageSize.width){rect.x-=rect.x+rect.width-imageSize.width;}rect.y=Math.max(rect.y,0);if(rect.y+rect.height>imageSize.height){rect.y-=rect.y+rect.height-imageSize.height;}// we get the center of the current rect so we can center the contained rect to it\nconst intendedCenter=rectCenter(rect);// make sure still adheres to aspect ratio\nconst containedRect=rectContainRect(rect,intendedAspectRatio);containedRect.width=Math.max(minSize.width,containedRect.width);containedRect.height=Math.max(minSize.height,containedRect.height);containedRect.x=intendedCenter.x-containedRect.width*0.5;containedRect.y=intendedCenter.y-containedRect.height*0.5;rectUpdateWithRect(rect,containedRect);}};var applyCropRectAction=(cropRectPrevious,cropRectNext,imageSize,imageRotation,imagePerspective,cropLimitToImageBounds,cropMinSize,cropMaxSize)=>{// clone\nconst minSize=sizeClone(cropMinSize);// set upper bounds to crop max size\nconst maxSize=sizeClone(cropMaxSize);// limit max size (more important that min size is respected so first limit max size)\nconst maxScalar=fixPrecision(Math.max(cropRectNext.width/maxSize.width,cropRectNext.height/maxSize.height));const minScalar=fixPrecision(Math.min(cropRectNext.width/minSize.width,cropRectNext.height/minSize.height));// clone for resulting crop rect\nconst cropRectOut=rectClone(cropRectNext);//\n// if exceeds min or max scale correct next crop rectangle to conform to bounds\n//\nif(minScalar<1||maxScalar>1){// center of both previous and next crop rects\nconst previousCropRectCenter=rectCenter(cropRectPrevious);const nextCropRectCenter=rectCenter(cropRectNext);// calculate scales\nconst scalar=minScalar<1?minScalar:maxScalar;const cx=(nextCropRectCenter.x+previousCropRectCenter.x)/2;const cy=(nextCropRectCenter.y+previousCropRectCenter.y)/2;const cw=cropRectOut.width/scalar;const ch=cropRectOut.height/scalar;rectUpdate(cropRectOut,cx-cw*0.5,cy-ch*0.5,cw,ch);}// no need to limit to bounds, let's go!\nif(!cropLimitToImageBounds)return{crop:cropRectOut};//\n// make sure the crop is made inside the bounds of the image\n//\nlimitRectToImage(cropRectOut,imageSize,imageRotation,imagePerspective,minSize);return{crop:cropRectOut};};var getBaseCropRect=(imageSize,transformedCropRect,imageRotation,imagePerspective={x:0,y:0})=>{const imageRect=rectCreateFromSize(imageSize);const imageCenter=rectCenter(imageRect);const imageTransformedVertices=rectRotate(imageRect,imageRotation,imageCenter);// get the rotated image bounds center (offset isn't relevant as crop is relative to top left image position)\nconst imageRotatedBoundsCenter=rectCenter(rectNormalizeOffset(rectCreateFromPoints(imageTransformedVertices)));// get the center of the crop inside the rotated image\nconst cropCenterInTransformedImage=rectCenter(transformedCropRect);// invert the rotation of the crop center around the rotated image center\nconst deRotatedCropCenter=vectorRotate(cropCenterInTransformedImage,-imageRotation,imageRotatedBoundsCenter);// calculate crop distance from rotated image center\nconst cropFromCenterOfTransformedImage=vectorSubtract(deRotatedCropCenter,imageRotatedBoundsCenter);// calculate original crop offset (from untransformed image)\nconst originalCropCenterOffset=vectorApply(vectorAdd(imageCenter,cropFromCenterOfTransformedImage),fixPrecision);return rectCreate(originalCropCenterOffset.x-transformedCropRect.width*0.5,originalCropCenterOffset.y-transformedCropRect.height*0.5,transformedCropRect.width,transformedCropRect.height);};var clamp=(value,min,max)=>Math.max(min,Math.min(value,max));var applyRotationAction=(imageRotationPrevious,imageRotation,imageRotationRange,cropRect,imageSize,imagePerspective,cropLimitToImageBounds,cropRectOrigin,cropMinSize,cropMaxSize)=>{// clone\nconst minSize=sizeClone(cropMinSize);// set upper bounds to crop max size if image is bigger than max size,\n// else if should limit to image bounds use image size as limit\nlet maxSize=sizeClone(cropMaxSize);if(cropLimitToImageBounds){maxSize.width=Math.min(cropMaxSize.width,imageSize.width);maxSize.height=Math.min(cropMaxSize.height,imageSize.height);}let didAttemptDoubleTurn=false;const rotate=(rotationPrevious,rotation)=>{// get the base crop rect (position of crop rect in untransformed image)\n// if we have the base crop rect we can apply the new rotation to it\nconst cropRectBase=getBaseCropRect(imageSize,cropRect,rotationPrevious,null);// calculate transforms based on new rotation and base crop rect\nconst imageRect=rectCreateFromSize(imageSize);const imageCenter=rectCenter(imageRect);const imageTransformedCorners=rectApplyPerspective(imageRect,imagePerspective,imageCenter);// need this to correct for perspective centroid displacement\nconst perspectiveOffset=vectorSubtract(vectorClone(imageCenter),quadCentroid(imageTransformedCorners));// rotate around center of image\nconst cropCenter=vectorRotate(rectCenter(cropRectBase),rotation,imageCenter);const rotateCropOffset=vectorSubtract(vectorClone(imageCenter),cropCenter);// get center of image bounds and move to correct position\nimageTransformedCorners.forEach(imageVertex=>vectorRotate(imageVertex,rotation,imageCenter));const imageBoundsRect=rectCreateFromPoints(imageTransformedCorners);const imageCentroid=quadCentroid(imageTransformedCorners);const cropOffset=vectorAdd(vectorSubtract(vectorSubtract(imageCentroid,rotateCropOffset),imageBoundsRect),perspectiveOffset);// create output cropRect\nconst cropRectOut=rectCreate(cropOffset.x-cropRectBase.width*0.5,cropOffset.y-cropRectBase.height*0.5,cropRectBase.width,cropRectBase.height);// if has size target, scale croprect to target size\nif(cropRectOrigin){rectScale(cropRectOut,cropRectOrigin.width/cropRectOut.width);}// if should limit to image bounds\nif(cropLimitToImageBounds){const imagePoly=getImagePolygon(imageSize,rotation,imagePerspective);// offsetRectToFitPolygon(cropRectOut, imagePoly);\n// commenting this fixes poly sliding problem when adjusting rotation\nlimitCropRectToImage(cropRectOut,imagePoly);}//#region if exceeds min or max adjust rotation to conform to bounds\nconst minScalar=fixPrecision(Math.min(cropRectOut.width/minSize.width,cropRectOut.height/minSize.height),8);const maxScalar=fixPrecision(Math.max(cropRectOut.width/maxSize.width,cropRectOut.height/maxSize.height),8);if(minScalar<1||maxScalar>1){// determine if is full image turn\nconst isTurn=fixPrecision(Math.abs(rotation-rotationPrevious))===fixPrecision(Math.PI/2);// try another turn if is turning image\nif(isTurn&&!didAttemptDoubleTurn){didAttemptDoubleTurn=true;return rotate(imageRotationPrevious,imageRotationPrevious+Math.sign(rotation-rotationPrevious)*Math.PI);}}//#endregion\nreturn{rotation,crop:rectApply(cropRectOut,v=>fixPrecision(v,8))};};// amount of turns applied, we need this to correctly determine the allowed rotation range\nconst imageTurns=Math.sign(imageRotation)*Math.round(Math.abs(imageRotation)/HALF_PI)*HALF_PI;const imageRotationClamped=clamp(imageRotation,imageTurns+imageRotationRange[0],imageTurns+imageRotationRange[1]);// set new crop position\nreturn rotate(imageRotationPrevious,imageRotationClamped);};const ORDERED_STATE_PROPS=[// requirements\n'cropLimitToImage','cropMinSize','cropMaxSize','cropAspectRatio',// selection -> flip -> rotate -> perspective -> crop\n'flipX','flipY','rotation','crop',// 'perspectiveX',\n// 'perspectiveY',\n// effects\n'colorMatrix','convolutionMatrix','gamma','vignette',// 'noise',\n// shapes\n'annotation','decoration',// other\n'backgroundColor','targetSize'];const clone=value=>{if(isArray(value)){return value.map(clone);}else if(isObject(value)){return _objectSpread({},value);}return value;};/* TODO: keep this state outside of the shape array? */const excludedShapeProps=['isDraft','isFormatted','isComplete','isError','isLoading','isEditing','isSelected'];/* note this method doesn't actually test if the value is fully serializable it simlpy excludes known prop values that can't be serialized */const isSerializeAble=value=>{// isFunction(value) ||\nreturn!isElement(value);};const filterShapeState=shapes=>shapes.map(shape=>Object.keys(shape).reduce((copy,prop)=>{if(excludedShapeProps.includes(prop)||!isSerializeAble(shape[prop]))return copy;copy[prop]=shape[prop];return copy;},{}));var stateStore=(defaultValue,stores,accessors)=>{const observedStores=ORDERED_STATE_PROPS.map(key=>stores[key]);// can only subscribe, setting is done directly through store accessors\n// @ts-ignore\nconst{subscribe}=derived(observedStores,(values,set)=>{const state=ORDERED_STATE_PROPS.reduce((prev,curr,i)=>{prev[curr]=clone(values[i]);return prev;},{});// round crop if defined\nstate.crop&&rectApply(state.crop,Math.round);// remove state props from decoration and annotation\nstate.annotation=state.annotation&&filterShapeState(state.annotation);state.decoration=state.decoration&&filterShapeState(state.decoration);set(state);});const setState=state=>{// requires at least some state to be supplied\nif(!state)return;// make sure crop origin is reset\naccessors.cropOrigin=undefined;// apply new values\nORDERED_STATE_PROPS// remove keys that weren't set\n.filter(key=>state.hasOwnProperty(key))// apply each key in order\n.forEach(key=>{accessors[key]=clone(state[key]);});};return{set:setState,update:fn=>setState(fn(null)),subscribe};};var toNumericAspectRatio=v=>{if(!v)return undefined;if(/:/.test(v)){const[w,h]=v.split(':');return w/h;}return parseFloat(v);};var arrayEqual=(a,b)=>{if(a.length!==b.length)return false;for(let i=0;i<a.length;i++){if(a[i]!==b[i])return false;}return true;};let result$5=null;var isAndroid=()=>{if(result$5===null)result$5=isUserAgent(/Android/);return result$5;};let result$6=null;var isFirefox=()=>{if(result$6===null)result$6=isUserAgent(/Firefox/);return result$6;};let result$7=null;var isEdge=()=>{if(result$7===null)result$7=isUserAgent(/Edge/);return result$7;};let vendor;var getBrowserVendor=()=>{if(vendor)return vendor;vendor=isIOS()?'ios':isAndroid()?'android':isFirefox()?'firefox':isInternetExplorer()?'ie':isEdge()?'edge':'chrome';return vendor;};// https://github.com/jhildenbiddle/canvas-size#test-results\nlet maxCanvasSze;var getMaxCanvasSize=()=>{if(!maxCanvasSze){const sizes={android:[32767,32767,10836],ios:[4194303,8388607,16777216],chrome:[32767,32767,268435456],firefox:[32767,32767,124992400],edge:[16384,16384,268435456],ie:[16384,16384,67108864]};maxCanvasSze=sizes[getBrowserVendor()]||sizes['chrome'];}const[width,height,density]=maxCanvasSze;return{width,height,density};};var padColorArray=(color=[0,0,0,0],opacity=1.0)=>color.length===4?color:[...color,opacity];//\n// constants\n//\nconst MIN_ROTATION=-QUART_PI;const MAX_ROTATION=QUART_PI;//\n// helper methods\n//\nconst isCropCentered=(crop,imageSize,imageRotation)=>{const cropCenter=vectorApply(rectCenter(crop),v=>fixPrecision(v,8));const imageRect=rectCreateFromSize(imageSize);const imageCenter=rectCenter(imageRect);const imageRotatedVertices=rectRotate(imageRect,imageRotation,imageCenter);const imageBoundsCenter=vectorApply(sizeCenter(rectCreateFromPoints(imageRotatedVertices)),v=>fixPrecision(v,8));const dx=Math.abs(imageBoundsCenter.x-cropCenter.x);const dy=Math.abs(imageBoundsCenter.y-cropCenter.y);return dx<1&&dy<1;};const isCropMaxSize=(cropRect,imageSize,rotation)=>{const maxSize=getMaxSizeInRect(imageSize,rotation,rectAspectRatio(cropRect));return sizeEqual(sizeApply(maxSize,Math.round),sizeApply(sizeClone(cropRect),Math.round));};//\n// updater methods\n//\nconst updateCropRect=props=>(cropNext,cropPrevious=cropNext)=>{// wait for image to load\nconst{loadState,size,cropMinSize,cropMaxSize,cropLimitToImage,rotation,perspective}=props;// image hasn't loaded yet, use supplied crop rect\nif(!cropNext||!loadState||!loadState.beforeComplete)return cropNext;// apply the action\nconst res=applyCropRectAction(cropPrevious,cropNext,size,rotation,perspective,cropLimitToImage,cropMinSize,cropMaxSize);const cropOut=rectApply(res.crop,v=>fixPrecision(v,8));return cropOut;};const updateCropAspectRatio=props=>aspectRatioNext=>{const{loadState,crop,size,rotation}=props;const aspectRatio=toNumericAspectRatio(aspectRatioNext);// no aspect ratio means custom aspect ratio so set to undefined\nif(!aspectRatio)return undefined;// can't update crop if not defined yet\nif(!loadState||!loadState.beforeComplete)return aspectRatio;// if crop centered scale up\nif(isCropCentered(crop,size,rotation)){const imageSize=sizeTurn(sizeClone(size),rotation);props.crop=rectApply(rectContainRect(rectCreateFromSize(imageSize),aspectRatioNext),fixPrecision);}else{const cropSize={width:crop.height*aspectRatio,height:crop.height};const tx=(crop.width-cropSize.width)*0.5;const ty=(crop.height-cropSize.height)*0.5;props.crop=rectApply(rectCreate(crop.x+tx,crop.y+ty,cropSize.width,cropSize.height),fixPrecision);}return aspectRatio;};const updateCropLimitToImage=props=>(limitToImageNext,limitToImagePrevious,onUpdate)=>{// if was not limiting previously and now set limiting make sure crop fits bounds\nif(!limitToImagePrevious&&limitToImageNext){onUpdate(()=>props.crop=rectClone(props.crop));}return limitToImageNext;};const updateRotation=props=>(rotationNext,rotationPrevious,onUpdate)=>{// when image rotation is updated we need to adjust the\n// cropRect offset so rotation happens from cropRect center\n// no change\nif(rotationNext===rotationPrevious)return rotationNext;// get relevant data from store state\nconst{loadState,size,rotationRange,cropMinSize,cropMaxSize,crop,perspective,cropLimitToImage,cropOrigin}=props;// image not ready, exit!\nif(!loadState||!loadState.beforeComplete)return rotationNext;// remember if current crop was at max size and centered, if so, resulting crop should also be at max size\nconst cropWasAtMaxSize=isCropMaxSize(crop,size,rotationPrevious);const cropWasCentered=isCropCentered(crop,size,rotationPrevious);// get new state\nconst res=applyRotationAction(rotationPrevious,rotationNext,rotationRange,crop,size,perspective,cropLimitToImage,cropOrigin,cropMinSize,cropMaxSize);// if is centered, and initial crop was at max size expand crop to max size\nif(cropWasAtMaxSize&&cropWasCentered){const rect=getMaxSizeInRect(size,rotationNext,rectAspectRatio(res.crop));// move top left corner\nres.crop.x+=res.crop.width*0.5;res.crop.y+=res.crop.height*0.5;res.crop.x-=rect.width*0.5;res.crop.y-=rect.height*0.5;// update size to max size\nres.crop.width=rect.width;res.crop.height=rect.height;}// return validated rotation value, then, after we assign that value, we update the crop rect\n// we may only call onUpdate if a change was made\nonUpdate(()=>{props.crop=rectApply(res.crop,v=>fixPrecision(v,8));});// return result rotation (might have been rotated twice to fit crop rectangle)\nreturn res.rotation;};// updates the range of valid rotation input\nconst updateRotationRange=(imageSize,imageIsRotatedSideways,cropMinSize,cropSize)=>{/*\n    - 'a' is angle between diagonal and image height\n    - 'b' is angle between diagonal and crop height\n    - 'c' is angle between diagonal and image width\n    - resulting range is then a - b\n    +----------/\\------------------------+\n    |         / \\ \\                      |\n    |        /   \\  \\                    |\n    |       /     \\   \\                  |\n    |       \\      \\    \\                |\n    |         \\     \\     \\              |\n    |           \\    \\      \\            |\n    |             \\   \\       /          |\n    |               \\  \\     /           |\n    |                 \\ \\   /            |\n    |                   \\\\a/b            |\n    +---------------------\\--------------+\n    */const scalar=Math.max(cropMinSize.width/cropSize.width,cropMinSize.height/cropSize.height);const minSize=sizeCreate(cropSize.width*scalar,cropSize.height*scalar);// the hypotenus is the length of the diagonal of the min crop size\nconst requiredSpace=sizeHypotenuse(minSize);// minimum space available in horizontal / vertical direction\nconst availableSpace=Math.min(imageSize.width,imageSize.height);// if there's enough space available, we can return the max range\nif(requiredSpace<availableSpace)return[MIN_ROTATION,MAX_ROTATION];// if the image is turned we need to swap the width and height\nconst imageWidth=imageIsRotatedSideways?imageSize.height:imageSize.width;const imageHeight=imageIsRotatedSideways?imageSize.width:imageSize.height;// subtracting the angle between the hypotenuse and the crop itself\nconst a=Math.acos(minSize.height/requiredSpace);const b=Math.acos(imageHeight/requiredSpace);const c=Math.asin(imageWidth/requiredSpace);const rangeHorizontal=a-b;const rangeVertical=c-a;// range is not a number, it means we can rotate as much as we want\nif(Number.isNaN(rangeHorizontal)&&Number.isNaN(rangeVertical))return[MIN_ROTATION,MAX_ROTATION];// get minimum range\nconst range=Number.isNaN(rangeHorizontal)?rangeVertical:Number.isNaN(rangeVertical)?rangeHorizontal:Math.min(rangeHorizontal,rangeVertical);// if not, limit range to min and max rotation\nconst rangeMin=Math.max(-range,MIN_ROTATION);const rangeMax=Math.min(range,MAX_ROTATION);return[rangeMin,rangeMax];};// updates the range of valid crop rectangle input\nconst updateCropRange=(imageSize,rotation,cropAspectRatio,cropMinSize,cropMaxSize,cropLimitToImage)=>{// ! rotation doesn't affect min size, only max size\n// set lower bounds to crop min size\nlet minSize=sizeClone(cropMinSize);// set upper bounds to crop max size\nlet maxSize=sizeClone(cropMaxSize);// now we got basic bounds, let's see if we should limit to the image bounds, else we done\nif(!cropLimitToImage)return[minSize,maxSize];return[minSize,sizeApply(getMaxSizeInRect(imageSize,rotation,cropAspectRatio),Math.round)];};const prepareShape=(shape,options)=>{// only auto-format once\nif(!shape.isFormatted){shape=shapeFormat(shape);shape.isFormatted=true;}// we need to make sure shape is still correctly positioned relative to parent\n// draft cannot be relative\n// if context changed\n// if has left top right or bottom\nif(!shape.isDraft&&shapeHasRelativeSize(shape)&&(!shape.context||!rectEqual(options.context,shape.context))){shape=shapeComputeRect(shape,options.context);shape.context=_objectSpread({},options.context);}return shape;};var imageProps=[// image info received from read\n['file'],['size'],// loading and processing state\n['loadState'],['processState'],// derived info\n['aspectRatio',DERIVED_STORE(({size})=>[size,$size=>$size?rectAspectRatio($size):undefined])],// image modifications\n['perspectiveX',DEFAULT_VALUE(()=>0)],['perspectiveY',DEFAULT_VALUE(()=>0)],['perspective',DERIVED_STORE(({perspectiveX,perspectiveY})=>[[perspectiveX,perspectiveY],([x,y])=>({x,y})])],['rotation',DEFAULT_VALUE(()=>0),UPDATE_VALUE(updateRotation)],['flipX',DEFAULT_VALUE(()=>false)],['flipY',DEFAULT_VALUE(()=>false)],['flip',DERIVED_STORE(({flipX,flipY})=>[[flipX,flipY],([x,y])=>({x,y})])],['isRotatedSideways',UNIQUE_DERIVED_STORE(({rotation})=>[[rotation],([$rotation],set)=>set(isRotatedSideways($rotation)),(prevValue,nextValue)=>prevValue!==nextValue])],['crop',UPDATE_VALUE(updateCropRect)],['cropAspectRatio',UPDATE_VALUE(updateCropAspectRatio)],['cropOrigin'],['cropMinSize',DEFAULT_VALUE(()=>({width:1,height:1}))],['cropMaxSize',DEFAULT_VALUE(()=>sizeClone(getMaxCanvasSize()))],['cropLimitToImage',DEFAULT_VALUE(()=>true),UPDATE_VALUE(updateCropLimitToImage)],['cropSize',UNIQUE_DERIVED_STORE(({crop})=>[[crop],([$crop],set)=>{if(!$crop)return;set(sizeCreate($crop.width,$crop.height));},// if is same as previous size, don't trigger update (happens when updating only the crop offset)\n(prevValue,nextValue)=>sizeEqual(prevValue,nextValue)])],['cropRectAspectRatio',DERIVED_STORE(({cropSize})=>[[cropSize],([$cropSize],set)=>{if(!$cropSize)return;set(fixPrecision(rectAspectRatio($cropSize),5));}])],['cropRange',UNIQUE_DERIVED_STORE(({size,rotation,cropRectAspectRatio,cropMinSize,cropMaxSize,cropLimitToImage})=>[[size,rotation,cropRectAspectRatio,cropMinSize,cropMaxSize,cropLimitToImage],([$size,$rotation,$cropRectAspectRatio,$cropMinSize,$cropMaxSize,$cropLimitToImage],set)=>{// wait for image size\nif(!$size)return;const range=updateCropRange($size,$rotation,$cropRectAspectRatio,$cropMinSize,$cropMaxSize,$cropLimitToImage);set(range);},// if is same range as previous range, don't trigger update\n(prevRange,nextRange)=>arrayEqual(prevRange,nextRange)])],['rotationRange',UNIQUE_DERIVED_STORE(({size,isRotatedSideways,cropMinSize,cropSize})=>[[size,isRotatedSideways,cropMinSize,cropSize],([$size,$isRotatedSideways,$cropMinSize,$cropSize],set)=>{// wait for image size\nif(!$size||!$cropSize)return;const range=updateRotationRange($size,$isRotatedSideways,$cropMinSize,$cropSize);set(range);},// if is same range as previous range, don't trigger update\n(prevRange,nextRange)=>arrayEqual(prevRange,nextRange)])],// canvas\n['backgroundColor',UPDATE_VALUE(()=>color=>padColorArray(color))],// size\n['targetSize'],// effects\n['colorMatrix'],['convolutionMatrix'],['gamma'],['noise'],['vignette'],// annotations live in image space\n['annotation',MAP_STORE(({size})=>[prepareShape,{context:size}]),DEFAULT_VALUE(()=>[])],// decorations live in crop space\n['decoration',MAP_STORE(({crop})=>[prepareShape,{context:crop}]),DEFAULT_VALUE(()=>[])],// state of image, used to restore a previous state or request the current state\n['state',CUSTOM_STORE(stateStore)]];var process=async(value,chainTasks,chainOptions={},processOptions)=>{// options relevant to the process method itself\nconst{ontaskstart,ontaskprogress,ontaskend,token}=processOptions;// has been cancelled\nlet cancelled=false;// set cancel handler method\ntoken.cancel=()=>{// cancel called from outside of the process method\ncancelled=true;};// step through chain\nfor(const[index,task]of chainTasks.entries()){// exit when cancelled\nif(cancelled)return;// get the task function and the id so we can notify the callee of the task that is being started\nconst[fn,id]=task;// start task\nontaskstart(index,id);try{value=await fn(value,_objectSpread({},chainOptions),event=>ontaskprogress(index,id,event));}catch(err){// stop processing more items in the chain\ncancelled=true;// pass error back to parent\nthrow err;}ontaskend(index,id);}return value;};// TODO: find better location for minSize / file load validation\nvar createImage=({minSize={width:1,height:1}}={})=>{// create default store\nconst{stores,accessors}=createStores(imageProps);// pub/sub\nconst{pub,sub}=pubsub();// processing handler\nconst createProcessingHandler=(stateProp,eventKey)=>{const getStore=()=>accessors[stateProp]||{};const setStore=obj=>accessors[stateProp]=_objectSpread(_objectSpread(_objectSpread({},getStore()),obj),{},{timeStamp:Date.now()});const hasError=()=>getStore().error;const handleError=error=>{if(hasError())return;setStore({error:error});pub(`${eventKey}error`,_objectSpread({},getStore()));};return{start(){pub(`${eventKey}start`);},onabort(){pub(`${eventKey}abort`);},ontaskstart(index,id){if(hasError())return;setStore({index,task:id,taskProgress:undefined,taskLengthComputable:undefined});pub(`${eventKey}taskstart`,_objectSpread({},getStore()));},ontaskprogress(index,id,event){if(hasError())return;setStore({index,task:id,taskProgress:event.loaded/event.total,taskLengthComputable:event.lengthComputable});pub(`${eventKey}taskprogress`,_objectSpread({},getStore()));pub(`${eventKey}progress`,_objectSpread({},getStore()));},ontaskend(index,id){if(hasError())return;setStore({index,task:id});pub(`${eventKey}taskend`,_objectSpread({},getStore()));},ontaskerror(error){handleError(error);},error(error){handleError(error);},beforeComplete(data){if(hasError())return;setStore({beforeComplete:true});pub(`before${eventKey}`,data);},complete(data){if(hasError())return;setStore({complete:true});pub(eventKey,data);}};};//#region read image\nconst read=(src,{reader})=>{// exit if no reader supplied\nif(!reader)return;// reset file data to undefined as we're loading a new image\nObject.assign(accessors,{file:undefined,size:undefined,loadState:undefined});// our cancel token so we can abort load if needed, cancel will be set by process\nlet imageReadToken={cancel:noop};let imageReadCancelled=false;const imageReadHandler=createProcessingHandler('loadState','load');const processOptions=_objectSpread({token:imageReadToken},imageReadHandler);const readerState={src,size:undefined,dest:undefined};const readerOptions={};// start reading image\n(async()=>{try{imageReadHandler.start();const output=await process(readerState,reader,readerOptions,processOptions);// was cancelled\nif(imageReadCancelled)return imageReadHandler.onabort();// get shortcuts for validation\nconst{size,dest}=output||{};// if we don't have a size\nif(!size||!size.width||!size.height)throw new DokaError('Image size missing','IMAGE_SIZE_MISSING',output);// size of image is too small\nif(size.width<minSize.width||size.height<minSize.height)throw new DokaError('Image too small','IMAGE_TOO_SMALL',_objectSpread(_objectSpread({},output),{},{minWidth:minSize.width,minHeight:minSize.height}));// update internal data\nObject.assign(accessors,{size:size,file:dest});// set base crop rect if not already has crop defined\nif(!accessors.crop){accessors.crop=rectContainRect(rectCreateFromSize(size),accessors.cropAspectRatio);}// apply current image state in correct order,\n// there's a difference between the actions `rotate -> crop` and `crop -> rotate`\n// this makes sure the initial state is always `rotate -> crop`\naccessors.state=accessors.state;// before load complete\nimageReadHandler.beforeComplete(output);// done loading image\nimageReadHandler.complete(output);}catch(err){imageReadHandler.error(err);}finally{imageReadToken=undefined;}})();// call to abort load\nreturn()=>{imageReadCancelled=true;imageReadToken&&imageReadToken.cancel();};};//#endregion\n//#region write image\nconst write=writer=>{// not ready to start processing\nif(!accessors.loadState.complete)return;// reset process state to undefined\naccessors.processState=undefined;const imageWriteHandler=createProcessingHandler('processState','process');const writerState={src:accessors.file,imageState:accessors.state,dest:undefined};// willProcessImageState\nif(!writer){imageWriteHandler.start();imageWriteHandler.complete(writerState);return;}// we need this token to be a blet to cancel the processing operation\nlet imageWriteToken={cancel:noop};const writerOptions={};const processOptions=_objectSpread({token:imageWriteToken},imageWriteHandler);// start writing image\n(async()=>{imageWriteHandler.start();try{const output=await process(writerState,writer,writerOptions,processOptions);imageWriteHandler.complete(output);}catch(err){imageWriteHandler.error(err);}finally{imageWriteToken=undefined;}})();// call to abort processing\nreturn()=>imageWriteToken&&imageWriteToken.cancel();};//#endregion\n//#region api\ndefineMethods(accessors,{read,write,on:sub});//#endregion\n// expose store API\nreturn{accessors,stores};};// @ts-ignore\nconst editorEventsToBubble=['loadstart','loadabort','loaderror','loadprogress','load','processstart','processabort','processerror','processprogress','process'];const imagePrivateProps=['flip','cropOrigin','isRotatedSideways','perspective','perspectiveX','perspectiveY','cropRange'];const editorPrivateProps=['images'];const getImagePropGroupedName=prop=>`image${capitalizeFirstLetter(prop)}`;const getEditorProps=()=>{const imageProperties=getImagePublicPropNames(imageProps).map(getImagePropGroupedName);const editorProperties=props.map(([prop])=>prop).filter(prop=>!editorPrivateProps.includes(prop));return imageProperties.concat(editorProperties);};const getImagePublicPropNames=imageProps=>imageProps.map(([prop])=>prop).filter(prop=>!imagePrivateProps.includes(prop));var createImageEditor=()=>{// create default stores\nconst{stores,accessors}=createStores(props);// set up pub/sub for the app layer\nconst{sub,pub}=pubsub();const bubble=name=>value=>pub(name,value);// helper method\nconst getImageObjSafe=()=>accessors.images?accessors.images[0]:{};// create shortcuts to image props : `crop` -> `imageCrop`\nlet initialImageProps={};getImagePublicPropNames(imageProps).forEach(prop=>{Object.defineProperty(accessors,getImagePropGroupedName(prop),{get:()=>{const image=getImageObjSafe();if(!image)return;return image.accessors[prop];},set:value=>{const image=getImageObjSafe();if(!image){initialImageProps[prop]=value;return;}image.accessors[prop]=value;}});});// handling loading an image if a src is set\nconst unsubSrc=stores.src.subscribe(src=>{// no image set, means clear active image\nif(!src)return accessors.images=[];// exit here if we don't have an imageReader we'll wait for an imageReader to be defined\nif(!accessors.imageReader)return;// this is the first image so let's use `loadSrc` so we can also apply initial props\nif(!accessors.images.length)return loadSrc(src);loadImage(src).catch(()=>{// fail silently, is handled with 'loaderror' event\n});});const unsubReader=stores.imageReader.subscribe(reader=>{// can't do anything without an image reader\nif(!reader)return;// an image has already been loaded no need to load images that were set earlier\nif(accessors.images.length)return;// no image to load, we'll wait for images to be set to the `src` prop\nif(!accessors.src)return;// src is waiting to be loaded so let's pick it up,\n// push it back a tick so we know initialImageProps are set\nloadSrc(accessors.src).catch(()=>{// fail silently, is handled with 'loaderror' event\n});});// loads the initial source, differs from loadImage as this method picks up any set image props\nconst loadSrc=src=>Promise.resolve().then(()=>loadImage(src,initialImageProps));// internal helper method to get active image\nconst getImage=()=>accessors.images&&accessors.images[0];//#endregion\n//#region public method (note that these are also called from UI, name of method is name of dispatched event in UI)\n// load image, resolve when image is loaded\nlet imageLoadAbort;const loadImage=(src,options={})=>new Promise((resolve,reject)=>{// get current image\nlet image=getImage();// determine min defined image size (is crop min size)\nconst minImageSize=options.cropMinSize||image&&image.accessors.cropMinSize;// if already has image, remove existing image\nif(image)removeImage();// access image props and stores\nimage=createImage({minSize:minImageSize});editorEventsToBubble.map(event=>image.accessors.on(event,bubble(event)));// done, clean up listeners\nconst done=()=>{initialImageProps={};unsubReject();unsubResolve();};const unsubReject=image.accessors.on('loaderror',error=>{done();reject(error);});image.accessors.on('beforeload',()=>{// normalize all prefixed options (from imageRotation -> rotation)\nconst normalizedOptions=getImagePublicPropNames(imageProps).reduce((prev,prop)=>{// test if already has image prop (rotation)\nif(prop in options){prev[prop]=options[prop];return prev;}// test if has prefixed image prop (imageRotation)\nelse{const groupedPropName=getImagePropGroupedName(prop);if(groupedPropName in options){prev[prop]=options[groupedPropName];}}return prev;},{});// if set as initial props we apply in most logical order\n['cropLimitToImage','crop','cropAspectRatio','rotation'].forEach(prop=>{if(!(prop in normalizedOptions))return;// asign to `image`\nimage.accessors[prop]=normalizedOptions[prop];// remove from normalizedOptions\ndelete normalizedOptions[prop];});// assign remaining options to `image`\nObject.assign(image.accessors,normalizedOptions);});const unsubResolve=image.accessors.on('load',output=>{imageLoadAbort=undefined;done();resolve(output);});// set new image\naccessors.images=[image];// assign passed options to editor accessors, we ignore 'src'\nif(options.imageReader)accessors.imageReader=options.imageReader;if(options.imageWriter)accessors.imageWriter=options.imageWriter;// start reading image\nimageLoadAbort=image.accessors.read(src,{reader:accessors.imageReader});});// start processing a loaded image, resolve when image is processed\nlet imageProcessAbort;const processImage=(src,options)=>{return new Promise(async(resolve,reject)=>{// if src supplied, first load src, then process\nsrc&&(await loadImage(src,options));// get current active image\nconst image=getImage();// needs image for processing\nif(!image)return reject('no image');// done, clean up listeners\nconst done=()=>{imageProcessAbort=undefined;unsubReject();unsubResolve();};const unsubReject=image.accessors.on('processerror',error=>{done();reject(error);});const unsubResolve=image.accessors.on('process',output=>{done();resolve(output);});imageProcessAbort=image.accessors.write(accessors.imageWriter);});};const abortProcessImage=()=>{const image=getImage();if(!image)return;if(imageProcessAbort)imageProcessAbort();image.accessors.processState=undefined;};// used internally (triggered by 'x' button when error loading image in UI)\nconst abortLoadImage=()=>{accessors.images=[];};// edit image, loads an image and resolve when image is processed\nconst editImage=(src,options)=>new Promise((resolve,reject)=>{loadImage(src,options).then(()=>{// access image props and stores\nconst{images}=accessors;const image=images[0];// done, clean up listeners\nconst done=()=>{unsubReject();unsubResolve();};const unsubReject=image.accessors.on('processerror',error=>{done();reject(error);});const unsubResolve=image.accessors.on('process',output=>{done();resolve(output);});}).catch(reject);});const removeImage=()=>{// no images, nothing to remove\nconst image=getImage();if(!image)return;// try to abort image load\nif(imageLoadAbort)imageLoadAbort();image.accessors.loadState=undefined;// clear images\naccessors.images=[];};//#endregion\nObject.defineProperty(accessors,'stores',{get:()=>stores});//#region API\ndefineMethods(accessors,{on:sub,loadImage,abortLoadImage,editImage,removeImage,processImage,abortProcessImage,destroy:()=>{unsubSrc();unsubReader();}});return accessors;//#endregion\n};var getComponentExportedProps=Component=>{const descriptors=Object.getOwnPropertyDescriptors(Component.prototype);return Object.keys(descriptors).filter(key=>!!descriptors[key]['get']);};function circOut(t){return Math.sqrt(1- --t*t);}function is_date(obj){return Object.prototype.toString.call(obj)==='[object Date]';}function get_interpolator(a,b){if(a===b||a!==a)return()=>a;const type=typeof a;if(type!==typeof b||Array.isArray(a)!==Array.isArray(b)){throw new Error('Cannot interpolate values of different type');}if(Array.isArray(a)){const arr=b.map((bi,i)=>{return get_interpolator(a[i],bi);});return t=>arr.map(fn=>fn(t));}if(type==='object'){if(!a||!b)throw new Error('Object cannot be null');if(is_date(a)&&is_date(b)){a=a.getTime();b=b.getTime();const delta=b-a;return t=>new Date(a+t*delta);}const keys=Object.keys(b);const interpolators={};keys.forEach(key=>{interpolators[key]=get_interpolator(a[key],b[key]);});return t=>{const result={};keys.forEach(key=>{result[key]=interpolators[key](t);});return result;};}if(type==='number'){const delta=b-a;return t=>a+t*delta;}throw new Error(`Cannot interpolate ${type} values`);}function tweened(value,defaults={}){const store=writable(value);let task;let target_value=value;function set(new_value,opts){if(value==null){store.set(value=new_value);return Promise.resolve();}target_value=new_value;let previous_task=task;let started=false;let{delay=0,duration=400,easing=identity,interpolate=get_interpolator}=assign(assign({},defaults),opts);if(duration===0){if(previous_task){previous_task.abort();previous_task=null;}store.set(value=target_value);return Promise.resolve();}const start=now()+delay;let fn;task=loop(now=>{if(now<start)return true;if(!started){fn=interpolate(value,new_value);if(typeof duration==='function')duration=duration(value,new_value);started=true;}if(previous_task){previous_task.abort();previous_task=null;}const elapsed=now-start;if(elapsed>duration){store.set(value=new_value);return false;}// @ts-ignore\nstore.set(value=fn(easing(elapsed/duration)));return true;});return task.promise;}return{set,update:(fn,opts)=>set(fn(target_value,value),opts),subscribe:store.subscribe};}function tick_spring(ctx,last_value,current_value,target_value){if(typeof current_value==='number'){// @ts-ignore\nconst delta=target_value-current_value;// @ts-ignore\nconst velocity=(current_value-last_value)/(ctx.dt||1/60);// guard div by 0\nconst spring=ctx.opts.stiffness*delta;const damper=ctx.opts.damping*velocity;const acceleration=(spring-damper)*ctx.inv_mass;const d=(velocity+acceleration)*ctx.dt;if(Math.abs(d)<ctx.opts.precision&&Math.abs(delta)<ctx.opts.precision){return target_value;// settled\n}else{ctx.settled=false;// signal loop to keep ticking\n// @ts-ignore\nreturn current_value+d;}}else if(isArray(current_value)){// @ts-ignore\nreturn current_value.map((_,i)=>tick_spring(ctx,last_value[i],current_value[i],target_value[i]));}else if(typeof current_value==='object'){const next_value={};// @ts-ignore\nfor(const k in current_value){// @ts-ignore\nnext_value[k]=tick_spring(ctx,last_value[k],current_value[k],target_value[k]);}// @ts-ignore\nreturn next_value;}else{throw new Error(`Cannot spring ${typeof current_value} values`);}}function spring(value,opts={}){const store=writable(value);const{stiffness=0.15,damping=0.8,precision=0.01}=opts;let last_time;let task;let current_token;let last_value=value;let target_value=value;let inv_mass=1;let inv_mass_recovery_rate=0;let cancel_task=false;function set(new_value,opts={}){target_value=new_value;const token=current_token={};if(value==null||opts.hard||spring.stiffness>=1&&spring.damping>=1){cancel_task=true;// cancel any running animation\nlast_time=null;last_value=new_value;store.set(value=target_value);return Promise.resolve();}else if(opts.soft){const rate=opts.soft===true?0.5:+opts.soft;inv_mass_recovery_rate=1/(rate*60);inv_mass=0;// infinite mass, unaffected by spring forces\n}if(!task){last_time=null;cancel_task=false;const ctx={inv_mass:undefined,opts:spring,settled:true,dt:undefined};task=loop(now=>{if(last_time===null)last_time=now;if(cancel_task){cancel_task=false;task=null;return false;}inv_mass=Math.min(inv_mass+inv_mass_recovery_rate,1);// altered so doesn't create a new object\nctx.inv_mass=inv_mass;ctx.opts=spring;ctx.settled=true;// tick_spring may signal false\nctx.dt=(now-last_time)*60/1000;const next_value=tick_spring(ctx,last_value,value,target_value);last_time=now;last_value=value;store.set(value=next_value);if(ctx.settled)task=null;return!ctx.settled;});}return new Promise(fulfil=>{task.promise.then(()=>{if(token===current_token)fulfil();});});}const spring={set,update:(fn,opts)=>set(fn(target_value,value),opts),subscribe:store.subscribe,stiffness,damping,precision};return spring;}var prefersReducedMotion=readable(false,set=>{const mql=window.matchMedia('(prefers-reduced-motion:reduce)');set(mql.matches);mql.onchange=()=>set(mql.matches);});var hasResizeObserver=()=>'ResizeObserver'in window;//\nconst rectNext=rectCreateEmpty();const updateNodeRect=(node,x,y,width,height)=>{if(!node.rect)node.rect=rectCreateEmpty();const rect=node.rect;rectUpdate(rectNext,x,y,width,height);if(rectEqual(rect,rectNext))return;rectUpdateWithRect(rect,rectNext);node.dispatchEvent(new CustomEvent('measure',{detail:rect}));};// measures the element\nconst r=Math.round;const measureViewRect=node=>{const clientRect=node.getBoundingClientRect();updateNodeRect(node,r(clientRect.x),r(clientRect.y),r(clientRect.width),r(clientRect.height));};const measureOffset=node=>updateNodeRect(node,node.offsetLeft,node.offsetTop,node.offsetWidth,node.offsetHeight);// holds all the elements to measure using requestAnimationFrame\nconst elements=[];// draw loop\nlet frame=null;function tick(){if(!elements.length){frame=null;return;}elements.forEach(node=>node.measure(node));frame=requestAnimationFrame(tick);}let observer;// ResizeObserver API not known by TypeScript\nvar measurable=(node,options={})=>{const{observePosition=false,observeViewRect=false,once=false,disabled=false}=options;// exit\nif(disabled)return;// use resize observe if available\nif(hasResizeObserver()&&!observePosition&&!observeViewRect){// we only create one observer, it will observe all registered elements\nif(!observer){// @ts-ignore: [2020-02-20] ResizeObserver API not known by TypeScript\nobserver=new ResizeObserver(entries=>{entries.forEach(entry=>measureOffset(entry.target));});}// start observing this node\nobserver.observe(node);// measure our node for the first time\nmeasureOffset(node);// if should only measure once, remove now\nif(once)observer.unobserve(node);// and we done, need to return a clean up method for when our node is destroyed\nreturn{destroy(){// already unobserved this node\nif(once)return;observer.unobserve(node);// TODO: test if all nodes have been removed, if so, remove observer\n}};}// set measure function\nnode.measure=observeViewRect?measureViewRect:measureOffset;// add so the element is measured\nelements.push(node);// start measuring on next frame, we set up a single measure loop,\n// the loop will check if there's still elements that need to be measured,\n// else it will stop running\nif(!frame)frame=requestAnimationFrame(tick);// measure this element now\nnode.measure(node);// remove method\nreturn{destroy(){const index=elements.indexOf(node);elements.splice(index,1);}};};var focusvisible=element=>{let isKeyboardInteraction=false;const handlePointerdown=()=>{isKeyboardInteraction=false;};const handleKeydown=()=>{isKeyboardInteraction=true;};const handleKeyup=()=>{isKeyboardInteraction=false;};const handleFocus=e=>{if(!isKeyboardInteraction)return;e.target.dataset.focusVisible='';};const handleBlur=e=>{delete e.target.dataset.focusVisible;};const map={pointerdown:handlePointerdown,keydown:handleKeydown,keyup:handleKeyup,focus:handleFocus,blur:handleBlur};Object.keys(map).forEach(event=>element.addEventListener(event,map[event],true));return{destroy(){Object.keys(map).forEach(event=>element.removeEventListener(event,map[event],true));}};};var isImage=file=>/^image/.test(file.type);const getFilesFromEvent=e=>{const{items,files}=e.dataTransfer;if(items){return Array.from(items).filter(item=>item.kind==='file').map(item=>item.getAsFile());}return Array.from(files)||[];};var dropable=node=>{const handleDragOver=e=>{// need to be prevent default to allow drop\ne.preventDefault();};const handleDrop=e=>{e.preventDefault();e.stopPropagation();// prevents parents from catching this drop\nnode.dispatchEvent(new CustomEvent('dropfiles',{detail:{event:e,files:getFilesFromEvent(e).filter(file=>isImage(file))}}));};node.addEventListener('drop',handleDrop);node.addEventListener('dragover',handleDragOver);// remove method\nreturn{destroy(){node.removeEventListener('drop',handleDrop);node.removeEventListener('dragover',handleDragOver);}};};let result$8=null;var supportsWebGL2=()=>{if(result$8===null){if('WebGL2RenderingContext'in window){let canvas;try{canvas=h('canvas');result$8=!!canvas.getContext('webgl2');}catch(err){result$8=false;}canvas&&releaseCanvas(canvas);}else{result$8=false;}}return result$8;};var isPowerOf2=value=>(value&value-1)===0;var stringReplace=(str,entries={},prefix='',postfix='')=>{return Object.keys(entries).filter(key=>!isObject(entries[key])).reduce((prev,curr)=>{return prev.replace(new RegExp(prefix+curr+postfix),entries[curr]);},str);};var SHADER_FRAG_HEAD=\"#version 300 es\\nprecision highp float;\\n\\nout vec4 fragColor;\";// eslint-disable-line\nvar SHADER_FRAG_INIT=\"\\nfloat a=1.0;vec4 fillColor=uColor;vec4 textureColor=texture(uTexture,vTexCoord);textureColor*=(1.0-step(1.0,vTexCoord.y))*step(0.0,vTexCoord.y)*(1.0-step(1.0,vTexCoord.x))*step(0.0,vTexCoord.x);\";// eslint-disable-line\nvar SHADER_FRAG_MASK=\"\\nuniform float uMaskFeather[8];uniform float uMaskBounds[4];uniform float uMaskOpacity;float mask(float x,float y,float bounds[4],float opacity){return 1.0-(1.0-(smoothstep(bounds[3],bounds[3]+1.0,x)*(1.0-smoothstep(bounds[1]-1.0,bounds[1],x))*(1.0-step(bounds[0],y))*step(bounds[2],y)))*(1.0-opacity);}\";// eslint-disable-line\nvar SHADER_FRAG_MASK_APPLY=\"\\nfloat m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);\";// eslint-disable-line\nvar SHADER_FRAG_MASK_FEATHER_APPLY=\"\\nfloat leftFeatherOpacity=step(uMaskFeather[1],gl_FragCoord.x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],gl_FragCoord.x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],gl_FragCoord.x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],gl_FragCoord.x));a*=leftFeatherOpacity*rightFeatherOpacity;\";// eslint-disable-line\nvar SHADER_FRAG_RECT_AA=\"\\nvec2 scaledPoint=vec2(vRectCoord.x*uSize.x,vRectCoord.y*uSize.y);a*=smoothstep(0.0,1.0,uSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);\";// eslint-disable-line\nvar SHADER_FRAG_CORNER_RADIUS=\"\\nvec2 s=(uSize-2.0)*.5;vec2 r=(vRectCoord*uSize);vec2 p=r-(uSize*.5);float cornerRadius=uCornerRadius[0];bool left=r.x<s.x;bool top=r.y<s.x;if(!left&&top){cornerRadius=uCornerRadius[1];}if(!left&&!top){cornerRadius=uCornerRadius[3];}if(left&&!top){cornerRadius=uCornerRadius[2];}a*=1.0-clamp(length(max(abs(p)-(s-cornerRadius),0.0))-cornerRadius,0.0,1.0);\";// eslint-disable-line\nvar SHADER_FRAG_SHAPE_BLEND_COLOR=\"\\nfillColor.a*=a;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);textureColor*=uTextureOpacity;textureColor.a*=a;textureColor.rgb*=m*a;textureColor.rgb+=(1.0-m)*(uCanvasColor.rgb*textureColor.a);fragColor=textureColor+(fillColor*(1.0-textureColor.a));\";// eslint-disable-line\nvar SHADER_FRAG_TEXTURE_COLORIZE=\"\\nif(uTextureColor.a!=0.0&&textureColor.a>0.0){vec3 colorFlattened=textureColor.rgb/textureColor.a;if(colorFlattened.r>.999999&&colorFlattened.g==0.0&&colorFlattened.b>.999999){textureColor.rgb=uTextureColor.rgb*textureColor.a;}textureColor*=uTextureColor.a;}\";// eslint-disable-line\nvar SHADER_VERT_HEAD=\"#version 300 es\\n\\nin vec4 aPosition;uniform mat4 uMatrix;\";// eslint-disable-line\nvar SHADER_VERT_MULTIPLY_MATRUX=\"\\ngl_Position=uMatrix*vec4(aPosition.x,aPosition.y,0,1);\";// eslint-disable-line\nvar SHADER_VERT_TEXTURE=\"\\nin vec2 aTexCoord;out vec2 vTexCoord;\";// eslint-disable-line\nconst SHADER_VERT_SNIPPETS={head:SHADER_VERT_HEAD,text:SHADER_VERT_TEXTURE,matrix:SHADER_VERT_MULTIPLY_MATRUX};const SHADER_FRAG_SNIPPETS={head:SHADER_FRAG_HEAD,mask:SHADER_FRAG_MASK,init:SHADER_FRAG_INIT,colorize:SHADER_FRAG_TEXTURE_COLORIZE,maskapply:SHADER_FRAG_MASK_APPLY,maskfeatherapply:SHADER_FRAG_MASK_FEATHER_APPLY,edgeaa:SHADER_FRAG_RECT_AA,cornerradius:SHADER_FRAG_CORNER_RADIUS,fragcolor:SHADER_FRAG_SHAPE_BLEND_COLOR};const transpileShader=(gl,src,type)=>{src=stringReplace(src,type===gl.VERTEX_SHADER?SHADER_VERT_SNIPPETS:SHADER_FRAG_SNIPPETS,'##').trim();// ready if supports webgl\nif(supportsWebGL2())return src;src=src.replace(/#version.+/gm,'').trim();src=src.replace(/^\\/\\/\\#/gm,'#');if(type===gl.VERTEX_SHADER){src=src.replace(/in /gm,'attribute ').replace(/out /g,'varying ');}if(type===gl.FRAGMENT_SHADER){src=src.replace(/in /gm,'varying ').replace(/out.*?;/gm,'').replace(/texture\\(/g,'texture2D(').replace(/fragColor/g,'gl_FragColor');}return`${src}`;};const compileShader=(gl,src,type)=>{const shader=gl.createShader(type);const transpiledSrc=transpileShader(gl,src,type);gl.shaderSource(shader,transpiledSrc);gl.compileShader(shader);if(!gl.getShaderParameter(shader,gl.COMPILE_STATUS)){console.error(gl.getShaderInfoLog(shader));}return shader;};const createShader=(gl,vertexShader,fragmentShader,attribs,uniforms)=>{const program=gl.createProgram();gl.attachShader(program,compileShader(gl,vertexShader,gl.VERTEX_SHADER));gl.attachShader(program,compileShader(gl,fragmentShader,gl.FRAGMENT_SHADER));gl.linkProgram(program);const locations={};attribs.forEach(name=>{locations[name]=gl.getAttribLocation(program,name);});uniforms.forEach(name=>{locations[name]=gl.getUniformLocation(program,name);});return{program,locations};};const canMipMap=source=>{if(supportsWebGL2())return true;return isPowerOf2(source.width)&&isPowerOf2(source.height);};const applyTextureProperties=(gl,source)=>{gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,canMipMap(source)?gl.LINEAR_MIPMAP_LINEAR:gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);if(canMipMap(source)){gl.generateMipmap(gl.TEXTURE_2D);}};const createTexture=(gl,source)=>{const texture=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,texture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,source);applyTextureProperties(gl,source);gl.bindTexture(gl.TEXTURE_2D,null);return texture;};const applyOpacity=(color,opacity=1)=>color?[color[0],color[1],color[2],isNumber(color[3])?opacity*color[3]:opacity]:[0,0,0,0];const mat4Create=()=>{const mat=new Float32Array(16);mat[0]=1;mat[5]=1;mat[10]=1;mat[15]=1;return mat;};const mat4Perspective=(mat,fovy,aspect,near,far)=>{const f=1.0/Math.tan(fovy/2);const nf=1/(near-far);mat[0]=f/aspect;mat[1]=0;mat[2]=0;mat[3]=0;mat[4]=0;mat[5]=f;mat[6]=0;mat[7]=0;mat[8]=0;mat[9]=0;mat[10]=(far+near)*nf;mat[11]=-1;mat[12]=0;mat[13]=0;mat[14]=2*far*near*nf;mat[15]=0;};const mat4Ortho=(mat,left,right,bottom,top,near,far)=>{const lr=1/(left-right);const bt=1/(bottom-top);const nf=1/(near-far);mat[0]=-2*lr;mat[1]=0;mat[2]=0;mat[3]=0;mat[4]=0;mat[5]=-2*bt;mat[6]=0;mat[7]=0;mat[8]=0;mat[9]=0;mat[10]=2*nf;mat[11]=0;mat[12]=(left+right)*lr;mat[13]=(top+bottom)*bt;mat[14]=(far+near)*nf;mat[15]=1;};const mat4Translate=(mat,x,y,z)=>{mat[12]=mat[0]*x+mat[4]*y+mat[8]*z+mat[12];mat[13]=mat[1]*x+mat[5]*y+mat[9]*z+mat[13];mat[14]=mat[2]*x+mat[6]*y+mat[10]*z+mat[14];mat[15]=mat[3]*x+mat[7]*y+mat[11]*z+mat[15];};const mat4Scale=(mat,s)=>{mat[0]=mat[0]*s;mat[1]=mat[1]*s;mat[2]=mat[2]*s;mat[3]=mat[3]*s;mat[4]=mat[4]*s;mat[5]=mat[5]*s;mat[6]=mat[6]*s;mat[7]=mat[7]*s;mat[8]=mat[8]*s;mat[9]=mat[9]*s;mat[10]=mat[10]*s;mat[11]=mat[11]*s;};const mat4ScaleX=(mat,s)=>{mat[0]=mat[0]*s;mat[1]=mat[1]*s;mat[2]=mat[2]*s;mat[3]=mat[3]*s;};const mat4ScaleY=(mat,s)=>{mat[4]=mat[4]*s;mat[5]=mat[5]*s;mat[6]=mat[6]*s;mat[7]=mat[7]*s;};const mat4RotateX=(mat,rad)=>{const s=Math.sin(rad);const c=Math.cos(rad);const a10=mat[4];const a11=mat[5];const a12=mat[6];const a13=mat[7];const a20=mat[8];const a21=mat[9];const a22=mat[10];const a23=mat[11];mat[4]=a10*c+a20*s;mat[5]=a11*c+a21*s;mat[6]=a12*c+a22*s;mat[7]=a13*c+a23*s;mat[8]=a20*c-a10*s;mat[9]=a21*c-a11*s;mat[10]=a22*c-a12*s;mat[11]=a23*c-a13*s;};const mat4RotateY=(mat,rad)=>{const s=Math.sin(rad);const c=Math.cos(rad);const a00=mat[0];const a01=mat[1];const a02=mat[2];const a03=mat[3];const a20=mat[8];const a21=mat[9];const a22=mat[10];const a23=mat[11];mat[0]=a00*c-a20*s;mat[1]=a01*c-a21*s;mat[2]=a02*c-a22*s;mat[3]=a03*c-a23*s;mat[8]=a00*s+a20*c;mat[9]=a01*s+a21*c;mat[10]=a02*s+a22*c;mat[11]=a03*s+a23*c;};const mat4RotateZ=(mat,rad)=>{const s=Math.sin(rad);const c=Math.cos(rad);const a00=mat[0];const a01=mat[1];const a02=mat[2];const a03=mat[3];const a10=mat[4];const a11=mat[5];const a12=mat[6];const a13=mat[7];mat[0]=a00*c+a10*s;mat[1]=a01*c+a11*s;mat[2]=a02*c+a12*s;mat[3]=a03*c+a13*s;mat[4]=a10*c-a00*s;mat[5]=a11*c-a01*s;mat[6]=a12*c-a02*s;mat[7]=a13*c-a03*s;};var degToRad=degrees=>degrees*Math.PI/180;var previewFragmentShader=\"\\n##head\\nin vec2 vTexCoord;uniform sampler2D uTexture;uniform sampler2D uTextureMarkup;uniform vec2 uTextureSize;uniform float uOpacity;uniform vec4 uFillColor;uniform vec4 uOverlayColor;uniform mat4 uColorMatrix;uniform vec4 uColorOffset;uniform float uClarityKernel[9];uniform float uClarityKernelWeight;uniform float uColorGamma;uniform float uColorVignette;uniform float uMaskClip;uniform float uMaskOpacity;uniform float uMaskBounds[4];uniform float uMaskCornerRadius[4];uniform float uMaskFeather[8];vec4 applyGamma(vec4 c,float g){c.r=pow(c.r,g);c.g=pow(c.g,g);c.b=pow(c.b,g);return c;}vec4 applyColorMatrix(vec4 c,mat4 m,vec4 o){vec4 cM=(c*m)+o;cM*=cM.a;return cM;}vec4 applyConvolutionMatrix(vec4 c,float k0,float k1,float k2,float k3,float k4,float k5,float k6,float k7,float k8,float w){if(w<=0.0)return c;vec2 pixel=vec2(1)/uTextureSize;vec4 colorSum=texture(uTexture,vTexCoord+pixel*vec2(-1.0,-1.0))*k0+texture(uTexture,vTexCoord+pixel*vec2(0.0,-1.0))*k1+texture(uTexture,vTexCoord+pixel*vec2(1.0,-1.0))*k2+texture(uTexture,vTexCoord+pixel*vec2(-1.0,0.0))*k3+texture(uTexture,vTexCoord+pixel*vec2(0.0,0.0))*k4+texture(uTexture,vTexCoord+pixel*vec2(1.0,0.0))*k5+texture(uTexture,vTexCoord+pixel*vec2(-1.0,1.0))*k6+texture(uTexture,vTexCoord+pixel*vec2(0.0,1.0))*k7+texture(uTexture,vTexCoord+pixel*vec2(1.0,1.0))*k8;vec4 color=vec4((colorSum/w).rgb,c.a);color.rgb=clamp(color.rgb,0.0,1.0);return color;}vec4 applyVignette(vec4 c,vec2 pos,vec2 center,float v){float d=distance(pos,center)/length(center);float f=1.0-(d*abs(v));if(v>0.0){c.rgb*=f;}else if(v<0.0){c.rgb+=(1.0-f)*(1.0-c.rgb);}return c;}vec4 blendPremultipliedAlpha(vec4 back,vec4 front){return front+(back*(1.0-front.a));}void main(){float x=gl_FragCoord.x;float y=gl_FragCoord.y;float a=1.0;float maskTop=uMaskBounds[0];float maskRight=uMaskBounds[1];float maskBottom=uMaskBounds[2];float maskLeft=uMaskBounds[3];float leftFeatherOpacity=step(uMaskFeather[1],x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],x));a*=leftFeatherOpacity*rightFeatherOpacity;float overlayColorAlpha=(smoothstep(maskLeft,maskLeft+1.0,x)*(1.0-smoothstep(maskRight-1.0,maskRight,x))*(1.0-step(maskTop,y))*step(maskBottom,y));if(uOverlayColor.a==0.0){a*=overlayColorAlpha;}vec2 offset=vec2(maskLeft,maskBottom);vec2 size=vec2(maskRight-maskLeft,maskTop-maskBottom)*.5;vec2 center=offset.xy+size.xy;int pixelX=int(step(center.x,x));int pixelY=int(step(y,center.y));float cornerRadius=0.0;if(pixelX==0&&pixelY==0)cornerRadius=uMaskCornerRadius[0];if(pixelX==1&&pixelY==0)cornerRadius=uMaskCornerRadius[1];if(pixelX==0&&pixelY==1)cornerRadius=uMaskCornerRadius[2];if(pixelX==1&&pixelY==1)cornerRadius=uMaskCornerRadius[3];float cornerOffset=sign(cornerRadius)*length(max(abs(gl_FragCoord.xy-size-offset)-size+cornerRadius,0.0))-cornerRadius;float cornerOpacity=1.0-smoothstep(0.0,1.0,cornerOffset);a*=cornerOpacity;vec2 scaledPoint=vec2(vTexCoord.x*uTextureSize.x,vTexCoord.y*uTextureSize.y);a*=smoothstep(0.0,1.0,uTextureSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uTextureSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);vec4 color=texture(uTexture,vTexCoord);color=applyConvolutionMatrix(color,uClarityKernel[0],uClarityKernel[1],uClarityKernel[2],uClarityKernel[3],uClarityKernel[4],uClarityKernel[5],uClarityKernel[6],uClarityKernel[7],uClarityKernel[8],uClarityKernelWeight);color=applyGamma(color,uColorGamma);color=applyColorMatrix(color,uColorMatrix,uColorOffset);color=blendPremultipliedAlpha(uFillColor,color);color*=a;color=blendPremultipliedAlpha(color,texture(uTextureMarkup,vTexCoord));if(uColorVignette!=0.0){vec2 pos=gl_FragCoord.xy-offset;color=applyVignette(color,pos,center-offset,uColorVignette);}vec4 overlayColor=uOverlayColor*(1.0-overlayColorAlpha);overlayColor.rgb*=overlayColor.a;color=blendPremultipliedAlpha(color,overlayColor);if(uOverlayColor.a>0.0&&color.a<1.0&&uFillColor.a>0.0){color=blendPremultipliedAlpha(uFillColor,overlayColor);}color*=uOpacity;fragColor=color;}\";// eslint-disable-line\nvar previewVertexShader=\"\\n##head\\n##text\\nvoid main(){vTexCoord=aTexCoord;gl_Position=uMatrix*aPosition;}\";// eslint-disable-line\nvar pathVertexShader=\"#version 300 es\\n\\nin vec4 aPosition;in vec2 aNormal;in float aMiter;out vec2 vNormal;out float vMiter;uniform float uWidth;uniform mat4 uMatrix;void main(){vMiter=aMiter;vNormal=aNormal;float w=uWidth;gl_Position=uMatrix*vec4(aPosition.x+(aNormal.x*w*.5*aMiter),aPosition.y+(aNormal.y*w*.5*aMiter),0,1);}\";// eslint-disable-line\nvar pathFragmentShader=\"\\n##head\\n##mask\\nin vec2 vNormal;in float vMiter;uniform float uWidth;uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;float w=(uWidth-1.0)*.5;float d=1.0-abs(vMiter);float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);fillColor.a*=clamp(smoothstep(0.25,1.0,d*w),0.0,1.0);fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}\";// eslint-disable-line\nvar rectVertexShader=\"\\n##head\\n##text\\nin vec2 aRectCoord;out vec2 vRectCoord;void main(){vTexCoord=aTexCoord;vRectCoord=aRectCoord;\\n##matrix\\n}\";// eslint-disable-line\nvar rectFragmentShader=\"\\n##head\\n##mask\\nin vec2 vTexCoord;in vec2 vRectCoord;uniform sampler2D uTexture;uniform vec4 uTextureColor;uniform float uTextureOpacity;uniform vec4 uColor;uniform float uCornerRadius[4];uniform vec2 uSize;uniform vec2 uPosition;uniform vec4 uCanvasColor;void main(){\\n##init\\n##colorize\\n##edgeaa\\n##cornerradius\\n##maskfeatherapply\\n##maskapply\\n##fragcolor\\n}\";// eslint-disable-line\nvar ellipseVertexShader=\"\\n##head\\n##text\\nvoid main(){vTexCoord=vec2(aTexCoord.x*2.0-1.0,aTexCoord.y*2.0-1.0);\\n##matrix\\n}\";// eslint-disable-line\nvar ellipseFragmentShader=\"\\n##head\\n##mask\\nin vec2 vTexCoord;uniform sampler2D uTexture;uniform float uTextureOpacity;uniform vec2 uRadius;uniform vec4 uColor;uniform int uInverted;uniform vec4 uCanvasColor;void main(){\\n##init\\nfloat ar=uRadius.x/uRadius.y;vec2 rAA=vec2(uRadius.x-1.0,uRadius.y-(1.0/ar));vec2 scaledPointSq=vec2((vTexCoord.x*uRadius.x)*(vTexCoord.x*uRadius.x),(vTexCoord.y*uRadius.y)*(vTexCoord.y*uRadius.y));float p=(scaledPointSq.x/(uRadius.x*uRadius.x))+(scaledPointSq.y/(uRadius.y*uRadius.y));float pAA=(scaledPointSq.x/(rAA.x*rAA.x))+(scaledPointSq.y/(rAA.y*rAA.y));a=smoothstep(1.0,p/pAA,p);if(uInverted==1)a=1.0-a;\\n##maskapply\\n##fragcolor\\n}\";// eslint-disable-line\nvar triangleVertexShader=\"\\n##head\\nvoid main(){\\n##matrix\\n}\";// eslint-disable-line\nvar triangleFragmentShader=\"\\n##head\\n##mask\\nuniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;\\n##maskapply\\nfillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}\";// eslint-disable-line\nconst createPathSegment=(vertices,index,a,b,c)=>{let ab;let bc;ab=vectorNormalize(vectorCreate(b.x-a.x,b.y-a.y));bc=vectorNormalize(vectorCreate(c.x-b.x,c.y-b.y));const tangent=vectorNormalize(vectorCreate(ab.x+bc.x,ab.y+bc.y));const miter=vectorCreate(-tangent.y,tangent.x);const normal=vectorCreate(-ab.y,ab.x);// TODO: The Math.min is a \"dirty\" hack to prevent miter spikes, should bevel line edges\n// const dist = Math.min(1, 1 / vectorDot(miter, normal));\nconst miterLength=1/vectorDot(miter,normal);vertices[index]=b.x;vertices[index+1]=b.y;vertices[index+2]=miter.x;vertices[index+3]=miter.y;vertices[index+4]=-miterLength;vertices[index+5]=b.x;vertices[index+6]=b.y;vertices[index+7]=miter.x;vertices[index+8]=miter.y;vertices[index+9]=miterLength;};const createPathVertices=(points,close)=>{let a,b,c,i=0;const l=points.length;const stride=10;const vertices=new Float32Array((close?l+1:l)*stride);const first=points[0];const last=points[l-1];for(i=0;i<l;i++){a=points[i-1];b=points[i];c=points[i+1];// if previous point not available use inverse vector to next point\nif(!a)a=close?last:vectorCreate(b.x+(b.x-c.x),b.y+(b.y-c.y));// if next point not available use inverse vector from previous point\nif(!c)c=close?first:vectorCreate(b.x+(b.x-a.x),b.y+(b.y-a.y));createPathSegment(vertices,i*stride,a,b,c);}if(close)createPathSegment(vertices,l*stride,last,first,points[1]);return vertices;};const rectPointsToVertices=points=>{// [tl, tr, br, bl]\n// B   D\n// | \\ |\n// A  C\nconst vertices=new Float32Array(8);vertices[0]=points[3].x;vertices[1]=points[3].y;vertices[2]=points[0].x;vertices[3]=points[0].y;vertices[4]=points[2].x;vertices[5]=points[2].y;vertices[6]=points[1].x;vertices[7]=points[1].y;return vertices;};const trianglePointToVertices=points=>{const vertices=new Float32Array(6);vertices[0]=points[0].x;vertices[1]=points[0].y;vertices[2]=points[1].x;vertices[3]=points[1].y;vertices[4]=points[2].x;vertices[5]=points[2].y;return vertices;};const createRectPoints=(rect,rotation=0,flipX,flipY)=>{const corners=rectGetCorners(rect);const cx=rect.x+rect.width*0.5;const cy=rect.y+rect.height*0.5;if(flipX||flipY)vectorsFlip(corners,flipX,flipY,cx,cy);if(rotation!==0)vectorsRotate(corners,rotation,cx,cy);return corners;};const createEllipseOutline=(x,y,width,height,rotation,flipX,flipY)=>{const points=[];// decide how much points we need to describe the circle\nconst size=Math.abs(width)+Math.abs(height);const precision=Math.max(20,Math.round(size/6));const w=width*0.5;const h=height*0.5;const cx=x+w;const cy=y+h;for(let i=0;i<precision;i++){points.push(vectorCreate(cx+w*Math.cos(i*(Math.PI*2)/precision),cy+h*Math.sin(i*(Math.PI*2)/precision)));}if(flipX||flipY)vectorsFlip(points,flipX,flipY,cx,cy);if(rotation)vectorsRotate(points,rotation,cx,cy);return points;};const createRectOutline=(x,y,width,height,rotation,cornerRadius,flipX,flipY)=>{const points=[];if(cornerRadius.every(v=>v===0)){points.push(vectorCreate(x,y),// top left corner\nvectorCreate(x+width,y),// top right corner\nvectorCreate(x+width,y+height),// bottom right corner\nvectorCreate(x,y+height)// bottom left corner\n);}else{const[tl,tr,bl,br]=cornerRadius;const l=x;const r=x+width;const t=y;const b=y+height;// start at end of top left corner\npoints.push(vectorCreate(l+tl,t));pushRectCornerPoints(points,r-tr,t+tr,tr,-1);// move to bottom right corner\npoints.push(vectorCreate(r,t+tr));pushRectCornerPoints(points,r-br,b-br,br,0);// move to bottom left corner\npoints.push(vectorCreate(r-br,b));pushRectCornerPoints(points,l+bl,b-bl,bl,1);// move to top left corner\npoints.push(vectorCreate(l,b-bl));pushRectCornerPoints(points,l+tl,t+tl,tl,2);}if(flipX||flipY)vectorsFlip(points,flipX,flipY,x+width*0.5,y+height*0.5);if(rotation)vectorsRotate(points,rotation,x+width*0.5,y+height*0.5);return points;};const pushRectCornerPoints=(points,x,y,radius,offset)=>{const precision=Math.min(20,Math.max(4,Math.round(radius/2)));let p=0;let s=0;let rx=0;let ry=0;let i=0;for(;i<precision;i++){p=i/precision;s=offset*HALF_PI+p*HALF_PI;rx=radius*Math.cos(s);ry=radius*Math.sin(s);points.push(vectorCreate(x+rx,y+ry));}};var getWebGLContext=(canvas,attrs)=>canvas.getContext('webgl2',attrs)||canvas.getContext('webgl',attrs)||canvas.getContext('experimental-webgl',attrs);// prettier-ignore\n// B   D\n// | \\ |\n// A  C\nconst rectUV=new Float32Array([0.0,1.0,0.0,0.0,1.0,1.0,1.0,0.0]);var createGLImageDrawer=(canvas,imageData,imageSize,pixelDensity)=>{let viewSize={width:0,height:0};let viewSizeVisual={width:0,height:0};let viewAspectRatio;let viewPixelDensity;let viewZ;let markupMatrixCanvas;let markupMatrixFrameBuffer;let markupMatrix;let imagePositions;let maskTop;let maskRight;let maskBottom;let maskLeft;let maskOpacity;let maskBounds;let canvasColor=[0,0,0];//#region texture handling\n// offset +   0 : white\n// offset +   1 : transparent\n// offset +   2 : preview markup\n// offset +   3 : preview\n// offset + >=4 : markup\nconst TEXTURE_WHITE_INDEX=0;const TEXTURE_TRANSPARENT_INDEX=1;const TEXTURE_PREVIEW_MARKUP_INDEX=2;const TEXTURE_PREVIEW_INDEX=3;const TEXTURE_OFFSET=4;const textures=[];const setTextureObject=(index,texture,source=undefined)=>{const storedTexture=textures[index];if(storedTexture)gl.deleteTexture(storedTexture.texture);textures[index]={texture,source,textureAspectRatio:source?getAspectRatio(source.width,source.height):undefined};return index;};const getTextureSize=index=>{const source=textures[index].source;return source&&{width:source.width,height:source.height};};const getAvailableTextureIndex=()=>{const index=textures.findIndex(value=>value===undefined);return index<TEXTURE_OFFSET?textures.length:index;};const addTextureObject=(texture,source=undefined)=>setTextureObject(getAvailableTextureIndex(),texture,source);const addTexture=source=>addTextureObject(createTexture(gl,source),source);const setTexture=(index,source)=>{setTextureObject(index,createTexture(gl,source),source);};const reserveTexture=index=>{textures[index]={};};const removeTexture=index=>{const item=textures[index];gl.deleteTexture(item.texture);if(item.source instanceof HTMLCanvasElement)releaseCanvas(item.source);textures[index]=undefined;};//#endregion\n// resize view\nconst resize=(width,height,pixelDensity)=>{// density\nviewPixelDensity=pixelDensity;// visual size\nviewSizeVisual.width=width;viewSizeVisual.height=height;// size\nviewSize.width=width*pixelDensity;viewSize.height=height*pixelDensity;// calculate the aspect ratio, we use this to determine quad size\nviewAspectRatio=getAspectRatio(viewSize.width,viewSize.height);// sync dimensions with image data\ncanvas.width=viewSize.width;canvas.height=viewSize.height;// redefine matrices\nmarkupMatrixCanvas=mat4Create();mat4Ortho(markupMatrixCanvas,0,viewSize.width,viewSize.height,0,-1,1);markupMatrixFrameBuffer=mat4Create();const w=imageData.width*pixelDensity;const h=imageData.height*pixelDensity;mat4Ortho(markupMatrixFrameBuffer,0,w,h,0,-1,1);mat4Translate(markupMatrixFrameBuffer,0,h,0);mat4ScaleX(markupMatrixFrameBuffer,1);mat4ScaleY(markupMatrixFrameBuffer,-1);// update preview markup texture\ngl.bindTexture(gl.TEXTURE_2D,textures[TEXTURE_PREVIEW_MARKUP_INDEX].texture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,imageData.width,imageData.height,0,gl.RGBA,gl.UNSIGNED_BYTE,null);// set the filtering, we don't need mips\ngl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE);gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE);gl.bindFramebuffer(gl.FRAMEBUFFER,fb);gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,textures[TEXTURE_PREVIEW_MARKUP_INDEX].texture,0);// update image texture\nconst imageWidth=imageSize.width*pixelDensity;const imageHeight=imageSize.height*pixelDensity;const l=imageWidth*-0.5;const t=imageHeight*0.5;const r=imageWidth*0.5;const b=imageHeight*-0.5;// prettier-ignore\n// B   D\n// | \\ |\n// A  C\nimagePositions=new Float32Array([l,b,0,l,t,0,r,b,0,r,t,0]);gl.bindBuffer(gl.ARRAY_BUFFER,imagePositionsBuffer);gl.bufferData(gl.ARRAY_BUFFER,imagePositions,gl.STATIC_DRAW);// move image backwards so it's presented in actual pixel size\nviewZ=// 1. we calculate the z offset required to have the\n//    image height match the view height\n/*        /|\n                     / |\n                    /  | height / 2\n                   /   |\n            f / 2 /__z_|\n                  \\    |\n                   \\   |\n                    \\  |\n                     \\ |\n                      \\|\n            */imageSize.height/2/FOV_TAN_HALF*(// 2. we want to render the image at the actual height, viewsize / height gets us results in a 1:1 presentation\nviewSize.height/imageSize.height)*// 3. z has to be negative, therefor multiply by -1\n-1;};// fov is fixed\nconst FOV=degToRad(30);const FOV_TAN_HALF=Math.tan(FOV/2);// get gl drawing context\nconst gl=getWebGLContext(canvas,{antialias:false,alpha:false,premultipliedAlpha:true});// no drawing context received, exit\nif(!gl)return;// enable derivatives\ngl.getExtension('OES_standard_derivatives');// toggle gl settings\ngl.disable(gl.DEPTH_TEST);// set blend mode, we need it for alpha blending\ngl.enable(gl.BLEND);/*\n    https://webglfundamentals.org/webgl/lessons/webgl-and-alpha.html\n    most if not all Canvas 2D implementations work with pre-multiplied alpha.\n    That means when you transfer them to WebGL and UNPACK_PREMULTIPLY_ALPHA_WEBGL\n    is false WebGL will convert them back to un-premultipiled.\n    With pre-multiplied alpha on, [1, .5, .5, 0] does not exist, it's always [0, 0, 0, 0]\n    */gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA);gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,true);// something to look into:\n// gl.UNPACK_COLORSPACE_CONVERSION_WEBGL\n// create white base shape texture\nconst whiteTexture=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,whiteTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,// width\n1,// height\n0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array([255,255,255,255])// white background\n);setTextureObject(TEXTURE_WHITE_INDEX,whiteTexture);const transparentTexture=gl.createTexture();gl.bindTexture(gl.TEXTURE_2D,transparentTexture);gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,1,// width\n1,// height\n0,gl.RGBA,gl.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])// transparent background\n);setTextureObject(TEXTURE_TRANSPARENT_INDEX,transparentTexture);// create image markup texture and framebuffer\nconst imageMarkupTexture=gl.createTexture();setTextureObject(TEXTURE_PREVIEW_MARKUP_INDEX,imageMarkupTexture);const fb=gl.createFramebuffer();// #region image\n// create preview texture\nsetTexture(TEXTURE_PREVIEW_INDEX,imageData);const imagePositionsBuffer=gl.createBuffer();const texturePositionsBuffer=gl.createBuffer();gl.bindBuffer(gl.ARRAY_BUFFER,texturePositionsBuffer);gl.bufferData(gl.ARRAY_BUFFER,rectUV,gl.STATIC_DRAW);// prettier-ignore\n// B   D\n// | \\ |\n// A  C\nconst imageCoordinateCount=4;// create default pixel drawing program, supports what we need\nconst previewShader=createShader(gl,previewVertexShader,previewFragmentShader,['aPosition','aTexCoord'],['uMatrix','uTexture','uTextureMarkup','uTextureSize','uColorGamma','uColorVignette','uColorOffset','uColorMatrix','uClarityKernel','uClarityKernelWeight','uOpacity','uMaskOpacity','uMaskBounds','uMaskCornerRadius','uMaskFeather','uFillColor','uOverlayColor']);// tell canvas context to use program\ngl.useProgram(previewShader.program);// transform vars\nlet matrix;const drawPreviewImage=(originX,originY,translateX,translateY,rotateX,rotateY,rotateZ,scale,colorMatrix,opacity=1,clarity,gamma=1,vignette=0,maskFeather=[1,0,1,0,1,viewSizeVisual.width,1,viewSizeVisual.width],maskCornerRadius=[0,0,0,0],imageBackgroundColor=[0,0,0,0],imageOverlayColor=[0,0,0,0],enableMarkup=true)=>{const{program,locations}=previewShader;// convert to pixel density\ntranslateX*=viewPixelDensity;translateY*=viewPixelDensity;originX*=viewPixelDensity;originY*=viewPixelDensity;// apply\nmatrix=mat4Create();mat4Perspective(matrix,FOV,viewAspectRatio,1,-viewZ*2);// move image\nmat4Translate(matrix,translateX,-translateY,viewZ);// set rotation origin in view\nmat4Translate(matrix,originX,-originY,0);// rotate image\nmat4RotateZ(matrix,-rotateZ);// resize\nmat4Scale(matrix,scale);// reset rotation origin\nmat4Translate(matrix,-originX,originY,0);// flip\nmat4RotateY(matrix,rotateY);mat4RotateX(matrix,rotateX);//\n// tell context to draw preview\n//\ngl.useProgram(program);gl.enableVertexAttribArray(locations.aPosition);gl.enableVertexAttribArray(locations.aTexCoord);// set up texture\nconst previewTexture=textures[TEXTURE_PREVIEW_INDEX];gl.uniform1i(locations.uTexture,TEXTURE_PREVIEW_INDEX);gl.uniform2f(locations.uTextureSize,imageData.width,imageData.height);gl.activeTexture(gl.TEXTURE0+TEXTURE_PREVIEW_INDEX);gl.bindTexture(gl.TEXTURE_2D,previewTexture.texture);// set up markup texture\nconst textureIndex=enableMarkup?TEXTURE_PREVIEW_MARKUP_INDEX:TEXTURE_TRANSPARENT_INDEX;const markupTexture=textures[textureIndex];gl.uniform1i(locations.uTextureMarkup,textureIndex);gl.activeTexture(gl.TEXTURE0+textureIndex);gl.bindTexture(gl.TEXTURE_2D,markupTexture.texture);// set up buffers\ngl.bindBuffer(gl.ARRAY_BUFFER,imagePositionsBuffer);gl.vertexAttribPointer(locations.aPosition,3,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,texturePositionsBuffer);gl.vertexAttribPointer(locations.aTexCoord,2,gl.FLOAT,false,0,0);// update matrix\ngl.uniformMatrix4fv(locations.uMatrix,false,matrix);// overlay color\ngl.uniform4fv(locations.uOverlayColor,imageOverlayColor);gl.uniform4fv(locations.uFillColor,imageBackgroundColor);// convolution\nlet clarityWeight;if(!clarity){clarity=[0,0,0,0,1,0,0,0,0];clarityWeight=-1;}else{clarityWeight=clarity.reduce((prev,curr)=>prev+curr,0);clarityWeight=clarityWeight<=0?1:clarityWeight;}gl.uniform1fv(locations.uClarityKernel,clarity);gl.uniform1f(locations.uClarityKernelWeight,clarityWeight);gl.uniform1f(locations.uColorGamma,1.0/gamma);gl.uniform1f(locations.uColorVignette,vignette);// set color matrix values\ngl.uniform4f(locations.uColorOffset,colorMatrix[4],colorMatrix[9],colorMatrix[14],colorMatrix[19]);gl.uniformMatrix4fv(locations.uColorMatrix,false,[colorMatrix[0],colorMatrix[1],colorMatrix[2],colorMatrix[3],colorMatrix[5],colorMatrix[6],colorMatrix[7],colorMatrix[8],colorMatrix[10],colorMatrix[11],colorMatrix[12],colorMatrix[13],colorMatrix[15],colorMatrix[16],colorMatrix[17],colorMatrix[18]]);// opacity level\ngl.uniform1f(locations.uOpacity,opacity);// mask\ngl.uniform1f(locations.uMaskOpacity,maskOpacity);gl.uniform1fv(locations.uMaskBounds,maskBounds);gl.uniform1fv(locations.uMaskCornerRadius,maskCornerRadius.map(v=>v*pixelDensity));gl.uniform1fv(locations.uMaskFeather,maskFeather.map((v,i)=>i%2===0?v:v*pixelDensity));gl.drawArrays(gl.TRIANGLE_STRIP,0,imageCoordinateCount);gl.disableVertexAttribArray(locations.aPosition);gl.disableVertexAttribArray(locations.aTexCoord);};//#endregion\n// #region path\nconst pathShader=createShader(gl,pathVertexShader,pathFragmentShader,['aPosition','aNormal','aMiter'],['uColor','uCanvasColor','uMatrix','uWidth','uMaskBounds','uMaskOpacity']);const pathBuffer=gl.createBuffer();const strokePath=(points,width,color,close)=>{const{program,locations}=pathShader;gl.useProgram(program);gl.enableVertexAttribArray(locations.aPosition);gl.enableVertexAttribArray(locations.aNormal);gl.enableVertexAttribArray(locations.aMiter);const vertices=createPathVertices(points,close);const stride=Float32Array.BYTES_PER_ELEMENT*5;const normalOffset=Float32Array.BYTES_PER_ELEMENT*2;// at position 2\nconst miterOffset=Float32Array.BYTES_PER_ELEMENT*4;// at position 4\ngl.uniform1f(locations.uWidth,width+2.0);gl.uniform4fv(locations.uColor,color);gl.uniformMatrix4fv(locations.uMatrix,false,markupMatrix);gl.uniform4f(locations.uCanvasColor,canvasColor[0],canvasColor[1],canvasColor[2],1);gl.uniform1fv(locations.uMaskBounds,maskBounds);gl.uniform1f(locations.uMaskOpacity,maskOpacity);gl.bindBuffer(gl.ARRAY_BUFFER,pathBuffer);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);gl.vertexAttribPointer(locations.aPosition,2,gl.FLOAT,false,stride,0);gl.vertexAttribPointer(locations.aNormal,2,gl.FLOAT,false,stride,normalOffset);gl.vertexAttribPointer(locations.aMiter,1,gl.FLOAT,false,stride,miterOffset);gl.drawArrays(gl.TRIANGLE_STRIP,0,vertices.length/5);gl.disableVertexAttribArray(locations.aPosition);gl.disableVertexAttribArray(locations.aNormal);gl.disableVertexAttribArray(locations.aMiter);};//#endregion\n// #region triangle\nconst triangleShader=createShader(gl,triangleVertexShader,triangleFragmentShader,['aPosition'],['uColor','uCanvasColor','uMatrix','uMaskBounds','uMaskOpacity']);const triangleBuffer=gl.createBuffer();const fillTriangle=(vertices,backgroundColor)=>{const{program,locations}=triangleShader;gl.useProgram(program);gl.enableVertexAttribArray(locations.aPosition);gl.uniform4fv(locations.uColor,backgroundColor);gl.uniformMatrix4fv(locations.uMatrix,false,markupMatrix);gl.uniform1fv(locations.uMaskBounds,maskBounds);gl.uniform1f(locations.uMaskOpacity,maskOpacity);gl.uniform4f(locations.uCanvasColor,canvasColor[0],canvasColor[1],canvasColor[2],1);gl.bindBuffer(gl.ARRAY_BUFFER,triangleBuffer);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);gl.vertexAttribPointer(locations.aPosition,2,gl.FLOAT,false,0,0);gl.drawArrays(gl.TRIANGLE_STRIP,0,vertices.length/2);gl.disableVertexAttribArray(locations.aPosition);return vertices;};//#endregion\n// #region rect\nconst rectShaderAttributes=['aPosition','aTexCoord','aRectCoord'];const rectShaderUniforms=['uTexture','uColor','uMatrix','uCanvasColor','uTextureColor','uTextureOpacity','uPosition','uSize','uMaskBounds','uMaskOpacity','uMaskFeather','uCornerRadius'];const rectShader=createShader(gl,rectVertexShader,rectFragmentShader,rectShaderAttributes,rectShaderUniforms);const rectBuffer=gl.createBuffer();const rectTextureBuffer=gl.createBuffer();const rectCornerBuffer=gl.createBuffer();const rectTextureColorFilter=[0,0,0,0];const fillRect=(vertices,width,height,cornerRadius,backgroundColor,backgroundImage,opacity=1.0,colorFilter=rectTextureColorFilter,uv=rectUV,maskFeather=[1,0,1,0,1,Math.max(viewSize.width,imageData.width),1,Math.max(viewSize.width,imageData.width)])=>{const{program,locations}=rectShader;gl.useProgram(program);gl.enableVertexAttribArray(locations.aPosition);gl.enableVertexAttribArray(locations.aTexCoord);gl.enableVertexAttribArray(locations.aRectCoord);gl.uniform4fv(locations.uColor,backgroundColor);gl.uniform4fv(locations.uTextureColor,colorFilter);gl.uniform1f(locations.uTextureOpacity,opacity);gl.uniform2fv(locations.uSize,[width,height]);gl.uniform2fv(locations.uPosition,[vertices[2],vertices[3]]);gl.uniform1fv(locations.uCornerRadius,cornerRadius);gl.uniform4f(locations.uCanvasColor,canvasColor[0],canvasColor[1],canvasColor[2],1);// mask\ngl.uniform1fv(locations.uMaskFeather,maskFeather.map((v,i)=>i%2===0?v:v*pixelDensity));gl.uniform1fv(locations.uMaskBounds,maskBounds);gl.uniform1f(locations.uMaskOpacity,maskOpacity);gl.uniformMatrix4fv(locations.uMatrix,false,markupMatrix);const textureIndex=textures[backgroundImage]&&textures[backgroundImage].texture?backgroundImage:TEXTURE_TRANSPARENT_INDEX;gl.uniform1i(locations.uTexture,textureIndex);gl.activeTexture(gl.TEXTURE0+textureIndex);gl.bindTexture(gl.TEXTURE_2D,textures[textureIndex].texture);gl.bindBuffer(gl.ARRAY_BUFFER,rectTextureBuffer);gl.bufferData(gl.ARRAY_BUFFER,uv,gl.STATIC_DRAW);gl.vertexAttribPointer(locations.aTexCoord,2,gl.FLOAT,false,0,0);// we use these coordinates combined with the size of the rect to interpolate and alias edges\ngl.bindBuffer(gl.ARRAY_BUFFER,rectCornerBuffer);gl.bufferData(gl.ARRAY_BUFFER,rectUV,gl.STATIC_DRAW);gl.vertexAttribPointer(locations.aRectCoord,2,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,rectBuffer);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);gl.vertexAttribPointer(locations.aPosition,2,gl.FLOAT,false,0,0);gl.drawArrays(gl.TRIANGLE_STRIP,0,vertices.length/2);gl.disableVertexAttribArray(locations.aPosition);gl.disableVertexAttribArray(locations.aTexCoord);gl.disableVertexAttribArray(locations.aRectCoord);return vertices;};//#endregion\n// #region ellipse\nconst ellipseShader=createShader(gl,ellipseVertexShader,ellipseFragmentShader,['aPosition','aTexCoord'],['uTexture','uTextureOpacity','uColor','uCanvasColor','uMatrix','uRadius','uInverted','uMaskBounds','uMaskOpacity']);const ellipseBuffer=gl.createBuffer();const ellipseTextureBuffer=gl.createBuffer();const fillEllipse=(vertices,width,height,backgroundColor,backgroundImage=TEXTURE_TRANSPARENT_INDEX,opacity=1.0,inverted=false)=>{const{program,locations}=ellipseShader;gl.useProgram(program);gl.enableVertexAttribArray(locations.aPosition);gl.enableVertexAttribArray(locations.aTexCoord);gl.uniform2fv(locations.uRadius,[width*0.5,height*0.5]);gl.uniform1i(locations.uInverted,inverted?1:0);gl.uniform4fv(locations.uColor,backgroundColor);gl.uniformMatrix4fv(locations.uMatrix,false,markupMatrix);gl.uniform4f(locations.uCanvasColor,canvasColor[0],canvasColor[1],canvasColor[2],1);gl.uniform1fv(locations.uMaskBounds,maskBounds);gl.uniform1f(locations.uMaskOpacity,maskOpacity);gl.uniform1i(locations.uTexture,backgroundImage);gl.uniform1f(locations.uTextureOpacity,opacity);gl.activeTexture(gl.TEXTURE0+backgroundImage);gl.bindTexture(gl.TEXTURE_2D,textures[backgroundImage].texture);gl.bindBuffer(gl.ARRAY_BUFFER,ellipseTextureBuffer);gl.bufferData(gl.ARRAY_BUFFER,rectUV,gl.STATIC_DRAW);gl.vertexAttribPointer(locations.aTexCoord,2,gl.FLOAT,false,0,0);gl.bindBuffer(gl.ARRAY_BUFFER,ellipseBuffer);gl.bufferData(gl.ARRAY_BUFFER,vertices,gl.STATIC_DRAW);gl.vertexAttribPointer(locations.aPosition,2,gl.FLOAT,false,0,0);gl.drawArrays(gl.TRIANGLE_STRIP,0,vertices.length/2);gl.disableVertexAttribArray(locations.aPosition);gl.disableVertexAttribArray(locations.aTexCoord);};//#endregion\n//\n// draw calls\n//\nconst drawPath=(points,strokeWidth,strokeColor,opacity)=>{// is no line\nif(points.length<2)return;strokePath(points.map(p=>({x:p.x*pixelDensity,y:p.y*pixelDensity})),strokeWidth*pixelDensity,applyOpacity(strokeColor,opacity),false);};const drawTriangle=(points,rotation=0,flipX=false,flipY=false,backgroundColor,opacity)=>{if(!backgroundColor)return;const clonedPoints=points.map(p=>({x:p.x*pixelDensity,y:p.y*pixelDensity}));const center=quadCentroid(clonedPoints);if(flipX||flipY)vectorsFlip(clonedPoints,flipX,flipY,center.x,center.y);vectorsRotate(clonedPoints,rotation,center.x,center.y);const vertices=trianglePointToVertices(clonedPoints);fillTriangle(vertices,applyOpacity(backgroundColor,opacity));};const getBackgroundUV=(width,height,backgroundSize,backgroundPosition)=>{if(!backgroundSize&&!backgroundPosition)return rectUV;let x=backgroundPosition.x/backgroundSize.width;let y=backgroundPosition.y/backgroundSize.height;let w=width/backgroundSize.width/pixelDensity;let h=height/backgroundSize.height/pixelDensity;w-=x;h-=y;// prettier-ignore\n// B   D\n// | \\ |\n// A  C\n// bottom left\nconst ax=-x;const ay=h;// top left\nconst bx=-x;const by=-y;// bottom right\nconst cx=w;const cy=h;// top right\nconst dx=w;const dy=-y;return new Float32Array([ax,ay,bx,by,cx,cy,dx,dy]);};const limitCornerRadius=(r,size)=>Math.floor(clamp(r,0,Math.min((size.width-1)*0.5,(size.height-1)*0.5)));const drawRect=(rect,rotation=0,flipX=false,flipY=false,cornerRadius,backgroundColor,backgroundImage,backgroundSize=undefined,backgroundPosition=undefined,strokeWidth,strokeColor,opacity,maskFeather=undefined,colorize)=>{// clone first\nlet rectOut=rectMultiply(rectClone(rect),pixelDensity);// has radius, doesn't matter for coordinates\nconst cornerRadiusOut=cornerRadius.map(r=>limitCornerRadius(r||0,rect)).map(r=>r*viewPixelDensity);// should fill\nif(backgroundColor||backgroundImage){// adjust for edge anti-aliasing, if we don't do this the\n// visible rectangle will be 1 pixel smaller than the actual rectangle\nconst rectFill=rectClone(rectOut);rectFill.x-=0.5;rectFill.y-=0.5;rectFill.width+=1.0;rectFill.height+=1.0;const points=createRectPoints(rectFill,rotation,flipX,flipY);const vertices=rectPointsToVertices(points);let color;if(colorize){color=applyOpacity(colorize);// as 0 transparancy is used to test if the colorize filter should be applied we set it to 0.001\nif(color[3]===0)color[3]=0.001;}fillRect(vertices,rectFill.width,rectFill.height,cornerRadiusOut,applyOpacity(backgroundColor,opacity),backgroundImage,opacity,color,getBackgroundUV(rectFill.width,rectFill.height,backgroundSize,backgroundPosition),maskFeather);}// should draw outline\nif(strokeWidth){// fixes issue where stroke would render weirdly\nstrokeWidth=Math.min(strokeWidth,rectOut.width,rectOut.height);strokePath(// rect out is already multiplied by pixel density\ncreateRectOutline(rectOut.x,rectOut.y,rectOut.width,rectOut.height,rotation,cornerRadiusOut,flipX,flipY),strokeWidth*pixelDensity,applyOpacity(strokeColor,opacity),true);}};const drawEllipse=(center,rx,ry,rotation,flipX,flipY,backgroundColor,backgroundImage,strokeWidth,strokeColor,opacity,inverted)=>{let rectOut=rectMultiply(rectCreate(center.x-rx,center.y-ry,rx*2,ry*2),pixelDensity);if(backgroundColor||backgroundImage){// adjust for edge anti-aliasing, if we don't do this the\n// visible rectangle will be 1 pixel smaller than the actual rectangle\nconst rectFill=rectClone(rectOut);rectFill.x-=0.5;rectFill.y-=0.5;rectFill.width+=1.0;rectFill.height+=1.0;const points=createRectPoints(rectFill,rotation,flipX,flipY);const vertices=rectPointsToVertices(points);fillEllipse(vertices,rectFill.width,rectFill.height,applyOpacity(backgroundColor,opacity),backgroundImage,opacity,inverted);}if(strokeWidth)strokePath(// rect out is already multiplied by pixeldensity\ncreateEllipseOutline(rectOut.x,rectOut.y,rectOut.width,rectOut.height,rotation,flipX,flipY),strokeWidth*pixelDensity,applyOpacity(strokeColor,opacity),true);};//#endregion\nreturn{// draw api\ndrawPath,drawTriangle,drawRect,drawEllipse,drawPreviewImage,setCanvasColor(color){canvasColor=color;},drawToCanvas(){gl.bindFramebuffer(gl.FRAMEBUFFER,null);// switch transform matrix\nmarkupMatrix=markupMatrixCanvas;// tell webgl about the viewport\ngl.viewport(0,0,gl.drawingBufferWidth,gl.drawingBufferHeight);// black (or other color depending on background)\ngl.colorMask(true,true,true,false);gl.clearColor(canvasColor[0],canvasColor[1],canvasColor[2],1);// gl.clearColor(0.25, 0.25, 0.25, 1); // for debugging\ngl.clear(gl.COLOR_BUFFER_BIT);},drawToFramebuffer(){// is twice as big as the loaded image\ngl.bindFramebuffer(gl.FRAMEBUFFER,fb);// switch transform matrix\nmarkupMatrix=markupMatrixFrameBuffer;// tell webgl about the \"viewport\"\ngl.viewport(0,0,imageData.width,imageData.height);// always transparent\ngl.colorMask(true,true,true,true);gl.clearColor(0,0,0,0);gl.clear(gl.COLOR_BUFFER_BIT);},// texture management\naddTexture,setTexture,reserveTexture,removeTexture,getTextureSize,getAvailableTextureIndex,// set mask\nenableMask(rect,opacity){const maskX=rect.x*viewPixelDensity;const maskY=rect.y*viewPixelDensity;const maskWidth=rect.width*viewPixelDensity;const maskHeight=rect.height*viewPixelDensity;maskLeft=maskX;maskRight=maskLeft+maskWidth;maskTop=viewSize.height-maskY;maskBottom=viewSize.height-(maskY+maskHeight);maskOpacity=1.0-opacity;maskBounds=[maskTop,maskRight,maskBottom,maskLeft];},disableMask(){maskLeft=0;maskRight=viewSize.width;maskTop=viewSize.height;maskBottom=0;maskOpacity=1;maskBounds=[maskTop,maskRight,maskBottom,maskLeft];},// canvas\nresize,release(){canvas.width=1;canvas.height=1;}};};/* src/core/ui/components/Canvas.svelte generated by Svelte v3.29.4 */function create_fragment(ctx){let div;let canvas_1;let measurable_action;let mounted;let dispose;return{c(){div=element(\"div\");canvas_1=element(\"canvas\");attr(div,\"class\",\"DokaCanvas\");},m(target,anchor){insert(target,div,anchor);append(div,canvas_1);/*canvas_1_binding*/ctx[15](canvas_1);if(!mounted){dispose=[listen(canvas_1,\"measure\",/*handleSizeChange*/ctx[4]),action_destroyer(measurable_action=measurable.call(null,canvas_1))];mounted=true;}},p:noop$1,i:noop$1,o:noop$1,d(detaching){if(detaching)detach(div);/*canvas_1_binding*/ctx[15](null);mounted=false;run_all(dispose);}};}function instance($$self,$$props,$$invalidate){let $imageMain;let $background;let $mask;const dispatch=createEventDispatcher();// fallback matrix\nconst COLOR_MATRIX_IDENTITY=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];let{animate}=$$props;let{imageData}=$$props;let{imageSize}=$$props;let{imageProps}=$$props;let{imagePreviews=[]}=$$props;let{maskRect}=$$props;let{pixelRatio=1}=$$props;let{willRender=passthrough}=$$props;let{loadImageData=passthrough}=$$props;let{backgroundColor}=$$props;//\n// springyness for main preview\n//\nconst updateSpring=(spring,value)=>spring.set(value,{hard:!animate});const blendWithCanvasBackground=(back,front)=>{const[bR,bG,bB]=back;const[fR,fG,fB,fA]=front;return[fR*fA+bR*(1-fA),fG*fA+bG*(1-fA),fB*fA+bB*(1-fA),1];};const SPRING_PROPS={precision:0.0001};const SPRING_PROPS_FRACTION={precision:SPRING_PROPS.precision*0.01};const background=tweened(undefined,{duration:250});component_subscribe($$self,background,value=>$$invalidate(22,$background=value));const translation=spring(undefined,SPRING_PROPS);const rotation=spring(undefined,SPRING_PROPS_FRACTION);const origin=spring(undefined,SPRING_PROPS);const perspective=spring(undefined,SPRING_PROPS_FRACTION);const scale=spring(undefined,SPRING_PROPS_FRACTION);const gamma=spring(undefined,SPRING_PROPS_FRACTION);const vignette=spring(undefined,SPRING_PROPS_FRACTION);const colorMatrix=spring([...COLOR_MATRIX_IDENTITY],SPRING_PROPS);const clarity=writable(undefined);const opacity=spring(0,SPRING_PROPS_FRACTION);const maskOpacity=spring(1,SPRING_PROPS_FRACTION);const mask=writable();component_subscribe($$self,mask,value=>$$invalidate(24,$mask=value));const imageBackgroundColor=writable();const imageMain=derived([origin,translation,perspective,rotation,scale,opacity,colorMatrix,mask,maskOpacity,clarity,gamma,vignette,imageBackgroundColor,background],([$origin,$translation,$perspective,$rotation,$scale,$opacity,$colorMatrix,$mask,$maskOpacity,$clarity,$gamma,$vignette,$imageBackgroundColor,$background],set)=>{if(!imageProps||!$background)return set(undefined);const maskOpacityClamped=clamp($maskOpacity,0,1);set({origin:$origin,translation:$translation,perspective:$perspective,rotation:$rotation,scale:$scale,colorMatrix:$colorMatrix,opacity:clamp($opacity,0,1),clarity:$clarity,gamma:$gamma,vignette:$vignette,mask:$mask,maskOpacity:maskOpacityClamped,overlayColor:[$background[0],$background[1],$background[2],maskOpacityClamped],backgroundColor:$imageBackgroundColor});});component_subscribe($$self,imageMain,value=>$$invalidate(21,$imageMain=value));//\n// rendering\n//\nlet canvas;let webGLImageDrawer=null;let width=null;let height=null;const drawPreviewImage=({origin,translation,rotation,scale,colorMatrix,opacity,clarity,gamma,vignette,offset,maskFeather,maskCornerRadius,backgroundColor,overlayColor,enableShapes})=>{let tx=translation.x;let ty=translation.y;if(offset){tx+=offset.x-width*0.5;ty+=offset.y-height*0.5;}// calculate opaque backgroundColor if is background color is transparent and visible\nif(backgroundColor[3]<1&&backgroundColor[3]>0){backgroundColor=blendWithCanvasBackground($background,backgroundColor);}webGLImageDrawer.drawPreviewImage(origin.x,origin.y,tx,ty,rotation.x,rotation.y,rotation.z,scale,colorMatrix||COLOR_MATRIX_IDENTITY,opacity,clarity,gamma,vignette,maskFeather,maskCornerRadius,backgroundColor,overlayColor,enableShapes);};// shape texture cache\nconst TextureUnits=new Map([]);const getShapeImageTexture=({backgroundImage})=>{// get texture unit assigned to this image\nlet texture=TextureUnits.get(backgroundImage);// texture already available, we done\nif(texture)return texture;// reserve texture unit\ntexture=webGLImageDrawer.getAvailableTextureIndex();webGLImageDrawer.reserveTexture(texture);// this background is now available in this texture unit\nTextureUnits.set(backgroundImage,texture);// load the new background image data\nloadImageData(backgroundImage).then(imageData=>{// create new texture\nwebGLImageDrawer.setTexture(texture,imageData);// need to redraw because texture is now available\nrequestAnimationFrame(drawUpdate);}).catch(err=>{console.error(err);});return texture;};const TEXT_MEASURE_CONTEXT=createSimpleContext();const getShapeTextTexture=shape=>{let{text,textAlign,fontFamily,fontSize,fontWeight,fontVariant,fontStyle,lineHeight,width}=shape;// we need this context to correctly wrap text\nupdateTextContext(TEXT_MEASURE_CONTEXT,{fontSize,fontFamily,fontWeight,fontVariant,fontStyle,textAlign});// wrap the text\nconst textString=width?wrapText(TEXT_MEASURE_CONTEXT,text,width):text;// create UID for this texture so we can cache it and fetch it later on\nconst textUID=shapeTextUID(_objectSpread(_objectSpread({},shape),{},{text:textString}));// get texture unit assigned to this specific text shape\nlet texture=TextureUnits.get(textUID);if(texture)return texture;// we need to create a new texture\nconst ctx=createSimpleContext();updateTextContext(ctx,{fontSize,fontFamily,fontWeight,fontVariant,fontStyle,textAlign});// calculate canvas height\nresizeContextToFitText(ctx,textString,{fontSize,fontFamily,fontWeight,fontVariant,fontStyle,textAlign,lineHeight});const contextMinWidth=ctx.canvas.width;// scale context to account for italic styles\nctx.canvas.width+=textPadding;// context resized, we now need to re-apply style\nupdateTextContext(ctx,{fontSize,fontFamily,fontWeight,fontVariant,fontStyle,textAlign,color:[1,0,1]// color we'll replace in the shader\n});// if so, draw text and update texture\ndrawText(ctx,textString,{fontSize,textAlign,lineHeight,lineWidth:contextMinWidth});// TODO: Create power of 2 texture and update texture instead of delete -> replace\n// add this texture\ntexture=webGLImageDrawer.addTexture(ctx.canvas);// Store reference to the texture\nTextureUnits.set(textUID,texture);return texture;};const getShapeTexture=shape=>{let texture;// let's create textures for backgrounds and texts\nif(shape.backgroundImage){texture=getShapeImageTexture(shape);}else if(isString(shape.text)){if(shape.width&&shape.width<1||shape.height&&shape.height<1)return undefined;texture=getShapeTextTexture(shape);}return texture;};const drawShapes=(shapes=[])=>shapes.map(shape=>{let texture=getShapeTexture(shape);if(isArray(shape.points)){// is triangle\nif(shape.points.length===3&&shape.backgroundColor){webGLImageDrawer.drawTriangle(shape.points,shape.rotation,shape.flipX,shape.flipY,shape.backgroundColor,shape.strokeWidth,shape.strokeColor,shape.opacity);}else// is normal path\n{webGLImageDrawer.drawPath(shape.points,shape.strokeWidth,shape.strokeColor,shape.opacity);}}else// is ellipse \nif(isNumber(shape.rx)){webGLImageDrawer.drawEllipse(shape,shape.rx,shape.ry,shape.rotation,shape.flipX,shape.flipY,shape.backgroundColor,texture,shape.strokeWidth,shape.strokeColor,shape.opacity,shape.inverted);}else// is rect\nif(isString(shape.text)&&texture||shape.width){const textureSize=texture&&webGLImageDrawer.getTextureSize(texture);let colorize=undefined;let shapeRect;let shapeCornerRadius=[shape.cornerRadius,shape.cornerRadius,shape.cornerRadius,shape.cornerRadius];if(shape.width){shapeRect=shape;}else{shapeRect=_objectSpread({x:shape.x,y:shape.y},textureSize);}let backgroundSize;let backgroundPosition;if(textureSize){// background should be scaled\nif(shape.backgroundImage&&shape.backgroundSize){// always respect texture aspect ratio\nconst textureAspectRatio=getAspectRatio(textureSize.width,textureSize.height);// adjust position of background\nif(shape.backgroundSize===\"contain\"){const rect=rectContainRect(shape,textureAspectRatio,shapeRect);backgroundSize=sizeCreateFromRect(rect);backgroundPosition=vectorCreate((shape.width-backgroundSize.width)*0.5,(shape.height-backgroundSize.height)*0.5);}else if(shape.backgroundSize===\"cover\"){const rect=rectCoverRect(shape,textureAspectRatio,shapeRect);backgroundSize=sizeCreateFromRect(rect);backgroundPosition=vectorCreate(rect.x,rect.y);backgroundPosition=vectorCreate((shape.width-backgroundSize.width)*0.5,(shape.height-backgroundSize.height)*0.5);}}else// is text, \"background\" should be texture size and be positioned based on alignment\nif(shape.text&&shape.width){// position texture based on text alignment\nbackgroundSize=textureSize;backgroundPosition=vectorCreate(0,0);// auto height\nif(!shape.height)shape.height=textureSize.height;// textPadding so text doesn't clip on left and right edges\nshape.x-=textPadding;shape.width+=textPadding*2;if(shape.textAlign===\"left\"){backgroundPosition.x=textPadding;}if(shape.textAlign===\"center\"){backgroundPosition.x=textPadding*0.5+(shape.width-textureSize.width)*0.5;}if(shape.textAlign===\"right\"){backgroundPosition.x=shape.width-textureSize.width;}}else if(shape.text){backgroundPosition=vectorCreate(0,0);backgroundSize={width:shapeRect.width,height:shapeRect.height};// texture is slightly larger because of text padding, need to compensate for this in single line mode\nshapeRect.width-=textPadding;}if(shape.text)colorize=shape.color;}webGLImageDrawer.drawRect(shapeRect,shape.rotation,shape.flipX,shape.flipY,shapeCornerRadius,shape.backgroundColor,texture,backgroundSize,backgroundPosition,shape.strokeWidth,shape.strokeColor,shape.opacity,undefined,colorize);}return texture?[shape.id,texture]:undefined;}).filter(Boolean);// redraws state\nconst redraw=()=>{// allow dev to inject more shapes\nconst canvas=willRender({opacity:$imageMain.opacity,// opacity of main image, can be used to change opacity of other elements\nrotation:$imageMain.rotation,scale:$imageMain.scale,size:canvasSize,backgroundColor:[...$background]});canvas.backgroundColor=[...$background];canvas.image=$imageMain;canvas.imageMask=$imageMain.mask;canvas.imageMaskOpacity=$imageMain.maskOpacity;canvas.imagePreviews=imagePreviews;// no need to draw to framebuffer is no annotations\nconst hasAnnotations=canvas.annotationShapes.length>0;// if image has background color\nconst hasImageBackgroundColor=$imageMain.backgroundColor[3]>0;// if the overlay is transparent so we can see the canvas\nconst hasTransparentOverlay=$imageMain.maskOpacity<1;// array of textures used in this draw call\nconst usedTextures=[];// set canvas background color to image background color if is defined\nif(hasTransparentOverlay&&hasImageBackgroundColor){const backR=canvas.backgroundColor[0];const backG=canvas.backgroundColor[1];const backB=canvas.backgroundColor[2];const frontA=1-$imageMain.maskOpacity;const frontR=$imageMain.backgroundColor[0]*frontA;const frontG=$imageMain.backgroundColor[1]*frontA;const frontB=$imageMain.backgroundColor[2]*frontA;const fA=1-frontA;canvas.backgroundColor=[frontR+backR*fA,frontG+backG*fA,frontB+backB*fA,1];}webGLImageDrawer.setCanvasColor(canvas.backgroundColor);// if has annotations draw annotation shapes to framebuffer\n// TODO: only run this if annotations have changed\nif(hasAnnotations){webGLImageDrawer.disableMask();webGLImageDrawer.drawToFramebuffer();usedTextures.push(...drawShapes(canvas.annotationShapes));}// switch to canvas drawing for other elements\nwebGLImageDrawer.drawToCanvas();webGLImageDrawer.enableMask(canvas.imageMask,canvas.imageMaskOpacity);// draw a colored rectangle behind main preview image\nif(hasImageBackgroundColor){webGLImageDrawer.drawRect($mask,0,false,false,[0,0,0,0],blendWithCanvasBackground($background,$imageMain.backgroundColor));}// draw main preview image\ncanvas.image.enableShapes=hasAnnotations;drawPreviewImage(canvas.image);// TODO: move vignette here (draw with colorized circular gradient texture instead of in shader)\n// draw decorations shapes relative to crop\nusedTextures.push(...drawShapes(canvas.decorationShapes));// crop mask not used for interface\nwebGLImageDrawer.disableMask();// draw custom interface shapes\nusedTextures.push(...drawShapes(canvas.interfaceShapes));canvas.imagePreviews.forEach(image=>{webGLImageDrawer.enableMask(image.mask,image.maskOpacity);// draw background fill\nif(hasImageBackgroundColor){webGLImageDrawer.drawRect(image.mask,0,false,false,image.maskCornerRadius,$imageMain.backgroundColor,undefined,undefined,undefined,undefined,undefined,image.opacity,image.maskFeather);}drawPreviewImage(_objectSpread(_objectSpread({},image),{},{backgroundColor:$imageMain.backgroundColor,overlayColor:[0,0,0,0],enableShapes:false}));});webGLImageDrawer.disableMask();// determine which textures can be dropped\nTextureUnits.forEach((registeredTextureUnit,key,map)=>{const isUsed=!!usedTextures.find(([id,usedTextureUnit])=>usedTextureUnit===registeredTextureUnit);// stil used, no need to release\nif(isUsed)return;// remove this texture\nTextureUnits.delete(key);webGLImageDrawer.removeTexture(registeredTextureUnit);});};//\n// events\n//\n// auto update when size changes\nconst handleSizeChange=e=>{$$invalidate(17,width=e.detail.width);$$invalidate(18,height=e.detail.height);dispatch(\"measure\",{width,height});};//\n// hooks\n//\n// after DOM has been altered, draw to canvas\nafterUpdate(()=>drawUpdate());// hook up canvas and image\nonMount(()=>$$invalidate(16,webGLImageDrawer=createGLImageDrawer(canvas,imageData,imageSize,pixelRatio)));// clean up canvas\nonDestroy(()=>{// if canvas wasn't created we don't need to release it\nif(!webGLImageDrawer)return;// done drawing\nwebGLImageDrawer.release();// force release canvas for Safari\nreleaseCanvas(TEXT_MEASURE_CONTEXT.canvas);});function canvas_1_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{canvas=$$value;$$invalidate(0,canvas);});}$$self.$$set=$$props=>{if(\"animate\"in $$props)$$invalidate(5,animate=$$props.animate);if(\"imageData\"in $$props)$$invalidate(6,imageData=$$props.imageData);if(\"imageSize\"in $$props)$$invalidate(7,imageSize=$$props.imageSize);if(\"imageProps\"in $$props)$$invalidate(8,imageProps=$$props.imageProps);if(\"imagePreviews\"in $$props)$$invalidate(9,imagePreviews=$$props.imagePreviews);if(\"maskRect\"in $$props)$$invalidate(10,maskRect=$$props.maskRect);if(\"pixelRatio\"in $$props)$$invalidate(11,pixelRatio=$$props.pixelRatio);if(\"willRender\"in $$props)$$invalidate(12,willRender=$$props.willRender);if(\"loadImageData\"in $$props)$$invalidate(13,loadImageData=$$props.loadImageData);if(\"backgroundColor\"in $$props)$$invalidate(14,backgroundColor=$$props.backgroundColor);};let canvasSize;let canDraw;let drawUpdate;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*backgroundColor*/16384){// canvas style\nbackgroundColor&&updateSpring(background,backgroundColor);}if($$self.$$.dirty[0]&/*imageProps*/256){// image transforms\nimageProps&&updateSpring(origin,imageProps.origin);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&updateSpring(translation,imageProps.translation);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&updateSpring(perspective,imageProps.perspective);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&updateSpring(rotation,imageProps.rotation);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&updateSpring(scale,imageProps.scale);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&updateSpring(colorMatrix,imageProps.colorMatrix||[...COLOR_MATRIX_IDENTITY]);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&updateSpring(vignette,imageProps.vignette||0);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&updateSpring(gamma,imageProps.gamma||1);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&clarity.set(imageProps.convolutionMatrix&&imageProps.convolutionMatrix.clarity||undefined);}if($$self.$$.dirty[0]&/*imageProps*/256){// image ui style\nimageProps&&updateSpring(opacity,1);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&updateSpring(maskOpacity,isNumber(imageProps.maskOpacity)?imageProps.maskOpacity:1);}if($$self.$$.dirty[0]&/*maskRect*/1024){maskRect&&mask.set(maskRect);}if($$self.$$.dirty[0]&/*imageProps*/256){imageProps&&imageBackgroundColor.set(imageProps.backgroundColor);}if($$self.$$.dirty[0]&/*width, height*/393216){// canvas size\ncanvasSize={width,height};}if($$self.$$.dirty[0]&/*webGLImageDrawer, width, height, $imageMain*/2555904){// can draw view\n$$invalidate(20,canDraw=webGLImageDrawer&&width&&height&&$imageMain);}if($$self.$$.dirty[0]&/*width, height, webGLImageDrawer, pixelRatio*/460800){// observe width and height changes and resize the canvas proportionally\nwidth&&height&&webGLImageDrawer&&webGLImageDrawer.resize(width,height,pixelRatio);}if($$self.$$.dirty[0]&/*canDraw*/1048576){// switch to draw method when can draw\ndrawUpdate=canDraw?redraw:noop;}};return[canvas,background,mask,imageMain,handleSizeChange,animate,imageData,imageSize,imageProps,imagePreviews,maskRect,pixelRatio,willRender,loadImageData,backgroundColor,canvas_1_binding];}class Canvas extends SvelteComponent{constructor(options){super();init(this,options,instance,create_fragment,safe_not_equal,{animate:5,imageData:6,imageSize:7,imageProps:8,imagePreviews:9,maskRect:10,pixelRatio:11,willRender:12,loadImageData:13,backgroundColor:14},[-1,-1]);}}var arrayJoin=(arr,filter=Boolean,str=' ')=>arr.filter(filter).join(str);/* src/core/ui/components/TabList.svelte generated by Svelte v3.29.4 */const get_default_slot_changes=dirty=>({tab:dirty&/*tabNodes*/8});const get_default_slot_context=ctx=>({tab:/*tab*/ctx[16]});function get_each_context(ctx,list,i){const child_ctx=ctx.slice();child_ctx[16]=list[i];return child_ctx;}// (72:4) {#each tabNodes as tab (tab.id) }\nfunction create_each_block(key_1,ctx){let li;let button;let button_aria_controls_value;let button_id_value;let button_aria_selected_value;let button_disabled_value;let t;let current;let mounted;let dispose;const default_slot_template=/*#slots*/ctx[10].default;const default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[9],get_default_slot_context);function keydown_handler(...args){return(/*keydown_handler*/ctx[11](/*tab*/ctx[16],...args));}function click_handler(...args){return(/*click_handler*/ctx[12](/*tab*/ctx[16],...args));}return{key:key_1,first:null,c(){li=element(\"li\");button=element(\"button\");if(default_slot)default_slot.c();t=space();attr(button,\"role\",\"tab\");attr(button,\"aria-controls\",button_aria_controls_value=/*tab*/ctx[16].href);attr(button,\"id\",button_id_value=/*tab*/ctx[16].tabId);attr(button,\"aria-selected\",button_aria_selected_value=/*tab*/ctx[16].selected);button.disabled=button_disabled_value=/*tab*/ctx[16].disabled;this.first=li;},m(target,anchor){insert(target,li,anchor);append(li,button);if(default_slot){default_slot.m(button,null);}append(li,t);current=true;if(!mounted){dispose=[listen(button,\"keydown\",keydown_handler),listen(button,\"click\",click_handler)];mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;if(default_slot){if(default_slot.p&&dirty&/*$$scope, tabNodes*/520){update_slot(default_slot,default_slot_template,ctx,/*$$scope*/ctx[9],dirty,get_default_slot_changes,get_default_slot_context);}}if(!current||dirty&/*tabNodes*/8&&button_aria_controls_value!==(button_aria_controls_value=/*tab*/ctx[16].href)){attr(button,\"aria-controls\",button_aria_controls_value);}if(!current||dirty&/*tabNodes*/8&&button_id_value!==(button_id_value=/*tab*/ctx[16].tabId)){attr(button,\"id\",button_id_value);}if(!current||dirty&/*tabNodes*/8&&button_aria_selected_value!==(button_aria_selected_value=/*tab*/ctx[16].selected)){attr(button,\"aria-selected\",button_aria_selected_value);}if(!current||dirty&/*tabNodes*/8&&button_disabled_value!==(button_disabled_value=/*tab*/ctx[16].disabled)){button.disabled=button_disabled_value;}},i(local){if(current)return;transition_in(default_slot,local);current=true;},o(local){transition_out(default_slot,local);current=false;},d(detaching){if(detaching)detach(li);if(default_slot)default_slot.d(detaching);mounted=false;run_all(dispose);}};}function create_fragment$1(ctx){let ul;let each_blocks=[];let each_1_lookup=new Map();let ul_class_value;let current;let each_value=/*tabNodes*/ctx[3];const get_key=ctx=>/*tab*/ctx[16].id;for(let i=0;i<each_value.length;i+=1){let child_ctx=get_each_context(ctx,each_value,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block(key,child_ctx));}return{c(){ul=element(\"ul\");for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}attr(ul,\"class\",ul_class_value=arrayJoin([\"DokaTabList\",/*klass*/ctx[0]]));attr(ul,\"role\",\"tablist\");attr(ul,\"data-layout\",/*layout*/ctx[1]);},m(target,anchor){insert(target,ul,anchor);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(ul,null);}/*ul_binding*/ctx[13](ul);current=true;},p(ctx,[dirty]){if(dirty&/*tabNodes, handleKeyTab, handleClickTab, $$scope*/568){const each_value=/*tabNodes*/ctx[3];group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,ul,outro_and_destroy_block,create_each_block,null,get_each_context);check_outros();}if(!current||dirty&/*klass*/1&&ul_class_value!==(ul_class_value=arrayJoin([\"DokaTabList\",/*klass*/ctx[0]]))){attr(ul,\"class\",ul_class_value);}if(!current||dirty&/*layout*/2){attr(ul,\"data-layout\",/*layout*/ctx[1]);}},i(local){if(current)return;for(let i=0;i<each_value.length;i+=1){transition_in(each_blocks[i]);}current=true;},o(local){for(let i=0;i<each_blocks.length;i+=1){transition_out(each_blocks[i]);}current=false;},d(detaching){if(detaching)detach(ul);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d();}/*ul_binding*/ctx[13](null);}};}function instance$1($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope}=$$props;let root;let{class:klass=undefined}=$$props;let{name}=$$props;let{selected}=$$props;let{tabs=[]}=$$props;let{layout=undefined}=$$props;const dispatch=createEventDispatcher();const focusTab=index=>{const tab=root.querySelectorAll(\"button[role=\\\"tab\\\"]\")[index];if(!tab)return;tab.focus();};const handleClickTab=(e,id)=>{e.preventDefault();e.stopPropagation();dispatch(\"select\",id);};const handleKeyTab=({key},id)=>{if(!/arrow/i.test(key))return;const index=tabs.findIndex(tab=>tab.id===id);// next\nif(/right|down/i.test(key))return focusTab(index<tabs.length-1?index+1:0);// prev\nif(/left|up/i.test(key))return focusTab(index>0?index-1:tabs.length-1);};const keydown_handler=(tab,e)=>handleKeyTab(e,tab.id);const click_handler=(tab,e)=>handleClickTab(e,tab.id);function ul_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{root=$$value;$$invalidate(2,root);});}$$self.$$set=$$props=>{if(\"class\"in $$props)$$invalidate(0,klass=$$props.class);if(\"name\"in $$props)$$invalidate(6,name=$$props.name);if(\"selected\"in $$props)$$invalidate(7,selected=$$props.selected);if(\"tabs\"in $$props)$$invalidate(8,tabs=$$props.tabs);if(\"layout\"in $$props)$$invalidate(1,layout=$$props.layout);if(\"$$scope\"in $$props)$$invalidate(9,$$scope=$$props.$$scope);};let tabNodes;$$self.$$.update=()=>{if($$self.$$.dirty&/*tabs, selected, name*/448){$$invalidate(3,tabNodes=tabs.map(tab=>{const isActive=tab.id===selected;return _objectSpread(_objectSpread({},tab),{},{tabId:`doka-tab-${name}-${tab.id}`,href:`#doka-${name}-${tab.id}`,selected:isActive});}));}};return[klass,layout,root,tabNodes,handleClickTab,handleKeyTab,name,selected,tabs,$$scope,slots,keydown_handler,click_handler,ul_binding];}class TabList extends SvelteComponent{constructor(options){super();init(this,options,instance$1,create_fragment$1,safe_not_equal,{class:0,name:6,selected:7,tabs:8,layout:1});}}/* src/core/ui/components/TabPanels.svelte generated by Svelte v3.29.4 */const get_default_slot_changes$1=dirty=>({panel:dirty&/*panelNodes*/16,panelIsActive:dirty&/*panelNodes*/16});const get_default_slot_context$1=ctx=>({panel:/*id*/ctx[11],panelIsActive:!/*hidden*/ctx[15]});function get_each_context$1(ctx,list,i){const child_ctx=ctx.slice();child_ctx[11]=list[i].id;child_ctx[12]=list[i].panelId;child_ctx[13]=list[i].tabindex;child_ctx[14]=list[i].labelledBy;child_ctx[15]=list[i].hidden;child_ctx[3]=list[i].visible;return child_ctx;}// (61:4) {#each panelNodes as { id, panelId, tabindex, labelledBy, hidden, visible }\nfunction create_each_block$1(key_1,ctx){let div;let t;let div_class_value;let div_hidden_value;let div_id_value;let div_tabindex_value;let div_aria_labelledby_value;let div_data_inert_value;let current;const default_slot_template=/*#slots*/ctx[9].default;const default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[8],get_default_slot_context$1);return{key:key_1,first:null,c(){div=element(\"div\");if(default_slot)default_slot.c();t=space();attr(div,\"class\",div_class_value=arrayJoin([\"DokaTabPanel\",/*panelClass*/ctx[1]]));div.hidden=div_hidden_value=/*hidden*/ctx[15];attr(div,\"id\",div_id_value=/*panelId*/ctx[12]);attr(div,\"tabindex\",div_tabindex_value=/*tabindex*/ctx[13]);attr(div,\"aria-labelledby\",div_aria_labelledby_value=/*labelledBy*/ctx[14]);attr(div,\"data-inert\",div_data_inert_value=!/*visible*/ctx[3]);this.first=div;},m(target,anchor){insert(target,div,anchor);if(default_slot){default_slot.m(div,null);}append(div,t);current=true;},p(ctx,dirty){if(default_slot){if(default_slot.p&&dirty&/*$$scope, panelNodes*/272){update_slot(default_slot,default_slot_template,ctx,/*$$scope*/ctx[8],dirty,get_default_slot_changes$1,get_default_slot_context$1);}}if(!current||dirty&/*panelClass*/2&&div_class_value!==(div_class_value=arrayJoin([\"DokaTabPanel\",/*panelClass*/ctx[1]]))){attr(div,\"class\",div_class_value);}if(!current||dirty&/*panelNodes*/16&&div_hidden_value!==(div_hidden_value=/*hidden*/ctx[15])){div.hidden=div_hidden_value;}if(!current||dirty&/*panelNodes*/16&&div_id_value!==(div_id_value=/*panelId*/ctx[12])){attr(div,\"id\",div_id_value);}if(!current||dirty&/*panelNodes*/16&&div_tabindex_value!==(div_tabindex_value=/*tabindex*/ctx[13])){attr(div,\"tabindex\",div_tabindex_value);}if(!current||dirty&/*panelNodes*/16&&div_aria_labelledby_value!==(div_aria_labelledby_value=/*labelledBy*/ctx[14])){attr(div,\"aria-labelledby\",div_aria_labelledby_value);}if(!current||dirty&/*panelNodes*/16&&div_data_inert_value!==(div_data_inert_value=!/*visible*/ctx[3])){attr(div,\"data-inert\",div_data_inert_value);}},i(local){if(current)return;transition_in(default_slot,local);current=true;},o(local){transition_out(default_slot,local);current=false;},d(detaching){if(detaching)detach(div);if(default_slot)default_slot.d(detaching);}};}function create_fragment$2(ctx){let div;let each_blocks=[];let each_1_lookup=new Map();let div_class_value;let measurable_action;let current;let mounted;let dispose;let each_value=/*panelNodes*/ctx[4];const get_key=ctx=>/*id*/ctx[11];for(let i=0;i<each_value.length;i+=1){let child_ctx=get_each_context$1(ctx,each_value,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block$1(key,child_ctx));}return{c(){div=element(\"div\");for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}attr(div,\"class\",div_class_value=arrayJoin([\"DokaTabPanels\",/*klass*/ctx[0]]));attr(div,\"style\",/*style*/ctx[2]);},m(target,anchor){insert(target,div,anchor);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(div,null);}current=true;if(!mounted){dispose=[listen(div,\"measure\",/*measure_handler*/ctx[10]),action_destroyer(measurable_action=measurable.call(null,div))];mounted=true;}},p(ctx,[dirty]){if(dirty&/*arrayJoin, panelClass, panelNodes, $$scope*/274){const each_value=/*panelNodes*/ctx[4];group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,div,outro_and_destroy_block,create_each_block$1,null,get_each_context$1);check_outros();}if(!current||dirty&/*klass*/1&&div_class_value!==(div_class_value=arrayJoin([\"DokaTabPanels\",/*klass*/ctx[0]]))){attr(div,\"class\",div_class_value);}if(!current||dirty&/*style*/4){attr(div,\"style\",/*style*/ctx[2]);}},i(local){if(current)return;for(let i=0;i<each_value.length;i+=1){transition_in(each_blocks[i]);}current=true;},o(local){for(let i=0;i<each_blocks.length;i+=1){transition_out(each_blocks[i]);}current=false;},d(detaching){if(detaching)detach(div);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d();}mounted=false;run_all(dispose);}};}function instance$2($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope}=$$props;let{class:klass=undefined}=$$props;let{name}=$$props;let{selected}=$$props;let{visible=undefined}=$$props;let{panelClass=undefined}=$$props;let{panels=[]}=$$props;let{style=undefined}=$$props;function measure_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"class\"in $$props)$$invalidate(0,klass=$$props.class);if(\"name\"in $$props)$$invalidate(5,name=$$props.name);if(\"selected\"in $$props)$$invalidate(6,selected=$$props.selected);if(\"visible\"in $$props)$$invalidate(3,visible=$$props.visible);if(\"panelClass\"in $$props)$$invalidate(1,panelClass=$$props.panelClass);if(\"panels\"in $$props)$$invalidate(7,panels=$$props.panels);if(\"style\"in $$props)$$invalidate(2,style=$$props.style);if(\"$$scope\"in $$props)$$invalidate(8,$$scope=$$props.$$scope);};let panelNodes;$$self.$$.update=()=>{if($$self.$$.dirty&/*panels, selected, visible, name*/232){$$invalidate(4,panelNodes=panels.map(id=>{const isActive=id===selected;const isVisible=visible?visible.indexOf(id)!==-1:true;return{id,panelId:`doka-${name}_${id}`,labelledBy:`doka-tab-${name}_${id}`,hidden:!isActive,visible:isVisible,tabindex:isActive?0:-1};}));}};return[klass,panelClass,style,visible,panelNodes,name,selected,panels,$$scope,slots,measure_handler];}class TabPanels extends SvelteComponent{constructor(options){super();init(this,options,instance$2,create_fragment$2,safe_not_equal,{class:0,name:5,selected:6,visible:3,panelClass:1,panels:7,style:2});}}/* src/core/ui/components/Panel.svelte generated by Svelte v3.29.4 */function create_fragment$3(ctx){let div;let switch_instance;let updating_name;let div_class_value;let current;const switch_instance_spread_levels=[/*componentProps*/ctx[7]];function switch_instance_name_binding(value){/*switch_instance_name_binding*/ctx[17].call(null,value);}var switch_value=/*componentView*/ctx[11];function switch_props(ctx){let switch_instance_props={};for(let i=0;i<switch_instance_spread_levels.length;i+=1){switch_instance_props=assign(switch_instance_props,switch_instance_spread_levels[i]);}if(/*panelName*/ctx[3]!==void 0){switch_instance_props.name=/*panelName*/ctx[3];}return{props:switch_instance_props};}if(switch_value){switch_instance=new switch_value(switch_props(ctx));binding_callbacks.push(()=>bind(switch_instance,\"name\",switch_instance_name_binding));/*switch_instance_binding*/ctx[18](switch_instance);switch_instance.$on(\"measure\",/*measure_handler*/ctx[19]);}return{c(){div=element(\"div\");if(switch_instance)create_component(switch_instance.$$.fragment);attr(div,\"data-util\",/*panelName*/ctx[3]);attr(div,\"class\",div_class_value=arrayJoin([\"DokaPanel\",/*klass*/ctx[1]]));attr(div,\"style\",/*style*/ctx[6]);},m(target,anchor){insert(target,div,anchor);if(switch_instance){mount_component(switch_instance,div,null);}current=true;},p(ctx,[dirty]){const switch_instance_changes=dirty&/*componentProps*/128?get_spread_update(switch_instance_spread_levels,[get_spread_object(/*componentProps*/ctx[7])]):{};if(!updating_name&&dirty&/*panelName*/8){updating_name=true;switch_instance_changes.name=/*panelName*/ctx[3];add_flush_callback(()=>updating_name=false);}if(switch_value!==(switch_value=/*componentView*/ctx[11])){if(switch_instance){group_outros();const old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,()=>{destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=new switch_value(switch_props(ctx));binding_callbacks.push(()=>bind(switch_instance,\"name\",switch_instance_name_binding));/*switch_instance_binding*/ctx[18](switch_instance);switch_instance.$on(\"measure\",/*measure_handler*/ctx[19]);create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,div,null);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}if(!current||dirty&/*panelName*/8){attr(div,\"data-util\",/*panelName*/ctx[3]);}if(!current||dirty&/*klass*/2&&div_class_value!==(div_class_value=arrayJoin([\"DokaPanel\",/*klass*/ctx[1]]))){attr(div,\"class\",div_class_value);}if(!current||dirty&/*style*/64){attr(div,\"style\",/*style*/ctx[6]);}},i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);/*switch_instance_binding*/ctx[18](null);if(switch_instance)destroy_component(switch_instance);}};}function instance$3($$self,$$props,$$invalidate){let $opacityClamped;let $isActivePrivateStore;const dispatch=createEventDispatcher();let{isActive=true}=$$props;let{stores}=$$props;let{content}=$$props;let{component}=$$props;let{locale}=$$props;let{class:klass=undefined}=$$props;// we remember the view rect in this variable\nlet rect;const opacity=spring(0);const opacityClamped=derived(opacity,$opacity=>clamp($opacity,0,1));component_subscribe($$self,opacityClamped,value=>$$invalidate(22,$opacityClamped=value));// throw hide / show events\nlet isHidden=!isActive;// create active store so can be used in derived stores\nconst isActivePrivateStore=writable(isActive);component_subscribe($$self,isActivePrivateStore,value=>$$invalidate(23,$isActivePrivateStore=value));const stateProps={isActive:derived(isActivePrivateStore,$isActivePrivateStore=>$isActivePrivateStore),isActiveFraction:derived(opacityClamped,$opacityClamped=>$opacityClamped),isVisible:derived(opacityClamped,$opacityClamped=>$opacityClamped>0)};// build the component props\nconst componentView=content.view;const componentExportedProps=getComponentExportedProps(componentView);const componentComputedProps=Object.keys(content.props||{}).reduce((computedProps,key)=>{if(!componentExportedProps.includes(key))return computedProps;computedProps[key]=content.props[key];return computedProps;},{});const componentComputedStateProps=Object.keys(stateProps).reduce((computedStateProps,key)=>{if(!componentExportedProps.includes(key))return computedStateProps;computedStateProps[key]=stateProps[key];return computedStateProps;},{});// class used on panel element\nlet panelName;// we use the `hasBeenMounted` bool to block rect updates until the entire panel is ready\nlet hasBeenMounted=false;let preMountRect;let mountRectTimeout;onMount(()=>{$$invalidate(4,hasBeenMounted=true);// this fixes a weird issue where the measure event isn't fired \n// when no components active in subview\nclearTimeout(mountRectTimeout);mountRectTimeout=setTimeout(()=>{if(rect||!preMountRect)return;dispatch(\"measure\",_objectSpread({},preMountRect));},0);});function switch_instance_name_binding(value){panelName=value;$$invalidate(3,panelName);}function switch_instance_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{component=$$value;$$invalidate(0,component);});}const measure_handler=e=>{$$invalidate(5,preMountRect=_objectSpread({},e.detail));if(!hasBeenMounted)return;$$invalidate(2,rect=e.detail);dispatch(\"measure\",_objectSpread({},rect));};$$self.$$set=$$props=>{if(\"isActive\"in $$props)$$invalidate(12,isActive=$$props.isActive);if(\"stores\"in $$props)$$invalidate(13,stores=$$props.stores);if(\"content\"in $$props)$$invalidate(14,content=$$props.content);if(\"component\"in $$props)$$invalidate(0,component=$$props.component);if(\"locale\"in $$props)$$invalidate(15,locale=$$props.locale);if(\"class\"in $$props)$$invalidate(1,klass=$$props.class);};let style;let componentProps;$$self.$$.update=()=>{if($$self.$$.dirty&/*rect, isActive, component*/4101){// when the view rect changes and the panel is in active state or became active, dispatch measure event\nif(rect&&isActive&&component)dispatch(\"measure\",rect);}if($$self.$$.dirty&/*isActive*/4096){opacity.set(isActive?1:0);}if($$self.$$.dirty&/*$opacityClamped, isHidden*/5242880){if($opacityClamped<=0&&!isHidden){$$invalidate(20,isHidden=true);dispatch(\"hide\");}else if($opacityClamped>0&&isHidden){$$invalidate(20,isHidden=false);dispatch(\"show\");}}if($$self.$$.dirty&/*$opacityClamped*/4194304){dispatch(\"fade\",$opacityClamped);}if($$self.$$.dirty&/*$opacityClamped*/4194304){// only set opacity prop if is below 0\n$$invalidate(6,style=$opacityClamped<1?`opacity: ${$opacityClamped}`:undefined);}if($$self.$$.dirty&/*isActive*/4096){set_store_value(isActivePrivateStore,$isActivePrivateStore=isActive,$isActivePrivateStore);}if($$self.$$.dirty&/*stores, locale*/40960){$$invalidate(7,componentProps=_objectSpread(_objectSpread(_objectSpread({},componentComputedProps),componentComputedStateProps),{},{stores,locale}));}};return[component,klass,rect,panelName,hasBeenMounted,preMountRect,style,componentProps,dispatch,opacityClamped,isActivePrivateStore,componentView,isActive,stores,content,locale,opacity,switch_instance_name_binding,switch_instance_binding,measure_handler];}class Panel extends SvelteComponent{constructor(options){super();init(this,options,instance$3,create_fragment$3,safe_not_equal,{isActive:12,stores:13,content:14,component:0,locale:15,class:1,opacity:16});}get opacity(){return this.$$.ctx[16];}}/* src/core/ui/components/Icon.svelte generated by Svelte v3.29.4 */function create_fragment$4(ctx){let svg;let svg_viewBox_value;let current;const default_slot_template=/*#slots*/ctx[5].default;const default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[4],null);return{c(){svg=svg_element(\"svg\");if(default_slot)default_slot.c();attr(svg,\"class\",/*klass*/ctx[3]);attr(svg,\"style\",/*style*/ctx[2]);attr(svg,\"width\",/*width*/ctx[0]);attr(svg,\"height\",/*height*/ctx[1]);attr(svg,\"viewBox\",svg_viewBox_value=\"0 0 \"+/*width*/ctx[0]+\"\\n    \"+/*height*/ctx[1]);attr(svg,\"xmlns\",\"http://www.w3.org/2000/svg\");attr(svg,\"aria-hidden\",\"true\");attr(svg,\"focusable\",\"false\");attr(svg,\"stroke-linecap\",\"round\");attr(svg,\"stroke-linejoin\",\"round\");},m(target,anchor){insert(target,svg,anchor);if(default_slot){default_slot.m(svg,null);}current=true;},p(ctx,[dirty]){if(default_slot){if(default_slot.p&&dirty&/*$$scope*/16){update_slot(default_slot,default_slot_template,ctx,/*$$scope*/ctx[4],dirty,null,null);}}if(!current||dirty&/*klass*/8){attr(svg,\"class\",/*klass*/ctx[3]);}if(!current||dirty&/*style*/4){attr(svg,\"style\",/*style*/ctx[2]);}if(!current||dirty&/*width*/1){attr(svg,\"width\",/*width*/ctx[0]);}if(!current||dirty&/*height*/2){attr(svg,\"height\",/*height*/ctx[1]);}if(!current||dirty&/*width, height*/3&&svg_viewBox_value!==(svg_viewBox_value=\"0 0 \"+/*width*/ctx[0]+\"\\n    \"+/*height*/ctx[1])){attr(svg,\"viewBox\",svg_viewBox_value);}},i(local){if(current)return;transition_in(default_slot,local);current=true;},o(local){transition_out(default_slot,local);current=false;},d(detaching){if(detaching)detach(svg);if(default_slot)default_slot.d(detaching);}};}function instance$4($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope}=$$props;let{width=24}=$$props;let{height=24}=$$props;let{style=undefined}=$$props;let{class:klass=undefined}=$$props;$$self.$$set=$$props=>{if(\"width\"in $$props)$$invalidate(0,width=$$props.width);if(\"height\"in $$props)$$invalidate(1,height=$$props.height);if(\"style\"in $$props)$$invalidate(2,style=$$props.style);if(\"class\"in $$props)$$invalidate(3,klass=$$props.class);if(\"$$scope\"in $$props)$$invalidate(4,$$scope=$$props.$$scope);};return[width,height,style,klass,$$scope,slots];}class Icon extends SvelteComponent{constructor(options){super();init(this,options,instance$4,create_fragment$4,safe_not_equal,{width:0,height:1,style:2,class:3});}}var isEventTarget=(e,element)=>element===e.target||element.contains(e.target);/* src/core/ui/components/Button.svelte generated by Svelte v3.29.4 */function create_if_block_1(ctx){let icon_1;let current;icon_1=new Icon({props:{class:\"DokaButtonIcon\",$$slots:{default:[create_default_slot]},$$scope:{ctx}}});return{c(){create_component(icon_1.$$.fragment);},m(target,anchor){mount_component(icon_1,target,anchor);current=true;},p(ctx,dirty){const icon_1_changes={};if(dirty&/*$$scope, icon*/1048578){icon_1_changes.$$scope={dirty,ctx};}icon_1.$set(icon_1_changes);},i(local){if(current)return;transition_in(icon_1.$$.fragment,local);current=true;},o(local){transition_out(icon_1.$$.fragment,local);current=false;},d(detaching){destroy_component(icon_1,detaching);}};}// (40:16) <Icon class=\"DokaButtonIcon\">\nfunction create_default_slot(ctx){let g;return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=/*icon*/ctx[1];},p(ctx,dirty){if(dirty&/*icon*/2)g.innerHTML=/*icon*/ctx[1];},d(detaching){if(detaching)detach(g);}};}// (46:12) {#if label}\nfunction create_if_block(ctx){let span;let t;return{c(){span=element(\"span\");t=text(/*label*/ctx[0]);attr(span,\"class\",/*elLabelClass*/ctx[11]);},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty&/*label*/1)set_data(t,/*label*/ctx[0]);if(dirty&/*elLabelClass*/2048){attr(span,\"class\",/*elLabelClass*/ctx[11]);}},d(detaching){if(detaching)detach(span);}};}// (37:10)          \nfunction fallback_block(ctx){let span;let t;let current;let if_block0=/*icon*/ctx[1]&&create_if_block_1(ctx);let if_block1=/*label*/ctx[0]&&create_if_block(ctx);return{c(){span=element(\"span\");if(if_block0)if_block0.c();t=space();if(if_block1)if_block1.c();attr(span,\"class\",/*elButtonInnerClass*/ctx[9]);},m(target,anchor){insert(target,span,anchor);if(if_block0)if_block0.m(span,null);append(span,t);if(if_block1)if_block1.m(span,null);current=true;},p(ctx,dirty){if(/*icon*/ctx[1]){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*icon*/2){transition_in(if_block0,1);}}else{if_block0=create_if_block_1(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(span,t);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(/*label*/ctx[0]){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block(ctx);if_block1.c();if_block1.m(span,null);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(!current||dirty&/*elButtonInnerClass*/512){attr(span,\"class\",/*elButtonInnerClass*/ctx[9]);}},i(local){if(current)return;transition_in(if_block0);current=true;},o(local){transition_out(if_block0);current=false;},d(detaching){if(detaching)detach(span);if(if_block0)if_block0.d();if(if_block1)if_block1.d();}};}function create_fragment$5(ctx){let button;let action_action;let current;let mounted;let dispose;const default_slot_template=/*#slots*/ctx[18].default;const default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[20],null);const default_slot_or_fallback=default_slot||fallback_block(ctx);return{c(){button=element(\"button\");if(default_slot_or_fallback)default_slot_or_fallback.c();attr(button,\"type\",/*type*/ctx[4]);attr(button,\"style\",/*style*/ctx[2]);button.disabled=/*disabled*/ctx[3];attr(button,\"class\",/*elButtonClass*/ctx[10]);attr(button,\"title\",/*label*/ctx[0]);},m(target,anchor){insert(target,button,anchor);if(default_slot_or_fallback){default_slot_or_fallback.m(button,null);}/*button_binding*/ctx[19](button);current=true;if(!mounted){dispose=[listen(button,\"keydown\",function(){if(is_function(/*onkeydown*/ctx[6]))/*onkeydown*/ctx[6].apply(this,arguments);}),listen(button,\"click\",function(){if(is_function(/*onclick*/ctx[5]))/*onclick*/ctx[5].apply(this,arguments);}),action_destroyer(action_action=/*action*/ctx[7].call(null,button))];mounted=true;}},p(new_ctx,[dirty]){ctx=new_ctx;if(default_slot){if(default_slot.p&&dirty&/*$$scope*/1048576){update_slot(default_slot,default_slot_template,ctx,/*$$scope*/ctx[20],dirty,null,null);}}else{if(default_slot_or_fallback&&default_slot_or_fallback.p&&dirty&/*elButtonInnerClass, elLabelClass, label, icon*/2563){default_slot_or_fallback.p(ctx,dirty);}}if(!current||dirty&/*type*/16){attr(button,\"type\",/*type*/ctx[4]);}if(!current||dirty&/*style*/4){attr(button,\"style\",/*style*/ctx[2]);}if(!current||dirty&/*disabled*/8){button.disabled=/*disabled*/ctx[3];}if(!current||dirty&/*elButtonClass*/1024){attr(button,\"class\",/*elButtonClass*/ctx[10]);}if(!current||dirty&/*label*/1){attr(button,\"title\",/*label*/ctx[0]);}},i(local){if(current)return;transition_in(default_slot_or_fallback,local);current=true;},o(local){transition_out(default_slot_or_fallback,local);current=false;},d(detaching){if(detaching)detach(button);if(default_slot_or_fallback)default_slot_or_fallback.d(detaching);/*button_binding*/ctx[19](null);mounted=false;run_all(dispose);}};}function instance$5($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope}=$$props;let{class:klass=undefined}=$$props;let{label=undefined}=$$props;let{labelClass=undefined}=$$props;let{innerClass=undefined}=$$props;let{hideLabel=false}=$$props;let{icon=undefined}=$$props;let{style=undefined}=$$props;let{disabled=undefined}=$$props;let{type=\"button\"}=$$props;let{onclick=undefined}=$$props;let{onkeydown=undefined}=$$props;let{action=()=>{}}=$$props;let root;const isEventTarget$1=e=>isEventTarget(e,root);const getElement=()=>root;function button_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{root=$$value;$$invalidate(8,root);});}$$self.$$set=$$props=>{if(\"class\"in $$props)$$invalidate(12,klass=$$props.class);if(\"label\"in $$props)$$invalidate(0,label=$$props.label);if(\"labelClass\"in $$props)$$invalidate(13,labelClass=$$props.labelClass);if(\"innerClass\"in $$props)$$invalidate(14,innerClass=$$props.innerClass);if(\"hideLabel\"in $$props)$$invalidate(15,hideLabel=$$props.hideLabel);if(\"icon\"in $$props)$$invalidate(1,icon=$$props.icon);if(\"style\"in $$props)$$invalidate(2,style=$$props.style);if(\"disabled\"in $$props)$$invalidate(3,disabled=$$props.disabled);if(\"type\"in $$props)$$invalidate(4,type=$$props.type);if(\"onclick\"in $$props)$$invalidate(5,onclick=$$props.onclick);if(\"onkeydown\"in $$props)$$invalidate(6,onkeydown=$$props.onkeydown);if(\"action\"in $$props)$$invalidate(7,action=$$props.action);if(\"$$scope\"in $$props)$$invalidate(20,$$scope=$$props.$$scope);};let elButtonInnerClass;let elButtonClass;let elLabelClass;$$self.$$.update=()=>{if($$self.$$.dirty&/*innerClass*/16384){$$invalidate(9,elButtonInnerClass=arrayJoin([\"DokaButtonInner\",innerClass]));}if($$self.$$.dirty&/*hideLabel, klass*/36864){$$invalidate(10,elButtonClass=arrayJoin([\"DokaButton\",hideLabel&&\"DokaButtonIconOnly\",klass]));}if($$self.$$.dirty&/*hideLabel, labelClass*/40960){$$invalidate(11,elLabelClass=arrayJoin([hideLabel?\"implicit\":\"DokaButtonLabel\",labelClass]));}};return[label,icon,style,disabled,type,onclick,onkeydown,action,root,elButtonInnerClass,elButtonClass,elLabelClass,klass,labelClass,innerClass,hideLabel,isEventTarget$1,getElement,slots,button_binding,$$scope];}class Button extends SvelteComponent{constructor(options){super();init(this,options,instance$5,create_fragment$5,safe_not_equal,{class:12,label:0,labelClass:13,innerClass:14,hideLabel:15,icon:1,style:2,disabled:3,type:4,onclick:5,onkeydown:6,action:7,isEventTarget:16,getElement:17});}get isEventTarget(){return this.$$.ctx[16];}get getElement(){return this.$$.ctx[17];}}var arrayRemove=(array,predicate)=>{const index=array.findIndex(predicate);if(index>=0)return array.splice(index,1);return undefined;};// svelte\n// constants\nconst INERTIA_THRESHOLD=0.25;// when force of velocity exceeds this value we drift\nconst INERTIA_DISTANCE_MULTIPLIER=50;const INERTIA_DURATION_MULTIPLIER=80;const TAP_DURATION_MAX=300;const TAP_DISTANCE_MAX=64;const DOUBLE_TAP_DURATION_MAX=700;const DOUBLE_TAP_DISTANCE_MAX=128;const isContextMenuAction=e=>isNumber(e.button)&&e.button!==0;const getPinchScalar=(offset,current)=>{return(current-offset)/offset;};var interactable=(node,options={})=>{// set defaults\nconst{inertia=false,matchTarget=false,pinch=false,getEventPosition=e=>vectorCreate(e.clientX,e.clientY)}=options;//\n// helpers\n//\nfunction dispatch(type,detail){node.dispatchEvent(new CustomEvent(type,{detail}));}function resetInertia(){if(inertiaTweenUnsubscribe)inertiaTweenUnsubscribe();inertiaTweenUnsubscribe=undefined;}//#region pointer registry\nconst pointers=[];const addPointer=e=>{const pointer={timeStamp:e.timeStamp,timeStampInitial:e.timeStamp,position:getEventPosition(e),origin:getEventPosition(e),velocity:vectorCreateEmpty(),translation:vectorCreateEmpty(),interactionState:undefined,event:e};pointers.push(pointer);pointer.interactionState=getInteractionState(pointers);};const removePointer=e=>{const pointer=arrayRemove(pointers,pointer=>pointer.event.pointerId===e.pointerId);if(pointer)return pointer[0];};const getPointerIndex=e=>pointers.findIndex(pointer=>pointer.event.pointerId===e.pointerId);const flattenPointerOrigin=pointer=>{pointer.origin.x=pointer.position.x;pointer.origin.y=pointer.position.y;pointer.translation.x=0;pointer.translation.y=0;};const updatePointer=e=>{const pointer=getPointer(e);if(!pointer)return;const{timeStamp}=e;// position\nconst eventPosition=getEventPosition(e);// duration between previous interaction and new interaction, an interaction duration cannot be faster than 1 millisecond\nconst interactionDuration=Math.max(1,timeStamp-pointer.timeStamp);// calculate velocity\npointer.velocity.x=(eventPosition.x-pointer.position.x)/interactionDuration;pointer.velocity.y=(eventPosition.y-pointer.position.y)/interactionDuration;// update the translation\npointer.translation.x=eventPosition.x-pointer.origin.x;pointer.translation.y=eventPosition.y-pointer.origin.y;// set new state\npointer.timeStamp=timeStamp;pointer.position.x=eventPosition.x;pointer.position.y=eventPosition.y;pointer.event=e;};const getPointer=e=>{const i=getPointerIndex(e);if(i<0)return;return pointers[i];};const isSingleTouching=()=>pointers.length===1;const isMultiTouching=()=>pointers.length===2;const getDistance=(pointers,position)=>{const distanceTotal=pointers.reduce((prev,curr)=>{prev+=vectorDistance(position,curr.position);return prev;},0);return distanceTotal/pointers.length;};const getInteractionState=pointers=>{const center=vectorCenter(pointers.map(pointer=>pointer.position));const distance=getDistance(pointers,center);return{center,distance,velocity:vectorCenter(pointers.map(pointer=>pointer.velocity)),translation:vectorCenter(pointers.map(pointer=>pointer.translation))};};//#endregion\nlet inertiaTween;let inertiaTweenUnsubscribe;let pinchOffset;let currentTranslation;let currentScale;let isGesture;let lastTapTimeStamp=0;let lastTapPosition=undefined;// start handling interactions\nnode.addEventListener('pointerdown',handlePointerdown);function handlePointerdown(e){// ignore more than two pointers for now\nif(isMultiTouching())return;// not interested in context menu\nif(isContextMenuAction(e))return;// target should equal node, if it doesn't user might have clicked one of the nodes children\nif(matchTarget&&e.target!==node)return;// stop any previous inertia tweens\nresetInertia();// register this pointer\naddPointer(e);// if is first pointer we need to init the drag gesture\nif(isSingleTouching()){// handle pointer events\ndocument.documentElement.addEventListener('pointermove',handlePointermove);document.documentElement.addEventListener('pointerup',handlePointerup);document.documentElement.addEventListener('pointercancel',handlePointerup);// clear vars\nisGesture=false;currentScale=0;currentTranslation=vectorCreateEmpty();pinchOffset=undefined;dispatch('interactionstart',{origin:vectorClone(getPointer(e).origin)});}else if(pinch){isGesture=true;pinchOffset=vectorDistance(pointers[0].position,pointers[1].position);currentTranslation.x+=pointers[0].translation.x;currentTranslation.y+=pointers[0].translation.y;flattenPointerOrigin(pointers[0]);}}//\n// pointer move can only be a primary event (other pointers are not handled)\n//\nfunction handlePointermove(e){// prevent selection of text (Safari)\ne.preventDefault();// update pointer state\nupdatePointer(e);let scalar=currentScale;let translation=vectorClone(pointers[0].translation);if(pinch&&isMultiTouching()){// current offset\ntranslation.x+=pointers[1].translation.x;translation.y+=pointers[1].translation.y;// current pinch distance\nconst pinchCurrent=vectorDistance(pointers[0].position,pointers[1].position);// to find out scalar we calculate the difference between the pinch offset and the new pinch\nscalar+=getPinchScalar(pinchOffset,pinchCurrent);}translation.x+=currentTranslation.x;translation.y+=currentTranslation.y;dispatch('interactionupdate',{translation,scalar:pinch?scalar:undefined});}//\n// pointer up can only be a primary event (other pointers are not handled)\n//\nfunction handlePointerup(e){// remove pointer from active pointers array\nconst removedPointer=removePointer(e);// store current size\nif(pinch&&isSingleTouching()){// calculate current scale\nconst pinchCurrent=vectorDistance(pointers[0].position,removedPointer.position);currentScale=(currentScale||0)+getPinchScalar(pinchOffset,pinchCurrent);currentTranslation.x+=pointers[0].translation.x+removedPointer.translation.x;currentTranslation.y+=pointers[0].translation.y+removedPointer.translation.y;flattenPointerOrigin(pointers[0]);}// check if this was a tap\nlet isTap=false;let isDoubleTap=false;if(!isGesture){const interactionEnd=performance.now();const interactionDuration=interactionEnd-removedPointer.timeStampInitial;const interactionDistanceSquared=vectorDistanceSquared(removedPointer.translation);isTap=interactionDistanceSquared<TAP_DISTANCE_MAX&&interactionDuration<TAP_DURATION_MAX;isDoubleTap=!!(lastTapPosition&&isTap&&interactionEnd-lastTapTimeStamp<DOUBLE_TAP_DURATION_MAX&&vectorDistanceSquared(lastTapPosition,removedPointer.position)<DOUBLE_TAP_DISTANCE_MAX);if(isTap){lastTapPosition=vectorClone(removedPointer.position);lastTapTimeStamp=interactionEnd;}}// we wait till last multi-touch interaction is finished, all pointers need to be de-registered before proceeding\nif(pointers.length>0)return;// stop listening\ndocument.documentElement.removeEventListener('pointermove',handlePointermove);document.documentElement.removeEventListener('pointerup',handlePointerup);document.documentElement.removeEventListener('pointercancel',handlePointerup);const translation=vectorClone(removedPointer.translation);const velocity=vectorClone(removedPointer.velocity);// allows cancelling inertia from release handler\nlet inertiaPrevented=false;// user has released interaction\ndispatch('interactionrelease',{isTap,isDoubleTap,translation,scalar:currentScale,preventInertia:()=>inertiaPrevented=true});// stop intantly if not a lot of force applied\nconst force=vectorDistance(velocity);if(inertiaPrevented||!inertia||force<INERTIA_THRESHOLD){return handleEnd(translation,{isTap,isDoubleTap});}// drift\ninertiaTween=tweened(vectorClone(translation),{easing:circOut,duration:force*INERTIA_DURATION_MULTIPLIER});inertiaTween.set({x:translation.x+velocity.x*INERTIA_DISTANCE_MULTIPLIER,y:translation.y+velocity.y*INERTIA_DISTANCE_MULTIPLIER}).then(()=>{// if has unsubscribed (tween was reset)\nif(!inertiaTweenUnsubscribe)return;// go!\nhandleEnd(get_store_value(inertiaTween),{isTap,isDoubleTap});});inertiaTweenUnsubscribe=inertiaTween.subscribe(handleInertiaUpdate);}function handleInertiaUpdate(inertiaTranslation){// if is same as previous position, ignore\nif(!inertiaTranslation)return;// || vectorEqual(inertiaTranslation, translation)) return;\n// this will handle drift interactions\ndispatch('interactionupdate',{translation:inertiaTranslation,scalar:pinch?currentScale:undefined});}function handleEnd(translation,tapState){resetInertia();dispatch('interactionend',_objectSpread(_objectSpread({},tapState),{},{translation,scalar:pinch?currentScale:undefined}));}return{destroy(){resetInertia();node.removeEventListener('pointerdown',handlePointerdown);}};};var nudgeable=(element,options={})=>{// if added as action on non focusable element you should add tabindex=0 attribute\nconst{direction=undefined,shiftMultiplier=10,bubbles=false,stopKeydownPropagation=true}=options;const isHorizontalDirection=direction==='horizontal';const isVerticalDirection=direction==='vertical';const handleKeydown=e=>{const{key}=e;const isShift=e.shiftKey;const isHorizontalAction=/up|down/i.test(key);const isVerticalAction=/left|right/i.test(key);// no directional key\nif(!isHorizontalAction&&!isVerticalAction)return;// is horizontal but up or down pressed\nif(isHorizontalDirection&&isVerticalAction)return;// is vertical but left or right pressed\nif(isVerticalDirection&&isHorizontalAction)return;// if holding shift move by a factor 10\nconst multiplier=isShift?shiftMultiplier:1;if(stopKeydownPropagation)e.stopPropagation();element.dispatchEvent(new CustomEvent('nudge',{bubbles,detail:vectorCreate((/left/i.test(key)?-1:/right/i.test(key)?1:0)*multiplier,(/up/i.test(key)?-1:/down/i.test(key)?1:0)*multiplier)}));};element.addEventListener('keydown',handleKeydown);return{destroy(){element.removeEventListener('keydown',handleKeydown);}};};function elastify(translation,dist){return dist*Math.sign(translation)*Math.log10(1+Math.abs(translation)/dist);}const elastifyRects=(a,b,dist)=>{if(!b)return rectClone(a);const left=a.x+elastify(b.x-a.x,dist);const right=a.x+a.width+elastify(b.x+b.width-(a.x+a.width),dist);const top=a.y+elastify(b.y-a.y,dist);const bottom=a.y+a.height+elastify(b.y+b.height-(a.y+a.height),dist);return{x:left,y:top,width:right-left,height:bottom-top};};var unitToPixels=(value,element)=>{if(!value)return;if(/em/.test(value))return parseInt(value,10)*16;if(/px/.test(value))return parseInt(value,10);};var getWheelDelta=e=>{let d=e.detail||0;// @ts-ignore\nif(e.wheelDelta||e.wheelDeltaY)d=(-e.wheelDelta||-e.wheelDeltaY)/120;if(!d)d=e.deltaY;return d;};/* src/core/ui/components/Scrollable.svelte generated by Svelte v3.29.4 */function create_fragment$6(ctx){let div1;let div0;let interactable_action;let measurable_action;let div1_class_value;let measurable_action_1;let nudgeable_action;let current;let mounted;let dispose;const default_slot_template=/*#slots*/ctx[29].default;const default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[28],null);return{c(){div1=element(\"div\");div0=element(\"div\");if(default_slot)default_slot.c();attr(div0,\"style\",/*childStyle*/ctx[6]);attr(div1,\"class\",div1_class_value=arrayJoin([\"DokaScrollable\",/*klass*/ctx[0]]));attr(div1,\"style\",/*overflowStyle*/ctx[4]);attr(div1,\"data-direction\",/*scrollDirection*/ctx[1]);attr(div1,\"data-state\",/*containerState*/ctx[5]);},m(target,anchor){insert(target,div1,anchor);append(div1,div0);if(default_slot){default_slot.m(div0,null);}/*div1_binding*/ctx[31](div1);current=true;if(!mounted){dispose=[listen(div0,\"interactionstart\",/*handleDragStart*/ctx[9]),listen(div0,\"interactionupdate\",/*handleDragMove*/ctx[11]),listen(div0,\"interactionend\",/*handleDragEnd*/ctx[12]),listen(div0,\"interactionrelease\",/*handleDragRelease*/ctx[10]),action_destroyer(interactable_action=interactable.call(null,div0,{inertia:true})),listen(div0,\"measure\",/*measure_handler*/ctx[30]),action_destroyer(measurable_action=measurable.call(null,div0)),listen(div1,\"wheel\",/*handleWheel*/ctx[14]),listen(div1,\"scroll\",/*handleScroll*/ctx[16]),listen(div1,\"focusin\",/*handleFocus*/ctx[15]),listen(div1,\"nudge\",/*handleNudge*/ctx[17]),listen(div1,\"measure\",/*handleResizeScrollContainer*/ctx[13]),action_destroyer(measurable_action_1=measurable.call(null,div1,{observePosition:true})),action_destroyer(nudgeable_action=nudgeable.call(null,div1,{direction:/*scrollDirection*/ctx[1]===\"x\"?\"horizontal\":\"vertical\",stopKeydownPropagation:false}))];mounted=true;}},p(ctx,dirty){if(default_slot){if(default_slot.p&&dirty[0]&/*$$scope*/268435456){update_slot(default_slot,default_slot_template,ctx,/*$$scope*/ctx[28],dirty,null,null);}}if(!current||dirty[0]&/*childStyle*/64){attr(div0,\"style\",/*childStyle*/ctx[6]);}if(!current||dirty[0]&/*klass*/1&&div1_class_value!==(div1_class_value=arrayJoin([\"DokaScrollable\",/*klass*/ctx[0]]))){attr(div1,\"class\",div1_class_value);}if(!current||dirty[0]&/*overflowStyle*/16){attr(div1,\"style\",/*overflowStyle*/ctx[4]);}if(!current||dirty[0]&/*scrollDirection*/2){attr(div1,\"data-direction\",/*scrollDirection*/ctx[1]);}if(!current||dirty[0]&/*containerState*/32){attr(div1,\"data-state\",/*containerState*/ctx[5]);}if(nudgeable_action&&is_function(nudgeable_action.update)&&dirty[0]&/*scrollDirection*/2)nudgeable_action.update.call(null,{direction:/*scrollDirection*/ctx[1]===\"x\"?\"horizontal\":\"vertical\",stopKeydownPropagation:false});},i(local){if(current)return;transition_in(default_slot,local);current=true;},o(local){transition_out(default_slot,local);current=false;},d(detaching){if(detaching)detach(div1);if(default_slot)default_slot.d(detaching);/*div1_binding*/ctx[31](null);mounted=false;run_all(dispose);}};}function instance$6($$self,$$props,$$invalidate){let $scrollOffset;let $keysPressedStore;let{$$slots:slots={},$$scope}=$$props;const dispatch=createEventDispatcher();const keysPressedStore=getContext(\"keysPressed\");component_subscribe($$self,keysPressedStore,value=>$$invalidate(46,$keysPressedStore=value));let scrollState=\"idle\";let scrollOrigin;let scrollRect;let scrollContainerRect;let scrollReleased;let scrollOffset=spring(0);component_subscribe($$self,scrollOffset,value=>$$invalidate(44,$scrollOffset=value));let{class:klass=undefined}=$$props;let{scrollBlockInteractionDist=5}=$$props;let{scrollStep=10}=$$props;// the distance multiplier for each mouse scroll interaction (delta)\nlet{scrollFocusMargin=64}=$$props;// the margin used around elements to decided where to move the focus so elements are positioned into view with some spacing around them, this allows peaking at next/previous elements\nlet{scrollDirection=\"x\"}=$$props;let{scrollAutoCancel=false}=$$props;let{elasticity=0}=$$props;let{onscroll=noop}=$$props;let{maskFeatherSize=undefined}=$$props;let{maskFeatherStartOpacity=undefined}=$$props;let{maskFeatherEndOpacity=undefined}=$$props;let{scroll=undefined}=$$props;// logic\nlet container;let overflowStyle=\"\";// is scroll in reset state\nlet scrollAtRest=true;// triggers onscroll callback\nscrollOffset.subscribe(value=>{const pos=vectorCreateEmpty();pos[scrollDirection]=value;onscroll(pos);});const limitOffsetToContainer=offset=>Math.max(Math.min(0,offset),scrollContainerRect[size]-scrollRect[size]);let scrollFirstMove;let scrollCancelled;let scrollTranslationPrev;const isHorizontalTranslation=translation=>{const velocity=vectorApply(vectorCreate(translation.x-scrollTranslationPrev.x,translation.y-scrollTranslationPrev.y),Math.abs);scrollTranslationPrev=vectorClone(translation);const speed=vectorDistanceSquared(velocity);const diff=velocity.x-velocity.y;return!(speed>1&&diff<-0.5);};const handleDragStart=()=>{// not overflowing so no need to handle\nif(!overflows)return;scrollCancelled=false;scrollFirstMove=true;scrollTranslationPrev=vectorCreate(0,0);scrollReleased=false;$$invalidate(32,scrollState=\"idle\");scrollOrigin=get_store_value(scrollOffset);};const handleDragRelease=({detail})=>{if(!overflows)return;scrollReleased=true;$$invalidate(32,scrollState=\"idle\");};const handleDragMove=({detail})=>{if(!overflows)return;if(scrollCancelled)return;// fixes problem with single move event fired when clicking\nif(scrollFirstMove){scrollFirstMove=false;if(vectorDistanceSquared(detail.translation)<0.1)return;}if(scrollAutoCancel&&scrollDirection===\"x\"&&!isHorizontalTranslation(detail.translation)){scrollCancelled=true;return;}setScrollOffset(scrollOrigin+detail.translation[scrollDirection],{elastic:true});};const handleDragEnd=({detail})=>{if(!overflows)return;if(scrollCancelled)return;const offset=scrollOrigin+detail.translation[scrollDirection];const offsetLimited=limitOffsetToContainer(offset);scrollAtRest=false;scrollOffset.set(offsetLimited).then(res=>{if(!scrollReleased)return;scrollAtRest=true;});};const handleResizeScrollContainer=({detail})=>{$$invalidate(34,scrollContainerRect=detail);dispatch(\"measure\",{x:detail.x,y:detail.y,width:detail.width,height:detail.height});};const setScrollOffset=(offset,options={})=>{const{elastic=false,animate=false}=options;// prevents clicks on child elements if the container is being scrolled\nif(Math.abs(offset)>scrollBlockInteractionDist&&scrollState===\"idle\"&&!scrollReleased){$$invalidate(32,scrollState=\"scrolling\");}const offsetLimited=limitOffsetToContainer(offset);const offsetVisual=elastic&&elasticity&&!scrollReleased?offsetLimited+elastify(offset-offsetLimited,elasticity):offsetLimited;let snapToPosition=true;if(animate){snapToPosition=false;}else if(!scrollAtRest){snapToPosition=!scrollReleased;}scrollAtRest=false;scrollOffset.set(offsetVisual,{hard:snapToPosition}).then(res=>{if(!scrollReleased)return;scrollAtRest=true;});};const handleWheel=e=>{// don't do anything if isn't overflowing\nif(!overflows)return;// scroll down -> move to right/down\n// scroll up -> move to left/up\n// don't run default actions, prevent other actions from running\ne.preventDefault();e.stopPropagation();// apply wheel delta to offset\nconst delta=getWheelDelta(e);const offset=get_store_value(scrollOffset);setScrollOffset(offset+delta*scrollStep,{animate:true});};const handleFocus=e=>{// don't do anything if isn't overflowing\nif(!overflows)return;// ignore this handler if is dragging\nif(!scrollReleased&&!$keysPressedStore.length)return;let target=e.target;// when a target is marked as implicit we use its parent elemetn\nif(e.target.classList.contains(\"implicit\"))target=target.parentNode;// get bounds\nconst start=target[scrollDirection===\"x\"?\"offsetLeft\":\"offsetTop\"];//.offsetLeft;\nconst space=target[scrollDirection===\"x\"?\"offsetWidth\":\"offsetHeight\"];//.offsetWidth;\nconst end=start+space;// we need to know the current offset of the scroll so we can determine if the target is in view\nconst currentScrollOffset=get_store_value(scrollOffset);// the margin around elements to keep in mind when focussing items\nconst margin=scrollFocusMargin+maskFeatherSize;if(currentScrollOffset+start<margin){setScrollOffset(-start+margin);}else if(currentScrollOffset+end>scrollContainerRect[size]-margin){setScrollOffset(scrollContainerRect[size]-end-margin,{animate:true});}};const handleScroll=()=>{// the scroll handler corrects auto browser scroll, \n// is triggered when browser tries to focus an \n// element outside of the scrollcontiner\n$$invalidate(3,container[scrollDirection===\"x\"?\"scrollLeft\":\"scrollTop\"]=0,container);};const handleNudge=({detail})=>{const delta=-2*detail[scrollDirection];const offset=get_store_value(scrollOffset);setScrollOffset(offset+delta*scrollStep,{animate:true});};const measure_handler=e=>$$invalidate(2,scrollRect=e.detail);function div1_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{container=$$value;$$invalidate(3,container);});}$$self.$$set=$$props=>{if(\"class\"in $$props)$$invalidate(0,klass=$$props.class);if(\"scrollBlockInteractionDist\"in $$props)$$invalidate(21,scrollBlockInteractionDist=$$props.scrollBlockInteractionDist);if(\"scrollStep\"in $$props)$$invalidate(22,scrollStep=$$props.scrollStep);if(\"scrollFocusMargin\"in $$props)$$invalidate(23,scrollFocusMargin=$$props.scrollFocusMargin);if(\"scrollDirection\"in $$props)$$invalidate(1,scrollDirection=$$props.scrollDirection);if(\"scrollAutoCancel\"in $$props)$$invalidate(24,scrollAutoCancel=$$props.scrollAutoCancel);if(\"elasticity\"in $$props)$$invalidate(25,elasticity=$$props.elasticity);if(\"onscroll\"in $$props)$$invalidate(26,onscroll=$$props.onscroll);if(\"maskFeatherSize\"in $$props)$$invalidate(18,maskFeatherSize=$$props.maskFeatherSize);if(\"maskFeatherStartOpacity\"in $$props)$$invalidate(19,maskFeatherStartOpacity=$$props.maskFeatherStartOpacity);if(\"maskFeatherEndOpacity\"in $$props)$$invalidate(20,maskFeatherEndOpacity=$$props.maskFeatherEndOpacity);if(\"scroll\"in $$props)$$invalidate(27,scroll=$$props.scroll);if(\"$$scope\"in $$props)$$invalidate(28,$$scope=$$props.$$scope);};let size;let axis;let containerStyle;let containerFeatherSize;let overflows;let containerState;let childStyle;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*scrollDirection*/2){$$invalidate(40,size=scrollDirection===\"x\"?\"width\":\"height\");}if($$self.$$.dirty[0]&/*scrollDirection*/2){$$invalidate(41,axis=scrollDirection.toUpperCase());}if($$self.$$.dirty[0]&/*container*/8){$$invalidate(42,containerStyle=container&&getComputedStyle(container));}if($$self.$$.dirty[0]&/*container*/8|$$self.$$.dirty[1]&/*containerStyle*/2048){$$invalidate(43,containerFeatherSize=containerStyle&&unitToPixels(containerStyle.getPropertyValue(\"--scrollable-feather-size\")));}if($$self.$$.dirty[0]&/*scrollRect, maskFeatherStartOpacity, maskFeatherEndOpacity*/1572868|$$self.$$.dirty[1]&/*$scrollOffset, scrollContainerRect, containerFeatherSize, size*/12808){if($scrollOffset!=null&&scrollContainerRect&&containerFeatherSize!=null&&scrollRect){const startOffset=-$scrollOffset/containerFeatherSize;const endOffset=-(scrollContainerRect[size]-scrollRect[size]-$scrollOffset)/containerFeatherSize;$$invalidate(19,maskFeatherStartOpacity=clamp(1-startOffset,0,1));$$invalidate(20,maskFeatherEndOpacity=clamp(1-endOffset,0,1));$$invalidate(18,maskFeatherSize=containerFeatherSize);$$invalidate(4,overflowStyle=`--scrollable-feather-start-opacity: ${maskFeatherStartOpacity};--scrollable-feather-end-opacity: ${maskFeatherEndOpacity}`);}}if($$self.$$.dirty[0]&/*container, scroll*/134217736){// update scroll position\nif(container&&scroll!==undefined){if(isNumber(scroll))setScrollOffset(scroll);else setScrollOffset(scroll.scrollOffset,scroll);}}if($$self.$$.dirty[0]&/*scrollRect*/4|$$self.$$.dirty[1]&/*scrollContainerRect, size*/520){$$invalidate(45,overflows=scrollContainerRect&&scrollRect?scrollRect[size]>scrollContainerRect[size]:undefined);}if($$self.$$.dirty[1]&/*scrollState, overflows*/16386){$$invalidate(5,containerState=arrayJoin([scrollState,overflows?\"overflows\":undefined]));}if($$self.$$.dirty[1]&/*overflows, axis, $scrollOffset*/25600){$$invalidate(6,childStyle=overflows?`transform: translate${axis}(${$scrollOffset}px)`:undefined);}};return[klass,scrollDirection,scrollRect,container,overflowStyle,containerState,childStyle,keysPressedStore,scrollOffset,handleDragStart,handleDragRelease,handleDragMove,handleDragEnd,handleResizeScrollContainer,handleWheel,handleFocus,handleScroll,handleNudge,maskFeatherSize,maskFeatherStartOpacity,maskFeatherEndOpacity,scrollBlockInteractionDist,scrollStep,scrollFocusMargin,scrollAutoCancel,elasticity,onscroll,scroll,$$scope,slots,measure_handler,div1_binding];}class Scrollable extends SvelteComponent{constructor(options){super();init(this,options,instance$6,create_fragment$6,safe_not_equal,{class:0,scrollBlockInteractionDist:21,scrollStep:22,scrollFocusMargin:23,scrollDirection:1,scrollAutoCancel:24,elasticity:25,onscroll:26,maskFeatherSize:18,maskFeatherStartOpacity:19,maskFeatherEndOpacity:20,scroll:27},[-1,-1]);}}function fade(node,{delay=0,duration=400,easing=identity}){const o=+getComputedStyle(node).opacity;return{delay,duration,easing,css:t=>`opacity: ${t*o}`};}/* src/core/ui/components/StatusMessage.svelte generated by Svelte v3.29.4 */function create_fragment$7(ctx){let span;let t;let measure_action;let span_transition;let current;let mounted;let dispose;return{c(){span=element(\"span\");t=text(/*text*/ctx[0]);attr(span,\"class\",\"DokaStatusMessage\");},m(target,anchor){insert(target,span,anchor);append(span,t);current=true;if(!mounted){dispose=[listen(span,\"measure\",function(){if(is_function(/*onmeasure*/ctx[1]))/*onmeasure*/ctx[1].apply(this,arguments);}),action_destroyer(measure_action=measurable.call(null,span))];mounted=true;}},p(new_ctx,[dirty]){ctx=new_ctx;if(!current||dirty&/*text*/1)set_data(t,/*text*/ctx[0]);},i(local){if(current)return;add_render_callback(()=>{if(!span_transition)span_transition=create_bidirectional_transition(span,fade,{},true);span_transition.run(1);});current=true;},o(local){if(!span_transition)span_transition=create_bidirectional_transition(span,fade,{},false);span_transition.run(0);current=false;},d(detaching){if(detaching)detach(span);if(detaching&&span_transition)span_transition.end();mounted=false;run_all(dispose);}};}function instance$7($$self,$$props,$$invalidate){let{text}=$$props;let{onmeasure=noop}=$$props;$$self.$$set=$$props=>{if(\"text\"in $$props)$$invalidate(0,text=$$props.text);if(\"onmeasure\"in $$props)$$invalidate(1,onmeasure=$$props.onmeasure);};return[text,onmeasure];}class StatusMessage extends SvelteComponent{constructor(options){super();init(this,options,instance$7,create_fragment$7,safe_not_equal,{text:0,onmeasure:1});}}/* src/core/ui/components/ProgressIndicator.svelte generated by Svelte v3.29.4 */function create_fragment$8(ctx){let span1;let svg;let g;let circle0;let circle1;let t0;let span0;let t1;return{c(){span1=element(\"span\");svg=svg_element(\"svg\");g=svg_element(\"g\");circle0=svg_element(\"circle\");circle1=svg_element(\"circle\");t0=space();span0=element(\"span\");t1=text(/*formattedValue*/ctx[0]);attr(circle0,\"class\",\"DokaProgressIndicatorBar\");attr(circle0,\"r\",\"8.5\");attr(circle0,\"cx\",\"10\");attr(circle0,\"cy\",\"10\");attr(circle0,\"stroke-linecap\",\"round\");attr(circle0,\"opacity\",\".25\");attr(circle1,\"class\",\"DokaProgressIndicatorFill\");attr(circle1,\"r\",\"8.5\");attr(circle1,\"stroke-dasharray\",/*circleValue*/ctx[1]);attr(circle1,\"cx\",\"10\");attr(circle1,\"cy\",\"10\");attr(circle1,\"transform\",\"rotate(-90) translate(-20)\");attr(g,\"fill\",\"none\");attr(g,\"stroke\",\"currentColor\");attr(g,\"stroke-width\",\"2.5\");attr(g,\"stroke-linecap\",\"round\");attr(g,\"opacity\",/*circleOpacity*/ctx[2]);attr(svg,\"width\",\"20\");attr(svg,\"height\",\"20\");attr(svg,\"viewBox\",\"0 0 20 20\");attr(svg,\"xmlns\",\"http://www.w3.org/2000/svg\");attr(svg,\"aria-hidden\",\"true\");attr(svg,\"focusable\",\"false\");attr(span0,\"class\",\"implicit\");attr(span1,\"class\",\"DokaProgressIndicator\");attr(span1,\"data-status\",/*status*/ctx[3]);},m(target,anchor){insert(target,span1,anchor);append(span1,svg);append(svg,g);append(g,circle0);append(g,circle1);append(span1,t0);append(span1,span0);append(span0,t1);},p(ctx,[dirty]){if(dirty&/*circleValue*/2){attr(circle1,\"stroke-dasharray\",/*circleValue*/ctx[1]);}if(dirty&/*circleOpacity*/4){attr(g,\"opacity\",/*circleOpacity*/ctx[2]);}if(dirty&/*formattedValue*/1)set_data(t1,/*formattedValue*/ctx[0]);if(dirty&/*status*/8){attr(span1,\"data-status\",/*status*/ctx[3]);}},i:noop$1,o:noop$1,d(detaching){if(detaching)detach(span1);}};}function instance$8($$self,$$props,$$invalidate){let $animatedProgressClamped;const dispatch=createEventDispatcher();let{progress}=$$props;let{min=0}=$$props;let{max=100}=$$props;let{labelBusy=\"Busy\"}=$$props;const animatedValue=spring(0,{precision:0.01});const animatedProgressClamped=derived([animatedValue],$animatedValue=>clamp($animatedValue,min,max));component_subscribe($$self,animatedProgressClamped,value=>$$invalidate(9,$animatedProgressClamped=value));animatedProgressClamped.subscribe(value=>{if(progress===1&&Math.round(value)>=100)dispatch(\"complete\");});$$self.$$set=$$props=>{if(\"progress\"in $$props)$$invalidate(5,progress=$$props.progress);if(\"min\"in $$props)$$invalidate(6,min=$$props.min);if(\"max\"in $$props)$$invalidate(7,max=$$props.max);if(\"labelBusy\"in $$props)$$invalidate(8,labelBusy=$$props.labelBusy);};let formattedValue;let circleValue;let circleOpacity;let status;$$self.$$.update=()=>{if($$self.$$.dirty&/*progress*/32){progress&&progress!==Infinity&&animatedValue.set(progress*100);}if($$self.$$.dirty&/*progress, labelBusy, $animatedProgressClamped*/800){$$invalidate(0,formattedValue=progress===Infinity?labelBusy:`${Math.round($animatedProgressClamped)}%`);}if($$self.$$.dirty&/*progress, $animatedProgressClamped*/544){$$invalidate(1,circleValue=progress===Infinity?\"26.5 53\":`${$animatedProgressClamped/100*53} 53`);}if($$self.$$.dirty&/*progress, $animatedProgressClamped*/544){$$invalidate(2,circleOpacity=Math.min(1,progress===Infinity?1:$animatedProgressClamped/10));}if($$self.$$.dirty&/*progress*/32){$$invalidate(3,status=progress===Infinity?\"busy\":\"loading\");}};return[formattedValue,circleValue,circleOpacity,status,animatedProgressClamped,progress,min,max,labelBusy];}class ProgressIndicator extends SvelteComponent{constructor(options){super();init(this,options,instance$8,create_fragment$8,safe_not_equal,{progress:5,min:6,max:7,labelBusy:8});}}/* src/core/ui/components/StatusProgress.svelte generated by Svelte v3.29.4 */function create_fragment$9(ctx){let span;let progressindicator;let current;progressindicator=new ProgressIndicator({props:{progress:/*progress*/ctx[0]}});progressindicator.$on(\"complete\",function(){if(is_function(/*oncomplete*/ctx[1]))/*oncomplete*/ctx[1].apply(this,arguments);});return{c(){span=element(\"span\");create_component(progressindicator.$$.fragment);attr(span,\"class\",\"DokaStatusProgress\");attr(span,\"style\",/*style*/ctx[2]);},m(target,anchor){insert(target,span,anchor);mount_component(progressindicator,span,null);current=true;},p(new_ctx,[dirty]){ctx=new_ctx;const progressindicator_changes={};if(dirty&/*progress*/1)progressindicator_changes.progress=/*progress*/ctx[0];progressindicator.$set(progressindicator_changes);if(!current||dirty&/*style*/4){attr(span,\"style\",/*style*/ctx[2]);}},i(local){if(current)return;transition_in(progressindicator.$$.fragment,local);current=true;},o(local){transition_out(progressindicator.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(span);destroy_component(progressindicator);}};}function instance$9($$self,$$props,$$invalidate){let{offset=0}=$$props;let{visible=true}=$$props;let{progress}=$$props;let{oncomplete=noop}=$$props;$$self.$$set=$$props=>{if(\"offset\"in $$props)$$invalidate(3,offset=$$props.offset);if(\"visible\"in $$props)$$invalidate(4,visible=$$props.visible);if(\"progress\"in $$props)$$invalidate(0,progress=$$props.progress);if(\"oncomplete\"in $$props)$$invalidate(1,oncomplete=$$props.oncomplete);};let style;$$self.$$.update=()=>{if($$self.$$.dirty&/*offset, visible*/24){$$invalidate(2,style=`transform: translateX(${offset}px); opacity: ${visible?1:0}`);}};return[progress,oncomplete,style,offset,visible];}class StatusProgress extends SvelteComponent{constructor(options){super();init(this,options,instance$9,create_fragment$9,safe_not_equal,{offset:3,visible:4,progress:0,oncomplete:1});}}/* src/core/ui/components/DynamicComponentTree.svelte generated by Svelte v3.29.4 */function get_each_context$2(ctx,list,i){const child_ctx=ctx.slice();child_ctx[4]=list[i][0];child_ctx[5]=list[i][1];child_ctx[6]=list[i][2];child_ctx[0]=list[i][3];return child_ctx;}// (28:4) {:else}\nfunction create_else_block(ctx){let switch_instance;let switch_instance_anchor;let current;const switch_instance_spread_levels=[/*props*/ctx[6]];var switch_value=/*node*/ctx[4];function switch_props(ctx){let switch_instance_props={};for(let i=0;i<switch_instance_spread_levels.length;i+=1){switch_instance_props=assign(switch_instance_props,switch_instance_spread_levels[i]);}return{props:switch_instance_props};}if(switch_value){switch_instance=new switch_value(switch_props());}return{c(){if(switch_instance)create_component(switch_instance.$$.fragment);switch_instance_anchor=empty();},m(target,anchor){if(switch_instance){mount_component(switch_instance,target,anchor);}insert(target,switch_instance_anchor,anchor);current=true;},p(ctx,dirty){const switch_instance_changes=dirty&/*children*/1?get_spread_update(switch_instance_spread_levels,[get_spread_object(/*props*/ctx[6])]):{};if(switch_value!==(switch_value=/*node*/ctx[4])){if(switch_instance){group_outros();const old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,()=>{destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=new switch_value(switch_props());create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,switch_instance_anchor.parentNode,switch_instance_anchor);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(switch_instance_anchor);if(switch_instance)destroy_component(switch_instance,detaching);}};}// (26:4) {#if isString(node)}\nfunction create_if_block$1(ctx){let div;let dynamiccomponenttree;let current;dynamiccomponenttree=new DynamicComponentTree_1({props:{items:/*children*/ctx[0],discardEmptyItems:true}});let div_levels=[/*props*/ctx[6]];let div_data={};for(let i=0;i<div_levels.length;i+=1){div_data=assign(div_data,div_levels[i]);}return{c(){div=element(\"div\");create_component(dynamiccomponenttree.$$.fragment);set_attributes(div,div_data);},m(target,anchor){insert(target,div,anchor);mount_component(dynamiccomponenttree,div,null);current=true;},p(ctx,dirty){const dynamiccomponenttree_changes={};if(dirty&/*children*/1)dynamiccomponenttree_changes.items=/*children*/ctx[0];dynamiccomponenttree.$set(dynamiccomponenttree_changes);set_attributes(div,div_data=get_spread_update(div_levels,[dirty&/*children*/1&&/*props*/ctx[6]]));},i(local){if(current)return;transition_in(dynamiccomponenttree.$$.fragment,local);current=true;},o(local){transition_out(dynamiccomponenttree.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(dynamiccomponenttree);}};}// (25:0) {#each children as [node, key, props, children] (key) }\nfunction create_each_block$2(key_1,ctx){let first;let show_if;let current_block_type_index;let if_block;let if_block_anchor;let current;const if_block_creators=[create_if_block$1,create_else_block];const if_blocks=[];function select_block_type(ctx,dirty){if(dirty&/*children*/1)show_if=!!isString(/*node*/ctx[4]);if(show_if)return 0;return 1;}current_block_type_index=select_block_type(ctx,-1);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{key:key_1,first:null,c(){first=empty();if_block.c();if_block_anchor=empty();this.first=first;},m(target,anchor){insert(target,first,anchor);if_blocks[current_block_type_index].m(target,anchor);insert(target,if_block_anchor,anchor);current=true;},p(ctx,dirty){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx,dirty);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,()=>{if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(first);if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);}};}function create_fragment$a(ctx){let each_blocks=[];let each_1_lookup=new Map();let each_1_anchor;let current;let each_value=/*children*/ctx[0];const get_key=ctx=>/*key*/ctx[5];for(let i=0;i<each_value.length;i+=1){let child_ctx=get_each_context$2(ctx,each_value,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block$2(key,child_ctx));}return{c(){for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}each_1_anchor=empty();},m(target,anchor){for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(target,anchor);}insert(target,each_1_anchor,anchor);current=true;},p(ctx,[dirty]){if(dirty&/*children, isString*/1){const each_value=/*children*/ctx[0];group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,each_1_anchor.parentNode,outro_and_destroy_block,create_each_block$2,each_1_anchor,get_each_context$2);check_outros();}},i(local){if(current)return;for(let i=0;i<each_value.length;i+=1){transition_in(each_blocks[i]);}current=true;},o(local){for(let i=0;i<each_blocks.length;i+=1){transition_out(each_blocks[i]);}current=false;},d(detaching){for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d(detaching);}if(detaching)detach(each_1_anchor);}};}function instance$a($$self,$$props,$$invalidate){let{items}=$$props;let{discardEmptyItems=true}=$$props;const shouldRenderItem=item=>{// don't render falsy items\nif(!item)return false;// get relevant props\nconst[node,,,children]=item;// if item is component, we always render it\nif(!isString(node))return true;// item is tag, we have to check if children are empty\nreturn children.some(shouldRenderItem);};$$self.$$set=$$props=>{if(\"items\"in $$props)$$invalidate(1,items=$$props.items);if(\"discardEmptyItems\"in $$props)$$invalidate(2,discardEmptyItems=$$props.discardEmptyItems);};let children;$$self.$$.update=()=>{if($$self.$$.dirty&/*items, discardEmptyItems*/6){$$invalidate(0,children=(items&&discardEmptyItems?items.filter(shouldRenderItem):items)||[]);}};return[children,items,discardEmptyItems];}class DynamicComponentTree_1 extends SvelteComponent{constructor(options){super();init(this,options,instance$a,create_fragment$a,safe_not_equal,{items:1,discardEmptyItems:2});}}const ImageStoreProps=['file','size','loadState','processState','cropAspectRatio','cropLimitToImage','crop','cropMinSize','cropMaxSize','cropRange','cropOrigin','cropRectAspectRatio','rotation','rotationRange','targetSize','flipX','flipY','perspectiveX','perspectiveY','perspective','colorMatrix','convolutionMatrix','gamma','vignette','noise','decoration','annotation','backgroundColor','state'];const proxy=function(get,set,update){let subscribers=[];return{set,update,publish:value=>{subscribers.forEach(cb=>cb(value));},subscribe:cb=>{subscribers.push(cb);get(cb);return()=>{subscribers=subscribers.filter(item=>item!==cb);};}};};var createImageProxy=()=>{let unsubs;let image;const proxyStores=ImageStoreProps.reduce((prev,curr)=>{prev[curr]=proxy(// getter\ncb=>{// subscribe\nif(!image)return cb();const unsub=image.stores[curr].subscribe(cb);unsub();},// setter\nvalue=>{// set value on actual store if is defined\nif(!image)return;image.stores[curr].set(value);},// updater\ncb=>{if(!image)return;image.stores[curr].update(cb);});return prev;},{});const update=newImage=>{image=newImage;if(unsubs){// remove subscribers\nunsubs.forEach(unsub=>unsub());unsubs=undefined;}if(!newImage){// need to reset load state\nproxyStores['file'].publish(undefined);proxyStores['loadState'].publish(undefined);return;}unsubs=ImageStoreProps.map(prop=>newImage.stores[prop].subscribe(value=>proxyStores[prop].publish(value)));};return{update,stores:proxyStores};};var createPingRouter=(route,cancel=true)=>e=>{if(e.type!=='ping')return;if(cancel)e.stopPropagation();route(e.detail.type,e.detail.data);};var isTextarea=element=>/textarea/i.test(element.nodeName);var isTextInput=node=>/date|email|number|search|text|url/.test(node.type);var isTextField=node=>isTextarea(node)||isTextInput(node);var toKebabCase=(str,abbr)=>{return(abbr?stringReplace(str,abbr):str).replace(/([a-z])([A-Z])/g,'$1-$2').replace(/\\s+/g,'-').toLowerCase();};var matchMedia$1=(query,cb)=>{const mql=matchMedia(query);mql.addListener(cb);cb(mql);return{get matches(){return mql.matches;},destroy:()=>mql.removeListener(cb)};};var mediaQueryStore=(query,formatValue=passthrough)=>{const{subscribe,set}=writable(undefined);const mm=matchMedia$1(query,({matches})=>set(formatValue(matches)));return{subscribe,unsubscribe:mm.destroy};};var canPreventNavSwipe=()=>{// if not iOS we can't prevent swipe because it probably isn't a thing\nif(!isIOS())return false;// extract version number\nconst matches=navigator.userAgent.match(/OS (\\d+)_(\\d+)_?(\\d+)?/i)||[];const[,major,minor]=matches.map(v=>parseInt(v,10)||0);// is atleast version 13.4+\nreturn major>13||major===13&&minor>=4;};var calculateImageTransforms=(stageRect,rootRect,imageSize,cropRect,imageSelectionRect,imageScale,imagePerspectiveX,imagePerspectiveY,imageRotation,imageFlipX,imageFlipY)=>{if(!stageRect||!rootRect||!imageSize||!cropRect||!imageScale)return undefined;const viewRect=rectNormalizeOffset(rectClone(rootRect));const viewCenter=rectCenter(viewRect);const stageCenter=rectCenter(stageRect);const imageRect=rectCreateFromSize(imageSize);const imageCenter=rectCenter(imageRect);const imagePerspective=vectorCreate(imagePerspectiveX,imagePerspectiveY);// get base crop rect so we can correctly apply transforms\nconst cropRectBase=getBaseCropRect(imageSize,cropRect,imageRotation,imagePerspective);const cropRectBaseCenter=rectCenter(cropRectBase);const imageTranslation=vectorSubtract(vectorClone(imageCenter),cropRectBaseCenter);// calculate stage center offset from view center\nconst imageOffset=vectorSubtract(vectorClone(stageCenter),viewCenter);// correct for stage offset\nimageTranslation.x+=imageOffset.x;imageTranslation.y+=imageOffset.y;// set origin of translation (so rotates around center of selection)\nconst imageOrigin=vectorInvert(vectorClone(imageTranslation));// correct for stage offset\nimageOrigin.x+=imageOffset.x;imageOrigin.y+=imageOffset.y;// correct for image selection offset relative to view\nconst imageSelectionCenter=rectCenter(rectTranslate(rectClone(imageSelectionRect),stageRect));const imageSelectionOffset=vectorSubtract(imageSelectionCenter,stageCenter);vectorAdd(imageTranslation,imageSelectionOffset);return{// offset: imageOffset,\norigin:imageOrigin,translation:imageTranslation,rotation:{x:imageFlipY?Math.PI:0,y:imageFlipX?Math.PI:0,z:imageRotation},perspective:imagePerspective,scale:imageScale};};// @ts-ignore\nvar historyCreate=(getState,setState)=>{// set up pub/sub for history object\nconst{sub,pub}=pubsub();// current history state\nlet baseState;const entries=[];const index=writable(-1);const subs=[];const updateSubs=()=>subs.forEach(cb=>cb({index:get_store_value(index),length:entries.length}));const history={get index(){return get_store_value(index);},set index(i){// validate new index\ni=Number.isInteger(i)?i:-1;i=clamp(i,-1,entries.length-1);// remember\nindex.set(i);setState(entries[history.index]||baseState);// update subs\nupdateSubs();},get state(){return entries[entries.length-1]||baseState;},length(){return entries.length;},undo(){const newIndex=history.index--;pub('undo',newIndex);return newIndex;},redo(){const newIndex=history.index++;pub('redo',history.index);return newIndex;},revert(){entries.length=0;history.index=-1;pub('revert');},write(){// reset length to current index\nentries.length=history.index+1;// add new entry\nentries.push(getState());// move pointer to last added index\nindex.set(entries.length-1);updateSubs();},set(state={}){baseState=state;},subscribe(cb){subs.push(cb);cb({index:history.index,length:entries.length});return()=>subs.splice(subs.indexOf(cb),1);},on:sub};return history;};var isChrome=()=>isBrowser()&&!!window['chrome'];var imageBitmapToImageData=async imageBitmap=>canvasToImageData(await imageDataToCanvas(imageBitmap));var blobToImageBitmap=(file,ImageOrienter,canvasMemoryLimit)=>new Promise(async(resolve,reject)=>{// get orientation of image, should return 1 for normal orientation\nconst orientation=await ImageOrienter.read(file);// helper method to apply orientation fix if needed\nconst toImageData=file=>blobToImageData(file,canvasMemoryLimit).then(imageData=>ImageOrienter.apply(imageData,orientation)).then(resolve).catch(reject);// cannot create image bitmaps in worker\nif(!canCreateImageBitmap()||isSVGFile(file))return toImageData(file);// create image bitmap in thread\nlet imageBitmap;try{imageBitmap=await thread((file,done)=>createImageBitmap(file).then(bitmap=>done(null,bitmap)).catch(done),[file]);}catch(err){// fails silently on purpose, we'll try to turn the blob into image data in the main thread\n// console.error(err);\n}// no bitmap returned, something went wrong in `createImageBitmap` logic\nif(!imageBitmap||!imageBitmap.width)return toImageData(file);// if the browser can't orient images, we need to correct the orientation now\nif(!(await canOrientImages()))return resolve(ImageOrienter.apply(imageBitmap,orientation));// need to convert so oriented image can be used as WebGL texture\n// converting ImageBitmap to <canvas> (and then optionally to image data) fixes a Chrome render bug where the\n// ImageBitmap when used in WebGL doesn't render in the correct orientation\n// https://bugs.chromium.org/p/chromium/issues/detail?id=1082451&q=orientation%20imagebitmap&can=2\nif(isChrome()&&orientation>1)return resolve(await imageBitmapToImageData(imageBitmap));// yay we got our bitmap\nresolve(imageBitmap);});var imageDataContain=(imageData,size)=>new Promise(async resolve=>{if(imageData.width<size.width&&imageData.height<size.height)return resolve(imageData);const scalar=Math.min(size.width/imageData.width,size.height/imageData.height);// scale\nconst targetWidth=scalar*imageData.width;const targetHeight=scalar*imageData.height;const canvas=h('canvas',{width:targetWidth,height:targetHeight});const ctx=canvas.getContext('2d');const data=isImageData(imageData)?await imageDataToCanvas(imageData):imageData;ctx.drawImage(data,0,0,targetWidth,targetHeight);resolve(canvasToImageData(canvas));});let limit=null;var getWebGLTextureSizeLimit=()=>{if(limit!==null)return limit;const canvas=h('canvas');const gl=getWebGLContext(canvas);limit=gl?gl.getParameter(gl.MAX_TEXTURE_SIZE):undefined;releaseCanvas(canvas);return limit;};var getDevicePixelRatio=()=>isBrowser()&&window.devicePixelRatio||1;var hexToRGB=str=>{const[,q,w,e]=str.split('');str=str.length===4?`#${q}${q}${w}${w}${e}${e}`:str;const[,r,g,b]=/^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(str);return[r,g,b].map(v=>parseInt(v,16)/255);};var colorStringToColorArray=color=>{// if rgba(128, 128, 128, .5)\nif(/^rgba/.test(color)){return color.substr(5).split(',').map(parseFloat).map((v,i)=>v/(i===3?1:255));}// if rgb(128, 128, 128)\nif(/^rgb/.test(color)){return color.substr(4).split(',').map(parseFloat).map(v=>v/255);}// if #777\nif(/^#/.test(color)){return hexToRGB(color);}};var isDarkColor=color=>{return color[0]<0.25&&color[1]<0.25&&color[2]<0.25;};let result$9=null;var supportsWebGL=()=>{if(result$9===null){const canvas=h('canvas');result$9=!!getWebGLContext(canvas);releaseCanvas(canvas);}return result$9;};/* src/core/ui/index.svelte generated by Svelte v3.29.4 */function create_if_block$2(ctx){let t;let if_block1_anchor;let current;let if_block0=/*isStatusVisible*/ctx[47]&&create_if_block_5(ctx);let if_block1=/*$imagePreview*/ctx[38]&&!/*isSupportsError*/ctx[32]&&create_if_block_1$1(ctx);return{c(){if(if_block0)if_block0.c();t=space();if(if_block1)if_block1.c();if_block1_anchor=empty();},m(target,anchor){if(if_block0)if_block0.m(target,anchor);insert(target,t,anchor);if(if_block1)if_block1.m(target,anchor);insert(target,if_block1_anchor,anchor);current=true;},p(ctx,dirty){if(/*isStatusVisible*/ctx[47]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[1]&/*isStatusVisible*/65536){transition_in(if_block0,1);}}else{if_block0=create_if_block_5(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t.parentNode,t);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(/*$imagePreview*/ctx[38]&&!/*isSupportsError*/ctx[32]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[1]&/*$imagePreview, isSupportsError*/130){transition_in(if_block1,1);}}else{if_block1=create_if_block_1$1(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(if_block1_anchor.parentNode,if_block1_anchor);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,()=>{if_block1=null;});check_outros();}},i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);current=true;},o(local){transition_out(if_block0);transition_out(if_block1);current=false;},d(detaching){if(if_block0)if_block0.d(detaching);if(detaching)detach(t);if(if_block1)if_block1.d(detaching);if(detaching)detach(if_block1_anchor);}};}// (1410:2) {#if isStatusVisible}\nfunction create_if_block_5(ctx){let div;let p;let current_block_type_index;let if_block;let p_style_value;let div_style_value;let current;const if_block_creators=[create_if_block_6,create_if_block_7,create_if_block_9];const if_blocks=[];function select_block_type(ctx,dirty){if(/*isSupportsError*/ctx[32])return 0;if(/*isWaitingForImage*/ctx[34]||/*isImageLoadError*/ctx[33]||/*isLoadingImageData*/ctx[36]||/*isCreatingImagePreview*/ctx[37])return 1;if(/*isProcessingImage*/ctx[39]&&/*imageProcessStatusLabel*/ctx[42])return 2;return-1;}if(~(current_block_type_index=select_block_type(ctx))){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);}return{c(){div=element(\"div\");p=element(\"p\");if(if_block)if_block.c();attr(p,\"style\",p_style_value=`transform: translateX(${/*$statusOffsetX*/ctx[48]}px)`);attr(div,\"class\",\"DokaStatus\");attr(div,\"style\",div_style_value=`opacity: ${/*$statusOpacity*/ctx[46]}`);},m(target,anchor){insert(target,div,anchor);append(div,p);if(~current_block_type_index){if_blocks[current_block_type_index].m(p,null);}current=true;},p(ctx,dirty){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if(~current_block_type_index){if_blocks[current_block_type_index].p(ctx,dirty);}}else{if(if_block){group_outros();transition_out(if_blocks[previous_block_index],1,1,()=>{if_blocks[previous_block_index]=null;});check_outros();}if(~current_block_type_index){if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}transition_in(if_block,1);if_block.m(p,null);}else{if_block=null;}}if(!current||dirty[1]&/*$statusOffsetX*/131072&&p_style_value!==(p_style_value=`transform: translateX(${/*$statusOffsetX*/ctx[48]}px)`)){attr(p,\"style\",p_style_value);}if(!current||dirty[1]&/*$statusOpacity*/32768&&div_style_value!==(div_style_value=`opacity: ${/*$statusOpacity*/ctx[46]}`)){attr(div,\"style\",div_style_value);}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(div);if(~current_block_type_index){if_blocks[current_block_type_index].d();}}};}// (1433:58) \nfunction create_if_block_9(ctx){let statusmessage;let t0;let statusprogress;let t1;let if_block_anchor;let current;statusmessage=new StatusMessage({props:{text:/*imageProcessStatusLabel*/ctx[42],onmeasure:/*offsetProgress*/ctx[106]}});statusprogress=new StatusProgress({props:{offset:/*$progressOffsetX*/ctx[49],visible:/*imageProcessShowProgressIndicator*/ctx[44],progress:/*imageProcessProgress*/ctx[43]}});let if_block=/*isImageProcessingError*/ctx[45]&&create_if_block_10(ctx);return{c(){create_component(statusmessage.$$.fragment);t0=space();create_component(statusprogress.$$.fragment);t1=space();if(if_block)if_block.c();if_block_anchor=empty();},m(target,anchor){mount_component(statusmessage,target,anchor);insert(target,t0,anchor);mount_component(statusprogress,target,anchor);insert(target,t1,anchor);if(if_block)if_block.m(target,anchor);insert(target,if_block_anchor,anchor);current=true;},p(ctx,dirty){const statusmessage_changes={};if(dirty[1]&/*imageProcessStatusLabel*/2048)statusmessage_changes.text=/*imageProcessStatusLabel*/ctx[42];statusmessage.$set(statusmessage_changes);const statusprogress_changes={};if(dirty[1]&/*$progressOffsetX*/262144)statusprogress_changes.offset=/*$progressOffsetX*/ctx[49];if(dirty[1]&/*imageProcessShowProgressIndicator*/8192)statusprogress_changes.visible=/*imageProcessShowProgressIndicator*/ctx[44];if(dirty[1]&/*imageProcessProgress*/4096)statusprogress_changes.progress=/*imageProcessProgress*/ctx[43];statusprogress.$set(statusprogress_changes);if(/*isImageProcessingError*/ctx[45]){if(if_block){if_block.p(ctx,dirty);if(dirty[1]&/*isImageProcessingError*/16384){transition_in(if_block,1);}}else{if_block=create_if_block_10(ctx);if_block.c();transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}},i(local){if(current)return;transition_in(statusmessage.$$.fragment,local);transition_in(statusprogress.$$.fragment,local);transition_in(if_block);current=true;},o(local){transition_out(statusmessage.$$.fragment,local);transition_out(statusprogress.$$.fragment,local);transition_out(if_block);current=false;},d(detaching){destroy_component(statusmessage,detaching);if(detaching)detach(t0);destroy_component(statusprogress,detaching);if(detaching)detach(t1);if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}// (1422:99) \nfunction create_if_block_7(ctx){let statusmessage;let t0;let statusprogress;let t1;let if_block_anchor;let current;statusmessage=new StatusMessage({props:{text:/*imageLoadStatusLabel*/ctx[41],onmeasure:/*offsetProgress*/ctx[106]}});statusprogress=new StatusProgress({props:{offset:/*$progressOffsetX*/ctx[49],visible:/*imageLoadShowProgressIndicator*/ctx[40],progress:/*imageLoadProgress*/ctx[35]}});let if_block=/*isImageLoadError*/ctx[33]&&create_if_block_8(ctx);return{c(){create_component(statusmessage.$$.fragment);t0=space();create_component(statusprogress.$$.fragment);t1=space();if(if_block)if_block.c();if_block_anchor=empty();},m(target,anchor){mount_component(statusmessage,target,anchor);insert(target,t0,anchor);mount_component(statusprogress,target,anchor);insert(target,t1,anchor);if(if_block)if_block.m(target,anchor);insert(target,if_block_anchor,anchor);current=true;},p(ctx,dirty){const statusmessage_changes={};if(dirty[1]&/*imageLoadStatusLabel*/1024)statusmessage_changes.text=/*imageLoadStatusLabel*/ctx[41];statusmessage.$set(statusmessage_changes);const statusprogress_changes={};if(dirty[1]&/*$progressOffsetX*/262144)statusprogress_changes.offset=/*$progressOffsetX*/ctx[49];if(dirty[1]&/*imageLoadShowProgressIndicator*/512)statusprogress_changes.visible=/*imageLoadShowProgressIndicator*/ctx[40];if(dirty[1]&/*imageLoadProgress*/16)statusprogress_changes.progress=/*imageLoadProgress*/ctx[35];statusprogress.$set(statusprogress_changes);if(/*isImageLoadError*/ctx[33]){if(if_block){if_block.p(ctx,dirty);if(dirty[1]&/*isImageLoadError*/4){transition_in(if_block,1);}}else{if_block=create_if_block_8(ctx);if_block.c();transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}},i(local){if(current)return;transition_in(statusmessage.$$.fragment,local);transition_in(statusprogress.$$.fragment,local);transition_in(if_block);current=true;},o(local){transition_out(statusmessage.$$.fragment,local);transition_out(statusprogress.$$.fragment,local);transition_out(if_block);current=false;},d(detaching){destroy_component(statusmessage,detaching);if(detaching)detach(t0);destroy_component(statusprogress,detaching);if(detaching)detach(t1);if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}// (1414:3) {#if isSupportsError}\nfunction create_if_block_6(ctx){let statusmessage;let t;let span;let icon;let span_style_value;let current;statusmessage=new StatusMessage({props:{text:/*isSupportsError*/ctx[32],onmeasure:/*offsetProgress*/ctx[106]}});icon=new Icon({props:{$$slots:{default:[create_default_slot_4]},$$scope:{ctx}}});return{c(){create_component(statusmessage.$$.fragment);t=space();span=element(\"span\");create_component(icon.$$.fragment);attr(span,\"class\",\"DokaStatusIcon\");attr(span,\"style\",span_style_value=`transform: translateX(${/*$progressOffsetX*/ctx[49]}px)`);},m(target,anchor){mount_component(statusmessage,target,anchor);insert(target,t,anchor);insert(target,span,anchor);mount_component(icon,span,null);current=true;},p(ctx,dirty){const statusmessage_changes={};if(dirty[1]&/*isSupportsError*/2)statusmessage_changes.text=/*isSupportsError*/ctx[32];statusmessage.$set(statusmessage_changes);const icon_changes={};if(dirty[0]&/*locale*/4|dirty[8]&/*$$scope*/4096){icon_changes.$$scope={dirty,ctx};}icon.$set(icon_changes);if(!current||dirty[1]&/*$progressOffsetX*/262144&&span_style_value!==(span_style_value=`transform: translateX(${/*$progressOffsetX*/ctx[49]}px)`)){attr(span,\"style\",span_style_value);}},i(local){if(current)return;transition_in(statusmessage.$$.fragment,local);transition_in(icon.$$.fragment,local);current=true;},o(local){transition_out(statusmessage.$$.fragment,local);transition_out(icon.$$.fragment,local);current=false;},d(detaching){destroy_component(statusmessage,detaching);if(detaching)detach(t);if(detaching)detach(span);destroy_component(icon);}};}// (1438:4) {#if isImageProcessingError}\nfunction create_if_block_10(ctx){let span;let button;let span_style_value;let current;button=new Button({props:{onclick:/*handleCloseImageProcessError*/ctx[108],label:/*locale*/ctx[2].statusLabelButtonClose,icon:/*locale*/ctx[2].statusIconButtonClose,hideLabel:true}});return{c(){span=element(\"span\");create_component(button.$$.fragment);attr(span,\"class\",\"DokaStatusButton\");attr(span,\"style\",span_style_value=`transform: translateX(${/*$progressOffsetX*/ctx[49]}px)`);},m(target,anchor){insert(target,span,anchor);mount_component(button,span,null);current=true;},p(ctx,dirty){const button_changes={};if(dirty[0]&/*locale*/4)button_changes.label=/*locale*/ctx[2].statusLabelButtonClose;if(dirty[0]&/*locale*/4)button_changes.icon=/*locale*/ctx[2].statusIconButtonClose;button.$set(button_changes);if(!current||dirty[1]&/*$progressOffsetX*/262144&&span_style_value!==(span_style_value=`transform: translateX(${/*$progressOffsetX*/ctx[49]}px)`)){attr(span,\"style\",span_style_value);}},i(local){if(current)return;transition_in(button.$$.fragment,local);current=true;},o(local){transition_out(button.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(span);destroy_component(button);}};}// (1427:4) {#if isImageLoadError}\nfunction create_if_block_8(ctx){let span;let button;let span_style_value;let current;button=new Button({props:{onclick:/*handleCloseImageLoadError*/ctx[107],label:/*locale*/ctx[2].statusLabelButtonClose,icon:/*locale*/ctx[2].statusIconButtonClose,hideLabel:true}});return{c(){span=element(\"span\");create_component(button.$$.fragment);attr(span,\"class\",\"DokaStatusButton\");attr(span,\"style\",span_style_value=`transform: translateX(${/*$progressOffsetX*/ctx[49]}px)`);},m(target,anchor){insert(target,span,anchor);mount_component(button,span,null);current=true;},p(ctx,dirty){const button_changes={};if(dirty[0]&/*locale*/4)button_changes.label=/*locale*/ctx[2].statusLabelButtonClose;if(dirty[0]&/*locale*/4)button_changes.icon=/*locale*/ctx[2].statusIconButtonClose;button.$set(button_changes);if(!current||dirty[1]&/*$progressOffsetX*/262144&&span_style_value!==(span_style_value=`transform: translateX(${/*$progressOffsetX*/ctx[49]}px)`)){attr(span,\"style\",span_style_value);}},i(local){if(current)return;transition_in(button.$$.fragment,local);current=true;},o(local){transition_out(button.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(span);destroy_component(button);}};}// (1419:5) <Icon>\nfunction create_default_slot_4(ctx){let g;let raw_value=/*locale*/ctx[2].iconSupportError+\"\";return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=raw_value;},p(ctx,dirty){if(dirty[0]&/*locale*/4&&raw_value!==(raw_value=/*locale*/ctx[2].iconSupportError+\"\"))g.innerHTML=raw_value;},d(detaching){if(detaching)detach(g);}};}// (1449:2) {#if $imagePreview && !isSupportsError}\nfunction create_if_block_1$1(ctx){let t0;let t1;let current_block_type_index;let if_block2;let t2;let canvas;let t3;let div;let current;let if_block0=/*enableToolbar*/ctx[6]&&create_if_block_4(ctx);let if_block1=/*shouldRenderTabs*/ctx[16]&&/*showUtils*/ctx[14]&&create_if_block_3(ctx);const if_block_creators=[create_if_block_2,create_else_block$1];const if_blocks=[];function select_block_type_1(ctx,dirty){if(/*shouldRenderTabs*/ctx[16])return 0;return 1;}current_block_type_index=select_block_type_1(ctx);if_block2=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);canvas=new Canvas({props:{animate:/*shouldAnimate*/ctx[18],pixelRatio:/*$pixelRatio*/ctx[56],backgroundColor:/*$rootBackgroundColor*/ctx[28],maskRect:/*$imageSelectionRectPresentation*/ctx[31],imageSize:/*$imageSize*/ctx[17],imageData:/*$imagePreview*/ctx[38],imageProps:/*imageProps*/ctx[30],imagePreviews:/*$imagePreviews*/ctx[57],loadImageData:/*imageSourceToImageData*/ctx[8],willRender:/*func_2*/ctx[152]}});return{c(){if(if_block0)if_block0.c();t0=space();if(if_block1)if_block1.c();t1=space();if_block2.c();t2=space();create_component(canvas.$$.fragment);t3=space();div=element(\"div\");attr(div,\"class\",\"DokaRootPortal\");},m(target,anchor){if(if_block0)if_block0.m(target,anchor);insert(target,t0,anchor);if(if_block1)if_block1.m(target,anchor);insert(target,t1,anchor);if_blocks[current_block_type_index].m(target,anchor);insert(target,t2,anchor);mount_component(canvas,target,anchor);insert(target,t3,anchor);insert(target,div,anchor);/*div_binding*/ctx[153](div);current=true;},p(ctx,dirty){if(/*enableToolbar*/ctx[6]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*enableToolbar*/64){transition_in(if_block0,1);}}else{if_block0=create_if_block_4(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t0.parentNode,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(/*shouldRenderTabs*/ctx[16]&&/*showUtils*/ctx[14]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*shouldRenderTabs, showUtils*/81920){transition_in(if_block1,1);}}else{if_block1=create_if_block_3(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(t1.parentNode,t1);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,()=>{if_block1=null;});check_outros();}let previous_block_index=current_block_type_index;current_block_type_index=select_block_type_1(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,()=>{if_blocks[previous_block_index]=null;});check_outros();if_block2=if_blocks[current_block_type_index];if(!if_block2){if_block2=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block2.c();}transition_in(if_block2,1);if_block2.m(t2.parentNode,t2);}const canvas_changes={};if(dirty[0]&/*shouldAnimate*/262144)canvas_changes.animate=/*shouldAnimate*/ctx[18];if(dirty[1]&/*$pixelRatio*/33554432)canvas_changes.pixelRatio=/*$pixelRatio*/ctx[56];if(dirty[0]&/*$rootBackgroundColor*/268435456)canvas_changes.backgroundColor=/*$rootBackgroundColor*/ctx[28];if(dirty[1]&/*$imageSelectionRectPresentation*/1)canvas_changes.maskRect=/*$imageSelectionRectPresentation*/ctx[31];if(dirty[0]&/*$imageSize*/131072)canvas_changes.imageSize=/*$imageSize*/ctx[17];if(dirty[1]&/*$imagePreview*/128)canvas_changes.imageData=/*$imagePreview*/ctx[38];if(dirty[0]&/*imageProps*/1073741824)canvas_changes.imageProps=/*imageProps*/ctx[30];if(dirty[1]&/*$imagePreviews*/67108864)canvas_changes.imagePreviews=/*$imagePreviews*/ctx[57];if(dirty[0]&/*imageSourceToImageData*/256)canvas_changes.loadImageData=/*imageSourceToImageData*/ctx[8];if(dirty[0]&/*willRenderCanvas*/32|dirty[1]&/*$imageDecoration, $imageAnnotation, $imageOverlay*/939524096)canvas_changes.willRender=/*func_2*/ctx[152];canvas.$set(canvas_changes);},i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);transition_in(if_block2);transition_in(canvas.$$.fragment,local);current=true;},o(local){transition_out(if_block0);transition_out(if_block1);transition_out(if_block2);transition_out(canvas.$$.fragment,local);current=false;},d(detaching){if(if_block0)if_block0.d(detaching);if(detaching)detach(t0);if(if_block1)if_block1.d(detaching);if(detaching)detach(t1);if_blocks[current_block_type_index].d(detaching);if(detaching)detach(t2);destroy_component(canvas,detaching);if(detaching)detach(t3);if(detaching)detach(div);/*div_binding*/ctx[153](null);}};}// (1451:3) {#if enableToolbar}\nfunction create_if_block_4(ctx){let div;let dynamiccomponenttree;let measurable_action;let current;let mounted;let dispose;dynamiccomponenttree=new DynamicComponentTree_1({props:{items:/*toolbarItems*/ctx[51]}});return{c(){div=element(\"div\");create_component(dynamiccomponenttree.$$.fragment);attr(div,\"class\",\"DokaNav DokaNavTools\");},m(target,anchor){insert(target,div,anchor);mount_component(dynamiccomponenttree,div,null);current=true;if(!mounted){dispose=[listen(div,\"measure\",/*measure_handler*/ctx[137]),action_destroyer(measurable_action=measurable.call(null,div))];mounted=true;}},p(ctx,dirty){const dynamiccomponenttree_changes={};if(dirty[1]&/*toolbarItems*/1048576)dynamiccomponenttree_changes.items=/*toolbarItems*/ctx[51];dynamiccomponenttree.$set(dynamiccomponenttree_changes);},i(local){if(current)return;transition_in(dynamiccomponenttree.$$.fragment,local);current=true;},o(local){transition_out(dynamiccomponenttree.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(dynamiccomponenttree);mounted=false;run_all(dispose);}};}// (1457:3) {#if shouldRenderTabs && showUtils }\nfunction create_if_block_3(ctx){let div;let scrollable;let current;scrollable=new Scrollable({props:{elasticity:/*elasticityMultiplier*/ctx[4]*scrollElasticity,scrollDirection:/*isLandscape*/ctx[27]?\"y\":\"x\",$$slots:{default:[create_default_slot_1]},$$scope:{ctx}}});return{c(){div=element(\"div\");create_component(scrollable.$$.fragment);attr(div,\"class\",\"DokaNav DokaNavMain\");},m(target,anchor){insert(target,div,anchor);mount_component(scrollable,div,null);current=true;},p(ctx,dirty){const scrollable_changes={};if(dirty[0]&/*elasticityMultiplier*/16)scrollable_changes.elasticity=/*elasticityMultiplier*/ctx[4]*scrollElasticity;if(dirty[0]&/*isLandscape*/134217728)scrollable_changes.scrollDirection=/*isLandscape*/ctx[27]?\"y\":\"x\";if(dirty[0]&/*tabsConfig, tabs, utilSelected*/27262976|dirty[8]&/*$$scope*/4096){scrollable_changes.$$scope={dirty,ctx};}scrollable.$set(scrollable_changes);},i(local){if(current)return;transition_in(scrollable.$$.fragment,local);current=true;},o(local){transition_out(scrollable.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(scrollable);}};}// (1461:6) <Icon>\nfunction create_default_slot_3(ctx){let g;let raw_value=/*tab*/ctx[259].icon+\"\";return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=raw_value;},p(ctx,dirty){if(dirty[8]&/*tab*/2048&&raw_value!==(raw_value=/*tab*/ctx[259].icon+\"\"))g.innerHTML=raw_value;},d(detaching){if(detaching)detach(g);}};}// (1460:5) <TabList {...tabsConfig} {tabs} on:select={({ detail }) => utilSelected = detail} let:tab={tab}>\nfunction create_default_slot_2(ctx){let icon;let t0;let span;let t1_value=/*tab*/ctx[259].label+\"\";let t1;let current;icon=new Icon({props:{$$slots:{default:[create_default_slot_3]},$$scope:{ctx}}});return{c(){create_component(icon.$$.fragment);t0=space();span=element(\"span\");t1=text(t1_value);},m(target,anchor){mount_component(icon,target,anchor);insert(target,t0,anchor);insert(target,span,anchor);append(span,t1);current=true;},p(ctx,dirty){const icon_changes={};if(dirty[8]&/*$$scope, tab*/6144){icon_changes.$$scope={dirty,ctx};}icon.$set(icon_changes);if((!current||dirty[8]&/*tab*/2048)&&t1_value!==(t1_value=/*tab*/ctx[259].label+\"\"))set_data(t1,t1_value);},i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o(local){transition_out(icon.$$.fragment,local);current=false;},d(detaching){destroy_component(icon,detaching);if(detaching)detach(t0);if(detaching)detach(span);}};}// (1459:4) <Scrollable elasticity={elasticityMultiplier * scrollElasticity} scrollDirection={isLandscape ? 'y' : 'x'}>\nfunction create_default_slot_1(ctx){let tablist;let current;const tablist_spread_levels=[/*tabsConfig*/ctx[23],{tabs:/*tabs*/ctx[24]}];let tablist_props={$$slots:{default:[create_default_slot_2,({tab})=>({259:tab}),({tab})=>[0,0,0,0,0,0,0,0,tab?2048:0]]},$$scope:{ctx}};for(let i=0;i<tablist_spread_levels.length;i+=1){tablist_props=assign(tablist_props,tablist_spread_levels[i]);}tablist=new TabList({props:tablist_props});tablist.$on(\"select\",/*select_handler*/ctx[138]);return{c(){create_component(tablist.$$.fragment);},m(target,anchor){mount_component(tablist,target,anchor);current=true;},p(ctx,dirty){const tablist_changes=dirty[0]&/*tabsConfig, tabs*/25165824?get_spread_update(tablist_spread_levels,[dirty[0]&/*tabsConfig*/8388608&&get_spread_object(/*tabsConfig*/ctx[23]),dirty[0]&/*tabs*/16777216&&{tabs:/*tabs*/ctx[24]}]):{};if(dirty[8]&/*$$scope, tab*/6144){tablist_changes.$$scope={dirty,ctx};}tablist.$set(tablist_changes);},i(local){if(current)return;transition_in(tablist.$$.fragment,local);current=true;},o(local){transition_out(tablist.$$.fragment,local);current=false;},d(detaching){destroy_component(tablist,detaching);}};}// (1481:3) {:else}\nfunction create_else_block$1(ctx){let panel;let updating_component;let current;function panel_component_binding_1(value){/*panel_component_binding_1*/ctx[147].call(null,value);}let panel_props={class:\"DokaMain\",content:_objectSpread(_objectSpread({},/*utilsMerged*/ctx[20].find(/*func_1*/ctx[146])),{},{props:/*pluginOptions*/ctx[7][/*utilSelected*/ctx[21]]}),locale:/*locale*/ctx[2],stores:/*utilStores*/ctx[101]};if(/*pluginInterface*/ctx[0][/*utilSelected*/ctx[21]]!==void 0){panel_props.component=/*pluginInterface*/ctx[0][/*utilSelected*/ctx[21]];}panel=new Panel({props:panel_props});binding_callbacks.push(()=>bind(panel,\"component\",panel_component_binding_1));panel.$on(\"measure\",/*measure_handler_3*/ctx[148]);panel.$on(\"show\",/*show_handler_1*/ctx[149]);panel.$on(\"hide\",/*hide_handler_1*/ctx[150]);panel.$on(\"fade\",/*fade_handler_1*/ctx[151]);return{c(){create_component(panel.$$.fragment);},m(target,anchor){mount_component(panel,target,anchor);current=true;},p(ctx,dirty){const panel_changes={};if(dirty[0]&/*utilsMerged, utilSelected, pluginOptions*/3145856)panel_changes.content=_objectSpread(_objectSpread({},/*utilsMerged*/ctx[20].find(/*func_1*/ctx[146])),{},{props:/*pluginOptions*/ctx[7][/*utilSelected*/ctx[21]]});if(dirty[0]&/*locale*/4)panel_changes.locale=/*locale*/ctx[2];if(!updating_component&&dirty[0]&/*pluginInterface, utilSelected*/2097153){updating_component=true;panel_changes.component=/*pluginInterface*/ctx[0][/*utilSelected*/ctx[21]];add_flush_callback(()=>updating_component=false);}panel.$set(panel_changes);},i(local){if(current)return;transition_in(panel.$$.fragment,local);current=true;},o(local){transition_out(panel.$$.fragment,local);current=false;},d(detaching){destroy_component(panel,detaching);}};}// (1468:3) {#if shouldRenderTabs}\nfunction create_if_block_2(ctx){let tabpanels;let current;const tabpanels_spread_levels=[{class:\"DokaMain\"},{visible:/*utilsVisible*/ctx[12]},/*tabsConfig*/ctx[23],{panels:/*panels*/ctx[25]}];let tabpanels_props={$$slots:{default:[create_default_slot$1,({panel})=>({258:panel}),({panel})=>[0,0,0,0,0,0,0,0,panel?1024:0]]},$$scope:{ctx}};for(let i=0;i<tabpanels_spread_levels.length;i+=1){tabpanels_props=assign(tabpanels_props,tabpanels_spread_levels[i]);}tabpanels=new TabPanels({props:tabpanels_props});tabpanels.$on(\"measure\",/*measure_handler_2*/ctx[145]);return{c(){create_component(tabpanels.$$.fragment);},m(target,anchor){mount_component(tabpanels,target,anchor);current=true;},p(ctx,dirty){const tabpanels_changes=dirty[0]&/*utilsVisible, tabsConfig, panels*/41947136?get_spread_update(tabpanels_spread_levels,[tabpanels_spread_levels[0],dirty[0]&/*utilsVisible*/4096&&{visible:/*utilsVisible*/ctx[12]},dirty[0]&/*tabsConfig*/8388608&&get_spread_object(/*tabsConfig*/ctx[23]),dirty[0]&/*panels*/33554432&&{panels:/*panels*/ctx[25]}]):{};if(dirty[0]&/*utilsMerged, pluginOptions, locale, utilSelected, pluginInterface, utilsVisible, utilsVisibleFraction*/7344261|dirty[1]&/*$utilRect*/16777216|dirty[8]&/*$$scope, panel*/5120){tabpanels_changes.$$scope={dirty,ctx};}tabpanels.$set(tabpanels_changes);},i(local){if(current)return;transition_in(tabpanels.$$.fragment,local);current=true;},o(local){transition_out(tabpanels.$$.fragment,local);current=false;},d(detaching){destroy_component(tabpanels,detaching);}};}// (1469:3) <TabPanels class=\"DokaMain\" visible={utilsVisible} {...tabsConfig} {panels} let:panel on:measure={e => $tabRect = e.detail}>\nfunction create_default_slot$1(ctx){let panel;let updating_component;let current;function func(...args){return(/*func*/ctx[139](/*panel*/ctx[258],...args));}function panel_component_binding(value){/*panel_component_binding*/ctx[140].call(null,value,/*panel*/ctx[258]);}function show_handler(...args){return(/*show_handler*/ctx[142](/*panel*/ctx[258],...args));}function hide_handler(...args){return(/*hide_handler*/ctx[143](/*panel*/ctx[258],...args));}function fade_handler(...args){return(/*fade_handler*/ctx[144](/*panel*/ctx[258],...args));}let panel_props={content:_objectSpread(_objectSpread({},/*utilsMerged*/ctx[20].find(func)),{},{props:/*pluginOptions*/ctx[7][/*panel*/ctx[258]]}),locale:/*locale*/ctx[2],isActive:/*panel*/ctx[258]===/*utilSelected*/ctx[21],stores:/*utilStores*/ctx[101]};if(/*pluginInterface*/ctx[0][/*panel*/ctx[258]]!==void 0){panel_props.component=/*pluginInterface*/ctx[0][/*panel*/ctx[258]];}panel=new Panel({props:panel_props});binding_callbacks.push(()=>bind(panel,\"component\",panel_component_binding));panel.$on(\"measure\",/*measure_handler_1*/ctx[141]);panel.$on(\"show\",show_handler);panel.$on(\"hide\",hide_handler);panel.$on(\"fade\",fade_handler);return{c(){create_component(panel.$$.fragment);},m(target,anchor){mount_component(panel,target,anchor);current=true;},p(new_ctx,dirty){ctx=new_ctx;const panel_changes={};if(dirty[0]&/*utilsMerged, pluginOptions*/1048704|dirty[8]&/*panel*/1024)panel_changes.content=_objectSpread(_objectSpread({},/*utilsMerged*/ctx[20].find(func)),{},{props:/*pluginOptions*/ctx[7][/*panel*/ctx[258]]});if(dirty[0]&/*locale*/4)panel_changes.locale=/*locale*/ctx[2];if(dirty[0]&/*utilSelected*/2097152|dirty[8]&/*panel*/1024)panel_changes.isActive=/*panel*/ctx[258]===/*utilSelected*/ctx[21];if(!updating_component&&dirty[0]&/*pluginInterface*/1|dirty[8]&/*panel*/1024){updating_component=true;panel_changes.component=/*pluginInterface*/ctx[0][/*panel*/ctx[258]];add_flush_callback(()=>updating_component=false);}panel.$set(panel_changes);},i(local){if(current)return;transition_in(panel.$$.fragment,local);current=true;},o(local){transition_out(panel.$$.fragment,local);current=false;},d(detaching){destroy_component(panel,detaching);}};}function create_fragment$b(ctx){let div;let measurable_action;let focusvisible_action;let dropable_action;let current;let mounted;let dispose;add_render_callback(/*onwindowresize*/ctx[136]);let if_block=/*canRender*/ctx[52]&&create_if_block$2(ctx);return{c(){div=element(\"div\");if(if_block)if_block.c();attr(div,\"id\",/*id*/ctx[3]);attr(div,\"class\",/*className*/ctx[26]);attr(div,\"data-env\",/*envStr*/ctx[29]);},m(target,anchor){insert(target,div,anchor);if(if_block)if_block.m(div,null);/*div_binding_1*/ctx[154](div);current=true;if(!mounted){dispose=[listen(window,\"keydown\",/*handleKeydown*/ctx[110]),listen(window,\"keyup\",/*handleKeyup*/ctx[111]),listen(window,\"blur\",/*handleWindowBlur*/ctx[112]),listen(window,\"resize\",/*onwindowresize*/ctx[136]),listen(div,\"ping\",function(){if(is_function(/*routePing*/ctx[53]))/*routePing*/ctx[53].apply(this,arguments);}),listen(div,\"contextmenu\",/*handleContextMenu*/ctx[113]),listen(div,\"touchstart\",function(){if(is_function(/*handleTouchStart*/ctx[50]))/*handleTouchStart*/ctx[50].apply(this,arguments);}),listen(div,\"transitionend\",/*handleTransitionEnd*/ctx[102]),listen(div,\"dropfiles\",/*handleDropFiles*/ctx[114]),listen(div,\"measure\",/*measure_handler_4*/ctx[155]),action_destroyer(measurable_action=measurable.call(null,div,{observeViewRect:true})),action_destroyer(focusvisible_action=focusvisible.call(null,div)),action_destroyer(dropable_action=dropable.call(null,div))];mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;if(/*canRender*/ctx[52]){if(if_block){if_block.p(ctx,dirty);if(dirty[1]&/*canRender*/2097152){transition_in(if_block,1);}}else{if_block=create_if_block$2(ctx);if_block.c();transition_in(if_block,1);if_block.m(div,null);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}if(!current||dirty[0]&/*id*/8){attr(div,\"id\",/*id*/ctx[3]);}if(!current||dirty[0]&/*className*/67108864){attr(div,\"class\",/*className*/ctx[26]);}if(!current||dirty[0]&/*envStr*/536870912){attr(div,\"data-env\",/*envStr*/ctx[29]);}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(div);if(if_block)if_block.d();/*div_binding_1*/ctx[154](null);mounted=false;run_all(dispose);}};}const imageCropRectElasticity=5;// updating crop selection / the intended selection rect, combined with actual selection rect, used to render elasticity visualisation\nconst imageSelectionRectElasticity=1;const scrollElasticity=10;const rangeInputElasticity=5;function instance$b($$self,$$props,$$invalidate){let $images;let $clientRect;let $rootRect;let $imageState;let $imageLoadState;let $imageCropRectSnapshot;let $imageCropRectIntent;let $previewShouldUpscale;let $imageCropRect;let $isInteracting;let $imageSelectionRect;let $imageSelectionRectIntent;let $stageRect;let $stageScalar;let $imageSize;let $presentationScalar;let $imageSelectionRectSnapshot;let $prefersReducedMotion;let $tabRect;let $history,$$unsubscribe_history=noop$1,$$subscribe_history=()=>($$unsubscribe_history(),$$unsubscribe_history=subscribe(history,$$value=>$$invalidate(181,$history=$$value)),history);let $imageProcessingPreparing;let $rootBackgroundColor;let $env;let $pointerAccuracy;let $pointerHoverable;let $imageTransforms;let $imagePreviewModifiers;let $imageEffects;let $imageBackgroundColor;let $imageSelectionRectPresentation;let $imageVisualLoadComplete;let $imageFile;let $imagePreview;let $imageProcessState;let $statusOpacity;let $statusOffsetX;let $progressOffsetX;let $pressedKeysStore;let $isInteractingFraction;let $toolRect;let $utilRect;let $pixelRatio;let $imagePreviews;let $imageDecoration;let $imageAnnotation;let $imageOverlay;component_subscribe($$self,prefersReducedMotion,$$value=>$$invalidate(179,$prefersReducedMotion=$$value));$$self.$$.on_destroy.push(()=>$$unsubscribe_history());const eventProxy=pubsub();const dispatch=createEventDispatcher();//\n// View Props\n//\nlet{class:klass=undefined}=$$props;let{layout:layoutMode=undefined}=$$props;let{stores}=$$props;let{locale=undefined}=$$props;let{id=undefined}=$$props;let{util=undefined}=$$props;let{utils=undefined}=$$props;// which utils are active (list of ids), or is derived from plugins automatically\nlet{animations=\"auto\"}=$$props;let{previewUpscale=false}=$$props;let{elasticityMultiplier=10}=$$props;let{willRevert=()=>Promise.resolve(true)}=$$props;let{willRenderCanvas=passthrough}=$$props;let{willRenderToolbar=passthrough}=$$props;let{enableButtonExport=true}=$$props;let{enableButtonRevert=true}=$$props;let{enableNavigateHistory=true}=$$props;let{enableToolbar=true}=$$props;let{enableUtils=true}=$$props;let{enableButtonClose=false}=$$props;let{previewImageDataMaxSize=undefined}=$$props;let{enableDropImage=false}=$$props;let{imageOrienter={read:()=>1,apply:v=>v}}=$$props;let{pluginComponents=undefined}=$$props;let{pluginOptions={}}=$$props;const sub=eventProxy.sub;const pluginInterface={};let{root}=$$props;let registeredPluginsComponents=[];// \n// this method is used to read image resources (preview image / shape images)\nconst glMaxTextureSize=getWebGLTextureSizeLimit()||1024;const maxTextureSize=sizeCreate(glMaxTextureSize,glMaxTextureSize);const canvasMemoryLimit=isIOS()?4096*4096:Infinity;let{imageSourceToImageData=src=>isString(src)?fetch(src).then(res=>res.blob()).then(blob=>blobToImageBitmap(blob,imageOrienter,canvasMemoryLimit)).then(imageData=>imageDataContain(imageData,maxImageDataSize)):blobToImageBitmap(src,imageOrienter,canvasMemoryLimit).then(imageData=>imageDataContain(imageData,maxImageDataSize))}=$$props;const imageProxy=createImageProxy();const{file:imageFile,size:imageSize,loadState:imageLoadState,processState:imageProcessState,cropAspectRatio:imageCropAspectRatio,cropLimitToImage:imageCropLimitToImage,crop:imageCropRect,cropMinSize:imageCropMinSize,cropMaxSize:imageCropMaxSize,cropRange:imageCropRange,cropOrigin:imageCropRectOrigin,cropRectAspectRatio:imageCropRectAspectRatio,rotation:imageRotation,rotationRange:imageRotationRange,targetSize:imageOutputSize,flipX:imageFlipX,flipY:imageFlipY,backgroundColor:imageBackgroundColor,colorMatrix:imageColorMatrix,convolutionMatrix:imageConvolutionMatrix,gamma:imageGamma,vignette:imageVignette,noise:imageNoise,decoration:imageDecoration,annotation:imageAnnotation,state:imageState}=imageProxy.stores;component_subscribe($$self,imageFile,value=>$$invalidate(210,$imageFile=value));component_subscribe($$self,imageSize,value=>$$invalidate(17,$imageSize=value));component_subscribe($$self,imageLoadState,value=>$$invalidate(165,$imageLoadState=value));component_subscribe($$self,imageProcessState,value=>$$invalidate(211,$imageProcessState=value));component_subscribe($$self,imageCropRect,value=>$$invalidate(169,$imageCropRect=value));component_subscribe($$self,imageBackgroundColor,value=>$$invalidate(207,$imageBackgroundColor=value));component_subscribe($$self,imageDecoration,value=>$$invalidate(58,$imageDecoration=value));component_subscribe($$self,imageAnnotation,value=>$$invalidate(59,$imageAnnotation=value));component_subscribe($$self,imageState,value=>$$invalidate(164,$imageState=value));const{images,imageReader}=stores;component_subscribe($$self,images,value=>$$invalidate(162,$images=value));//\n// handles the view rect size, makes sure it is offset from the top\n//\n// root element reference used to read styles\nconst rootBackgroundColor=writable([0,0,0]);component_subscribe($$self,rootBackgroundColor,value=>$$invalidate(28,$rootBackgroundColor=value));// client rect is the doka editor rect excluding scroll offset\nconst clientRect=writable();component_subscribe($$self,clientRect,value=>$$invalidate(15,$clientRect=value));// root rect is the doka editor rect including scroll offset\nconst rootRect=writable();component_subscribe($$self,rootRect,value=>$$invalidate(163,$rootRect=value));// when in overlay mode force aspect ratio to aspect ratio of editor root\nconst syncRootAspectRatio=()=>{// set aspect ratio\nimageCropAspectRatio.set(rectAspectRatio($rootRect));// need to set history 0 point to this state\nhistory.set($imageState);};const tabRect=writable(rectCreateEmpty());component_subscribe($$self,tabRect,value=>$$invalidate(19,$tabRect=value));const toolRect=writable(rectCreateEmpty());component_subscribe($$self,toolRect,value=>$$invalidate(54,$toolRect=value));const utilRect=writable();// is undefined because we wait till util is set before defining stage rect\ncomponent_subscribe($$self,utilRect,value=>$$invalidate(55,$utilRect=value));const stageRect=derived([utilRect,tabRect,toolRect],([$utilRect,$tabRect,$toolRect],set)=>{if(!$utilRect)return set(undefined);const utiloffsetX=$tabRect.x;const utilOffsetY=$tabRect.y+(shouldRenderTabs&&showUtils||isOverlayModeEnabled?0:$toolRect.y+$toolRect.height);set(rectCreate(utiloffsetX+$utilRect.x,utilOffsetY+$utilRect.y,$utilRect.width,$utilRect.height));});component_subscribe($$self,stageRect,value=>$$invalidate(173,$stageRect=value));//\n// environment\n//\nconst pointerAccuracy=mediaQueryStore(\"(pointer: fine)\",matches=>matches?\"pointer-fine\":\"pointer-coarse\");component_subscribe($$self,pointerAccuracy,value=>$$invalidate(202,$pointerAccuracy=value));const pointerHoverable=mediaQueryStore(\"(hover: hover)\",matches=>matches?\"pointer-hover\":\"pointer-no-hover\");component_subscribe($$self,pointerHoverable,value=>$$invalidate(203,$pointerHoverable=value));//\n// app API\n//\nconst isInteracting=writable(false);component_subscribe($$self,isInteracting,value=>$$invalidate(170,$isInteracting=value));const isInteractingFraction=readable(undefined,set=>{const animator=spring(0);const updater=value=>{animator.set(value?1:0);};const subs=[isInteracting.subscribe(updater),animator.subscribe(set)];// destroy subs\nreturn()=>subs.forEach(unsub=>unsub());});component_subscribe($$self,isInteractingFraction,value=>$$invalidate(214,$isInteractingFraction=value));const previewShouldUpscale=writable(previewUpscale);component_subscribe($$self,previewShouldUpscale,value=>$$invalidate(168,$previewShouldUpscale=value));//\n// image related\n//\nconst stageScalar=derived([stageRect,imageCropRect],([$stageRect,$imageCropRect],set)=>{const isManipulatingImageCropRect=!!($imageCropRectSnapshot||$imageCropRectIntent);// update stage scalar, the crop output size relative to the stage, if image fits it's 1\nif(!$stageRect||!$imageCropRect||isManipulatingImageCropRect)return;// calculate scale factor needed to fit crop rect to stage\nconst scalar=Math.min($stageRect.width/$imageCropRect.width,$stageRect.height/$imageCropRect.height);// always scaled down to fit stage, if is allowed to upscale, zoom to fit stage\nconst scale=$previewShouldUpscale?scalar:Math.min(1,scalar);set(scale);});component_subscribe($$self,stageScalar,value=>$$invalidate(174,$stageScalar=value));const imageCropRectSnapshot=writable();component_subscribe($$self,imageCropRectSnapshot,value=>$$invalidate(166,$imageCropRectSnapshot=value));const imageCropRectIntent=writable();// should always be set before setting `imageCropRect`\ncomponent_subscribe($$self,imageCropRectIntent,value=>$$invalidate(167,$imageCropRectIntent=value));const imageCropRectPresentation=readable(undefined,set=>{const animator=spring(undefined,{precision:0.0001});const update=()=>{if(!$imageCropRect)return;const instantUpdate=$imageCropRectIntent===undefined||$isInteracting;const elasticRect=elastifyRects($imageCropRect,$imageCropRectIntent,imageCropRectElasticity*elasticityMultiplier);animator.set(elasticRect,{hard:instantUpdate});};const subs=[// need to update presentation rect when crop rect is updated\nimageCropRect.subscribe(update),// update parent store\nanimator.subscribe(set)];return()=>subs.forEach(unsub=>unsub());});const imageSelectionRect=writable();component_subscribe($$self,imageSelectionRect,value=>$$invalidate(171,$imageSelectionRect=value));const imageSelectionRectSnapshot=writable();component_subscribe($$self,imageSelectionRectSnapshot,value=>$$invalidate(176,$imageSelectionRectSnapshot=value));const imageSelectionRectIntent=writable(undefined);// should always be set before setting `imageSelectionRect`\ncomponent_subscribe($$self,imageSelectionRectIntent,value=>$$invalidate(172,$imageSelectionRectIntent=value));//\n// Image selection\n//\nconst imageSelectionRectPresentation=readable(undefined,set=>{const animator=spring(undefined,{precision:0.0001});const updater=()=>{if(!$imageSelectionRect)return;const instantUpdate=$isInteracting;const elasticRect=elastifyRects($imageSelectionRect,$imageSelectionRectIntent,imageSelectionRectElasticity*elasticityMultiplier);// prevent negative size (can happen because of elastics)\nif(elasticRect.width<0){elasticRect.width=0;elasticRect.x=$imageSelectionRect.x;}if(elasticRect.height<0){elasticRect.height=0;elasticRect.y=$imageSelectionRect.y;}// translate elastic rect x,y by stage rect x,y\nrectTranslate(elasticRect,$stageRect);animator.set(elasticRect,{hard:instantUpdate});};const subs=[// need to update selection rect when stage is resized\nstageRect.subscribe(updater),// listen for selection rect changes (as is assigned rect will always trigger, even if assigned same rect, this is needed to also update when intent changes)\nimageSelectionRect.subscribe(updater),// update parent store\nanimator.subscribe(set)];// destroy subs\nreturn()=>subs.forEach(unsub=>unsub());});component_subscribe($$self,imageSelectionRectPresentation,value=>$$invalidate(31,$imageSelectionRectPresentation=value));// when scaling the stage we need to recenter the image selection\nstageRect.subscribe(()=>{if(!$stageRect||!$imageCropRect)return;const imageCropRectFitsStage=$imageCropRect.width<=$stageRect.width&&$imageCropRect.height<=$stageRect.height;const centeredImageSelectionRect=// if we have a crop rect and it fits the stage, center it\nimageCropRectFitsStage?// center the crop rectangle to the stage\nrectCenterRect($stageRect,rectMultiply(rectClone($imageCropRect),$stageScalar||1)):// render a rectangle based on the fixed crop aspect ratio, or the aspect ratio of the current crop rectangle, or as a last resort the input image\nrectContainRect($stageRect,rectAspectRatio($imageCropRect||$imageSize));imageSelectionRect.set(centeredImageSelectionRect);});// if we've taken a snapshot of the selection, also take a snapshot of the crop rect and the presentationScalar\n// - cropRect so we can adjust it based on the adjustments to the imageSelectionRect\n// - presentationScalar so we can use the snapshot for the calculation of the cropRect scale relative to the original imageSelectionRect (if we use the live $presentationScalar small rounding errors of the scalar result in weird glitches)\nlet presentationScalarSnapshot;imageSelectionRectSnapshot.subscribe(rect=>{if(!rect){presentationScalarSnapshot=undefined;set_store_value(imageCropRectSnapshot,$imageCropRectSnapshot=undefined,$imageCropRectSnapshot);return;}presentationScalarSnapshot=$presentationScalar;const cropRectClone=rectClone($imageCropRect);imageCropRectSnapshot.set(cropRectClone);});// if image selection rect is being manipulated, and imageSelectionRectSnapshot has been defined, we also need to update the crop rect\nimageSelectionRect.subscribe(rect=>{// only sync crop rect with image selection rect when no longer manipulating\nif(!rect||!$imageSelectionRectSnapshot)return;const offset=rectSubtract(rectClone(rect),$imageSelectionRectSnapshot);rectDivide(offset,presentationScalarSnapshot);const crop=rectAdd(rectClone($imageCropRectSnapshot),offset);imageCropRect.set(crop);});imageCropRect.subscribe(rect=>{// don't update image selection rect while we're intertacting with the view, this prevents feedback loop from cropRect model updates\nif($isInteracting||$imageSelectionRectSnapshot||$imageCropRectIntent)return;// if no rect, we can't do anything\n// if no selection rect yet, we wait for a selection rect to be loaded\nif(!rect||!$imageSelectionRect)return;// only if crop aspect ratio differs from image selection aspect ratio we update image selection rectangle\nconst imageSelectionRectAspectRatio=rectAspectRatio($imageSelectionRect);const cropRectAspectRatio=rectAspectRatio(rect);if(fixPrecision(imageSelectionRectAspectRatio,6)===fixPrecision(cropRectAspectRatio,6))return;// TEMP DUPLICATE OF STAGESCALAR DERIVED STORE TO FIX ZOOM OUT AFTER WHEEL ISSUE\n// reproduce -> crop view => resize selection rect vertically, tap recenter, zoom out with scroll wheel\nconst scalar=Math.min($stageRect.width/$imageCropRect.width,$stageRect.height/$imageCropRect.height);// const scale = $previewShouldUpscale ? scalar : Math.min(1, scalar);\nconst size=sizeCreate(rect.width*scalar,rect.height*scalar);const tx=($imageSelectionRect.width-size.width)*0.5;const ty=($imageSelectionRect.height-size.height)*0.5;const selectionRect=rectCreate($imageSelectionRect.x+tx,$imageSelectionRect.y+ty,size.width,size.height);imageSelectionRect.set(selectionRect);});const imageScalar=derived([stageScalar,imageCropRect,imageSelectionRect],([$stageScalar,$imageCropRect,$imageSelectionRect],set)=>{// update the image scalar, the image zoom calculated by the image selection and the actual crop coordinates\nif(!$stageScalar||!$imageCropRect||!$imageSelectionRect)return;const selectionScaledWidth=$imageSelectionRect.width/$imageCropRect.width;const selectionScaledHeight=$imageSelectionRect.height/$imageCropRect.height;// need to correct for scale of stage\nconst scalar=Math.max(selectionScaledWidth,selectionScaledHeight)/$stageScalar;set(scalar);});const presentationScalar=derived([stageScalar,imageScalar],([$stageScalar,$imageScalar],set)=>{// can't scale presentation if no image scalar defined\nif(!$imageScalar)return;const scalar=$stageScalar*$imageScalar;set(scalar);});component_subscribe($$self,presentationScalar,value=>$$invalidate(175,$presentationScalar=value));//\n// UI Elements\n//\n// guides and edges rendered on top of image\nconst imageSelectionGuides=derived([rootBackgroundColor,isInteracting,imageSelectionRectPresentation,isInteractingFraction],([$rootBackgroundColor,$isInteracting,$rect,$opacity],set)=>{if(!$rect)return set([]);const{x,y,width,height}=$rect;const showGrid=$opacity>0;const rows=showGrid?3:1;const cols=showGrid?3:1;const w=width/cols;const h=height/rows;const guides=[];const strokeColor=isDarkColor($rootBackgroundColor)?[1,1,1]:[0,0,0];// rows\nfor(let r=0;r<=rows;r++){let isEdge=r===0||r===rows;if(isOverlayModeEnabled&&isEdge)continue;let o=isEdge?1:$opacity*0.25;let yo=y+h*r;guides.push({id:`image-selection-guide-row-${r}`,points:[vectorCreate(x,yo),vectorCreate(x+width,yo)],opacity:o,strokeWidth:1,strokeColor});}// cols\nfor(let c=0;c<=cols;c++){let isEdge=c===0||c===cols;if(isOverlayModeEnabled&&isEdge)continue;let o=isEdge?1:$opacity*0.25;let xo=x+w*c;guides.push({id:`image-selection-guide-col-${c}`,points:[vectorCreate(xo,y),vectorCreate(xo,y+height)],opacity:o,strokeWidth:1,strokeColor});}set(guides);});// custom markup rendered on top of image\nconst imageOverlayMarkup=writable([]);// the resulting overlay markup\nconst imageOverlay=derived([imageSelectionGuides,imageOverlayMarkup],([$imageSelectionGuides,$imageOverlayMarkup],set)=>{set($imageSelectionGuides.concat($imageOverlayMarkup));});component_subscribe($$self,imageOverlay,value=>$$invalidate(60,$imageOverlay=value));//\n// Loading the preview\n//\nconst imageVisualLoadComplete=writable(false);component_subscribe($$self,imageVisualLoadComplete,value=>$$invalidate(209,$imageVisualLoadComplete=value));let imagePreviewLoaderCancelToken;const createImagePreviewLoader=(file,token)=>new Promise((resolve,reject)=>{let cancelled=false;let timer;token.cancel=()=>cancelled=true;const now=Date.now();imageSourceToImageData(file).then(imageData=>{const dist=Date.now()-now;clearTimeout(timer);timer=setTimeout(()=>{if(cancelled)return;resolve(imageData);},Math.max(0,1000-dist));}).catch(reject);});const imagePreview=derived([imageVisualLoadComplete,imageFile],([$imageVisualLoadComplete,$imageFile],set)=>{// cancel existing loader\nif(imagePreviewLoaderCancelToken)imagePreviewLoaderCancelToken.cancel();// no data, reset preview data\nif(!$imageVisualLoadComplete||!$imageFile)return set(undefined);imagePreviewLoaderCancelToken={cancel:noop};createImagePreviewLoader($imageFile,imagePreviewLoaderCancelToken).then(set).catch(err=>set_store_value(imageLoadState,$imageLoadState.error=err,$imageLoadState));});component_subscribe($$self,imagePreview,value=>$$invalidate(38,$imagePreview=value));//\n// Calculates the image transforms and effects necessary for the preview\n//\nconst imagePreviewModifiers=writable({});component_subscribe($$self,imagePreviewModifiers,value=>$$invalidate(205,$imagePreviewModifiers=value));const imagePreviews=writable([]);component_subscribe($$self,imagePreviews,value=>$$invalidate(57,$imagePreviews=value));const imageTransforms=derived([stageRect,rootRect,imageSize,imageCropRectPresentation,imageSelectionRect,presentationScalar,imageRotation,imageFlipX,imageFlipY],([$stageRect,$rootRect,$imageSize,$imageCropRectPresentation,$imageSelectionRect,$presentationScalar,$imageRotation,$imageFlipX,$imageFlipY],set)=>{set(calculateImageTransforms($stageRect,$rootRect,$imageSize,$imageCropRectPresentation,$imageSelectionRect,$presentationScalar,0,0,$imageRotation,$imageFlipX,$imageFlipY));});component_subscribe($$self,imageTransforms,value=>$$invalidate(204,$imageTransforms=value));const imageEffects=derived([imageColorMatrix,imageConvolutionMatrix,imageGamma,imageVignette,imageNoise],([$colorMatrix,$convolutionMatrix,$gamma,$vignette,$noise],set)=>{const colorMatrices=$colorMatrix&&Object.keys($colorMatrix).map(name=>$colorMatrix[name]).filter(Boolean);const effects={gamma:$gamma||undefined,vignette:$vignette||undefined,noise:$noise||undefined,convolutionMatrix:$convolutionMatrix||undefined,colorMatrix:colorMatrices&&colorMatrices.length&&getColorMatrixFromColorMatrices(colorMatrices)};set(effects);});component_subscribe($$self,imageEffects,value=>$$invalidate(206,$imageEffects=value));//\n// current environment variables\n//\nlet windowWidth;let windowHeight;const shouldPreventSwipe=canPreventNavSwipe();const env=writable({});component_subscribe($$self,env,value=>$$invalidate(201,$env=value));const initialPixelRatio=getDevicePixelRatio();const pixelRatio=readable(initialPixelRatio,set=>{const handleResolutionChange=()=>set(getDevicePixelRatio());const resolutionObserver=matchMedia(`(resolution: ${initialPixelRatio}dppx)`);resolutionObserver.addListener(handleResolutionChange);return()=>resolutionObserver.removeListener(handleResolutionChange);});component_subscribe($$self,pixelRatio,value=>$$invalidate(56,$pixelRatio=value));const history=historyCreate(()=>$imageState,state=>{// set new state from history, $imageState will store a clone of the received state\nset_store_value(imageState,$imageState=state,$imageState);// image state will return a clone of the current state\n// trigger recenter of image selection rect\ntabRect.set($tabRect);});$$subscribe_history();imageLoadState.subscribe(({complete}={})=>{if(!complete)return;history.set($imageState);});const revert=()=>willRevert().then(shouldReset=>shouldReset&&history.revert());//\n// Visual processing of the image\n//\nconst imageProcessingPreparing=writable(false);component_subscribe($$self,imageProcessingPreparing,value=>$$invalidate(183,$imageProcessingPreparing=value));const handleExport=()=>{// this will trigger status overlay fade in\nset_store_value(imageProcessingPreparing,$imageProcessingPreparing=true,$imageProcessingPreparing);// wait for status to be done fading in, then requests image writing\nconst unsub=statusOpacity.subscribe(value=>{if(value!==1)return;// stop listening for\nunsub();// request write image\ndispatch(\"processImage\");});};imageProcessState.subscribe(state=>{if(!state)return;set_store_value(imageProcessingPreparing,$imageProcessingPreparing=true,$imageProcessingPreparing);const{task,error,complete}=state;if(complete)set_store_value(imageProcessingPreparing,$imageProcessingPreparing=false,$imageProcessingPreparing);});//\n// Configure the available views\n//\nconst utilStores=_objectSpread(_objectSpread({},stores),{},{// image\nimageFile,imageSize,imageCropAspectRatio,imageCropMinSize,imageCropMaxSize,imageCropLimitToImage,imageCropRect,imageCropRectOrigin,imageCropRectSnapshot,imageCropRectAspectRatio,imageCropRange,imageRotation,imageRotationRange,imageFlipX,imageFlipY,imageOutputSize,// effects\nimageColorMatrix,imageConvolutionMatrix,imageGamma,imageVignette,imageNoise,// markup\nimageDecoration,imageAnnotation,// image preview for utils that need access to pixel data\nimagePreview,// top left position of image preview\nimageTransforms,// allows utils to control how the preview is presented (for example more opacity for mask)\nimagePreviewModifiers,// history state and update\nhistory,// static env info\npixelRatio,elasticityMultiplier,scrollElasticity,rangeInputElasticity,// dynamic env info\npointerAccuracy,pointerHoverable,env,rootRect,stageRect,stageScalar,utilRect,presentationScalar,rootBackgroundColor,// (write) add guides to ui (for example is used by markup util to add lines for shape manipulator)\nimageOverlayMarkup,// (write) previews to render\nimagePreviews,// (write) set to true to disable animations\nisInteracting,// (write) the current intended crop rect\nimageCropRectIntent,// (read) the current presented crop rect\nimageCropRectPresentation,// (write) the current limited size of the image selection rect\nimageSelectionRect,// (write) the inteded rectangle by the user\nimageSelectionRectIntent,// (read) the current presentation of the image selection rect, includes elasticity etc.\nimageSelectionRectPresentation,// (read) a snapshot of the image selection rectangle, use to store the rectangle before modification so alterations to the rectangle can be applied to the snapshot\nimageSelectionRectSnapshot,// scalar of image in view\nimageScalar});// don't expose image store\ndelete utilStores.image;const utilsUniqueId=`util-${getUniqueId()}`;let utilsVisible=[];// env\nlet iOS=isIOS();// canvas background color\nconst syncBackgroundColor=()=>{const colorString=rootElementComputedStyle.getPropertyValue(\"background-color\");const colorArray=colorStringToColorArray(colorString);// hide transparent color\nif(colorArray[3]===0)return;// limit to opaque colors\ncolorArray.length=3;// update background\nset_store_value(rootBackgroundColor,$rootBackgroundColor=colorArray,$rootBackgroundColor);};const handleTransitionEnd=({target,propertyName})=>{if(target!==root||propertyName!==\"background-color\")return;syncBackgroundColor();};// test if some shapes have left/top/bottom/right offsets, if so, convert to crop space\n// updates original shape (which at this point is a flattened shape (clone))\nconst positionDecorationShape=(shape,canvasState)=>shapeComputeDisplay(shape,{x:$imageSelectionRectPresentation.x/canvasState.scale,y:$imageSelectionRectPresentation.y/canvasState.scale,width:$imageSelectionRectPresentation.width/canvasState.scale,height:$imageSelectionRectPresentation.height/canvasState.scale});// decoration is drawn relative to view space, so we need to translate relative to crop presentation rect\nconst transformDecorationShape=(shape,canvasState)=>{shapeComputeTransform(shape,$imageSelectionRectPresentation,canvasState.scale,canvasState.size);return shape;};const flattenShapes=shapes=>{const flattenedShapes=[];shapes.forEach(shape=>flattenedShapes.push(...flattenShape(shape)));return flattenedShapes.filter(Boolean);};const flattenShape=shape=>{// at this point shape is a copy of the original shape\n// the shapes to draw, can be multiple shapes\nconst drawableShapes=[shape];if(shapeIsLine(shape)){let start=vectorCreate(shape.x1,shape.y1);let end=vectorCreate(shape.x2,shape.y2);if(shape.lineStart){const style=shapeComputeLineEnd(start,shape.strokeWidth,shape.strokeColor,shape.lineStart,vectorCreate(end.x-start.x,end.y-start.y));start=style.position||start;drawableShapes.push(style.shape);}if(shape.lineEnd){const style=shapeComputeLineEnd(end,shape.strokeWidth,shape.strokeColor,shape.lineEnd,vectorCreate(start.x-end.x,start.y-end.y));end=style.position||start;drawableShapes.push(style.shape);}// transform into line\nshape.points=[start,end];}else if(shapeIsTriangle(shape)){shape.points=[vectorCreate(shape.x1,shape.y1),vectorCreate(shape.x2,shape.y2),vectorCreate(shape.x3,shape.y3)];}else// is empty text\nif(shapeIsTextEmpty(shape)){// make sure shape is still visible\nif(shapeIsTextLine(shape)){shape.width=5;shape.height=isFunction(shape.lineHeight)?shape.lineHeight(shape.fontSize):shape.lineHeight;}// set to empty text style\nshape.strokeWidth=1;shape.strokeColor=[1,1,1,0.5];shape.backgroundColor=[0,0,0,0.1];}return drawableShapes;};const statusOpacity=tweened(undefined,{duration:500});component_subscribe($$self,statusOpacity,value=>$$invalidate(46,$statusOpacity=value));let loadTimer;const statusOffsetX=spring(undefined,{stiffness:0.02,damping:0.5,precision:0.25});component_subscribe($$self,statusOffsetX,value=>$$invalidate(48,$statusOffsetX=value));const progressOffsetX=spring(undefined,{stiffness:0.03,damping:0.4,precision:0.25});component_subscribe($$self,progressOffsetX,value=>$$invalidate(49,$progressOffsetX=value));const hideStatus=()=>{statusOffsetX.set(undefined,{hard:true});progressOffsetX.set(undefined,{hard:true});};const offsetProgress=e=>{set_store_value(statusOffsetX,$statusOffsetX=Math.round(-e.detail.width*0.5)-16,$statusOffsetX);// -16 offsets text so it's better centered to the viewport\nset_store_value(progressOffsetX,$progressOffsetX=e.detail.width,$progressOffsetX);};const handleCloseImageLoadError=()=>{dispatch(\"abortLoadImage\");};const handleCloseImageProcessError=()=>{dispatch(\"abortProcessImage\");set_store_value(imageProcessingPreparing,$imageProcessingPreparing=false,$imageProcessingPreparing);};// context for children to know if a key is down\nconst pressedKeysStore=writable([]);component_subscribe($$self,pressedKeysStore,value=>$$invalidate(213,$pressedKeysStore=value));setContext(\"keysPressed\",pressedKeysStore);const handleKeydown=e=>{const{keyCode}=e;const keySet=new Set([...$pressedKeysStore,keyCode]);pressedKeysStore.set(Array.from(keySet));};const handleKeyup=({keyCode})=>{pressedKeysStore.set($pressedKeysStore.filter(pressedKey=>pressedKey!==keyCode));};// so no keys get stuck when user cmd-tabs out of the window, or when dev-tools open by key-press\nconst handleWindowBlur=()=>{pressedKeysStore.set([]);};// block context menu on everything but text input fields\nconst handleContextMenu=e=>{if(isTextField(e.target))return;e.preventDefault();};// handle files being dropped on the editor\nconst handleDropFiles=e=>{// if no files dropped, exit!\nif(!enableDropImage||!e.detail.files.length)return;// request load image\ndispatch(\"loadImage\",e.detail.files[0]);};// canvas drawing\nconst getStageState=()=>({// add information on which util is active\nutilVisibility:_objectSpread({},utilsVisibleFraction),// used to fade in elements when interacting\nisInteracting:$isInteracting,isInteractingFraction:$isInteractingFraction,// add the root rectangle so will render can use width/height of root element\nrootRect:rectClone($rootRect),// add the stage rectangle so will render knows where stage starts and ends\nstageRect:rectClone($stageRect),// preview selection rect\nselectionRect:rectClone($imageSelectionRectPresentation)});const createCanvasState=(canvasState,annotationShapes,decorationShapes,interfaceShapes)=>({annotationShapes:flattenShapes(annotationShapes.filter(shapeIsVisible).map(shapeDeepCopy).map(shape=>shapeComputeDisplay(shape,$imageSize))),decorationShapes:flattenShapes(decorationShapes.filter(shapeIsVisible).map(shapeDeepCopy).map(shape=>positionDecorationShape(shape,canvasState)).map(shape=>transformDecorationShape(shape,canvasState))),interfaceShapes:flattenShapes(interfaceShapes.filter(shapeIsVisible))});// setup root portal for detail panel dropdown\nlet rootPortal;const rootPortalStore=writable();setContext(\"rootPortal\",rootPortalStore);// setup root rect store for global access\nsetContext(\"rootRect\",rootRect);function onwindowresize(){$$invalidate(10,windowWidth=window.innerWidth);$$invalidate(11,windowHeight=window.innerHeight);}const measure_handler=e=>set_store_value(toolRect,$toolRect=e.detail,$toolRect);const select_handler=({detail})=>$$invalidate(21,utilSelected=detail);const func=(panel,util)=>util.id===panel;function panel_component_binding(value,panel){pluginInterface[panel]=value;($$invalidate(0,pluginInterface),$$invalidate(7,pluginOptions)),$$invalidate(134,pluginComponents);}const measure_handler_1=e=>set_store_value(utilRect,$utilRect=e.detail,$utilRect);const show_handler=panel=>$$invalidate(12,utilsVisible=utilsVisible.concat(panel));const hide_handler=panel=>$$invalidate(12,utilsVisible=utilsVisible.filter(util=>util!==panel));const fade_handler=(panel,{detail})=>$$invalidate(22,utilsVisibleFraction[panel]=detail,utilsVisibleFraction);const measure_handler_2=e=>set_store_value(tabRect,$tabRect=e.detail,$tabRect);const func_1=util=>util.id===utilSelected;function panel_component_binding_1(value){pluginInterface[utilSelected]=value;($$invalidate(0,pluginInterface),$$invalidate(7,pluginOptions)),$$invalidate(134,pluginComponents);}const measure_handler_3=e=>set_store_value(utilRect,$utilRect=e.detail,$utilRect);const show_handler_1=()=>$$invalidate(12,utilsVisible=utilsVisible.concat(utilSelected));const hide_handler_1=()=>$$invalidate(12,utilsVisible=utilsVisible.filter(util=>util!==utilSelected));const fade_handler_1=({detail})=>$$invalidate(22,utilsVisibleFraction[utilSelected]=detail,utilsVisibleFraction);const func_2=canvasState=>{// current draw state\nconst drawState=_objectSpread(_objectSpread({},canvasState),getStageState());// allow dev to add custom overlay to `imageOverlay`\nconst{annotationShapes,decorationShapes,interfaceShapes}=willRenderCanvas({decorationShapes:$imageDecoration,annotationShapes:$imageAnnotation,interfaceShapes:$imageOverlay},drawState);// need to map shapes\nreturn createCanvasState(drawState,annotationShapes,decorationShapes,interfaceShapes);};function div_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{rootPortal=$$value;$$invalidate(13,rootPortal);});}function div_binding_1($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{root=$$value;$$invalidate(1,root);});}const measure_handler_4=e=>set_store_value(clientRect,$clientRect=e.detail,$clientRect);$$self.$$set=$$props=>{if(\"class\"in $$props)$$invalidate(117,klass=$$props.class);if(\"layout\"in $$props)$$invalidate(118,layoutMode=$$props.layout);if(\"stores\"in $$props)$$invalidate(119,stores=$$props.stores);if(\"locale\"in $$props)$$invalidate(2,locale=$$props.locale);if(\"id\"in $$props)$$invalidate(3,id=$$props.id);if(\"util\"in $$props)$$invalidate(120,util=$$props.util);if(\"utils\"in $$props)$$invalidate(121,utils=$$props.utils);if(\"animations\"in $$props)$$invalidate(122,animations=$$props.animations);if(\"previewUpscale\"in $$props)$$invalidate(123,previewUpscale=$$props.previewUpscale);if(\"elasticityMultiplier\"in $$props)$$invalidate(4,elasticityMultiplier=$$props.elasticityMultiplier);if(\"willRevert\"in $$props)$$invalidate(124,willRevert=$$props.willRevert);if(\"willRenderCanvas\"in $$props)$$invalidate(5,willRenderCanvas=$$props.willRenderCanvas);if(\"willRenderToolbar\"in $$props)$$invalidate(125,willRenderToolbar=$$props.willRenderToolbar);if(\"enableButtonExport\"in $$props)$$invalidate(126,enableButtonExport=$$props.enableButtonExport);if(\"enableButtonRevert\"in $$props)$$invalidate(127,enableButtonRevert=$$props.enableButtonRevert);if(\"enableNavigateHistory\"in $$props)$$invalidate(128,enableNavigateHistory=$$props.enableNavigateHistory);if(\"enableToolbar\"in $$props)$$invalidate(6,enableToolbar=$$props.enableToolbar);if(\"enableUtils\"in $$props)$$invalidate(129,enableUtils=$$props.enableUtils);if(\"enableButtonClose\"in $$props)$$invalidate(130,enableButtonClose=$$props.enableButtonClose);if(\"previewImageDataMaxSize\"in $$props)$$invalidate(131,previewImageDataMaxSize=$$props.previewImageDataMaxSize);if(\"enableDropImage\"in $$props)$$invalidate(132,enableDropImage=$$props.enableDropImage);if(\"imageOrienter\"in $$props)$$invalidate(133,imageOrienter=$$props.imageOrienter);if(\"pluginComponents\"in $$props)$$invalidate(134,pluginComponents=$$props.pluginComponents);if(\"pluginOptions\"in $$props)$$invalidate(7,pluginOptions=$$props.pluginOptions);if(\"root\"in $$props)$$invalidate(1,root=$$props.root);if(\"imageSourceToImageData\"in $$props)$$invalidate(8,imageSourceToImageData=$$props.imageSourceToImageData);};let isOverlayModeEnabled;let showUtils;let maxImageDataSize;let canAnimate;let acceptsAnimations;let shouldAnimate;let canUndo;let canRedo;let utilsFiltered;let utilsAvailable;let utilsDefined;let utilsMerged;let utilSelected;let utilTools;let utilsVisibleFraction;let tabsConfig;let tabs;let panels;let shouldRenderTabs;let className;let orientation;let isLandscape;let horizontalSpace;let hasLimitedSpace;let verticalSpace;let isModal;let isCenteredHorizontally;let isCenteredVertically;let isCentered;let isNarrow;let isCompact;let hasSwipeNavigation;let shouldRenderUtilTools;let rootElementComputedStyle;let envStr;let imageProps;let missingFeatures;let isSupportsError;let isImageLoadError;let isWaitingForImage;let imageLoadProgress;let isLoadingImageData;let isCreatingImagePreview;let isProcessingImage;let imageLoadShowProgressIndicator;let imageLoadStatusLabel;let imageProcessStatusLabel;let imageProcessProgress;let imageProcessShowProgressIndicator;let isImageProcessingError;let isStatusVisible;let handleTouchStart;let toolbarItems;let hasClientRect;let canRender;let routePing;$$self.$$.update=()=>{if($$self.$$.dirty[3]&/*layoutMode*/33554432){$$invalidate(160,isOverlayModeEnabled=layoutMode===\"overlay\");}if($$self.$$.dirty[4]&/*enableUtils*/32|$$self.$$.dirty[5]&/*isOverlayModeEnabled*/32){$$invalidate(14,showUtils=enableUtils&&!isOverlayModeEnabled);}if($$self.$$.dirty[0]&/*pluginOptions, pluginInterface*/129){// map plugin options to plugin interface\nif(pluginOptions){// for every plugin in plugin options\nObject.keys(pluginOptions).forEach(plugin=>{// for every prop defined for this plugin\nObject.keys(pluginOptions[plugin]).forEach(prop=>{// set value to interface\nif(!pluginInterface[plugin])return;// set prop value\n$$invalidate(0,pluginInterface[plugin][prop]=pluginOptions[plugin][prop],pluginInterface);});});}}if($$self.$$.dirty[0]&/*pluginInterface*/1|$$self.$$.dirty[4]&/*pluginComponents*/1024){{let changed=false;pluginComponents.forEach(([key])=>{if(pluginInterface[key])return;$$invalidate(0,pluginInterface[key]={},pluginInterface);changed=true;});if(changed){$$invalidate(156,registeredPluginsComponents=[...pluginComponents]);}}}if($$self.$$.dirty[4]&/*previewImageDataMaxSize*/128){maxImageDataSize=previewImageDataMaxSize?sizeMin(previewImageDataMaxSize,maxTextureSize):maxTextureSize;}if($$self.$$.dirty[5]&/*$images*/128){imageProxy.update($images[0]);}if($$self.$$.dirty[0]&/*$clientRect*/32768){$clientRect&&rootRect.set(rectCreate($clientRect.x,$clientRect.y,$clientRect.width,$clientRect.height));}if($$self.$$.dirty[5]&/*$rootRect, isOverlayModeEnabled, $imageLoadState*/1312){$rootRect&&isOverlayModeEnabled&&$imageLoadState&&$imageLoadState.complete&&syncRootAspectRatio();}if($$self.$$.dirty[3]&/*previewUpscale*/1073741824|$$self.$$.dirty[5]&/*isOverlayModeEnabled*/32){previewShouldUpscale.set(previewUpscale||isOverlayModeEnabled);}if($$self.$$.dirty[5]&/*$isInteracting*/32768){//\n// Animations based on prefers-reduced-motion, automatically checks if user prefers reduced animations\n//\n$$invalidate(177,canAnimate=!$isInteracting);}if($$self.$$.dirty[5]&/*$prefersReducedMotion*/16777216){$$invalidate(178,acceptsAnimations=!$prefersReducedMotion);}if($$self.$$.dirty[3]&/*animations*/536870912|$$self.$$.dirty[5]&/*canAnimate, acceptsAnimations*/12582912){$$invalidate(18,shouldAnimate=animations===\"always\"?canAnimate:animations===\"never\"?false:canAnimate&&acceptsAnimations);}if($$self.$$.dirty[5]&/*$history*/67108864){$$invalidate(180,canUndo=$history.index>-1);}if($$self.$$.dirty[5]&/*$history*/67108864){$$invalidate(182,canRedo=$history.index<$history.length-1);}if($$self.$$.dirty[0]&/*locale*/4|$$self.$$.dirty[3]&/*utils*/268435456|$$self.$$.dirty[5]&/*registeredPluginsComponents*/2){$$invalidate(184,utilsFiltered=locale&&registeredPluginsComponents.length?utils||registeredPluginsComponents.map(([id])=>id):[]);}if($$self.$$.dirty[5]&/*registeredPluginsComponents, utilsFiltered*/536870914){$$invalidate(185,utilsAvailable=registeredPluginsComponents.filter(([id])=>utilsFiltered.includes(id)));}if($$self.$$.dirty[5]&/*utilsAvailable*/1073741824){$$invalidate(186,utilsDefined=utilsAvailable.length);}if($$self.$$.dirty[0]&/*locale*/4|$$self.$$.dirty[5]&/*utilsFiltered, utilsAvailable*/1610612736){$$invalidate(20,utilsMerged=utilsFiltered.map(utilId=>{const util=utilsAvailable.find(([id])=>utilId===id);// [id, view]\nif(!util)return;return{id:utilId,view:util[1],tabIcon:locale[`${utilId}Icon`],tabLabel:locale[`${utilId}Label`]};}).filter(Boolean)||[]);}if($$self.$$.dirty[3]&/*util*/134217728|$$self.$$.dirty[5]&/*utilsFiltered*/536870912|$$self.$$.dirty[6]&/*utilsDefined*/1){$$invalidate(21,utilSelected=util&&typeof util===\"string\"&&utilsFiltered.includes(util)?util:utilsDefined&&utilsFiltered[0]);}if($$self.$$.dirty[0]&/*utilSelected, pluginInterface*/2097153){$$invalidate(187,utilTools=utilSelected&&pluginInterface[utilSelected].tools||[]);}if($$self.$$.dirty[0]&/*utilsMerged, utilsVisibleFraction*/5242880){$$invalidate(22,utilsVisibleFraction=utilsMerged.reduce((prev,curr)=>{prev[curr.id]=utilsVisibleFraction&&utilsVisibleFraction[curr.id]||0;return prev;},{}));}if($$self.$$.dirty[0]&/*utilSelected*/2097152){$$invalidate(23,tabsConfig={name:utilsUniqueId,selected:utilSelected});}if($$self.$$.dirty[0]&/*utilsMerged*/1048576){$$invalidate(24,tabs=utilsMerged.map(util=>({id:util.id,icon:util.tabIcon,label:util.tabLabel})));}if($$self.$$.dirty[0]&/*utilsMerged*/1048576){$$invalidate(25,panels=utilsMerged.map(util=>util.id));}if($$self.$$.dirty[5]&/*utilsFiltered*/536870912){$$invalidate(16,shouldRenderTabs=utilsFiltered.length>1);}if($$self.$$.dirty[3]&/*klass*/16777216){$$invalidate(26,className=arrayJoin([\"DokaRoot\",\"DokaRootComponent\",klass]));}if($$self.$$.dirty[5]&/*$rootRect*/256){$$invalidate(188,orientation=$rootRect&&($rootRect.width>$rootRect.height?\"landscape\":\"portrait\"));}if($$self.$$.dirty[6]&/*orientation*/4){$$invalidate(27,isLandscape=orientation===\"landscape\");}if($$self.$$.dirty[5]&/*$rootRect*/256){$$invalidate(189,horizontalSpace=$rootRect&&($rootRect.width>1000?\"wide\":$rootRect.width<600?\"narrow\":undefined));}if($$self.$$.dirty[5]&/*$rootRect*/256){$$invalidate(190,hasLimitedSpace=$rootRect&&($rootRect.width<=320||$rootRect.height<=460));}if($$self.$$.dirty[5]&/*$rootRect*/256){$$invalidate(191,verticalSpace=$rootRect&&($rootRect.height>1000?\"tall\":$rootRect.height<600?\"short\":undefined));}if($$self.$$.dirty[0]&/*root*/2){$$invalidate(192,isModal=root&&root.parentNode&&root.parentNode.classList.contains(\"DokaModal\"));}if($$self.$$.dirty[0]&/*windowWidth*/1024|$$self.$$.dirty[5]&/*$rootRect*/256|$$self.$$.dirty[6]&/*isModal*/64){$$invalidate(193,isCenteredHorizontally=isModal&&$rootRect&&windowWidth>$rootRect.width);}if($$self.$$.dirty[0]&/*windowHeight*/2048|$$self.$$.dirty[5]&/*$rootRect*/256|$$self.$$.dirty[6]&/*isModal*/64){$$invalidate(194,isCenteredVertically=isModal&&$rootRect&&windowHeight>$rootRect.height);}if($$self.$$.dirty[6]&/*isCenteredHorizontally, isCenteredVertically*/384){$$invalidate(195,isCentered=isCenteredHorizontally&&isCenteredVertically);}if($$self.$$.dirty[6]&/*horizontalSpace*/8){$$invalidate(196,isNarrow=horizontalSpace===\"narrow\");}if($$self.$$.dirty[6]&/*isNarrow, verticalSpace*/1056){$$invalidate(197,isCompact=isNarrow||verticalSpace===\"short\");}if($$self.$$.dirty[0]&/*windowWidth*/1024|$$self.$$.dirty[5]&/*$rootRect*/256){$$invalidate(198,hasSwipeNavigation=iOS&&$rootRect&&windowWidth===$rootRect.width&&!shouldPreventSwipe);}if($$self.$$.dirty[6]&/*utilTools, verticalSpace*/34){$$invalidate(199,shouldRenderUtilTools=utilTools.length&&verticalSpace===\"short\");}if($$self.$$.dirty[0]&/*root*/2){// will update when root element is available\n$$invalidate(200,rootElementComputedStyle=root&&getComputedStyle(root));}if($$self.$$.dirty[6]&/*rootElementComputedStyle*/16384){// sync for first time\nif(rootElementComputedStyle)syncBackgroundColor();}if($$self.$$.dirty[0]&/*enableToolbar, shouldRenderTabs, showUtils*/81984|$$self.$$.dirty[3]&/*layoutMode*/33554432|$$self.$$.dirty[6]&/*$env, orientation, horizontalSpace, verticalSpace, isModal, isCentered, isCenteredHorizontally, isCenteredVertically, $pointerAccuracy, $pointerHoverable, isCompact, hasSwipeNavigation, hasLimitedSpace*/236540){env.set(_objectSpread(_objectSpread({},$env),{},{layoutMode,orientation,horizontalSpace,verticalSpace,isModal,isCentered,isCenteredHorizontally,isCenteredVertically,pointerAccuracy:$pointerAccuracy,pointerHoverable:$pointerHoverable,isCompact,hasSwipeNavigation,hasLimitedSpace,hasToolbar:enableToolbar,hasNavigation:shouldRenderTabs&&showUtils,isIOS:iOS}));}if($$self.$$.dirty[6]&/*$env*/32768){$$invalidate(29,envStr=Object.keys($env).map(key=>{// is true boolean prop, use key\nif(/^is|has/.test(key)){return $env[key]?toKebabCase(key):undefined;}// use value\nreturn $env[key];}).filter(Boolean).join(\" \"));}if($$self.$$.dirty[5]&/*$imageCropRect*/16384|$$self.$$.dirty[6]&/*$imageTransforms, $imagePreviewModifiers, $imageEffects, $imageBackgroundColor*/3932160){$$invalidate(30,imageProps=$imageTransforms?_objectSpread(_objectSpread(_objectSpread(_objectSpread({},Object.keys($imagePreviewModifiers).filter(key=>$imagePreviewModifiers[key]!=null).reduce((prev,curr)=>{prev=_objectSpread(_objectSpread({},prev),$imagePreviewModifiers[curr]);return prev;},{})),$imageTransforms),$imageEffects),{},{backgroundColor:$imageBackgroundColor,size:sizeCreateFromRect($imageCropRect)}):undefined);}if($$self.$$.dirty[0]&/*locale*/4|$$self.$$.dirty[6]&/*missingFeatures*/4194304){$$invalidate(32,isSupportsError=locale&&missingFeatures.length&&locale.labelSupportError(missingFeatures));}if($$self.$$.dirty[5]&/*$imageLoadState*/1024){//\n// loading status\n//\n$$invalidate(33,isImageLoadError=$imageLoadState&&!!$imageLoadState.error);}if($$self.$$.dirty[5]&/*$imageLoadState*/1024){$$invalidate(34,isWaitingForImage=!$imageLoadState||!$imageLoadState.complete&&$imageLoadState.task===undefined);}if($$self.$$.dirty[5]&/*$imageLoadState*/1024){$$invalidate(35,imageLoadProgress=$imageLoadState&&($imageLoadState.taskLengthComputable?$imageLoadState.taskProgress:Infinity));}if($$self.$$.dirty[5]&/*$imageLoadState, loadTimer*/1040){if($imageLoadState&&$imageLoadState.complete){// TODO: derive visual load complete from interface rest state instead of arbitrary timer\nclearTimeout(loadTimer);$$invalidate(159,loadTimer=setTimeout(()=>{set_store_value(imageVisualLoadComplete,$imageVisualLoadComplete=true,$imageVisualLoadComplete);},500));}else if(!$imageLoadState){set_store_value(imageVisualLoadComplete,$imageVisualLoadComplete=false,$imageVisualLoadComplete);}}if($$self.$$.dirty[1]&/*isImageLoadError, isWaitingForImage*/12|$$self.$$.dirty[5]&/*$imageLoadState*/1024|$$self.$$.dirty[6]&/*$imageVisualLoadComplete*/8388608){$$invalidate(36,isLoadingImageData=$imageLoadState&&!isImageLoadError&&!isWaitingForImage&&!$imageVisualLoadComplete);}if($$self.$$.dirty[1]&/*$imagePreview*/128|$$self.$$.dirty[6]&/*$imageFile*/16777216){$$invalidate(37,isCreatingImagePreview=!!($imageFile&&!$imagePreview));}if($$self.$$.dirty[5]&/*$imageProcessingPreparing*/268435456|$$self.$$.dirty[6]&/*$imageProcessState*/33554432){//\n// processing status\n//\n$$invalidate(39,isProcessingImage=$imageProcessingPreparing||$imageProcessState&&$imageProcessState.progress!==undefined&&!$imageProcessState.complete);}if($$self.$$.dirty[1]&/*isWaitingForImage*/8|$$self.$$.dirty[5]&/*$imageLoadState*/1024){$$invalidate(40,imageLoadShowProgressIndicator=$imageLoadState&&!($imageLoadState.error||isWaitingForImage));}if($$self.$$.dirty[0]&/*locale*/4|$$self.$$.dirty[5]&/*$imageLoadState*/1024){$$invalidate(41,imageLoadStatusLabel=locale&&(!$imageLoadState?locale.statusLabelLoadImage($imageLoadState):!$imageLoadState.complete?stringReplace(locale.statusLabelLoadImage($imageLoadState),$imageLoadState.error&&$imageLoadState.error.metadata,\"{\",\"}\"):locale.statusLabelLoadImage({progress:Infinity,task:\"blob-to-bitmap\"})));}if($$self.$$.dirty[0]&/*locale*/4|$$self.$$.dirty[6]&/*$imageProcessState*/33554432){$$invalidate(42,imageProcessStatusLabel=$imageProcessState&&locale&&locale.statusLabelProcessImage($imageProcessState));}if($$self.$$.dirty[6]&/*$imageProcessState*/33554432){$$invalidate(43,imageProcessProgress=$imageProcessState&&($imageProcessState.taskLengthComputable?$imageProcessState.taskProgress:Infinity));}if($$self.$$.dirty[6]&/*$imageProcessState*/33554432){$$invalidate(44,imageProcessShowProgressIndicator=$imageProcessState&&!$imageProcessState.error);}if($$self.$$.dirty[6]&/*$imageProcessState*/33554432){$$invalidate(45,isImageProcessingError=$imageProcessState&&$imageProcessState.error);}if($$self.$$.dirty[1]&/*isSupportsError, isWaitingForImage, isImageLoadError, isLoadingImageData, isCreatingImagePreview, isProcessingImage*/366){set_store_value(statusOpacity,$statusOpacity=isSupportsError||isWaitingForImage||isImageLoadError||isLoadingImageData||isCreatingImagePreview||isProcessingImage?1:0,$statusOpacity);}if($$self.$$.dirty[1]&/*$statusOpacity*/32768){$$invalidate(47,isStatusVisible=$statusOpacity>0);}if($$self.$$.dirty[1]&/*$statusOpacity*/32768){if($statusOpacity<=0)hideStatus();}if($$self.$$.dirty[0]&/*windowWidth*/1024){$$invalidate(50,handleTouchStart=shouldPreventSwipe&&(e=>{// get touch or event itself (fixes issue with chrome dev tools)\nconst event=e.touches?e.touches[0]:e;// if is not an attempt to swipe back or forward\nif(event.pageX>10&&event.pageX<windowWidth-10)return;// stop the navigation attempt\ne.preventDefault();}));}if($$self.$$.dirty[0]&/*locale*/4|$$self.$$.dirty[4]&/*willRenderToolbar, enableButtonClose, enableButtonRevert, enableNavigateHistory, enableButtonExport*/94|$$self.$$.dirty[5]&/*canUndo, canRedo*/167772160|$$self.$$.dirty[6]&/*shouldRenderUtilTools, utilTools, isNarrow, $env*/41986){// dynamic IO menu\n$$invalidate(51,toolbarItems=locale&&willRenderToolbar([[\"div\",\"alpha\",{class:\"DokaNavGroup\"},[[\"div\",\"alpha-set\",{class:\"DokaNavSet\"},[// button close\nenableButtonClose&&[Button,\"close\",{label:locale.labelClose,icon:locale.iconButtonClose,onclick:()=>dispatch(\"close\"),hideLabel:true}],// button revert\nenableButtonRevert&&[Button,\"revert\",{label:locale.labelButtonRevert,icon:locale.iconButtonRevert,disabled:!canUndo,onclick:revert,hideLabel:true}]]]]],[\"div\",\"beta\",{class:\"DokaNavGroup DokaNavGroupFloat\"},[enableNavigateHistory&&[\"div\",\"history\",{class:\"DokaNavSet\"},[[Button,\"undo\",{label:locale.labelButtonUndo,icon:locale.iconButtonUndo,disabled:!canUndo,onclick:history.undo,hideLabel:true}],[Button,\"redo\",{label:locale.labelButtonRedo,icon:locale.iconButtonRedo,disabled:!canRedo,onclick:history.redo,hideLabel:true}]]],shouldRenderUtilTools&&[\"div\",\"plugin-tools\",{class:\"DokaNavSet\"},utilTools.filter(Boolean).map(// in\n([component,key,props])=>// out\n[component,key,_objectSpread(_objectSpread({},props),{},{hideLabel:true})])]]],[\"div\",\"gamma\",{class:\"DokaNavGroup\"},[enableButtonExport&&[Button,\"export\",{label:locale.labelButtonExport,icon:isNarrow&&locale.iconButtonExport,class:\"DokaButtonExport\",onclick:handleExport,hideLabel:isNarrow}]]]],_objectSpread({},$env)));}if($$self.$$.dirty[0]&/*$clientRect*/32768){$$invalidate(212,hasClientRect=$clientRect&&$clientRect.width>0&&$clientRect.height>0);}if($$self.$$.dirty[0]&/*locale*/4|$$self.$$.dirty[6]&/*hasClientRect, utilsDefined*/67108865){$$invalidate(52,canRender=hasClientRect&&locale&&utilsDefined);}if($$self.$$.dirty[0]&/*rootPortal*/8192){rootPortal&&rootPortalStore.set(rootPortal);}};$$invalidate(208,missingFeatures=[!supportsWebGL()&&\"WebGL\"].filter(Boolean));// used to route ping events\n$$invalidate(53,routePing=createPingRouter(eventProxy.pub));return[pluginInterface,root,locale,id,elasticityMultiplier,willRenderCanvas,enableToolbar,pluginOptions,imageSourceToImageData,history,windowWidth,windowHeight,utilsVisible,rootPortal,showUtils,$clientRect,shouldRenderTabs,$imageSize,shouldAnimate,$tabRect,utilsMerged,utilSelected,utilsVisibleFraction,tabsConfig,tabs,panels,className,isLandscape,$rootBackgroundColor,envStr,imageProps,$imageSelectionRectPresentation,isSupportsError,isImageLoadError,isWaitingForImage,imageLoadProgress,isLoadingImageData,isCreatingImagePreview,$imagePreview,isProcessingImage,imageLoadShowProgressIndicator,imageLoadStatusLabel,imageProcessStatusLabel,imageProcessProgress,imageProcessShowProgressIndicator,isImageProcessingError,$statusOpacity,isStatusVisible,$statusOffsetX,$progressOffsetX,handleTouchStart,toolbarItems,canRender,routePing,$toolRect,$utilRect,$pixelRatio,$imagePreviews,$imageDecoration,$imageAnnotation,$imageOverlay,imageFile,imageSize,imageLoadState,imageProcessState,imageCropRect,imageBackgroundColor,imageDecoration,imageAnnotation,imageState,images,rootBackgroundColor,clientRect,rootRect,tabRect,toolRect,utilRect,stageRect,pointerAccuracy,pointerHoverable,isInteracting,isInteractingFraction,previewShouldUpscale,stageScalar,imageCropRectSnapshot,imageCropRectIntent,imageSelectionRect,imageSelectionRectSnapshot,imageSelectionRectIntent,imageSelectionRectPresentation,presentationScalar,imageOverlay,imageVisualLoadComplete,imagePreview,imagePreviewModifiers,imagePreviews,imageTransforms,imageEffects,env,pixelRatio,imageProcessingPreparing,utilStores,handleTransitionEnd,statusOpacity,statusOffsetX,progressOffsetX,offsetProgress,handleCloseImageLoadError,handleCloseImageProcessError,pressedKeysStore,handleKeydown,handleKeyup,handleWindowBlur,handleContextMenu,handleDropFiles,getStageState,createCanvasState,klass,layoutMode,stores,util,utils,animations,previewUpscale,willRevert,willRenderToolbar,enableButtonExport,enableButtonRevert,enableNavigateHistory,enableUtils,enableButtonClose,previewImageDataMaxSize,enableDropImage,imageOrienter,pluginComponents,sub,onwindowresize,measure_handler,select_handler,func,panel_component_binding,measure_handler_1,show_handler,hide_handler,fade_handler,measure_handler_2,func_1,panel_component_binding_1,measure_handler_3,show_handler_1,hide_handler_1,fade_handler_1,func_2,div_binding,div_binding_1,measure_handler_4];}class Ui extends SvelteComponent{constructor(options){super();init(this,options,instance$b,create_fragment$b,safe_not_equal,{class:117,layout:118,stores:119,locale:2,id:3,util:120,utils:121,animations:122,previewUpscale:123,elasticityMultiplier:4,willRevert:124,willRenderCanvas:5,willRenderToolbar:125,enableButtonExport:126,enableButtonRevert:127,enableNavigateHistory:128,enableToolbar:6,enableUtils:129,enableButtonClose:130,previewImageDataMaxSize:131,enableDropImage:132,imageOrienter:133,pluginComponents:134,pluginOptions:7,sub:135,pluginInterface:0,root:1,imageSourceToImageData:8,history:9},[-1,-1,-1,-1,-1,-1,-1,-1,-1]);}get class(){return this.$$.ctx[117];}set class(klass){this.$set({class:klass});flush();}get layout(){return this.$$.ctx[118];}set layout(layoutMode){this.$set({layout:layoutMode});flush();}get stores(){return this.$$.ctx[119];}set stores(stores){this.$set({stores});flush();}get locale(){return this.$$.ctx[2];}set locale(locale){this.$set({locale});flush();}get id(){return this.$$.ctx[3];}set id(id){this.$set({id});flush();}get util(){return this.$$.ctx[120];}set util(util){this.$set({util});flush();}get utils(){return this.$$.ctx[121];}set utils(utils){this.$set({utils});flush();}get animations(){return this.$$.ctx[122];}set animations(animations){this.$set({animations});flush();}get previewUpscale(){return this.$$.ctx[123];}set previewUpscale(previewUpscale){this.$set({previewUpscale});flush();}get elasticityMultiplier(){return this.$$.ctx[4];}set elasticityMultiplier(elasticityMultiplier){this.$set({elasticityMultiplier});flush();}get willRevert(){return this.$$.ctx[124];}set willRevert(willRevert){this.$set({willRevert});flush();}get willRenderCanvas(){return this.$$.ctx[5];}set willRenderCanvas(willRenderCanvas){this.$set({willRenderCanvas});flush();}get willRenderToolbar(){return this.$$.ctx[125];}set willRenderToolbar(willRenderToolbar){this.$set({willRenderToolbar});flush();}get enableButtonExport(){return this.$$.ctx[126];}set enableButtonExport(enableButtonExport){this.$set({enableButtonExport});flush();}get enableButtonRevert(){return this.$$.ctx[127];}set enableButtonRevert(enableButtonRevert){this.$set({enableButtonRevert});flush();}get enableNavigateHistory(){return this.$$.ctx[128];}set enableNavigateHistory(enableNavigateHistory){this.$set({enableNavigateHistory});flush();}get enableToolbar(){return this.$$.ctx[6];}set enableToolbar(enableToolbar){this.$set({enableToolbar});flush();}get enableUtils(){return this.$$.ctx[129];}set enableUtils(enableUtils){this.$set({enableUtils});flush();}get enableButtonClose(){return this.$$.ctx[130];}set enableButtonClose(enableButtonClose){this.$set({enableButtonClose});flush();}get previewImageDataMaxSize(){return this.$$.ctx[131];}set previewImageDataMaxSize(previewImageDataMaxSize){this.$set({previewImageDataMaxSize});flush();}get enableDropImage(){return this.$$.ctx[132];}set enableDropImage(enableDropImage){this.$set({enableDropImage});flush();}get imageOrienter(){return this.$$.ctx[133];}set imageOrienter(imageOrienter){this.$set({imageOrienter});flush();}get pluginComponents(){return this.$$.ctx[134];}set pluginComponents(pluginComponents){this.$set({pluginComponents});flush();}get pluginOptions(){return this.$$.ctx[7];}set pluginOptions(pluginOptions){this.$set({pluginOptions});flush();}get sub(){return this.$$.ctx[135];}get pluginInterface(){return this.$$.ctx[0];}get root(){return this.$$.ctx[1];}set root(root){this.$set({root});flush();}get imageSourceToImageData(){return this.$$.ctx[8];}set imageSourceToImageData(imageSourceToImageData){this.$set({imageSourceToImageData});flush();}get history(){return this.$$.ctx[9];}}// which props to filter out of exported props\nconst utilPrivateProps=['klass','stores','isVisible','isActive','isActiveFraction','locale'];const viewPrivateProps=[// methods\n'history',// props\n'klass','stores','navButtons','pluginComponents','pluginInterface','pluginOptions','sub'];// view options array\nlet editorProps;const pluginProps=new Set([]);const propPluginRef={};// loops over plugins and registers all available options so we can define getters/setters\nconst pluginComponents=new Map();const setEditorViewPlugins=(...args)=>{args.forEach(plugin=>{const[id,Component]=plugin.util;pluginComponents.set(id,Component);getComponentExportedProps(Component).filter(prop=>!utilPrivateProps.includes(prop)).forEach(prop=>{pluginProps.add(prop);if(propPluginRef[prop]){propPluginRef[prop].push(id);return;}propPluginRef[prop]=[id];});});};const getEditorViewProps=()=>{editorProps=new Set(getComponentExportedProps(Ui).filter(prop=>!viewPrivateProps.includes(prop)));return[...editorProps,...pluginProps];};const attachEditorView=(target,stores)=>{const accessors={};const editor=new Ui({target,props:{stores,pluginComponents:Array.from(pluginComponents)}});// set up accessors for editor props\nif(!editorProps)editorProps=new Set(getComponentExportedProps(Ui).filter(prop=>!viewPrivateProps.includes(prop)));editorProps.forEach(prop=>{Object.defineProperty(accessors,prop,{get:()=>editor.prop,set:value=>editor[prop]=value});});// set up accessors for plugin props\npluginProps.forEach(prop=>{const plugins=propPluginRef[prop];const plugin=plugins[0];// will always get value from first plugin, when plugins share a property the value will be in sync when set\nObject.defineProperty(accessors,prop,{get:()=>editor.pluginInterface[plugin][prop],set:value=>{const opts=plugins.reduce((prev,plugin)=>{prev[plugin]=_objectSpread(_objectSpread({},editor.pluginOptions[plugin]),{},{[prop]:value});return prev;},{});editor.pluginOptions=_objectSpread(_objectSpread({},editor.pluginOptions),opts);}});});// add element root query\nObject.defineProperty(accessors,'element',{get:()=>editor.root,set:()=>undefined});defineMethods(accessors,{on:(event,cb)=>{if(/undo|redo|revert/.test(event))return editor.history.on(event,cb);const unsubs=[editor.sub(event,cb),editor.$on(event,e=>cb(e instanceof CustomEvent&&!e.detail?undefined:e))].filter(Boolean);return()=>unsubs.forEach(unsub=>unsub());},undo:()=>editor.history.undo(),redo:()=>editor.history.redo(),revert:()=>editor.history.clear(),close:()=>editor.pub('close'),destroy:()=>editor.$destroy()});// clean up on window unload\nif(isBrowser())window.addEventListener('pagehide',()=>editor&&editor.$destroy());return accessors;};var linkAccessors=(destination,origin)=>{const descriptors=Object.getOwnPropertyDescriptors(destination);Object.keys(descriptors).forEach(key=>{// props, set new setter and getter\nif(!!descriptors[key]['get']){Object.defineProperty(origin,key,{get:()=>destination[key],set:value=>destination[key]=value});}// method, copy reference\nelse{origin[key]=destination[key];}});};var editorEvents=[...editorEventsToBubble,'undo','redo','revert','destroy','show','hide','close','selectshape','updateshape','addshape','removeshape'];var hasDoctype=()=>isBrowser()&&document.doctype!==null;var initEditorView=target=>{const accessors={};const{sub,pub}=pubsub();// catch missing doctype\nif(!hasDoctype())console.warn('Missing Document Type Declaration');// create editor core\nconst core=createImageEditor();linkAccessors(core,accessors);// create editor view\nconst view=attachEditorView(target,core.stores);linkAccessors(view,accessors);// listen for UI interaction and link to editor API (internals)\nconst unsubs=['loadImage','processImage','abortProcessImage','abortLoadImage'].map(event=>view.on(event,e=>core[event](e&&e.detail)));// auto subscribes on each possible publisher\nconst subscribe=(event,cb)=>{const unsubInit=sub(event,cb);const unsubCore=core.on(event,cb);const unsubView=view.on(event,cb);return()=>{unsubInit();unsubCore();unsubView();};};// handles every event, useful for routing events from the options object\naccessors.handleEvent=noop;const handleEventUnsubs=editorEvents.map(type=>subscribe(type,res=>accessors.handleEvent(type,res)));// set up new api\ndefineMethods(accessors,{on:subscribe,close:()=>{pub('close');},destroy:()=>{// unsub\n[...unsubs,...handleEventUnsubs].forEach(unsub=>unsub());// destroy\nview.destroy();core.destroy();// destroyed\npub('destroy');}});return accessors;};var appendEditor=(target,options={})=>{const element=isString(target)?document.querySelector(target):target;if(!element)return undefined;options.class=options.class?`doka-image-editor ${options.class}`:'doka-image-editor';const accessors=initEditorView(element);return Object.assign(accessors,options);};var appendEditors=(targets,options={})=>{const elements=isString(targets)?Array.from(document.querySelectorAll(targets)):targets;return elements.filter(Boolean).map(element=>appendEditor(element,deepCopy(options)));};/* src/core/ui/modal/index.svelte generated by Svelte v3.29.4 */const{document:document_1}=globals;function create_fragment$c(ctx){let t;let div;let mounted;let dispose;add_render_callback(/*onwindowresize*/ctx[14]);return{c(){t=space();div=element(\"div\");attr(div,\"class\",\"doka-image-editor DokaModal\");attr(div,\"style\",/*style*/ctx[4]);},m(target,anchor){insert(target,t,anchor);insert(target,div,anchor);/*div_binding*/ctx[15](div);if(!mounted){dispose=[listen(window,\"keydown\",/*handleKey*/ctx[9]),listen(window,\"orientationchange\",/*spawnMeasureElement*/ctx[10]),listen(window,\"resize\",/*onwindowresize*/ctx[14]),listen(document_1.body,\"focusin\",function(){if(is_function(!/*hidden*/ctx[1]&&/*handleFocusIn*/ctx[6]))(!/*hidden*/ctx[1]&&/*handleFocusIn*/ctx[6]).apply(this,arguments);}),listen(document_1.body,\"focusout\",function(){if(is_function(/*hasFocussedTextField*/ctx[2]&&/*handleFocusOut*/ctx[7]))(/*hasFocussedTextField*/ctx[2]&&/*handleFocusOut*/ctx[7]).apply(this,arguments);}),listen(div,\"wheel\",/*handleWheel*/ctx[8])];mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;if(dirty[0]&/*style*/16){attr(div,\"style\",/*style*/ctx[4]);}},i:noop$1,o:noop$1,d(detaching){if(detaching)detach(t);if(detaching)detach(div);/*div_binding*/ctx[15](null);mounted=false;run_all(dispose);}};}function instance$c($$self,$$props,$$invalidate){let $opacity;const dispatch=createEventDispatcher();let{root}=$$props;let{preventZoomViewport=true}=$$props;let hidden=true;let hiding=false;let showing=false;const opacity=spring(0,{precision:0.001,damping:0.5});component_subscribe($$self,opacity,value=>$$invalidate(25,$opacity=value));// animate hide and show\nconst unsub=opacity.subscribe(o=>{if(showing&&o>=1){showing=false;// now shown\n$$invalidate(1,hidden=false);dispatch(\"show\");}else if(hiding&&o<=0){hiding=false;// now hidden\n$$invalidate(1,hidden=true);dispatch(\"hide\");}});// clean up when removed\nonDestroy(()=>unsub());let hasFocussedTextField=false;let viewportDefaults=undefined;let showTimeoutId=undefined;const getViewPortElement=()=>document.querySelector(\"meta[name=viewport]\");const show=()=>{// is visible, or busy becoming visible\nif(showing||!hidden)return;// now in 'showing' transition\nshowing=true;// store default viewport element values\nconst viewportElement=getViewPortElement()||h(\"meta\",{name:\"viewport\"});viewportDefaults=!viewportDefaults&&viewportElement.getAttribute(\"content\");viewportElement.setAttribute(\"content\",viewportRules+(/cover/.test(viewportDefaults)?\",viewport-fit=cover\":\"\"));if(!viewportElement.parentNode)document.head.appendChild(viewportElement);clearTimeout(showTimeoutId);showTimeoutId=setTimeout(()=>set_store_value(opacity,$opacity=1,$opacity),250);};const hide=()=>{// is hiding or already hidden\nif(hiding||hidden)return;// if previous command was show, we need to prevent the timeout from kicking off\nclearTimeout(showTimeoutId);// now in 'hiding' transition\nhiding=true;// get a reference to the viewport element, it should be there as we created it earlier, \n// we restore defaults if the viewport metatag was defined, if not, we destroy it\nconst viewportElement=getViewPortElement();if(viewportDefaults)viewportElement.setAttribute(\"content\",viewportDefaults);else document.head.removeChild(viewportElement);// let's hide!\nset_store_value(opacity,$opacity=0,$opacity);};// handle soft keyboard impact on window height\nlet focusOutTimer;let focusInWindowHeight;const handleFocusIn=e=>{// test if is text input element\nif(!/textarea/i.test(e.target))return;// now focussing a field\n$$invalidate(2,hasFocussedTextField=true);focusInWindowHeight=windowHeight;};const handleFocusOut=e=>{// test if is text input element\nif(!/textarea/i.test(e.target))return;// prevent accidentally setting two timers\nclearTimeout(focusOutTimer);// test if window height changed, if not, no soft keyboard appeared and we can set false to focus state immidiately\nif(focusInWindowHeight===windowHeight){$$invalidate(2,hasFocussedTextField=false);}else// soft keyboard might have appeared, test for window height change before setting unfocus state\n{const windowCurrentHeight=windowHeight;runWhen(()=>windowHeight!==windowCurrentHeight,()=>$$invalidate(2,hasFocussedTextField=false));}};const runWhen=(test,cb)=>{const frame=()=>{if(test()){cb();return;}requestAnimationFrame(frame);};requestAnimationFrame(frame);};// end soft keyboard logic\n// prevent mousewheel from scrolling content behind modal\nconst handleWheel=e=>e.preventDefault();// handle escape to close modal\nconst handleKey=e=>{// get key type\nconst{key}=e;// only deal with escape key\nif(!/escape/i.test(key))return;// don't close when in an input or textuarea\nconst targetElement=e.target;if(targetElement&&/input|textarea/i.test(targetElement.nodeName))return;hide();};// this logic scales modal to fit viewport height\nlet windowHeight=0;let windowHeightComputed;// iOS measure actual page height so we can make optional use of available space\nlet measureElement;let measureElementHeight=undefined;const spawnMeasureElement=()=>{// can't spawn more than one\nif(measureElement)return;measureElement=h(\"div\",{style:\"position:fixed;height:100vh;top:0\"});document.body.appendChild(measureElement);};onMount(()=>{// no need to run this logic if is not on iOS\nif(!isIOS())return;// will be used in first read to determine page height and bottom padding\nspawnMeasureElement();});afterUpdate(()=>{// will only run on iOS\nif(!measureElement)return;// get height and store\n$$invalidate(23,measureElementHeight=measureElement.offsetHeight);// remove measure element\nmeasureElement.parentNode.removeChild(measureElement);measureElement=undefined;});function onwindowresize(){$$invalidate(3,windowHeight=window.innerHeight);}function div_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{root=$$value;$$invalidate(0,root);});}$$self.$$set=$$props=>{if(\"root\"in $$props)$$invalidate(0,root=$$props.root);if(\"preventZoomViewport\"in $$props)$$invalidate(11,preventZoomViewport=$$props.preventZoomViewport);};let viewportRules;let isIOSFooterVisible;let style;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*preventZoomViewport*/2048){viewportRules=\"width=device-width,height=device-height,initial-scale=1\"+(preventZoomViewport?\",maximum-scale=1,user-scalable=0\":\"\");}if($$self.$$.dirty[0]&/*hasFocussedTextField, windowHeight*/12){if(!hasFocussedTextField)$$invalidate(21,windowHeightComputed=windowHeight);}if($$self.$$.dirty[0]&/*measureElementHeight, windowHeight*/8388616){$$invalidate(26,isIOSFooterVisible=isIOS()?`--viewport-pad-footer:${measureElementHeight>windowHeight?0:1}`:\"\");}if($$self.$$.dirty[0]&/*windowHeightComputed, $opacity, isIOSFooterVisible*/102760448){$$invalidate(4,style=`height:${windowHeightComputed}px;opacity:${$opacity};--editor-modal:1;${isIOSFooterVisible}`);}};return[root,hidden,hasFocussedTextField,windowHeight,style,opacity,handleFocusIn,handleFocusOut,handleWheel,handleKey,spawnMeasureElement,preventZoomViewport,show,hide,onwindowresize,div_binding];}class Modal extends SvelteComponent{constructor(options){super();init(this,options,instance$c,create_fragment$c,safe_not_equal,{root:0,preventZoomViewport:11,show:12,hide:13},[-1,-1]);}get root(){return this.$$.ctx[0];}set root(root){this.$set({root});flush();}get preventZoomViewport(){return this.$$.ctx[11];}set preventZoomViewport(preventZoomViewport){this.$set({preventZoomViewport});flush();}get show(){return this.$$.ctx[12];}get hide(){return this.$$.ctx[13];}}// @ts-ignore\n// we export a function that renders the view as to not export svelte component related code to outside the ui dir\nvar createModal=(options={},parent)=>new Modal({target:parent||document.body,props:{preventZoomViewport:options.preventZoomViewport}});var openEditor=(options={},parent)=>{// set up pub/sub for the app layer\nconst{sub,pub}=pubsub();const accessors={};const modal=createModal(options,parent);const hide=()=>{modal.hide();};const show=()=>{modal.show();};const view=initEditorView(modal.root);linkAccessors(view,accessors);// link up handle event\naccessors.handleEvent=noop;view.handleEvent=(type,detail)=>accessors.handleEvent(type,detail);// route close request from view to modal\nview.on('close',hide);const subscribe=(event,cb)=>{// capture modal related events\nif(/show|hide/.test(event))return sub(event,cb);// route rest of events to view\nreturn view.on(event,cb);};const modalHandleEventUnsubs=['show','hide'].map(type=>subscribe(type,detail=>accessors.handleEvent(type,detail)));// cleans up view\nconst destroy=()=>{// unsub\nmodalHandleEventUnsubs.forEach(unsub=>unsub());// remove\nhide();modal.$destroy();view.destroy();};defineMethods(accessors,{on:subscribe,destroy,hide,show});// add element root query\nObject.defineProperty(accessors,'modal',{get:()=>modal.root,set:()=>undefined});// destroy when hidden\nmodal.$on('show',()=>pub('show'));modal.$on('hide',()=>{pub('hide');destroy();});// modal behavior\nview.on('process',hide);view.on('loadstart',show);// test if should\nif(options.enableButtonClose!==false)options.enableButtonClose=true;// update props\nObject.assign(accessors,options);return accessors;};var overlayEditor=(target,options)=>{const editor=appendEditor(target,_objectSpread(_objectSpread({},options),{},{layout:'overlay'}));return editor;};const dispatchElementEvent=(target,event,detail)=>target.dispatchEvent(new CustomEvent(event,{detail,bubbles:true,cancelable:true}));var dispatchEditorEvents=(editor,handler,options={})=>{const{prefix='doka:'}=options;return editorEvents.map(event=>editor.on(event,value=>isElement(handler)?dispatchElementEvent(handler,`${prefix}${event}`,value):handler(event,value)));};const TAG='doka-image-editor';var customElement=()=>new Promise(resolve=>{if(!DokaImageEditorElement)return resolve([]);customElements.define(TAG,DokaImageEditorElement);customElements.whenDefined(TAG).then(()=>resolve(document.querySelectorAll(TAG)));});const DokaImageEditorElement=isBrowser()&&class extends HTMLElement{constructor(){super();this._editor=undefined;this._unsubs=undefined;}static get observedAttributes(){return['src'];}attributeChangedCallback(attrName,oldValue,newValue){this[attrName]=newValue;}connectedCallback(){this._editor=initEditorView(this);linkAccessors(this._editor,this);this._editor.src=this.getAttribute('src');this._unsubs=dispatchEditorEvents(this._editor,this);}disconnectedCallback(){this._editor.destroy();this._unsubs.forEach(unsub=>unsub());}};var arrayInsert=(array,index,item)=>{array.splice(index,0,item);return array;};// first index is always id, so if is string, it's a node\nconst isNode=item=>isString(item[0]);// if it's not a node, it's a nodelist\nconst isNodeList=item=>!isNode(item);const getNodeId=node=>node[1];const getNodeChildren=node=>node[3]||[];const createNode=(instance,id,props={},children=[])=>[instance,id,props,children];const insertNode=(node,needle,haystack,getIndex=index=>index)=>{const nodeList=findNodeList(needle,haystack);const targetIndex=nodeList.findIndex(item=>getNodeId(item)===needle);arrayInsert(nodeList,getIndex(targetIndex),node);};const insertNodeBefore=(node,needle,haystack)=>insertNode(node,needle,haystack);const insertNodeAfter=(node,needle,haystack)=>insertNode(node,needle,haystack,index=>index+1);const appendNode=(node,needle,haystack)=>{const parent=findNode(needle,haystack);getNodeChildren(parent).push(node);return parent;};const removeNode=(needle,haystack)=>{const nodeList=findNodeList(needle,haystack);arrayRemove(nodeList,item=>getNodeId(item)===needle);return nodeList;};const findNode=(needle,haystack)=>{return isNode(haystack)?// haystack is a node, maybe node is a match or one of children is a match\ngetNodeId(haystack)===needle?haystack:findNode(needle,getNodeChildren(haystack)):// haystack is a list of nodes\nhaystack.find(item=>findNode(needle,item));};const findNodeList=(needle,haystack)=>{// haystack is node list\nif(isNodeList(haystack)){// lets search nodes in this haystack\nif(haystack.find(item=>getNodeId(item)===needle))return haystack;// not found, lets move the search to the childnodes\nreturn haystack.find(item=>findNodeList(needle,getNodeChildren(item)));}// is node, lets find in children\nreturn findNodeList(needle,getNodeChildren(haystack));};//#region markup\nconst propertyMap={borderColor:'strokeColor',borderWidth:'strokeWidth',lineWidth:'strokeWidth',fontColor:'color',lineColor:'strokeColor',src:'backgroundImage',fit:'backgroundSize'};const convertValue=value=>{if(value===0)return 0;if(value==='0%')return 0;if(value==='0px')return 0;if(/px$/.test(value))return parseInt(value,10);if(/\\%$/.test(value))return value;if(value<=1)return`${value*100}%`;};const addValues=(a,b)=>{let _a,_b;if(/%$/.test(a)){_a=parseFloat(a);_b=parseFloat(b);return`${_a+_b}%`;}if(/px$/.test(a)){_a=parseInt(a,10);_b=parseInt(b,10);return`${_a+_b}px`;}};const shapeFromLegacyMarkup=(crop,type,style)=>{const shape=Object.keys(style).reduce((res,prop)=>{let value=style[prop];// rename prop\nprop=propertyMap[prop]||prop;// if is px value\nif(/px$/.test(value)){value=convertValue(value);}// if is number convert to percentage\nelse if(/^(?:x|y|left|right|top|bottom|width|height|fontSize|strokeWidth)$/.test(prop)&&typeof value==='number'){if(/strokeWidth/.test(prop))value*=2;value=convertValue(value);}// if is color value\nif(/color/i.test(prop)){value=colorStringToColorArray(value);}if(value===null)value=undefined;res[prop]=value;return res;},{});if(type==='line'){if(shape.lineDecoration.length===1)shape.lineEnd='arrow';if(shape.lineDecoration.length===2)shape.lineStart='arrow';shape.x1=shape.x;shape.y1=shape.y;shape.x2=addValues(shape.x,shape.width);shape.y2=addValues(shape.y,shape.height);delete shape.x;delete shape.y;delete shape.width;delete shape.height;delete shape.lineDecoration;delete shape.lineStyle;}if(type==='text'){shape.y=addValues(shape.y,'-'+shape.fontSize);delete shape.width;delete shape.height;delete shape.borderStyle;}if(type==='ellipse'){let w,h;// calculate `rx` and `ry` based on `width` and `h`eight`\nif(/%$/.test(shape.width)){w=parseFloat(shape.width)/100;h=parseFloat(shape.height)/100;const widthAbsolute=w*crop.width;const heightAbsolute=h*crop.height;w=widthAbsolute/crop.width*100;h=heightAbsolute/crop.height*100;}else{w=shape.width;h=shape.height;}shape.rx=w*0.5;shape.ry=h*0.5;if(/%$/.test(shape.width)){shape.rx+='%';shape.ry+='%';}shape.x=addValues(shape.x,shape.rx);shape.y=addValues(shape.y,shape.ry);delete shape.width;delete shape.height;delete shape.borderStyle;}if(type==='rect'){delete shape.borderStyle;}if(type==='path'){shape.points=shape.points.map(point=>{return{x:convertValue(point.x),y:convertValue(point.y)};});}return shape;};//#endregion\n//#region crop\nconst getOffsetPointOnEdge=(length,rotation)=>{const a=length;const A=1.5707963267948966;const B=rotation;const C=1.5707963267948966-rotation;const sinA=Math.sin(A);const sinB=Math.sin(B);const sinC=Math.sin(C);const cosC=Math.cos(C);const ratio=a/sinA;const b=ratio*sinB;const c=ratio*sinC;return vectorCreate(cosC*b,cosC*c);};const getRotatedRectSize=(rect,rotation)=>{const w=rect.width;const h=rect.height;const hor=getOffsetPointOnEdge(w,rotation);const ver=getOffsetPointOnEdge(h,rotation);const tl=vectorCreate(rect.x+Math.abs(hor.x),rect.y-Math.abs(hor.y));const tr=vectorCreate(rect.x+rect.width+Math.abs(ver.y),rect.y+Math.abs(ver.x));const bl=vectorCreate(rect.x-Math.abs(ver.y),rect.y+rect.height-Math.abs(ver.x));return{width:vectorDistance(tl,tr),height:vectorDistance(tl,bl)};};const getBoundsAroundCenter=(imageSize,center)=>{const cx=center.x>0.5?1-center.x:center.x;const cy=center.y>0.5?1-center.y:center.y;return sizeCreate(cx*2*imageSize.width,cy*2*imageSize.height);};const getCanvasSize=(imageSize,canvasAspectRatio,zoom=1)=>{const imageAspectRatio=imageSize.height/imageSize.width;// determine actual pixels on x and y axis\nlet canvasWidth=1;let canvasHeight=canvasAspectRatio;let imgWidth=1;let imgHeight=imageAspectRatio;if(imgHeight>canvasHeight){imgHeight=canvasHeight;imgWidth=imgHeight/imageAspectRatio;}const scalar=Math.max(canvasWidth/imgWidth,canvasHeight/imgHeight);const width=imageSize.width/(zoom*scalar*imgWidth);const height=width*canvasAspectRatio;return{width:width,height:height};};const getCenteredCropRect=(imageSize,aspectRatio)=>{let width=imageSize.width;let height=width*aspectRatio;if(height>imageSize.height){height=imageSize.height;width=height/aspectRatio;}const x=(imageSize.width-width)*0.5;const y=(imageSize.height-height)*0.5;return rectCreate(x,y,width,height);};const getCorrectedLegacyAspectRatio=(imageSize,aspectRatio)=>aspectRatio!=null?// fox the aspect ratio\n1/aspectRatio:// set image aspect ratio\nimageSize.width/imageSize.height;const imagePropertiesFromLegacyCrop=(imageSize,{flip,aspectRatio,rotation,center,zoom,scaleToFit})=>{const res={};// is centered crop\nconst isCenteredCrop=!center||center&&center.x===0.5&&center.y===0.5;// handle basic props\nif(flip&&flip.horizontal)res.flipHorizontal=flip.horizontal;if(flip&&flip.vertical)res.flipVertical=flip.vertical;// fix aspect ratio, in FilePond and Doka classic it's height/width instead of width/height\nconst correctedAspectRatio=getCorrectedLegacyAspectRatio(imageSize,aspectRatio);// image bounds\nconst cropLimit=!(scaleToFit===false);const canvasSize=getCanvasSize(imageSize,aspectRatio,zoom);const cropSize=isCenteredCrop?imageSize:getBoundsAroundCenter(imageSize,cropLimit?center:{x:0.5,y:0.5});const cropCentered=getCenteredCropRect(imageSize,aspectRatio);// has different aspect ratio than image\nif(aspectRatio||!isCenteredCrop||zoom){res.crop=rectContainRect(rectCreateFromSize(cropSize),correctedAspectRatio);}if(typeof rotation==='number'&&rotation!==null){if(rotation!=null)res.rotation=rotation;const rotatedCropSize=getRotatedRectSize(cropCentered,rotation);const scalar=Math.max(rotatedCropSize.width/cropSize.width,rotatedCropSize.height/cropSize.height);// window.clear();\n// crop position in non-rotated image\nconst cropCenter=vectorCreate(center.x*imageSize.width,center.y*imageSize.height);// const imageCenter = sizeCenter(imageSize);\n// const imageCenterToCropCenter = vectorCreate(\n//     imageCenter.x - cropCenter.x,\n//     imageCenter.y - cropCenter.y\n// );\n// get rotated image center\nconst rotatedImageSize=getImageTransformedRect(imageSize,rotation);const rotatedImageCenter=sizeCenter(rotatedImageSize);const rotatedImageOffset=vectorCreate((rotatedImageSize.width-imageSize.width)*0.5,(rotatedImageSize.height-imageSize.height)*0.5);// window.draw(rotatedImageCenter, 'red');\n// window.draw(rotatedImageSize, 'red');\n// window.draw(\n//     {\n//         x: rotatedImageOffset.x,\n//         y: rotatedImageOffset.y,\n//         width: imageSize.width,\n//         height: imageSize.height,\n//     },\n//     'cyan'\n// );\n// const imagePoints = rectRotate(\n//     rectCreate(\n//         rotatedImageOffset.x,\n//         rotatedImageOffset.y,\n//         imageSize.width,\n//         imageSize.height\n//     ),\n//     rotation\n// );\n// window.draw(imagePoints, 'orange');\nconst cropPoints=rectRotate({x:rotatedImageOffset.x+cropCenter.x-canvasSize.width/scalar*0.5,y:rotatedImageOffset.y+cropCenter.y-canvasSize.height/scalar*0.5,width:canvasSize.width/scalar,height:canvasSize.height/scalar},rotation);// window.draw(cropPoints, 'cyan');\nconst cropBoundsPoints=vectorsRotate(cropPoints.map(vectorClone),rotation,rotatedImageCenter.x,rotatedImageCenter.y);// window.draw(cropBoundsPoints, 'orange');\nconst cropBoundsPointsCenter=rectCenter(rectCreateFromPoints(cropBoundsPoints));// window.draw(cropBoundsPointsCenter, 'green');\nconst deRotatedCropBoundsPoints=vectorsRotate(cropBoundsPoints.map(vectorClone),-(rotation*2),cropBoundsPointsCenter.x,cropBoundsPointsCenter.y);// window.draw(deRotatedCropBoundsPoints, 'green');\nres.crop=rectCreateFromPoints(deRotatedCropBoundsPoints);}else if(zoom!=null){rectScale(res.crop,1/zoom);}if(!cropLimit){res.cropLimitToImage=false;}return res;};//#endregion\nconst isLegacyData=(data={})=>{if('markup'in data||'color'in data||'filter'in data)return true;const{crop}=data;if(crop&&('flip'in crop||'center'in crop||'aspectRatio'in crop||'rotation'in crop))return true;return false;};var legacyDataToImageState=(editor,imageSize,data={})=>{const res={};// test if isn't legacy data\nif(!isLegacyData(data))return data;if(data.crop){Object.assign(res,imagePropertiesFromLegacyCrop(imageSize,data.crop));}if(data.markup){res.decoration=data.markup.map(markup=>shapeFromLegacyMarkup(res.crop||imageSize,markup[0],markup[1])).sort((a,b)=>{if(a.zIndex<b.zIndex)return-1;if(a.zIndex>b.zIndex)return 1;return 0;}).map(shape=>{delete shape.zIndex;return shape;});}if(data.color){res.colorMatrix={brightness:data.color.brightness.matrix,contrast:data.color.contrast.matrix,exposure:data.color.exposure.matrix,saturation:data.color.saturation.matrix};}if(data.filter){if(!res.colorMatrix)res.colorMatrix={};res.colorMatrix.filter=typeof data.filter==='string'&&editor['filterFunctions'][data.filter]?editor['filterFunctions'][data.filter]():data.filter.matrix;}return res;};const isOperaMini=()=>Object.prototype.toString.call(window['operamini'])==='[object OperaMini]';const hasPromises=()=>'Promise'in window;const hasCreateObjectURL=()=>'URL'in window&&'createObjectURL'in window.URL;const hasVisibility=()=>'visibilityState'in document;const hasTiming=()=>'performance'in window;// iOS 8.x\nconst hasFileConstructor=()=>'File'in window;// excludes IE11\nlet result$a=null;var isModernBrowser=()=>{if(result$a===null)result$a=isBrowser()&&// Can't run on Opera Mini due to lack of everything\n!isOperaMini()&&// Require these APIs to feature detect a modern browser\nhasVisibility()&&hasPromises()&&hasFileConstructor()&&hasCreateObjectURL()&&hasTiming();return result$a;};const toPercentageNumber=v=>Math.round(v*100);const brightness={base:0,min:-0.25,max:0.25,getLabel:value=>{return toPercentageNumber(value/0.25);},getStore:({imageColorMatrix})=>imageColorMatrix,getValue:store=>{if(!store.brightness)return;return store.brightness[4];},setValue:(store,v)=>store.update(matrices=>_objectSpread(_objectSpread({},matrices),{},{// prettier-ignore\nbrightness:[1,0,0,0,v,0,1,0,0,v,0,0,1,0,v,0,0,0,1,0]}))};const contrast={base:1,min:0.5,max:1.5,getLabel:value=>{return toPercentageNumber(-1+(value-0.5)*2);},getStore:({imageColorMatrix})=>imageColorMatrix,getValue:store=>{if(!store.contrast)return;return store.contrast[0];},setValue:(store,v)=>store.update(matrices=>_objectSpread(_objectSpread({},matrices),{},{// prettier-ignore\ncontrast:[v,0,0,0,.5*(1-v),0,v,0,0,.5*(1-v),0,0,v,0,.5*(1-v),0,0,0,1,0]}))};const saturation={base:1,min:0,max:2,getLabel:value=>{return toPercentageNumber(value-1);},getStore:({imageColorMatrix})=>imageColorMatrix,getValue:store=>{if(!store.saturation)return;return(store.saturation[0]-0.213)/0.787;},setValue:(store,v)=>store.update(matrices=>_objectSpread(_objectSpread({},matrices),{},{// prettier-ignore\nsaturation:[.213+.787*v,.715-.715*v,.072-.072*v,0,0,.213-.213*v,.715+.285*v,.072-.072*v,0,0,.213-.213*v,.715-.715*v,.072+.928*v,0,0,0,0,0,1,0]}))};const exposure={base:1,min:0.5,max:1.5,getLabel:value=>{return toPercentageNumber(-1+(value-0.5)*2);},getStore:({imageColorMatrix})=>imageColorMatrix,getValue:store=>{if(!store.exposure)return;return store.exposure[0];},setValue:(store,v)=>store.update(matrices=>_objectSpread(_objectSpread({},matrices),{},{// prettier-ignore\nexposure:[v,0,0,0,0,0,v,0,0,0,0,0,v,0,0,0,0,0,1,0]}))};const gamma={base:1,min:0.15,max:4,getLabel:value=>{if(value<1){return toPercentageNumber((value-0.15)/0.85-1);}return toPercentageNumber((value-1)/3);},getStore:({imageGamma})=>imageGamma};const vignette={base:0,min:-1,max:1,getStore:({imageVignette})=>imageVignette};const clarity={base:0,min:-1,max:1,getStore:({imageConvolutionMatrix})=>imageConvolutionMatrix,getValue:store=>{if(!store.clarity)return;if(store.clarity[0]===0){return store.clarity[1]/-1;}else{return store.clarity[1]/-2;}},setValue:(store,v)=>{store.update(matrices=>_objectSpread(_objectSpread({},matrices),{},{// prettier-ignore\nclarity:v>=0?[0,-1*v,0,-1*v,1+4*v,-1*v,0,-1*v,0]:[-1*v,-2*v,-1*v,-2*v,1+-3*v,-2*v,-1*v,-2*v,-1*v]}));}};const temperature={base:0,min:-1,max:1,getStore:({imageColorMatrix})=>imageColorMatrix,getValue:store=>{if(!store.temperature)return;const v=store.temperature[0];if(v>=1){return(v-1)/0.1;}return(1-v)/-0.15;},setValue:(store,v)=>store.update(matrices=>_objectSpread(_objectSpread({},matrices),{},{// prettier-ignore\ntemperature:v>0?[1+v*.1,0,0,0,0,0,1,0,0,0,0,0,1+-v*.1,0,0,0,0,0,1,0]:[1+v*.15,0,0,0,0,0,1+v*.05,0,0,0,0,0,1+-v*.15,0,0,0,0,0,1,0]}))};const finetuneControlConfigurationDefault={gamma,brightness,contrast,saturation,exposure,temperature,clarity,vignette};const finetuneOptionsDefault=[['brightness',locale=>locale.finetuneLabelBrightness],['contrast',locale=>locale.finetuneLabelContrast],['saturation',locale=>locale.finetuneLabelSaturation],['exposure',locale=>locale.finetuneLabelExposure],['temperature',locale=>locale.finetuneLabelTemperature],['gamma',locale=>locale.finetuneLabelGamma],['clarity',locale=>locale.finetuneLabelClarity],['vignette',locale=>locale.finetuneLabelVignette]];var defaults={finetuneControlConfiguration:finetuneControlConfigurationDefault,finetuneOptions:finetuneOptionsDefault};/*\nTODO: fix inverse fn in getValue\nexport const hue = {\n    base: 0,\n    min: 0,\n    max: Math.PI,\n    getStore: ({ imageColorMatrix }) => imageColorMatrix,\n    getValue: (store) => {\n        if (!store.hue) return;\n\n        const v = store.hue[1];\n\n        const o = -(Math.acos((0.715 - v) / Math.sqrt(2) / 0.715) - Math.PI / 4);\n\n        return o;\n    },\n    setValue: (store, v: number) => {\n        store.update((matrices) => {\n            // const value = v * (Math.PI);\n\n            const cos = Math.cos(v);\n            const sin = Math.sin(v);\n\n            const a00 = 0.213 + cos * 0.787 - sin * 0.213;\n            const a01 = 0.715 - cos * 0.715 - sin * 0.715;\n            const a02 = 0.072 - cos * 0.072 + sin * 0.928;\n            const a10 = 0.213 - cos * 0.213 + sin * 0.143;\n            const a11 = 0.715 + cos * 0.285 + sin * 0.14;\n            const a12 = 0.072 - cos * 0.072 - sin * 0.283;\n            const a20 = 0.213 - cos * 0.213 - sin * 0.787;\n            const a21 = 0.715 - cos * 0.715 + sin * 0.715;\n            const a22 = 0.072 + cos * 0.928 + sin * 0.072;\n\n            return {\n                ...matrices,\n\n                // prettier-ignore\n                hue: [\n                    a00, a01, a02, 0, 0,\n                    a10, a11, a12, 0, 0,\n                    a20, a21, a22, 0, 0,\n                      0,   0,   0, 1, 0,\n                ]\n            };\n        });\n    },\n};\n*/const pastel=()=>// prettier-ignore\n[0.75,0.25,0.25,0,0,0.25,0.75,0.25,0,0,0.25,0.25,0.75,0,0,0,0,0,1,0];const chrome=()=>// prettier-ignore\n[1.398,-0.316,0.065,-0.273,0.201,-0.051,1.278,-0.080,-0.273,0.201,-0.051,0.119,1.151,-0.290,0.215,0,0,0,1,0];const fade$1=()=>// prettier-ignore\n[1.073,-0.015,0.092,-0.115,-0.017,0.107,0.859,0.184,-0.115,-0.017,0.015,0.077,1.104,-0.115,-0.017,0,0,0,1,0];const warm=()=>// prettier-ignore\n[1.06,0,0,0,0,0,1.01,0,0,0,0,0,0.93,0,0,0,0,0,1,0];const cold=()=>// prettier-ignore\n[1.1,0,0,0,-.1,0,1.1,0,0,-.1,0,0,1.2,0,-.1,0,0,0,1,0];const invert=()=>// prettier-ignore\n[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];const monoDefault=()=>// prettier-ignore\n[0.212,0.715,0.114,0,0,0.212,0.715,0.114,0,0,0.212,0.715,0.114,0,0,0,0,0,1,0];const monoNoir=()=>// prettier-ignore\n[0.15,1.3,-0.25,0.1,-0.2,0.15,1.3,-0.25,0.1,-0.2,0.15,1.3,-0.25,0.1,-0.2,0,0,0,1,0];const monoWash=()=>// prettier-ignore\n[0.163,0.518,0.084,-0.010,0.208,0.163,0.529,0.082,-0.020,0.210,0.171,0.529,0.084,0.000,0.214,0.000,0.000,0.000,1.000,0.000];const monoStark=()=>// prettier-ignore\n[0.338,0.991,0.117,0.093,-0.196,0.302,1.049,0.096,0.078,-0.196,0.286,1.016,0.146,0.101,-0.196,0.000,0.000,0.000,1.000,0.000];const sepiaDefault=()=>// prettier-ignore\n[0.393,0.768,0.188,0,0,0.349,0.685,0.167,0,0,0.272,0.533,0.130,0,0,0,0,0,1,0];const sepiaBlues=()=>// prettier-ignore\n[0.289,0.620,0.185,0.000,0.077,0.257,0.566,0.163,0.000,0.115,0.200,0.430,0.128,0.000,0.188,0.000,0.000,0.000,1.000,0.000];const sepiaRust=()=>// prettier-ignore\n[0.269,0.764,0.172,0.050,0.100,0.239,0.527,0.152,0.000,0.176,0.186,0.400,0.119,0.000,0.159,0.000,0.000,0.000,1.000,0.000];const sepiaColor=()=>// prettier-ignore\n[0.547,0.764,0.134,0.000,-0.147,0.281,0.925,0.120,0.000,-0.135,0.225,0.558,0.330,0.000,-0.113,0.000,0.000,0.000,1.000,0.000];//\n// default filter set\n//\nconst filterFunctionsDefault={chrome,fade:fade$1,pastel,cold,warm,monoDefault,monoWash,monoNoir,monoStark,sepiaDefault,sepiaRust,sepiaBlues,sepiaColor};const filterOptionsDefault=[['Default',[[undefined,locale=>locale.labelDefault]]],['Classic',[['chrome',locale=>locale.filterLabelChrome],['fade',locale=>locale.filterLabelFade],['cold',locale=>locale.filterLabelCold],['warm',locale=>locale.filterLabelWarm],['pastel',locale=>locale.filterLabelPastel]]],['Monochrome',[['monoDefault',locale=>locale.filterLabelMonoDefault],['monoNoir',locale=>locale.filterLabelMonoNoir],['monoStark',locale=>locale.filterLabelMonoStark],['monoWash',locale=>locale.filterLabelMonoWash]]],['Sepia',[['sepiaDefault',locale=>locale.filterLabelSepiaDefault],['sepiaRust',locale=>locale.filterLabelSepiaRust],['sepiaBlues',locale=>locale.filterLabelSepiaBlues],['sepiaColor',locale=>locale.filterLabelSepiaColor]]]];var defaults$1={filterFunctions:filterFunctionsDefault,filterOptions:filterOptionsDefault};// if this is a non retina display snap to pixel\nlet fn=null;var snapToPixel=v=>{if(fn===null)fn=getDevicePixelRatio()===1?v=>Math.round(v):v=>v;return fn(v);};/* src/core/ui/components/Details.svelte generated by Svelte v3.29.4 */const get_details_slot_changes=dirty=>({});const get_details_slot_context=ctx=>({});const get_label_slot_changes=dirty=>({});const get_label_slot_context=ctx=>({});// (167:0) <Button bind:this={buttonComponent}      class={arrayJoin(['DokaDetailsButton', buttonClass])}      onkeydown={handleButtonKeydown}      onclick={handleClick}>\nfunction create_default_slot$2(ctx){let current;const label_slot_template=/*#slots*/ctx[19].label;const label_slot=create_slot(label_slot_template,ctx,/*$$scope*/ctx[23],get_label_slot_context);return{c(){if(label_slot)label_slot.c();},m(target,anchor){if(label_slot){label_slot.m(target,anchor);}current=true;},p(ctx,dirty){if(label_slot){if(label_slot.p&&dirty[0]&/*$$scope*/8388608){update_slot(label_slot,label_slot_template,ctx,/*$$scope*/ctx[23],dirty,get_label_slot_changes,get_label_slot_context);}}},i(local){if(current)return;transition_in(label_slot,local);current=true;},o(local){transition_out(label_slot,local);current=false;},d(detaching){if(label_slot)label_slot.d(detaching);}};}// (174:0) {#if isVisible}\nfunction create_if_block_1$2(ctx){let div;let div_class_value;let measure_action;let current;let mounted;let dispose;const details_slot_template=/*#slots*/ctx[19].details;const details_slot=create_slot(details_slot_template,ctx,/*$$scope*/ctx[23],get_details_slot_context);return{c(){div=element(\"div\");if(details_slot)details_slot.c();attr(div,\"class\",div_class_value=arrayJoin([\"DokaDetailsPanel\",/*panelClass*/ctx[1]]));attr(div,\"tabindex\",\"-1\");attr(div,\"style\",/*style*/ctx[6]);},m(target,anchor){insert(target,div,anchor);if(details_slot){details_slot.m(div,null);}/*div_binding*/ctx[21](div);current=true;if(!mounted){dispose=[listen(div,\"keydown\",/*handlePanelKeydown*/ctx[16]),listen(div,\"measure\",/*measure_handler*/ctx[22]),action_destroyer(measure_action=measurable.call(null,div))];mounted=true;}},p(ctx,dirty){if(details_slot){if(details_slot.p&&dirty[0]&/*$$scope*/8388608){update_slot(details_slot,details_slot_template,ctx,/*$$scope*/ctx[23],dirty,get_details_slot_changes,get_details_slot_context);}}if(!current||dirty[0]&/*panelClass*/2&&div_class_value!==(div_class_value=arrayJoin([\"DokaDetailsPanel\",/*panelClass*/ctx[1]]))){attr(div,\"class\",div_class_value);}if(!current||dirty[0]&/*style*/64){attr(div,\"style\",/*style*/ctx[6]);}},i(local){if(current)return;transition_in(details_slot,local);current=true;},o(local){transition_out(details_slot,local);current=false;},d(detaching){if(detaching)detach(div);if(details_slot)details_slot.d(detaching);/*div_binding*/ctx[21](null);mounted=false;run_all(dispose);}};}function create_fragment$d(ctx){let t0;let button;let t1;let t2;let if_block1_anchor;let current;let mounted;let dispose;let button_props={class:arrayJoin([\"DokaDetailsButton\",/*buttonClass*/ctx[0]]),onkeydown:/*handleButtonKeydown*/ctx[15],onclick:/*handleClick*/ctx[14],$$slots:{default:[create_default_slot$2]},$$scope:{ctx}};button=new Button({props:button_props});/*button_binding*/ctx[20](button);let if_block0=/*isVisible*/ctx[5]&&create_if_block_1$2(ctx);let if_block1=false;return{c(){t0=space();create_component(button.$$.fragment);t1=space();if(if_block0)if_block0.c();t2=space();if_block1_anchor=empty();},m(target,anchor){insert(target,t0,anchor);mount_component(button,target,anchor);insert(target,t1,anchor);if(if_block0)if_block0.m(target,anchor);insert(target,t2,anchor);insert(target,if_block1_anchor,anchor);current=true;if(!mounted){dispose=[listen(document.body,\"pointerdown\",function(){if(is_function(/*handleDown*/ctx[7]))/*handleDown*/ctx[7].apply(this,arguments);}),listen(document.body,\"pointerup\",function(){if(is_function(/*handleUp*/ctx[8]))/*handleUp*/ctx[8].apply(this,arguments);})];mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;const button_changes={};if(dirty[0]&/*buttonClass*/1)button_changes.class=arrayJoin([\"DokaDetailsButton\",/*buttonClass*/ctx[0]]);if(dirty[0]&/*$$scope*/8388608){button_changes.$$scope={dirty,ctx};}button.$set(button_changes);if(/*isVisible*/ctx[5]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*isVisible*/32){transition_in(if_block0,1);}}else{if_block0=create_if_block_1$2(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t2.parentNode,t2);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}},i(local){if(current)return;transition_in(button.$$.fragment,local);transition_in(if_block0);transition_in(if_block1);current=true;},o(local){transition_out(button.$$.fragment,local);transition_out(if_block0);transition_out(if_block1);current=false;},d(detaching){if(detaching)detach(t0);/*button_binding*/ctx[20](null);destroy_component(button,detaching);if(detaching)detach(t1);if(if_block0)if_block0.d(detaching);if(detaching)detach(t2);if(detaching)detach(if_block1_anchor);mounted=false;run_all(dispose);}};}let panelMargin=12;function instance$d($$self,$$props,$$invalidate){let $portalRootRect;let $position;let $opacity;let $offset;let $portal;let{$$slots:slots={},$$scope}=$$props;let{buttonClass=undefined}=$$props;let{panelClass=undefined}=$$props;let{isActive=false}=$$props;let{onshow=({panel})=>panel.focus()}=$$props;const portal=getContext(\"rootPortal\");component_subscribe($$self,portal,value=>$$invalidate(35,$portal=value));const portalRootRect=getContext(\"rootRect\");component_subscribe($$self,portalRootRect,value=>$$invalidate(29,$portalRootRect=value));let panelSize;let buttonComponent;let buttonRect;let dir=vectorCreateEmpty();let opacity=spring(0);component_subscribe($$self,opacity,value=>$$invalidate(31,$opacity=value));const position=writable({x:0,y:0});component_subscribe($$self,position,value=>$$invalidate(30,$position=value));const offset=spring(-5);component_subscribe($$self,offset,value=>$$invalidate(34,$offset=value));const isTargetSelf=e=>isEventTarget(e,$portal)||buttonComponent.isEventTarget(e);let downOutsidePanel=false;// move detail panel to portal\nlet detailPanel;let trigger;// test keydown press to open\nconst handleClick=e=>{if(!isActive)$$invalidate(24,buttonRect=buttonElement.getBoundingClientRect());$$invalidate(27,trigger=e);$$invalidate(17,isActive=!isActive);};const handleButtonKeydown=e=>{if(!/down/i.test(e.key))return;$$invalidate(17,isActive=true);$$invalidate(27,trigger=e);};const handlePanelKeydown=e=>{if(!/esc/i.test(e.key))return;$$invalidate(17,isActive=false);buttonElement.focus();};// clean up panel if it was appended to a portal\nonDestroy(()=>{if(!$portal||!detailPanel)return;$portal.removeChild(detailPanel);});function button_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{buttonComponent=$$value;$$invalidate(3,buttonComponent);});}function div_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{detailPanel=$$value;$$invalidate(4,detailPanel);});}const measure_handler=e=>$$invalidate(2,panelSize=sizeCreateFromAny(e.detail));$$self.$$set=$$props=>{if(\"buttonClass\"in $$props)$$invalidate(0,buttonClass=$$props.buttonClass);if(\"panelClass\"in $$props)$$invalidate(1,panelClass=$$props.panelClass);if(\"isActive\"in $$props)$$invalidate(17,isActive=$$props.isActive);if(\"onshow\"in $$props)$$invalidate(18,onshow=$$props.onshow);if(\"$$scope\"in $$props)$$invalidate(23,$$scope=$$props.$$scope);};let buttonElement;let isVisible;let isAnimating;let transform;let style;let handleDown;let handleUp;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*buttonComponent*/8){buttonElement=buttonComponent&&buttonComponent.getElement();}if($$self.$$.dirty[0]&/*isActive, downOutsidePanel*/67239936){$$invalidate(8,handleUp=isActive?e=>{if(!downOutsidePanel)return;$$invalidate(26,downOutsidePanel=false);if(isTargetSelf(e))return;$$invalidate(17,isActive=false);}:undefined);}if($$self.$$.dirty[0]&/*isActive*/131072){opacity.set(isActive?1:0);}if($$self.$$.dirty[0]&/*isActive*/131072){offset.set(isActive?0:-5);}if($$self.$$.dirty[0]&/*$portalRootRect, panelSize, buttonRect*/553648132){if($portalRootRect&&panelSize&&buttonRect){// as a starting point we'll align panel to center of button and position below\nlet x=buttonRect.x-$portalRootRect.x+buttonRect.width*0.5-panelSize.width*0.5;let y=buttonRect.y-$portalRootRect.y+buttonRect.height;const parentLeft=panelMargin;const parentTop=panelMargin;const parentRight=$portalRootRect.width-panelMargin;const parentBottom=$portalRootRect.height-panelMargin;const panelLeft=x;const panelTop=y;const panelRight=panelLeft+panelSize.width;const panelBottom=panelTop+panelSize.height;// move to right\nif(panelLeft<parentLeft){x=parentLeft;}// move to left\nif(panelRight>parentRight){x=parentRight-panelSize.width;}if(panelBottom>parentBottom){// doesn't fit vertically, push up\n$$invalidate(25,dir.y=-1,dir);const positionedAboveButtonY=y-panelSize.height-buttonRect.height;const panelFitsAboveButton=parentTop<positionedAboveButtonY;if(panelFitsAboveButton){y-=panelSize.height+buttonRect.height;}else{// overlap with button\ny-=panelBottom-parentBottom;}}else{// all is fine\n$$invalidate(25,dir.y=1,dir);}set_store_value(position,$position=vectorApply(vectorCreate(x,y),snapToPixel),$position);}}if($$self.$$.dirty[1]&/*$opacity*/1){$$invalidate(5,isVisible=$opacity>0);}if($$self.$$.dirty[1]&/*$opacity*/1){$$invalidate(32,isAnimating=$opacity<1);}if($$self.$$.dirty[0]&/*$position, dir*/1107296256|$$self.$$.dirty[1]&/*$offset*/8){$$invalidate(33,transform=`translateX(${$position.x+dir.x*panelMargin}px) translateY(${$position.y+dir.y*panelMargin+dir.y*$offset}px)`);}if($$self.$$.dirty[1]&/*isAnimating, $opacity, transform*/7){$$invalidate(6,style=isAnimating?`opacity: ${$opacity}; pointer-events: ${$opacity<1?\"none\":\"all\"}; transform: ${transform};`:`transform: ${transform}`);}if($$self.$$.dirty[0]&/*isActive*/131072){$$invalidate(7,handleDown=isActive?e=>{if(isTargetSelf(e))return;$$invalidate(26,downOutsidePanel=true);}:undefined);}if($$self.$$.dirty[0]&/*isVisible, detailPanel*/48|$$self.$$.dirty[1]&/*$portal*/16){if(isVisible&&$portal&&detailPanel&&detailPanel.parentNode!==$portal)$portal.appendChild(detailPanel);}if($$self.$$.dirty[0]&/*isActive*/131072){if(!isActive)$$invalidate(27,trigger=undefined);}if($$self.$$.dirty[0]&/*isVisible, detailPanel, onshow, trigger*/134479920){if(isVisible&&detailPanel)onshow({e:trigger,panel:detailPanel});}};return[buttonClass,panelClass,panelSize,buttonComponent,detailPanel,isVisible,style,handleDown,handleUp,portal,portalRootRect,opacity,position,offset,handleClick,handleButtonKeydown,handlePanelKeydown,isActive,onshow,slots,button_binding,div_binding,measure_handler,$$scope];}class Details extends SvelteComponent{constructor(options){super();init(this,options,instance$d,create_fragment$d,safe_not_equal,{buttonClass:0,panelClass:1,isActive:17,onshow:18},[-1,-1]);}}/* src/core/ui/components/RadioItem.svelte generated by Svelte v3.29.4 */function create_fragment$e(ctx){let li;let input;let t;let label_1;let li_class_value;let current;let mounted;let dispose;const default_slot_template=/*#slots*/ctx[14].default;const default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[13],null);return{c(){li=element(\"li\");input=element(\"input\");t=space();label_1=element(\"label\");if(default_slot)default_slot.c();attr(input,\"type\",\"radio\");attr(input,\"class\",\"implicit\");attr(input,\"id\",/*inputId*/ctx[6]);attr(input,\"name\",/*name*/ctx[0]);input.value=/*value*/ctx[3];input.disabled=/*disabled*/ctx[5];input.checked=/*checked*/ctx[4];attr(label_1,\"for\",/*inputId*/ctx[6]);attr(label_1,\"title\",/*label*/ctx[2]);attr(li,\"class\",li_class_value=arrayJoin([\"DokaRadioGroupOption\",/*klass*/ctx[1]]));attr(li,\"data-disabled\",/*disabled*/ctx[5]);attr(li,\"data-selected\",/*checked*/ctx[4]);},m(target,anchor){insert(target,li,anchor);append(li,input);append(li,t);append(li,label_1);if(default_slot){default_slot.m(label_1,null);}current=true;if(!mounted){dispose=[listen(input,\"change\",stop_propagation(/*change_handler*/ctx[15])),listen(input,\"keydown\",/*handleKeydown*/ctx[8]),listen(input,\"click\",/*handleClick*/ctx[9])];mounted=true;}},p(ctx,[dirty]){if(!current||dirty&/*inputId*/64){attr(input,\"id\",/*inputId*/ctx[6]);}if(!current||dirty&/*name*/1){attr(input,\"name\",/*name*/ctx[0]);}if(!current||dirty&/*value*/8){input.value=/*value*/ctx[3];}if(!current||dirty&/*disabled*/32){input.disabled=/*disabled*/ctx[5];}if(!current||dirty&/*checked*/16){input.checked=/*checked*/ctx[4];}if(default_slot){if(default_slot.p&&dirty&/*$$scope*/8192){update_slot(default_slot,default_slot_template,ctx,/*$$scope*/ctx[13],dirty,null,null);}}if(!current||dirty&/*inputId*/64){attr(label_1,\"for\",/*inputId*/ctx[6]);}if(!current||dirty&/*label*/4){attr(label_1,\"title\",/*label*/ctx[2]);}if(!current||dirty&/*klass*/2&&li_class_value!==(li_class_value=arrayJoin([\"DokaRadioGroupOption\",/*klass*/ctx[1]]))){attr(li,\"class\",li_class_value);}if(!current||dirty&/*disabled*/32){attr(li,\"data-disabled\",/*disabled*/ctx[5]);}if(!current||dirty&/*checked*/16){attr(li,\"data-selected\",/*checked*/ctx[4]);}},i(local){if(current)return;transition_in(default_slot,local);current=true;},o(local){transition_out(default_slot,local);current=false;},d(detaching){if(detaching)detach(li);if(default_slot)default_slot.d(detaching);mounted=false;run_all(dispose);}};}function instance$e($$self,$$props,$$invalidate){let $keysPressedStored;let{$$slots:slots={},$$scope}=$$props;let{name}=$$props;let{class:klass=undefined}=$$props;let{label}=$$props;let{id}=$$props;let{value}=$$props;let{checked}=$$props;let{onkeydown}=$$props;let{onclick}=$$props;let{disabled=false}=$$props;const keysPressedStored=getContext(\"keysPressed\");component_subscribe($$self,keysPressedStored,value=>$$invalidate(16,$keysPressedStored=value));const handleKeydown=e=>{onkeydown(e);};const handleClick=e=>{if($keysPressedStored.length)return;onclick(e);};function change_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"name\"in $$props)$$invalidate(0,name=$$props.name);if(\"class\"in $$props)$$invalidate(1,klass=$$props.class);if(\"label\"in $$props)$$invalidate(2,label=$$props.label);if(\"id\"in $$props)$$invalidate(10,id=$$props.id);if(\"value\"in $$props)$$invalidate(3,value=$$props.value);if(\"checked\"in $$props)$$invalidate(4,checked=$$props.checked);if(\"onkeydown\"in $$props)$$invalidate(11,onkeydown=$$props.onkeydown);if(\"onclick\"in $$props)$$invalidate(12,onclick=$$props.onclick);if(\"disabled\"in $$props)$$invalidate(5,disabled=$$props.disabled);if(\"$$scope\"in $$props)$$invalidate(13,$$scope=$$props.$$scope);};let inputId;$$self.$$.update=()=>{if($$self.$$.dirty&/*name, id*/1025){$$invalidate(6,inputId=`${name}-${id}`);}};return[name,klass,label,value,checked,disabled,inputId,keysPressedStored,handleKeydown,handleClick,id,onkeydown,onclick,$$scope,slots,change_handler];}class RadioItem extends SvelteComponent{constructor(options){super();init(this,options,instance$e,create_fragment$e,safe_not_equal,{name:0,class:1,label:2,id:10,value:3,checked:4,onkeydown:11,onclick:12,disabled:5});}}var flattenOptions=(options=[])=>options.reduce((prev,current)=>{const isGroup=isArray(current)?isArray(current[1]):!!current.options;if(isGroup){return prev.concat(isArray(current)?current[1]:current.options);}prev.push(current);return prev;},[]);const mapOption=(option,index,optionMapper)=>{let mappedOption;if(isArray(option)){mappedOption=_objectSpread({id:index,value:option[0],label:option[1]},option[2]||{});}else{mappedOption=option;mappedOption.id=mappedOption.id!=null?mappedOption.id:index;}return optionMapper?optionMapper(mappedOption):mappedOption;};var mapOptions=(options=[],optionMapper)=>{let index=0;return options.map(option=>{index++;if(isArray(option)){// is either [label, options] or [value, label]\nif(isArray(option[1])){return{id:index,label:option[0],options:option[1].map(option=>mapOption(option,++index,optionMapper))};}return mapOption(option,index,optionMapper);}else{// is either { id?, label, options } or { id?, value, label }\nif(option.options){return{id:option.id||index,label:option.label,options:option.options.map(option=>mapOption(option,++index,optionMapper))};}return mapOption(option,index,optionMapper);}});};var opop=(fn,...args)=>fn&&fn(...args);var localize=(prop,locale,params)=>isFunction(prop)?prop(locale,params):prop;const localizeOptions=(options,locale)=>options.map(([value,label,props])=>{if(isArray(label)){return[localize(value,locale),localizeOptions(label,locale)];}else{const res=[value,localize(label,locale)];if(props){let obj=_objectSpread({},props);if(props.icon)obj.icon=localize(props.icon,locale);res.push(obj);}return res;}});var localizeOptions$1=(options,locale)=>localizeOptions(options,locale);/* src/core/ui/components/RadioGroup.svelte generated by Svelte v3.29.4 */const get_option_slot_changes_1=dirty=>({option:dirty[0]&/*mappedOptions*/2048});const get_option_slot_context_1=ctx=>({option:/*option*/ctx[27]});const get_option_slot_changes=dirty=>({option:dirty[0]&/*mappedOptions*/2048});const get_option_slot_context=ctx=>({option:/*option*/ctx[27]});function get_each_context_1(ctx,list,i){const child_ctx=ctx.slice();child_ctx[27]=list[i];return child_ctx;}const get_group_slot_changes=dirty=>({option:dirty[0]&/*mappedOptions*/2048});const get_group_slot_context=ctx=>({option:/*option*/ctx[27]});function get_each_context$3(ctx,list,i){const child_ctx=ctx.slice();child_ctx[27]=list[i];return child_ctx;}// (83:0) {#if localizedOptions.length}\nfunction create_if_block_1$3(ctx){let fieldset;let t;let ul;let each_blocks=[];let each_1_lookup=new Map();let fieldset_class_value;let current;let if_block=/*label*/ctx[1]&&create_if_block_7$1(ctx);let each_value=/*mappedOptions*/ctx[11];const get_key=ctx=>/*option*/ctx[27].id;for(let i=0;i<each_value.length;i+=1){let child_ctx=get_each_context$3(ctx,each_value,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block$3(key,child_ctx));}return{c(){fieldset=element(\"fieldset\");if(if_block)if_block.c();t=space();ul=element(\"ul\");for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}attr(ul,\"class\",\"DokaRadioGroupOptions\");attr(fieldset,\"class\",fieldset_class_value=arrayJoin([\"DokaRadioGroup\",/*klass*/ctx[3]]));attr(fieldset,\"data-layout\",/*layout*/ctx[5]);attr(fieldset,\"title\",/*title*/ctx[7]);},m(target,anchor){insert(target,fieldset,anchor);if(if_block)if_block.m(fieldset,null);append(fieldset,t);append(fieldset,ul);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(ul,null);}current=true;},p(ctx,dirty){if(/*label*/ctx[1]){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block_7$1(ctx);if_block.c();if_block.m(fieldset,t);}}else if(if_block){if_block.d(1);if_block=null;}if(dirty[0]&/*optionGroupClass, mappedOptions, name, optionClass, getOptionIndex, selectedIndex, handleRadioKeydown, handleRadioClick, optionLabelClass, $$scope*/4225873){const each_value=/*mappedOptions*/ctx[11];group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,ul,outro_and_destroy_block,create_each_block$3,null,get_each_context$3);check_outros();}if(!current||dirty[0]&/*klass*/8&&fieldset_class_value!==(fieldset_class_value=arrayJoin([\"DokaRadioGroup\",/*klass*/ctx[3]]))){attr(fieldset,\"class\",fieldset_class_value);}if(!current||dirty[0]&/*layout*/32){attr(fieldset,\"data-layout\",/*layout*/ctx[5]);}if(!current||dirty[0]&/*title*/128){attr(fieldset,\"title\",/*title*/ctx[7]);}},i(local){if(current)return;for(let i=0;i<each_value.length;i+=1){transition_in(each_blocks[i]);}current=true;},o(local){for(let i=0;i<each_blocks.length;i+=1){transition_out(each_blocks[i]);}current=false;},d(detaching){if(detaching)detach(fieldset);if(if_block)if_block.d();for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d();}}};}// (85:4) {#if label}\nfunction create_if_block_7$1(ctx){let legend;let t;let legend_class_value;return{c(){legend=element(\"legend\");t=text(/*label*/ctx[1]);attr(legend,\"class\",legend_class_value=/*hideLabel*/ctx[2]&&\"implicit\");},m(target,anchor){insert(target,legend,anchor);append(legend,t);},p(ctx,dirty){if(dirty[0]&/*label*/2)set_data(t,/*label*/ctx[1]);if(dirty[0]&/*hideLabel*/4&&legend_class_value!==(legend_class_value=/*hideLabel*/ctx[2]&&\"implicit\")){attr(legend,\"class\",legend_class_value);}},d(detaching){if(detaching)detach(legend);}};}// (115:8) {:else}\nfunction create_else_block$2(ctx){let radioitem;let current;radioitem=new RadioItem({props:{name:/*name*/ctx[4],label:/*option*/ctx[27].label,id:/*option*/ctx[27].id,value:/*option*/ctx[27].value,disabled:/*option*/ctx[27].disabled,class:/*optionClass*/ctx[8],checked:/*getOptionIndex*/ctx[12](/*option*/ctx[27])===/*selectedIndex*/ctx[0],onkeydown:/*handleRadioKeydown*/ctx[13](/*option*/ctx[27]),onclick:/*handleRadioClick*/ctx[14](/*option*/ctx[27]),$$slots:{default:[create_default_slot_2$1]},$$scope:{ctx}}});return{c(){create_component(radioitem.$$.fragment);},m(target,anchor){mount_component(radioitem,target,anchor);current=true;},p(ctx,dirty){const radioitem_changes={};if(dirty[0]&/*name*/16)radioitem_changes.name=/*name*/ctx[4];if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.label=/*option*/ctx[27].label;if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.id=/*option*/ctx[27].id;if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.value=/*option*/ctx[27].value;if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.disabled=/*option*/ctx[27].disabled;if(dirty[0]&/*optionClass*/256)radioitem_changes.class=/*optionClass*/ctx[8];if(dirty[0]&/*mappedOptions, selectedIndex*/2049)radioitem_changes.checked=/*getOptionIndex*/ctx[12](/*option*/ctx[27])===/*selectedIndex*/ctx[0];if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.onkeydown=/*handleRadioKeydown*/ctx[13](/*option*/ctx[27]);if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.onclick=/*handleRadioClick*/ctx[14](/*option*/ctx[27]);if(dirty[0]&/*$$scope, optionLabelClass, mappedOptions*/4196416){radioitem_changes.$$scope={dirty,ctx};}radioitem.$set(radioitem_changes);},i(local){if(current)return;transition_in(radioitem.$$.fragment,local);current=true;},o(local){transition_out(radioitem.$$.fragment,local);current=false;},d(detaching){destroy_component(radioitem,detaching);}};}// (90:8) {#if option.options}\nfunction create_if_block_2$1(ctx){let li;let t0;let ul;let each_blocks=[];let each_1_lookup=new Map();let t1;let li_class_value;let current;const group_slot_template=/*#slots*/ctx[21].group;const group_slot=create_slot(group_slot_template,ctx,/*$$scope*/ctx[22],get_group_slot_context);const group_slot_or_fallback=group_slot||fallback_block_1(ctx);let each_value_1=/*option*/ctx[27].options;const get_key=ctx=>/*option*/ctx[27].id;for(let i=0;i<each_value_1.length;i+=1){let child_ctx=get_each_context_1(ctx,each_value_1,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block_1(key,child_ctx));}return{c(){li=element(\"li\");if(group_slot_or_fallback)group_slot_or_fallback.c();t0=space();ul=element(\"ul\");for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}t1=space();attr(ul,\"class\",\"DokaRadioGroupOptions\");attr(li,\"class\",li_class_value=arrayJoin([\"DokaRadioGroupOptionGroup\",/*optionGroupClass*/ctx[9]]));},m(target,anchor){insert(target,li,anchor);if(group_slot_or_fallback){group_slot_or_fallback.m(li,null);}append(li,t0);append(li,ul);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(ul,null);}append(li,t1);current=true;},p(ctx,dirty){if(group_slot){if(group_slot.p&&dirty[0]&/*$$scope, mappedOptions*/4196352){update_slot(group_slot,group_slot_template,ctx,/*$$scope*/ctx[22],dirty,get_group_slot_changes,get_group_slot_context);}}else{if(group_slot_or_fallback&&group_slot_or_fallback.p&&dirty[0]&/*mappedOptions*/2048){group_slot_or_fallback.p(ctx,dirty);}}if(dirty[0]&/*name, mappedOptions, optionClass, getOptionIndex, selectedIndex, handleRadioKeydown, handleRadioClick, optionLabelClass, $$scope*/4225361){const each_value_1=/*option*/ctx[27].options;group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value_1,each_1_lookup,ul,outro_and_destroy_block,create_each_block_1,null,get_each_context_1);check_outros();}if(!current||dirty[0]&/*optionGroupClass*/512&&li_class_value!==(li_class_value=arrayJoin([\"DokaRadioGroupOptionGroup\",/*optionGroupClass*/ctx[9]]))){attr(li,\"class\",li_class_value);}},i(local){if(current)return;transition_in(group_slot_or_fallback,local);for(let i=0;i<each_value_1.length;i+=1){transition_in(each_blocks[i]);}current=true;},o(local){transition_out(group_slot_or_fallback,local);for(let i=0;i<each_blocks.length;i+=1){transition_out(each_blocks[i]);}current=false;},d(detaching){if(detaching)detach(li);if(group_slot_or_fallback)group_slot_or_fallback.d(detaching);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d();}}};}// (126:16) {#if option.icon}\nfunction create_if_block_6$1(ctx){let icon;let current;icon=new Icon({props:{$$slots:{default:[create_default_slot_3$1]},$$scope:{ctx}}});return{c(){create_component(icon.$$.fragment);},m(target,anchor){mount_component(icon,target,anchor);current=true;},p(ctx,dirty){const icon_changes={};if(dirty[0]&/*$$scope, mappedOptions*/4196352){icon_changes.$$scope={dirty,ctx};}icon.$set(icon_changes);},i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o(local){transition_out(icon.$$.fragment,local);current=false;},d(detaching){destroy_component(icon,detaching);}};}// (127:16) <Icon>\nfunction create_default_slot_3$1(ctx){let g;let raw_value=/*option*/ctx[27].icon+\"\";return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=raw_value;},p(ctx,dirty){if(dirty[0]&/*mappedOptions*/2048&&raw_value!==(raw_value=/*option*/ctx[27].icon+\"\"))g.innerHTML=raw_value;},d(detaching){if(detaching)detach(g);}};}// (129:16) {#if !option.hideLabel}\nfunction create_if_block_5$1(ctx){let span;let t_value=/*option*/ctx[27].label+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);attr(span,\"class\",/*optionLabelClass*/ctx[6]);},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty[0]&/*mappedOptions*/2048&&t_value!==(t_value=/*option*/ctx[27].label+\"\"))set_data(t,t_value);if(dirty[0]&/*optionLabelClass*/64){attr(span,\"class\",/*optionLabelClass*/ctx[6]);}},d(detaching){if(detaching)detach(span);}};}// (125:76)                  \nfunction fallback_block_2(ctx){let t0;let t1;let current;let if_block0=/*option*/ctx[27].icon&&create_if_block_6$1(ctx);let if_block1=!/*option*/ctx[27].hideLabel&&create_if_block_5$1(ctx);return{c(){if(if_block0)if_block0.c();t0=space();if(if_block1)if_block1.c();t1=space();},m(target,anchor){if(if_block0)if_block0.m(target,anchor);insert(target,t0,anchor);if(if_block1)if_block1.m(target,anchor);insert(target,t1,anchor);current=true;},p(ctx,dirty){if(/*option*/ctx[27].icon){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*mappedOptions*/2048){transition_in(if_block0,1);}}else{if_block0=create_if_block_6$1(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t0.parentNode,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(!/*option*/ctx[27].hideLabel){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block_5$1(ctx);if_block1.c();if_block1.m(t1.parentNode,t1);}}else if(if_block1){if_block1.d(1);if_block1=null;}},i(local){if(current)return;transition_in(if_block0);current=true;},o(local){transition_out(if_block0);current=false;},d(detaching){if(if_block0)if_block0.d(detaching);if(detaching)detach(t0);if(if_block1)if_block1.d(detaching);if(detaching)detach(t1);}};}// (116:8) <RadioItem              {name}              label={option.label}             id={option.id}             value={option.value}             disabled={option.disabled}             class={optionClass}             checked={getOptionIndex(option) === selectedIndex}             onkeydown={handleRadioKeydown(option)}             onclick={handleRadioClick(option)}>\nfunction create_default_slot_2$1(ctx){let current;const option_slot_template=/*#slots*/ctx[21].option;const option_slot=create_slot(option_slot_template,ctx,/*$$scope*/ctx[22],get_option_slot_context_1);const option_slot_or_fallback=option_slot||fallback_block_2(ctx);return{c(){if(option_slot_or_fallback)option_slot_or_fallback.c();},m(target,anchor){if(option_slot_or_fallback){option_slot_or_fallback.m(target,anchor);}current=true;},p(ctx,dirty){if(option_slot){if(option_slot.p&&dirty[0]&/*$$scope, mappedOptions*/4196352){update_slot(option_slot,option_slot_template,ctx,/*$$scope*/ctx[22],dirty,get_option_slot_changes_1,get_option_slot_context_1);}}else{if(option_slot_or_fallback&&option_slot_or_fallback.p&&dirty[0]&/*optionLabelClass, mappedOptions*/2112){option_slot_or_fallback.p(ctx,dirty);}}},i(local){if(current)return;transition_in(option_slot_or_fallback,local);current=true;},o(local){transition_out(option_slot_or_fallback,local);current=false;},d(detaching){if(option_slot_or_fallback)option_slot_or_fallback.d(detaching);}};}// (92:47) <span class=\"DokaRadioGroupOptionGroupLabel\">\nfunction fallback_block_1(ctx){let span;let t_value=/*option*/ctx[27].label+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);attr(span,\"class\",\"DokaRadioGroupOptionGroupLabel\");},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty[0]&/*mappedOptions*/2048&&t_value!==(t_value=/*option*/ctx[27].label+\"\"))set_data(t,t_value);},d(detaching){if(detaching)detach(span);}};}// (105:24) {#if option.icon}\nfunction create_if_block_4$1(ctx){let icon;let current;icon=new Icon({props:{$$slots:{default:[create_default_slot_1$1]},$$scope:{ctx}}});return{c(){create_component(icon.$$.fragment);},m(target,anchor){mount_component(icon,target,anchor);current=true;},p(ctx,dirty){const icon_changes={};if(dirty[0]&/*$$scope, mappedOptions*/4196352){icon_changes.$$scope={dirty,ctx};}icon.$set(icon_changes);},i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o(local){transition_out(icon.$$.fragment,local);current=false;},d(detaching){destroy_component(icon,detaching);}};}// (106:24) <Icon>\nfunction create_default_slot_1$1(ctx){let g;let raw_value=/*option*/ctx[27].icon+\"\";return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=raw_value;},p(ctx,dirty){if(dirty[0]&/*mappedOptions*/2048&&raw_value!==(raw_value=/*option*/ctx[27].icon+\"\"))g.innerHTML=raw_value;},d(detaching){if(detaching)detach(g);}};}// (108:24) {#if !option.hideLabel}\nfunction create_if_block_3$1(ctx){let span;let t_value=/*option*/ctx[27].label+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);attr(span,\"class\",/*optionLabelClass*/ctx[6]);},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty[0]&/*mappedOptions*/2048&&t_value!==(t_value=/*option*/ctx[27].label+\"\"))set_data(t,t_value);if(dirty[0]&/*optionLabelClass*/64){attr(span,\"class\",/*optionLabelClass*/ctx[6]);}},d(detaching){if(detaching)detach(span);}};}// (104:84)                          \nfunction fallback_block$1(ctx){let t0;let t1;let current;let if_block0=/*option*/ctx[27].icon&&create_if_block_4$1(ctx);let if_block1=!/*option*/ctx[27].hideLabel&&create_if_block_3$1(ctx);return{c(){if(if_block0)if_block0.c();t0=space();if(if_block1)if_block1.c();t1=space();},m(target,anchor){if(if_block0)if_block0.m(target,anchor);insert(target,t0,anchor);if(if_block1)if_block1.m(target,anchor);insert(target,t1,anchor);current=true;},p(ctx,dirty){if(/*option*/ctx[27].icon){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*mappedOptions*/2048){transition_in(if_block0,1);}}else{if_block0=create_if_block_4$1(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t0.parentNode,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(!/*option*/ctx[27].hideLabel){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block_3$1(ctx);if_block1.c();if_block1.m(t1.parentNode,t1);}}else if(if_block1){if_block1.d(1);if_block1=null;}},i(local){if(current)return;transition_in(if_block0);current=true;},o(local){transition_out(if_block0);current=false;},d(detaching){if(if_block0)if_block0.d(detaching);if(detaching)detach(t0);if(if_block1)if_block1.d(detaching);if(detaching)detach(t1);}};}// (95:16) <RadioItem                      {name}                      label={option.label}                     id={option.id}                     value={option.value}                     disabled={option.disabled}                     class={optionClass}                     checked={getOptionIndex(option) === selectedIndex}                     onkeydown={handleRadioKeydown(option)}                     onclick={handleRadioClick(option)}>\nfunction create_default_slot$3(ctx){let current;const option_slot_template=/*#slots*/ctx[21].option;const option_slot=create_slot(option_slot_template,ctx,/*$$scope*/ctx[22],get_option_slot_context);const option_slot_or_fallback=option_slot||fallback_block$1(ctx);return{c(){if(option_slot_or_fallback)option_slot_or_fallback.c();},m(target,anchor){if(option_slot_or_fallback){option_slot_or_fallback.m(target,anchor);}current=true;},p(ctx,dirty){if(option_slot){if(option_slot.p&&dirty[0]&/*$$scope, mappedOptions*/4196352){update_slot(option_slot,option_slot_template,ctx,/*$$scope*/ctx[22],dirty,get_option_slot_changes,get_option_slot_context);}}else{if(option_slot_or_fallback&&option_slot_or_fallback.p&&dirty[0]&/*optionLabelClass, mappedOptions*/2112){option_slot_or_fallback.p(ctx,dirty);}}},i(local){if(current)return;transition_in(option_slot_or_fallback,local);current=true;},o(local){transition_out(option_slot_or_fallback,local);current=false;},d(detaching){if(option_slot_or_fallback)option_slot_or_fallback.d(detaching);}};}// (94:16) {#each option.options as option (option.id) }\nfunction create_each_block_1(key_1,ctx){let first;let radioitem;let current;radioitem=new RadioItem({props:{name:/*name*/ctx[4],label:/*option*/ctx[27].label,id:/*option*/ctx[27].id,value:/*option*/ctx[27].value,disabled:/*option*/ctx[27].disabled,class:/*optionClass*/ctx[8],checked:/*getOptionIndex*/ctx[12](/*option*/ctx[27])===/*selectedIndex*/ctx[0],onkeydown:/*handleRadioKeydown*/ctx[13](/*option*/ctx[27]),onclick:/*handleRadioClick*/ctx[14](/*option*/ctx[27]),$$slots:{default:[create_default_slot$3]},$$scope:{ctx}}});return{key:key_1,first:null,c(){first=empty();create_component(radioitem.$$.fragment);this.first=first;},m(target,anchor){insert(target,first,anchor);mount_component(radioitem,target,anchor);current=true;},p(ctx,dirty){const radioitem_changes={};if(dirty[0]&/*name*/16)radioitem_changes.name=/*name*/ctx[4];if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.label=/*option*/ctx[27].label;if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.id=/*option*/ctx[27].id;if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.value=/*option*/ctx[27].value;if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.disabled=/*option*/ctx[27].disabled;if(dirty[0]&/*optionClass*/256)radioitem_changes.class=/*optionClass*/ctx[8];if(dirty[0]&/*mappedOptions, selectedIndex*/2049)radioitem_changes.checked=/*getOptionIndex*/ctx[12](/*option*/ctx[27])===/*selectedIndex*/ctx[0];if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.onkeydown=/*handleRadioKeydown*/ctx[13](/*option*/ctx[27]);if(dirty[0]&/*mappedOptions*/2048)radioitem_changes.onclick=/*handleRadioClick*/ctx[14](/*option*/ctx[27]);if(dirty[0]&/*$$scope, optionLabelClass, mappedOptions*/4196416){radioitem_changes.$$scope={dirty,ctx};}radioitem.$set(radioitem_changes);},i(local){if(current)return;transition_in(radioitem.$$.fragment,local);current=true;},o(local){transition_out(radioitem.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(first);destroy_component(radioitem,detaching);}};}// (89:8) {#each mappedOptions as option (option.id) }\nfunction create_each_block$3(key_1,ctx){let first;let current_block_type_index;let if_block;let if_block_anchor;let current;const if_block_creators=[create_if_block_2$1,create_else_block$2];const if_blocks=[];function select_block_type(ctx,dirty){if(/*option*/ctx[27].options)return 0;return 1;}current_block_type_index=select_block_type(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{key:key_1,first:null,c(){first=empty();if_block.c();if_block_anchor=empty();this.first=first;},m(target,anchor){insert(target,first,anchor);if_blocks[current_block_type_index].m(target,anchor);insert(target,if_block_anchor,anchor);current=true;},p(ctx,dirty){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,()=>{if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(first);if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);}};}function create_fragment$f(ctx){let t;let if_block1_anchor;let current;let if_block0=/*localizedOptions*/ctx[10].length&&create_if_block_1$3(ctx);let if_block1=false;return{c(){if(if_block0)if_block0.c();t=space();if_block1_anchor=empty();},m(target,anchor){if(if_block0)if_block0.m(target,anchor);insert(target,t,anchor);insert(target,if_block1_anchor,anchor);current=true;},p(ctx,dirty){if(/*localizedOptions*/ctx[10].length){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*localizedOptions*/1024){transition_in(if_block0,1);}}else{if_block0=create_if_block_1$3(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t.parentNode,t);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}},i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);current=true;},o(local){transition_out(if_block0);transition_out(if_block1);current=false;},d(detaching){if(if_block0)if_block0.d(detaching);if(detaching)detach(t);if(detaching)detach(if_block1_anchor);}};}function instance$f($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope}=$$props;const dispatch=createEventDispatcher();let{label=undefined}=$$props;let{hideLabel=true}=$$props;let{class:klass=undefined}=$$props;let{name=`doka-radio-group-${getUniqueId()}`}=$$props;let{selectedIndex=-1}=$$props;let{options=[]}=$$props;let{onchange=undefined}=$$props;let{layout=undefined}=$$props;let{optionMapper=undefined}=$$props;let{optionFilter=undefined}=$$props;let{value=undefined}=$$props;let{optionLabelClass=undefined}=$$props;let{title=undefined}=$$props;let{locale=undefined}=$$props;let{optionClass=undefined}=$$props;let{optionGroupClass=undefined}=$$props;const getOptionIndex=option=>flattenedOptions.findIndex(flattenedOption=>flattenedOption.id===option.id);const isConfirm=key=>/enter| /i.test(key);const changeSelection=option=>{$$invalidate(0,selectedIndex=getOptionIndex(option));const payload=_objectSpread({index:selectedIndex},option);opop(onchange,payload);dispatch(\"change\",payload);};const handleRadioKeydown=option=>e=>{// is confirm key ([enter] or [space])\nif(!isConfirm(e.key))return;changeSelection(option);};const handleRadioClick=option=>e=>{changeSelection(option);};$$self.$$set=$$props=>{if(\"label\"in $$props)$$invalidate(1,label=$$props.label);if(\"hideLabel\"in $$props)$$invalidate(2,hideLabel=$$props.hideLabel);if(\"class\"in $$props)$$invalidate(3,klass=$$props.class);if(\"name\"in $$props)$$invalidate(4,name=$$props.name);if(\"selectedIndex\"in $$props)$$invalidate(0,selectedIndex=$$props.selectedIndex);if(\"options\"in $$props)$$invalidate(15,options=$$props.options);if(\"onchange\"in $$props)$$invalidate(16,onchange=$$props.onchange);if(\"layout\"in $$props)$$invalidate(5,layout=$$props.layout);if(\"optionMapper\"in $$props)$$invalidate(17,optionMapper=$$props.optionMapper);if(\"optionFilter\"in $$props)$$invalidate(18,optionFilter=$$props.optionFilter);if(\"value\"in $$props)$$invalidate(19,value=$$props.value);if(\"optionLabelClass\"in $$props)$$invalidate(6,optionLabelClass=$$props.optionLabelClass);if(\"title\"in $$props)$$invalidate(7,title=$$props.title);if(\"locale\"in $$props)$$invalidate(20,locale=$$props.locale);if(\"optionClass\"in $$props)$$invalidate(8,optionClass=$$props.optionClass);if(\"optionGroupClass\"in $$props)$$invalidate(9,optionGroupClass=$$props.optionGroupClass);if(\"$$scope\"in $$props)$$invalidate(22,$$scope=$$props.$$scope);};let localizedOptions;let mappedOptions;let flattenedOptions;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*optionFilter, options, locale*/1343488){$$invalidate(10,localizedOptions=localizeOptions$1(optionFilter?options.filter(optionFilter):options,locale));}if($$self.$$.dirty[0]&/*localizedOptions, optionMapper*/132096){$$invalidate(11,mappedOptions=mapOptions(localizedOptions,optionMapper));}if($$self.$$.dirty[0]&/*mappedOptions*/2048){$$invalidate(23,flattenedOptions=flattenOptions(mappedOptions));}if($$self.$$.dirty[0]&/*value, selectedIndex, flattenedOptions*/8912897){// can optionally pass value to have radio button group try to auto-select the right option\nif(value&&selectedIndex<0){$$invalidate(0,selectedIndex=flattenedOptions.findIndex(option=>option.value===value));}}};return[selectedIndex,label,hideLabel,klass,name,layout,optionLabelClass,title,optionClass,optionGroupClass,localizedOptions,mappedOptions,getOptionIndex,handleRadioKeydown,handleRadioClick,options,onchange,optionMapper,optionFilter,value,locale,slots,$$scope];}class RadioGroup extends SvelteComponent{constructor(options){super();init(this,options,instance$f,create_fragment$f,safe_not_equal,{label:1,hideLabel:2,class:3,name:4,selectedIndex:0,options:15,onchange:16,layout:5,optionMapper:17,optionFilter:18,value:19,optionLabelClass:6,title:7,locale:20,optionClass:8,optionGroupClass:9},[-1,-1]);}}var isDeepEqual=(a,b)=>{if(Array.isArray(a)&&Array.isArray(b))return arrayEqual(a,b);return a===b;};/* src/core/ui/components/Dropdown.svelte generated by Svelte v3.29.4 */function create_if_block_2$2(ctx){let icon_1;let current;icon_1=new Icon({props:{$$slots:{default:[create_default_slot_3$2]},$$scope:{ctx}}});return{c(){create_component(icon_1.$$.fragment);},m(target,anchor){mount_component(icon_1,target,anchor);current=true;},p(ctx,dirty){const icon_1_changes={};if(dirty&/*$$scope, icon*/134217792){icon_1_changes.$$scope={dirty,ctx};}icon_1.$set(icon_1_changes);},i(local){if(current)return;transition_in(icon_1.$$.fragment,local);current=true;},o(local){transition_out(icon_1.$$.fragment,local);current=false;},d(detaching){destroy_component(icon_1,detaching);}};}// (145:8) <Icon>\nfunction create_default_slot_3$2(ctx){let g;return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=/*icon*/ctx[6];},p(ctx,dirty){if(dirty&/*icon*/64)g.innerHTML=/*icon*/ctx[6];},d(detaching){if(detaching)detach(g);}};}// (147:8) {#if !hideLabel}\nfunction create_if_block_1$4(ctx){let span;let t_value=(/*label*/ctx[2]||/*selectedLabel*/ctx[18])+\"\";let t;let span_class_value;return{c(){span=element(\"span\");t=text(t_value);attr(span,\"class\",span_class_value=arrayJoin([\"DokaButtonLabel\",/*labelClass*/ctx[3]]));},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty&/*label, selectedLabel*/262148&&t_value!==(t_value=(/*label*/ctx[2]||/*selectedLabel*/ctx[18])+\"\"))set_data(t,t_value);if(dirty&/*labelClass*/8&&span_class_value!==(span_class_value=arrayJoin([\"DokaButtonLabel\",/*labelClass*/ctx[3]]))){attr(span,\"class\",span_class_value);}},d(detaching){if(detaching)detach(span);}};}// (143:4) <span slot=\"label\" title={localize(title, locale)} class={arrayJoin(['DokaButtonInner', innerClass])} >\nfunction create_label_slot(ctx){let span;let t;let span_title_value;let span_class_value;let current;let if_block0=/*icon*/ctx[6]&&create_if_block_2$2(ctx);let if_block1=!/*hideLabel*/ctx[5]&&create_if_block_1$4(ctx);return{c(){span=element(\"span\");if(if_block0)if_block0.c();t=space();if(if_block1)if_block1.c();attr(span,\"slot\",\"label\");attr(span,\"title\",span_title_value=localize(/*title*/ctx[1],/*locale*/ctx[15]));attr(span,\"class\",span_class_value=arrayJoin([\"DokaButtonInner\",/*innerClass*/ctx[4]]));},m(target,anchor){insert(target,span,anchor);if(if_block0)if_block0.m(span,null);append(span,t);if(if_block1)if_block1.m(span,null);current=true;},p(ctx,dirty){if(/*icon*/ctx[6]){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*icon*/64){transition_in(if_block0,1);}}else{if_block0=create_if_block_2$2(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(span,t);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(!/*hideLabel*/ctx[5]){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block_1$4(ctx);if_block1.c();if_block1.m(span,null);}}else if(if_block1){if_block1.d(1);if_block1=null;}if(!current||dirty&/*title, locale*/32770&&span_title_value!==(span_title_value=localize(/*title*/ctx[1],/*locale*/ctx[15]))){attr(span,\"title\",span_title_value);}if(!current||dirty&/*innerClass*/16&&span_class_value!==(span_class_value=arrayJoin([\"DokaButtonInner\",/*innerClass*/ctx[4]]))){attr(span,\"class\",span_class_value);}},i(local){if(current)return;transition_in(if_block0);current=true;},o(local){transition_out(if_block0);current=false;},d(detaching){if(detaching)detach(span);if(if_block0)if_block0.d();if(if_block1)if_block1.d();}};}// (165:12) <span slot=\"group\">\nfunction create_group_slot(ctx){let span;let t_value=/*option*/ctx[26].label+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);attr(span,\"slot\",\"group\");},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty&/*option*/67108864&&t_value!==(t_value=/*option*/ctx[26].label+\"\"))set_data(t,t_value);},d(detaching){if(detaching)detach(span);}};}// (167:16) {#if option.icon}\nfunction create_if_block$3(ctx){let icon_1;let current;icon_1=new Icon({props:{style:isFunction(/*optionIconStyle*/ctx[13])?/*optionIconStyle*/ctx[13](/*option*/ctx[26].value):/*optionIconStyle*/ctx[13],$$slots:{default:[create_default_slot_2$2]},$$scope:{ctx}}});return{c(){create_component(icon_1.$$.fragment);},m(target,anchor){mount_component(icon_1,target,anchor);current=true;},p(ctx,dirty){const icon_1_changes={};if(dirty&/*optionIconStyle, option*/67117056)icon_1_changes.style=isFunction(/*optionIconStyle*/ctx[13])?/*optionIconStyle*/ctx[13](/*option*/ctx[26].value):/*optionIconStyle*/ctx[13];if(dirty&/*$$scope, option*/201326592){icon_1_changes.$$scope={dirty,ctx};}icon_1.$set(icon_1_changes);},i(local){if(current)return;transition_in(icon_1.$$.fragment,local);current=true;},o(local){transition_out(icon_1.$$.fragment,local);current=false;},d(detaching){destroy_component(icon_1,detaching);}};}// (168:16) <Icon style={isFunction(optionIconStyle) ? optionIconStyle(option.value) : optionIconStyle}>\nfunction create_default_slot_2$2(ctx){let g;let raw_value=/*option*/ctx[26].icon+\"\";return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=raw_value;},p(ctx,dirty){if(dirty&/*option*/67108864&&raw_value!==(raw_value=/*option*/ctx[26].icon+\"\"))g.innerHTML=raw_value;},d(detaching){if(detaching)detach(g);}};}// (166:12) <span slot=\"option\">\nfunction create_option_slot(ctx){let span0;let t0;let span1;let t1_value=/*option*/ctx[26].label+\"\";let t1;let span1_style_value;let span1_class_value;let current;let if_block=/*option*/ctx[26].icon&&create_if_block$3(ctx);return{c(){span0=element(\"span\");if(if_block)if_block.c();t0=space();span1=element(\"span\");t1=text(t1_value);attr(span1,\"style\",span1_style_value=isFunction(/*optionLabelStyle*/ctx[14])?/*optionLabelStyle*/ctx[14](/*option*/ctx[26].value):/*optionLabelStyle*/ctx[14]);attr(span1,\"class\",span1_class_value=arrayJoin([\"DokaDropdownOptionLabel\",/*optionLabelClass*/ctx[10]]));attr(span0,\"slot\",\"option\");},m(target,anchor){insert(target,span0,anchor);if(if_block)if_block.m(span0,null);append(span0,t0);append(span0,span1);append(span1,t1);current=true;},p(ctx,dirty){if(/*option*/ctx[26].icon){if(if_block){if_block.p(ctx,dirty);if(dirty&/*option*/67108864){transition_in(if_block,1);}}else{if_block=create_if_block$3(ctx);if_block.c();transition_in(if_block,1);if_block.m(span0,t0);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}if((!current||dirty&/*option*/67108864)&&t1_value!==(t1_value=/*option*/ctx[26].label+\"\"))set_data(t1,t1_value);if(!current||dirty&/*optionLabelStyle, option*/67125248&&span1_style_value!==(span1_style_value=isFunction(/*optionLabelStyle*/ctx[14])?/*optionLabelStyle*/ctx[14](/*option*/ctx[26].value):/*optionLabelStyle*/ctx[14])){attr(span1,\"style\",span1_style_value);}if(!current||dirty&/*optionLabelClass*/1024&&span1_class_value!==(span1_class_value=arrayJoin([\"DokaDropdownOptionLabel\",/*optionLabelClass*/ctx[10]]))){attr(span1,\"class\",span1_class_value);}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(span0);if(if_block)if_block.d();}};}// (153:8) <RadioGroup              {name}             {value}             {selectedIndex}             {optionFilter}             {optionMapper}             optionLabelClass={arrayJoin(['DokaDropdownOptionLabel', optionLabelClass])}             optionGroupClass=\"DokaDropdownOptionGroup\"             optionClass=\"DokaDropdownOption\"             options={localizedOptions}             onchange={handleSelect}             let:option>\nfunction create_default_slot_1$2(ctx){let t;return{c(){t=space();},m(target,anchor){insert(target,t,anchor);},p:noop$1,i:noop$1,o:noop$1,d(detaching){if(detaching)detach(t);}};}// (152:4) <div class=\"DokaDropdownPanel\" slot=\"details\" on:keydown={handleKeydown}>\nfunction create_details_slot(ctx){let div;let radiogroup;let current;let mounted;let dispose;radiogroup=new RadioGroup({props:{name:/*name*/ctx[7],value:/*value*/ctx[9],selectedIndex:/*selectedIndex*/ctx[8],optionFilter:/*optionFilter*/ctx[11],optionMapper:/*optionMapper*/ctx[12],optionLabelClass:arrayJoin([\"DokaDropdownOptionLabel\",/*optionLabelClass*/ctx[10]]),optionGroupClass:\"DokaDropdownOptionGroup\",optionClass:\"DokaDropdownOption\",options:/*localizedOptions*/ctx[17],onchange:/*handleSelect*/ctx[19],$$slots:{default:[create_default_slot_1$2,({option})=>({26:option}),({option})=>option?67108864:0],option:[create_option_slot,({option})=>({26:option}),({option})=>option?67108864:0],group:[create_group_slot,({option})=>({26:option}),({option})=>option?67108864:0]},$$scope:{ctx}}});return{c(){div=element(\"div\");create_component(radiogroup.$$.fragment);attr(div,\"class\",\"DokaDropdownPanel\");attr(div,\"slot\",\"details\");},m(target,anchor){insert(target,div,anchor);mount_component(radiogroup,div,null);current=true;if(!mounted){dispose=listen(div,\"keydown\",/*handleKeydown*/ctx[21]);mounted=true;}},p(ctx,dirty){const radiogroup_changes={};if(dirty&/*name*/128)radiogroup_changes.name=/*name*/ctx[7];if(dirty&/*value*/512)radiogroup_changes.value=/*value*/ctx[9];if(dirty&/*selectedIndex*/256)radiogroup_changes.selectedIndex=/*selectedIndex*/ctx[8];if(dirty&/*optionFilter*/2048)radiogroup_changes.optionFilter=/*optionFilter*/ctx[11];if(dirty&/*optionMapper*/4096)radiogroup_changes.optionMapper=/*optionMapper*/ctx[12];if(dirty&/*optionLabelClass*/1024)radiogroup_changes.optionLabelClass=arrayJoin([\"DokaDropdownOptionLabel\",/*optionLabelClass*/ctx[10]]);if(dirty&/*localizedOptions*/131072)radiogroup_changes.options=/*localizedOptions*/ctx[17];if(dirty&/*$$scope, optionLabelStyle, option, optionLabelClass, optionIconStyle*/201352192){radiogroup_changes.$$scope={dirty,ctx};}radiogroup.$set(radiogroup_changes);},i(local){if(current)return;transition_in(radiogroup.$$.fragment,local);current=true;},o(local){transition_out(radiogroup.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(radiogroup);mounted=false;dispose();}};}// (139:0) <Details bind:isActive={dropdownVisible}      onshow={handleShowPanel}      buttonClass={arrayJoin(['DokaDropdownButton',klass, hideLabel && 'DokaDropdownIconOnly'])}>\nfunction create_default_slot$4(ctx){let t;return{c(){t=space();},m(target,anchor){insert(target,t,anchor);},p:noop$1,i:noop$1,o:noop$1,d(detaching){if(detaching)detach(t);}};}function create_fragment$g(ctx){let details;let updating_isActive;let current;function details_isActive_binding(value){/*details_isActive_binding*/ctx[24].call(null,value);}let details_props={onshow:/*handleShowPanel*/ctx[20],buttonClass:arrayJoin([\"DokaDropdownButton\",/*klass*/ctx[0],/*hideLabel*/ctx[5]&&\"DokaDropdownIconOnly\"]),$$slots:{default:[create_default_slot$4],details:[create_details_slot],label:[create_label_slot]},$$scope:{ctx}};if(/*dropdownVisible*/ctx[16]!==void 0){details_props.isActive=/*dropdownVisible*/ctx[16];}details=new Details({props:details_props});binding_callbacks.push(()=>bind(details,\"isActive\",details_isActive_binding));return{c(){create_component(details.$$.fragment);},m(target,anchor){mount_component(details,target,anchor);current=true;},p(ctx,[dirty]){const details_changes={};if(dirty&/*klass, hideLabel*/33)details_changes.buttonClass=arrayJoin([\"DokaDropdownButton\",/*klass*/ctx[0],/*hideLabel*/ctx[5]&&\"DokaDropdownIconOnly\"]);if(dirty&/*$$scope, name, value, selectedIndex, optionFilter, optionMapper, optionLabelClass, localizedOptions, optionLabelStyle, optionIconStyle, title, locale, innerClass, labelClass, label, selectedLabel, hideLabel, icon*/134676478){details_changes.$$scope={dirty,ctx};}if(!updating_isActive&&dirty&/*dropdownVisible*/65536){updating_isActive=true;details_changes.isActive=/*dropdownVisible*/ctx[16];add_flush_callback(()=>updating_isActive=false);}details.$set(details_changes);},i(local){if(current)return;transition_in(details.$$.fragment,local);current=true;},o(local){transition_out(details.$$.fragment,local);current=false;},d(detaching){destroy_component(details,detaching);}};}function instance$g($$self,$$props,$$invalidate){let{class:klass=undefined}=$$props;let{title=undefined}=$$props;let{label=undefined}=$$props;let{labelClass=undefined}=$$props;let{innerClass=undefined}=$$props;let{hideLabel=false}=$$props;let{icon=undefined}=$$props;let{name=undefined}=$$props;let{options=[]}=$$props;let{selectedIndex=-1}=$$props;let{value=undefined}=$$props;let{optionLabelClass=undefined}=$$props;let{optionFilter=undefined}=$$props;let{optionMapper=undefined}=$$props;let{optionIconStyle=undefined}=$$props;let{optionLabelStyle=undefined}=$$props;let{onchange=undefined}=$$props;let{locale=undefined}=$$props;const getUndefinedOptionLabel=options=>{const option=localizedOptions.find(option=>option[0]===undefined);if(!option)return undefined;return option[1];};let dropdownVisible;const handleSelect=detail=>{// triggers label update\n$$invalidate(18,selectedLabel=detail.value);// update value\nonchange(detail);// hide details\n$$invalidate(16,dropdownVisible=false);};const handleShowPanel=({e,panel})=>{if(e&&e.key&&/up|down/i.test(e.key))return panel.querySelector(\"input:not([disabled])\").focus();panel.querySelector(\"fieldset\").focus();};const handleKeydown=e=>{// don't allow tabbing ([tab] is also blocked in normal <select>)\nif(/tab/i.test(e.key))e.preventDefault();};function details_isActive_binding(value){dropdownVisible=value;$$invalidate(16,dropdownVisible);}$$self.$$set=$$props=>{if(\"class\"in $$props)$$invalidate(0,klass=$$props.class);if(\"title\"in $$props)$$invalidate(1,title=$$props.title);if(\"label\"in $$props)$$invalidate(2,label=$$props.label);if(\"labelClass\"in $$props)$$invalidate(3,labelClass=$$props.labelClass);if(\"innerClass\"in $$props)$$invalidate(4,innerClass=$$props.innerClass);if(\"hideLabel\"in $$props)$$invalidate(5,hideLabel=$$props.hideLabel);if(\"icon\"in $$props)$$invalidate(6,icon=$$props.icon);if(\"name\"in $$props)$$invalidate(7,name=$$props.name);if(\"options\"in $$props)$$invalidate(22,options=$$props.options);if(\"selectedIndex\"in $$props)$$invalidate(8,selectedIndex=$$props.selectedIndex);if(\"value\"in $$props)$$invalidate(9,value=$$props.value);if(\"optionLabelClass\"in $$props)$$invalidate(10,optionLabelClass=$$props.optionLabelClass);if(\"optionFilter\"in $$props)$$invalidate(11,optionFilter=$$props.optionFilter);if(\"optionMapper\"in $$props)$$invalidate(12,optionMapper=$$props.optionMapper);if(\"optionIconStyle\"in $$props)$$invalidate(13,optionIconStyle=$$props.optionIconStyle);if(\"optionLabelStyle\"in $$props)$$invalidate(14,optionLabelStyle=$$props.optionLabelStyle);if(\"onchange\"in $$props)$$invalidate(23,onchange=$$props.onchange);if(\"locale\"in $$props)$$invalidate(15,locale=$$props.locale);};let localizedOptions;let selectedLabel;$$self.$$.update=()=>{if($$self.$$.dirty&/*options, locale*/4227072){$$invalidate(17,localizedOptions=localizeOptions$1(options,locale));}if($$self.$$.dirty&/*localizedOptions, value*/131584){$$invalidate(18,selectedLabel=localizedOptions.reduce((prev,curr)=>{if(prev)return prev;const[optionValue,optionLabel]=curr;if(isDeepEqual(optionValue,value))return optionLabel;},undefined)||getUndefinedOptionLabel());}};return[klass,title,label,labelClass,innerClass,hideLabel,icon,name,selectedIndex,value,optionLabelClass,optionFilter,optionMapper,optionIconStyle,optionLabelStyle,locale,dropdownVisible,localizedOptions,selectedLabel,handleSelect,handleShowPanel,handleKeydown,options,onchange,details_isActive_binding];}class Dropdown extends SvelteComponent{constructor(options){super();init(this,options,instance$g,create_fragment$g,safe_not_equal,{class:0,title:1,label:2,labelClass:3,innerClass:4,hideLabel:5,icon:6,name:7,options:22,selectedIndex:8,value:9,optionLabelClass:10,optionFilter:11,optionMapper:12,optionIconStyle:13,optionLabelStyle:14,onchange:23,locale:15});}}/* src/core/ui/components/Slider.svelte generated by Svelte v3.29.4 */function create_fragment$h(ctx){let div3;let input_1;let nudgeable_action;let t0;let div0;let t1;let div2;let div1;let div2_style_value;let div3_class_value;let mounted;let dispose;return{c(){div3=element(\"div\");input_1=element(\"input\");t0=space();div0=element(\"div\");t1=space();div2=element(\"div\");div1=element(\"div\");attr(input_1,\"type\",\"range\");attr(input_1,\"id\",/*id*/ctx[4]);attr(input_1,\"min\",/*min*/ctx[1]);attr(input_1,\"max\",/*max*/ctx[2]);attr(input_1,\"step\",/*step*/ctx[3]);input_1.value=/*value*/ctx[0];attr(div0,\"class\",\"DokaSliderTrack\");attr(div0,\"style\",/*trackStyle*/ctx[5]);attr(div1,\"class\",\"DokaSliderKnob\");attr(div1,\"style\",/*knobStyle*/ctx[6]);attr(div2,\"class\",\"DokaSliderKnobController\");attr(div2,\"style\",div2_style_value=`transform: translateX(${/*position*/ctx[9]}%)`);attr(div3,\"class\",div3_class_value=arrayJoin([\"DokaSlider\",/*klass*/ctx[7]]));},m(target,anchor){insert(target,div3,anchor);append(div3,input_1);/*input_1_binding*/ctx[14](input_1);append(div3,t0);append(div3,div0);append(div3,t1);append(div3,div2);append(div2,div1);if(!mounted){dispose=[listen(input_1,\"pointerdown\",/*handlePointerDown*/ctx[12]),listen(input_1,\"input\",/*handleInput*/ctx[10]),listen(input_1,\"nudge\",/*handleNudge*/ctx[11]),action_destroyer(nudgeable_action=nudgeable.call(null,input_1))];mounted=true;}},p(ctx,[dirty]){if(dirty&/*id*/16){attr(input_1,\"id\",/*id*/ctx[4]);}if(dirty&/*min*/2){attr(input_1,\"min\",/*min*/ctx[1]);}if(dirty&/*max*/4){attr(input_1,\"max\",/*max*/ctx[2]);}if(dirty&/*step*/8){attr(input_1,\"step\",/*step*/ctx[3]);}if(dirty&/*value*/1){input_1.value=/*value*/ctx[0];}if(dirty&/*trackStyle*/32){attr(div0,\"style\",/*trackStyle*/ctx[5]);}if(dirty&/*knobStyle*/64){attr(div1,\"style\",/*knobStyle*/ctx[6]);}if(dirty&/*position*/512&&div2_style_value!==(div2_style_value=`transform: translateX(${/*position*/ctx[9]}%)`)){attr(div2,\"style\",div2_style_value);}if(dirty&/*klass*/128&&div3_class_value!==(div3_class_value=arrayJoin([\"DokaSlider\",/*klass*/ctx[7]]))){attr(div3,\"class\",div3_class_value);}},i:noop$1,o:noop$1,d(detaching){if(detaching)detach(div3);/*input_1_binding*/ctx[14](null);mounted=false;run_all(dispose);}};}function instance$h($$self,$$props,$$invalidate){let{min=0}=$$props;let{max=100}=$$props;let{step=1}=$$props;let{id=undefined}=$$props;let{value=0}=$$props;let{trackStyle=undefined}=$$props;let{knobStyle=undefined}=$$props;let{onchange=undefined}=$$props;let{class:klass=undefined}=$$props;let input;let inputWidth;let inputOffsetX;let pageOffsetX;const setValueByOffsetX=(offsetX,inputWidth)=>{$$invalidate(0,value=clamp(min+offsetX/inputWidth*range,min,max));onchange(value);};const handleInput=e=>{// already handled by pointer events\nif(inputWidth)return;$$invalidate(0,value=parseFloat(e.target.value));onchange(value);};const handleNudge=e=>{const width=input.offsetWidth;const offset=value/range*width;setValueByOffsetX(offset+e.detail.x,width);};const handlePointerDown=e=>{e.stopPropagation();inputWidth=input.offsetWidth;inputOffsetX=e.offsetX;pageOffsetX=e.pageX;setValueByOffsetX(inputOffsetX,inputWidth);document.documentElement.addEventListener(\"pointermove\",handlePointerMove);document.documentElement.addEventListener(\"pointerup\",handlePointerUp);};const handlePointerMove=e=>{const dx=e.pageX-pageOffsetX;setValueByOffsetX(inputOffsetX+dx,inputWidth);};const handlePointerUp=e=>{inputWidth=undefined;document.documentElement.removeEventListener(\"pointermove\",handlePointerMove);document.documentElement.removeEventListener(\"pointerup\",handlePointerUp);onchange(value);};function input_1_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{input=$$value;$$invalidate(8,input);});}$$self.$$set=$$props=>{if(\"min\"in $$props)$$invalidate(1,min=$$props.min);if(\"max\"in $$props)$$invalidate(2,max=$$props.max);if(\"step\"in $$props)$$invalidate(3,step=$$props.step);if(\"id\"in $$props)$$invalidate(4,id=$$props.id);if(\"value\"in $$props)$$invalidate(0,value=$$props.value);if(\"trackStyle\"in $$props)$$invalidate(5,trackStyle=$$props.trackStyle);if(\"knobStyle\"in $$props)$$invalidate(6,knobStyle=$$props.knobStyle);if(\"onchange\"in $$props)$$invalidate(13,onchange=$$props.onchange);if(\"class\"in $$props)$$invalidate(7,klass=$$props.class);};let range;let position;$$self.$$.update=()=>{if($$self.$$.dirty&/*max, min*/6){$$invalidate(18,range=max-min);}if($$self.$$.dirty&/*value, range*/262145){$$invalidate(9,position=value/range*100);}};return[value,min,max,step,id,trackStyle,knobStyle,klass,input,position,handleInput,handleNudge,handlePointerDown,onchange,input_1_binding];}class Slider extends SvelteComponent{constructor(options){super();init(this,options,instance$h,create_fragment$h,safe_not_equal,{min:1,max:2,step:3,id:4,value:0,trackStyle:5,knobStyle:6,onchange:13,class:7});}}var RGBToHSV=(r,g,b)=>{let v=Math.max(r,g,b),n=v-Math.min(r,g,b);let h=n&&(v==r?(g-b)/n:v==g?2+(b-r)/n:4+(r-g)/n);return[60*(h<0?h+6:h)/360,v&&n/v,v];};var HSVToRGB=(h,s,v)=>{let r,g,b;const i=Math.floor(h*6);const f=h*6-i;const p=v*(1-s);const q=v*(1-f*s);const t=v*(1-(1-f)*s);switch(i%6){case 0:r=v,g=t,b=p;break;case 1:r=q,g=v,b=p;break;case 2:r=p,g=v,b=t;break;case 3:r=p,g=q,b=v;break;case 4:r=t,g=p,b=v;break;case 5:r=v,g=p,b=q;break;}return[r,g,b];};/* src/core/ui/components/ColorPreview.svelte generated by Svelte v3.29.4 */function create_fragment$i(ctx){let div;let span;let div_style_value;return{c(){div=element(\"div\");span=element(\"span\");attr(div,\"class\",\"DokaColorPreview\");attr(div,\"title\",/*title*/ctx[0]);attr(div,\"style\",div_style_value=`--color:${/*colorValue*/ctx[1]}`);},m(target,anchor){insert(target,div,anchor);append(div,span);},p(ctx,[dirty]){if(dirty&/*title*/1){attr(div,\"title\",/*title*/ctx[0]);}if(dirty&/*colorValue*/2&&div_style_value!==(div_style_value=`--color:${/*colorValue*/ctx[1]}`)){attr(div,\"style\",div_style_value);}},i:noop$1,o:noop$1,d(detaching){if(detaching)detach(div);}};}function instance$i($$self,$$props,$$invalidate){let{color=undefined}=$$props;let{title=undefined}=$$props;$$self.$$set=$$props=>{if(\"color\"in $$props)$$invalidate(2,color=$$props.color);if(\"title\"in $$props)$$invalidate(0,title=$$props.title);};let colorValue;$$self.$$.update=()=>{if($$self.$$.dirty&/*color*/4){$$invalidate(1,colorValue=color?colorArrayToRGBA(color):\"transparent\");}};return[title,colorValue,color];}class ColorPreview extends SvelteComponent{constructor(options){super();init(this,options,instance$i,create_fragment$i,safe_not_equal,{color:2,title:0});}}/* src/core/ui/components/ColorPicker.svelte generated by Svelte v3.29.4 */function create_if_block_4$2(ctx){let span;let t;return{c(){span=element(\"span\");t=text(/*label*/ctx[0]);},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty[0]&/*label*/1)set_data(t,/*label*/ctx[0]);},d(detaching){if(detaching)detach(span);}};}// (312:4) <span slot=\"label\" class=\"DokaButtonLabel\">\nfunction create_label_slot$1(ctx){let span;let colorpreview;let t;let current;colorpreview=new ColorPreview({props:{color:/*value*/ctx[4],title:localize(/*title*/ctx[8],/*locale*/ctx[10])}});let if_block=!/*hidePresetLabel*/ctx[9]&&create_if_block_4$2(ctx);return{c(){span=element(\"span\");create_component(colorpreview.$$.fragment);t=space();if(if_block)if_block.c();attr(span,\"slot\",\"label\");attr(span,\"class\",\"DokaButtonLabel\");},m(target,anchor){insert(target,span,anchor);mount_component(colorpreview,span,null);append(span,t);if(if_block)if_block.m(span,null);current=true;},p(ctx,dirty){const colorpreview_changes={};if(dirty[0]&/*value*/16)colorpreview_changes.color=/*value*/ctx[4];if(dirty[0]&/*title, locale*/1280)colorpreview_changes.title=localize(/*title*/ctx[8],/*locale*/ctx[10]);colorpreview.$set(colorpreview_changes);if(!/*hidePresetLabel*/ctx[9]){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block_4$2(ctx);if_block.c();if_block.m(span,null);}}else if(if_block){if_block.d(1);if_block=null;}},i(local){if(current)return;transition_in(colorpreview.$$.fragment,local);current=true;},o(local){transition_out(colorpreview.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(span);destroy_component(colorpreview);if(if_block)if_block.d();}};}// (324:8) {#if enablePicker}\nfunction create_if_block_2$3(ctx){let div3;let div2;let div1;let div0;let div0_style_value;let nudgeable_action;let div1_style_value;let div2_style_value;let t0;let slider;let t1;let current;let mounted;let dispose;slider=new Slider({props:{class:\"DokaHuePicker\",knobStyle:`background-color:${/*valueAsRGBAFullySaturated*/ctx[19]}`,onchange:/*updateHue*/ctx[24],value:/*hue*/ctx[14],min:0,max:1,step:0.001}});let if_block=/*enableOpacity*/ctx[11]&&create_if_block_3$2(ctx);return{c(){div3=element(\"div\");div2=element(\"div\");div1=element(\"div\");div0=element(\"div\");t0=space();create_component(slider.$$.fragment);t1=space();if(if_block)if_block.c();attr(div0,\"role\",\"button\");attr(div0,\"class\",\"DokaPickerKnob\");attr(div0,\"tabindex\",\"0\");attr(div0,\"style\",div0_style_value=`background-color:${/*valueAsRGBAFullyOpaque*/ctx[18]};`);attr(div1,\"class\",\"DokaPickerKnobController\");attr(div1,\"style\",div1_style_value=`transform:translate(${/*sx*/ctx[21]}%,${/*sy*/ctx[22]}%)`);attr(div2,\"class\",\"DokaSaturationPicker\");attr(div2,\"style\",div2_style_value=`background-color: ${/*valueAsRGBAFullySaturated*/ctx[19]}`);attr(div3,\"class\",\"DokaPicker\");},m(target,anchor){insert(target,div3,anchor);append(div3,div2);append(div2,div1);append(div1,div0);/*div2_binding*/ctx[29](div2);append(div3,t0);mount_component(slider,div3,null);append(div3,t1);if(if_block)if_block.m(div3,null);current=true;if(!mounted){dispose=[listen(div0,\"nudge\",/*handleNudge*/ctx[27]),action_destroyer(nudgeable_action=nudgeable.call(null,div0)),listen(div2,\"pointerdown\",/*handlePointerDown*/ctx[26])];mounted=true;}},p(ctx,dirty){if(!current||dirty[0]&/*valueAsRGBAFullyOpaque*/262144&&div0_style_value!==(div0_style_value=`background-color:${/*valueAsRGBAFullyOpaque*/ctx[18]};`)){attr(div0,\"style\",div0_style_value);}if(!current||dirty[0]&/*sx, sy*/6291456&&div1_style_value!==(div1_style_value=`transform:translate(${/*sx*/ctx[21]}%,${/*sy*/ctx[22]}%)`)){attr(div1,\"style\",div1_style_value);}if(!current||dirty[0]&/*valueAsRGBAFullySaturated*/524288&&div2_style_value!==(div2_style_value=`background-color: ${/*valueAsRGBAFullySaturated*/ctx[19]}`)){attr(div2,\"style\",div2_style_value);}const slider_changes={};if(dirty[0]&/*valueAsRGBAFullySaturated*/524288)slider_changes.knobStyle=`background-color:${/*valueAsRGBAFullySaturated*/ctx[19]}`;if(dirty[0]&/*hue*/16384)slider_changes.value=/*hue*/ctx[14];slider.$set(slider_changes);if(/*enableOpacity*/ctx[11]){if(if_block){if_block.p(ctx,dirty);if(dirty[0]&/*enableOpacity*/2048){transition_in(if_block,1);}}else{if_block=create_if_block_3$2(ctx);if_block.c();transition_in(if_block,1);if_block.m(div3,null);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}},i(local){if(current)return;transition_in(slider.$$.fragment,local);transition_in(if_block);current=true;},o(local){transition_out(slider.$$.fragment,local);transition_out(if_block);current=false;},d(detaching){if(detaching)detach(div3);/*div2_binding*/ctx[29](null);destroy_component(slider);if(if_block)if_block.d();mounted=false;run_all(dispose);}};}// (344:12) {#if enableOpacity}\nfunction create_if_block_3$2(ctx){let slider;let current;slider=new Slider({props:{class:\"DokaOpacityPicker\",knobStyle:`background-color: ${/*valueAsRGBA*/ctx[16]}`,trackStyle:`background-image: linear-gradient(to right, ${/*valueAsRGBAFullyTransparent*/ctx[17]}, ${/*valueAsRGBAFullyOpaque*/ctx[18]})`,onchange:/*updateOpacity*/ctx[25],value:/*opacity*/ctx[15],min:0,max:1,step:0.001}});return{c(){create_component(slider.$$.fragment);},m(target,anchor){mount_component(slider,target,anchor);current=true;},p(ctx,dirty){const slider_changes={};if(dirty[0]&/*valueAsRGBA*/65536)slider_changes.knobStyle=`background-color: ${/*valueAsRGBA*/ctx[16]}`;if(dirty[0]&/*valueAsRGBAFullyTransparent, valueAsRGBAFullyOpaque*/393216)slider_changes.trackStyle=`background-image: linear-gradient(to right, ${/*valueAsRGBAFullyTransparent*/ctx[17]}, ${/*valueAsRGBAFullyOpaque*/ctx[18]})`;if(dirty[0]&/*opacity*/32768)slider_changes.value=/*opacity*/ctx[15];slider.$set(slider_changes);},i(local){if(current)return;transition_in(slider.$$.fragment,local);current=true;},o(local){transition_out(slider.$$.fragment,local);current=false;},d(detaching){destroy_component(slider,detaching);}};}// (357:8) {#if enablePresets}\nfunction create_if_block$4(ctx){let radiogroup;let current;radiogroup=new RadioGroup({props:{label:\"Presets\",class:arrayJoin([\"DokaColorPresets\",/*hidePresetLabel*/ctx[9]?\"DokaColorPresetsGrid\":\"DokaColorPresetsList\"]),hideLabel:false,name:/*name*/ctx[1],value:/*value*/ctx[4],optionGroupClass:\"DokaDropdownOptionGroup\",optionClass:\"DokaDropdownOption\",options:/*options*/ctx[2].map(/*func*/ctx[30]),selectedIndex:/*selectedIndex*/ctx[3],optionMapper:/*optionMapper*/ctx[7],optionLabelClass:/*optionLabelClass*/ctx[6],onchange:/*func_1*/ctx[31],$$slots:{default:[create_default_slot_1$3,({option})=>({44:option}),({option})=>[0,option?8192:0]],option:[create_option_slot$1,({option})=>({44:option}),({option})=>[0,option?8192:0]],group:[create_group_slot$1,({option})=>({44:option}),({option})=>[0,option?8192:0]]},$$scope:{ctx}}});return{c(){create_component(radiogroup.$$.fragment);},m(target,anchor){mount_component(radiogroup,target,anchor);current=true;},p(ctx,dirty){const radiogroup_changes={};if(dirty[0]&/*hidePresetLabel*/512)radiogroup_changes.class=arrayJoin([\"DokaColorPresets\",/*hidePresetLabel*/ctx[9]?\"DokaColorPresetsGrid\":\"DokaColorPresetsList\"]);if(dirty[0]&/*name*/2)radiogroup_changes.name=/*name*/ctx[1];if(dirty[0]&/*value*/16)radiogroup_changes.value=/*value*/ctx[4];if(dirty[0]&/*options, locale*/1028)radiogroup_changes.options=/*options*/ctx[2].map(/*func*/ctx[30]);if(dirty[0]&/*selectedIndex*/8)radiogroup_changes.selectedIndex=/*selectedIndex*/ctx[3];if(dirty[0]&/*optionMapper*/128)radiogroup_changes.optionMapper=/*optionMapper*/ctx[7];if(dirty[0]&/*optionLabelClass*/64)radiogroup_changes.optionLabelClass=/*optionLabelClass*/ctx[6];if(dirty[0]&/*hidePresetLabel*/512|dirty[1]&/*$$scope, option*/24576){radiogroup_changes.$$scope={dirty,ctx};}radiogroup.$set(radiogroup_changes);},i(local){if(current)return;transition_in(radiogroup.$$.fragment,local);current=true;},o(local){transition_out(radiogroup.$$.fragment,local);current=false;},d(detaching){destroy_component(radiogroup,detaching);}};}// (373:12) <span slot=\"group\">\nfunction create_group_slot$1(ctx){let span;let t_value=/*option*/ctx[44].label+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);attr(span,\"slot\",\"group\");},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty[1]&/*option*/8192&&t_value!==(t_value=/*option*/ctx[44].label+\"\"))set_data(t,t_value);},d(detaching){if(detaching)detach(span);}};}// (378:16) {#if !hidePresetLabel}\nfunction create_if_block_1$5(ctx){let span;let t_value=/*option*/ctx[44].label+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);attr(span,\"class\",\"DokaButtonLabel\");},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty[1]&/*option*/8192&&t_value!==(t_value=/*option*/ctx[44].label+\"\"))set_data(t,t_value);},d(detaching){if(detaching)detach(span);}};}// (376:12) <span slot=\"option\">\nfunction create_option_slot$1(ctx){let span;let colorpreview;let t;let current;colorpreview=new ColorPreview({props:{title:/*option*/ctx[44].label,color:/*option*/ctx[44].value}});let if_block=!/*hidePresetLabel*/ctx[9]&&create_if_block_1$5(ctx);return{c(){span=element(\"span\");create_component(colorpreview.$$.fragment);t=space();if(if_block)if_block.c();attr(span,\"slot\",\"option\");},m(target,anchor){insert(target,span,anchor);mount_component(colorpreview,span,null);append(span,t);if(if_block)if_block.m(span,null);current=true;},p(ctx,dirty){const colorpreview_changes={};if(dirty[1]&/*option*/8192)colorpreview_changes.title=/*option*/ctx[44].label;if(dirty[1]&/*option*/8192)colorpreview_changes.color=/*option*/ctx[44].value;colorpreview.$set(colorpreview_changes);if(!/*hidePresetLabel*/ctx[9]){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block_1$5(ctx);if_block.c();if_block.m(span,null);}}else if(if_block){if_block.d(1);if_block=null;}},i(local){if(current)return;transition_in(colorpreview.$$.fragment,local);current=true;},o(local){transition_out(colorpreview.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(span);destroy_component(colorpreview);if(if_block)if_block.d();}};}// (359:8) <RadioGroup              label=\"Presets\"             class={arrayJoin(['DokaColorPresets', hidePresetLabel ? 'DokaColorPresetsGrid' : 'DokaColorPresetsList'])}             hideLabel={false}             {name}             {value}             optionGroupClass=\"DokaDropdownOptionGroup\"             optionClass=\"DokaDropdownOption\"             options={options.map(([color, label]) => [color, isFunction(label) ? label(locale) : label])}             {selectedIndex}             {optionMapper}             {optionLabelClass}             onchange={(detail) => updateColorArray(detail.value)}             let:option>\nfunction create_default_slot_1$3(ctx){let t;return{c(){t=space();},m(target,anchor){insert(target,t,anchor);},p:noop$1,i:noop$1,o:noop$1,d(detaching){if(detaching)detach(t);}};}// (321:4) <div slot=\"details\" class=\"DokaColorPickerPanel\">\nfunction create_details_slot$1(ctx){let div;let t;let current;let if_block0=/*enablePicker*/ctx[13]&&create_if_block_2$3(ctx);let if_block1=/*enablePresets*/ctx[12]&&create_if_block$4(ctx);return{c(){div=element(\"div\");if(if_block0)if_block0.c();t=space();if(if_block1)if_block1.c();attr(div,\"slot\",\"details\");attr(div,\"class\",\"DokaColorPickerPanel\");},m(target,anchor){insert(target,div,anchor);if(if_block0)if_block0.m(div,null);append(div,t);if(if_block1)if_block1.m(div,null);current=true;},p(ctx,dirty){if(/*enablePicker*/ctx[13]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*enablePicker*/8192){transition_in(if_block0,1);}}else{if_block0=create_if_block_2$3(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(div,t);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(/*enablePresets*/ctx[12]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*enablePresets*/4096){transition_in(if_block1,1);}}else{if_block1=create_if_block$4(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(div,null);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,()=>{if_block1=null;});check_outros();}},i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);current=true;},o(local){transition_out(if_block0);transition_out(if_block1);current=false;},d(detaching){if(detaching)detach(div);if(if_block0)if_block0.d();if(if_block1)if_block1.d();}};}// (310:0) <Details buttonClass={arrayJoin(['DokaColorPickerButton', buttonClass])}>\nfunction create_default_slot$5(ctx){let t;return{c(){t=space();},m(target,anchor){insert(target,t,anchor);},p:noop$1,i:noop$1,o:noop$1,d(detaching){if(detaching)detach(t);}};}function create_fragment$j(ctx){let details;let current;details=new Details({props:{buttonClass:arrayJoin([\"DokaColorPickerButton\",/*buttonClass*/ctx[5]]),$$slots:{default:[create_default_slot$5],details:[create_details_slot$1],label:[create_label_slot$1]},$$scope:{ctx}}});return{c(){create_component(details.$$.fragment);},m(target,anchor){mount_component(details,target,anchor);current=true;},p(ctx,dirty){const details_changes={};if(dirty[0]&/*buttonClass*/32)details_changes.buttonClass=arrayJoin([\"DokaColorPickerButton\",/*buttonClass*/ctx[5]]);if(dirty[0]&/*hidePresetLabel, name, value, options, locale, selectedIndex, optionMapper, optionLabelClass, enablePresets, valueAsRGBA, valueAsRGBAFullyTransparent, valueAsRGBAFullyOpaque, opacity, enableOpacity, valueAsRGBAFullySaturated, hue, input, sx, sy, enablePicker, label, title*/8388575|dirty[1]&/*$$scope*/16384){details_changes.$$scope={dirty,ctx};}details.$set(details_changes);},i(local){if(current)return;transition_in(details.$$.fragment,local);current=true;},o(local){transition_out(details.$$.fragment,local);current=false;},d(detaching){destroy_component(details,detaching);}};}function instance$j($$self,$$props,$$invalidate){let{label=undefined}=$$props;let{name=undefined}=$$props;let{options=[]}=$$props;let{selectedIndex=-1}=$$props;let{value=undefined}=$$props;let{buttonClass=undefined}=$$props;let{optionLabelClass=undefined}=$$props;let{optionMapper=undefined}=$$props;let{onchange=undefined}=$$props;let{title=undefined}=$$props;let{hidePresetLabel=true}=$$props;let{locale=undefined}=$$props;let{enableOpacity=true}=$$props;let{enablePresets=true}=$$props;let{enablePicker=true}=$$props;// inputs\nlet hue;let saturation;let brightness;let opacity;// shortcuts\nlet valueAsRGB;let valueAsRGBA;let valueAsRGBAFullyTransparent;let valueAsRGBAFullyOpaque;let valueAsRGBAFullySaturated;const updateProps=(color,syncControls)=>{valueAsRGB=[color[0],color[1],color[2]];if(syncControls){let valueAsHSV=RGBToHSV(...valueAsRGB);$$invalidate(14,hue=valueAsHSV[0]);$$invalidate(32,saturation=valueAsHSV[1]);$$invalidate(33,brightness=valueAsHSV[2]);$$invalidate(15,opacity=isNumber(color[3])?color[3]:1);}$$invalidate(16,valueAsRGBA=colorArrayToRGBA(color));$$invalidate(17,valueAsRGBAFullyTransparent=colorArrayToRGBA([...valueAsRGB,0]));$$invalidate(18,valueAsRGBAFullyOpaque=colorArrayToRGBA([...valueAsRGB,1]));$$invalidate(19,valueAsRGBAFullySaturated=colorArrayToRGBA(HSVToRGB(hue,1,1)));};value&&updateProps(value,true);const update=()=>{const rgb=HSVToRGB(hue,saturation,brightness);const rgba=[...rgb,opacity];updateProps(rgba);onchange(rgba);};const updateColorArray=arr=>{const rgba=arr.length===3?[...arr,1]:arr;updateProps(rgba,true);onchange(rgba);};const updateHue=h=>{$$invalidate(14,hue=h);if(opacity===0)$$invalidate(15,opacity=1);update();};const updateSaturationAndBrightness=(s,b)=>{$$invalidate(32,saturation=s);$$invalidate(33,brightness=b);if(opacity===0)$$invalidate(15,opacity=1);update();};const updateOpacity=o=>{$$invalidate(15,opacity=o);update();};const setValueByOffset=(offset,inputSize)=>{const x=clamp(offset.x/inputSize.width,0,1);const y=clamp(offset.y/inputSize.height,0,1);updateSaturationAndBrightness(x,1-y);};let input;let inputSize;let inputOffset;let inputPageOffset;const handlePointerDown=e=>{e.stopPropagation();inputSize=sizeCreate(input.offsetWidth,input.offsetHeight);inputOffset=vectorCreateFromPointerEventOffset(e);inputPageOffset=vectorCreateFromPointerEvent(e);setValueByOffset(inputOffset,inputSize);document.documentElement.addEventListener(\"pointermove\",handlePointerMove);document.documentElement.addEventListener(\"pointerup\",handlePointerUp);};const handlePointerMove=e=>{const d=vectorSubtract(vectorCreateFromPointerEvent(e),inputPageOffset);setValueByOffset(vectorAdd(vectorClone(inputOffset),d),inputSize);};const handlePointerUp=e=>{inputSize=undefined;document.documentElement.removeEventListener(\"pointermove\",handlePointerMove);document.documentElement.removeEventListener(\"pointerup\",handlePointerUp);};const handleNudge=e=>{inputSize=sizeCreate(input.offsetWidth,input.offsetHeight);const x=sx/100*inputSize.width;const y=sy/100*inputSize.height;setValueByOffset({x:x+e.detail.x,y:y+e.detail.y},inputSize);};function div2_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{input=$$value;$$invalidate(20,input);});}const func=([color,label])=>[color,isFunction(label)?label(locale):label];const func_1=detail=>updateColorArray(detail.value);$$self.$$set=$$props=>{if(\"label\"in $$props)$$invalidate(0,label=$$props.label);if(\"name\"in $$props)$$invalidate(1,name=$$props.name);if(\"options\"in $$props)$$invalidate(2,options=$$props.options);if(\"selectedIndex\"in $$props)$$invalidate(3,selectedIndex=$$props.selectedIndex);if(\"value\"in $$props)$$invalidate(4,value=$$props.value);if(\"buttonClass\"in $$props)$$invalidate(5,buttonClass=$$props.buttonClass);if(\"optionLabelClass\"in $$props)$$invalidate(6,optionLabelClass=$$props.optionLabelClass);if(\"optionMapper\"in $$props)$$invalidate(7,optionMapper=$$props.optionMapper);if(\"onchange\"in $$props)$$invalidate(28,onchange=$$props.onchange);if(\"title\"in $$props)$$invalidate(8,title=$$props.title);if(\"hidePresetLabel\"in $$props)$$invalidate(9,hidePresetLabel=$$props.hidePresetLabel);if(\"locale\"in $$props)$$invalidate(10,locale=$$props.locale);if(\"enableOpacity\"in $$props)$$invalidate(11,enableOpacity=$$props.enableOpacity);if(\"enablePresets\"in $$props)$$invalidate(12,enablePresets=$$props.enablePresets);if(\"enablePicker\"in $$props)$$invalidate(13,enablePicker=$$props.enablePicker);};let sx;let sy;$$self.$$.update=()=>{if($$self.$$.dirty[1]&/*saturation*/2){$$invalidate(21,sx=saturation*100);}if($$self.$$.dirty[1]&/*brightness*/4){$$invalidate(22,sy=100-brightness*100);}};return[label,name,options,selectedIndex,value,buttonClass,optionLabelClass,optionMapper,title,hidePresetLabel,locale,enableOpacity,enablePresets,enablePicker,hue,opacity,valueAsRGBA,valueAsRGBAFullyTransparent,valueAsRGBAFullyOpaque,valueAsRGBAFullySaturated,input,sx,sy,updateColorArray,updateHue,updateOpacity,handlePointerDown,handleNudge,onchange,div2_binding,func,func_1];}class ColorPicker extends SvelteComponent{constructor(options){super();init(this,options,instance$j,create_fragment$j,safe_not_equal,{label:0,name:1,options:2,selectedIndex:3,value:4,buttonClass:5,optionLabelClass:6,optionMapper:7,onchange:28,title:8,hidePresetLabel:9,locale:10,enableOpacity:11,enablePresets:12,enablePicker:13},[-1,-1]);}}var upperCaseFirstLetter=str=>str.charAt(0).toUpperCase()+str.slice(1);// @ts-ignore\nconst toLocaleFn=(key,localePrefix)=>locale=>locale[localePrefix?`${localePrefix}${upperCaseFirstLetter(key)}`:key];const mapToSizeOption=v=>[v,`${v}`];const createLocaleMapper=(options,localePrefix)=>key=>[options[key],toLocaleFn(key,localePrefix)];const toolColorDefault=[1,0.2549,0.2118];const toolStrokeColorDefault=[1,1,1,0];//#region tools\nconst toolShapeDefaults={path:()=>({points:[],disableErase:false}),line:()=>({x1:0,y1:0,x2:0,y2:0,disableErase:false}),rectangle:()=>({x:0,y:0,width:0,height:0}),ellipse:()=>({x:0,y:0,rx:0,ry:0}),text:()=>({x:0,y:0,text:'Text'})};const createToolStyle=(type,shape={},options={position:'relative'})=>{if(!toolShapeDefaults[type])return;const shapeDef=_objectSpread(_objectSpread({},toolShapeDefaults[type]()),shape);return[shapeDef,options];};const createToolStyles=tools=>_objectSpread({sharpie:createToolStyle('path',{strokeWidth:'0.5%',strokeColor:[...toolColorDefault]}),line:createToolStyle('line',{strokeColor:[...toolColorDefault],strokeWidth:'0.5%'}),arrow:createToolStyle('line',{lineEnd:'arrow-solid',strokeColor:[...toolColorDefault],strokeWidth:'0.5%'}),rectangle:createToolStyle('rectangle',{strokeColor:[...toolStrokeColorDefault],backgroundColor:[...toolColorDefault]}),ellipse:createToolStyle('ellipse',{strokeColor:[...toolStrokeColorDefault],backgroundColor:[...toolColorDefault]}),text:createToolStyle('text',{color:[...toolColorDefault],fontSize:'2%'})},tools);//#endregion\n//#region toolbar\nconst createToolbarItem=(tool,label,props)=>[tool,label||toLocaleFn(tool,'shapeLabelTool'),_objectSpread({icon:toLocaleFn(tool,'shapeIconTool')},props)];const createToolbar=(tools=['sharpie','eraser','line','arrow','rectangle','ellipse','text','preset'])=>tools.map(tool=>{// default tool definition, assume locale in\nif(isString(tool))return createToolbarItem(tool);// tool def with propery\nif(Array.isArray(tool)){// state update of tool with key in locale object\nif(isObject(tool[1]))return createToolbarItem(tool[0],undefined,tool[1]);// should be string, string\nreturn createToolbarItem(tool[0],tool[1],tool[2]);}}).filter(Boolean);//#endregion\n//#region style option defaults\nconst createDefaultColorOptions=()=>({transparent:[1,1,1,0],white:[1,1,1],silver:[0.8667,0.8667,0.8667],gray:[0.6667,0.6667,0.6667],black:[0,0,0],navy:[0,0.1216,0.2471],blue:[0,0.4549,0.851],aqua:[0.498,0.8588,1],teal:[0.2235,0.8,0.8],olive:[0.2392,0.6,0.4392],green:[0.1804,0.8,0.251],yellow:[1,0.8627,0],orange:[1,0.5216,0.1059],red:[1,0.2549,0.2118],maroon:[0.5216,0.0784,0.2941],fuchsia:[0.9412,0.0706,0.7451],purple:[0.6941,0.051,0.7882]});const createDefaultFontSizeOptions=()=>[16,18,20,24,30,36,48,64,72,96,144];const createDefaultFontScaleOptions=()=>({extraSmall:'2%',small:'4%',mediumSmall:'8%',medium:'10%',mediumLarge:'15%',large:'20%',extraLarge:'25%'});const createDefaultStrokeWidthOptions=()=>[1,2,3,4,6,8,12,16,20,24,32,48];const createDefaultStrokeScaleOptions=()=>({extraSmall:'0.25%',small:'0.5%',mediumSmall:'1%',medium:'1.75%',mediumLarge:'2.5%',large:'3.5%',extraLarge:'5%'});const createDefaultLineEndStyleOptions=()=>['bar','arrow','arrowSolid','circle','circleSolid','square','squareSolid'];const createDefaultFontFamilyOptions=()=>[[`Helvetica, Arial, Verdana, 'Droid Sans', sans-serif`,'Sans Serif'],[`'Arial Black', 'Avenir-Black', 'Arial Bold'`,'Black'],[`'Arial Narrow', 'Futura-CondensedMedium'`,'Narrow'],[`'Trebuchet MS'`,'Humanist'],[`Georgia, 'Avenir-Black', 'Times New Roman', 'Droid Serif', serif`,'Serif'],[`Palatino`,'Old-Style'],[`'Times New Roman', 'TimesNewRomanPSMT'`,'Transitional'],[`Menlo, Monaco, 'Lucida Console', monospace`,'Monospaced'],[`'Courier New', monospace`,'Slab Serif']];const createDefaultTextAlignOptions=()=>['left','center','right'];const createDefaultFontStyleOptions=()=>[['normal','bold'],['italic','normal'],['italic','bold']];//#endregion\n//#region style options\nconst createColorOptions=colors=>Object.keys(colors).map(createLocaleMapper(colors,'shapeTitleColor'));const createFontSizeOptions=sizes=>sizes.map(mapToSizeOption);const createFontScaleOptions=scales=>Object.keys(scales).map(createLocaleMapper(scales,'labelSize'));const createStrokeWidthOptions=sizes=>sizes.map(mapToSizeOption);const createStrokeScaleOptions=scales=>Object.keys(scales).map(createLocaleMapper(scales,'labelSize'));const createFontFamilyOptions=fonts=>[...fonts];const createFontStyleOptions=styles=>styles.map(style=>[style,locale=>locale[`shapeLabelFontStyle${style.filter(v=>v!=='normal').map(upperCaseFirstLetter).join('')}`]]);const createLineEndStyleOptions=styles=>styles.map(style=>[toKebabCase(style),locale=>locale[`shapeTitleLineDecoration${upperCaseFirstLetter(style)}`],{icon:locale=>locale[`shapeIconLineDecoration${upperCaseFirstLetter(style)}`]}]);const createTextAlignOptions=options=>options.map(align=>[align,locale=>locale[`shapeTitleTextAlign${upperCaseFirstLetter(align)}`],{hideLabel:true,icon:locale=>locale[`shapeIconTextAlign${upperCaseFirstLetter(align)}`]}]);const createControlOptions=(items,options)=>{const{defaultKey,defaultOptions}=options||{};let arr=[];if(defaultKey)arr[0]=[undefined,locale=>locale[defaultKey],_objectSpread({},defaultOptions)];return[...arr,...items];};//#endregion\n//#region shape style controls\nconst createFontFamilyControl=fontFamilies=>[Dropdown,{title:locale=>locale.shapeTitleFontFamily,optionLabelStyle:value=>`font-family: ${value}`,options:createControlOptions(fontFamilies,{defaultKey:'labelDefault'}),optionFilter:fontFamilyOption=>{// don't filter if not in browser context\nif(!isBrowser())return true;// get font stack\nconst[stack]=fontFamilyOption;// allow if undefined\nif(!stack)return true;// filter out fonts that aren't available\nreturn stack.split(',').map(name=>name.trim()).some(name=>{// @ts-ignore\nreturn document.fonts.check(`16px ${name}`);});}}];const createBackgroundColorControl=items=>[ColorPicker,{title:locale=>locale.shapeTitleBackgroundColor,options:createControlOptions(items)}];const createStrokeColorControl=(items,options={})=>[ColorPicker,{title:locale=>locale.shapeTitleStrokeColor,options:createControlOptions(items),buttonClass:'DokaColorPickerButtonStroke',onchange:(value,shape)=>{// get shape strokeWidth as number\nlet strokeWidth=shape.strokeWidth;let strokeWidthParsed=isNumber(strokeWidth)||isString(strokeWidth)?parseFloat(strokeWidth):0;// already has outline\nif(strokeWidthParsed>0)return;// set outline to first stroke width\nshape.strokeWidth=options&&options.defaultStrokeWidth||'0.5%';}}];const createStrokeWidthControl=items=>[Dropdown,{title:locale=>locale.shapeTitleStrokeWidth,options:shape=>{if(hasProp(shape,'backgroundColor'))return createControlOptions(items,{defaultKey:'shapeLabelStrokeNone'});return createControlOptions(items);}}];const createLineControl=(items,titleKey,optionIconStyle)=>[Dropdown,{title:locale=>locale[titleKey],options:createControlOptions(items,{defaultKey:'labelNone',defaultOptions:{icon:`<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H14\"/></g>`}}),optionIconStyle}];const createLineStartStyleControl=items=>createLineControl(items,'shapeTitleLineStart',`transform: scaleX(-1)`);const createLineEndStyleControl=items=>createLineControl(items,'shapeTitleLineEnd');const createFontColorControl=items=>[ColorPicker,{title:locale=>locale.shapeTitleTextColor,options:createControlOptions(items)}];const createFontStyleControl=items=>[Dropdown,{title:locale=>locale.shapeTitleFontStyle,optionLabelStyle:value=>value&&`font-style:${value[0]};font-weight:${value[1]}`,options:createControlOptions(items,{defaultKey:'shapeLabelFontStyleNormal'})}];const createFontSizeControl=items=>[Dropdown,{title:locale=>locale.shapeTitleFontSize,options:createControlOptions(items,{defaultKey:'labelDefault'})}];const createTextAlignControl=items=>[RadioGroup,{title:locale=>locale.shapeTitleTextAlign,options:createControlOptions(items)}];const createLineHeightControl=items=>[Dropdown,{title:locale=>locale.shapeTitleLineHeight,options:createControlOptions(items,{defaultKey:'labelAuto'})}];const createShapeStyleControls=(options={})=>{const{colorOptions=createColorOptions(createDefaultColorOptions()),strokeWidthOptions=createStrokeScaleOptions(createDefaultStrokeScaleOptions()),lineEndStyleOptions=createLineEndStyleOptions(createDefaultLineEndStyleOptions()),fontFamilyOptions=createFontFamilyOptions(createDefaultFontFamilyOptions()),fontStyleOptions=createFontStyleOptions(createDefaultFontStyleOptions()),fontSizeOptions=createFontScaleOptions(createDefaultFontScaleOptions()),textAlignOptions=createTextAlignOptions(createDefaultTextAlignOptions())}=options;return{// shape background\nbackgroundColor:colorOptions&&createBackgroundColorControl(colorOptions),// line/outline\nstrokeColor:colorOptions&&createStrokeColorControl(colorOptions),strokeWidth:strokeWidthOptions&&createStrokeWidthControl(strokeWidthOptions),// line\nlineStart:lineEndStyleOptions&&createLineStartStyleControl(lineEndStyleOptions),lineEnd:lineEndStyleOptions&&createLineEndStyleControl(lineEndStyleOptions),// text\ncolor:colorOptions&&createFontColorControl(colorOptions),fontFamily:fontFamilyOptions&&createFontFamilyControl(fontFamilyOptions),fontStyle_fontWeight:fontStyleOptions&&createFontStyleControl(fontStyleOptions),fontSize:fontSizeOptions&&createFontSizeControl(fontSizeOptions),textAlign:textAlignOptions&&createTextAlignControl(textAlignOptions)};};//#endregion\n/* src/core/ui/components/Measure.svelte generated by Svelte v3.29.4 */function create_fragment$k(ctx){let div;let measurable_action;let current;let mounted;let dispose;const default_slot_template=/*#slots*/ctx[3].default;const default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[2],null);return{c(){div=element(\"div\");if(default_slot)default_slot.c();attr(div,\"class\",/*klass*/ctx[0]);},m(target,anchor){insert(target,div,anchor);if(default_slot){default_slot.m(div,null);}current=true;if(!mounted){dispose=[listen(div,\"measure\",/*handleResize*/ctx[1]),action_destroyer(measurable_action=measurable.call(null,div))];mounted=true;}},p(ctx,[dirty]){if(default_slot){if(default_slot.p&&dirty&/*$$scope*/4){update_slot(default_slot,default_slot_template,ctx,/*$$scope*/ctx[2],dirty,null,null);}}if(!current||dirty&/*klass*/1){attr(div,\"class\",/*klass*/ctx[0]);}},i(local){if(current)return;transition_in(default_slot,local);current=true;},o(local){transition_out(default_slot,local);current=false;},d(detaching){if(detaching)detach(div);if(default_slot)default_slot.d(detaching);mounted=false;run_all(dispose);}};}function instance$k($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope}=$$props;const dispatch=createEventDispatcher();let{class:klass=null}=$$props;const handleResize=({detail})=>dispatch(\"measure\",detail);$$self.$$set=$$props=>{if(\"class\"in $$props)$$invalidate(0,klass=$$props.class);if(\"$$scope\"in $$props)$$invalidate(2,$$scope=$$props.$$scope);};return[klass,handleResize,$$scope,slots];}class Measure extends SvelteComponent{constructor(options){super();init(this,options,instance$k,create_fragment$k,safe_not_equal,{class:0});}}/* src/core/ui/components/Util.svelte generated by Svelte v3.29.4 */const get_footer_slot_changes=dirty=>({});const get_footer_slot_context=ctx=>({});const get_main_slot_changes=dirty=>({});const get_main_slot_context=ctx=>({});const get_header_slot_changes=dirty=>({});const get_header_slot_context=ctx=>({});// (209:0) {#if hasHeader}\nfunction create_if_block_2$4(ctx){let div;let current;const header_slot_template=/*#slots*/ctx[4].header;const header_slot=create_slot(header_slot_template,ctx,/*$$scope*/ctx[3],get_header_slot_context);return{c(){div=element(\"div\");if(header_slot)header_slot.c();attr(div,\"class\",\"DokaUtilHeader\");},m(target,anchor){insert(target,div,anchor);if(header_slot){header_slot.m(div,null);}current=true;},p(ctx,dirty){if(header_slot){if(header_slot.p&&dirty&/*$$scope*/8){update_slot(header_slot,header_slot_template,ctx,/*$$scope*/ctx[3],dirty,get_header_slot_changes,get_header_slot_context);}}},i(local){if(current)return;transition_in(header_slot,local);current=true;},o(local){transition_out(header_slot,local);current=false;},d(detaching){if(detaching)detach(div);if(header_slot)header_slot.d(detaching);}};}// (216:22) <Measure class=\"DokaStage\" on:measure/>\nfunction fallback_block$2(ctx){let measure;let current;measure=new Measure({props:{class:\"DokaStage\"}});measure.$on(\"measure\",/*measure_handler*/ctx[5]);return{c(){create_component(measure.$$.fragment);},m(target,anchor){mount_component(measure,target,anchor);current=true;},p:noop$1,i(local){if(current)return;transition_in(measure.$$.fragment,local);current=true;},o(local){transition_out(measure.$$.fragment,local);current=false;},d(detaching){destroy_component(measure,detaching);}};}// (219:0) {#if hasFooter}\nfunction create_if_block_1$6(ctx){let div;let current;const footer_slot_template=/*#slots*/ctx[4].footer;const footer_slot=create_slot(footer_slot_template,ctx,/*$$scope*/ctx[3],get_footer_slot_context);return{c(){div=element(\"div\");if(footer_slot)footer_slot.c();attr(div,\"class\",\"DokaUtilFooter\");},m(target,anchor){insert(target,div,anchor);if(footer_slot){footer_slot.m(div,null);}current=true;},p(ctx,dirty){if(footer_slot){if(footer_slot.p&&dirty&/*$$scope*/8){update_slot(footer_slot,footer_slot_template,ctx,/*$$scope*/ctx[3],dirty,get_footer_slot_changes,get_footer_slot_context);}}},i(local){if(current)return;transition_in(footer_slot,local);current=true;},o(local){transition_out(footer_slot,local);current=false;},d(detaching){if(detaching)detach(div);if(footer_slot)footer_slot.d(detaching);}};}function create_fragment$l(ctx){let t0;let div;let t1;let t2;let if_block2_anchor;let current;let if_block0=/*hasHeader*/ctx[1]&&create_if_block_2$4(ctx);const main_slot_template=/*#slots*/ctx[4].main;const main_slot=create_slot(main_slot_template,ctx,/*$$scope*/ctx[3],get_main_slot_context);const main_slot_or_fallback=main_slot||fallback_block$2(ctx);let if_block1=/*hasFooter*/ctx[2]&&create_if_block_1$6(ctx);let if_block2=false;return{c(){if(if_block0)if_block0.c();t0=space();div=element(\"div\");if(main_slot_or_fallback)main_slot_or_fallback.c();t1=space();if(if_block1)if_block1.c();t2=space();if_block2_anchor=empty();attr(div,\"class\",\"DokaUtilMain\");},m(target,anchor){if(if_block0)if_block0.m(target,anchor);insert(target,t0,anchor);insert(target,div,anchor);if(main_slot_or_fallback){main_slot_or_fallback.m(div,null);}/*div_binding*/ctx[6](div);insert(target,t1,anchor);if(if_block1)if_block1.m(target,anchor);insert(target,t2,anchor);insert(target,if_block2_anchor,anchor);current=true;},p(ctx,[dirty]){if(/*hasHeader*/ctx[1]){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*hasHeader*/2){transition_in(if_block0,1);}}else{if_block0=create_if_block_2$4(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t0.parentNode,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(main_slot){if(main_slot.p&&dirty&/*$$scope*/8){update_slot(main_slot,main_slot_template,ctx,/*$$scope*/ctx[3],dirty,get_main_slot_changes,get_main_slot_context);}}if(/*hasFooter*/ctx[2]){if(if_block1){if_block1.p(ctx,dirty);if(dirty&/*hasFooter*/4){transition_in(if_block1,1);}}else{if_block1=create_if_block_1$6(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(t2.parentNode,t2);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,()=>{if_block1=null;});check_outros();}},i(local){if(current)return;transition_in(if_block0);transition_in(main_slot_or_fallback,local);transition_in(if_block1);transition_in(if_block2);current=true;},o(local){transition_out(if_block0);transition_out(main_slot_or_fallback,local);transition_out(if_block1);transition_out(if_block2);current=false;},d(detaching){if(if_block0)if_block0.d(detaching);if(detaching)detach(t0);if(detaching)detach(div);if(main_slot_or_fallback)main_slot_or_fallback.d(detaching);/*div_binding*/ctx[6](null);if(detaching)detach(t1);if(if_block1)if_block1.d(detaching);if(detaching)detach(t2);if(detaching)detach(if_block2_anchor);}};}function instance$l($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope}=$$props;let{hasHeader=!!$$props.$$slots.header}=$$props;let{hasFooter=!!$$props.$$slots.footer}=$$props;let{root=undefined}=$$props;function measure_handler(event){bubble($$self,event);}function div_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{root=$$value;$$invalidate(0,root);});}$$self.$$set=$$new_props=>{$$invalidate(7,$$props=assign(assign({},$$props),exclude_internal_props($$new_props)));if(\"hasHeader\"in $$new_props)$$invalidate(1,hasHeader=$$new_props.hasHeader);if(\"hasFooter\"in $$new_props)$$invalidate(2,hasFooter=$$new_props.hasFooter);if(\"root\"in $$new_props)$$invalidate(0,root=$$new_props.root);if(\"$$scope\"in $$new_props)$$invalidate(3,$$scope=$$new_props.$$scope);};$$props=exclude_internal_props($$props);return[root,hasHeader,hasFooter,$$scope,slots,measure_handler,div_binding];}class Util extends SvelteComponent{constructor(options){super();init(this,options,instance$l,create_fragment$l,safe_not_equal,{hasHeader:1,hasFooter:2,root:0});}}var toFraction=(value,min,max)=>(value-min)/(max-min);/* src/core/ui/components/RangeInput.svelte generated by Svelte v3.29.4 */function create_if_block$5(ctx){let div;let div_style_value;return{c(){div=element(\"div\");attr(div,\"class\",\"DokaRangeInputMeter\");attr(div,\"style\",div_style_value=`transform: translateX(${/*$position*/ctx[9].x-/*svgPadding*/ctx[10].x}px) translateY(${/*$position*/ctx[9].y-/*svgPadding*/ctx[10].y}px)`);},m(target,anchor){insert(target,div,anchor);div.innerHTML=/*svg*/ctx[6];},p(ctx,dirty){if(dirty[0]&/*svg*/64)div.innerHTML=/*svg*/ctx[6];if(dirty[0]&/*$position*/512&&div_style_value!==(div_style_value=`transform: translateX(${/*$position*/ctx[9].x-/*svgPadding*/ctx[10].x}px) translateY(${/*$position*/ctx[9].y-/*svgPadding*/ctx[10].y}px)`)){attr(div,\"style\",div_style_value);}},d(detaching){if(detaching)detach(div);}};}function create_fragment$m(ctx){let div1;let span;let t0;let t1;let button;let t2;let button_disabled_value;let t3;let div0;let interactable_action;let measurable_action;let nudgeable_action;let mounted;let dispose;let if_block=/*$position*/ctx[9]&&create_if_block$5(ctx);return{c(){div1=element(\"div\");span=element(\"span\");t0=text(/*valueLabel*/ctx[4]);t1=space();button=element(\"button\");t2=text(/*labelReset*/ctx[1]);t3=space();div0=element(\"div\");if(if_block)if_block.c();attr(span,\"class\",\"DokaRangeInputValue\");attr(button,\"class\",\"DokaRangeInputReset\");attr(button,\"type\",\"button\");button.disabled=button_disabled_value=/*value*/ctx[0]===/*base*/ctx[3];attr(div0,\"class\",\"DokaRangeInputInner\");attr(div0,\"style\",/*rangeMask*/ctx[8]);attr(div0,\"data-value-limited\",/*isLimited*/ctx[7]);attr(div1,\"class\",\"DokaRangeInput\");attr(div1,\"tabindex\",\"0\");},m(target,anchor){insert(target,div1,anchor);append(div1,span);append(span,t0);append(div1,t1);append(div1,button);append(button,t2);append(div1,t3);append(div1,div0);if(if_block)if_block.m(div0,null);if(!mounted){dispose=[listen(button,\"click\",/*handleReset*/ctx[15]),listen(div0,\"interactionstart\",/*handleDragStart*/ctx[11]),listen(div0,\"interactionupdate\",/*handleDragMove*/ctx[13]),listen(div0,\"interactionend\",/*handleDragEnd*/ctx[14]),listen(div0,\"interactionrelease\",/*handleDragRelease*/ctx[12]),action_destroyer(interactable_action=interactable.call(null,div0,{inertia:true})),listen(div0,\"measure\",/*measure_handler*/ctx[27]),action_destroyer(measurable_action=measurable.call(null,div0)),listen(div1,\"wheel\",/*handleWheel*/ctx[17]),listen(div1,\"nudge\",/*handleNudge*/ctx[18]),action_destroyer(nudgeable_action=nudgeable.call(null,div1,/*direction*/ctx[2]=\"horizontal\"))];mounted=true;}},p(ctx,dirty){if(dirty[0]&/*valueLabel*/16)set_data(t0,/*valueLabel*/ctx[4]);if(dirty[0]&/*labelReset*/2)set_data(t2,/*labelReset*/ctx[1]);if(dirty[0]&/*value, base*/9&&button_disabled_value!==(button_disabled_value=/*value*/ctx[0]===/*base*/ctx[3])){button.disabled=button_disabled_value;}if(/*$position*/ctx[9]){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block$5(ctx);if_block.c();if_block.m(div0,null);}}else if(if_block){if_block.d(1);if_block=null;}if(dirty[0]&/*rangeMask*/256){attr(div0,\"style\",/*rangeMask*/ctx[8]);}if(dirty[0]&/*isLimited*/128){attr(div0,\"data-value-limited\",/*isLimited*/ctx[7]);}if(nudgeable_action&&is_function(nudgeable_action.update)&&dirty[0]&/*direction*/4)nudgeable_action.update.call(null,/*direction*/ctx[2]=\"horizontal\");},i:noop$1,o:noop$1,d(detaching){if(detaching)detach(div1);if(if_block)if_block.d();mounted=false;run_all(dispose);}};}const radiusBig=2;const radiusSmall=0.75;const indicatorSpacing=10;const indicatorInterval=5;const indicatorCount=40;// must be even\nfunction instance$m($$self,$$props,$$invalidate){let $position;let{labelReset=\"Reset\"}=$$props;let{direction=\"x\"}=$$props;let{min=0}=$$props;let{max=1}=$$props;let{base=min}=$$props;let{value=0}=$$props;let{valueLabel=0}=$$props;let{valueMin=undefined}=$$props;let{valueMax=undefined}=$$props;let{oninputstart=noop}=$$props;let{oninputmove=noop}=$$props;let{oninputend=noop}=$$props;let{elasticity=0}=$$props;const round=(number,increment,offset)=>Math.ceil((number-offset)/increment)*increment+offset;let size;let svg;let svgSize;const svgPadding={x:2,y:0};function getMask(limitedMin,limitedMax){const step=1/indicatorCount;const from=toFraction(limitedMin,min,max);const to=toFraction(limitedMax,min,max);const fromSnapped=fixPrecision(round(from,step,0)-step*0.5);const toSnapped=fixPrecision(round(to,step,0)-step*0.5);return`--range-mask-from:${fromSnapped*100}%;--range-mask-to:${toSnapped*100}%`;}//\n// Dragging related\n//\nlet interactionOrigin=undefined;let interactionReleased=false;let interactionRange;let interactionOptions={snap:false,elastic:false};const handleDragStart=()=>{interactionReleased=false;interactionOrigin=get_store_value(position);interactionRange=[valueToPosition(valueMin!=null?valueMin:min,direction),valueToPosition(valueMax!=null?valueMax:max,direction)];oninputstart();};const handleDragRelease=()=>{interactionReleased=true;};const handleDragMove=({detail})=>{interactionOptions.snap=!interactionReleased;interactionOptions.elastic=!interactionReleased;translatePosition(interactionOrigin,detail.translation,interactionOptions);};const handleDragEnd=({detail})=>{interactionOptions.snap=false;interactionOptions.elastic=false;const valueAtPosition=translatePosition(interactionOrigin,detail.translation,interactionOptions);interactionOrigin=undefined;interactionRange=undefined;// if is near base position, set to base\nif(Math.abs(valueAtPosition-base)<0.01)return oninputend(base);oninputend(valueAtPosition);};const translatePosition=(origin,translation,options)=>{const target=origin[direction]+translation[direction];const targetLimited=clamp(target,interactionRange[1][direction],interactionRange[0][direction]);const targetElastic=elasticity?targetLimited+elastify(target-targetLimited,elasticity):targetLimited;const targetVisual=options.elastic?targetElastic:targetLimited;// set position\nconst targetValid=vectorCreate(0,0);targetValid[direction]=targetVisual;position.set(targetValid,{hard:options.snap});return clamp(positionToValue(targetValid,direction),min,max);};const handleReset=()=>{$$invalidate(0,value=clamp(base,valueMinLimited,valueMaxLimited));oninputstart();oninputend(value);};//\n// Meter position and value updates\n//\nconst position=spring();component_subscribe($$self,position,value=>$$invalidate(9,$position=value));const valueToPosition=(value,axis)=>{const offset=(size[axis]-barSize[axis])*0.5;const fraction=toFraction(value,min,max);const v=fraction*barSize[axis]-barSize[axis]*0.5;const pos=offset-v;return{x:axis===\"x\"?pos:0,y:axis===\"y\"?pos:0};};const positionToValue=(position,axis)=>{const dist=position[axis]-size[axis]*0.5;const fraction=-(dist/barSize[axis]);return min+fraction*range;};position.subscribe(currentPosition=>{// if not positioned yet or is not interacting we're not interested in this event\nif(!currentPosition||!interactionOrigin)return;oninputmove(clamp(positionToValue(currentPosition,direction),min,max));});const updatePosition=value=>{const interactionRange=[valueToPosition(valueMin!=null?valueMin:min,direction),valueToPosition(valueMax!=null?valueMax:max,direction)];const target={x:direction===\"x\"?$position.x+value:0,y:direction===\"y\"?$position.y+value:0};const targetLimited=clamp(target[direction],interactionRange[1][direction],interactionRange[0][direction]);const positionTarget=_objectSpread(_objectSpread({},$position),{},{[direction]:targetLimited});set_store_value(position,$position=positionTarget,$position);const result=clamp(positionToValue(positionTarget,direction),min,max);oninputstart();oninputmove(result);oninputend(result);};const handleWheel=e=>{// don't run default actions, prevent other actions from running\ne.preventDefault();e.stopPropagation();// apply wheel delta to offset\nconst step=8;const delta=getWheelDelta(e)*step;updatePosition(delta);};const handleNudge=({detail})=>{updatePosition(detail[direction]*8);};const measure_handler=e=>$$invalidate(5,size=vectorCreateFromSize(e.detail));$$self.$$set=$$props=>{if(\"labelReset\"in $$props)$$invalidate(1,labelReset=$$props.labelReset);if(\"direction\"in $$props)$$invalidate(2,direction=$$props.direction);if(\"min\"in $$props)$$invalidate(19,min=$$props.min);if(\"max\"in $$props)$$invalidate(20,max=$$props.max);if(\"base\"in $$props)$$invalidate(3,base=$$props.base);if(\"value\"in $$props)$$invalidate(0,value=$$props.value);if(\"valueLabel\"in $$props)$$invalidate(4,valueLabel=$$props.valueLabel);if(\"valueMin\"in $$props)$$invalidate(21,valueMin=$$props.valueMin);if(\"valueMax\"in $$props)$$invalidate(22,valueMax=$$props.valueMax);if(\"oninputstart\"in $$props)$$invalidate(23,oninputstart=$$props.oninputstart);if(\"oninputmove\"in $$props)$$invalidate(24,oninputmove=$$props.oninputmove);if(\"oninputend\"in $$props)$$invalidate(25,oninputend=$$props.oninputend);if(\"elasticity\"in $$props)$$invalidate(26,elasticity=$$props.elasticity);};let range;let valueMinLimited;let valueMaxLimited;let barSize;let baseFraction;let isLimited;let rangeMask;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*max, min*/1572864){//\n// derived\n//\n$$invalidate(33,range=max-min);}if($$self.$$.dirty[0]&/*valueMin, min*/2621440){$$invalidate(34,valueMinLimited=valueMin!=null?Math.max(valueMin,min):min);}if($$self.$$.dirty[0]&/*valueMax, max*/5242880){$$invalidate(35,valueMaxLimited=valueMax!=null?Math.min(valueMax,max):max);}if($$self.$$.dirty[0]&/*base, min, max*/1572872){$$invalidate(37,baseFraction=toFraction(base,min,max));}if($$self.$$.dirty[0]&/*size*/32|$$self.$$.dirty[1]&/*baseFraction*/64){if(size){const centerY=size.y*0.5;let indicatorCenter=indicatorCount*baseFraction;let indicators=\"\";let svgWidth;let svgHeight=size.y;for(let i=0;i<=indicatorCount;i++){const x=svgPadding.x+i*indicatorSpacing;const y=centerY;const r=i%indicatorInterval===0?radiusBig:radiusSmall;indicators+=`<circle cx=\"${x}\" cy=\"${y}\" r=\"${r}\"/>`;svgWidth=x+svgPadding.x;if(i===indicatorCenter){indicators+=`<path stroke=\"none\" fill=\"currentColor\" d=\"M${x} ${y-4} l2 3 l-2 -1 l-2 1 z\"/>`;}}$$invalidate(6,svg=`<svg width=\"${svgWidth}\" height=\"${svgHeight}\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 ${svgWidth} ${svgHeight}\" aria-hidden=\"true\" focusable=\"false\">${indicators}<rect rx=\"4\" ry=\"4\" y=\"${centerY-4}\"\" height=\"8\"></rect></svg>`);$$invalidate(28,svgSize={x:svgWidth-svgPadding.x*2,y:svgHeight});}}if($$self.$$.dirty[0]&/*size, svgSize*/268435488){barSize=size&&svgSize;}if($$self.$$.dirty[0]&/*min, max*/1572864|$$self.$$.dirty[1]&/*valueMinLimited, valueMaxLimited*/24){$$invalidate(7,isLimited=valueMinLimited!==min||valueMaxLimited!==max);}if($$self.$$.dirty[0]&/*isLimited*/128|$$self.$$.dirty[1]&/*valueMinLimited, valueMaxLimited*/24){$$invalidate(8,rangeMask=isLimited?getMask(valueMinLimited,valueMaxLimited):\"\");}if($$self.$$.dirty[0]&/*size, value, direction*/37|$$self.$$.dirty[1]&/*range*/4){// if has size (range is in here so the position is updated if the range is changed)\nif(range&&size&&size.x&&size.y){position.set(valueToPosition(value,direction));}}};return[value,labelReset,direction,base,valueLabel,size,svg,isLimited,rangeMask,$position,svgPadding,handleDragStart,handleDragRelease,handleDragMove,handleDragEnd,handleReset,position,handleWheel,handleNudge,min,max,valueMin,valueMax,oninputstart,oninputmove,oninputend,elasticity,measure_handler];}class RangeInput extends SvelteComponent{constructor(options){super();init(this,options,instance$m,create_fragment$m,safe_not_equal,{labelReset:1,direction:2,min:19,max:20,base:3,value:0,valueLabel:4,valueMin:21,valueMax:22,oninputstart:23,oninputmove:24,oninputend:25,elasticity:26},[-1,-1]);}}/* src/core/ui/components/Toolbar.svelte generated by Svelte v3.29.4 */function create_fragment$n(ctx){let div1;let div0;let measurable_action;let measurable_action_1;let current;let mounted;let dispose;const default_slot_template=/*#slots*/ctx[5].default;const default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[4],null);return{c(){div1=element(\"div\");div0=element(\"div\");if(default_slot)default_slot.c();attr(div0,\"class\",\"DokaToolbarInner\");attr(div1,\"class\",\"DokaToolbar\");attr(div1,\"data-layout\",/*layout*/ctx[1]);attr(div1,\"data-overflow\",/*overflow*/ctx[0]);},m(target,anchor){insert(target,div1,anchor);append(div1,div0);if(default_slot){default_slot.m(div0,null);}current=true;if(!mounted){dispose=[listen(div0,\"measure\",/*handleChildResizeEvent*/ctx[3]),action_destroyer(measurable_action=measurable.call(null,div0)),listen(div1,\"measure\",/*handleParentResizeEvent*/ctx[2]),action_destroyer(measurable_action_1=measurable.call(null,div1))];mounted=true;}},p(ctx,[dirty]){if(default_slot){if(default_slot.p&&dirty&/*$$scope*/16){update_slot(default_slot,default_slot_template,ctx,/*$$scope*/ctx[4],dirty,null,null);}}if(!current||dirty&/*layout*/2){attr(div1,\"data-layout\",/*layout*/ctx[1]);}if(!current||dirty&/*overflow*/1){attr(div1,\"data-overflow\",/*overflow*/ctx[0]);}},i(local){if(current)return;transition_in(default_slot,local);current=true;},o(local){transition_out(default_slot,local);current=false;},d(detaching){if(detaching)detach(div1);if(default_slot)default_slot.d(detaching);mounted=false;run_all(dispose);}};}function instance$n($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope}=$$props;let childWidth=0;let childMaxWidth=0;let parentWidth=0;let overflow;const testOverflow=()=>{$$invalidate(0,overflow=layout===\"compact\"&&childWidth>parentWidth?\"overflow\":undefined);};const handleParentResizeEvent=({detail})=>{const{width,height}=detail;$$invalidate(8,parentWidth=width);testOverflow();};const handleChildResizeEvent=({detail})=>{const{width,height}=detail;if(width>childMaxWidth){$$invalidate(7,childMaxWidth=width);}childWidth=width;if(!overflow)testOverflow();};$$self.$$set=$$props=>{if(\"$$scope\"in $$props)$$invalidate(4,$$scope=$$props.$$scope);};let layout;$$self.$$.update=()=>{if($$self.$$.dirty&/*childMaxWidth, parentWidth*/384){$$invalidate(1,layout=childMaxWidth>parentWidth?\"compact\":\"default\");}};return[overflow,layout,handleParentResizeEvent,handleChildResizeEvent,$$scope,slots];}class Toolbar extends SvelteComponent{constructor(options){super();init(this,options,instance$n,create_fragment$n,safe_not_equal,{});}}// enum Direction {\n//     Top = 't',\n//     Right = 'r',\n//     Bottom = 'b',\n//     Left = 'l',\n//     TopLeft = 'tl',\n//     TopRight = 'tr',\n//     BottomRight = 'br',\n//     BottomLeft = 'bl',\n// }\n// export const { Top, Right, Bottom, Left, TopLeft, TopRight, BottomRight, BottomLeft } = Direction;\n// export default Direction;\nconst Direction={Top:'t',Right:'r',Bottom:'b',Left:'l',TopLeft:'tl',TopRight:'tr',BottomRight:'br',BottomLeft:'bl'};const{Top,Right,Bottom,Left,TopLeft,TopRight,BottomRight,BottomLeft}=Direction;var DirectionRectMap={[Top]:rect=>({x:rect.x,y:rect.y}),[TopRight]:rect=>({x:rect.x+rect.width,y:rect.y}),[Right]:rect=>({x:rect.x+rect.width,y:rect.y}),[BottomRight]:rect=>({x:rect.x+rect.width,y:rect.y+rect.height}),[Bottom]:rect=>({x:rect.x,y:rect.y+rect.height}),[BottomLeft]:rect=>({x:rect.x,y:rect.y+rect.height}),[Left]:rect=>({x:rect.x,y:rect.y}),[TopLeft]:rect=>({x:rect.x,y:rect.y})};/* src/core/ui/components/RectManipulator.svelte generated by Svelte v3.29.4 */function get_each_context$4(ctx,list,i){const child_ctx=ctx.slice();child_ctx[11]=list[i].key;child_ctx[12]=list[i].translate;child_ctx[13]=list[i].scale;child_ctx[14]=list[i].type;child_ctx[15]=list[i].opacity;return child_ctx;}// (210:0) {#each mappedDirections as { key, translate, scale, type, opacity }\nfunction create_each_block$4(key_1,ctx){let div;let div_tabindex_value;let div_data_direction_value;let div_data_shape_value;let div_style_value;let nudgeable_action;let interactable_action;let mounted;let dispose;return{key:key_1,first:null,c(){div=element(\"div\");attr(div,\"role\",\"button\");attr(div,\"tabindex\",div_tabindex_value=/*type*/ctx[14]===\"edge\"?-1:0);attr(div,\"class\",\"DokaRectManipulator\");attr(div,\"data-direction\",div_data_direction_value=/*key*/ctx[11]);attr(div,\"data-shape\",div_data_shape_value=`${/*type*/ctx[14]===\"edge\"?\"edge\":`${/*style*/ctx[0]}`}`);attr(div,\"style\",div_style_value=`transform: translate3d(${/*translate*/ctx[12].x}px, ${/*translate*/ctx[12].y}px, 0) scale(${/*scale*/ctx[13].x}, ${/*scale*/ctx[13].y}); opacity: ${/*opacity*/ctx[15]}`);this.first=div;},m(target,anchor){insert(target,div,anchor);if(!mounted){dispose=[listen(div,\"nudge\",function(){if(is_function(/*nudge*/ctx[5](/*key*/ctx[11])))/*nudge*/ctx[5](/*key*/ctx[11]).apply(this,arguments);}),action_destroyer(nudgeable_action=nudgeable.call(null,div)),listen(div,\"interactionstart\",function(){if(is_function(/*route*/ctx[4](\"resizestart\",/*key*/ctx[11])))/*route*/ctx[4](\"resizestart\",/*key*/ctx[11]).apply(this,arguments);}),listen(div,\"interactionupdate\",function(){if(is_function(/*route*/ctx[4](\"resizemove\",/*key*/ctx[11])))/*route*/ctx[4](\"resizemove\",/*key*/ctx[11]).apply(this,arguments);}),listen(div,\"interactionend\",function(){if(is_function(/*route*/ctx[4](\"resizeend\",/*key*/ctx[11])))/*route*/ctx[4](\"resizeend\",/*key*/ctx[11]).apply(this,arguments);}),action_destroyer(interactable_action=interactable.call(null,div))];mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;if(dirty&/*mappedDirections*/2&&div_tabindex_value!==(div_tabindex_value=/*type*/ctx[14]===\"edge\"?-1:0)){attr(div,\"tabindex\",div_tabindex_value);}if(dirty&/*mappedDirections*/2&&div_data_direction_value!==(div_data_direction_value=/*key*/ctx[11])){attr(div,\"data-direction\",div_data_direction_value);}if(dirty&/*mappedDirections, style*/3&&div_data_shape_value!==(div_data_shape_value=`${/*type*/ctx[14]===\"edge\"?\"edge\":`${/*style*/ctx[0]}`}`)){attr(div,\"data-shape\",div_data_shape_value);}if(dirty&/*mappedDirections*/2&&div_style_value!==(div_style_value=`transform: translate3d(${/*translate*/ctx[12].x}px, ${/*translate*/ctx[12].y}px, 0) scale(${/*scale*/ctx[13].x}, ${/*scale*/ctx[13].y}); opacity: ${/*opacity*/ctx[15]}`)){attr(div,\"style\",div_style_value);}},d(detaching){if(detaching)detach(div);mounted=false;run_all(dispose);}};}function create_fragment$o(ctx){let each_blocks=[];let each_1_lookup=new Map();let each_1_anchor;let each_value=/*mappedDirections*/ctx[1];const get_key=ctx=>/*key*/ctx[11];for(let i=0;i<each_value.length;i+=1){let child_ctx=get_each_context$4(ctx,each_value,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block$4(key,child_ctx));}return{c(){for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}each_1_anchor=empty();},m(target,anchor){for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(target,anchor);}insert(target,each_1_anchor,anchor);},p(ctx,[dirty]){if(dirty&/*mappedDirections, style, nudge, route*/51){const each_value=/*mappedDirections*/ctx[1];each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,each_1_anchor.parentNode,destroy_block,create_each_block$4,each_1_anchor,get_each_context$4);}},i:noop$1,o:noop$1,d(detaching){for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d(detaching);}if(detaching)detach(each_1_anchor);}};}function instance$o($$self,$$props,$$invalidate){let $selectionScale;let $selectionOpacity;let{rect=null}=$$props;let{visible=false}=$$props;let{style=undefined}=$$props;// is `undefined` to prevent bounce when first rendering view\nconst selectionScale=spring(undefined,{precision:0.0001,stiffness:0.2,damping:0.4});component_subscribe($$self,selectionScale,value=>$$invalidate(8,$selectionScale=value));const selectionOpacity=spring(0,{precision:0.001});component_subscribe($$self,selectionOpacity,value=>$$invalidate(9,$selectionOpacity=value));//\n// dragging\n//\nconst dispatch=createEventDispatcher();const route=(type,direction)=>({detail})=>dispatch(type,{direction,translation:detail&&detail.translation});const nudge=direction=>({detail})=>{dispatch(`resizestart`,{direction,translation:{x:0,y:0}});dispatch(`resizemove`,{direction,translation:detail});dispatch(`resizeend`,{direction,translation:{x:0,y:0}});};$$self.$$set=$$props=>{if(\"rect\"in $$props)$$invalidate(6,rect=$$props.rect);if(\"visible\"in $$props)$$invalidate(7,visible=$$props.visible);if(\"style\"in $$props)$$invalidate(0,style=$$props.style);};let mappedDirections;$$self.$$.update=()=>{if($$self.$$.dirty&/*visible*/128){selectionScale.set(visible?1:0.5);}if($$self.$$.dirty&/*visible*/128){selectionOpacity.set(visible?1:0);}if($$self.$$.dirty&/*rect, $selectionScale, $selectionOpacity*/832){//\n// rendering\n//\n$$invalidate(1,mappedDirections=Object.keys(Direction).map((key,i)=>{// get direction enum\nconst direction=Direction[key];// get position from direction\nconst position=DirectionRectMap[direction](rect);// corner or edge\nconst type=direction.length===1?\"edge\":\"corner\";const isCorner=type===\"corner\";return{key:direction,type,scale:{x:/^(t|b)$/.test(direction)?rect.width:isCorner?clamp($selectionScale,0.5,1.25):1,y:/^(r|l)$/.test(direction)?rect.height:isCorner?clamp($selectionScale,0.5,1.25):1},translate:{x:position.x,y:position.y},opacity:$selectionOpacity};}));}};return[style,mappedDirections,selectionScale,selectionOpacity,route,nudge,rect,visible];}class RectManipulator extends SvelteComponent{constructor(options){super();init(this,options,instance$o,create_fragment$o,safe_not_equal,{rect:6,visible:7,style:0});}}var getEventPositionInViewport=e=>vectorCreate(e.clientX,e.clientY);var getEventPositionInStage=(e,viewOffset,stageOffset)=>{const positionInViewport=getEventPositionInViewport(e);return vectorSubtract(vectorSubtract(positionInViewport,viewOffset),stageOffset);};var DirectionInversionTable={[Top]:Bottom,[Right]:Left,[Bottom]:Top,[Left]:Right,[TopLeft]:BottomRight,[TopRight]:BottomLeft,[BottomRight]:TopLeft,[BottomLeft]:TopRight};var DirectionCoordinateTable={[Top]:[0.5,0],[Right]:[1,0.5],[Bottom]:[0.5,1],[Left]:[0,0.5],[TopLeft]:[0,0],[TopRight]:[1,0],[BottomRight]:[1,1],[BottomLeft]:[0,1]};var getTranslationInfo=target=>{const translateToRight=target===Right||target===TopRight||target===BottomRight;const translateToLeft=target===Left||target===BottomLeft||target===TopLeft;const translateToTop=target===Top||target===TopRight||target===TopLeft;const translateToBottom=target===Bottom||target===BottomRight||target===BottomLeft;const translateHorizontally=target===Left||target===Right;const translateVertically=target===Top||target===Bottom;const translateAxis=translateHorizontally||translateVertically;return[translateToRight,translateToLeft,translateToTop,translateToBottom,translateHorizontally,translateVertically,translateAxis];};var limitRectDirectionTranslation=(rect,transform,bounds,options={})=>{// the transforms to apply\nconst{target,translate}=transform;// the transform requirements\nconst{aspectRatio,minSize,maxSize}=options;// get anchor coordinates and x,y position we need this for relative scaling of the view rectangle\nconst anchor=DirectionInversionTable[target];const anchorDirectionCoordinates=DirectionCoordinateTable[anchor];const anchorPosition=vectorAdd(vectorCreate(rect.x,rect.y),vectorCreate(anchorDirectionCoordinates[0]*rect.width,anchorDirectionCoordinates[1]*rect.height));// get coordinate of direction\nconst targetDirectionCoordinates=DirectionCoordinateTable[target];const targetPosition=vectorAdd(rectClone(rect),vectorCreate(targetDirectionCoordinates[0]*rect.width,targetDirectionCoordinates[1]*rect.height));// bools to determine which direction the interaction is moving in\nconst[translateToRight,translateToLeft,translateToTop,translateToBottom,translateHorizontally,translateVertically,translateAxis]=getTranslationInfo(target);let tx=translate.x;let ty=translate.y;if(translateHorizontally)ty=0;else if(translateVertically)tx=0;const interactionBounds=getInteractionBounds(anchorPosition,target,bounds,{aspectRatio,minSize,maxSize});// current bounds\nlet[t,r,b,l]=rectToBounds(rect);// update view bounds with anchor based on translation direction (one side is always locked)\nif(translateToRight)l=anchorPosition.x;else if(translateToLeft)r=anchorPosition.x;if(translateToBottom)t=anchorPosition.y;else if(translateToTop)b=anchorPosition.y;// update view bounds with interaction limits\nif(translateToRight){const innerR=interactionBounds.inner.x+interactionBounds.inner.width;const outerR=interactionBounds.outer.x+interactionBounds.outer.width;r=clamp(targetPosition.x+tx,innerR,outerR);}else if(translateToLeft){const innerL=interactionBounds.outer.x;const outerL=interactionBounds.inner.x;l=clamp(targetPosition.x+tx,innerL,outerL);}if(translateToBottom){const innerB=interactionBounds.inner.y+interactionBounds.inner.height;const outerB=interactionBounds.outer.y+interactionBounds.outer.height;b=clamp(targetPosition.y+ty,innerB,outerB);}else if(translateToTop){const innerT=interactionBounds.outer.y;const outerT=interactionBounds.inner.y;t=clamp(targetPosition.y+ty,innerT,outerT);}// if aspect ratio is set we need to scale both axis\nif(aspectRatio){// if translating over horizontal or vertical axis we need to update the other axis based on the aspect ratio as well\nif(translateAxis){let dx=r-l;let dy=b-t;if(translateHorizontally){dy=dx/aspectRatio;t=anchorPosition.y-dy*0.5;b=anchorPosition.y+dy*0.5;}else if(translateVertically){dx=dy*aspectRatio;l=anchorPosition.x-dx*0.5;r=anchorPosition.x+dx*0.5;}}// we're translating one of the corners in both the x and y direction, need to make sure it conforms to aspect ratio\nelse{const pointer=vectorCreate(targetPosition.x+tx-anchorPosition.x,targetPosition.y+ty-anchorPosition.y);// translations cannot be inverted, limited by anchor position\nif(target===TopRight){pointer.x=Math.max(0,pointer.x);pointer.y=Math.min(0,pointer.y);}else if(target===BottomRight){pointer.x=Math.max(0,pointer.x);pointer.y=Math.max(0,pointer.y);}else if(target===BottomLeft){pointer.x=Math.min(0,pointer.x);pointer.y=Math.max(0,pointer.y);}else if(target===TopLeft){pointer.x=Math.min(0,pointer.x);pointer.y=Math.min(0,pointer.y);}// calculate the translation pointer, then get its length, now create a new pointer based on the aspect ratio, and scale it based on the original (limited) length\nconst pointerLength=vectorLength(pointer);const pointerLengthMin=vectorLength(vectorCreate(interactionBounds.inner.width,interactionBounds.inner.height));const pointerLengthMax=vectorLength(vectorCreate(interactionBounds.outer.width,interactionBounds.outer.height));const pointerLengthLimited=clamp(pointerLength,pointerLengthMin,pointerLengthMax);const pointerAspectRatio=vectorCreate(aspectRatio,1);const pointerScaled=vectorMultiply(vectorNormalize(pointerAspectRatio),pointerLengthLimited);if(target===TopRight){r=anchorPosition.x+pointerScaled.x;t=anchorPosition.y-pointerScaled.y;}else if(target===BottomRight){r=anchorPosition.x+pointerScaled.x;b=anchorPosition.y+pointerScaled.y;}else if(target===BottomLeft){l=anchorPosition.x-pointerScaled.x;b=anchorPosition.y+pointerScaled.y;}else if(target===TopLeft){l=anchorPosition.x-pointerScaled.x;t=anchorPosition.y-pointerScaled.y;}}}return rectCreate(l,t,r-l,b-t);};const getInteractionBounds=(anchor,dir,bounds,options)=>{const{aspectRatio,minSize,maxSize}=options;const translateToRight=dir===Right||dir===TopRight||dir===BottomRight;const translateToLeft=dir===Left||dir===BottomLeft||dir===TopLeft;const translateToTop=dir===Top||dir===TopRight||dir===TopLeft;const translateToBottom=dir===Bottom||dir===BottomRight||dir===BottomLeft;const translateHorizontally=dir===Left||dir===Right;const translateVertically=dir===Top||dir===Bottom;// limit bounds based on anchor and direction\nconst limitedBounds=rectClone(bounds);if(translateToRight){limitedBounds.x=anchor.x;limitedBounds.width-=anchor.x;}else if(translateToLeft){limitedBounds.width=anchor.x;}if(translateToBottom){limitedBounds.y=anchor.y;limitedBounds.height-=anchor.y;}else if(translateToTop){limitedBounds.height=anchor.y;}// limit max size based on bounds\nconst maxSizeLimitedToBounds=rectCreateFromDimensions(Math.min(limitedBounds.width,maxSize.width),Math.min(limitedBounds.height,maxSize.height));if(aspectRatio){// limit height\nif(translateHorizontally){const verticalSpace=Math.min(anchor.y,bounds.height-anchor.y);maxSizeLimitedToBounds.height=Math.min(verticalSpace*2,maxSizeLimitedToBounds.height);}// limit width\nelse if(translateVertically){const horizontalSpace=Math.min(anchor.x,bounds.width-anchor.x);maxSizeLimitedToBounds.width=Math.min(horizontalSpace*2,maxSizeLimitedToBounds.width);}}const maxSizeLimited=aspectRatio?sizeCreateFromRect(rectContainRect(maxSizeLimitedToBounds,aspectRatio)):maxSizeLimitedToBounds;// limit min size\nconst minSizeLimited=aspectRatio?sizeCreateFromRect(rectCoverRect(rectCreateFromSize(minSize),aspectRatio)):minSize;let l,r,t,b;// set bounds\nif(translateToRight)l=anchor.x;else if(translateToLeft)r=anchor.x;if(translateToBottom)t=anchor.y;else if(translateToTop)b=anchor.y;// inner\nif(translateToRight){r=l+minSizeLimited.width;}else if(translateToLeft){l=r-minSizeLimited.width;}if(translateToBottom){b=t+minSizeLimited.height;}else if(translateToTop){t=b-minSizeLimited.height;}if(translateHorizontally){t=anchor.y-minSizeLimited.height*0.5;b=anchor.y+minSizeLimited.height*0.5;}else if(translateVertically){l=anchor.x-minSizeLimited.width*0.5;r=anchor.x+minSizeLimited.width*0.5;}const inner=rectCreateFromPoints(vectorCreate(l,t),vectorCreate(r,b));// outer\nif(translateToRight){r=l+maxSizeLimited.width;}else if(translateToLeft){l=r-maxSizeLimited.width;}if(translateToBottom){b=t+maxSizeLimited.height;}else if(translateToTop){t=b-maxSizeLimited.height;}if(translateHorizontally){t=anchor.y-maxSizeLimited.height*0.5;b=anchor.y+maxSizeLimited.height*0.5;}else if(translateVertically){l=anchor.x-maxSizeLimited.width*0.5;r=anchor.x+maxSizeLimited.width*0.5;}const outer=rectCreateFromPoints(vectorCreate(l,t),vectorCreate(r,b));return{inner,outer};};var applyRectDirectionTranslation=(rect,transform,options={})=>{// the transforms to apply\nconst{target,translate}=transform;// the transform requirements\nconst{aspectRatio}=options;// get anchor coordinates and x,y position we need this for relative scaling of the view rectangle\nconst anchor=DirectionInversionTable[target];const anchorDirectionCoordinates=DirectionCoordinateTable[anchor];const anchorPosition=vectorAdd(rectClone(rect),vectorCreate(anchorDirectionCoordinates[0]*rect.width,anchorDirectionCoordinates[1]*rect.height));// get coordinate of direction\nconst targetDirectionCoordinates=DirectionCoordinateTable[target];const targetPosition=vectorAdd(rectClone(rect),vectorCreate(targetDirectionCoordinates[0]*rect.width,targetDirectionCoordinates[1]*rect.height));// bools to determine which direction the interaction is moving in\nconst[translateToRight,translateToLeft,translateToTop,translateToBottom,translateHorizontally,translateVertically,translateAxis]=getTranslationInfo(target);let tx=translate.x;let ty=translate.y;if(translateHorizontally)ty=0;else if(translateVertically)tx=0;// current bounds\nlet[t,r,b,l]=rectToBounds(rect);// update view bounds with anchor based on translation direction (one side is always locked)\nif(translateToRight)l=anchorPosition.x;else if(translateToLeft)r=anchorPosition.x;if(translateToBottom)t=anchorPosition.y;else if(translateToTop)b=anchorPosition.y;// update view bounds with interaction limits\nif(translateToRight){r=targetPosition.x+tx;}else if(translateToLeft){l=targetPosition.x+tx;}if(translateToBottom){b=targetPosition.y+ty;}else if(translateToTop){t=targetPosition.y+ty;}// if aspect ratio is set we need to scale both axis\nif(aspectRatio){// if translating over horizontal or vertical axis we need to update the other axis based on the aspect ratio as well\nif(translateAxis){let dx=r-l;let dy=b-t;if(translateHorizontally){dy=dx/aspectRatio;t=anchorPosition.y-dy*0.5;b=anchorPosition.y+dy*0.5;}else if(translateVertically){dx=dy*aspectRatio;l=anchorPosition.x-dx*0.5;r=anchorPosition.x+dx*0.5;}}// we're translating one of the corners in both the x and y direction, need to make sure it conforms to aspect ratio\nelse{const pointer=vectorCreate(targetPosition.x+tx-anchorPosition.x,targetPosition.y+ty-anchorPosition.y);// translations cannot be inverted, limited by anchor position\nif(target===TopRight){pointer.x=Math.max(0,pointer.x);pointer.y=Math.min(0,pointer.y);}else if(target===BottomRight){pointer.x=Math.max(0,pointer.x);pointer.y=Math.max(0,pointer.y);}else if(target===BottomLeft){pointer.x=Math.min(0,pointer.x);pointer.y=Math.max(0,pointer.y);}else if(target===TopLeft){pointer.x=Math.min(0,pointer.x);pointer.y=Math.min(0,pointer.y);}// calculate the translation pointer, then get its length, now create a new pointer based on the aspect ratio, and scale it based on the original (limited) length\nconst pointerLength=vectorLength(pointer);const pointerAspectRatio=vectorCreate(aspectRatio,1);const pointerScaled=vectorMultiply(vectorNormalize(pointerAspectRatio),pointerLength);if(target===TopRight){r=anchorPosition.x+pointerScaled.x;t=anchorPosition.y-pointerScaled.y;}else if(target===BottomRight){r=anchorPosition.x+pointerScaled.x;b=anchorPosition.y+pointerScaled.y;}else if(target===BottomLeft){l=anchorPosition.x-pointerScaled.x;b=anchorPosition.y+pointerScaled.y;}else if(target===TopLeft){l=anchorPosition.x-pointerScaled.x;t=anchorPosition.y-pointerScaled.y;}}}return rectCreate(l,t,r-l,b-t);};var radToDeg=rad=>rad*180/Math.PI;/* src/core/ui/plugins/crop/components/ImageRotator.svelte generated by Svelte v3.29.4 */function create_fragment$p(ctx){let div;let rangeinput;let current;rangeinput=new RangeInput({props:{elasticity:/*elasticity*/ctx[5],min:/*min*/ctx[7],max:/*max*/ctx[8],value:/*value*/ctx[12],valueMin:/*valueMin*/ctx[0],valueMax:/*valueMax*/ctx[1],labelReset:/*labelReset*/ctx[6],base:/*center*/ctx[9],valueLabel:`${Math.round(radToDeg(/*value*/ctx[12]))}`,oninputstart:/*oninputstart*/ctx[2],oninputmove:/*func*/ctx[14],oninputend:/*func_1*/ctx[15]}});return{c(){div=element(\"div\");create_component(rangeinput.$$.fragment);attr(div,\"class\",\"DokaImageRotator\");},m(target,anchor){insert(target,div,anchor);mount_component(rangeinput,div,null);current=true;},p(ctx,[dirty]){const rangeinput_changes={};if(dirty&/*elasticity*/32)rangeinput_changes.elasticity=/*elasticity*/ctx[5];if(dirty&/*min*/128)rangeinput_changes.min=/*min*/ctx[7];if(dirty&/*max*/256)rangeinput_changes.max=/*max*/ctx[8];if(dirty&/*value*/4096)rangeinput_changes.value=/*value*/ctx[12];if(dirty&/*valueMin*/1)rangeinput_changes.valueMin=/*valueMin*/ctx[0];if(dirty&/*valueMax*/2)rangeinput_changes.valueMax=/*valueMax*/ctx[1];if(dirty&/*labelReset*/64)rangeinput_changes.labelReset=/*labelReset*/ctx[6];if(dirty&/*center*/512)rangeinput_changes.base=/*center*/ctx[9];if(dirty&/*value*/4096)rangeinput_changes.valueLabel=`${Math.round(radToDeg(/*value*/ctx[12]))}`;if(dirty&/*oninputstart*/4)rangeinput_changes.oninputstart=/*oninputstart*/ctx[2];if(dirty&/*oninputmove, sign, turns*/3080)rangeinput_changes.oninputmove=/*func*/ctx[14];if(dirty&/*oninputend, sign, turns*/3088)rangeinput_changes.oninputend=/*func_1*/ctx[15];rangeinput.$set(rangeinput_changes);},i(local){if(current)return;transition_in(rangeinput.$$.fragment,local);current=true;},o(local){transition_out(rangeinput.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(rangeinput);}};}const MARGIN=1e-9;function instance$p($$self,$$props,$$invalidate){const HALF_PI=Math.PI/2;const QUARTER_PI=Math.PI/4;let{rotation}=$$props;let{valueMin}=$$props;let{valueMax}=$$props;let{oninputstart=noop}=$$props;let{oninputmove=noop}=$$props;let{oninputend=noop}=$$props;let{elasticity=0}=$$props;let{labelReset=undefined}=$$props;const func=value=>oninputmove(sign*turns+value);const func_1=value=>oninputend(sign*turns+value);$$self.$$set=$$props=>{if(\"rotation\"in $$props)$$invalidate(13,rotation=$$props.rotation);if(\"valueMin\"in $$props)$$invalidate(0,valueMin=$$props.valueMin);if(\"valueMax\"in $$props)$$invalidate(1,valueMax=$$props.valueMax);if(\"oninputstart\"in $$props)$$invalidate(2,oninputstart=$$props.oninputstart);if(\"oninputmove\"in $$props)$$invalidate(3,oninputmove=$$props.oninputmove);if(\"oninputend\"in $$props)$$invalidate(4,oninputend=$$props.oninputend);if(\"elasticity\"in $$props)$$invalidate(5,elasticity=$$props.elasticity);if(\"labelReset\"in $$props)$$invalidate(6,labelReset=$$props.labelReset);};let min;let max;let center;let sign;let turns;let value;$$self.$$.update=()=>{if($$self.$$.dirty&/*min, max*/384){$$invalidate(9,center=min+(max-min)*0.5);}if($$self.$$.dirty&/*rotation*/8192){$$invalidate(10,sign=Math.sign(rotation));}if($$self.$$.dirty&/*rotation*/8192){$$invalidate(11,turns=Math.round(Math.abs(rotation)/HALF_PI)*HALF_PI);}if($$self.$$.dirty&/*rotation, sign, turns*/11264){$$invalidate(12,value=rotation-sign*turns);}};$$invalidate(7,min=-QUARTER_PI+MARGIN);$$invalidate(8,max=QUARTER_PI-MARGIN);return[valueMin,valueMax,oninputstart,oninputmove,oninputend,elasticity,labelReset,min,max,center,sign,turns,value,rotation,func,func_1];}class ImageRotator extends SvelteComponent{constructor(options){super();init(this,options,instance$p,create_fragment$p,safe_not_equal,{rotation:13,valueMin:0,valueMax:1,oninputstart:2,oninputmove:3,oninputend:4,elasticity:5,labelReset:6});}}/* src/core/ui/plugins/crop/components/ImageInfo.svelte generated by Svelte v3.29.4 */function create_fragment$q(ctx){let div;let p;let t0;let t1;let t2;return{c(){div=element(\"div\");p=element(\"p\");t0=text(/*width*/ctx[0]);t1=text(\"  \");t2=text(/*height*/ctx[1]);attr(div,\"class\",\"DokaImageInfo\");},m(target,anchor){insert(target,div,anchor);append(div,p);append(p,t0);append(p,t1);append(p,t2);},p(ctx,[dirty]){if(dirty&/*width*/1)set_data(t0,/*width*/ctx[0]);if(dirty&/*height*/2)set_data(t2,/*height*/ctx[1]);},i:noop$1,o:noop$1,d(detaching){if(detaching)detach(div);}};}function instance$q($$self,$$props,$$invalidate){let{width}=$$props;let{height}=$$props;$$self.$$set=$$props=>{if(\"width\"in $$props)$$invalidate(0,width=$$props.width);if(\"height\"in $$props)$$invalidate(1,height=$$props.height);};return[width,height];}class ImageInfo extends SvelteComponent{constructor(options){super();init(this,options,instance$q,create_fragment$q,safe_not_equal,{width:0,height:1});}}var getSelectionPresetOptionIcon=(value,options={})=>{const{width=24,height=24,bounds=16,radius=3}=options;let aspectRatio=isArray(value)?getAspectRatio(value[0],value[1]):value;let aspectRatioDefined=!!aspectRatio;aspectRatio=aspectRatioDefined?aspectRatio:1;let x;let y;let w;let h;w=aspectRatio>1?bounds:aspectRatio*bounds;h=w/aspectRatio;x=Math.round((width-w)*0.5);y=Math.round((height-h)*0.5);const fill=aspectRatioDefined?'currentColor':'none';const stroke=aspectRatioDefined?'none':'currentColor';const strokeWidth=width/16;const strokeDashArray=[width/12,width/6].join(' ');return`<rect fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${strokeWidth}\" stroke-dasharray=\"${strokeDashArray}\" x=\"${x}\" y=\"${y}\" width=\"${w}\" height=\"${h}\" rx=\"${radius}\"/>`;};/* src/core/ui/plugins/crop/index.svelte generated by Svelte v3.29.4 */function create_default_slot_3$3(ctx){let dynamiccomponenttree;let current;dynamiccomponenttree=new DynamicComponentTree_1({props:{items:/*tools*/ctx[0]}});return{c(){create_component(dynamiccomponenttree.$$.fragment);},m(target,anchor){mount_component(dynamiccomponenttree,target,anchor);current=true;},p(ctx,dirty){const dynamiccomponenttree_changes={};if(dirty[0]&/*tools*/1)dynamiccomponenttree_changes.items=/*tools*/ctx[0];dynamiccomponenttree.$set(dynamiccomponenttree_changes);},i(local){if(current)return;transition_in(dynamiccomponenttree.$$.fragment,local);current=true;},o(local){transition_out(dynamiccomponenttree.$$.fragment,local);current=false;},d(detaching){destroy_component(dynamiccomponenttree,detaching);}};}// (1208:4) <div slot=\"header\">\nfunction create_header_slot(ctx){let div;let toolbar;let current;toolbar=new Toolbar({props:{$$slots:{default:[create_default_slot_3$3]},$$scope:{ctx}}});return{c(){div=element(\"div\");create_component(toolbar.$$.fragment);attr(div,\"slot\",\"header\");},m(target,anchor){insert(target,div,anchor);mount_component(toolbar,div,null);current=true;},p(ctx,dirty){const toolbar_changes={};if(dirty[0]&/*tools*/1|dirty[5]&/*$$scope*/16384){toolbar_changes.$$scope={dirty,ctx};}toolbar.$set(toolbar_changes);},i(local){if(current)return;transition_in(toolbar.$$.fragment,local);current=true;},o(local){transition_out(toolbar.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(toolbar);}};}// (1232:12) {#if shouldRenderImageSelection && shouldRenderImageSelectionRecenterButton}\nfunction create_if_block_6$2(ctx){let button;let current;button=new Button({props:{onclick:/*handleRecenterAction*/ctx[74],label:/*locale*/ctx[4].cropLabelButtonRecenter,icon:/*locale*/ctx[4].cropIconButtonRecenter,class:\"DokaButtonCenter\",disabled:!/*canCenter*/ctx[11],hideLabel:true,style:`opacity: ${/*$recenterOpacity*/ctx[24]}; transform: translate3d(${/*$recenterOffset*/ctx[25].x}px, ${/*$recenterOffset*/ctx[25].y}px, 0)`}});return{c(){create_component(button.$$.fragment);},m(target,anchor){mount_component(button,target,anchor);current=true;},p(ctx,dirty){const button_changes={};if(dirty[0]&/*locale*/16)button_changes.label=/*locale*/ctx[4].cropLabelButtonRecenter;if(dirty[0]&/*locale*/16)button_changes.icon=/*locale*/ctx[4].cropIconButtonRecenter;if(dirty[0]&/*canCenter*/2048)button_changes.disabled=!/*canCenter*/ctx[11];if(dirty[0]&/*$recenterOpacity, $recenterOffset*/50331648)button_changes.style=`opacity: ${/*$recenterOpacity*/ctx[24]}; transform: translate3d(${/*$recenterOffset*/ctx[25].x}px, ${/*$recenterOffset*/ctx[25].y}px, 0)`;button.$set(button_changes);},i(local){if(current)return;transition_in(button.$$.fragment,local);current=true;},o(local){transition_out(button.$$.fragment,local);current=false;},d(detaching){destroy_component(button,detaching);}};}// (1244:12) {#if shouldRenderImageSelection}\nfunction create_if_block_5$2(ctx){let rectmanipulator;let current;rectmanipulator=new RectManipulator({props:{rect:/*imageSelectionRectOffset*/ctx[14],visible:/*$isActive*/ctx[16],style:/*cropImageSelectionCornerStyle*/ctx[2]}});rectmanipulator.$on(\"resizestart\",/*handleSelectionGrab*/ctx[57]);rectmanipulator.$on(\"resizemove\",/*handleSelectionDrag*/ctx[58]);rectmanipulator.$on(\"resizeend\",/*handleSelectionRelease*/ctx[59]);return{c(){create_component(rectmanipulator.$$.fragment);},m(target,anchor){mount_component(rectmanipulator,target,anchor);current=true;},p(ctx,dirty){const rectmanipulator_changes={};if(dirty[0]&/*imageSelectionRectOffset*/16384)rectmanipulator_changes.rect=/*imageSelectionRectOffset*/ctx[14];if(dirty[0]&/*$isActive*/65536)rectmanipulator_changes.visible=/*$isActive*/ctx[16];if(dirty[0]&/*cropImageSelectionCornerStyle*/4)rectmanipulator_changes.style=/*cropImageSelectionCornerStyle*/ctx[2];rectmanipulator.$set(rectmanipulator_changes);},i(local){if(current)return;transition_in(rectmanipulator.$$.fragment,local);current=true;},o(local){transition_out(rectmanipulator.$$.fragment,local);current=false;},d(detaching){destroy_component(rectmanipulator,detaching);}};}// (1256:8) {#if shouldRenderInfoIndicator}\nfunction create_if_block_4$3(ctx){let imageinfo;let current;imageinfo=new ImageInfo({props:{width:Math.round(/*$imageCropRect*/ctx[7].width),height:Math.round(/*$imageCropRect*/ctx[7].height)}});return{c(){create_component(imageinfo.$$.fragment);},m(target,anchor){mount_component(imageinfo,target,anchor);current=true;},p(ctx,dirty){const imageinfo_changes={};if(dirty[0]&/*$imageCropRect*/128)imageinfo_changes.width=Math.round(/*$imageCropRect*/ctx[7].width);if(dirty[0]&/*$imageCropRect*/128)imageinfo_changes.height=Math.round(/*$imageCropRect*/ctx[7].height);imageinfo.$set(imageinfo_changes);},i(local){if(current)return;transition_in(imageinfo.$$.fragment,local);current=true;},o(local){transition_out(imageinfo.$$.fragment,local);current=false;},d(detaching){destroy_component(imageinfo,detaching);}};}// (1214:4) <div slot=\"main\">\nfunction create_main_slot(ctx){let div0;let div1;let t0;let measurable_action;let interactable_action;let t1;let current;let mounted;let dispose;let if_block0=/*shouldRenderImageSelection*/ctx[13]&&/*shouldRenderImageSelectionRecenterButton*/ctx[15]&&create_if_block_6$2(ctx);let if_block1=/*shouldRenderImageSelection*/ctx[13]&&create_if_block_5$2(ctx);let if_block2=/*shouldRenderInfoIndicator*/ctx[12]&&create_if_block_4$3(ctx);return{c(){div0=element(\"div\");div1=element(\"div\");if(if_block0)if_block0.c();t0=space();if(if_block1)if_block1.c();t1=space();if(if_block2)if_block2.c();attr(div1,\"class\",\"DokaStage\");attr(div0,\"slot\",\"main\");},m(target,anchor){insert(target,div0,anchor);append(div0,div1);if(if_block0)if_block0.m(div1,null);append(div1,t0);if(if_block1)if_block1.m(div1,null);append(div0,t1);if(if_block2)if_block2.m(div0,null);current=true;if(!mounted){dispose=[listen(div1,\"measure\",/*measure_handler_1*/ctx[98]),action_destroyer(measurable_action=measurable.call(null,div1)),listen(div1,\"wheel\",function(){if(is_function(/*cropEnableZoom*/ctx[3]&&/*handleWheel*/ctx[73]))(/*cropEnableZoom*/ctx[3]&&/*handleWheel*/ctx[73]).apply(this,arguments);}),listen(div1,\"interactionstart\",/*handleImageDragStart*/ctx[63]),listen(div1,\"interactionupdate\",/*handleImageDrag*/ctx[64]),listen(div1,\"interactionrelease\",/*handleImageDragRelease*/ctx[66]),listen(div1,\"interactionend\",/*handleImageDragEnd*/ctx[65]),action_destroyer(interactable_action=interactable.call(null,div1,{drag:true,pinch:/*cropEnableZoom*/ctx[3],inertia:true,matchTarget:true,getEventPosition:/*interactable_function*/ctx[99]}))];mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;if(/*shouldRenderImageSelection*/ctx[13]&&/*shouldRenderImageSelectionRecenterButton*/ctx[15]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*shouldRenderImageSelection, shouldRenderImageSelectionRecenterButton*/40960){transition_in(if_block0,1);}}else{if_block0=create_if_block_6$2(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(div1,t0);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(/*shouldRenderImageSelection*/ctx[13]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*shouldRenderImageSelection*/8192){transition_in(if_block1,1);}}else{if_block1=create_if_block_5$2(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(div1,null);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,()=>{if_block1=null;});check_outros();}if(interactable_action&&is_function(interactable_action.update)&&dirty[0]&/*cropEnableZoom, $rootRect*/1032)interactable_action.update.call(null,{drag:true,pinch:/*cropEnableZoom*/ctx[3],inertia:true,matchTarget:true,getEventPosition:/*interactable_function*/ctx[99]});if(/*shouldRenderInfoIndicator*/ctx[12]){if(if_block2){if_block2.p(ctx,dirty);if(dirty[0]&/*shouldRenderInfoIndicator*/4096){transition_in(if_block2,1);}}else{if_block2=create_if_block_4$3(ctx);if_block2.c();transition_in(if_block2,1);if_block2.m(div0,null);}}else if(if_block2){group_outros();transition_out(if_block2,1,1,()=>{if_block2=null;});check_outros();}},i(local){if(current)return;transition_in(if_block0);transition_in(if_block1);transition_in(if_block2);current=true;},o(local){transition_out(if_block0);transition_out(if_block1);transition_out(if_block2);current=false;},d(detaching){if(detaching)detach(div0);if(if_block0)if_block0.d();if(if_block1)if_block1.d();if(if_block2)if_block2.d();mounted=false;run_all(dispose);}};}// (1264:4) {#if shouldRenderFooter}\nfunction create_if_block$6(ctx){let t;let tabpanels;let current;let if_block=/*shouldRenderTabs*/ctx[19]&&create_if_block_3$3(ctx);const tabpanels_spread_levels=[{class:\"DokaControlPanels\"},{panelClass:\"DokaControlPanel\"},{panels:/*panels*/ctx[22]},/*tabsConfig*/ctx[20]];let tabpanels_props={$$slots:{default:[create_default_slot_1$4,({panel})=>({167:panel}),({panel})=>[0,0,0,0,0,panel?4096:0]]},$$scope:{ctx}};for(let i=0;i<tabpanels_spread_levels.length;i+=1){tabpanels_props=assign(tabpanels_props,tabpanels_spread_levels[i]);}tabpanels=new TabPanels({props:tabpanels_props});return{c(){if(if_block)if_block.c();t=space();create_component(tabpanels.$$.fragment);},m(target,anchor){if(if_block)if_block.m(target,anchor);insert(target,t,anchor);mount_component(tabpanels,target,anchor);current=true;},p(ctx,dirty){if(/*shouldRenderTabs*/ctx[19]){if(if_block){if_block.p(ctx,dirty);if(dirty[0]&/*shouldRenderTabs*/524288){transition_in(if_block,1);}}else{if_block=create_if_block_3$3(ctx);if_block.c();transition_in(if_block,1);if_block.m(t.parentNode,t);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}const tabpanels_changes=dirty[0]&/*panels, tabsConfig*/5242880?get_spread_update(tabpanels_spread_levels,[tabpanels_spread_levels[0],tabpanels_spread_levels[1],dirty[0]&/*panels*/4194304&&{panels:/*panels*/ctx[22]},dirty[0]&/*tabsConfig*/1048576&&get_spread_object(/*tabsConfig*/ctx[20])]):{};if(dirty[0]&/*$imageRotation, locale, $imageRotationRange, tabs, imageZoomLevelMin, $imageZoomLevelRange, $imageZoomLevel*/471859984|dirty[5]&/*$$scope, panel*/20480){tabpanels_changes.$$scope={dirty,ctx};}tabpanels.$set(tabpanels_changes);},i(local){if(current)return;transition_in(if_block);transition_in(tabpanels.$$.fragment,local);current=true;},o(local){transition_out(if_block);transition_out(tabpanels.$$.fragment,local);current=false;},d(detaching){if(if_block)if_block.d(detaching);if(detaching)detach(t);destroy_component(tabpanels,detaching);}};}// (1266:8) {#if shouldRenderTabs}\nfunction create_if_block_3$3(ctx){let tablist;let current;const tablist_spread_levels=[{class:\"DokaControlList\"},{tabs:/*tabs*/ctx[21]},/*tabsConfig*/ctx[20]];let tablist_props={$$slots:{default:[create_default_slot_2$3,({tab})=>({168:tab}),({tab})=>[0,0,0,0,0,tab?8192:0]]},$$scope:{ctx}};for(let i=0;i<tablist_spread_levels.length;i+=1){tablist_props=assign(tablist_props,tablist_spread_levels[i]);}tablist=new TabList({props:tablist_props});tablist.$on(\"select\",/*select_handler*/ctx[100]);return{c(){create_component(tablist.$$.fragment);},m(target,anchor){mount_component(tablist,target,anchor);current=true;},p(ctx,dirty){const tablist_changes=dirty[0]&/*tabs, tabsConfig*/3145728?get_spread_update(tablist_spread_levels,[tablist_spread_levels[0],dirty[0]&/*tabs*/2097152&&{tabs:/*tabs*/ctx[21]},dirty[0]&/*tabsConfig*/1048576&&get_spread_object(/*tabsConfig*/ctx[20])]):{};if(dirty[5]&/*$$scope, tab*/24576){tablist_changes.$$scope={dirty,ctx};}tablist.$set(tablist_changes);},i(local){if(current)return;transition_in(tablist.$$.fragment,local);current=true;},o(local){transition_out(tablist.$$.fragment,local);current=false;},d(detaching){destroy_component(tablist,detaching);}};}// (1267:8) <TabList class=\"DokaControlList\" {tabs} {...tabsConfig} on:select={({ detail }) => transformSelected = detail} let:tab={tab}>\nfunction create_default_slot_2$3(ctx){let span;let t_value=/*tab*/ctx[168].label+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty[5]&/*tab*/8192&&t_value!==(t_value=/*tab*/ctx[168].label+\"\"))set_data(t,t_value);},d(detaching){if(detaching)detach(span);}};}// (1283:43) \nfunction create_if_block_2$5(ctx){let rangeinput;let current;rangeinput=new RangeInput({props:{elasticity:/*elasticityMultiplier*/ctx[34]*/*rangeInputElasticity*/ctx[35],base:imageZoomLevelBase,min:/*imageZoomLevelMin*/ctx[9],max:imageZoomLevelMax,valueMin:/*$imageZoomLevelRange*/ctx[27][0],valueMax:/*$imageZoomLevelRange*/ctx[27][1],value:/*$imageZoomLevel*/ctx[28],labelReset:/*locale*/ctx[4].labelReset,valueLabel:`${Math.round(/*$imageZoomLevel*/ctx[28]*100)}%`,oninputstart:/*handleResizeStart*/ctx[70],oninputmove:/*handleResizeMove*/ctx[71],oninputend:/*handleResizeEnd*/ctx[72]}});return{c(){create_component(rangeinput.$$.fragment);},m(target,anchor){mount_component(rangeinput,target,anchor);current=true;},p(ctx,dirty){const rangeinput_changes={};if(dirty[0]&/*imageZoomLevelMin*/512)rangeinput_changes.min=/*imageZoomLevelMin*/ctx[9];if(dirty[0]&/*$imageZoomLevelRange*/134217728)rangeinput_changes.valueMin=/*$imageZoomLevelRange*/ctx[27][0];if(dirty[0]&/*$imageZoomLevelRange*/134217728)rangeinput_changes.valueMax=/*$imageZoomLevelRange*/ctx[27][1];if(dirty[0]&/*$imageZoomLevel*/268435456)rangeinput_changes.value=/*$imageZoomLevel*/ctx[28];if(dirty[0]&/*locale*/16)rangeinput_changes.labelReset=/*locale*/ctx[4].labelReset;if(dirty[0]&/*$imageZoomLevel*/268435456)rangeinput_changes.valueLabel=`${Math.round(/*$imageZoomLevel*/ctx[28]*100)}%`;rangeinput.$set(rangeinput_changes);},i(local){if(current)return;transition_in(rangeinput.$$.fragment,local);current=true;},o(local){transition_out(rangeinput.$$.fragment,local);current=false;},d(detaching){destroy_component(rangeinput,detaching);}};}// (1273:12) {#if panel === tabs[0].id }\nfunction create_if_block_1$7(ctx){let imagerotator;let current;imagerotator=new ImageRotator({props:{elasticity:/*elasticityMultiplier*/ctx[34]*/*rangeInputElasticity*/ctx[35],rotation:/*$imageRotation*/ctx[8],labelReset:/*locale*/ctx[4].labelReset,valueMin:/*$imageRotationRange*/ctx[26][0],valueMax:/*$imageRotationRange*/ctx[26][1],oninputstart:/*handleRotateStart*/ctx[60],oninputmove:/*handleRotateMove*/ctx[61],oninputend:/*handleRotateEnd*/ctx[62]}});return{c(){create_component(imagerotator.$$.fragment);},m(target,anchor){mount_component(imagerotator,target,anchor);current=true;},p(ctx,dirty){const imagerotator_changes={};if(dirty[0]&/*$imageRotation*/256)imagerotator_changes.rotation=/*$imageRotation*/ctx[8];if(dirty[0]&/*locale*/16)imagerotator_changes.labelReset=/*locale*/ctx[4].labelReset;if(dirty[0]&/*$imageRotationRange*/67108864)imagerotator_changes.valueMin=/*$imageRotationRange*/ctx[26][0];if(dirty[0]&/*$imageRotationRange*/67108864)imagerotator_changes.valueMax=/*$imageRotationRange*/ctx[26][1];imagerotator.$set(imagerotator_changes);},i(local){if(current)return;transition_in(imagerotator.$$.fragment,local);current=true;},o(local){transition_out(imagerotator.$$.fragment,local);current=false;},d(detaching){destroy_component(imagerotator,detaching);}};}// (1272:8) <TabPanels class=\"DokaControlPanels\" panelClass=\"DokaControlPanel\" {panels} {...tabsConfig} let:panel>\nfunction create_default_slot_1$4(ctx){let current_block_type_index;let if_block;let if_block_anchor;let current;const if_block_creators=[create_if_block_1$7,create_if_block_2$5];const if_blocks=[];function select_block_type(ctx,dirty){if(/*panel*/ctx[167]===/*tabs*/ctx[21][0].id)return 0;if(/*panel*/ctx[167]===/*tabs*/ctx[21][1].id)return 1;return-1;}if(~(current_block_type_index=select_block_type(ctx))){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);}return{c(){if(if_block)if_block.c();if_block_anchor=empty();},m(target,anchor){if(~current_block_type_index){if_blocks[current_block_type_index].m(target,anchor);}insert(target,if_block_anchor,anchor);current=true;},p(ctx,dirty){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if(~current_block_type_index){if_blocks[current_block_type_index].p(ctx,dirty);}}else{if(if_block){group_outros();transition_out(if_blocks[previous_block_index],1,1,()=>{if_blocks[previous_block_index]=null;});check_outros();}if(~current_block_type_index){if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}else{if_block=null;}}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(~current_block_type_index){if_blocks[current_block_type_index].d(detaching);}if(detaching)detach(if_block_anchor);}};}// (1263:4) <div slot=\"footer\" style={footerStyle}>\nfunction create_footer_slot(ctx){let div;let current;let if_block=/*shouldRenderFooter*/ctx[18]&&create_if_block$6(ctx);return{c(){div=element(\"div\");if(if_block)if_block.c();attr(div,\"slot\",\"footer\");attr(div,\"style\",/*footerStyle*/ctx[23]);},m(target,anchor){insert(target,div,anchor);if(if_block)if_block.m(div,null);current=true;},p(ctx,dirty){if(/*shouldRenderFooter*/ctx[18]){if(if_block){if_block.p(ctx,dirty);if(dirty[0]&/*shouldRenderFooter*/262144){transition_in(if_block,1);}}else{if_block=create_if_block$6(ctx);if_block.c();transition_in(if_block,1);if_block.m(div,null);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}if(!current||dirty[0]&/*footerStyle*/8388608){attr(div,\"style\",/*footerStyle*/ctx[23]);}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(div);if(if_block)if_block.d();}};}// (1206:0) <Util hasHeader={shouldRenderToolbar} on:measure bind:root>\nfunction create_default_slot$6(ctx){let t0;let t1;return{c(){t0=space();t1=space();},m(target,anchor){insert(target,t0,anchor);insert(target,t1,anchor);},p:noop$1,i:noop$1,o:noop$1,d(detaching){if(detaching)detach(t0);if(detaching)detach(t1);}};}function create_fragment$r(ctx){let util;let updating_root;let current;function util_root_binding(value){/*util_root_binding*/ctx[101].call(null,value);}let util_props={hasHeader:/*shouldRenderToolbar*/ctx[17],$$slots:{default:[create_default_slot$6],footer:[create_footer_slot],main:[create_main_slot],header:[create_header_slot]},$$scope:{ctx}};if(/*root*/ctx[6]!==void 0){util_props.root=/*root*/ctx[6];}util=new Util({props:util_props});binding_callbacks.push(()=>bind(util,\"root\",util_root_binding));util.$on(\"measure\",/*measure_handler*/ctx[102]);return{c(){create_component(util.$$.fragment);},m(target,anchor){mount_component(util,target,anchor);current=true;},p(ctx,dirty){const util_changes={};if(dirty[0]&/*shouldRenderToolbar*/131072)util_changes.hasHeader=/*shouldRenderToolbar*/ctx[17];if(dirty[0]&/*footerStyle, panels, tabsConfig, $imageRotation, locale, $imageRotationRange, tabs, imageZoomLevelMin, $imageZoomLevelRange, $imageZoomLevel, transformSelected, shouldRenderTabs, shouldRenderFooter, $imageCropRect, shouldRenderInfoIndicator, cropEnableZoom, $rootRect, imageSelectionRectOffset, $isActive, cropImageSelectionCornerStyle, shouldRenderImageSelection, canCenter, $recenterOpacity, $recenterOffset, shouldRenderImageSelectionRecenterButton, tools*/536739773|dirty[5]&/*$$scope*/16384){util_changes.$$scope={dirty,ctx};}if(!updating_root&&dirty[0]&/*root*/64){updating_root=true;util_changes.root=/*root*/ctx[6];add_flush_callback(()=>updating_root=false);}util.$set(util_changes);},i(local){if(current)return;transition_in(util.$$.fragment,local);current=true;},o(local){transition_out(util.$$.fragment,local);current=false;},d(detaching){destroy_component(util,detaching);}};}const imageZoomLevelMax=1;const imageZoomLevelBase=0;function instance$r($$self,$$props,$$invalidate){let $imageCropAspectRatio;let $imageCropRect;let $imageSize;let $imageRotation;let $imageFlipY;let $imageFlipX;let $selectedPresetIndex;let $imageOutputSize;let $imageCropMinSize;let $imageCropLimitToImage;let $isInteracting;let $imageSelectionRectSnapshot;let $imageSelectionRect;let $presentationScalar;let $imageCropMaxSize;let $imageSelectionRectIntent;let $utilRect;let $imageCropRectOrigin;let $imageCropRectIntent;let $imageCropRange;let $rootRect;let $stageRect;let $imageCropRangeAspectRatio;let $imageSelectionRectPresentation;let $env;let $imageScalar;let $isActive,$$unsubscribe_isActive=noop$1,$$subscribe_isActive=()=>($$unsubscribe_isActive(),$$unsubscribe_isActive=subscribe(isActive,$$value=>$$invalidate(16,$isActive=$$value)),isActive);let $imagePreviewModifiers;let $footerOffset;let $recenterOpacity;let $recenterOffset;let $imageRotationRange;let $imageZoomLevelRange;let $imageZoomLevel;$$self.$$.on_destroy.push(()=>$$unsubscribe_isActive());const name=\"crop\";let{isActive}=$$props;$$subscribe_isActive();let{stores}=$$props;let{cropImageSelectionCornerStyle=\"circle\"}=$$props;// 'circle', 'hook'\nlet{cropAutoCenterImageSelectionTimeout=undefined}=$$props;let{cropEnableZoomMatchImageAspectRatio=true}=$$props;let{cropEnableRotateMatchImageAspectRatio=\"never\"}=$$props;// 'always' | 'custom' | 'never'\nlet{cropEnableRotationInput=true}=$$props;let{cropEnableZoom=true}=$$props;let{cropEnableZoomInput=true}=$$props;let{cropEnableImageSelection=true}=$$props;let{cropEnableInfoIndicator=false}=$$props;let{cropEnableZoomTowardsWheelPosition=true}=$$props;let{cropEnableLimitWheelInputToCropSelection=true}=$$props;let{cropEnableCenterImageSelection=true}=$$props;let{cropEnableButtonRotateLeft=true}=$$props;let{cropEnableButtonRotateRight=false}=$$props;let{cropEnableButtonFlipHorizontal=true}=$$props;let{cropEnableButtonFlipVertical=false}=$$props;let{cropSelectPresetOptions=undefined}=$$props;let{cropEnableSelectPreset=true}=$$props;let{cropEnableButtonToggleCropLimit=false}=$$props;let{locale={}}=$$props;let{tools=[]}=$$props;const isCustomCrop=()=>$imageCropAspectRatio===undefined;const turnAspectRatio=aspectRatio=>1/aspectRatio;const hasValidRotatedCropAspectRatio=()=>{if($imageCropAspectRatio===1)return false;const rotatedImageCropAspectRatio=turnAspectRatio($imageCropAspectRatio);// no options available, forced crop aspect ratio\nif(!cropSelectPresetOptions)return false;// options available but no valid option in list\nif(!flattenOptions(cropSelectPresetOptions).find(([aspectRatio])=>aspectRatio===rotatedImageCropAspectRatio))return false;return true;};const isCropMaxSize=(imageCropRect,imageSize,imageRotation)=>isRotatedSideways(imageRotation)?imageSize.width===Math.round(imageCropRect.height)||imageSize.height===Math.round(imageCropRect.width):imageSize.width===Math.round(imageCropRect.width)||imageSize.height===Math.round(imageCropRect.height);const isCropCentered=(imageCropRect,imageSize,imageRotation)=>{const imageSizeRotated=sizeApply(sizeRotate(sizeClone(imageSize),imageRotation),v=>Math.abs(Math.round(v)));const imageCenter=sizeCenter(imageSizeRotated);const cropCenter=rectCenter(imageCropRect);return vectorEqual(imageCenter,cropCenter);};const canMatchCropAspectRatioToRotation=()=>(// is custom crop mode\nisCustomCrop()||// can match preset crop and preset is available\ncropEnableRotateMatchImageAspectRatio===\"always\"&&hasValidRotatedCropAspectRatio())&&isCropCentered($imageCropRect,$imageSize,$imageRotation)&&isCropMaxSize($imageCropRect,$imageSize,$imageRotation);const applyRotation=value=>{if(cropEnableRotateMatchImageAspectRatio!==\"never\"&&canMatchCropAspectRatioToRotation()){set_store_value(imageRotation,$imageRotation+=value,$imageRotation);const isRotated=isRotatedSideways($imageRotation);const w=isRotated?$imageSize.height:$imageSize.width;const h=isRotated?$imageSize.width:$imageSize.height;set_store_value(imageCropRect,$imageCropRect=rectCreate(0,0,w,h),$imageCropRect);if(!isCustomCrop())set_store_value(imageCropAspectRatio,$imageCropAspectRatio=getAspectRatio(w,h),$imageCropAspectRatio);}else{set_store_value(imageRotation,$imageRotation+=value,$imageRotation);}};const{history,env,isInteracting,rootRect,stageRect,utilRect,elasticityMultiplier,rangeInputElasticity,presentationScalar,// effect filtering\nimagePreviewModifiers,// crop selection\nimageFlipX,imageFlipY,imageRotation,imageRotationRange,imageOutputSize,imageSelectionRect,imageSelectionRectSnapshot,imageSelectionRectIntent,imageSelectionRectPresentation,imageCropRectIntent,imageCropRectOrigin,imageCropRect,imageCropMinSize,imageCropMaxSize,imageCropRange,imageCropAspectRatio,imageCropRectAspectRatio,imageCropLimitToImage,imageSize,imageScalar}=stores;// the actual limited rectangle\n// used to calculate rectangle while dragging\n// can be used to set set intended rectangle\n// readonly\ncomponent_subscribe($$self,env,value=>$$invalidate(140,$env=value));component_subscribe($$self,isInteracting,value=>$$invalidate(120,$isInteracting=value));component_subscribe($$self,rootRect,value=>$$invalidate(10,$rootRect=value));component_subscribe($$self,stageRect,value=>$$invalidate(130,$stageRect=value));component_subscribe($$self,utilRect,value=>$$invalidate(126,$utilRect=value));component_subscribe($$self,presentationScalar,value=>$$invalidate(123,$presentationScalar=value));component_subscribe($$self,imagePreviewModifiers,value=>$$invalidate(143,$imagePreviewModifiers=value));component_subscribe($$self,imageFlipX,value=>$$invalidate(113,$imageFlipX=value));component_subscribe($$self,imageFlipY,value=>$$invalidate(112,$imageFlipY=value));component_subscribe($$self,imageRotation,value=>$$invalidate(8,$imageRotation=value));component_subscribe($$self,imageRotationRange,value=>$$invalidate(26,$imageRotationRange=value));component_subscribe($$self,imageOutputSize,value=>$$invalidate(116,$imageOutputSize=value));component_subscribe($$self,imageSelectionRect,value=>$$invalidate(122,$imageSelectionRect=value));component_subscribe($$self,imageSelectionRectSnapshot,value=>$$invalidate(121,$imageSelectionRectSnapshot=value));component_subscribe($$self,imageSelectionRectIntent,value=>$$invalidate(125,$imageSelectionRectIntent=value));component_subscribe($$self,imageSelectionRectPresentation,value=>$$invalidate(134,$imageSelectionRectPresentation=value));component_subscribe($$self,imageCropRectIntent,value=>$$invalidate(128,$imageCropRectIntent=value));component_subscribe($$self,imageCropRectOrigin,value=>$$invalidate(127,$imageCropRectOrigin=value));component_subscribe($$self,imageCropRect,value=>$$invalidate(7,$imageCropRect=value));component_subscribe($$self,imageCropMinSize,value=>$$invalidate(118,$imageCropMinSize=value));component_subscribe($$self,imageCropMaxSize,value=>$$invalidate(124,$imageCropMaxSize=value));component_subscribe($$self,imageCropRange,value=>$$invalidate(129,$imageCropRange=value));component_subscribe($$self,imageCropAspectRatio,value=>$$invalidate(110,$imageCropAspectRatio=value));component_subscribe($$self,imageCropLimitToImage,value=>$$invalidate(119,$imageCropLimitToImage=value));component_subscribe($$self,imageSize,value=>$$invalidate(111,$imageSize=value));component_subscribe($$self,imageScalar,value=>$$invalidate(142,$imageScalar=value));//\n// resizing crop\n//\nlet presentationScalarSnapshot;let imageSelectionRectMinSize;let imageSelectionRectMaxSize;const handleSelectionGrab=()=>{// now interacting\nset_store_value(isInteracting,$isInteracting=true,$isInteracting);// we remember the current view rect and crop rect, because that is the crop rect we use as a starting point to transform while dragging\nset_store_value(imageSelectionRectSnapshot,$imageSelectionRectSnapshot=rectClone($imageSelectionRect),$imageSelectionRectSnapshot);// remember current scalar so we can update min and max size correctly\npresentationScalarSnapshot=$presentationScalar;imageSelectionRectMinSize=sizeScale(sizeClone($imageCropMinSize),presentationScalarSnapshot);imageSelectionRectMaxSize=sizeScale(sizeClone($imageCropMaxSize),presentationScalarSnapshot);};const handleSelectionDrag=({detail})=>{const{boundsLimited,boundsIntent}=translateSelection(detail.direction,detail.translation);// update actual image selection rectangle\nset_store_value(imageSelectionRectIntent,$imageSelectionRectIntent=boundsIntent,$imageSelectionRectIntent);// intent needs to be updated first because has no listeners attached\nset_store_value(imageSelectionRect,$imageSelectionRect=boundsLimited,$imageSelectionRect);};const handleSelectionRelease=({detail})=>{const{boundsLimited}=translateSelection(detail.direction,detail.translation);// we're no longer interacting with the image selection, we need to set this here so the image selection presentation is animated when applying the new bounds below\nset_store_value(isInteracting,$isInteracting=false,$isInteracting);// no more intent as we're finalizing the selection, so before setting the final selection, we set this to undefined | intent needs to be updated first because has no listeners attached\nset_store_value(imageSelectionRectIntent,$imageSelectionRectIntent=undefined,$imageSelectionRectIntent);// confirm the limited rect if actually made a change\nif(vectorLength(detail.translation)){set_store_value(imageSelectionRect,$imageSelectionRect=boundsLimited,$imageSelectionRect);history.write();}// need to set this to undefined after setting the final rect, the snapshot is used to calculate the crop rect transform\nset_store_value(imageSelectionRectSnapshot,$imageSelectionRectSnapshot=undefined,$imageSelectionRectSnapshot);};const translateSelection=(target,translate)=>{// - selection may grow to max bounds (util bounds)\n// - the image preview(!) is scaled to fit the selection, actual image size is not affected\n// - we need to make sure the selection adheres to the aspect ratio of the min size\nconst directionTranslation={target,translate};let rectIntended=applyRectDirectionTranslation($imageSelectionRectSnapshot,directionTranslation,{aspectRatio:$imageCropAspectRatio});let cropAspectRatioLimited;// size in crop rect\nconst cropSize=sizeCreateFromRect(rectDivide(rectClone(rectIntended),$presentationScalar));const imagePolygon=getImagePolygon($imageSize,$imageRotation);const imageCenter=quadCentroid(imagePolygon);// if one of the edges is small and not both are smaller we need to correct\nif(cropSize.width<$imageCropMinSize.width||cropSize.height<$imageCropMinSize.height){// if moving towards the center of the crop, it can't exceed bounds\nconst translateUp=translate.y<0;const translateRight=translate.x>0;const translateLeft=translate.x<0;const translateDown=translate.y>0;const couldExceedBounds=target===\"t\"&&translateUp||target===\"r\"&&translateRight||target===\"b\"&&translateDown||target===\"l\"&&translateLeft||target===\"tr\"&&(translateRight||translateUp)||target===\"tl\"&&(translateLeft||translateUp)||target===\"br\"&&(translateRight||translateDown)||target===\"bl\"&&(translateLeft||translateDown);// need the aspect ratio of the crop to determine if it violates min size\nconst cropAspectRatio=rectAspectRatio(cropSize);// find the maximum size for the current aspect ratio\nconst cropSizeMax=getMaxSizeInRect($imageSize,$imageRotation,cropAspectRatio);if(couldExceedBounds&&(cropSizeMax.width<$imageCropMinSize.width||cropSizeMax.height<$imageCropMinSize.height)){if($imageRotation!==0){const sign=Math.sign($imageRotation);const turns=Math.round(Math.abs($imageRotation)/HALF_PI)*HALF_PI;const value=$imageRotation-sign*turns;const imageIsRotated=turns/HALF_PI%2===1;const imageWidth=imageIsRotated?$imageSize.height:$imageSize.width;const imageHeight=imageIsRotated?$imageSize.width:$imageSize.height;const r=Math.abs(value);const sin=Math.sin(r);const cos=Math.cos(r);if(cropSize.width<$imageCropMinSize.width){// width doesn't fit, let's limit the width to the min size\ncropSize.width=$imageCropMinSize.width;// And now calculate the height\n//  - rotation = .15\n//  - image size = 384 x 288\n//  - crop size width = 200\n// height = 288 - (Math.sin(.15) * 200) / Math.cos(.15)\nconst w=cos*cropSize.width+sin*cropSize.height;const h=sin*cropSize.width+cos*cropSize.height;const dx=imageWidth-w;const dy=imageHeight-h;if(dx<dy){cropSize.height=(imageWidth-cos*cropSize.width)/sin;}else if(dy<dx){cropSize.height=(imageHeight-sin*cropSize.width)/cos;}}if(cropSize.height<$imageCropMinSize.height){// height doesn't fit, let's limit the height to the min size\ncropSize.height=$imageCropMinSize.height;// And now calculate the width\n//  - rotation = .15\n//  - image size = 384 x 288\n//  - crop size height = 200\nconst w=cos*cropSize.width+sin*cropSize.height;const h=sin*cropSize.width+cos*cropSize.height;const dx=imageWidth-w;const dy=imageHeight-h;if(dx<dy){// (384 - (Math.sin(.15) * 250)) / Math.cos(.15)\ncropSize.width=(imageWidth-sin*cropSize.height)/cos;}else if(dy<dx){// (288 - (Math.cos(.15) * 250)) / Math.sin(.15)\ncropSize.width=(imageHeight-cos*cropSize.height)/sin;}}}else{if(cropSize.width<$imageCropMinSize.width){cropSize.width=$imageCropMinSize.width;cropSize.height=$imageSize.height;}if(cropSize.height<$imageCropMinSize.height){cropSize.height=$imageCropMinSize.height;cropSize.width=$imageSize.width;}}// we now have a corrected size, let's calculate the new aspect ratio and use that to limit the translation\ncropAspectRatioLimited=rectAspectRatio(cropSize);}}if(cropAspectRatioLimited){rectIntended=applyRectDirectionTranslation($imageSelectionRectSnapshot,directionTranslation,{aspectRatio:cropAspectRatioLimited||$imageCropAspectRatio});}let rectLimited=limitRectDirectionTranslation($imageSelectionRectSnapshot,directionTranslation,$utilRect,{aspectRatio:$imageCropAspectRatio||cropAspectRatioLimited,minSize:imageSelectionRectMinSize,maxSize:imageSelectionRectMaxSize});return{boundsLimited:rectLimited,boundsIntent:rectIntended};};//\n// rotating\n//\nconst handleRotateStart=()=>{// now interacting with view\nset_store_value(isInteracting,$isInteracting=true,$isInteracting);// we need to know the origin of the crop so we can \"shrink\" the image to fit the crop rect while rotating\nset_store_value(imageCropRectOrigin,$imageCropRectOrigin=rectClone($imageCropRect),$imageCropRectOrigin);};const handleRotateMove=value=>{set_store_value(imageRotation,$imageRotation=value,$imageRotation);// will auto validate\n};const handleRotateEnd=value=>{// we're done interacting\nset_store_value(isInteracting,$isInteracting=false,$isInteracting);// apply our final rotation value\nset_store_value(imageRotation,$imageRotation=value,$imageRotation);history.write();// done, so we no longer need to \"shrink\" the image\nset_store_value(imageCropRectOrigin,$imageCropRectOrigin=undefined,$imageCropRectOrigin);};//\n// moving\n//\nlet interactionCropRect=undefined;let interactionCropRectForce=undefined;const handleImageDragStart=()=>{interactionCropRectForce=undefined;set_store_value(isInteracting,$isInteracting=true,$isInteracting);interactionCropRect=rectClone($imageCropRect);};const handleImageDrag=({detail})=>manipulateImage(detail);const handleImageDragEnd=({detail})=>{// done interacting\nset_store_value(isInteracting,$isInteracting=false,$isInteracting);// apply translation to the crop rect only if did make changes\nif(vectorLength(detail.translation)>0||detail.scalar!==0){manipulateImage(detail);history.write();}// no intent (needs to be set before crop rect is updated)\nset_store_value(imageCropRectIntent,$imageCropRectIntent=undefined,$imageCropRectIntent);// now done\ninteractionCropRect=undefined;};const handleImageDragRelease=({detail})=>{interactionCropRectForce=detail.translation;set_store_value(isInteracting,$isInteracting=false,$isInteracting);};const manipulateImage=({translation,scalar})=>{const imageSelectionRectZoomFactor=Math.min($imageSelectionRect.width/$imageCropRect.width,$imageSelectionRect.height/$imageCropRect.height);const scaledTranslation=vectorMultiply(vectorClone(translation),1/imageSelectionRectZoomFactor);// while we're interacting we apply changes to the original crop rectangle, after we apply a force\nlet cropIntent;if(!interactionCropRectForce){cropIntent=rectTranslate(rectClone(interactionCropRect),vectorInvert(vectorClone(scaledTranslation)));if(scalar!==undefined){rectScale(cropIntent,1-scalar);}}else{// we apply the force to the existing crop rect so animation is not borked\nconst forceTranslation=vectorSubtract(vectorClone(interactionCropRectForce),translation);interactionCropRectForce=translation;cropIntent=rectTranslate(rectClone($imageCropRect),forceTranslation);}// update crop rect\nset_store_value(imageCropRectIntent,$imageCropRectIntent=cropIntent,$imageCropRectIntent);// auto calculates an elastic effect if bounds exceeded (needs to be set before crop rect is updated)\nset_store_value(imageCropRect,$imageCropRect=cropIntent,$imageCropRect);// auto limits to bounds if needed\n};//\n// resizing with range input\n//\nconst calculateZoomLevel=(imageSize,size,imageRotation)=>{if(isRotatedSideways(imageRotation)){return 1-1/Math.min(imageSize.height/size.width,imageSize.width/size.height);}return 1-1/Math.min(imageSize.width/size.width,imageSize.height/size.height);};const imageCropRangeAspectRatio=derived([imageCropRange,imageCropRect],([$imageCropRange,$imageCropRect],set)=>{if(!$imageCropRect)return;const[minSize,maxSize]=$imageCropRange;const aspectRatio=rectAspectRatio($imageCropRect);set([sizeCreateFromRect(rectApply(rectCoverRect(minSize,aspectRatio),fixPrecision)),sizeCreateFromRect(rectApply(rectContainRect(maxSize,aspectRatio),fixPrecision))]);});component_subscribe($$self,imageCropRangeAspectRatio,value=>$$invalidate(131,$imageCropRangeAspectRatio=value));// this is the max value range that can be set (triggers white range indicator bar)\nconst imageZoomLevelRange=derived([imageSize,imageCropLimitToImage,imageCropMinSize,imageCropMaxSize,imageCropRange,imageRotation],([$imageSize,$imageCropLimitToImage,$imageCropMinSize,$imageCropMaxSize,$imageCropRange,$imageRotation],set)=>{if(!$imageSize)return;const rangeMinSize=$imageCropRange[0];const rangeMaxSize=$imageCropRange[1];let minZoom;let maxZoom;// can't zoom out\nif($imageCropLimitToImage){minZoom=calculateZoomLevel($imageSize,rangeMaxSize,$imageRotation);maxZoom=Math.min(rangeMinSize.width/$imageCropMinSize.width,rangeMinSize.height/$imageCropMinSize.height);}else{maxZoom=1;minZoom=-1;}const range=[fixPrecision(minZoom),fixPrecision(maxZoom)];set(range);});component_subscribe($$self,imageZoomLevelRange,value=>$$invalidate(27,$imageZoomLevelRange=value));const imageZoomLevel=derived([imageSize,imageCropRect,imageCropRange,imageRotation],([$imageSize,$imageCropRect,$imageCropRange,$imageRotation],set)=>{// need to check if this value is set, could be that it's empty while loading a new image\nif(!$imageSize||!$imageCropRect)return set(0);let z;const rangeMinSize=$imageCropRange[0];const rangeMaxSize=$imageCropRange[1];const currentCropWidth=$imageCropRect.width;const currentCropHeight=$imageCropRect.height;const currentCropAspectRatio=rectAspectRatio($imageCropRect);const imageRect=isRotatedSideways($imageRotation)?sizeCreate($imageSize.height,$imageSize.width):$imageSize;const imageCropMaxRect=rectContainRect(imageRect,currentCropAspectRatio);if(currentCropWidth<=imageCropMaxRect.width||currentCropHeight<=imageCropMaxRect.height){// zoomed in\nconst w=imageCropMaxRect.width-rangeMinSize.width;const h=imageCropMaxRect.height-rangeMinSize.height;// cannot zoom in\nif(w===0||h===0){z=1;}else{z=1-Math.min((currentCropWidth-rangeMinSize.width)/w,(currentCropHeight-rangeMinSize.height)/h);}}else{// zoomed out\nconst w=rangeMaxSize.width-imageCropMaxRect.width;const h=rangeMaxSize.height-imageCropMaxRect.height;const r=rectContainRect({width:w,height:h},currentCropAspectRatio);z=-Math.min((currentCropWidth-imageCropMaxRect.width)/r.width,(currentCropHeight-imageCropMaxRect.height)/r.height);}set(z);});component_subscribe($$self,imageZoomLevel,value=>$$invalidate(28,$imageZoomLevel=value));const snapshotCropRect=()=>{interactionCropRect=rectClone($imageCropRect);};const resizeImage=zoom=>{const aspectRatio=rectAspectRatio(interactionCropRect);let targetWidth;let targetHeight;let r;const imageRect=isRotatedSideways($imageRotation)?sizeCreate($imageSize.height,$imageSize.width):$imageSize;const imageCropMaxRect=rectContainRect(imageRect,aspectRatio);if(zoom>=0){// zoom in\nconst rangeWidth=imageCropMaxRect.width-$imageCropRange[0].width;const rangeHeight=imageCropMaxRect.height-$imageCropRange[0].height;targetWidth=imageCropMaxRect.width-rangeWidth*zoom;targetHeight=imageCropMaxRect.height-rangeHeight*zoom;r=rectCoverRect({width:targetWidth,height:targetHeight},aspectRatio);}else{// zoom out\nconst rangeWidth=$imageCropRange[1].width-imageCropMaxRect.width;const rangeHeight=$imageCropRange[1].height-imageCropMaxRect.height;targetWidth=imageCropMaxRect.width+rangeWidth*-zoom;targetHeight=imageCropMaxRect.height+rangeHeight*-zoom;r=rectContainRect({width:targetWidth,height:targetHeight},aspectRatio);}targetWidth=r.width;targetHeight=r.height;const targetX=interactionCropRect.x+interactionCropRect.width*0.5-targetWidth*0.5;const targetY=interactionCropRect.y+interactionCropRect.height*0.5-targetHeight*0.5;set_store_value(imageCropRect,$imageCropRect={x:targetX,y:targetY,width:targetWidth,height:targetHeight},$imageCropRect);};const handleResizeStart=()=>{// now interacting with view\nset_store_value(isInteracting,$isInteracting=true,$isInteracting);snapshotCropRect();};const handleResizeMove=value=>{// value range from 0 (no zoom) to 1 (100% zoom, 1x1 pixel)\nresizeImage(value);};const handleResizeEnd=value=>{resizeImage(value);history.write();// we're done interacting\nset_store_value(isInteracting,$isInteracting=false,$isInteracting);// now done\ninteractionCropRect=undefined;};//\n// resizing with wheel\n//\nlet zoomHistoryTimeoutId;const handleWheel=e=>{const stageWheelPosition=getEventPositionInStage(e,$rootRect,$stageRect);// only block input if wheel is used within image rectangle\nif(cropEnableLimitWheelInputToCropSelection&&!rectContainsPoint($imageSelectionRect,stageWheelPosition))return;// now interacting\nset_store_value(isInteracting,$isInteracting=true,$isInteracting);// don't run default actions, prevent other actions from running\ne.preventDefault();e.stopPropagation();// get current crop rect\nconst currentCropRect=rectClone($imageCropRect);// convert wheel delta to scalar\nconst delta=getWheelDelta(e);const scalar=1+delta/100;// if already zoomed in, block further zoom in instructions\nconst isMinSize=Math.min($imageCropRect.width/$imageCropMinSize.width,$imageCropRect.height/$imageCropMinSize.height)===1;// if is fully zoomed out and trying to zoom out more and crop shape is free, fit image aspect ratio\nif(cropEnableZoomMatchImageAspectRatio&&$imageCropLimitToImage){const isAtMaxCropSize=isCropMaxSize($imageCropRect,$imageSize,$imageRotation);if(isCustomCrop()&&isAtMaxCropSize&&delta>0&&isImageSelectionCentered){set_store_value(isInteracting,$isInteracting=false,$isInteracting);const newCropRect=isRotatedSideways($imageRotation)?rectCreateFromSize({height:$imageSize.width,width:$imageSize.height}):rectCreateFromSize($imageSize);// no change, exit\nif(rectEqual(currentCropRect,newCropRect))return;// if we were previously zooming in we need to clear the timeout to prevent two history entries\nclearTimeout(zoomHistoryTimeoutId);// test if crop rect in history is same as new crop rect, this is possible when zooming in and out real quick\nif(rectEqual(history.state.crop,newCropRect))return;// store new crop rect\nset_store_value(imageCropRect,$imageCropRect=newCropRect,$imageCropRect);history.write();return;}}// by default when zooming, zoom from center of crop rectangle\nlet origin=rectCenter($imageCropRect);// when zooming in, zoom in on the part of the image below the mouse cursor\nif(cropEnableZoomTowardsWheelPosition&&delta<0&&!isMinSize){const selectionOffset=vectorSubtract(vectorClone(stageWheelPosition),$imageSelectionRect);const imageSelectionScale=Math.min($imageSelectionRect.width/$imageCropRect.width,$imageSelectionRect.height/$imageCropRect.height);// if wheel is inside image selection rectangle (slightly expanded version), we zoom based on position in the rectangle, if not, we use the selection center\nconst expandedImageSelection=rectScale(rectClone($imageSelectionRect),1.1);origin=rectContainsPoint(expandedImageSelection,stageWheelPosition)?vectorAdd(rectClone($imageCropRect),vectorMultiply(selectionOffset,1/imageSelectionScale)):origin;}let newCropRect=rectScale(rectClone($imageCropRect),scalar,origin);// determin if is new crop rect exceeds min or max size, if so, limit\nif(!sizeContains($imageCropRangeAspectRatio[1],newCropRect)){// exceeds max size, limit to max size and position at new crop rect center\nnewCropRect=rectCreateWithCenter(rectCenter(newCropRect),$imageCropRangeAspectRatio[1]);}if(!sizeContains(newCropRect,$imageCropRangeAspectRatio[0])){// exceeds min size, limit to min size and position at new crop rect center\nnewCropRect=rectCreateWithCenter(rectCenter(newCropRect),$imageCropRangeAspectRatio[0]);}// no change, exit\nif(rectEqual(currentCropRect,newCropRect,fixPrecision)){set_store_value(isInteracting,$isInteracting=false,$isInteracting);return;}// attempt to update the rectangle, we use fixPrecision so the width and height are nice integers when at max zoom (this makes sure the `isMinSize` variable is set to true at this point)\nset_store_value(imageCropRect,$imageCropRect=rectApply(newCropRect,v=>fixPrecision(v,5)),$imageCropRect);// done!\nset_store_value(isInteracting,$isInteracting=false,$isInteracting);// write history timer\nclearTimeout(zoomHistoryTimeoutId);zoomHistoryTimeoutId=setTimeout(()=>{history.write();},500);};//\n// recenter\n//\n// the 'measure' event triggers the editor to center and scale up the crop\nconst dispatch=createEventDispatcher();const handleRecenterAction=()=>{dispatch(\"measure\",rectClone($utilRect));};// auto recenter after timeout\nlet cropAutoCenterImageSelectionTimeoutId;// animations\nconst recenterOpacity=spring(0,{precision:0.0001});component_subscribe($$self,recenterOpacity,value=>$$invalidate(24,$recenterOpacity=value));const recenterOffset=spring();component_subscribe($$self,recenterOffset,value=>$$invalidate(25,$recenterOffset=value));const footerOffset=spring(0);component_subscribe($$self,footerOffset,value=>$$invalidate(146,$footerOffset=value));//\n// crop selection presets\n//\nconst selectedPresetIndex=derived([imageCropAspectRatio,imageOutputSize],([$cropAspectRatio,$imageOutputSize],set)=>{if(!cropSelectPresetOptions)return;const options=flattenOptions(cropSelectPresetOptions);const matchedOptionValue=[...options].// to value\nmap(option=>option[0]).// sort sizes first\nsort((a,b)=>{if(isArray(a[0])&&!isArray(b[0]))return 1;return-1;}).// match value\nfind(value=>{if(isArray(value)&&$imageOutputSize){// size + aspect ratio\nconst[width,height]=value;const outputSizeMatches=$imageOutputSize.width===width&&$imageOutputSize.height===height;const aspectRatioMatches=$cropAspectRatio===getAspectRatio(width,height);return outputSizeMatches&&aspectRatioMatches;}// aspect ratio\nreturn value===$cropAspectRatio;});const index=options.// to value\nmap(option=>option[0]).// find index of matching value\nfindIndex(value=>isArray(value)?arrayEqual(value,matchedOptionValue):value===matchedOptionValue);set(index);});component_subscribe($$self,selectedPresetIndex,value=>$$invalidate(115,$selectedPresetIndex=value));const getSelectionPresetLabelIcon=selectedIndex=>{if(!cropSelectPresetOptions)return;const selectedValue=flattenOptions(cropSelectPresetOptions)[selectedIndex][0];const aspectRatio=!selectedValue?undefined:isArray(selectedValue)?getAspectRatio(selectedValue[0],selectedValue[1]):selectedValue;const[a,b,c]=!aspectRatio?[0.2,0.3,0.4]:[aspectRatio<1?1:0.3,aspectRatio===1?0.85:0.5,aspectRatio>1?1:0.3];return`<g fill=\"currentColor\">\n        <rect opacity=\"${a}\" x=\"2\" y=\"4\" width=\"10\" height=\"18\" rx=\"1\"/>\n        <rect opacity=\"${b}\" x=\"4\" y=\"8\" width=\"14\" height=\"14\" rx=\"1\"/>\n        <rect opacity=\"${c}\" x=\"6\" y=\"12\" width=\"17\" height=\"10\" rx=\"1\"/>\n    </g>`;};//\n// crop boundary\n//\nconst getCropBoundaryLabelIcon=isBoundToImage=>{const[a,b,c,d]=isBoundToImage?[0.3,1,0,0]:[0,0,0.3,1];return`<g fill=\"currentColor\">\n        <rect opacity=\"${a}\" x=\"2\" y=\"3\" width=\"20\" height=\"20\" rx=\"1\"/>\n        <rect opacity=\"${b}\" x=\"7\" y=\"8\" width=\"10\" height=\"10\" rx=\"1\"/>\n        <rect opacity=\"${c}\" x=\"4\" y=\"8\" width=\"14\" height=\"14\" rx=\"1\"/>\n        <rect opacity=\"${d}\" x=\"12\" y=\"4\" width=\"10\" height=\"10\" rx=\"1\"/>\n    </g>`;};const cropUniqueId=`crop-${getUniqueId()}`;let transformInitial=cropEnableRotationInput?\"rotation\":\"zoom\";let transformToolInitial=cropUniqueId+\"-\"+transformInitial;let transformSelected=transformToolInitial;let root=undefined;function measure_handler_1(event){bubble($$self,event);}const interactable_function=e=>getEventPositionInViewport(e);const select_handler=({detail})=>$$invalidate(5,transformSelected=detail);function util_root_binding(value){root=value;$$invalidate(6,root);}function measure_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"isActive\"in $$props)$$subscribe_isActive($$invalidate(1,isActive=$$props.isActive));if(\"stores\"in $$props)$$invalidate(80,stores=$$props.stores);if(\"cropImageSelectionCornerStyle\"in $$props)$$invalidate(2,cropImageSelectionCornerStyle=$$props.cropImageSelectionCornerStyle);if(\"cropAutoCenterImageSelectionTimeout\"in $$props)$$invalidate(81,cropAutoCenterImageSelectionTimeout=$$props.cropAutoCenterImageSelectionTimeout);if(\"cropEnableZoomMatchImageAspectRatio\"in $$props)$$invalidate(82,cropEnableZoomMatchImageAspectRatio=$$props.cropEnableZoomMatchImageAspectRatio);if(\"cropEnableRotateMatchImageAspectRatio\"in $$props)$$invalidate(83,cropEnableRotateMatchImageAspectRatio=$$props.cropEnableRotateMatchImageAspectRatio);if(\"cropEnableRotationInput\"in $$props)$$invalidate(84,cropEnableRotationInput=$$props.cropEnableRotationInput);if(\"cropEnableZoom\"in $$props)$$invalidate(3,cropEnableZoom=$$props.cropEnableZoom);if(\"cropEnableZoomInput\"in $$props)$$invalidate(85,cropEnableZoomInput=$$props.cropEnableZoomInput);if(\"cropEnableImageSelection\"in $$props)$$invalidate(86,cropEnableImageSelection=$$props.cropEnableImageSelection);if(\"cropEnableInfoIndicator\"in $$props)$$invalidate(87,cropEnableInfoIndicator=$$props.cropEnableInfoIndicator);if(\"cropEnableZoomTowardsWheelPosition\"in $$props)$$invalidate(88,cropEnableZoomTowardsWheelPosition=$$props.cropEnableZoomTowardsWheelPosition);if(\"cropEnableLimitWheelInputToCropSelection\"in $$props)$$invalidate(89,cropEnableLimitWheelInputToCropSelection=$$props.cropEnableLimitWheelInputToCropSelection);if(\"cropEnableCenterImageSelection\"in $$props)$$invalidate(90,cropEnableCenterImageSelection=$$props.cropEnableCenterImageSelection);if(\"cropEnableButtonRotateLeft\"in $$props)$$invalidate(91,cropEnableButtonRotateLeft=$$props.cropEnableButtonRotateLeft);if(\"cropEnableButtonRotateRight\"in $$props)$$invalidate(92,cropEnableButtonRotateRight=$$props.cropEnableButtonRotateRight);if(\"cropEnableButtonFlipHorizontal\"in $$props)$$invalidate(93,cropEnableButtonFlipHorizontal=$$props.cropEnableButtonFlipHorizontal);if(\"cropEnableButtonFlipVertical\"in $$props)$$invalidate(94,cropEnableButtonFlipVertical=$$props.cropEnableButtonFlipVertical);if(\"cropSelectPresetOptions\"in $$props)$$invalidate(95,cropSelectPresetOptions=$$props.cropSelectPresetOptions);if(\"cropEnableSelectPreset\"in $$props)$$invalidate(96,cropEnableSelectPreset=$$props.cropEnableSelectPreset);if(\"cropEnableButtonToggleCropLimit\"in $$props)$$invalidate(97,cropEnableButtonToggleCropLimit=$$props.cropEnableButtonToggleCropLimit);if(\"locale\"in $$props)$$invalidate(4,locale=$$props.locale);if(\"tools\"in $$props)$$invalidate(0,tools=$$props.tools);};let imageZoomLevelMin;let imageSelectionOffset;let imageSelectionCenter;let imageSelectionCenteredRect;let isImageSelectionDisplayed;let isImageSelectionCentered;let isResizingSelection;let isMaxSelectionRect;let isOverlayMode;let canZoomToCenter;let canCenter;let shouldRenderInfoIndicator;let shouldRenderImageSelection;let shouldRenderImageSelectionRecenterButton;let imageSelectionRectOffset;let shouldRenderPresetSelect;let hasPlentyVerticalSpace;let shouldRenderToolbar;let shouldRenderZoomInput;let shouldRenderFooter;let shouldRenderTabs;let tabsConfig;let tabs;let panels;let footerStyle;$$self.$$.update=()=>{if($$self.$$.dirty[4]&/*$env*/65536){$$invalidate(139,isOverlayMode=$env.layoutMode===\"overlay\");}if($$self.$$.dirty[3]&/*cropEnableSelectPreset*/8|$$self.$$.dirty[4]&/*isOverlayMode*/32768){//\n// Transform tabs\n//\n$$invalidate(114,shouldRenderPresetSelect=cropEnableSelectPreset&&!isOverlayMode);}if($$self.$$.dirty[3]&/*$imageSelectionRect*/536870912|$$self.$$.dirty[4]&/*$utilRect*/4){// determine if we can center the crop, if we can, show the crop center button\n$$invalidate(135,imageSelectionCenteredRect=$utilRect&&$imageSelectionRect&&rectCenterRect($utilRect,$imageSelectionRect));}if($$self.$$.dirty[3]&/*$imageSelectionRect*/536870912|$$self.$$.dirty[4]&/*imageSelectionCenteredRect*/2048){$$invalidate(136,isImageSelectionDisplayed=!!($imageSelectionRect&&imageSelectionCenteredRect));}if($$self.$$.dirty[3]&/*$imageSelectionRect*/536870912|$$self.$$.dirty[4]&/*isImageSelectionDisplayed, imageSelectionCenteredRect*/6144){$$invalidate(117,isImageSelectionCentered=isImageSelectionDisplayed&&rectEqual($imageSelectionRect,imageSelectionCenteredRect,value=>fixPrecision(value,5)));}if($$self.$$.dirty[0]&/*locale, $imageRotation*/272|$$self.$$.dirty[2]&/*cropEnableButtonRotateLeft, cropEnableButtonRotateRight*/1610612736|$$self.$$.dirty[3]&/*cropEnableButtonFlipHorizontal, $imageFlipY, $imageFlipX, cropEnableButtonFlipVertical, shouldRenderPresetSelect, cropSelectPresetOptions, $selectedPresetIndex, isImageSelectionCentered, $imageSize, $imageCropMinSize, cropEnableButtonToggleCropLimit, $imageCropLimitToImage*/125566999){$$invalidate(0,tools=[cropEnableButtonRotateLeft&&[Button,\"rotate-left\",{label:locale.cropLabelButtonRotateLeft,labelClass:\"DokaToolbarContentWide\",icon:locale.cropIconButtonRotateLeft,onclick:()=>{applyRotation(-Math.PI/2);history.write();}}],cropEnableButtonRotateRight&&[Button,\"rotate-right\",{label:locale.cropLabelButtonRotateRight,labelClass:\"DokaToolbarContentWide\",icon:locale.cropIconButtonRotateRight,onclick:()=>{applyRotation(Math.PI/2);history.write();}}],cropEnableButtonFlipHorizontal&&[Button,\"flip-horizontal\",{label:locale.cropLabelButtonFlipHorizontal,labelClass:\"DokaToolbarContentWide\",icon:locale.cropIconButtonFlipHorizontal,onclick:()=>{if(isRotatedSideways($imageRotation)){set_store_value(imageFlipY,$imageFlipY=!$imageFlipY,$imageFlipY);}else{set_store_value(imageFlipX,$imageFlipX=!$imageFlipX,$imageFlipX);}history.write();}}],cropEnableButtonFlipVertical&&[Button,\"flip-vertical\",{label:locale.cropLabelButtonFlipVertical,labelClass:\"DokaToolbarContentWide\",icon:locale.cropIconButtonFlipVertical,onclick:()=>{if(isRotatedSideways($imageRotation)){set_store_value(imageFlipX,$imageFlipX=!$imageFlipX,$imageFlipX);}else{set_store_value(imageFlipY,$imageFlipY=!$imageFlipY,$imageFlipY);}history.write();}}],shouldRenderPresetSelect&&cropSelectPresetOptions&&[Dropdown,\"select-preset\",{icon:getSelectionPresetLabelIcon($selectedPresetIndex),label:locale.cropLabelSelectPreset,labelClass:\"DokaToolbarContentWide\",options:cropSelectPresetOptions,selectedIndex:$selectedPresetIndex,onchange:({value})=>{if(isArray(value)){set_store_value(imageCropAspectRatio,$imageCropAspectRatio=getAspectRatio(value[0],value[1]),$imageCropAspectRatio);set_store_value(imageOutputSize,$imageOutputSize=sizeCreateFromArray(value),$imageOutputSize);}else{set_store_value(imageCropAspectRatio,$imageCropAspectRatio=value,$imageCropAspectRatio);}if(isImageSelectionCentered){handleRecenterAction();}history.write();},optionMapper:option=>{// if no aspect ratio found we enable the option by default\nlet disabled=false;// get aspect ratio for this option\nconst optionAspectRatio=isArray(option.value)?option.value[0]/option.value[1]:option.value;// can be undefined in which case we don't need to check anything\nif(optionAspectRatio){const maxCropSize=getMaxSizeInRect($imageSize,$imageRotation,optionAspectRatio);disabled=maxCropSize.width<$imageCropMinSize.width||maxCropSize.height<$imageCropMinSize.height;}// add icon for this option\noption.icon=getSelectionPresetOptionIcon(option.value,{bounds:14});return _objectSpread(_objectSpread({},option),{},{disabled});}}],cropEnableButtonToggleCropLimit&&[Dropdown,\"select-crop-limit\",{icon:getCropBoundaryLabelIcon($imageCropLimitToImage),label:locale.cropLabelCropBoundary,labelClass:\"DokaToolbarContentWide\",onchange:({value})=>{set_store_value(imageCropLimitToImage,$imageCropLimitToImage=value,$imageCropLimitToImage);history.write();},options:[[true,locale.cropLabelCropBoundaryEdge,{icon:getCropBoundaryLabelIcon(true)}],[false,locale.cropLabelCropBoundaryNone,{icon:getCropBoundaryLabelIcon(false)}]]}]]);}if($$self.$$.dirty[3]&/*$imageCropLimitToImage*/67108864){$$invalidate(9,imageZoomLevelMin=$imageCropLimitToImage?0:-1);}if($$self.$$.dirty[4]&/*$utilRect, $stageRect*/68){$$invalidate(132,imageSelectionOffset=$utilRect&&vectorCreate(-($stageRect.x-$utilRect.x),-($stageRect.y-$utilRect.y)));}if($$self.$$.dirty[4]&/*$imageSelectionRectPresentation, imageSelectionOffset*/1280){// normalized crop bounds, we use these to limit the crop interactions to the view\n$$invalidate(133,imageSelectionCenter=$imageSelectionRectPresentation&&vectorCreate(snapToPixel($imageSelectionRectPresentation.x+$imageSelectionRectPresentation.width*0.5+imageSelectionOffset.x),snapToPixel($imageSelectionRectPresentation.y+$imageSelectionRectPresentation.height*0.5+imageSelectionOffset.y)));}if($$self.$$.dirty[3]&/*$imageSelectionRectSnapshot*/268435456){$$invalidate(137,isResizingSelection=$imageSelectionRectSnapshot!=null);}if($$self.$$.dirty[4]&/*$utilRect, imageSelectionCenteredRect*/2052){$$invalidate(138,isMaxSelectionRect=$utilRect&&imageSelectionCenteredRect&&(imageSelectionCenteredRect.height===$utilRect.height||imageSelectionCenteredRect.width===$utilRect.width));}if($$self.$$.dirty[3]&/*$presentationScalar*/1073741824|$$self.$$.dirty[4]&/*isMaxSelectionRect, $imageScalar*/278528){$$invalidate(141,canZoomToCenter=!isMaxSelectionRect&&$presentationScalar<1&&$imageScalar<1);}if($$self.$$.dirty[3]&/*isImageSelectionCentered*/16777216|$$self.$$.dirty[4]&/*isImageSelectionDisplayed, isResizingSelection, canZoomToCenter*/143360){$$invalidate(11,canCenter=isImageSelectionDisplayed&&!isResizingSelection&&(!isImageSelectionCentered||canZoomToCenter));}if($$self.$$.dirty[0]&/*$imageCropRect*/128|$$self.$$.dirty[2]&/*cropEnableInfoIndicator*/33554432|$$self.$$.dirty[4]&/*isOverlayMode*/32768){$$invalidate(12,shouldRenderInfoIndicator=cropEnableInfoIndicator&&!!$imageCropRect&&!isOverlayMode);}if($$self.$$.dirty[4]&/*$imageSelectionRectPresentation, imageSelectionOffset*/1280){$$invalidate(14,imageSelectionRectOffset=$imageSelectionRectPresentation&&imageSelectionOffset&&{x:$imageSelectionRectPresentation.x+imageSelectionOffset.x,y:$imageSelectionRectPresentation.y+imageSelectionOffset.y,width:$imageSelectionRectPresentation.width,height:$imageSelectionRectPresentation.height});}if($$self.$$.dirty[0]&/*imageSelectionRectOffset*/16384|$$self.$$.dirty[2]&/*cropEnableImageSelection*/16777216|$$self.$$.dirty[4]&/*isOverlayMode*/32768){$$invalidate(13,shouldRenderImageSelection=cropEnableImageSelection&&!!imageSelectionRectOffset&&!isOverlayMode);}if($$self.$$.dirty[2]&/*cropEnableCenterImageSelection, cropAutoCenterImageSelectionTimeout*/268959744|$$self.$$.dirty[4]&/*imageSelectionCenter*/512){$$invalidate(15,shouldRenderImageSelectionRecenterButton=cropEnableCenterImageSelection&&!!imageSelectionCenter&&!cropAutoCenterImageSelectionTimeout);}if($$self.$$.dirty[0]&/*canCenter*/2048|$$self.$$.dirty[2]&/*cropAutoCenterImageSelectionTimeout*/524288|$$self.$$.dirty[3]&/*$isInteracting, cropAutoCenterImageSelectionTimeoutId*/134283264){if(canCenter&&cropAutoCenterImageSelectionTimeout&&!$isInteracting){clearTimeout(cropAutoCenterImageSelectionTimeoutId);$$invalidate(109,cropAutoCenterImageSelectionTimeoutId=setTimeout(handleRecenterAction,cropAutoCenterImageSelectionTimeout));}}if($$self.$$.dirty[3]&/*$isInteracting, cropAutoCenterImageSelectionTimeoutId*/134283264){if($isInteracting)clearTimeout(cropAutoCenterImageSelectionTimeoutId);}if($$self.$$.dirty[0]&/*canCenter*/2048){recenterOpacity.set(canCenter?1:0);}if($$self.$$.dirty[4]&/*imageSelectionCenter*/512){recenterOffset.set(imageSelectionCenter);}if($$self.$$.dirty[0]&/*$isActive*/65536){footerOffset.set($isActive?0:20);}if($$self.$$.dirty[0]&/*$isActive*/65536|$$self.$$.dirty[4]&/*$imagePreviewModifiers*/524288){//\n// enable seeing the image outside of the crop area, and disable the vignette effect\n// \nif($isActive){set_store_value(imagePreviewModifiers,$imagePreviewModifiers[\"crop\"]={maskOpacity:0.85,maskMarkupOpacity:0.85},$imagePreviewModifiers);}else{delete $imagePreviewModifiers[\"crop\"];}}if($$self.$$.dirty[4]&/*isOverlayMode, $env*/98304){$$invalidate(144,hasPlentyVerticalSpace=isOverlayMode?false:$env.verticalSpace!==\"short\");}if($$self.$$.dirty[4]&/*hasPlentyVerticalSpace*/1048576){$$invalidate(17,shouldRenderToolbar=hasPlentyVerticalSpace);}if($$self.$$.dirty[0]&/*cropEnableZoom*/8|$$self.$$.dirty[2]&/*cropEnableZoomInput*/8388608|$$self.$$.dirty[4]&/*hasPlentyVerticalSpace*/1048576){$$invalidate(145,shouldRenderZoomInput=cropEnableZoom&&cropEnableZoomInput&&hasPlentyVerticalSpace);}if($$self.$$.dirty[2]&/*cropEnableRotationInput*/4194304|$$self.$$.dirty[4]&/*shouldRenderZoomInput*/2097152){$$invalidate(18,shouldRenderFooter=cropEnableRotationInput||shouldRenderZoomInput);}if($$self.$$.dirty[2]&/*cropEnableRotationInput*/4194304|$$self.$$.dirty[4]&/*shouldRenderZoomInput*/2097152){$$invalidate(19,shouldRenderTabs=cropEnableRotationInput&&shouldRenderZoomInput);}if($$self.$$.dirty[4]&/*shouldRenderZoomInput*/2097152){if(!shouldRenderZoomInput){$$invalidate(5,transformSelected=transformToolInitial);}}if($$self.$$.dirty[0]&/*transformSelected*/32){$$invalidate(20,tabsConfig={name:cropUniqueId,selected:transformSelected});}if($$self.$$.dirty[0]&/*locale*/16){$$invalidate(21,tabs=[{id:cropUniqueId+\"-rotation\",label:locale.cropLabelTabRotation},{id:cropUniqueId+\"-zoom\",label:locale.cropLabelTabZoom}]);}if($$self.$$.dirty[0]&/*tabs*/2097152){$$invalidate(22,panels=tabs.map(tab=>tab.id));}if($$self.$$.dirty[4]&/*$footerOffset*/4194304){$$invalidate(23,footerStyle=$footerOffset?`transform: translateY(${$footerOffset}px)`:undefined);}};return[tools,isActive,cropImageSelectionCornerStyle,cropEnableZoom,locale,transformSelected,root,$imageCropRect,$imageRotation,imageZoomLevelMin,$rootRect,canCenter,shouldRenderInfoIndicator,shouldRenderImageSelection,imageSelectionRectOffset,shouldRenderImageSelectionRecenterButton,$isActive,shouldRenderToolbar,shouldRenderFooter,shouldRenderTabs,tabsConfig,tabs,panels,footerStyle,$recenterOpacity,$recenterOffset,$imageRotationRange,$imageZoomLevelRange,$imageZoomLevel,env,isInteracting,rootRect,stageRect,utilRect,elasticityMultiplier,rangeInputElasticity,presentationScalar,imagePreviewModifiers,imageFlipX,imageFlipY,imageRotation,imageRotationRange,imageOutputSize,imageSelectionRect,imageSelectionRectSnapshot,imageSelectionRectIntent,imageSelectionRectPresentation,imageCropRectIntent,imageCropRectOrigin,imageCropRect,imageCropMinSize,imageCropMaxSize,imageCropRange,imageCropAspectRatio,imageCropLimitToImage,imageSize,imageScalar,handleSelectionGrab,handleSelectionDrag,handleSelectionRelease,handleRotateStart,handleRotateMove,handleRotateEnd,handleImageDragStart,handleImageDrag,handleImageDragEnd,handleImageDragRelease,imageCropRangeAspectRatio,imageZoomLevelRange,imageZoomLevel,handleResizeStart,handleResizeMove,handleResizeEnd,handleWheel,handleRecenterAction,recenterOpacity,recenterOffset,footerOffset,selectedPresetIndex,name,stores,cropAutoCenterImageSelectionTimeout,cropEnableZoomMatchImageAspectRatio,cropEnableRotateMatchImageAspectRatio,cropEnableRotationInput,cropEnableZoomInput,cropEnableImageSelection,cropEnableInfoIndicator,cropEnableZoomTowardsWheelPosition,cropEnableLimitWheelInputToCropSelection,cropEnableCenterImageSelection,cropEnableButtonRotateLeft,cropEnableButtonRotateRight,cropEnableButtonFlipHorizontal,cropEnableButtonFlipVertical,cropSelectPresetOptions,cropEnableSelectPreset,cropEnableButtonToggleCropLimit,measure_handler_1,interactable_function,select_handler,util_root_binding,measure_handler];}class Crop extends SvelteComponent{constructor(options){super();init(this,options,instance$r,create_fragment$r,safe_not_equal,{name:79,isActive:1,stores:80,cropImageSelectionCornerStyle:2,cropAutoCenterImageSelectionTimeout:81,cropEnableZoomMatchImageAspectRatio:82,cropEnableRotateMatchImageAspectRatio:83,cropEnableRotationInput:84,cropEnableZoom:3,cropEnableZoomInput:85,cropEnableImageSelection:86,cropEnableInfoIndicator:87,cropEnableZoomTowardsWheelPosition:88,cropEnableLimitWheelInputToCropSelection:89,cropEnableCenterImageSelection:90,cropEnableButtonRotateLeft:91,cropEnableButtonRotateRight:92,cropEnableButtonFlipHorizontal:93,cropEnableButtonFlipVertical:94,cropSelectPresetOptions:95,cropEnableSelectPreset:96,cropEnableButtonToggleCropLimit:97,locale:4,tools:0},[-1,-1,-1,-1,-1,-1]);}get name(){return this.$$.ctx[79];}get isActive(){return this.$$.ctx[1];}set isActive(isActive){this.$set({isActive});flush();}get stores(){return this.$$.ctx[80];}set stores(stores){this.$set({stores});flush();}get cropImageSelectionCornerStyle(){return this.$$.ctx[2];}set cropImageSelectionCornerStyle(cropImageSelectionCornerStyle){this.$set({cropImageSelectionCornerStyle});flush();}get cropAutoCenterImageSelectionTimeout(){return this.$$.ctx[81];}set cropAutoCenterImageSelectionTimeout(cropAutoCenterImageSelectionTimeout){this.$set({cropAutoCenterImageSelectionTimeout});flush();}get cropEnableZoomMatchImageAspectRatio(){return this.$$.ctx[82];}set cropEnableZoomMatchImageAspectRatio(cropEnableZoomMatchImageAspectRatio){this.$set({cropEnableZoomMatchImageAspectRatio});flush();}get cropEnableRotateMatchImageAspectRatio(){return this.$$.ctx[83];}set cropEnableRotateMatchImageAspectRatio(cropEnableRotateMatchImageAspectRatio){this.$set({cropEnableRotateMatchImageAspectRatio});flush();}get cropEnableRotationInput(){return this.$$.ctx[84];}set cropEnableRotationInput(cropEnableRotationInput){this.$set({cropEnableRotationInput});flush();}get cropEnableZoom(){return this.$$.ctx[3];}set cropEnableZoom(cropEnableZoom){this.$set({cropEnableZoom});flush();}get cropEnableZoomInput(){return this.$$.ctx[85];}set cropEnableZoomInput(cropEnableZoomInput){this.$set({cropEnableZoomInput});flush();}get cropEnableImageSelection(){return this.$$.ctx[86];}set cropEnableImageSelection(cropEnableImageSelection){this.$set({cropEnableImageSelection});flush();}get cropEnableInfoIndicator(){return this.$$.ctx[87];}set cropEnableInfoIndicator(cropEnableInfoIndicator){this.$set({cropEnableInfoIndicator});flush();}get cropEnableZoomTowardsWheelPosition(){return this.$$.ctx[88];}set cropEnableZoomTowardsWheelPosition(cropEnableZoomTowardsWheelPosition){this.$set({cropEnableZoomTowardsWheelPosition});flush();}get cropEnableLimitWheelInputToCropSelection(){return this.$$.ctx[89];}set cropEnableLimitWheelInputToCropSelection(cropEnableLimitWheelInputToCropSelection){this.$set({cropEnableLimitWheelInputToCropSelection});flush();}get cropEnableCenterImageSelection(){return this.$$.ctx[90];}set cropEnableCenterImageSelection(cropEnableCenterImageSelection){this.$set({cropEnableCenterImageSelection});flush();}get cropEnableButtonRotateLeft(){return this.$$.ctx[91];}set cropEnableButtonRotateLeft(cropEnableButtonRotateLeft){this.$set({cropEnableButtonRotateLeft});flush();}get cropEnableButtonRotateRight(){return this.$$.ctx[92];}set cropEnableButtonRotateRight(cropEnableButtonRotateRight){this.$set({cropEnableButtonRotateRight});flush();}get cropEnableButtonFlipHorizontal(){return this.$$.ctx[93];}set cropEnableButtonFlipHorizontal(cropEnableButtonFlipHorizontal){this.$set({cropEnableButtonFlipHorizontal});flush();}get cropEnableButtonFlipVertical(){return this.$$.ctx[94];}set cropEnableButtonFlipVertical(cropEnableButtonFlipVertical){this.$set({cropEnableButtonFlipVertical});flush();}get cropSelectPresetOptions(){return this.$$.ctx[95];}set cropSelectPresetOptions(cropSelectPresetOptions){this.$set({cropSelectPresetOptions});flush();}get cropEnableSelectPreset(){return this.$$.ctx[96];}set cropEnableSelectPreset(cropEnableSelectPreset){this.$set({cropEnableSelectPreset});flush();}get cropEnableButtonToggleCropLimit(){return this.$$.ctx[97];}set cropEnableButtonToggleCropLimit(cropEnableButtonToggleCropLimit){this.$set({cropEnableButtonToggleCropLimit});flush();}get locale(){return this.$$.ctx[4];}set locale(locale){this.$set({locale});flush();}get tools(){return this.$$.ctx[0];}set tools(tools){this.$set({tools});flush();}}// @ts-ignore\nvar index={util:['crop',Crop]};/* src/core/ui/plugins/filter/index.svelte generated by Svelte v3.29.4 */function create_option_slot$2(ctx){let div0;let div1;let measurable_action;let option=/*option*/ctx[61];let t0;let span;let t1_value=(isFunction(/*option*/ctx[61].label)?/*option*/ctx[61].label(/*locale*/ctx[2]):/*option*/ctx[61].label)+\"\";let t1;let mounted;let dispose;function measure_handler_1(...args){return(/*measure_handler_1*/ctx[29](/*option*/ctx[61],...args));}const assign_div1=()=>/*div1_binding*/ctx[30](div1,option);const unassign_div1=()=>/*div1_binding*/ctx[30](null,option);return{c(){div0=element(\"div\");div1=element(\"div\");t0=space();span=element(\"span\");t1=text(t1_value);attr(div1,\"class\",FILTER_PREVIEW_CLASS_NAME);attr(div0,\"slot\",\"option\");attr(div0,\"class\",\"DokaFilterOption\");},m(target,anchor){insert(target,div0,anchor);append(div0,div1);assign_div1();append(div0,t0);append(div0,span);append(span,t1);if(!mounted){dispose=[listen(div1,\"measure\",measure_handler_1),action_destroyer(measurable_action=measurable.call(null,div1))];mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;if(option!==/*option*/ctx[61]){unassign_div1();option=/*option*/ctx[61];assign_div1();}if(dirty[0]&/*locale*/4|dirty[1]&/*option*/1073741824&&t1_value!==(t1_value=(isFunction(/*option*/ctx[61].label)?/*option*/ctx[61].label(/*locale*/ctx[2]):/*option*/ctx[61].label)+\"\"))set_data(t1,t1_value);},d(detaching){if(detaching)detach(div0);unassign_div1();mounted=false;run_all(dispose);}};}// (459:8) <Scrollable              elasticity={elasticityMultiplier * scrollElasticity}              onscroll={offset => tileScrollOffset = offset}              bind:maskFeatherStartOpacity={tileLeftOpacity}             bind:maskFeatherEndOpacity={tileRightOpacity}             bind:maskFeatherSize={tileMargin}             on:measure={e => tileScrollContainerRect = e.detail}>\nfunction create_default_slot_1$5(ctx){let radiogroup;let current;radiogroup=new RadioGroup({props:{locale:/*locale*/ctx[2],layout:\"row\",options:/*filterOptions*/ctx[3],selectedIndex:/*selectedFilterIndex*/ctx[10],onchange:/*handleChangeFilter*/ctx[25],$$slots:{option:[create_option_slot$2,({option})=>({61:option}),({option})=>[0,option?1073741824:0]]},$$scope:{ctx}}});return{c(){create_component(radiogroup.$$.fragment);},m(target,anchor){mount_component(radiogroup,target,anchor);current=true;},p(ctx,dirty){const radiogroup_changes={};if(dirty[0]&/*locale*/4)radiogroup_changes.locale=/*locale*/ctx[2];if(dirty[0]&/*filterOptions*/8)radiogroup_changes.options=/*filterOptions*/ctx[3];if(dirty[0]&/*selectedFilterIndex*/1024)radiogroup_changes.selectedIndex=/*selectedFilterIndex*/ctx[10];if(dirty[0]&/*locale, tileElements*/20|dirty[1]&/*option*/1073741824|dirty[2]&/*$$scope*/1){radiogroup_changes.$$scope={dirty,ctx};}radiogroup.$set(radiogroup_changes);},i(local){if(current)return;transition_in(radiogroup.$$.fragment,local);current=true;},o(local){transition_out(radiogroup.$$.fragment,local);current=false;},d(detaching){destroy_component(radiogroup,detaching);}};}// (458:4) <div slot=\"footer\" style={footerStyle} on:transitionend={handleTransitionEnd}>\nfunction create_footer_slot$1(ctx){let div;let scrollable;let updating_maskFeatherStartOpacity;let updating_maskFeatherEndOpacity;let updating_maskFeatherSize;let current;let mounted;let dispose;function scrollable_maskFeatherStartOpacity_binding(value){/*scrollable_maskFeatherStartOpacity_binding*/ctx[32].call(null,value);}function scrollable_maskFeatherEndOpacity_binding(value){/*scrollable_maskFeatherEndOpacity_binding*/ctx[33].call(null,value);}function scrollable_maskFeatherSize_binding(value){/*scrollable_maskFeatherSize_binding*/ctx[34].call(null,value);}let scrollable_props={elasticity:/*elasticityMultiplier*/ctx[14]*/*scrollElasticity*/ctx[15],onscroll:/*func*/ctx[31],$$slots:{default:[create_default_slot_1$5]},$$scope:{ctx}};if(/*tileLeftOpacity*/ctx[5]!==void 0){scrollable_props.maskFeatherStartOpacity=/*tileLeftOpacity*/ctx[5];}if(/*tileRightOpacity*/ctx[6]!==void 0){scrollable_props.maskFeatherEndOpacity=/*tileRightOpacity*/ctx[6];}if(/*tileMargin*/ctx[7]!==void 0){scrollable_props.maskFeatherSize=/*tileMargin*/ctx[7];}scrollable=new Scrollable({props:scrollable_props});binding_callbacks.push(()=>bind(scrollable,\"maskFeatherStartOpacity\",scrollable_maskFeatherStartOpacity_binding));binding_callbacks.push(()=>bind(scrollable,\"maskFeatherEndOpacity\",scrollable_maskFeatherEndOpacity_binding));binding_callbacks.push(()=>bind(scrollable,\"maskFeatherSize\",scrollable_maskFeatherSize_binding));scrollable.$on(\"measure\",/*measure_handler_2*/ctx[35]);return{c(){div=element(\"div\");create_component(scrollable.$$.fragment);attr(div,\"slot\",\"footer\");attr(div,\"style\",/*footerStyle*/ctx[11]);},m(target,anchor){insert(target,div,anchor);mount_component(scrollable,div,null);current=true;if(!mounted){dispose=listen(div,\"transitionend\",/*handleTransitionEnd*/ctx[23]);mounted=true;}},p(ctx,dirty){const scrollable_changes={};if(dirty[0]&/*tileScrollOffset*/256)scrollable_changes.onscroll=/*func*/ctx[31];if(dirty[0]&/*locale, filterOptions, selectedFilterIndex, tileElements*/1052|dirty[2]&/*$$scope*/1){scrollable_changes.$$scope={dirty,ctx};}if(!updating_maskFeatherStartOpacity&&dirty[0]&/*tileLeftOpacity*/32){updating_maskFeatherStartOpacity=true;scrollable_changes.maskFeatherStartOpacity=/*tileLeftOpacity*/ctx[5];add_flush_callback(()=>updating_maskFeatherStartOpacity=false);}if(!updating_maskFeatherEndOpacity&&dirty[0]&/*tileRightOpacity*/64){updating_maskFeatherEndOpacity=true;scrollable_changes.maskFeatherEndOpacity=/*tileRightOpacity*/ctx[6];add_flush_callback(()=>updating_maskFeatherEndOpacity=false);}if(!updating_maskFeatherSize&&dirty[0]&/*tileMargin*/128){updating_maskFeatherSize=true;scrollable_changes.maskFeatherSize=/*tileMargin*/ctx[7];add_flush_callback(()=>updating_maskFeatherSize=false);}scrollable.$set(scrollable_changes);if(!current||dirty[0]&/*footerStyle*/2048){attr(div,\"style\",/*footerStyle*/ctx[11]);}},i(local){if(current)return;transition_in(scrollable.$$.fragment,local);current=true;},o(local){transition_out(scrollable.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(scrollable);mounted=false;dispose();}};}function create_fragment$s(ctx){let util;let current;util=new Util({props:{$$slots:{footer:[create_footer_slot$1]},$$scope:{ctx}}});util.$on(\"measure\",/*measure_handler*/ctx[36]);return{c(){create_component(util.$$.fragment);},m(target,anchor){mount_component(util,target,anchor);current=true;},p(ctx,dirty){const util_changes={};if(dirty[0]&/*footerStyle, tileScrollOffset, tileLeftOpacity, tileRightOpacity, tileMargin, tileScrollContainerRect, locale, filterOptions, selectedFilterIndex, tileElements*/4092|dirty[2]&/*$$scope*/1){util_changes.$$scope={dirty,ctx};}util.$set(util_changes);},i(local){if(current)return;transition_in(util.$$.fragment,local);current=true;},o(local){transition_out(util.$$.fragment,local);current=false;},d(detaching){destroy_component(util,detaching);}};}let FILTER_PREVIEW_CLASS_NAME=\"DokaFilterPreview\";function instance$s($$self,$$props,$$invalidate){let $imageColorMatrix;let $tileRects;let $canvasSize;let $imageTransforms;let $isActive,$$unsubscribe_isActive=noop$1,$$subscribe_isActive=()=>($$unsubscribe_isActive(),$$unsubscribe_isActive=subscribe(isActive,$$value=>$$invalidate(44,$isActive=$$value)),isActive);let $utilRect;let $stageRect;let $imageGamma;let $isActiveFraction,$$unsubscribe_isActiveFraction=noop$1,$$subscribe_isActiveFraction=()=>($$unsubscribe_isActiveFraction(),$$unsubscribe_isActiveFraction=subscribe(isActiveFraction,$$value=>$$invalidate(48,$isActiveFraction=$$value)),isActiveFraction);let $footerOffset;let $imageTiles;$$self.$$.on_destroy.push(()=>$$unsubscribe_isActive());$$self.$$.on_destroy.push(()=>$$unsubscribe_isActiveFraction());const name=\"filter\";let{isActive}=$$props;$$subscribe_isActive();let{isActiveFraction}=$$props;$$subscribe_isActiveFraction();let{stores}=$$props;let{locale}=$$props;let{filterFunctions}=$$props;let{filterOptions}=$$props;// connect filter choice to stores\nconst{history,imagePreviews,stageRect,utilRect,elasticityMultiplier,scrollElasticity,imageCropRect,imageSize,imageRotation,imageFlipX,imageFlipY,imageGamma,imageColorMatrix}=stores;component_subscribe($$self,stageRect,value=>$$invalidate(46,$stageRect=value));component_subscribe($$self,utilRect,value=>$$invalidate(45,$utilRect=value));component_subscribe($$self,imageGamma,value=>$$invalidate(47,$imageGamma=value));component_subscribe($$self,imageColorMatrix,value=>$$invalidate(40,$imageColorMatrix=value));const getFilterIndex=(imageColorMatrix,filterOptionsFlattened)=>{if(!imageColorMatrix||!imageColorMatrix[\"filter\"]||!filterOptionsFlattened)return 0;const filterColorMatrix=imageColorMatrix[\"filter\"];return filterOptionsFlattened.// get id and compare matrices\nfindIndex(([id])=>{if(!filterFunctions[id])return false;const matrix=filterFunctions[id]();return arrayEqual(matrix,filterColorMatrix);});};const tileRects=writable({});component_subscribe($$self,tileRects,value=>$$invalidate(41,$tileRects=value));const handleTileResize=(item,rect)=>set_store_value(tileRects,$tileRects[item.value]=rect,$tileRects);const canvasSize=derived(tileRects,$tileRects=>{if(!$tileRects[undefined])return;const tileRectFirst=$tileRects[undefined];if($canvasSize&&sizeEqual($canvasSize,tileRectFirst))return $canvasSize;return sizeClone(tileRectFirst);});component_subscribe($$self,canvasSize,value=>$$invalidate(42,$canvasSize=value));const imageTransforms=derived([isActive,canvasSize,imageCropRect,imageSize,imageRotation,imageFlipX,imageFlipY],([$isActive,$canvasSize,$imageCropRect,$imageSize,$imageRotation,$imageFlipX,$imageFlipY],set)=>{if(!$isActive||!$canvasSize||!$imageSize)return $imageTransforms;const imageRect=rectCreateFromSize($imageSize);const imageCenter=rectCenter(imageRect);// get base crop rect so we can correctly apply transforms\nconst cropRectBase=getBaseCropRect($imageSize,$imageCropRect,$imageRotation);const cropRectBaseCenter=rectCenter(cropRectBase);const imageTranslation=vectorSubtract(vectorClone(imageCenter),cropRectBaseCenter);const imageOrigin=vectorInvert(vectorClone(imageTranslation));// scalar\nconst imageScalar=Math.max($canvasSize.width/$imageCropRect.width,$canvasSize.height/$imageCropRect.height);// update preview transforms\nset({origin:imageOrigin,translation:imageTranslation,rotation:{x:$imageFlipY?Math.PI:0,y:$imageFlipX?Math.PI:0,z:$imageRotation},perspective:vectorCreateEmpty(),scale:imageScalar});});component_subscribe($$self,imageTransforms,value=>$$invalidate(43,$imageTransforms=value));const cloneImageTransforms=imageTransforms=>({origin:vectorClone(imageTransforms.origin),translation:vectorClone(imageTransforms.translation),rotation:_objectSpread({},imageTransforms.rotation),perspective:vectorClone(imageTransforms.perspective),scale:imageTransforms.scale});//\n// Footer\n//\nconst footerOffset=spring(0);component_subscribe($$self,footerOffset,value=>$$invalidate(49,$footerOffset=value));let tileCornerRadius;const tileElements={};const handleTransitionEnd=e=>{if(e.target.className!==FILTER_PREVIEW_CLASS_NAME)return;$$invalidate(37,tileCornerRadius=Object.keys(tileElements).reduce((prev,curr)=>{const element=tileElements[curr];const style=getComputedStyle(element);const corners=[\"top-left\",\"top-right\",\"bottom-left\",\"bottom-right\"].map(corner=>style.getPropertyValue(`border-${corner}-radius`)).map(unitToPixels).// this better aligns WebGL rounded corner with css rounded corner\nmap(v=>v*1.25);prev[curr]=corners;return prev;},{}));};let tileLeftOpacity;// set by Scrollable\nlet tileRightOpacity;// set by Scrollable\nlet tileMargin;// set by Scrollable\nlet tileScrollOffset={x:0,y:0};let tileScrollContainerRect;let tileWrapperOffset;const imageTiles=writable([]);component_subscribe($$self,imageTiles,value=>$$invalidate(50,$imageTiles=value));// clones an image tile for use in canvas\nconst cloneImageTile=tile=>{const clone=_objectSpread(_objectSpread({},tile),{},{offset:_objectSpread({},tile.offset),mask:_objectSpread({},tile.mask)});clone.opacity=$isActiveFraction;clone.offset.y+=$footerOffset;clone.mask.y+=$footerOffset;return clone;};const handleChangeFilter=({value})=>{set_store_value(imageColorMatrix,$imageColorMatrix=_objectSpread(_objectSpread({},$imageColorMatrix),{},{\"filter\":isFunction(filterFunctions[value])?filterFunctions[value]():undefined}),$imageColorMatrix);history.write();};const measure_handler_1=(option,e)=>handleTileResize(option,e.detail);function div1_binding($$value,option){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{tileElements[option.value]=$$value;$$invalidate(4,tileElements);});}const func=offset=>$$invalidate(8,tileScrollOffset=offset);function scrollable_maskFeatherStartOpacity_binding(value){tileLeftOpacity=value;$$invalidate(5,tileLeftOpacity);}function scrollable_maskFeatherEndOpacity_binding(value){tileRightOpacity=value;$$invalidate(6,tileRightOpacity);}function scrollable_maskFeatherSize_binding(value){tileMargin=value;$$invalidate(7,tileMargin);}const measure_handler_2=e=>$$invalidate(9,tileScrollContainerRect=e.detail);function measure_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"isActive\"in $$props)$$subscribe_isActive($$invalidate(0,isActive=$$props.isActive));if(\"isActiveFraction\"in $$props)$$subscribe_isActiveFraction($$invalidate(1,isActiveFraction=$$props.isActiveFraction));if(\"stores\"in $$props)$$invalidate(27,stores=$$props.stores);if(\"locale\"in $$props)$$invalidate(2,locale=$$props.locale);if(\"filterFunctions\"in $$props)$$invalidate(28,filterFunctions=$$props.filterFunctions);if(\"filterOptions\"in $$props)$$invalidate(3,filterOptions=$$props.filterOptions);};let filterOptionsFlattened;let selectedFilterIndex;let footerStyle;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*filterOptions*/8){$$invalidate(39,filterOptionsFlattened=flattenOptions(filterOptions));}if($$self.$$.dirty[1]&/*$imageColorMatrix, filterOptionsFlattened*/768){$$invalidate(10,selectedFilterIndex=getFilterIndex($imageColorMatrix,filterOptionsFlattened));}if($$self.$$.dirty[1]&/*$isActive*/8192){footerOffset.set($isActive?0:20);}if($$self.$$.dirty[1]&/*$isActive, $utilRect, $stageRect*/57344){if($isActive&&$utilRect&&$stageRect){const tileTopOffset=$stageRect.y+$stageRect.height+$utilRect.y;$$invalidate(38,tileWrapperOffset={x:$stageRect.x-$utilRect.x,y:tileTopOffset});}}if($$self.$$.dirty[0]&/*tileScrollOffset, tileScrollContainerRect, tileMargin, tileLeftOpacity, tileRightOpacity, filterFunctions*/268436448|$$self.$$.dirty[1]&/*$imageTransforms, tileWrapperOffset, tileCornerRadius, filterOptionsFlattened, $tileRects, $imageColorMatrix, $imageGamma*/71616){if($imageTransforms&&tileWrapperOffset&&tileScrollOffset&&tileScrollContainerRect&&tileCornerRadius){const boundsX=tileWrapperOffset.x+tileScrollContainerRect.x;const offsetX=boundsX+tileScrollOffset.x;const offsetY=tileWrapperOffset.y;const containerLeft=tileScrollContainerRect.x+tileWrapperOffset.x;const containerRight=containerLeft+tileScrollContainerRect.width;imageTiles.set(filterOptionsFlattened.map(([id],i)=>{const tileRect=$tileRects[id];// test if is outside of view\nconst tileLeft=tileScrollOffset.x+tileRect.x;const tileRight=tileLeft+tileRect.width;if(tileRight<0||tileLeft>tileScrollContainerRect.width)return false;const x=offsetX+tileRect.x;const y=offsetY+tileRect.y;const preview=cloneImageTransforms($imageTransforms);preview.offset=vectorCreate(tileRect.width*0.5+x,tileRect.height*0.5+y);let clipX=0;let clipWidth=0;preview.maskOpacity=1;preview.mask=rectCreate(x+clipX,y,tileRect.width+clipWidth,tileRect.height);preview.maskFeather=[1,0,1,0,1,containerRight,1,containerRight];if(tileLeft<tileMargin&&tileLeftOpacity<1){preview.maskFeather[0]=tileLeftOpacity;preview.maskFeather[1]=containerLeft;preview.maskFeather[2]=1;preview.maskFeather[3]=containerLeft+tileMargin;}if(tileRight>tileScrollContainerRect.width-tileMargin&&tileRightOpacity<1){preview.maskFeather[4]=tileRightOpacity;preview.maskFeather[5]=containerRight-tileMargin;preview.maskFeather[6]=1;preview.maskFeather[7]=containerRight;}preview.maskCornerRadius=tileCornerRadius[id];let colorMatrices=$imageColorMatrix&&Object.keys($imageColorMatrix).filter(name=>name!=\"filter\").map(name=>$imageColorMatrix[name])||[];if(isFunction(filterFunctions[id])){colorMatrices.push(filterFunctions[id]());}preview.colorMatrix=colorMatrices.length?getColorMatrixFromColorMatrices(colorMatrices):undefined;preview.gamma=$imageGamma;return preview;}).filter(Boolean));}}if($$self.$$.dirty[1]&/*$isActive, $imageTiles, $footerOffset, $isActiveFraction*/925696){// Will update `imagePreviews` store when\n// - $isActiveFraction is updated\n// - $imageTiles is updated\n// - $footerOffset is updated\nif($isActive&&$imageTiles){// clone tiles\nimagePreviews.set($imageTiles.map(cloneImageTile));}else{imagePreviews.set([]);}}if($$self.$$.dirty[1]&/*$footerOffset*/262144){$$invalidate(11,footerStyle=$footerOffset?`transform: translateY(${$footerOffset}px)`:undefined);}};return[isActive,isActiveFraction,locale,filterOptions,tileElements,tileLeftOpacity,tileRightOpacity,tileMargin,tileScrollOffset,tileScrollContainerRect,selectedFilterIndex,footerStyle,stageRect,utilRect,elasticityMultiplier,scrollElasticity,imageGamma,imageColorMatrix,tileRects,handleTileResize,canvasSize,imageTransforms,footerOffset,handleTransitionEnd,imageTiles,handleChangeFilter,name,stores,filterFunctions,measure_handler_1,div1_binding,func,scrollable_maskFeatherStartOpacity_binding,scrollable_maskFeatherEndOpacity_binding,scrollable_maskFeatherSize_binding,measure_handler_2,measure_handler];}class Filter extends SvelteComponent{constructor(options){super();init(this,options,instance$s,create_fragment$s,safe_not_equal,{name:26,isActive:0,isActiveFraction:1,stores:27,locale:2,filterFunctions:28,filterOptions:3},[-1,-1,-1]);}get name(){return this.$$.ctx[26];}get isActive(){return this.$$.ctx[0];}set isActive(isActive){this.$set({isActive});flush();}get isActiveFraction(){return this.$$.ctx[1];}set isActiveFraction(isActiveFraction){this.$set({isActiveFraction});flush();}get stores(){return this.$$.ctx[27];}set stores(stores){this.$set({stores});flush();}get locale(){return this.$$.ctx[2];}set locale(locale){this.$set({locale});flush();}get filterFunctions(){return this.$$.ctx[28];}set filterFunctions(filterFunctions){this.$set({filterFunctions});flush();}get filterOptions(){return this.$$.ctx[3];}set filterOptions(filterOptions){this.$set({filterOptions});flush();}}// @ts-ignore\nvar index$1={util:['filter',Filter]};/* src/core/ui/plugins/finetune/index.svelte generated by Svelte v3.29.4 */function create_default_slot_3$4(ctx){let span;let t_value=/*tab*/ctx[35].label+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty[1]&/*tab*/16&&t_value!==(t_value=/*tab*/ctx[35].label+\"\"))set_data(t,t_value);},d(detaching){if(detaching)detach(span);}};}// (152:8) <Scrollable elasticity={elasticityMultiplier * scrollElasticity} class=\"DokaControlListScroller\">\nfunction create_default_slot_2$4(ctx){let tablist;let current;const tablist_spread_levels=[{class:\"DokaControlList\"},{tabs:/*tabs*/ctx[1]},/*tabsConfig*/ctx[3]];let tablist_props={$$slots:{default:[create_default_slot_3$4,({tab})=>({35:tab}),({tab})=>[0,tab?16:0]]},$$scope:{ctx}};for(let i=0;i<tablist_spread_levels.length;i+=1){tablist_props=assign(tablist_props,tablist_spread_levels[i]);}tablist=new TabList({props:tablist_props});tablist.$on(\"select\",/*select_handler*/ctx[17]);return{c(){create_component(tablist.$$.fragment);},m(target,anchor){mount_component(tablist,target,anchor);current=true;},p(ctx,dirty){const tablist_changes=dirty[0]&/*tabs, tabsConfig*/10?get_spread_update(tablist_spread_levels,[tablist_spread_levels[0],dirty[0]&/*tabs*/2&&{tabs:/*tabs*/ctx[1]},dirty[0]&/*tabsConfig*/8&&get_spread_object(/*tabsConfig*/ctx[3])]):{};if(dirty[1]&/*$$scope, tab*/48){tablist_changes.$$scope={dirty,ctx};}tablist.$set(tablist_changes);},i(local){if(current)return;transition_in(tablist.$$.fragment,local);current=true;},o(local){transition_out(tablist.$$.fragment,local);current=false;},d(detaching){destroy_component(tablist,detaching);}};}// (158:8) <TabPanels class=\"DokaControlPanels\" panelClass=\"DokaControlPanel\" {panels} {...tabsConfig} let:panel>\nfunction create_default_slot_1$6(ctx){let rangeinput;let current;const rangeinput_spread_levels=[/*$rangeInputConfig*/ctx[5][/*panel*/ctx[34]]];let rangeinput_props={};for(let i=0;i<rangeinput_spread_levels.length;i+=1){rangeinput_props=assign(rangeinput_props,rangeinput_spread_levels[i]);}rangeinput=new RangeInput({props:rangeinput_props});return{c(){create_component(rangeinput.$$.fragment);},m(target,anchor){mount_component(rangeinput,target,anchor);current=true;},p(ctx,dirty){const rangeinput_changes=dirty[0]&/*$rangeInputConfig*/32|dirty[1]&/*panel*/8?get_spread_update(rangeinput_spread_levels,[get_spread_object(/*$rangeInputConfig*/ctx[5][/*panel*/ctx[34]])]):{};rangeinput.$set(rangeinput_changes);},i(local){if(current)return;transition_in(rangeinput.$$.fragment,local);current=true;},o(local){transition_out(rangeinput.$$.fragment,local);current=false;},d(detaching){destroy_component(rangeinput,detaching);}};}// (150:4) <div slot=\"footer\" style={footerStyle}>\nfunction create_footer_slot$2(ctx){let div;let scrollable;let t;let tabpanels;let current;scrollable=new Scrollable({props:{elasticity:/*elasticityMultiplier*/ctx[8]*/*scrollElasticity*/ctx[7],class:\"DokaControlListScroller\",$$slots:{default:[create_default_slot_2$4]},$$scope:{ctx}}});const tabpanels_spread_levels=[{class:\"DokaControlPanels\"},{panelClass:\"DokaControlPanel\"},{panels:/*panels*/ctx[4]},/*tabsConfig*/ctx[3]];let tabpanels_props={$$slots:{default:[create_default_slot_1$6,({panel})=>({34:panel}),({panel})=>[0,panel?8:0]]},$$scope:{ctx}};for(let i=0;i<tabpanels_spread_levels.length;i+=1){tabpanels_props=assign(tabpanels_props,tabpanels_spread_levels[i]);}tabpanels=new TabPanels({props:tabpanels_props});return{c(){div=element(\"div\");create_component(scrollable.$$.fragment);t=space();create_component(tabpanels.$$.fragment);attr(div,\"slot\",\"footer\");attr(div,\"style\",/*footerStyle*/ctx[6]);},m(target,anchor){insert(target,div,anchor);mount_component(scrollable,div,null);append(div,t);mount_component(tabpanels,div,null);current=true;},p(ctx,dirty){const scrollable_changes={};if(dirty[0]&/*tabs, tabsConfig, tabSelected*/14|dirty[1]&/*$$scope*/32){scrollable_changes.$$scope={dirty,ctx};}scrollable.$set(scrollable_changes);const tabpanels_changes=dirty[0]&/*panels, tabsConfig*/24?get_spread_update(tabpanels_spread_levels,[tabpanels_spread_levels[0],tabpanels_spread_levels[1],dirty[0]&/*panels*/16&&{panels:/*panels*/ctx[4]},dirty[0]&/*tabsConfig*/8&&get_spread_object(/*tabsConfig*/ctx[3])]):{};if(dirty[0]&/*$rangeInputConfig*/32|dirty[1]&/*$$scope, panel*/40){tabpanels_changes.$$scope={dirty,ctx};}tabpanels.$set(tabpanels_changes);if(!current||dirty[0]&/*footerStyle*/64){attr(div,\"style\",/*footerStyle*/ctx[6]);}},i(local){if(current)return;transition_in(scrollable.$$.fragment,local);transition_in(tabpanels.$$.fragment,local);current=true;},o(local){transition_out(scrollable.$$.fragment,local);transition_out(tabpanels.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(scrollable);destroy_component(tabpanels);}};}function create_fragment$t(ctx){let util;let current;util=new Util({props:{$$slots:{footer:[create_footer_slot$2]},$$scope:{ctx}}});util.$on(\"measure\",/*measure_handler*/ctx[18]);return{c(){create_component(util.$$.fragment);},m(target,anchor){mount_component(util,target,anchor);current=true;},p(ctx,dirty){const util_changes={};if(dirty[0]&/*footerStyle, panels, tabsConfig, $rangeInputConfig, tabs, tabSelected*/126|dirty[1]&/*$$scope*/32){util_changes.$$scope={dirty,ctx};}util.$set(util_changes);},i(local){if(current)return;transition_in(util.$$.fragment,local);current=true;},o(local){transition_out(util.$$.fragment,local);current=false;},d(detaching){destroy_component(util,detaching);}};}function instance$t($$self,$$props,$$invalidate){let $rangeInputConfig;let $panelValues;let $isActive,$$unsubscribe_isActive=noop$1,$$subscribe_isActive=()=>($$unsubscribe_isActive(),$$unsubscribe_isActive=subscribe(isActive,$$value=>$$invalidate(21,$isActive=$$value)),isActive);let $footerOffset;$$self.$$.on_destroy.push(()=>$$unsubscribe_isActive());const name=\"finetune\";let{stores}=$$props;let{isActive}=$$props;$$subscribe_isActive();let{locale={}}=$$props;let{finetuneControlConfiguration}=$$props;let{finetuneOptions}=$$props;const{history,scrollElasticity,elasticityMultiplier,rangeInputElasticity,imageColorMatrix,imageConvolutionMatrix,imageGamma,imageVignette,imageNoise}=stores;const imageEffectStores={imageColorMatrix,imageConvolutionMatrix,imageGamma,imageVignette,imageNoise};//\n// Tabs\n//\nconst uid=`doka-finetune-${getUniqueId()}`;//\n// Range inputs\n//\nconst panelValues=writable({});component_subscribe($$self,panelValues,value=>$$invalidate(20,$panelValues=value));const rangeInputConfig=writable({});component_subscribe($$self,rangeInputConfig,value=>$$invalidate(5,$rangeInputConfig=value));const updateRangeInputState=()=>{set_store_value(rangeInputConfig,$rangeInputConfig=Object.keys($panelValues).reduce((config,id)=>{const{base,min,max,getLabel,getStore,setValue=(store,v)=>store.set(v)}=finetuneControlConfiguration[id];const store=getStore(imageEffectStores);const value=$panelValues[id]!=null?$panelValues[id]:base;config[id]={base,min,max,value,valueLabel:getLabel?getLabel(value,min,max,max-min):Math.round(100*value),oninputmove:v=>{setValue(store,v);},oninputend:v=>{setValue(store,v);history.write();},elasticity:elasticityMultiplier*rangeInputElasticity,labelReset:locale.labelReset};return config;},{}),$rangeInputConfig);};// need to unsubscribe when redrawing vie\nlet unsubs=[];const subscribePanelStores=config=>{if(unsubs)unsubs.forEach(unsub=>unsub());unsubs=panels.map(id=>{const{getStore,getValue=passthrough}=config[id];const store=getStore(imageEffectStores);return store.subscribe(value=>{const currentValue=value!=null?getValue(value):value;set_store_value(panelValues,$panelValues=_objectSpread(_objectSpread({},$panelValues),{},{[id]:currentValue}),$panelValues);});});};//\n// Footer\n//\nconst footerOffset=spring(0);component_subscribe($$self,footerOffset,value=>$$invalidate(22,$footerOffset=value));const select_handler=({detail})=>$$invalidate(2,tabSelected=detail);function measure_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"stores\"in $$props)$$invalidate(13,stores=$$props.stores);if(\"isActive\"in $$props)$$subscribe_isActive($$invalidate(0,isActive=$$props.isActive));if(\"locale\"in $$props)$$invalidate(14,locale=$$props.locale);if(\"finetuneControlConfiguration\"in $$props)$$invalidate(15,finetuneControlConfiguration=$$props.finetuneControlConfiguration);if(\"finetuneOptions\"in $$props)$$invalidate(16,finetuneOptions=$$props.finetuneOptions);};let tabs;let tabSelected;let tabsConfig;let panels;let footerStyle;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*finetuneOptions, locale*/81920){$$invalidate(1,tabs=finetuneOptions?finetuneOptions.map(([id,label])=>({id,label:isFunction(label)?label(locale):label})):[]);}if($$self.$$.dirty[0]&/*tabs*/2){$$invalidate(2,tabSelected=tabs.length&&tabs[0].id);}if($$self.$$.dirty[0]&/*tabSelected*/4){$$invalidate(3,tabsConfig={name:uid,selected:tabSelected});}if($$self.$$.dirty[0]&/*tabs*/2){$$invalidate(4,panels=tabs.map(tab=>tab.id));}if($$self.$$.dirty[0]&/*finetuneControlConfiguration*/32768){finetuneControlConfiguration&&subscribePanelStores(finetuneControlConfiguration);}if($$self.$$.dirty[0]&/*finetuneControlConfiguration, $panelValues*/1081344){finetuneControlConfiguration&&$panelValues&&updateRangeInputState();}if($$self.$$.dirty[0]&/*$isActive*/2097152){footerOffset.set($isActive?0:20);}if($$self.$$.dirty[0]&/*$footerOffset*/4194304){$$invalidate(6,footerStyle=$footerOffset?`transform: translateY(${$footerOffset}px)`:undefined);}};return[isActive,tabs,tabSelected,tabsConfig,panels,$rangeInputConfig,footerStyle,scrollElasticity,elasticityMultiplier,panelValues,rangeInputConfig,footerOffset,name,stores,locale,finetuneControlConfiguration,finetuneOptions,select_handler,measure_handler];}class Finetune extends SvelteComponent{constructor(options){super();init(this,options,instance$t,create_fragment$t,safe_not_equal,{name:12,stores:13,isActive:0,locale:14,finetuneControlConfiguration:15,finetuneOptions:16},[-1,-1]);}get name(){return this.$$.ctx[12];}get stores(){return this.$$.ctx[13];}set stores(stores){this.$set({stores});flush();}get isActive(){return this.$$.ctx[0];}set isActive(isActive){this.$set({isActive});flush();}get locale(){return this.$$.ctx[14];}set locale(locale){this.$set({locale});flush();}get finetuneControlConfiguration(){return this.$$.ctx[15];}set finetuneControlConfiguration(finetuneControlConfiguration){this.$set({finetuneControlConfiguration});flush();}get finetuneOptions(){return this.$$.ctx[16];}set finetuneOptions(finetuneOptions){this.$set({finetuneOptions});flush();}}// @ts-ignore\nvar index$2={util:['finetune',Finetune]};/* src/core/ui/components/ShapeManipulator.svelte generated by Svelte v3.29.4 */function get_each_context$5(ctx,list,i){const child_ctx=ctx.slice();child_ctx[47]=list[i].key;child_ctx[48]=list[i].index;child_ctx[49]=list[i].translate;child_ctx[50]=list[i].scale;child_ctx[14]=list[i].rotate;child_ctx[51]=list[i].dir;child_ctx[52]=list[i].center;child_ctx[53]=list[i].type;return child_ctx;}// (304:0) {#if type ==='edge' && resizeAxis !== 'both'}\nfunction create_if_block_1$8(ctx){let div;let div_style_value;return{c(){div=element(\"div\");attr(div,\"class\",\"DokaShapeManipulator\");attr(div,\"data-control\",\"point\");attr(div,\"style\",div_style_value=`pointer-events:none;transform: translate3d(${/*center*/ctx[52].x}px, ${/*center*/ctx[52].y}px, 0) scale(${/*$selectionScale*/ctx[5]}, ${/*$selectionScale*/ctx[5]}); opacity: ${/*$selectionOpacity*/ctx[6]}`);},m(target,anchor){insert(target,div,anchor);},p(ctx,dirty){if(dirty[0]&/*resizeControls, $selectionScale, $selectionOpacity*/104&&div_style_value!==(div_style_value=`pointer-events:none;transform: translate3d(${/*center*/ctx[52].x}px, ${/*center*/ctx[52].y}px, 0) scale(${/*$selectionScale*/ctx[5]}, ${/*$selectionScale*/ctx[5]}); opacity: ${/*$selectionOpacity*/ctx[6]}`)){attr(div,\"style\",div_style_value);}},d(detaching){if(detaching)detach(div);}};}// (289:0) {#each resizeControls as { key, index, translate, scale, rotate, dir, center, type }\nfunction create_each_block$5(key_1,ctx){let div;let div_tabindex_value;let div_data_control_value;let div_style_value;let nudgeable_action;let interactable_action;let t;let if_block_anchor;let mounted;let dispose;function nudge_handler(...args){return(/*nudge_handler*/ctx[18](/*index*/ctx[48],...args));}let if_block=/*type*/ctx[53]===\"edge\"&&/*resizeAxis*/ctx[2]!==\"both\"&&create_if_block_1$8(ctx);return{key:key_1,first:null,c(){div=element(\"div\");t=space();if(if_block)if_block.c();if_block_anchor=empty();attr(div,\"role\",\"button\");attr(div,\"tabindex\",div_tabindex_value=/*type*/ctx[53]===\"edge\"?-1:0);attr(div,\"class\",\"DokaShapeManipulator\");attr(div,\"data-control\",div_data_control_value=/*type*/ctx[53]);attr(div,\"style\",div_style_value=`cursor: ${/*dir*/ctx[51]?/*dir*/ctx[51]+\"-resize\":\"move\"}; transform: translate3d(${/*translate*/ctx[49].x}px, ${/*translate*/ctx[49].y}px, 0) rotate(${/*rotate*/ctx[14]}rad) scale(${/*type*/ctx[53]===\"point\"?/*$selectionScale*/ctx[5]:/*scale*/ctx[50].x}, ${/*type*/ctx[53]===\"point\"?/*$selectionScale*/ctx[5]:/*scale*/ctx[50].y}); opacity: ${/*$selectionOpacity*/ctx[6]}`);this.first=div;},m(target,anchor){insert(target,div,anchor);insert(target,t,anchor);if(if_block)if_block.m(target,anchor);insert(target,if_block_anchor,anchor);if(!mounted){dispose=[listen(div,\"keydown\",/*handleKeyDown*/ctx[7]),listen(div,\"keyup\",/*handleKeyUp*/ctx[8]),listen(div,\"nudge\",nudge_handler),action_destroyer(nudgeable_action=nudgeable.call(null,div)),listen(div,\"interactionstart\",function(){if(is_function(/*resize*/ctx[11](\"start\",/*index*/ctx[48])))/*resize*/ctx[11](\"start\",/*index*/ctx[48]).apply(this,arguments);}),listen(div,\"interactionupdate\",function(){if(is_function(/*resize*/ctx[11](\"move\",/*index*/ctx[48])))/*resize*/ctx[11](\"move\",/*index*/ctx[48]).apply(this,arguments);}),listen(div,\"interactionend\",function(){if(is_function(/*resize*/ctx[11](\"end\",/*index*/ctx[48])))/*resize*/ctx[11](\"end\",/*index*/ctx[48]).apply(this,arguments);}),action_destroyer(interactable_action=interactable.call(null,div))];mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;if(dirty[0]&/*resizeControls*/8&&div_tabindex_value!==(div_tabindex_value=/*type*/ctx[53]===\"edge\"?-1:0)){attr(div,\"tabindex\",div_tabindex_value);}if(dirty[0]&/*resizeControls*/8&&div_data_control_value!==(div_data_control_value=/*type*/ctx[53])){attr(div,\"data-control\",div_data_control_value);}if(dirty[0]&/*resizeControls, $selectionScale, $selectionOpacity*/104&&div_style_value!==(div_style_value=`cursor: ${/*dir*/ctx[51]?/*dir*/ctx[51]+\"-resize\":\"move\"}; transform: translate3d(${/*translate*/ctx[49].x}px, ${/*translate*/ctx[49].y}px, 0) rotate(${/*rotate*/ctx[14]}rad) scale(${/*type*/ctx[53]===\"point\"?/*$selectionScale*/ctx[5]:/*scale*/ctx[50].x}, ${/*type*/ctx[53]===\"point\"?/*$selectionScale*/ctx[5]:/*scale*/ctx[50].y}); opacity: ${/*$selectionOpacity*/ctx[6]}`)){attr(div,\"style\",div_style_value);}if(/*type*/ctx[53]===\"edge\"&&/*resizeAxis*/ctx[2]!==\"both\"){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block_1$8(ctx);if_block.c();if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){if_block.d(1);if_block=null;}},d(detaching){if(detaching)detach(div);if(detaching)detach(t);if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);mounted=false;run_all(dispose);}};}// (308:0) {#if enableRotating && rotationControlActive}\nfunction create_if_block$7(ctx){let div;let div_style_value;let nudgeable_action;let interactable_action;let mounted;let dispose;return{c(){div=element(\"div\");attr(div,\"role\",\"button\");attr(div,\"tabindex\",\"0\");attr(div,\"class\",\"DokaShapeManipulator\");attr(div,\"data-control\",\"rotate\");attr(div,\"style\",div_style_value=`transform: translate3d(${/*rotatorPoint*/ctx[0].x}px, ${/*rotatorPoint*/ctx[0].y}px, 0) scale(${/*$selectionScale*/ctx[5]}, ${/*$selectionScale*/ctx[5]}); opacity: ${/*$selectionOpacity*/ctx[6]}`);},m(target,anchor){insert(target,div,anchor);if(!mounted){dispose=[listen(div,\"keydown\",/*handleKeyDown*/ctx[7]),listen(div,\"keyup\",/*handleKeyUp*/ctx[8]),listen(div,\"nudge\",/*handleRotateNudge*/ctx[13]),action_destroyer(nudgeable_action=nudgeable.call(null,div)),listen(div,\"interactionstart\",/*rotate*/ctx[14](\"start\")),listen(div,\"interactionupdate\",/*rotate*/ctx[14](\"move\")),listen(div,\"interactionend\",/*rotate*/ctx[14](\"end\")),action_destroyer(interactable_action=interactable.call(null,div))];mounted=true;}},p(ctx,dirty){if(dirty[0]&/*rotatorPoint, $selectionScale, $selectionOpacity*/97&&div_style_value!==(div_style_value=`transform: translate3d(${/*rotatorPoint*/ctx[0].x}px, ${/*rotatorPoint*/ctx[0].y}px, 0) scale(${/*$selectionScale*/ctx[5]}, ${/*$selectionScale*/ctx[5]}); opacity: ${/*$selectionOpacity*/ctx[6]}`)){attr(div,\"style\",div_style_value);}},d(detaching){if(detaching)detach(div);mounted=false;run_all(dispose);}};}function create_fragment$u(ctx){let each_blocks=[];let each_1_lookup=new Map();let t;let if_block_anchor;let each_value=/*resizeControls*/ctx[3];const get_key=ctx=>/*key*/ctx[47];for(let i=0;i<each_value.length;i+=1){let child_ctx=get_each_context$5(ctx,each_value,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block$5(key,child_ctx));}let if_block=/*enableRotating*/ctx[1]&&/*rotationControlActive*/ctx[4]&&create_if_block$7(ctx);return{c(){for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}t=space();if(if_block)if_block.c();if_block_anchor=empty();},m(target,anchor){for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(target,anchor);}insert(target,t,anchor);if(if_block)if_block.m(target,anchor);insert(target,if_block_anchor,anchor);},p(ctx,dirty){if(dirty[0]&/*resizeControls, $selectionScale, $selectionOpacity, resizeAxis, handleKeyDown, handleKeyUp, handleResizeNudge, resize*/6636){const each_value=/*resizeControls*/ctx[3];each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,t.parentNode,destroy_block,create_each_block$5,t,get_each_context$5);}if(/*enableRotating*/ctx[1]&&/*rotationControlActive*/ctx[4]){if(if_block){if_block.p(ctx,dirty);}else{if_block=create_if_block$7(ctx);if_block.c();if_block.m(if_block_anchor.parentNode,if_block_anchor);}}else if(if_block){if_block.d(1);if_block=null;}},i:noop$1,o:noop$1,d(detaching){for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d(detaching);}if(detaching)detach(t);if(if_block)if_block.d(detaching);if(detaching)detach(if_block_anchor);}};}function instance$u($$self,$$props,$$invalidate){let $selectionScale;let $selectionOpacity;const dispatch=createEventDispatcher();// which cursor to render\nconst EIGTH_PI=QUART_PI*0.5;const N=HALF_PI;const N0=N-EIGTH_PI;const N1=N+EIGTH_PI;const S=-HALF_PI;const S0=S-EIGTH_PI;const S1=S+EIGTH_PI;const E=PI;const E0=E-EIGTH_PI;const E1=-PI+EIGTH_PI;const W0=EIGTH_PI;const W1=-EIGTH_PI;const NW=N-QUART_PI;const NW0=NW-EIGTH_PI;const NW1=NW+EIGTH_PI;const NE=PI-QUART_PI;const NE0=NE-EIGTH_PI;const NE1=NE+EIGTH_PI;const SE=S-QUART_PI;const SE0=SE+EIGTH_PI;const SE1=SE-EIGTH_PI;const SW=S+QUART_PI;const SW0=SW+EIGTH_PI;const SW1=SW-EIGTH_PI;let{points=[]}=$$props;let{rotatorPoint=undefined}=$$props;let{visible=false}=$$props;let{enableResizing=true}=$$props;let{enableRotating=true}=$$props;// // internal\nlet shiftKey=false;const handleKeyDown=e=>shiftKey=e.shiftKey;const handleKeyUp=e=>shiftKey=false;// state\nconst selectionScale=spring(0.5,{precision:0.0001,stiffness:0.3,damping:0.7});component_subscribe($$self,selectionScale,value=>$$invalidate(5,$selectionScale=value));const selectionOpacity=spring(0,{precision:0.001});component_subscribe($$self,selectionOpacity,value=>$$invalidate(6,$selectionOpacity=value));const rotate=type=>({detail})=>{// always make sure we have a translation to work with\nconst translation=detail&&detail.translation?detail.translation:vectorCreate(0,0);dispatch(`rotate${type}`,{translation,shiftKey});};const resize=(type,indexes)=>({detail})=>{// always make sure we have a translation to work with\nconst translation=detail&&detail.translation?detail.translation:vectorCreate(0,0);// done transforming the points\ndispatch(`resize${type}`,{indexes,translation,shiftKey});};// https://en.wikipedia.org/wiki/Radian#/media/File:Degree-Radian_Conversion.svg\nconst getDirectionByAngle=angle=>{let dir=\"\";const isNorth=angle<=N1&&angle>=N0;const isSouth=angle>=S0&&angle<=S1;const isEast=angle<=E1||angle>=E0;const isWest=angle>=W1&&angle<=W0;const isNorthEast=angle>=NE0&&angle<=NE1;const isNorthWest=angle>=NW0&&angle<=NW1;const isSouthEast=angle<=SE0&&angle>=SE1;const isSouthWest=angle<=SW0&&angle>=SW1;if(isNorth||isSouth)dir=\"ns\";if(isEast||isWest)dir=\"ew\";if(isNorthEast||isSouthWest)dir=\"nesw\";if(isNorthWest||isSouthEast)dir=\"nwse\";return dir;};// 2 points -> [corner, corner]\n// 3 points => [corner, edge, corner, edge, corner, edge],\n// 4 points => [corner, edge, corner, edge, corner, edge, corner, edge]\nconst mapPointsToControls=(points,axis)=>{let i=0;const center=vectorCenter(points);const out=[];const l=points.length;const isLine=l===2;const isAxisLimited=axis!==\"both\";for(;i<l;i++){const p0=points[i-1]||points[points.length-1];const p1=points[i];const p2=points[i+1]||points[0];const dir=Math.atan2(p2.y-p1.y,p2.x-p1.x);// create corner, only allowed if axis equal 'both'\nif(!isAxisLimited){const a=vectorNormalize(vectorCreate(p0.x-p1.x,p0.y-p1.y));const b=vectorNormalize(vectorCreate(p2.x-p1.x,p2.y-p1.y));const cornerVector=vectorCreate(a.x+b.x,a.y+b.y);out.push({index:[i],key:`point-${i}`,type:\"point\",scale:{x:1,y:1},translate:{x:p1.x,y:p1.y},angle:undefined,rotate:isLine?0:dir,center:p1,dir:isLine?undefined:getDirectionByAngle(Math.atan2(cornerVector.y,cornerVector.x))});}// if only two points, skip edge\nif(isLine)continue;const mid=vectorCreate(p1.x+(p2.x-p1.x)*0.5,p1.y+(p2.y-p1.y)*0.5);// only allow horizontal controls\nif(axis===\"horizontal\"&&i%2===0)continue;// only allow vertical controls\nif(axis===\"vertical\"&&i%2!==0)continue;// create edge\nout.push({index:[i,i+1===l?0:i+1],key:`edge-${i}`,type:\"edge\",scale:{x:vectorDistance(p1,p2),y:1},translate:{x:p1.x,y:p1.y},angle:dir,rotate:dir,center:mid,dir:getDirectionByAngle(Math.atan2(center.y-mid.y,center.x-mid.x))});}return out;};const handleResizeNudge=(indexes,translation)=>{dispatch(`resizestart`,{indexes,translation:vectorCreateEmpty()});dispatch(`resizemove`,{indexes,translation});dispatch(`resizeend`,{indexes,translation:vectorCreateEmpty()});};const handleRotateNudge=({detail})=>{dispatch(`rotatestart`,{translation:vectorCreateEmpty()});dispatch(`rotatemove`,{translation:detail});dispatch(`rotateend`,{translation:vectorCreateEmpty()});};const nudge_handler=(index,{detail})=>handleResizeNudge(index,detail);$$self.$$set=$$props=>{if(\"points\"in $$props)$$invalidate(15,points=$$props.points);if(\"rotatorPoint\"in $$props)$$invalidate(0,rotatorPoint=$$props.rotatorPoint);if(\"visible\"in $$props)$$invalidate(16,visible=$$props.visible);if(\"enableResizing\"in $$props)$$invalidate(17,enableResizing=$$props.enableResizing);if(\"enableRotating\"in $$props)$$invalidate(1,enableRotating=$$props.enableRotating);};let resizeAxis;let resizeControls;let rotationControlActive;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*visible*/65536){selectionScale.set(visible?1:0.5);}if($$self.$$.dirty[0]&/*visible*/65536){selectionOpacity.set(visible?1:0);}if($$self.$$.dirty[0]&/*enableResizing*/131072){$$invalidate(2,resizeAxis=!enableResizing?false:isString(enableResizing)?enableResizing:\"both\");}if($$self.$$.dirty[0]&/*resizeAxis, points*/32772){$$invalidate(3,resizeControls=resizeAxis&&mapPointsToControls(points,resizeAxis)||[]);}if($$self.$$.dirty[0]&/*points*/32768){$$invalidate(4,rotationControlActive=points.length>2);}};return[rotatorPoint,enableRotating,resizeAxis,resizeControls,rotationControlActive,$selectionScale,$selectionOpacity,handleKeyDown,handleKeyUp,selectionScale,selectionOpacity,resize,handleResizeNudge,handleRotateNudge,rotate,points,visible,enableResizing,nudge_handler];}class ShapeManipulator extends SvelteComponent{constructor(options){super();init(this,options,instance$u,create_fragment$u,safe_not_equal,{points:15,rotatorPoint:0,visible:16,enableResizing:17,enableRotating:1},[-1,-1]);}}var getEventPositionInEditor=(e,viewOffset)=>{const positionInViewport=getEventPositionInViewport(e);return vectorSubtract(positionInViewport,viewOffset);};var cursorMoveToEnd=field=>field.selectionStart=field.selectionEnd=field.value.length;let result$b=null;var supportsVisualViewport=()=>{if(result$b===null){result$b=isBrowser()&&'visualViewport'in window;}return result$b;};var createSoftKeyboardObserver=cb=>{if(!supportsVisualViewport())return false;const heightNormal=visualViewport.height;const testState=()=>{cb(visualViewport.height<heightNormal?'visible':'hidden');};visualViewport.addEventListener('resize',testState);return()=>visualViewport.removeEventListener('resize',testState);};/* src/core/ui/components/InputForm.svelte generated by Svelte v3.29.4 */function create_fragment$v(ctx){let div2;let div1;let button0;let t0;let div0;let t1;let button1;let measurable_action;let current;let mounted;let dispose;button0=new Button({props:{onclick:/*oncancel*/ctx[1],label:/*labelCancel*/ctx[5],icon:/*iconCancel*/ctx[7],hideLabel:!/*labelCancelShow*/ctx[6]}});const default_slot_template=/*#slots*/ctx[17].default;const default_slot=create_slot(default_slot_template,ctx,/*$$scope*/ctx[16],null);button1=new Button({props:{onclick:/*onconfirm*/ctx[0],label:/*labelConfirm*/ctx[2],icon:/*iconConfirm*/ctx[4],hideLabel:!/*labelConfirmShow*/ctx[3],class:\"DokaInputFormButtonConfirm\"}});return{c(){div2=element(\"div\");div1=element(\"div\");create_component(button0.$$.fragment);t0=space();div0=element(\"div\");if(default_slot)default_slot.c();t1=space();create_component(button1.$$.fragment);attr(div0,\"class\",\"DokaInputFormFields\");attr(div1,\"class\",\"DokaInputFormInner\");attr(div2,\"class\",\"DokaInputForm\");attr(div2,\"style\",/*style*/ctx[9]);},m(target,anchor){insert(target,div2,anchor);append(div2,div1);mount_component(button0,div1,null);append(div1,t0);append(div1,div0);if(default_slot){default_slot.m(div0,null);}append(div1,t1);mount_component(button1,div1,null);/*div2_binding*/ctx[18](div2);current=true;if(!mounted){dispose=[listen(div2,\"focusin\",/*handleFocusIn*/ctx[10]),listen(div2,\"focusout\",/*handleFocusOut*/ctx[11]),listen(div2,\"measure\",/*handleMeasure*/ctx[12]),action_destroyer(measurable_action=measurable.call(null,div2))];mounted=true;}},p(ctx,dirty){const button0_changes={};if(dirty[0]&/*oncancel*/2)button0_changes.onclick=/*oncancel*/ctx[1];if(dirty[0]&/*labelCancel*/32)button0_changes.label=/*labelCancel*/ctx[5];if(dirty[0]&/*iconCancel*/128)button0_changes.icon=/*iconCancel*/ctx[7];if(dirty[0]&/*labelCancelShow*/64)button0_changes.hideLabel=!/*labelCancelShow*/ctx[6];button0.$set(button0_changes);if(default_slot){if(default_slot.p&&dirty[0]&/*$$scope*/65536){update_slot(default_slot,default_slot_template,ctx,/*$$scope*/ctx[16],dirty,null,null);}}const button1_changes={};if(dirty[0]&/*onconfirm*/1)button1_changes.onclick=/*onconfirm*/ctx[0];if(dirty[0]&/*labelConfirm*/4)button1_changes.label=/*labelConfirm*/ctx[2];if(dirty[0]&/*iconConfirm*/16)button1_changes.icon=/*iconConfirm*/ctx[4];if(dirty[0]&/*labelConfirmShow*/8)button1_changes.hideLabel=!/*labelConfirmShow*/ctx[3];button1.$set(button1_changes);if(!current||dirty[0]&/*style*/512){attr(div2,\"style\",/*style*/ctx[9]);}},i(local){if(current)return;transition_in(button0.$$.fragment,local);transition_in(default_slot,local);transition_in(button1.$$.fragment,local);current=true;},o(local){transition_out(button0.$$.fragment,local);transition_out(default_slot,local);transition_out(button1.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div2);destroy_component(button0);if(default_slot)default_slot.d(detaching);destroy_component(button1);/*div2_binding*/ctx[18](null);mounted=false;run_all(dispose);}};}const panelDelay=200;function instance$v($$self,$$props,$$invalidate){let{$$slots:slots={},$$scope}=$$props;let{onconfirm}=$$props;let{oncancel}=$$props;let{autoFocus=true}=$$props;let{autoPositionCursor=true}=$$props;let{labelConfirm}=$$props;let{labelConfirmShow=true}=$$props;let{iconConfirm}=$$props;let{labelCancel}=$$props;let{labelCancelShow=false}=$$props;let{iconCancel}=$$props;let{panelOffset=vectorCreateEmpty()}=$$props;let panelVisible=false;let panelHeight=undefined;let panelRevealTimeout=undefined;let panelPosition=\"\";let panelOpacity=0;let root;const preventTextAreaScrollingOnIOS=element=>{// preventsDefault on textarea events when can no longer scroll up or down in textarea\nlet lastScreenY;const handleTouchStart=e=>lastScreenY=e.touches[0].screenY;const handleTouchMove=e=>{const currentScreenY=e.touches[0].screenY;const target=e.target;if(/textarea/i.test(target.nodeName)){// moving down\nif(currentScreenY>lastScreenY){if(target.scrollTop==0){e.preventDefault();}}else// moving up\nif(currentScreenY<lastScreenY){if(target.scrollTop+target.offsetHeight==target.scrollHeight){e.preventDefault();}}else{e.preventDefault();}lastScreenY=currentScreenY;}else{e.preventDefault();}};element.addEventListener(\"touchstart\",handleTouchStart);element.addEventListener(\"touchmove\",handleTouchMove);return()=>{element.removeEventListener(\"touchstart\",handleTouchStart);element.removeEventListener(\"touchmove\",handleTouchMove);};};const focus=()=>{const field=root.querySelector(\"input, textarea\");field.focus();};const show=()=>{panelVisible=true;// browser does not support keyboard listener, place modal at top of view\nif(!unsubSoftKeyboardListener&&(isIOS()||isAndroid())){$$invalidate(22,panelPosition=\"top:1em;bottom:auto;\");}// prevent interacting with the root element\nif(isIOS())preventTextAreaScrollingOnIOS(root);// reveal\n$$invalidate(23,panelOpacity=1);};const hide=()=>{panelVisible=false;$$invalidate(23,panelOpacity=0);};const handleSoftKeyboard=keyboardState=>{if(!shouldStickToKeyboard)return;// no need to continue, already hidden\nif(keyboardState===\"hidden\"&&!panelVisible){focus();return;}// gonna update position here\nclearTimeout(panelRevealTimeout);panelRevealTimeout=undefined;// position\n$$invalidate(22,panelPosition=`top:${visualViewport.height-panelHeight-panelOffset.y}px`);// if a soft keyboard is detected, turn into modal mode\nif(keyboardState===\"visible\"){// stick to keyboard\n$$invalidate(8,root.dataset.layout=\"stick\",root);// need to refocus\nfocus();// place above keyboard\nshow();}else// keyboard is hidden\n{hide();}};let focusDateTime;const handleFocusIn=e=>{// we need to remember focus time so we can detect unrealistic blur event caused by soft keyboard shenanigans\nfocusDateTime=Date.now();// move cursor\nif(autoPositionCursor)cursorMoveToEnd(e.target);// wait a couple milliseconds\npanelRevealTimeout=setTimeout(show,panelDelay);};const handleFocusOut=e=>{const focusDuration=Date.now()-focusDateTime;if(focusDuration>50)return;// unrealistic blur, refocus\ne.stopPropagation();focus();};const unsubSoftKeyboardListener=createSoftKeyboardObserver(handleSoftKeyboard);const handleMeasure=({detail})=>{panelHeight=detail.height;};onMount(()=>{if(!autoFocus)return;focus();});onDestroy(()=>{unsubSoftKeyboardListener&&unsubSoftKeyboardListener();});function div2_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{root=$$value;$$invalidate(8,root);});}$$self.$$set=$$props=>{if(\"onconfirm\"in $$props)$$invalidate(0,onconfirm=$$props.onconfirm);if(\"oncancel\"in $$props)$$invalidate(1,oncancel=$$props.oncancel);if(\"autoFocus\"in $$props)$$invalidate(13,autoFocus=$$props.autoFocus);if(\"autoPositionCursor\"in $$props)$$invalidate(14,autoPositionCursor=$$props.autoPositionCursor);if(\"labelConfirm\"in $$props)$$invalidate(2,labelConfirm=$$props.labelConfirm);if(\"labelConfirmShow\"in $$props)$$invalidate(3,labelConfirmShow=$$props.labelConfirmShow);if(\"iconConfirm\"in $$props)$$invalidate(4,iconConfirm=$$props.iconConfirm);if(\"labelCancel\"in $$props)$$invalidate(5,labelCancel=$$props.labelCancel);if(\"labelCancelShow\"in $$props)$$invalidate(6,labelCancelShow=$$props.labelCancelShow);if(\"iconCancel\"in $$props)$$invalidate(7,iconCancel=$$props.iconCancel);if(\"panelOffset\"in $$props)$$invalidate(15,panelOffset=$$props.panelOffset);if(\"$$scope\"in $$props)$$invalidate(16,$$scope=$$props.$$scope);};let computedStyle;let shouldStickToKeyboard;let style;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*root*/256){$$invalidate(25,computedStyle=root&&getComputedStyle(root));}if($$self.$$.dirty[0]&/*computedStyle*/33554432){shouldStickToKeyboard=computedStyle&&computedStyle.getPropertyValue(\"--editor-modal\")===\"1\";}if($$self.$$.dirty[0]&/*panelOpacity, panelPosition*/12582912){$$invalidate(9,style=`opacity:${panelOpacity};${panelPosition}`);}};return[onconfirm,oncancel,labelConfirm,labelConfirmShow,iconConfirm,labelCancel,labelCancelShow,iconCancel,root,style,handleFocusIn,handleFocusOut,handleMeasure,autoFocus,autoPositionCursor,panelOffset,$$scope,slots,div2_binding];}class InputForm extends SvelteComponent{constructor(options){super();init(this,options,instance$v,create_fragment$v,safe_not_equal,{onconfirm:0,oncancel:1,autoFocus:13,autoPositionCursor:14,labelConfirm:2,labelConfirmShow:3,iconConfirm:4,labelCancel:5,labelCancelShow:6,iconCancel:7,panelOffset:15},[-1,-1]);}}/* src/core/ui/components/ShapeLayoutEditor.svelte generated by Svelte v3.29.4 */function get_each_context$6(ctx,list,i){const child_ctx=ctx.slice();child_ctx[153]=list[i];child_ctx[155]=i;return child_ctx;}// (1887:8) {#each shapeNavList as item, index (item.id) }\nfunction create_each_block$6(key_1,ctx){let li;let button;let colorpreview;let t0;let span;let t1_value=/*item*/ctx[153].name+\"\";let t1;let button_aria_label_value;let t2;let current;let mounted;let dispose;colorpreview=new ColorPreview({props:{color:/*item*/ctx[153].color}});function click_handler(...args){return(/*click_handler*/ctx[94](/*index*/ctx[155],...args));}return{key:key_1,first:null,c(){li=element(\"li\");button=element(\"button\");create_component(colorpreview.$$.fragment);t0=space();span=element(\"span\");t1=text(t1_value);t2=space();attr(button,\"class\",\"DokaShapeListItem\");attr(button,\"type\",\"button\");attr(button,\"aria-label\",button_aria_label_value=\"Select shape \"+/*item*/ctx[153].name);this.first=li;},m(target,anchor){insert(target,li,anchor);append(li,button);mount_component(colorpreview,button,null);append(button,t0);append(button,span);append(span,t1);append(li,t2);current=true;if(!mounted){dispose=listen(button,\"click\",click_handler);mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;const colorpreview_changes={};if(dirty[0]&/*shapeNavList*/524288)colorpreview_changes.color=/*item*/ctx[153].color;colorpreview.$set(colorpreview_changes);if((!current||dirty[0]&/*shapeNavList*/524288)&&t1_value!==(t1_value=/*item*/ctx[153].name+\"\"))set_data(t1,t1_value);if(!current||dirty[0]&/*shapeNavList*/524288&&button_aria_label_value!==(button_aria_label_value=\"Select shape \"+/*item*/ctx[153].name)){attr(button,\"aria-label\",button_aria_label_value);}},i(local){if(current)return;transition_in(colorpreview.$$.fragment,local);current=true;},o(local){transition_out(colorpreview.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(li);destroy_component(colorpreview);mounted=false;dispose();}};}// (1898:4) {#if shouldRenderShapeManipulator}\nfunction create_if_block_2$6(ctx){let shapemanipulator;let current;shapemanipulator=new ShapeManipulator({props:{visible:true,points:/*shapeManipulatorPoints*/ctx[11],rotatorPoint:/*shapeManipulatorRotationPointPosition*/ctx[12],enableResizing:/*allowedResizeControls*/ctx[9],enableRotating:/*allowRotateControls*/ctx[8]}});shapemanipulator.$on(\"resizestart\",/*handleManipulatorResizeGrab*/ctx[26]);shapemanipulator.$on(\"resizemove\",/*handleManipulatorResizeDrag*/ctx[27]);shapemanipulator.$on(\"resizeend\",/*handleManipulatorResizeEnd*/ctx[28]);shapemanipulator.$on(\"rotatestart\",/*handleManipulatorRotateGrab*/ctx[29]);shapemanipulator.$on(\"rotatemove\",/*handleManipulatorRotateDrag*/ctx[30]);shapemanipulator.$on(\"rotateend\",/*handleManipulatorRotateEnd*/ctx[31]);return{c(){create_component(shapemanipulator.$$.fragment);},m(target,anchor){mount_component(shapemanipulator,target,anchor);current=true;},p(ctx,dirty){const shapemanipulator_changes={};if(dirty[0]&/*shapeManipulatorPoints*/2048)shapemanipulator_changes.points=/*shapeManipulatorPoints*/ctx[11];if(dirty[0]&/*shapeManipulatorRotationPointPosition*/4096)shapemanipulator_changes.rotatorPoint=/*shapeManipulatorRotationPointPosition*/ctx[12];if(dirty[0]&/*allowedResizeControls*/512)shapemanipulator_changes.enableResizing=/*allowedResizeControls*/ctx[9];if(dirty[0]&/*allowRotateControls*/256)shapemanipulator_changes.enableRotating=/*allowRotateControls*/ctx[8];shapemanipulator.$set(shapemanipulator_changes);},i(local){if(current)return;transition_in(shapemanipulator.$$.fragment,local);current=true;},o(local){transition_out(shapemanipulator.$$.fragment,local);current=false;},d(detaching){destroy_component(shapemanipulator,detaching);}};}// (1913:4) {#if shouldRenderTextInput}\nfunction create_if_block_1$9(ctx){let inputform;let current;inputform=new InputForm({props:{panelOffset:/*offset*/ctx[1],onconfirm:/*handleTextConfirm*/ctx[37],oncancel:/*handleTextCancel*/ctx[38],labelCancel:/*locale*/ctx[3].shapeLabelInputCancel,iconCancel:/*locale*/ctx[3].shapeIconInputCancel,labelConfirm:/*locale*/ctx[3].shapeLabelInputConfirm,iconConfirm:/*locale*/ctx[3].shapeIconInputConfirm,$$slots:{default:[create_default_slot$7]},$$scope:{ctx}}});return{c(){create_component(inputform.$$.fragment);},m(target,anchor){mount_component(inputform,target,anchor);current=true;},p(ctx,dirty){const inputform_changes={};if(dirty[0]&/*offset*/2)inputform_changes.panelOffset=/*offset*/ctx[1];if(dirty[0]&/*locale*/8)inputform_changes.labelCancel=/*locale*/ctx[3].shapeLabelInputCancel;if(dirty[0]&/*locale*/8)inputform_changes.iconCancel=/*locale*/ctx[3].shapeIconInputCancel;if(dirty[0]&/*locale*/8)inputform_changes.labelConfirm=/*locale*/ctx[3].shapeLabelInputConfirm;if(dirty[0]&/*locale*/8)inputform_changes.iconConfirm=/*locale*/ctx[3].shapeIconInputConfirm;if(dirty[0]&/*markupTextInputStyle, textInputText, textInput*/49184|dirty[5]&/*$$scope*/2){inputform_changes.$$scope={dirty,ctx};}inputform.$set(inputform_changes);},i(local){if(current)return;transition_in(inputform.$$.fragment,local);current=true;},o(local){transition_out(inputform.$$.fragment,local);current=false;},d(detaching){destroy_component(inputform,detaching);}};}// (1914:4) <InputForm          panelOffset={offset}         onconfirm={handleTextConfirm}          oncancel={handleTextCancel}         labelCancel={locale.shapeLabelInputCancel}         iconCancel={locale.shapeIconInputCancel}         labelConfirm={locale.shapeLabelInputConfirm}         iconConfirm={locale.shapeIconInputConfirm}>\nfunction create_default_slot$7(ctx){let textarea;let mounted;let dispose;return{c(){textarea=element(\"textarea\");attr(textarea,\"style\",/*markupTextInputStyle*/ctx[15]);attr(textarea,\"spellcheck\",\"false\");attr(textarea,\"autocorrect\",\"off\");attr(textarea,\"autocapitalize\",\"off\");textarea.value=/*textInputText*/ctx[14];},m(target,anchor){insert(target,textarea,anchor);/*textarea_binding*/ctx[95](textarea);if(!mounted){dispose=[listen(textarea,\"keydown\",/*handleTextInputKeyDown*/ctx[35]),listen(textarea,\"keypress\",/*handleTextInputAttempt*/ctx[34]),listen(textarea,\"keyup\",/*handleTextInputKeyUp*/ctx[36]),listen(textarea,\"input\",/*handleTextInput*/ctx[33])];mounted=true;}},p(ctx,dirty){if(dirty[0]&/*markupTextInputStyle*/32768){attr(textarea,\"style\",/*markupTextInputStyle*/ctx[15]);}if(dirty[0]&/*textInputText*/16384){textarea.value=/*textInputText*/ctx[14];}},d(detaching){if(detaching)detach(textarea);/*textarea_binding*/ctx[95](null);mounted=false;run_all(dispose);}};}// (1932:4) {#if $markupControlsOpacity > 0}\nfunction create_if_block$8(ctx){let div;let dynamiccomponenttree;let measurable_action;let current;let mounted;let dispose;dynamiccomponenttree=new DynamicComponentTree_1({props:{items:/*shapeControls*/ctx[18]}});return{c(){div=element(\"div\");create_component(dynamiccomponenttree.$$.fragment);attr(div,\"class\",\"DokaShapeControls\");attr(div,\"style\",/*markupControlsStyle*/ctx[16]);},m(target,anchor){insert(target,div,anchor);mount_component(dynamiccomponenttree,div,null);current=true;if(!mounted){dispose=[listen(div,\"measure\",/*measure_handler_1*/ctx[96]),action_destroyer(measurable_action=measurable.call(null,div))];mounted=true;}},p(ctx,dirty){const dynamiccomponenttree_changes={};if(dirty[0]&/*shapeControls*/262144)dynamiccomponenttree_changes.items=/*shapeControls*/ctx[18];dynamiccomponenttree.$set(dynamiccomponenttree_changes);if(!current||dirty[0]&/*markupControlsStyle*/65536){attr(div,\"style\",/*markupControlsStyle*/ctx[16]);}},i(local){if(current)return;transition_in(dynamiccomponenttree.$$.fragment,local);current=true;},o(local){transition_out(dynamiccomponenttree.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(dynamiccomponenttree);mounted=false;run_all(dispose);}};}function create_fragment$w(ctx){let div;let nav;let ul;let each_blocks=[];let each_1_lookup=new Map();let t0;let t1;let t2;let measurable_action;let nudgeable_action;let interactable_action;let current;let mounted;let dispose;let each_value=/*shapeNavList*/ctx[19];const get_key=ctx=>/*item*/ctx[153].id;for(let i=0;i<each_value.length;i+=1){let child_ctx=get_each_context$6(ctx,each_value,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block$6(key,child_ctx));}let if_block0=/*shouldRenderShapeManipulator*/ctx[10]&&create_if_block_2$6(ctx);let if_block1=/*shouldRenderTextInput*/ctx[13]&&create_if_block_1$9(ctx);let if_block2=/*$markupControlsOpacity*/ctx[17]>0&&create_if_block$8(ctx);return{c(){div=element(\"div\");nav=element(\"nav\");ul=element(\"ul\");for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}t0=space();if(if_block0)if_block0.c();t1=space();if(if_block1)if_block1.c();t2=space();if(if_block2)if_block2.c();attr(nav,\"class\",\"DokaShapeList\");attr(nav,\"data-visible\",/*showShapeList*/ctx[7]);attr(div,\"class\",\"DokaShapeEditor\");attr(div,\"tabindex\",\"0\");},m(target,anchor){insert(target,div,anchor);append(div,nav);append(nav,ul);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(ul,null);}append(div,t0);if(if_block0)if_block0.m(div,null);append(div,t1);if(if_block1)if_block1.m(div,null);append(div,t2);if(if_block2)if_block2.m(div,null);current=true;if(!mounted){dispose=[listen(nav,\"focusin\",/*handleFocusIn*/ctx[41]),listen(nav,\"focusout\",/*handleFocusOut*/ctx[42]),listen(div,\"keydown\",/*handleKey*/ctx[32]),listen(div,\"nudge\",/*handleNudge*/ctx[40]),listen(div,\"measure\",/*measure_handler*/ctx[93]),action_destroyer(measurable_action=measurable.call(null,div)),action_destroyer(nudgeable_action=nudgeable.call(null,div)),listen(div,\"wheel\",/*handleWheel*/ctx[21]),listen(div,\"interactionstart\",/*handleInteractionStart*/ctx[22]),listen(div,\"interactionupdate\",/*handleInteractionUpdate*/ctx[23]),listen(div,\"interactionrelease\",/*handleInteractionRelease*/ctx[24]),listen(div,\"interactionend\",/*handleInteractionEnd*/ctx[25]),action_destroyer(interactable_action=interactable.call(null,div,{drag:true,pinch:true,inertia:true,matchTarget:true,getEventPosition:/*interactable_function*/ctx[97]}))];mounted=true;}},p(ctx,dirty){if(dirty[0]&/*shapeNavList, selectShape, markup*/524305){const each_value=/*shapeNavList*/ctx[19];group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,ul,outro_and_destroy_block,create_each_block$6,null,get_each_context$6);check_outros();}if(!current||dirty[0]&/*showShapeList*/128){attr(nav,\"data-visible\",/*showShapeList*/ctx[7]);}if(/*shouldRenderShapeManipulator*/ctx[10]){if(if_block0){if_block0.p(ctx,dirty);if(dirty[0]&/*shouldRenderShapeManipulator*/1024){transition_in(if_block0,1);}}else{if_block0=create_if_block_2$6(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(div,t1);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(/*shouldRenderTextInput*/ctx[13]){if(if_block1){if_block1.p(ctx,dirty);if(dirty[0]&/*shouldRenderTextInput*/8192){transition_in(if_block1,1);}}else{if_block1=create_if_block_1$9(ctx);if_block1.c();transition_in(if_block1,1);if_block1.m(div,t2);}}else if(if_block1){group_outros();transition_out(if_block1,1,1,()=>{if_block1=null;});check_outros();}if(/*$markupControlsOpacity*/ctx[17]>0){if(if_block2){if_block2.p(ctx,dirty);if(dirty[0]&/*$markupControlsOpacity*/131072){transition_in(if_block2,1);}}else{if_block2=create_if_block$8(ctx);if_block2.c();transition_in(if_block2,1);if_block2.m(div,null);}}else if(if_block2){group_outros();transition_out(if_block2,1,1,()=>{if_block2=null;});check_outros();}if(interactable_action&&is_function(interactable_action.update)&&dirty[0]&/*rootRect*/4)interactable_action.update.call(null,{drag:true,pinch:true,inertia:true,matchTarget:true,getEventPosition:/*interactable_function*/ctx[97]});},i(local){if(current)return;for(let i=0;i<each_value.length;i+=1){transition_in(each_blocks[i]);}transition_in(if_block0);transition_in(if_block1);transition_in(if_block2);current=true;},o(local){for(let i=0;i<each_blocks.length;i+=1){transition_out(each_blocks[i]);}transition_out(if_block0);transition_out(if_block1);transition_out(if_block2);current=false;},d(detaching){if(detaching)detach(div);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d();}if(if_block0)if_block0.d();if(if_block1)if_block1.d();if(if_block2)if_block2.d();mounted=false;run_all(dispose);}};}const ROTATION_CONTROL_OFFSET=20;const MIN_TEXT_MARKUP_WIDTH=10;const shapeControlDist=16;function instance$w($$self,$$props,$$invalidate){let $keysPressedStored;let $markupControlsOpacity;let{markup}=$$props;let{offset}=$$props;let{rotation=0}=$$props;let{scale}=$$props;let{ui}=$$props;let{opacity=1}=$$props;let{parentRect}=$$props;let{rootRect}=$$props;let{stageRect}=$$props;let{utilRect}=$$props;let{oninteractionstart=noop}=$$props;let{oninteractionupdate=noop}=$$props;let{oninteractionrelease=noop}=$$props;let{oninteractionend=noop}=$$props;let{onaddshape=noop}=$$props;let{onupdateshape=noop}=$$props;let{onselectshape=noop}=$$props;let{onremoveshape=noop}=$$props;let{beforeSelectShape=()=>true}=$$props;let{beforeDeselectShape=()=>true}=$$props;let{beforeAddShape=()=>true}=$$props;// unused for now\nlet{beforeRemoveShape=()=>true}=$$props;let{beforeUpdateShape=(shape,props)=>props}=$$props;let{willRenderShapeControls=passthrough}=$$props;let{mapEditorPointToImagePoint}=$$props;let{mapImagePointToEditorPoint}=$$props;let{enableButtonFlipVertical=false}=$$props;let{locale}=$$props;//\n// Cache\n//\nconst updateShape=(shape,props,parentRect)=>{let propsToUpdate=beforeUpdateShape(_objectSpread({},shape),props,_objectSpread({},parentRect));shapeUpdateProps(shape,propsToUpdate,parentRect);};//\n// Helpers\n//\nconst isPositionInRect=(position,rect,rotation,pivot)=>{if(rotation)return!!polyPointIntersectionConvex(position,rectRotate(rect,rotation,pivot||rectCenter(rect)));const[t,r,b,l]=rectToBounds(rect);return position.x>=l&&position.x<=r&&position.y>=t&&position.y<=b;};const isPositionInEllipse=(position,ellipse,rotation)=>{const rx=ellipse.rx;const ry=ellipse.ry;const x=ellipse.x;const y=ellipse.y;const angle=rotation||0;const c=Math.cos(angle);const s=Math.sin(angle);const rx2=rx*rx;const ry2=ry*ry;const a=c*(position.x-x)+s*(position.y-y);const b=s*(position.x-x)-c*(position.y-y);const aa=a*a;const bb=b*b;return aa/rx2+bb/ry2<=1;};const isPositionNearLine=(position,begin,end,treshold)=>{const ba=Math.atan2(position.y-begin.y,position.x-begin.x);const ea=Math.atan2(position.y-end.y,position.x-end.x);if(ba>0&&ea>0||ba<0&&ea<0)return false;const r=treshold*treshold;const d=vectorCreate(end.x-begin.x,end.y-begin.y);const f=vectorCreate(begin.x-position.x,begin.y-position.y);const a=vectorDot(d,d);const b=2*vectorDot(f,d);const c=vectorDot(f,f)-r;const discriminant=b*b-4*a*c;return discriminant>=0;};//\n// Shape creator\n//\nconst keysPressedStored=getContext(\"keysPressed\");component_subscribe($$self,keysPressedStored,value=>$$invalidate(105,$keysPressedStored=value));const createShape=(shapeDefault,options={})=>{// state\nlet interactionOrigin;let interactionRadius;let interactionPosition;let isEllipse=shapeIsEllipse(shapeDefault);let isText=shapeIsText(shapeDefault);let isRelative=options.position===\"relative\";if(shapeIsPath(shapeDefault)){return{start:e=>{const{origin}=e.detail;interactionRadius=4;interactionOrigin=vectorClone(origin);interactionPosition=vectorClone(origin);const originPoint=mapEditorPointToImagePoint(origin);if(isRelative){originPoint.x=isRelative?toPercentage(originPoint.x,parentRect.width):originPoint.x;originPoint.y=isRelative?toPercentage(originPoint.y,parentRect.height):originPoint.y;}// add to markup so it's drawn\naddMarkupItemDraft(_objectSpread(_objectSpread({},shapeDefault),{},{points:[originPoint]}));},update:e=>{const draft=getMarkupItemDraft();const{translation}=e.detail;// position\nconst pointerPosition=vectorCreate(interactionOrigin.x+translation.x,interactionOrigin.y+translation.y);// distance between interaction and pointer if it's too close, we don't draw this point\nconst dist=vectorDistance(interactionPosition,pointerPosition);if(fixPrecision(dist,5)<=interactionRadius)return;// get angle between interaction and pointer\nconst angle=vectorAngleBetween(pointerPosition,interactionPosition);// move brush towards pointer at angle\nconst moveDist=interactionRadius-dist;interactionPosition.x+=moveDist*Math.cos(angle);interactionPosition.y+=moveDist*Math.sin(angle);// create point\nconst point=mapEditorPointToImagePoint(interactionPosition);if(point){point.x=isRelative?toPercentage(point.x,parentRect.width):point.x;point.y=isRelative?toPercentage(point.y,parentRect.height):point.y;}draft.points=draft.points.concat(point);syncShapes();},release:e=>e.detail.preventInertia(),end:e=>{const draft=getMarkupItemDraft();if(e.detail.isTap)return discardMarkupItemDraft();const shape=confirmMarkupItemDraft();onaddshape(shape);}};}else if(isEllipse||isText||shapeIsRect(shapeDefault)){return{start:e=>{const{origin}=e.detail;// need to remember origin so we can correctly apply interaction translation\ninteractionOrigin=vectorClone(origin);const mappedOriginPosition=mapEditorPointToImagePoint(interactionOrigin);// add to markup so it's drawn\nconst draft=_objectSpread(_objectSpread({},shapeDefault),{},{rotation:-rotation,x:isRelative?toPercentage(mappedOriginPosition.x,parentRect.width):mappedOriginPosition.x,y:isRelative?toPercentage(mappedOriginPosition.y,parentRect.height):mappedOriginPosition.y});// remove position\ndelete draft.position;// hide initially\ndraft.opacity=0;// \nif(isEllipse){draft.rx=isRelative?toPercentage(0):0;draft.ry=isRelative?toPercentage(0):0;}else{draft.width=isRelative?toPercentage(0):0;draft.height=isRelative?toPercentage(0):0;}addMarkupItemDraft(draft);},update:e=>{const draft=getMarkupItemDraft();draft.opacity=1;const{aspectRatio}=draft;let{translation}=e.detail;// limit to aspect ratio\nif(aspectRatio){const t=Math.abs(translation.x)*aspectRatio;translation.x=translation.x;translation.y=t*Math.sign(translation.y);}// position\nconst pointerPosition=vectorCreate(interactionOrigin.x+translation.x,interactionOrigin.y+translation.y);const mappedOriginPosition=mapEditorPointToImagePoint(interactionOrigin);const mappedPointerPosition=mapEditorPointToImagePoint(pointerPosition);const pivot={x:mappedOriginPosition.x+(mappedPointerPosition.x-mappedOriginPosition.x)*0.5,y:mappedOriginPosition.y+(mappedPointerPosition.y-mappedOriginPosition.y)*0.5};vectorRotate(mappedOriginPosition,rotation,pivot);vectorRotate(mappedPointerPosition,rotation,pivot);const l=Math.min(mappedOriginPosition.x,mappedPointerPosition.x);const t=Math.min(mappedOriginPosition.y,mappedPointerPosition.y);const r=Math.max(mappedOriginPosition.x,mappedPointerPosition.x);const b=Math.max(mappedOriginPosition.y,mappedPointerPosition.y);let width=r-l;let height=b-t;let props={};if(isEllipse){props.x=l+width*0.5;props.y=t+height*0.5;props.rx=width*0.5;props.ry=height*0.5;}else{props.x=l;props.y=t;props.width=width;props.height=height;}updateShape(draft,props,parentRect);// shapeUpdateProps(draft, props, parentRect);\nsyncShapes();},release:e=>{e.detail.preventInertia();},end:e=>{const draft=getMarkupItemDraft();if(e.detail.isTap)return discardMarkupItemDraft();draft.opacity=1;// finish markup\nif(!shapeIsText(draft)){const shape=confirmMarkupItemDraft();onaddshape(shape);}// select the draft\nselectShape(draft);// also enable editing the text\nif(shapeIsText(draft))editMarkupItem(draft);}};}else if(shapeIsLine(shapeDefault)){return{start:e=>{const{origin}=e.detail;const originMapped=mapEditorPointToImagePoint(origin);const originSnapped=vectorApply(originMapped,snapToPixel);interactionOrigin=vectorClone(origin);// add to markup so it's drawn\naddMarkupItemDraft(_objectSpread(_objectSpread({},shapeDefault),{},{x1:isRelative?toPercentage(originSnapped.x,parentRect.width):originSnapped.x,y1:isRelative?toPercentage(originSnapped.y,parentRect.height):originSnapped.y,x2:isRelative?toPercentage(originSnapped.x,parentRect.width):originSnapped.x,y2:isRelative?toPercentage(originSnapped.y,parentRect.height):originSnapped.y,opacity:0}));},update:e=>{const draft=getMarkupItemDraft();const{translation}=e.detail;const interactionTarget=vectorAdd(vectorClone(interactionOrigin),translation);// shift pressed\nif($keysPressedStored.includes(16)){const length=vectorDistance(interactionOrigin,interactionTarget);const angle=vectorAngleBetween(interactionOrigin,interactionTarget);const angleSnapInterval=Math.PI/4;const angleSnapped=angleSnapInterval*Math.round(angle/angleSnapInterval);interactionTarget.x=interactionOrigin.x+length*Math.cos(angleSnapped);interactionTarget.y=interactionOrigin.y+length*Math.sin(angleSnapped);}// update line end position\nconst point=mapEditorPointToImagePoint(interactionTarget);updateMarkupShape(draft,{x2:isRelative?toPercentage(point.x,parentRect.width):point.x,y2:isRelative?toPercentage(point.y,parentRect.height):point.y,opacity:1});syncShapes();},release:e=>e.detail.preventInertia(),end:e=>{const draft=getMarkupItemDraft();if(e.detail.isTap)return discardMarkupItemDraft();// get draft\ndraft.opacity=1;// finish markup\nconfirmMarkupItemDraft();// select the draft\nselectShape(draft);}};}};const eraseShape=()=>{let origin;let positionPrevious;return{start:e=>{origin=e.detail.origin;positionPrevious=origin;},update:e=>{const{translation}=e.detail;const positionCurrent=vectorCreate(origin.x+translation.x,origin.y+translation.y);const shapesFound=getMarkupBetweenPoints(mapEditorPointToImagePoint(positionPrevious),mapEditorPointToImagePoint(positionCurrent));const shapesRemoved=removeMarkupItems(shapesFound);shapesRemoved.forEach(onremoveshape);positionPrevious=vectorClone(positionCurrent);},release:e=>e.detail.preventInertia(),end:()=>{}};};//\n// Mapping coordinates\n//\nconst getImagePointWithScreenTranslation=(point,translation)=>{const pointInScreenSpace=mapImagePointToEditorPoint(point);return mapEditorPointToImagePoint(vectorAdd(pointInScreenSpace,translation));};//\n// Interaction\n//\n// image zoom\nconst handleWheel=e=>{};// TODO: ZOOM image\n// markup manipulate\nconst translateShape=(shapeCurrent,shapeOriginComputed,translation)=>{if(shapeIsLine(shapeCurrent)){const beginImageOffset=getImagePointWithScreenTranslation(shapeLineGetStartPoint(shapeOriginComputed),translation);const endImageOffset=getImagePointWithScreenTranslation(shapeLineGetEndPoint(shapeOriginComputed),translation);updateShape(shapeCurrent,{x1:beginImageOffset.x,y1:beginImageOffset.y,x2:endImageOffset.x,y2:endImageOffset.y},parentRect);}else if(shapeIsRect(shapeCurrent)||shapeIsText(shapeCurrent)||shapeIsEllipse(shapeCurrent)){const imagePoint=getImagePointWithScreenTranslation(shapeOriginComputed,translation);updateShape(shapeCurrent,imagePoint,parentRect);}syncShapes();};const resizeMarkup=(shapeCurrent,shapeOriginComputed,indexes,translation,options)=>{if(shapeIsLine(shapeCurrent)){const[targetIndex]=indexes;const snap=$keysPressedStored.includes(16)?(origin,target)=>{const length=vectorDistance(origin,target);const angle=vectorAngleBetween(origin,target);const angleSnapInterval=Math.PI/4;const angleSnapped=angleSnapInterval*Math.round(angle/angleSnapInterval)-rotation%angleSnapInterval;target.x=origin.x+length*Math.cos(angleSnapped);target.y=origin.y+length*Math.sin(angleSnapped);}:(origin,target)=>target;if(targetIndex===0){const point=getImagePointWithScreenTranslation(shapeLineGetStartPoint(shapeOriginComputed),translation);snap(vectorCreate(shapeOriginComputed.x2,shapeOriginComputed.y2),point);updateShape(shapeCurrent,{x1:point.x,y1:point.y},parentRect);}else if(targetIndex===1){const point=getImagePointWithScreenTranslation(shapeLineGetEndPoint(shapeOriginComputed),translation);snap(vectorCreate(shapeOriginComputed.x1,shapeOriginComputed.y1),point);updateShape(shapeCurrent,{x2:point.x,y2:point.y},parentRect);}}else if(shapeHasSize(shapeCurrent)||shapeIsEllipse(shapeCurrent)||shapeIsTextBox(shapeCurrent)){let hasAutoHeight=false;let shapeOriginRect;if(shapeIsEllipse(shapeCurrent)){shapeOriginRect=rectCreateFromEllipse(shapeOriginComputed);}else if(shapeHasSize(shapeCurrent)){shapeOriginRect=rectCreateFromAny(shapeOriginComputed);}else{// is text with 'width' only\nhasAutoHeight=true;shapeOriginRect=rectCreateFromAny(shapeOriginComputed);const size=textSize(shapeOriginComputed.text,shapeOriginComputed);shapeOriginRect.height=size.height;}let shapeAspectRatio;if(shapeCurrent.aspectRatio){shapeAspectRatio=shapeCurrent.aspectRatio;}else if(options.shiftKey&&!hasAutoHeight){shapeAspectRatio=shapeOriginRect.width/shapeOriginRect.height;}// current shape\nconst rectAligned=rectCreateFromAny(shapeOriginRect);const rectAlignedCenterPosition=rectCenter(rectAligned);const rectRotation=shapeCurrent.rotation;const rectAlignedCorners=rectGetCorners(rectAligned);const rectCorners=rectRotate(rectAligned,rectRotation);// is translating one corner\nif(indexes.length===1){// corner\nlet cornerIndex=indexes[0];const[tl,tr,br,bl]=rectAlignedCorners;const screenTargetPosition=mapImagePointToEditorPoint(rectCorners[cornerIndex]);vectorAdd(screenTargetPosition,translation);const imageTargetPosition=mapEditorPointToImagePoint(screenTargetPosition);const imageTargetTranslation=vectorCreate(imageTargetPosition.x-rectCorners[cornerIndex].x,imageTargetPosition.y-rectCorners[cornerIndex].y);if(shapeCurrent.flipX)imageTargetTranslation.x=-imageTargetTranslation.x;if(shapeCurrent.flipY)imageTargetTranslation.y=-imageTargetTranslation.y;const imageTargetTranslationAligned=vectorRotate(vectorClone(imageTargetTranslation),-rectRotation);const imageTargetPositionAligned=vectorCreate(rectAlignedCorners[cornerIndex].x+imageTargetTranslationAligned.x,rectAlignedCorners[cornerIndex].y+imageTargetTranslationAligned.y);let anchor;if(cornerIndex===0)anchor=br;if(cornerIndex===1)anchor=bl;if(cornerIndex===2)anchor=tl;if(cornerIndex===3)anchor=tr;// create an aligned and updated rectangle\nconst rectAlignedResized=rectCreateFromPoints(anchor,imageTargetPositionAligned);// limit rect\nif(shapeAspectRatio){// get size that adheres to aspect ratio but still fits current rectangle\nconst{width,height}=rectContainRect(rectAlignedResized,shapeAspectRatio);const[t,r,b,l]=rectToBounds(rectAlignedResized);// update size\nrectAlignedResized.width=width;rectAlignedResized.height=height;// align to anchor\nif(imageTargetPositionAligned.y<anchor.y){rectAlignedResized.y=b-height;}if(imageTargetPositionAligned.x<anchor.x){rectAlignedResized.x=r-width;}}// rotate the aligned rectangle around it's original pivot point\nconst rr=rectRotate(rectAlignedResized,rectRotation,rectAlignedCenterPosition);// now calculate the new center and then rotate the tl and br corners around that center to find their new positions\nconst rrc=vectorCenter(rr);const p1=vectorRotate(rr[0],-rectRotation,rrc);const p2=vectorRotate(rr[2],-rectRotation,rrc);if(shapeCurrent.flipX||shapeCurrent.flipY){vectorsFlip([p1,p2],shapeCurrent.flipX,shapeCurrent.flipY,rectAlignedCenterPosition.x,rectAlignedCenterPosition.y);}const rectUpdated=rectCreateFromPoints(p1,p2);updateShape(shapeCurrent,shapeIsEllipse(shapeCurrent)?ellipseCreateFromRect(rectUpdated):rectUpdated,parentRect);}else// is translating two corner points\n{// 0-1 -> 2-3\n// 1-2 -> 3-0\n// 2-3 -> 0-1\n// 3-0 -> 1-2\nconst[cornerA,cornerB]=indexes.map(index=>rectCorners[index]);const mid={x:cornerA.x+(cornerB.x-cornerA.x)*0.5,y:cornerA.y+(cornerB.y-cornerA.y)*0.5};const[cornerAlignedA,cornerAlignedB]=indexes.map(index=>rectAlignedCorners[index]);const[cornerAlignedC,cornerAlignedD]=indexes.map(index=>{const mappedIndex=index+2;if(mappedIndex<4)return rectAlignedCorners[mappedIndex];return rectAlignedCorners[mappedIndex-4];});const midAligned={x:cornerAlignedA.x+(cornerAlignedB.x-cornerAlignedA.x)*0.5,y:cornerAlignedA.y+(cornerAlignedB.y-cornerAlignedA.y)*0.5};const midAnchorAligned={x:cornerAlignedC.x+(cornerAlignedD.x-cornerAlignedC.x)*0.5,y:cornerAlignedC.y+(cornerAlignedD.y-cornerAlignedC.y)*0.5};const screenTargetPosition=mapImagePointToEditorPoint(mid);vectorAdd(screenTargetPosition,translation);const imageTargetPosition=mapEditorPointToImagePoint(screenTargetPosition);const imageTargetTranslation=vectorCreate(imageTargetPosition.x-mid.x,imageTargetPosition.y-mid.y);if(shapeCurrent.flipX)imageTargetTranslation.x=-imageTargetTranslation.x;if(shapeCurrent.flipY)imageTargetTranslation.y=-imageTargetTranslation.y;const imageTargetTranslationAligned=vectorRotate(vectorClone(imageTargetTranslation),-rectRotation);// const imageTargetPositionAligned = vectorCreate(\n//     midAligned.x + imageTargetTranslationAligned.x,\n//     midAligned.y + imageTargetTranslationAligned.y,\n// );\nconst d=vectorSubtract(vectorClone(cornerAlignedA),cornerAlignedB);const f=vectorApply(d,v=>1-Math.abs(Math.sign(v)));const t=vectorCreate(imageTargetTranslationAligned.x*f.x,imageTargetTranslationAligned.y*f.y);vectorAdd(cornerAlignedA,t);vectorAdd(cornerAlignedB,t);const rectAlignedResized=rectCreateFromPoints(rectAlignedCorners);// limit rect\nif(shapeAspectRatio){let width=rectAlignedResized.width;let height=rectAlignedResized.height;if(f.y===0){height=width/shapeAspectRatio;}else{width=height*shapeAspectRatio;}// update size\nrectAlignedResized.width=width;rectAlignedResized.height=height;// align to anchor\nif(f.y===0){rectAlignedResized.y=midAnchorAligned.y-height*0.5;}else{rectAlignedResized.x=midAnchorAligned.x-width*0.5;}}// rotate the aligned rectangle around it's original pivot point\nconst rr=rectRotate(rectAlignedResized,rectRotation,rectAlignedCenterPosition);// now calculate the new center and then rotate the tl and br corners around that center to find their new positions\nconst rrc=vectorCenter(rr);const p1=vectorRotate(rr[0],-rectRotation,rrc);const p2=vectorRotate(rr[2],-rectRotation,rrc);if(shapeCurrent.flipX||shapeCurrent.flipY){vectorsFlip([p1,p2],shapeCurrent.flipX,shapeCurrent.flipY,rectAlignedCenterPosition.x,rectAlignedCenterPosition.y);}const rectUpdated=rectCreateFromPoints(p1,p2);let props;if(shapeIsEllipse(shapeCurrent)){props=ellipseCreateFromRect(rectUpdated);}else if(shapeHasSize(shapeCurrent)){props=rectUpdated;}else if(hasAutoHeight){props={x:rectUpdated.x,y:rectUpdated.y,width:rectUpdated.width};}updateShape(shapeCurrent,props,parentRect);}}syncShapes();};let rotatorInitialPosition;const rotateMarkup=(shapeCurrent,shapeOriginComputed,translation,options)=>{// calculate angle between translated rotation control and origin\nconst shapeRect=getMarkupShapeRect(shapeComputeDisplay(shapeDeepCopy(shapeCurrent),parentRect));const shapeCenter=rectCenter(shapeRect);const p=getImagePointWithScreenTranslation(rotatorInitialPosition,translation);let shapeRotation=vectorAngleBetween(p,shapeCenter)+Math.PI/2;if(options.shiftKey){const rotatorSnapInterval=Math.PI/16;shapeRotation=rotatorSnapInterval*Math.round(shapeRotation/rotatorSnapInterval)-rotation%rotatorSnapInterval;}updateShape(shapeCurrent,{rotation:shapeRotation},parentRect);syncShapes();};const getMarkupItemDraft=()=>{if(!markup.length)return;const lastMarkupItem=markup[markup.length-1];return lastMarkupItem.isDraft?lastMarkupItem:undefined;};const addMarkupItemDraft=(shape,sync=true)=>{if(getMarkupItemDraft())return;shape=Object.assign(shape,{isDraft:true});return addShape(shape,sync);};const confirmMarkupItemDraft=()=>{const markupItem=getMarkupItemDraft();if(!markupItem)return;updateMarkupShapeProperty(markupItem,\"isDraft\",false);return markupItem;};const discardMarkupItemDraft=()=>{if(!getMarkupItemDraft())return;$$invalidate(0,markup=markup.slice(0,-1));};const createMarkupItem=(props={})=>_objectSpread({id:getUniqueId()},props);const syncShapes=()=>$$invalidate(0,markup);const addShape=(shape,sync=true)=>{markup.push(shape);// sync markup array\nif(sync)syncShapes();return shape;};const updateMarkupShape=(shape,props,sync=true)=>{// update markup\nshape=Object.assign(shape,props);// sync markup array\nif(!sync)return;syncShapes();};const updateMarkupShapeProperty=(shape,name,value,sync=true)=>{shape[name]=value;// sync markup array\nif(!sync)return;syncShapes();};const updateMarkupItemsShapeProperty=(name,value,sync=true)=>{markup.forEach(shape=>updateMarkupShapeProperty(shape,name,value,false));// sync markup array\nif(!sync)return;syncShapes();};const updateMarkupShapeItems=(props,sync=true)=>{markup.forEach(markupItem=>updateMarkupShape(markupItem,props,false));// sync markup array\nif(!sync)return;syncShapes();};const getActiveMarkupItem=()=>[...markup].reverse().find(shapeIsSelected);const hasActiveMarkupItem=()=>!!getActiveMarkupItem();const removeShape=(shapeToRemove,sync=true)=>{if(!beforeRemoveShape(shapeToRemove))return false;const markupWithoutShape=markup.filter(shape=>shape!==shapeToRemove);onremoveshape(shapeToRemove);if(!sync)return;$$invalidate(0,markup=markupWithoutShape);};const removeActiveMarkupItem=()=>{const activeShape=getActiveMarkupItem();if(!activeShape)return;// get removable markup items, \nconst removableShapes=markup.filter(shape=>shapeCanRemove(shape)&&shapeCanSelect(shape));// find index of active shape so we can select the next active shape on removal\nconst index=removableShapes.findIndex(shape=>shape===activeShape);// remove the active ship from the shape array\nconst didRemove=removeShape(activeShape);if(didRemove===false)return;// remember selection\npreviousSelectedShape=activeShape;// if no more markup items, release active shape\nif(removableShapes.length-1===0)return blurShapes();// select next active markup item\nconst indexNext=index-1<0?removableShapes.length-1:index-1;selectShape(removableShapes[indexNext]);};let previousSelectedShape=undefined;const blurShapes=()=>{previousSelectedShape=getSelectedShape();updateMarkupShapeItems({isSelected:false,isEditing:false});};const getSelectedShape=()=>markup.find(shapeIsSelected);const selectShape=(shape,sync=true)=>{// can't select draft\nif(shape.isDraft)return;// get currently selected shape\nconst selectedShape=getSelectedShape()||previousSelectedShape;// reset previous selected shape\npreviousSelectedShape=undefined;// if is returned false will cancel select operation\nif(!beforeSelectShape(selectedShape,shape))return;// remove selected state from other markup\nblurShapes();// select\nshapeSelect(shape);// selected this shape\nonselectshape(shape);// sync\nif(!sync)return;syncShapes();};const deselectMarkupItem=markupItem=>{updateMarkupShape(markupItem,{isSelected:false,isEditing:false});};const editMarkupItem=markupItem=>{updateMarkupShape(markupItem,{isSelected:true,isEditing:true});};const finishEditMarkupItem=markupItem=>{updateMarkupShape(markupItem,{isSelected:true,isEditing:false});};const removeMarkupItems=shapesToRemove=>{const shapesToRemoveFiltered=shapesToRemove.filter(beforeRemoveShape);$$invalidate(0,markup=markup.filter(shape=>!shapesToRemoveFiltered.includes(shape)));return shapesToRemoveFiltered;};const getTextShapeRect=shape=>{const size=textSize(shape.text,shape);return rectCreate(shape.x,shape.y,shape.width?Math.min(shape.width,size.width):size.width,shape.height?Math.min(shape.height,size.height):size.height);};const getMarkupShapeRect=shape=>{// has own rect\nif(shapeHasSize(shape))return rectCreateFromAny(shape);if(shapeIsEllipse(shape))return rectCreateFromEllipse(shape);// calculate the size on canvas\nconst rect=getTextShapeRect(shape);rect.width=Math.max(MIN_TEXT_MARKUP_WIDTH,shape.width||rect.width);return rect;};const getShapesAtPosition=position=>[...markup].// reverse the array, want to select from top to bottom\nreverse().map(shape=>({shape,priority:1})).// can't select paths\nfilter(result=>shapeCanSelect(result.shape)).// find markup near pointer\nfilter(result=>{// get shape\nconst{shape}=result;// we need to know where the shape will end up\nconst computedShape=shapeComputeDisplay(shapeDeepCopy(shape),parentRect);// test if clicked in rect\nif(shapeIsRect(computedShape)){return isPositionInRect(position,computedShape,shape.rotation);}else if(shapeIsText(computedShape)){const shapeRect=getMarkupShapeRect(computedShape);const isPositionInBounds=isPositionInRect(position,shapeRect,shape.rotation);let isPositionInVisual=false;if(isPositionInBounds&&!shapeIsSelected(shape)){const visualRect=getTextShapeRect(computedShape);if(shape.textAlign===\"right\"&&!shape.flipX){visualRect.x=shapeRect.x+shapeRect.width-visualRect.width;}if(shape.textAlign===\"center\"){visualRect.x=shapeRect.x+shapeRect.width*0.5-visualRect.width*0.5;}isPositionInVisual=isPositionInRect(position,visualRect,shape.rotation,rectCenter(shapeRect));if(!isPositionInVisual)result.priority=-1;}return isPositionInBounds;}else// test if is ellipse\nif(shapeIsEllipse(computedShape)){return isPositionInEllipse(position,computedShape,shape.rotation);}else// test if clicked on line\nif(shapeIsLine(computedShape)){// radius around click position, test if line intersects\nreturn isPositionNearLine(position,shapeLineGetStartPoint(computedShape),shapeLineGetEndPoint(computedShape),16);}return false;}).sort((a,b)=>{if(a.priority<b.priority){return 1;}if(a.priority>b.priority){return-1;}return 0;});const getMarkupBetweenPoints=(a,b)=>{// eraseLine should be in image space\nconst eraseLine=lineCreate(a,b);// loop over shapes and find intersecting shapes\nreturn markup.filter(shapeCanErase).filter(shape=>!!linePointsIntersection(eraseLine,getMarkupShapePoints(shapeComputeDisplay(shapeDeepCopy(shape),parentRect))));};//\n// Generic interaction\n//\nlet interactionTimer=undefined;let interactionTarget=undefined;let interactionShape=undefined;let interactionShapeOriginComputed=undefined;let isInteracting=false;const handleInteractionStart=e=>{const{origin}=e.detail;interactionShape=undefined;interactionShapeOriginComputed=undefined;interactionTarget=undefined;clearTimeout(interactionTimer);interactionTimer=setTimeout(()=>$$invalidate(104,isInteracting=true),250);// test if target is a shape, if not, run interaction handler\nconst point=mapEditorPointToImagePoint(vectorClone(origin));const foundShapes=getShapesAtPosition(point);const targettedMarkupItem=foundShapes.length&&foundShapes.shift().shape;// check if markup was targetted\nif(targettedMarkupItem&&shapeIsSelected(targettedMarkupItem)){// clone shape we're interacting with so we can update it properly\ninteractionShape=targettedMarkupItem;interactionShapeOriginComputed=shapeComputeDisplay(shapeDeepCopy(interactionShape),parentRect);return;}// set target\ninteractionTarget=targettedMarkupItem;// started interacting\noninteractionstart(e);};const handleInteractionUpdate=e=>{// is interacting with shape\nif(interactionShape){// prevent moving if not allowed\nif(!shapeCanMove(interactionShape))return;// prevent moving if is editing text\nif(shapeIsTextEditing(interactionShape))return;return translateShape(interactionShape,interactionShapeOriginComputed,e.detail.translation);}oninteractionupdate(e);};const handleInteractionRelease=e=>{clearTimeout(interactionTimer);$$invalidate(104,isInteracting=false);// test if is text and if we double tapped, if so, switch to text edit mode\nif(interactionShape){if(interactionShape.isEditing){handleTextCancel();}else if(e.detail.isDoubleTap&&shapeIsText(interactionShape)&&shapeCanInput(interactionShape)!==false){editMarkupItem(interactionShape);}return;}oninteractionrelease(e);};const handleInteractionEnd=e=>{// shape remains active so user can resize, rotate\nif(interactionShape){onupdateshape(interactionShape);interactionShape=undefined;return;}// can we deselect the current shape?\nconst currentSelectedShape=getSelectedShape();const isSelectInteraction=interactionTarget&&e.detail.isTap;const allowDeselectShape=currentSelectedShape?beforeDeselectShape(currentSelectedShape,interactionTarget):true;if(allowDeselectShape){blurShapes();}oninteractionend(e);if(allowDeselectShape&&isSelectInteraction){selectShape(interactionTarget);}};//\n// Shape manipulation\n//\nconst getMarkupShapePoints=shape=>{let center;let points;if(shapeIsRect(shape)){center=rectCenter(shape);points=rectGetCorners(shape);if(shape.flipX||shape.flipY)vectorsFlip(points,shape.flipX,shape.flipY,center.x,center.y);points=vectorsRotate(points,shape.rotation,center.x,center.y);}else if(shapeIsEllipse(shape)){center=shape;points=rectGetCorners(rectCreateFromEllipse(shape));if(shape.flipX||shape.flipY)vectorsFlip(points,shape.flipX,shape.flipY,center.x,center.y);points=vectorsRotate(points,shape.rotation,center.x,center.y);}else if(shapeIsLine(shape)){points=[shapeLineGetStartPoint(shape),shapeLineGetEndPoint(shape)];center=vectorCenter(points);}else if(shapeIsPath(shape)){points=[...shape.points];center=vectorCenter(points);}else if(shapeIsText(shape)){const rect=getMarkupShapeRect(shape);rect.width=Math.max(MIN_TEXT_MARKUP_WIDTH,rect.width);center=rectCenter(rect);points=rectGetCorners(rect);if(shape.flipX||shape.flipY)vectorsFlip(points,shape.flipX,shape.flipY,center.x,center.y);points=vectorsRotate(points,shape.rotation,center.x,center.y);}return points;};const getShapeRotationPoint=shape=>{const points=getMarkupShapePoints(shape);let origin;let dir;if(shape.flipY){origin=vectorCenter([points[0],points[1]]);dir=vectorNormalize(vectorCreate(points[1].x-points[2].x,points[1].y-points[2].y));}else{origin=vectorCenter([points[2],points[3]]);dir=vectorNormalize(vectorCreate(points[2].x-points[1].x,points[2].y-points[1].y));}vectorMultiply(dir,ROTATION_CONTROL_OFFSET/scale);return{origin,dir};};const getShapeRotationPointOnScreen=shape=>{const markupPoint=getShapeRotationPoint(shape);const screenPosition=mapImagePointToEditorPoint({x:markupPoint.origin.x+markupPoint.dir.x,y:markupPoint.origin.y+markupPoint.dir.y});const screenOrigin=mapImagePointToEditorPoint(markupPoint.origin);return{origin:screenOrigin,position:screenPosition};};// draw shape manipulator edges\nlet shapeManipulatorUid=`markup-manipulator-segment`;onDestroy(()=>{// clean up UI elements created by editor\n$$invalidate(43,ui=ui.filter(guide=>guide.id!==shapeManipulatorUid));});const handleManipulatorResizeGrab=e=>{$$invalidate(104,isInteracting=true);interactionShape=activeMarkup;interactionShapeOriginComputed=activeMarkupComputed;};const handleManipulatorResizeDrag=e=>{const{translation,indexes,shiftKey}=e.detail;resizeMarkup(interactionShape,interactionShapeOriginComputed,indexes,translation,{shiftKey});};const handleManipulatorResizeEnd=e=>{selectShape(interactionShape);interactionShape=undefined;$$invalidate(104,isInteracting=false);onupdateshape(activeMarkup);};const handleManipulatorRotateGrab=e=>{rotatorInitialPosition=getShapeRotationPoint(activeMarkupComputed).origin;$$invalidate(104,isInteracting=true);interactionShape=activeMarkup;interactionShapeOriginComputed=activeMarkupComputed;};const handleManipulatorRotateDrag=e=>{const{translation,shiftKey}=e.detail;rotateMarkup(interactionShape,interactionShapeOriginComputed,translation,{shiftKey});};const handleManipulatorRotateEnd=()=>{selectShape(interactionShape);interactionShape=undefined;$$invalidate(104,isInteracting=false);onupdateshape(activeMarkup);};//\n// Keyboard\n//\nconst handleKey=e=>{// only handle key input if a shape has been selected\nif(!hasActiveMarkupItem())return;// get key type\nconst{key}=e;// if is escape deselect active item\nif(/escape/i.test(key)){return deselectMarkupItem(activeMarkup);}// if is tab, select next markup item\n/*\nif (/arrow/i.test(key)) {\n    const success = e.shiftKey \n        ? selectPreviousMarkupItem(activeMarkup)\n        : selectNextMarkupItem(activeMarkup);\n    \n    if (success) {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n}\n*/ // if is remove active\nif(/backspace/i.test(key)&&!/input|textarea/i.test(e.target.nodeName)){// prevent back navigation on Firefox\ne.preventDefault();// remove the item\nremoveActiveMarkupItem();}};//\n// Text input\n//\nlet textInput;const getTextShapeOriginSnapshot=()=>_objectSpread({},activeMarkup);const handleTextInput=()=>{const value=shapeIsTextLine(activeMarkup)?filterNewlines(textInput.value):textInput.value;const canInput=shapeCanInput(activeMarkup,value);const text=canInput===true?value:canInput;let x=textShapeOrigin.x;let y=textShapeOrigin.y;// if does not have height we need to adjust offset if is rotated\nif(!activeMarkup.height&&activeMarkup.rotation!==0){const textSizeCurrent=textSize(text,activeMarkup);const textRectCurrent=rectCreate(textShapeOrigin.x,textShapeOrigin.y,textSizeCurrent.width,textSizeCurrent.height);const[currentTopLeft]=rectRotate(textRectCurrent,textShapeOrigin.rotation);const[originTopLeft]=rectRotate(textRectOrigin,textShapeOrigin.rotation);x+=originTopLeft.x-currentTopLeft.x;y+=originTopLeft.y-currentTopLeft.y;}updateMarkupShape(activeMarkup,{x,y,text});};const handleEditTextActiveMarkup=()=>editMarkupItem(activeMarkup);const handleTextInputAttempt=e=>{const currentValue=e.target.value;const selectionStart=e.target.selectionStart;const selectionEnd=e.target.selectionEnd;const currentValueStart=currentValue.substring(0,selectionStart);const currentValueEnd=currentValue.substring(selectionEnd);const intendedValue=currentValueStart+e.key+currentValueEnd;const filteredValue=shapeCanInput(activeMarkup,intendedValue);if(filteredValue!==intendedValue)return e.preventDefault();};const filterNewlines=value=>value.// split on lines so we can create compressed normal line of text\nsplit(/[\\n\\r]/g).// rempve spaces around lines\nmap(str=>str.trim()).// remove empty strings\nfilter(str=>str.length).// create new line\njoin(\" \");// prevent moving shape when focusing text field, and close field if escape pressed\nconst handleTextInputKeyDown=e=>{if(shapeIsTextLine(activeMarkup)&&/enter/i.test(e.code))return e.preventDefault();if(/arrow/i.test(e.code))return e.stopPropagation();if(/escape/i.test(e.key))return handleTextCancel();};// handle alt/ctrl/cmd + return\nconst handleTextInputKeyUp=e=>{// get key type\nconst{key,ctrlKey,altKey}=e;// confirm multi line text elements\nif(/enter/i.test(key)&&ctrlKey|altKey)return handleTextConfirm();};const handleTextConfirm=()=>{// if was draft, now need to confirm\nlet wasDraft=activeMarkup.isDraft;if(activeMarkup.isDraft)confirmMarkupItemDraft();// final text input check\nhandleTextInput();// done\nfinishEditMarkupItem(activeMarkup);if(wasDraft)onaddshape(activeMarkup);else onupdateshape(activeMarkup);};const handleTextCancel=()=>{// revert text\nupdateMarkupShape(activeMarkup,{text:textShapeOrigin.text,x:textShapeOrigin.x,y:textShapeOrigin.y});if(activeMarkup.isDraft)discardMarkupItemDraft();finishEditMarkupItem(activeMarkup);};//\n// Controls\n//\nconst handleFlipX=e=>{e.stopPropagation();const flipX=activeMarkup.flipX||false;updateMarkupShapeProperty(activeMarkup,\"flipX\",!flipX);onupdateshape(activeMarkup);};const handleFlipY=e=>{e.stopPropagation();const flipY=activeMarkup.flipY||false;updateMarkupShapeProperty(activeMarkup,\"flipY\",!flipY);onupdateshape(activeMarkup);};const handleRemoveActiveMarkup=e=>{e.stopPropagation();e.target.blur();// cancels focus of remove button\nremoveActiveMarkupItem();};const handleMoveToFrontActiveMarkup=e=>{e.stopPropagation();// test if is not already at top of stack, if so, exit\nconst index=markup.findIndex(shape=>shape===activeMarkup);if(index===markup.length-1)return;// add to last index\n$$invalidate(0,markup=markup.filter(markupItem=>markupItem!==activeMarkup).concat([activeMarkup]));onupdateshape(activeMarkup);};const handleDuplicateActiveMarkup=e=>{e.stopPropagation();// create clone\nconst clone=shapeDeepCopy(activeMarkup);clone.id=getUniqueId();const duplicationOffset=vectorCreate(50,-50);// offset\nif(shapeIsLine(clone)){const linePosition=shapeGetPropsPixelValues(clone,[\"x1\",\"y1\",\"x2\",\"y2\"],parentRect);linePosition.x1+=duplicationOffset.x;linePosition.y1+=duplicationOffset.y;linePosition.x2+=duplicationOffset.x;linePosition.y2+=duplicationOffset.y;shapeUpdateProps(clone,linePosition,parentRect);}else{const currentPosition=shapeGetPropsPixelValues(clone,[\"x\",\"y\"],parentRect);currentPosition.x+=50;currentPosition.y-=50;shapeUpdateProps(clone,currentPosition,parentRect);}// add clone\nmarkup.push(clone);// added\nonaddshape(clone);// select clone\nselectShape(clone);};const getMarkupControlsAnchorPosition=rect=>vectorApply(vectorCreate(rect.x+rect.width*0.5,rect.y),snapToPixel);//\n// show & position markup controls panel\n//\nconst markupControlsOpacity=spring(0,{stiffness:0.2,damping:0.7});component_subscribe($$self,markupControlsOpacity,value=>$$invalidate(17,$markupControlsOpacity=value));let shapeControlsSize;const getShapeControlPositionOnCanvas=position=>{const left=utilRect.x;const top=utilRect.y;const right=left+utilRect.width;let x=Math.max(position.x-shapeControlsSize.width*0.5,left);let y=Math.max(position.y-shapeControlsSize.height-shapeControlDist,top);if(x+shapeControlsSize.width>right)x=right-shapeControlsSize.width;return vectorCreate(x,y);};const handleNudge=e=>{const shape=getActiveMarkupItem();if(!shape)return;if(!shapeCanMove(shape))return;interactionShape=shape;interactionShapeOriginComputed=shapeComputeDisplay(shapeDeepCopy(interactionShape),parentRect);translateShape(interactionShape,interactionShapeOriginComputed,e.detail);};const handleViewResize=()=>{if(isTextMarkupSelected)return;blurShapes();};// shape navigator\nlet showShapeList=false;const handleFocusIn=e=>{$$invalidate(7,showShapeList=true);};const handleFocusOut=({relatedTarget})=>{// still in list\nif(relatedTarget.classList.contains(\"shape-selector__button\"))return;$$invalidate(7,showShapeList=false);};function measure_handler(event){bubble($$self,event);}const click_handler=(index,e)=>selectShape(markup[index]);function textarea_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{textInput=$$value;$$invalidate(5,textInput);});}const measure_handler_1=e=>$$invalidate(6,shapeControlsSize=e.detail);const interactable_function=e=>getEventPositionInEditor(e,rootRect);$$self.$$set=$$props=>{if(\"markup\"in $$props)$$invalidate(0,markup=$$props.markup);if(\"offset\"in $$props)$$invalidate(1,offset=$$props.offset);if(\"rotation\"in $$props)$$invalidate(44,rotation=$$props.rotation);if(\"scale\"in $$props)$$invalidate(45,scale=$$props.scale);if(\"ui\"in $$props)$$invalidate(43,ui=$$props.ui);if(\"opacity\"in $$props)$$invalidate(46,opacity=$$props.opacity);if(\"parentRect\"in $$props)$$invalidate(47,parentRect=$$props.parentRect);if(\"rootRect\"in $$props)$$invalidate(2,rootRect=$$props.rootRect);if(\"stageRect\"in $$props)$$invalidate(48,stageRect=$$props.stageRect);if(\"utilRect\"in $$props)$$invalidate(49,utilRect=$$props.utilRect);if(\"oninteractionstart\"in $$props)$$invalidate(50,oninteractionstart=$$props.oninteractionstart);if(\"oninteractionupdate\"in $$props)$$invalidate(51,oninteractionupdate=$$props.oninteractionupdate);if(\"oninteractionrelease\"in $$props)$$invalidate(52,oninteractionrelease=$$props.oninteractionrelease);if(\"oninteractionend\"in $$props)$$invalidate(53,oninteractionend=$$props.oninteractionend);if(\"onaddshape\"in $$props)$$invalidate(54,onaddshape=$$props.onaddshape);if(\"onupdateshape\"in $$props)$$invalidate(55,onupdateshape=$$props.onupdateshape);if(\"onselectshape\"in $$props)$$invalidate(56,onselectshape=$$props.onselectshape);if(\"onremoveshape\"in $$props)$$invalidate(57,onremoveshape=$$props.onremoveshape);if(\"beforeSelectShape\"in $$props)$$invalidate(58,beforeSelectShape=$$props.beforeSelectShape);if(\"beforeDeselectShape\"in $$props)$$invalidate(59,beforeDeselectShape=$$props.beforeDeselectShape);if(\"beforeAddShape\"in $$props)$$invalidate(60,beforeAddShape=$$props.beforeAddShape);if(\"beforeRemoveShape\"in $$props)$$invalidate(61,beforeRemoveShape=$$props.beforeRemoveShape);if(\"beforeUpdateShape\"in $$props)$$invalidate(62,beforeUpdateShape=$$props.beforeUpdateShape);if(\"willRenderShapeControls\"in $$props)$$invalidate(63,willRenderShapeControls=$$props.willRenderShapeControls);if(\"mapEditorPointToImagePoint\"in $$props)$$invalidate(64,mapEditorPointToImagePoint=$$props.mapEditorPointToImagePoint);if(\"mapImagePointToEditorPoint\"in $$props)$$invalidate(65,mapImagePointToEditorPoint=$$props.mapImagePointToEditorPoint);if(\"enableButtonFlipVertical\"in $$props)$$invalidate(66,enableButtonFlipVertical=$$props.enableButtonFlipVertical);if(\"locale\"in $$props)$$invalidate(3,locale=$$props.locale);};let activeMarkup;let activeShapeId;let activeMarkupComputed;let activeMarkupItemIsDraft;let shapeProps;let shapeActivePoints;let allowResizeControls;let allowRotateControls;let allowedResizeControls;let shouldRenderShapeManipulator;let shapeActiveScreenPoints;let shapeManipulatorPoints;let shapeManipulatorRotationPoint;let shapeManipulatorRotationPointPosition;let shapeOpacity;let isTextMarkupSelected;let shouldRenderTextInput;let textShapeOrigin;let textSizeOrigin;let textRectOrigin;let textInputText;let markupTextInputStyle;let controlledMarkupItem;let allowShapeFlip;let allowShapeDuplicate;let allowShapeRemove;let allowShapeReorder;let allowShapeInput;let markupControlsAnchorPosition;let shapeControlsPosition;let markupControlsStyle;let shapeControls;let shapeNavList;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*markup*/1){$$invalidate(106,activeMarkup=markup&&(getMarkupItemDraft()||getActiveMarkupItem()));}if($$self.$$.dirty[3]&/*activeMarkup*/8192){$$invalidate(107,activeShapeId=activeMarkup&&!shapeIsDraft(activeMarkup)?activeMarkup.id:undefined);}if($$self.$$.dirty[1]&/*parentRect*/65536|$$self.$$.dirty[3]&/*activeMarkup*/8192){$$invalidate(108,activeMarkupComputed=activeMarkup&&shapeComputeDisplay(shapeDeepCopy(activeMarkup),parentRect));}if($$self.$$.dirty[3]&/*activeMarkup*/8192){$$invalidate(109,activeMarkupItemIsDraft=!!(activeMarkup&&shapeIsDraft(activeMarkup)));}if($$self.$$.dirty[3]&/*activeMarkup*/8192){$$invalidate(110,shapeProps=activeMarkup||undefined);}if($$self.$$.dirty[3]&/*activeMarkup, activeMarkupComputed*/40960){$$invalidate(111,shapeActivePoints=activeMarkup&&!shapeIsPath(activeMarkupComputed)&&getMarkupShapePoints(activeMarkupComputed)||[]);}if($$self.$$.dirty[3]&/*activeMarkup*/8192){$$invalidate(112,allowResizeControls=activeMarkup&&shapeCanResize(activeMarkup)&&!shapeIsTextEditing(activeMarkup));}if($$self.$$.dirty[3]&/*activeMarkup*/8192){$$invalidate(8,allowRotateControls=activeMarkup&&shapeCanRotate(activeMarkup)&&!shapeIsTextEditing(activeMarkup));}if($$self.$$.dirty[3]&/*allowResizeControls, activeMarkup*/532480){$$invalidate(9,allowedResizeControls=allowResizeControls&&hasProp(activeMarkup,\"text\")&&!activeMarkup.height?\"horizontal\":allowResizeControls);}if($$self.$$.dirty[3]&/*activeMarkup, shapeActivePoints*/270336){$$invalidate(10,shouldRenderShapeManipulator=activeMarkup&&shapeActivePoints.length>1);}if($$self.$$.dirty[2]&/*mapImagePointToEditorPoint*/8|$$self.$$.dirty[3]&/*shapeActivePoints*/262144){$$invalidate(113,shapeActiveScreenPoints=shapeActivePoints.map(mapImagePointToEditorPoint));}if($$self.$$.dirty[0]&/*offset*/2|$$self.$$.dirty[3]&/*shapeActiveScreenPoints*/1048576){$$invalidate(11,shapeManipulatorPoints=shapeActiveScreenPoints.map(point=>vectorCreate(point.x-offset.x,point.y-offset.y)));}if($$self.$$.dirty[0]&/*shouldRenderShapeManipulator, allowRotateControls*/1280|$$self.$$.dirty[3]&/*activeMarkupComputed*/32768){$$invalidate(114,shapeManipulatorRotationPoint=shouldRenderShapeManipulator&&allowRotateControls&&getShapeRotationPointOnScreen(activeMarkupComputed));}if($$self.$$.dirty[0]&/*offset*/2|$$self.$$.dirty[3]&/*shapeManipulatorRotationPoint*/2097152){$$invalidate(12,shapeManipulatorRotationPointPosition=shapeManipulatorRotationPoint&&vectorCreate(shapeManipulatorRotationPoint.position.x-offset.x,shapeManipulatorRotationPoint.position.y-offset.y));}if($$self.$$.dirty[1]&/*opacity*/32768){$$invalidate(115,shapeOpacity=opacity);// 1.0; // shapeManipulatorOpacity * opacity;\n}if($$self.$$.dirty[0]&/*shapeManipulatorPoints*/2048|$$self.$$.dirty[1]&/*opacity, ui*/36864|$$self.$$.dirty[3]&/*shapeActiveScreenPoints, shapeOpacity, shapeManipulatorRotationPoint*/7340032){if(opacity>0&&shapeManipulatorPoints.length>2){// create manipulator outline segments\nconst points=[...shapeActiveScreenPoints,shapeActiveScreenPoints[0]];const l=points.length;const segments=[];const strokeColor=[1,1,1,shapeOpacity];const strokeWidth=1;for(let i=0;i<l-1;i++){segments[i]={id:shapeManipulatorUid,points:[points[i],points[i+1]],opacity:1,strokeColor,strokeWidth};}if(shapeManipulatorRotationPoint){// add rotator line\nsegments[segments.length]={id:shapeManipulatorUid,opacity:1,points:[{x:shapeManipulatorRotationPoint.origin.x,y:shapeManipulatorRotationPoint.origin.y},{x:shapeManipulatorRotationPoint.position.x,y:shapeManipulatorRotationPoint.position.y}],strokeColor,strokeWidth};}// remove existing segments, and set new ones\n$$invalidate(43,ui=[...ui.filter(guide=>guide.id!==shapeManipulatorUid),...segments]);}else{// remove the guides when shape manipulator is no longer visible\n$$invalidate(43,ui=ui.filter(guide=>guide.id!==shapeManipulatorUid));}}if($$self.$$.dirty[3]&/*activeMarkup*/8192){$$invalidate(116,isTextMarkupSelected=activeMarkup&&shapeIsText(activeMarkup));}if($$self.$$.dirty[3]&/*isTextMarkupSelected, activeMarkup*/8396800){$$invalidate(13,shouldRenderTextInput=isTextMarkupSelected&&shapeCanInput(activeMarkup)!==false&&activeMarkup.isEditing);}if($$self.$$.dirty[0]&/*shouldRenderTextInput*/8192){$$invalidate(117,textShapeOrigin=shouldRenderTextInput?getTextShapeOriginSnapshot():undefined);}if($$self.$$.dirty[3]&/*textShapeOrigin*/16777216){$$invalidate(118,textSizeOrigin=textShapeOrigin&&textSize(textShapeOrigin.text,textShapeOrigin));}if($$self.$$.dirty[3]&/*textShapeOrigin, textSizeOrigin*/50331648){textRectOrigin=textShapeOrigin&&rectCreate(textShapeOrigin.x,textShapeOrigin.y,textSizeOrigin.width,textSizeOrigin.height);}if($$self.$$.dirty[0]&/*shouldRenderTextInput*/8192|$$self.$$.dirty[3]&/*activeMarkup*/8192){$$invalidate(14,textInputText=shouldRenderTextInput?activeMarkup.text:\"\");}if($$self.$$.dirty[0]&/*shouldRenderTextInput*/8192|$$self.$$.dirty[3]&/*shapeProps*/131072){$$invalidate(15,markupTextInputStyle=shouldRenderTextInput&&`\n    text-align: ${shapeProps.textAlign||\"left\"};\n    font-family: ${shapeProps.fontFamily||\"sans-serif\"};\n`);}if($$self.$$.dirty[3]&/*activeMarkup, activeMarkupItemIsDraft, controlledMarkupItem*/134291456){$$invalidate(120,controlledMarkupItem=activeMarkup&&!activeMarkupItemIsDraft?activeMarkup:controlledMarkupItem);}if($$self.$$.dirty[3]&/*controlledMarkupItem*/134217728){$$invalidate(121,allowShapeFlip=controlledMarkupItem&&shapeCanFlip(controlledMarkupItem));}if($$self.$$.dirty[3]&/*controlledMarkupItem*/134217728){$$invalidate(122,allowShapeDuplicate=controlledMarkupItem&&shapeCanDuplicate(controlledMarkupItem));}if($$self.$$.dirty[3]&/*controlledMarkupItem*/134217728){$$invalidate(123,allowShapeRemove=controlledMarkupItem&&shapeCanRemove(controlledMarkupItem));}if($$self.$$.dirty[3]&/*controlledMarkupItem*/134217728){$$invalidate(124,allowShapeReorder=controlledMarkupItem&&shapeCanReorder(controlledMarkupItem));}if($$self.$$.dirty[3]&/*controlledMarkupItem*/134217728){$$invalidate(125,allowShapeInput=controlledMarkupItem&&shapeCanInput(controlledMarkupItem)!==false);}if($$self.$$.dirty[0]&/*shouldRenderTextInput*/8192|$$self.$$.dirty[3]&/*activeMarkup, activeMarkupItemIsDraft, isInteracting*/75776){markupControlsOpacity.set(activeMarkup&&!activeMarkupItemIsDraft&&!isInteracting&&!shouldRenderTextInput?1:0);}if($$self.$$.dirty[0]&/*shapeManipulatorPoints*/2048|$$self.$$.dirty[3]&/*activeMarkup, activeMarkupItemIsDraft*/73728|$$self.$$.dirty[4]&/*markupControlsAnchorPosition*/4){$$invalidate(126,markupControlsAnchorPosition=activeMarkup&&!activeMarkupItemIsDraft?getMarkupControlsAnchorPosition(rectCreateFromPoints(shapeManipulatorPoints)):markupControlsAnchorPosition);}if($$self.$$.dirty[0]&/*shapeControlsSize*/64|$$self.$$.dirty[1]&/*utilRect*/262144|$$self.$$.dirty[4]&/*markupControlsAnchorPosition*/4){$$invalidate(127,shapeControlsPosition=markupControlsAnchorPosition&&shapeControlsSize&&utilRect&&getShapeControlPositionOnCanvas(markupControlsAnchorPosition));}if($$self.$$.dirty[0]&/*$markupControlsOpacity*/131072|$$self.$$.dirty[4]&/*shapeControlsPosition*/8){$$invalidate(16,markupControlsStyle=shapeControlsPosition&&`transform: translate(${shapeControlsPosition.x}px, ${shapeControlsPosition.y}px);opacity:${$markupControlsOpacity}`);}if($$self.$$.dirty[0]&/*locale*/8|$$self.$$.dirty[2]&/*willRenderShapeControls, enableButtonFlipVertical*/18|$$self.$$.dirty[3]&/*activeShapeId, allowShapeFlip, allowShapeDuplicate, allowShapeRemove*/1879064576|$$self.$$.dirty[4]&/*allowShapeReorder, allowShapeInput*/3){$$invalidate(18,shapeControls=activeShapeId&&willRenderShapeControls([[\"div\",\"alpha\",{class:\"DokaShapeControlsGroup\"},[allowShapeFlip&&[Button,\"flip-horizontal\",{onclick:handleFlipX,label:locale.shapeTitleButtonFlipHorizontal,icon:locale.shapeIconButtonFlipHorizontal,hideLabel:true}],allowShapeFlip&&enableButtonFlipVertical&&[Button,\"flip-vertical\",{onclick:handleFlipY,label:locale.shapeTitleButtonFlipVertical,icon:locale.shapeIconButtonFlipVertical,hideLabel:true}],allowShapeReorder&&[Button,\"to-front\",{onclick:handleMoveToFrontActiveMarkup,label:locale.shapeTitleButtonMoveToFront,icon:locale.shapeIconButtonMoveToFront,hideLabel:true}],allowShapeDuplicate&&[Button,\"duplicate\",{onclick:handleDuplicateActiveMarkup,label:locale.shapeTitleButtonDuplicate,icon:locale.shapeIconButtonDuplicate,hideLabel:true}],allowShapeRemove&&[Button,\"remove\",{onclick:handleRemoveActiveMarkup,label:locale.shapeTitleButtonRemove,icon:locale.shapeIconButtonRemove,hideLabel:true}]]],allowShapeInput&&[\"div\",\"beta\",{class:\"DokaShapeControlsGroup\"},[[Button,\"edit-text\",{label:locale.shapeLabelInputText,onclick:handleEditTextActiveMarkup}]]]],activeShapeId));}if($$self.$$.dirty[0]&/*rootRect*/4){// if view is resized\nif(rootRect){handleViewResize();}}if($$self.$$.dirty[0]&/*markup, locale*/9){$$invalidate(19,shapeNavList=markup.filter(shapeCanSelect).filter(shape=>!shapeIsDraft(shape)).map(shape=>({id:shape.id,color:shapeIsText(shape)?shape.color:shapeIsLine(shape)?shape.strokeColor:shape.backgroundColor,name:shape.name||locale[`shapeLabelTool${capitalizeFirstLetter(shapeGetDescription(shape))}`]})));}};return[markup,offset,rootRect,locale,selectShape,textInput,shapeControlsSize,showShapeList,allowRotateControls,allowedResizeControls,shouldRenderShapeManipulator,shapeManipulatorPoints,shapeManipulatorRotationPointPosition,shouldRenderTextInput,textInputText,markupTextInputStyle,markupControlsStyle,$markupControlsOpacity,shapeControls,shapeNavList,keysPressedStored,handleWheel,handleInteractionStart,handleInteractionUpdate,handleInteractionRelease,handleInteractionEnd,handleManipulatorResizeGrab,handleManipulatorResizeDrag,handleManipulatorResizeEnd,handleManipulatorRotateGrab,handleManipulatorRotateDrag,handleManipulatorRotateEnd,handleKey,handleTextInput,handleTextInputAttempt,handleTextInputKeyDown,handleTextInputKeyUp,handleTextConfirm,handleTextCancel,markupControlsOpacity,handleNudge,handleFocusIn,handleFocusOut,ui,rotation,scale,opacity,parentRect,stageRect,utilRect,oninteractionstart,oninteractionupdate,oninteractionrelease,oninteractionend,onaddshape,onupdateshape,onselectshape,onremoveshape,beforeSelectShape,beforeDeselectShape,beforeAddShape,beforeRemoveShape,beforeUpdateShape,willRenderShapeControls,mapEditorPointToImagePoint,mapImagePointToEditorPoint,enableButtonFlipVertical,createShape,eraseShape,getMarkupItemDraft,addMarkupItemDraft,confirmMarkupItemDraft,discardMarkupItemDraft,createMarkupItem,syncShapes,addShape,updateMarkupShape,updateMarkupShapeProperty,updateMarkupItemsShapeProperty,updateMarkupShapeItems,getActiveMarkupItem,hasActiveMarkupItem,removeShape,removeActiveMarkupItem,blurShapes,deselectMarkupItem,editMarkupItem,finishEditMarkupItem,removeMarkupItems,getTextShapeRect,getMarkupShapeRect,getShapesAtPosition,getMarkupBetweenPoints,measure_handler,click_handler,textarea_binding,measure_handler_1,interactable_function];}class ShapeLayoutEditor extends SvelteComponent{constructor(options){super();init(this,options,instance$w,create_fragment$w,safe_not_equal,{markup:0,offset:1,rotation:44,scale:45,ui:43,opacity:46,parentRect:47,rootRect:2,stageRect:48,utilRect:49,oninteractionstart:50,oninteractionupdate:51,oninteractionrelease:52,oninteractionend:53,onaddshape:54,onupdateshape:55,onselectshape:56,onremoveshape:57,beforeSelectShape:58,beforeDeselectShape:59,beforeAddShape:60,beforeRemoveShape:61,beforeUpdateShape:62,willRenderShapeControls:63,mapEditorPointToImagePoint:64,mapImagePointToEditorPoint:65,enableButtonFlipVertical:66,locale:3,createShape:67,eraseShape:68,getMarkupItemDraft:69,addMarkupItemDraft:70,confirmMarkupItemDraft:71,discardMarkupItemDraft:72,createMarkupItem:73,syncShapes:74,addShape:75,updateMarkupShape:76,updateMarkupShapeProperty:77,updateMarkupItemsShapeProperty:78,updateMarkupShapeItems:79,getActiveMarkupItem:80,hasActiveMarkupItem:81,removeShape:82,removeActiveMarkupItem:83,blurShapes:84,selectShape:4,deselectMarkupItem:85,editMarkupItem:86,finishEditMarkupItem:87,removeMarkupItems:88,getTextShapeRect:89,getMarkupShapeRect:90,getShapesAtPosition:91,getMarkupBetweenPoints:92},[-1,-1,-1,-1,-1,-1]);}get createShape(){return this.$$.ctx[67];}get eraseShape(){return this.$$.ctx[68];}get getMarkupItemDraft(){return this.$$.ctx[69];}get addMarkupItemDraft(){return this.$$.ctx[70];}get confirmMarkupItemDraft(){return this.$$.ctx[71];}get discardMarkupItemDraft(){return this.$$.ctx[72];}get createMarkupItem(){return this.$$.ctx[73];}get syncShapes(){return this.$$.ctx[74];}get addShape(){return this.$$.ctx[75];}get updateMarkupShape(){return this.$$.ctx[76];}get updateMarkupShapeProperty(){return this.$$.ctx[77];}get updateMarkupItemsShapeProperty(){return this.$$.ctx[78];}get updateMarkupShapeItems(){return this.$$.ctx[79];}get getActiveMarkupItem(){return this.$$.ctx[80];}get hasActiveMarkupItem(){return this.$$.ctx[81];}get removeShape(){return this.$$.ctx[82];}get removeActiveMarkupItem(){return this.$$.ctx[83];}get blurShapes(){return this.$$.ctx[84];}get selectShape(){return this.$$.ctx[4];}get deselectMarkupItem(){return this.$$.ctx[85];}get editMarkupItem(){return this.$$.ctx[86];}get finishEditMarkupItem(){return this.$$.ctx[87];}get removeMarkupItems(){return this.$$.ctx[88];}get getTextShapeRect(){return this.$$.ctx[89];}get getMarkupShapeRect(){return this.$$.ctx[90];}get getShapesAtPosition(){return this.$$.ctx[91];}get getMarkupBetweenPoints(){return this.$$.ctx[92];}}/* src/core/ui/components/ShapeStyleEditor.svelte generated by Svelte v3.29.4 */function get_each_context$7(ctx,list,i){const child_ctx=ctx.slice();child_ctx[10]=list[i];return child_ctx;}// (300:4) {#if activeShapeHash}\nfunction create_if_block$9(ctx){let previous_key=/*activeShapeHash*/ctx[2];let key_block_anchor;let current;let key_block=create_key_block(ctx);return{c(){key_block.c();key_block_anchor=empty();},m(target,anchor){key_block.m(target,anchor);insert(target,key_block_anchor,anchor);current=true;},p(ctx,dirty){if(dirty&/*activeShapeHash*/4&&safe_not_equal(previous_key,previous_key=/*activeShapeHash*/ctx[2])){group_outros();transition_out(key_block,1,1,noop$1);check_outros();key_block=create_key_block(ctx);key_block.c();transition_in(key_block);key_block.m(key_block_anchor.parentNode,key_block_anchor);}else{key_block.p(ctx,dirty);}},i(local){if(current)return;transition_in(key_block);current=true;},o(local){transition_out(key_block);current=false;},d(detaching){if(detaching)detach(key_block_anchor);key_block.d(detaching);}};}// (304:16) {#each activeControls as styleControl (styleControl.id) }\nfunction create_each_block$7(key_1,ctx){let li;let span;let t0_value=localize(/*styleControl*/ctx[10].componentProps.title,/*locale*/ctx[0])+\"\";let t0;let t1;let switch_instance;let t2;let current;const switch_instance_spread_levels=[/*styleControl*/ctx[10].componentProps];var switch_value=/*styleControl*/ctx[10].component;function switch_props(ctx){let switch_instance_props={};for(let i=0;i<switch_instance_spread_levels.length;i+=1){switch_instance_props=assign(switch_instance_props,switch_instance_spread_levels[i]);}return{props:switch_instance_props};}if(switch_value){switch_instance=new switch_value(switch_props());}return{key:key_1,first:null,c(){li=element(\"li\");span=element(\"span\");t0=text(t0_value);t1=space();if(switch_instance)create_component(switch_instance.$$.fragment);t2=space();attr(span,\"class\",\"DokaShapeStyleLabel\");attr(li,\"class\",\"DokaShapeStyle\");this.first=li;},m(target,anchor){insert(target,li,anchor);append(li,span);append(span,t0);append(li,t1);if(switch_instance){mount_component(switch_instance,li,null);}append(li,t2);current=true;},p(ctx,dirty){if((!current||dirty&/*activeControls, locale*/9)&&t0_value!==(t0_value=localize(/*styleControl*/ctx[10].componentProps.title,/*locale*/ctx[0])+\"\"))set_data(t0,t0_value);const switch_instance_changes=dirty&/*activeControls*/8?get_spread_update(switch_instance_spread_levels,[get_spread_object(/*styleControl*/ctx[10].componentProps)]):{};if(switch_value!==(switch_value=/*styleControl*/ctx[10].component)){if(switch_instance){group_outros();const old_component=switch_instance;transition_out(old_component.$$.fragment,1,0,()=>{destroy_component(old_component,1);});check_outros();}if(switch_value){switch_instance=new switch_value(switch_props());create_component(switch_instance.$$.fragment);transition_in(switch_instance.$$.fragment,1);mount_component(switch_instance,li,t2);}else{switch_instance=null;}}else if(switch_value){switch_instance.$set(switch_instance_changes);}},i(local){if(current)return;if(switch_instance)transition_in(switch_instance.$$.fragment,local);current=true;},o(local){if(switch_instance)transition_out(switch_instance.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(li);if(switch_instance)destroy_component(switch_instance);}};}// (302:8) <Scrollable class=\"DokaShapeStyles\" elasticity={scrollElasticity}>\nfunction create_default_slot$8(ctx){let ul;let each_blocks=[];let each_1_lookup=new Map();let ul_transition;let current;let each_value=/*activeControls*/ctx[3];const get_key=ctx=>/*styleControl*/ctx[10].id;for(let i=0;i<each_value.length;i+=1){let child_ctx=get_each_context$7(ctx,each_value,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block$7(key,child_ctx));}return{c(){ul=element(\"ul\");for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}attr(ul,\"class\",\"DokaShapeStyleList\");},m(target,anchor){insert(target,ul,anchor);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(ul,null);}current=true;},p(ctx,dirty){if(dirty&/*activeControls, localize, locale*/9){const each_value=/*activeControls*/ctx[3];group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,ul,outro_and_destroy_block,create_each_block$7,null,get_each_context$7);check_outros();}},i(local){if(current)return;for(let i=0;i<each_value.length;i+=1){transition_in(each_blocks[i]);}add_render_callback(()=>{if(!ul_transition)ul_transition=create_bidirectional_transition(ul,fade,{duration:250},true);ul_transition.run(1);});current=true;},o(local){for(let i=0;i<each_blocks.length;i+=1){transition_out(each_blocks[i]);}if(!ul_transition)ul_transition=create_bidirectional_transition(ul,fade,{duration:250},false);ul_transition.run(0);current=false;},d(detaching){if(detaching)detach(ul);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d();}if(detaching&&ul_transition)ul_transition.end();}};}// (301:8) {#key activeShapeHash}\nfunction create_key_block(ctx){let scrollable;let current;scrollable=new Scrollable({props:{class:\"DokaShapeStyles\",elasticity:/*scrollElasticity*/ctx[1],$$slots:{default:[create_default_slot$8]},$$scope:{ctx}}});return{c(){create_component(scrollable.$$.fragment);},m(target,anchor){mount_component(scrollable,target,anchor);current=true;},p(ctx,dirty){const scrollable_changes={};if(dirty&/*scrollElasticity*/2)scrollable_changes.elasticity=/*scrollElasticity*/ctx[1];if(dirty&/*$$scope, activeControls, locale*/8201){scrollable_changes.$$scope={dirty,ctx};}scrollable.$set(scrollable_changes);},i(local){if(current)return;transition_in(scrollable.$$.fragment,local);current=true;},o(local){transition_out(scrollable.$$.fragment,local);current=false;},d(detaching){destroy_component(scrollable,detaching);}};}function create_fragment$x(ctx){let div;let current;let if_block=/*activeShapeHash*/ctx[2]&&create_if_block$9(ctx);return{c(){div=element(\"div\");if(if_block)if_block.c();attr(div,\"class\",\"DokaShapeStyleEditor\");},m(target,anchor){insert(target,div,anchor);if(if_block)if_block.m(div,null);current=true;},p(ctx,[dirty]){if(/*activeShapeHash*/ctx[2]){if(if_block){if_block.p(ctx,dirty);if(dirty&/*activeShapeHash*/4){transition_in(if_block,1);}}else{if_block=create_if_block$9(ctx);if_block.c();transition_in(if_block,1);if_block.m(div,null);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(div);if(if_block)if_block.d();}};}function instance$x($$self,$$props,$$invalidate){let{controls={}}=$$props;let{shape=undefined}=$$props;let{onchange}=$$props;let{locale}=$$props;let{scrollElasticity}=$$props;const getShapeControls=shape=>{const shapeId=shape.id||\"tool\";const activeControls=controlKeys.filter(styleKey=>styleKey.split(\"_\").every(styleKey=>shape.hasOwnProperty(styleKey)&&shapeCanStyle(shape,styleKey))).map(styleKey=>{const styleKeys=styleKey.split(\"_\");const currentValue=styleKeys.length>1?styleKeys.map(key=>shape[key]):shape[styleKey];const[component,componentProps]=controls[styleKey];const options=isFunction(componentProps.options)?componentProps.options(shape):componentProps.options;return{id:`${shapeId}_${styleKey}`,component,componentProps:_objectSpread(_objectSpread({},componentProps),{},{// set the options prop\noptions,// defaults\nlocale,value:currentValue,optionLabelClass:\"DokaButtonLabel\",onchange:detail=>{const value=isObject(detail)&&!isArray(detail)?detail.value:detail;// allow custom changes\nif(componentProps.onchange)componentProps.onchange(value,shape);// internal change                        \nconst props=styleKeys.length>1?styleKeys.reduce((prev,key,index)=>{return _objectSpread(_objectSpread({},prev),{},{[key]:Array.isArray(value)?value[index]:value});},{}):{[styleKey]:value};onchange(props);}})};});return activeControls;};// animate\nlet activeShapeHash;let activeShapeHashPrev;$$self.$$set=$$props=>{if(\"controls\"in $$props)$$invalidate(4,controls=$$props.controls);if(\"shape\"in $$props)$$invalidate(5,shape=$$props.shape);if(\"onchange\"in $$props)$$invalidate(6,onchange=$$props.onchange);if(\"locale\"in $$props)$$invalidate(0,locale=$$props.locale);if(\"scrollElasticity\"in $$props)$$invalidate(1,scrollElasticity=$$props.scrollElasticity);};let controlKeys;let activeControls;$$self.$$.update=()=>{if($$self.$$.dirty&/*controls*/16){// finds the controls needed to style the selected shape\n$$invalidate(8,controlKeys=Object.keys(controls).filter(key=>controls[key]));}if($$self.$$.dirty&/*shape, controlKeys*/288){$$invalidate(3,activeControls=shape&&controlKeys&&shapeCanStyle(shape)?getShapeControls(shape):[]);}if($$self.$$.dirty&/*shape, activeShapeHashPrev*/160){if(shape){const hash=Object.keys(shape).join(\"_\");if(hash!=activeShapeHashPrev){$$invalidate(7,activeShapeHashPrev=hash);$$invalidate(2,activeShapeHash=hash);}}}};return[locale,scrollElasticity,activeShapeHash,activeControls,controls,shape,onchange];}class ShapeStyleEditor extends SvelteComponent{constructor(options){super();init(this,options,instance$x,create_fragment$x,safe_not_equal,{controls:4,shape:5,onchange:6,locale:0,scrollElasticity:1});}}/* src/core/ui/components/ShapePresetSelect.svelte generated by Svelte v3.29.4 */function create_if_block_1$a(ctx){let icon;let current;icon=new Icon({props:{width:16,height:16,$$slots:{default:[create_default_slot$9]},$$scope:{ctx}}});return{c(){create_component(icon.$$.fragment);},m(target,anchor){mount_component(icon,target,anchor);current=true;},p(ctx,dirty){const icon_changes={};if(dirty&/*$$scope, locale*/65){icon_changes.$$scope={dirty,ctx};}icon.$set(icon_changes);},i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o(local){transition_out(icon.$$.fragment,local);current=false;},d(detaching){destroy_component(icon,detaching);}};}// (77:8) <Icon width={16} height={16}>\nfunction create_default_slot$9(ctx){let g;let raw_value=/*locale*/ctx[0].shapeIconButtonSelectSticker+\"\";return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=raw_value;},p(ctx,dirty){if(dirty&/*locale*/1&&raw_value!==(raw_value=/*locale*/ctx[0].shapeIconButtonSelectSticker+\"\"))g.innerHTML=raw_value;},d(detaching){if(detaching)detach(g);}};}// (79:8) {#if locale.shapeLabelButtonSelectSticker}\nfunction create_if_block$a(ctx){let span;let t_value=/*locale*/ctx[0].shapeLabelButtonSelectSticker+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty&/*locale*/1&&t_value!==(t_value=/*locale*/ctx[0].shapeLabelButtonSelectSticker+\"\"))set_data(t,t_value);},d(detaching){if(detaching)detach(span);}};}function create_fragment$y(ctx){let form;let input;let t0;let label;let t1;let current;let mounted;let dispose;let if_block0=/*locale*/ctx[0].shapeIconButtonSelectSticker&&create_if_block_1$a(ctx);let if_block1=/*locale*/ctx[0].shapeLabelButtonSelectSticker&&create_if_block$a(ctx);return{c(){form=element(\"form\");input=element(\"input\");t0=space();label=element(\"label\");if(if_block0)if_block0.c();t1=space();if(if_block1)if_block1.c();attr(input,\"id\",/*name*/ctx[2]);attr(input,\"type\",\"file\");attr(input,\"accept\",\"image/*\");attr(label,\"for\",/*name*/ctx[2]);attr(form,\"class\",\"DokaShapePresetSelect\");},m(target,anchor){insert(target,form,anchor);append(form,input);append(form,t0);append(form,label);if(if_block0)if_block0.m(label,null);append(label,t1);if(if_block1)if_block1.m(label,null);/*form_binding*/ctx[5](form);current=true;if(!mounted){dispose=listen(input,\"input\",/*handleFileInput*/ctx[3]);mounted=true;}},p(ctx,[dirty]){if(/*locale*/ctx[0].shapeIconButtonSelectSticker){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*locale*/1){transition_in(if_block0,1);}}else{if_block0=create_if_block_1$a(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(label,t1);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(/*locale*/ctx[0].shapeLabelButtonSelectSticker){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block$a(ctx);if_block1.c();if_block1.m(label,null);}}else if(if_block1){if_block1.d(1);if_block1=null;}},i(local){if(current)return;transition_in(if_block0);current=true;},o(local){transition_out(if_block0);current=false;},d(detaching){if(detaching)detach(form);if(if_block0)if_block0.d();if(if_block1)if_block1.d();/*form_binding*/ctx[5](null);mounted=false;dispose();}};}function instance$y($$self,$$props,$$invalidate){let{locale}=$$props;let{oninput}=$$props;const name=`doka-preset-select-${getUniqueId()}`;let formFileInput;const handleFileInput=e=>{// only deal with image files\nArray.from(e.target.files).filter(isImage).forEach(oninput);// reset input when done\nformFileInput.reset();};function form_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{formFileInput=$$value;$$invalidate(1,formFileInput);});}$$self.$$set=$$props=>{if(\"locale\"in $$props)$$invalidate(0,locale=$$props.locale);if(\"oninput\"in $$props)$$invalidate(4,oninput=$$props.oninput);};return[locale,formFileInput,name,handleFileInput,oninput,form_binding];}class ShapePresetSelect extends SvelteComponent{constructor(options){super();init(this,options,instance$y,create_fragment$y,safe_not_equal,{locale:0,oninput:4});}}/* src/core/ui/components/DragButton.svelte generated by Svelte v3.29.4 */function create_fragment$z(ctx){let button;let mounted;let dispose;return{c(){button=element(\"button\");attr(button,\"class\",\"DokaDragButton\");attr(button,\"title\",/*title*/ctx[1]);button.disabled=/*disabled*/ctx[2];},m(target,anchor){insert(target,button,anchor);button.innerHTML=/*html*/ctx[0];/*button_binding*/ctx[9](button);if(!mounted){dispose=listen(button,\"pointerdown\",/*handleDown*/ctx[4]);mounted=true;}},p(ctx,[dirty]){if(dirty&/*html*/1)button.innerHTML=/*html*/ctx[0];if(dirty&/*title*/2){attr(button,\"title\",/*title*/ctx[1]);}if(dirty&/*disabled*/4){button.disabled=/*disabled*/ctx[2];}},i:noop$1,o:noop$1,d(detaching){if(detaching)detach(button);/*button_binding*/ctx[9](null);mounted=false;dispose();}};}function instance$z($$self,$$props,$$invalidate){let{html}=$$props;let{title}=$$props;let{onclick}=$$props;let{disabled=false}=$$props;let{ongrab=noop}=$$props;let{ondrag=noop}=$$props;let{ondrop=noop}=$$props;let element;const isOverButton=e=>vectorDistanceSquared(downPosition,vectorCreate(e.pageX,e.pageY))<256;let downPosition;const handleDown=e=>{downPosition=vectorCreate(e.pageX,e.pageY);ongrab(e);document.documentElement.addEventListener(\"pointermove\",handleMove);document.documentElement.addEventListener(\"pointerup\",handleUp);};const handleUp=e=>{document.documentElement.removeEventListener(\"pointermove\",handleMove);document.documentElement.removeEventListener(\"pointerup\",handleUp);const upPosition=vectorCreate(e.pageX,e.pageY);// must have moved enough distance to drop\nif(vectorDistanceSquared(downPosition,upPosition)<32)return onclick(e);// cant drop in button\nif(isOverButton(e))return;// was dragging\nondrop(e);};const handleMove=e=>{// must have moved enough distance from button\nif(isOverButton(e))return;// dragging out of button\nondrag(e);};function button_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{element=$$value;$$invalidate(3,element);});}$$self.$$set=$$props=>{if(\"html\"in $$props)$$invalidate(0,html=$$props.html);if(\"title\"in $$props)$$invalidate(1,title=$$props.title);if(\"onclick\"in $$props)$$invalidate(5,onclick=$$props.onclick);if(\"disabled\"in $$props)$$invalidate(2,disabled=$$props.disabled);if(\"ongrab\"in $$props)$$invalidate(6,ongrab=$$props.ongrab);if(\"ondrag\"in $$props)$$invalidate(7,ondrag=$$props.ondrag);if(\"ondrop\"in $$props)$$invalidate(8,ondrop=$$props.ondrop);};return[html,title,disabled,element,handleDown,onclick,ongrab,ondrag,ondrop,button_binding];}class DragButton extends SvelteComponent{constructor(options){super();init(this,options,instance$z,create_fragment$z,safe_not_equal,{html:0,title:1,onclick:5,disabled:2,ongrab:6,ondrag:7,ondrop:8});}}/* src/core/ui/components/ShapePresetsList.svelte generated by Svelte v3.29.4 */function get_each_context$8(ctx,list,i){const child_ctx=ctx.slice();child_ctx[14]=list[i];return child_ctx;}// (56:4) {#each presets as preset (preset.id)}\nfunction create_each_block$8(key_1,ctx){let li;let dragbutton;let t;let didMountPresetThumb_action;let current;let mounted;let dispose;function func(...args){return(/*func*/ctx[9](/*preset*/ctx[14],...args));}function func_1(...args){return(/*func_1*/ctx[10](/*preset*/ctx[14],...args));}function func_2(...args){return(/*func_2*/ctx[11](/*preset*/ctx[14],...args));}function func_3(...args){return(/*func_3*/ctx[12](/*preset*/ctx[14],...args));}dragbutton=new DragButton({props:{onclick:func,ongrab:func_1,ondrag:func_2,ondrop:func_3,disabled:/*disabled*/ctx[1]||/*preset*/ctx[14].disabled,title:/*preset*/ctx[14].title,html:/*preset*/ctx[14].thumb}});return{key:key_1,first:null,c(){li=element(\"li\");create_component(dragbutton.$$.fragment);t=space();attr(li,\"class\",\"DokaShapePreset\");attr(li,\"style\",/*style*/ctx[6]);this.first=li;},m(target,anchor){insert(target,li,anchor);mount_component(dragbutton,li,null);append(li,t);current=true;if(!mounted){dispose=action_destroyer(didMountPresetThumb_action=/*didMountPresetThumb*/ctx[8].call(null,li,/*preset*/ctx[14]));mounted=true;}},p(new_ctx,dirty){ctx=new_ctx;const dragbutton_changes={};if(dirty&/*onclickpreset, presets*/5)dragbutton_changes.onclick=func;if(dirty&/*ongrabpreset, presets*/9)dragbutton_changes.ongrab=func_1;if(dirty&/*ondragpreset, presets*/17)dragbutton_changes.ondrag=func_2;if(dirty&/*ondroppreset, presets*/33)dragbutton_changes.ondrop=func_3;if(dirty&/*disabled, presets*/3)dragbutton_changes.disabled=/*disabled*/ctx[1]||/*preset*/ctx[14].disabled;if(dirty&/*presets*/1)dragbutton_changes.title=/*preset*/ctx[14].title;if(dirty&/*presets*/1)dragbutton_changes.html=/*preset*/ctx[14].thumb;dragbutton.$set(dragbutton_changes);if(!current||dirty&/*style*/64){attr(li,\"style\",/*style*/ctx[6]);}if(didMountPresetThumb_action&&is_function(didMountPresetThumb_action.update)&&dirty&/*presets*/1)didMountPresetThumb_action.update.call(null,/*preset*/ctx[14]);},i(local){if(current)return;transition_in(dragbutton.$$.fragment,local);current=true;},o(local){transition_out(dragbutton.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(li);destroy_component(dragbutton);mounted=false;dispose();}};}function create_fragment$A(ctx){let ul;let each_blocks=[];let each_1_lookup=new Map();let current;let each_value=/*presets*/ctx[0];const get_key=ctx=>/*preset*/ctx[14].id;for(let i=0;i<each_value.length;i+=1){let child_ctx=get_each_context$8(ctx,each_value,i);let key=get_key(child_ctx);each_1_lookup.set(key,each_blocks[i]=create_each_block$8(key,child_ctx));}return{c(){ul=element(\"ul\");for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].c();}attr(ul,\"class\",\"DokaShapePresetsList\");},m(target,anchor){insert(target,ul,anchor);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].m(ul,null);}current=true;},p(ctx,[dirty]){if(dirty&/*style, presets, onclickpreset, ongrabpreset, ondragpreset, ondroppreset, disabled*/127){const each_value=/*presets*/ctx[0];group_outros();each_blocks=update_keyed_each(each_blocks,dirty,get_key,1,ctx,each_value,each_1_lookup,ul,outro_and_destroy_block,create_each_block$8,null,get_each_context$8);check_outros();}},i(local){if(current)return;for(let i=0;i<each_value.length;i+=1){transition_in(each_blocks[i]);}current=true;},o(local){for(let i=0;i<each_blocks.length;i+=1){transition_out(each_blocks[i]);}current=false;},d(detaching){if(detaching)detach(ul);for(let i=0;i<each_blocks.length;i+=1){each_blocks[i].d();}}};}function instance$A($$self,$$props,$$invalidate){let $anim;let{presets}=$$props;let{disabled=undefined}=$$props;let{onclickpreset}=$$props;let{ongrabpreset}=$$props;let{ondragpreset}=$$props;let{ondroppreset}=$$props;const anim=tweened(0,{duration:300});component_subscribe($$self,anim,value=>$$invalidate(13,$anim=value));const didMountPresetThumb=(element,item)=>item.mount&&item.mount(element.firstChild,item);onMount(()=>anim.set(1));const func=preset=>onclickpreset(preset.id);const func_1=(preset,e)=>ongrabpreset(preset.id,e);const func_2=(preset,e)=>ondragpreset(preset.id,e);const func_3=(preset,e)=>ondroppreset(preset.id,e);$$self.$$set=$$props=>{if(\"presets\"in $$props)$$invalidate(0,presets=$$props.presets);if(\"disabled\"in $$props)$$invalidate(1,disabled=$$props.disabled);if(\"onclickpreset\"in $$props)$$invalidate(2,onclickpreset=$$props.onclickpreset);if(\"ongrabpreset\"in $$props)$$invalidate(3,ongrabpreset=$$props.ongrabpreset);if(\"ondragpreset\"in $$props)$$invalidate(4,ondragpreset=$$props.ondragpreset);if(\"ondroppreset\"in $$props)$$invalidate(5,ondroppreset=$$props.ondroppreset);};let style;$$self.$$.update=()=>{if($$self.$$.dirty&/*$anim*/8192){$$invalidate(6,style=`opacity:${$anim}`);}};return[presets,disabled,onclickpreset,ongrabpreset,ondragpreset,ondroppreset,style,anim,didMountPresetThumb,func,func_1,func_2,func_3];}class ShapePresetsList extends SvelteComponent{constructor(options){super();init(this,options,instance$A,create_fragment$A,safe_not_equal,{presets:0,disabled:1,onclickpreset:2,ongrabpreset:3,ondragpreset:4,ondroppreset:5});}}var isSVGMarkup=str=>/<svg /.test(str);/* src/core/ui/components/ShapePresetsPalette.svelte generated by Svelte v3.29.4 */function create_if_block_6$3(ctx){let shapepresetselect;let current;shapepresetselect=new ShapePresetSelect({props:{locale:/*locale*/ctx[0],oninput:/*onaddpreset*/ctx[3]}});return{c(){create_component(shapepresetselect.$$.fragment);},m(target,anchor){mount_component(shapepresetselect,target,anchor);current=true;},p(ctx,dirty){const shapepresetselect_changes={};if(dirty&/*locale*/1)shapepresetselect_changes.locale=/*locale*/ctx[0];if(dirty&/*onaddpreset*/8)shapepresetselect_changes.oninput=/*onaddpreset*/ctx[3];shapepresetselect.$set(shapepresetselect_changes);},i(local){if(current)return;transition_in(shapepresetselect.$$.fragment,local);current=true;},o(local){transition_out(shapepresetselect.$$.fragment,local);current=false;},d(detaching){destroy_component(shapepresetselect,detaching);}};}// (180:4) {#if shouldRenderPresets}\nfunction create_if_block$b(ctx){let current_block_type_index;let if_block;let if_block_anchor;let current;const if_block_creators=[create_if_block_1$b,create_else_block$3];const if_blocks=[];function select_block_type_1(ctx,dirty){if(/*shouldGroupPresets*/ctx[9])return 0;return 1;}current_block_type_index=select_block_type_1(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);return{c(){if_block.c();if_block_anchor=empty();},m(target,anchor){if_blocks[current_block_type_index].m(target,anchor);insert(target,if_block_anchor,anchor);current=true;},p(ctx,dirty){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type_1(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,()=>{if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}transition_in(if_block,1);if_block.m(if_block_anchor.parentNode,if_block_anchor);}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if_blocks[current_block_type_index].d(detaching);if(detaching)detach(if_block_anchor);}};}// (234:8) {:else}\nfunction create_else_block$3(ctx){let div;let t;let scrollable;let current;let if_block=/*enableSelectImage*/ctx[2]&&create_if_block_5$3(ctx);scrollable=new Scrollable({props:{scrollAutoCancel:/*shouldRenderPresets*/ctx[8],elasticity:/*scrollElasticity*/ctx[1],$$slots:{default:[create_default_slot_4$1]},$$scope:{ctx}}});return{c(){div=element(\"div\");if(if_block)if_block.c();t=space();create_component(scrollable.$$.fragment);attr(div,\"class\",\"DokaShapePresetsFlat\");},m(target,anchor){insert(target,div,anchor);if(if_block)if_block.m(div,null);append(div,t);mount_component(scrollable,div,null);current=true;},p(ctx,dirty){if(/*enableSelectImage*/ctx[2]){if(if_block){if_block.p(ctx,dirty);if(dirty&/*enableSelectImage*/4){transition_in(if_block,1);}}else{if_block=create_if_block_5$3(ctx);if_block.c();transition_in(if_block,1);if_block.m(div,t);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}const scrollable_changes={};if(dirty&/*shouldRenderPresets*/256)scrollable_changes.scrollAutoCancel=/*shouldRenderPresets*/ctx[8];if(dirty&/*scrollElasticity*/2)scrollable_changes.elasticity=/*scrollElasticity*/ctx[1];if(dirty&/*$$scope, presetsMapped, onaddpreset, ongrabpreset, ondragpreset, ondroppreset*/268435704){scrollable_changes.$$scope={dirty,ctx};}scrollable.$set(scrollable_changes);},i(local){if(current)return;transition_in(if_block);transition_in(scrollable.$$.fragment,local);current=true;},o(local){transition_out(if_block);transition_out(scrollable.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);if(if_block)if_block.d();destroy_component(scrollable);}};}// (183:8) {#if shouldGroupPresets}\nfunction create_if_block_1$b(ctx){let div1;let div0;let t0;let tablist;let t1;let tabpanels;let current;let if_block=/*enableSelectImage*/ctx[2]&&create_if_block_4$4(ctx);const tablist_spread_levels=[{class:\"DokaControlList\"},{tabs:/*tabs*/ctx[10]},/*tabsConfig*/ctx[13],{layout:\"compact\"}];let tablist_props={$$slots:{default:[create_default_slot_2$5,({tab})=>({27:tab}),({tab})=>tab?134217728:0]},$$scope:{ctx}};for(let i=0;i<tablist_spread_levels.length;i+=1){tablist_props=assign(tablist_props,tablist_spread_levels[i]);}tablist=new TabList({props:tablist_props});tablist.$on(\"select\",/*select_handler*/ctx[16]);const tabpanels_spread_levels=[{class:\"DokaControlPanels\"},{panelClass:\"DokaControlPanel\"},{panels:/*panels*/ctx[14]},/*tabsConfig*/ctx[13]];let tabpanels_props={$$slots:{default:[create_default_slot$a,({panel,panelIsActive})=>({25:panel,26:panelIsActive}),({panel,panelIsActive})=>(panel?33554432:0)|(panelIsActive?67108864:0)]},$$scope:{ctx}};for(let i=0;i<tabpanels_spread_levels.length;i+=1){tabpanels_props=assign(tabpanels_props,tabpanels_spread_levels[i]);}tabpanels=new TabPanels({props:tabpanels_props});return{c(){div1=element(\"div\");div0=element(\"div\");if(if_block)if_block.c();t0=space();create_component(tablist.$$.fragment);t1=space();create_component(tabpanels.$$.fragment);attr(div0,\"class\",\"DokaShapePresetsGroups\");attr(div1,\"class\",\"DokaShapePresetsGrouped\");},m(target,anchor){insert(target,div1,anchor);append(div1,div0);if(if_block)if_block.m(div0,null);append(div0,t0);mount_component(tablist,div0,null);append(div1,t1);mount_component(tabpanels,div1,null);current=true;},p(ctx,dirty){if(/*enableSelectImage*/ctx[2]){if(if_block){if_block.p(ctx,dirty);if(dirty&/*enableSelectImage*/4){transition_in(if_block,1);}}else{if_block=create_if_block_4$4(ctx);if_block.c();transition_in(if_block,1);if_block.m(div0,t0);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}const tablist_changes=dirty&/*tabs, tabsConfig*/9216?get_spread_update(tablist_spread_levels,[tablist_spread_levels[0],dirty&/*tabs*/1024&&{tabs:/*tabs*/ctx[10]},dirty&/*tabsConfig*/8192&&get_spread_object(/*tabsConfig*/ctx[13]),tablist_spread_levels[3]]):{};if(dirty&/*$$scope, tab*/402653184){tablist_changes.$$scope={dirty,ctx};}tablist.$set(tablist_changes);const tabpanels_changes=dirty&/*panels, tabsConfig*/24576?get_spread_update(tabpanels_spread_levels,[tabpanels_spread_levels[0],tabpanels_spread_levels[1],dirty&/*panels*/16384&&{panels:/*panels*/ctx[14]},dirty&/*tabsConfig*/8192&&get_spread_object(/*tabsConfig*/ctx[13])]):{};if(dirty&/*$$scope, panelIsActive, shouldRenderPresets, scrollElasticity, presetTabs, panel, onaddpreset, ongrabpreset, ondragpreset, ondroppreset*/369101178){tabpanels_changes.$$scope={dirty,ctx};}tabpanels.$set(tabpanels_changes);},i(local){if(current)return;transition_in(if_block);transition_in(tablist.$$.fragment,local);transition_in(tabpanels.$$.fragment,local);current=true;},o(local){transition_out(if_block);transition_out(tablist.$$.fragment,local);transition_out(tabpanels.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div1);if(if_block)if_block.d();destroy_component(tablist);destroy_component(tabpanels);}};}// (238:12) {#if enableSelectImage}\nfunction create_if_block_5$3(ctx){let shapepresetselect;let current;shapepresetselect=new ShapePresetSelect({props:{locale:/*locale*/ctx[0],oninput:/*onaddpreset*/ctx[3]}});return{c(){create_component(shapepresetselect.$$.fragment);},m(target,anchor){mount_component(shapepresetselect,target,anchor);current=true;},p(ctx,dirty){const shapepresetselect_changes={};if(dirty&/*locale*/1)shapepresetselect_changes.locale=/*locale*/ctx[0];if(dirty&/*onaddpreset*/8)shapepresetselect_changes.oninput=/*onaddpreset*/ctx[3];shapepresetselect.$set(shapepresetselect_changes);},i(local){if(current)return;transition_in(shapepresetselect.$$.fragment,local);current=true;},o(local){transition_out(shapepresetselect.$$.fragment,local);current=false;},d(detaching){destroy_component(shapepresetselect,detaching);}};}// (241:12) <Scrollable scrollAutoCancel={shouldRenderPresets} elasticity={scrollElasticity}>\nfunction create_default_slot_4$1(ctx){let shapepresetslist;let current;shapepresetslist=new ShapePresetsList({props:{presets:/*presetsMapped*/ctx[7],onclickpreset:/*onaddpreset*/ctx[3],ongrabpreset:/*ongrabpreset*/ctx[4],ondragpreset:/*ondragpreset*/ctx[5],ondroppreset:/*ondroppreset*/ctx[6]}});return{c(){create_component(shapepresetslist.$$.fragment);},m(target,anchor){mount_component(shapepresetslist,target,anchor);current=true;},p(ctx,dirty){const shapepresetslist_changes={};if(dirty&/*presetsMapped*/128)shapepresetslist_changes.presets=/*presetsMapped*/ctx[7];if(dirty&/*onaddpreset*/8)shapepresetslist_changes.onclickpreset=/*onaddpreset*/ctx[3];if(dirty&/*ongrabpreset*/16)shapepresetslist_changes.ongrabpreset=/*ongrabpreset*/ctx[4];if(dirty&/*ondragpreset*/32)shapepresetslist_changes.ondragpreset=/*ondragpreset*/ctx[5];if(dirty&/*ondroppreset*/64)shapepresetslist_changes.ondroppreset=/*ondroppreset*/ctx[6];shapepresetslist.$set(shapepresetslist_changes);},i(local){if(current)return;transition_in(shapepresetslist.$$.fragment,local);current=true;},o(local){transition_out(shapepresetslist.$$.fragment,local);current=false;},d(detaching){destroy_component(shapepresetslist,detaching);}};}// (188:20) {#if enableSelectImage}\nfunction create_if_block_4$4(ctx){let shapepresetselect;let current;shapepresetselect=new ShapePresetSelect({props:{locale:/*locale*/ctx[0],oninput:/*onaddpreset*/ctx[3]}});return{c(){create_component(shapepresetselect.$$.fragment);},m(target,anchor){mount_component(shapepresetselect,target,anchor);current=true;},p(ctx,dirty){const shapepresetselect_changes={};if(dirty&/*locale*/1)shapepresetselect_changes.locale=/*locale*/ctx[0];if(dirty&/*onaddpreset*/8)shapepresetselect_changes.oninput=/*onaddpreset*/ctx[3];shapepresetselect.$set(shapepresetselect_changes);},i(local){if(current)return;transition_in(shapepresetselect.$$.fragment,local);current=true;},o(local){transition_out(shapepresetselect.$$.fragment,local);current=false;},d(detaching){destroy_component(shapepresetselect,detaching);}};}// (196:24) {#if tab.icon }\nfunction create_if_block_3$4(ctx){let icon;let current;icon=new Icon({props:{$$slots:{default:[create_default_slot_3$5]},$$scope:{ctx}}});return{c(){create_component(icon.$$.fragment);},m(target,anchor){mount_component(icon,target,anchor);current=true;},p(ctx,dirty){const icon_changes={};if(dirty&/*$$scope, tab*/402653184){icon_changes.$$scope={dirty,ctx};}icon.$set(icon_changes);},i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o(local){transition_out(icon.$$.fragment,local);current=false;},d(detaching){destroy_component(icon,detaching);}};}// (197:24) <Icon>\nfunction create_default_slot_3$5(ctx){let g;let raw_value=/*tab*/ctx[27].icon+\"\";return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=raw_value;},p(ctx,dirty){if(dirty&/*tab*/134217728&&raw_value!==(raw_value=/*tab*/ctx[27].icon+\"\"))g.innerHTML=raw_value;},d(detaching){if(detaching)detach(g);}};}// (199:24) {#if !tab.hideLabel}\nfunction create_if_block_2$7(ctx){let span;let t_value=/*tab*/ctx[27].label+\"\";let t;return{c(){span=element(\"span\");t=text(t_value);},m(target,anchor){insert(target,span,anchor);append(span,t);},p(ctx,dirty){if(dirty&/*tab*/134217728&&t_value!==(t_value=/*tab*/ctx[27].label+\"\"))set_data(t,t_value);},d(detaching){if(detaching)detach(span);}};}// (192:20) <TabList class=\"DokaControlList\"                          {tabs} {...tabsConfig}                          layout=\"compact\"                         on:select={({ detail }) => tabSelected = detail} let:tab={tab}>\nfunction create_default_slot_2$5(ctx){let t;let if_block1_anchor;let current;let if_block0=/*tab*/ctx[27].icon&&create_if_block_3$4(ctx);let if_block1=!/*tab*/ctx[27].hideLabel&&create_if_block_2$7(ctx);return{c(){if(if_block0)if_block0.c();t=space();if(if_block1)if_block1.c();if_block1_anchor=empty();},m(target,anchor){if(if_block0)if_block0.m(target,anchor);insert(target,t,anchor);if(if_block1)if_block1.m(target,anchor);insert(target,if_block1_anchor,anchor);current=true;},p(ctx,dirty){if(/*tab*/ctx[27].icon){if(if_block0){if_block0.p(ctx,dirty);if(dirty&/*tab*/134217728){transition_in(if_block0,1);}}else{if_block0=create_if_block_3$4(ctx);if_block0.c();transition_in(if_block0,1);if_block0.m(t.parentNode,t);}}else if(if_block0){group_outros();transition_out(if_block0,1,1,()=>{if_block0=null;});check_outros();}if(!/*tab*/ctx[27].hideLabel){if(if_block1){if_block1.p(ctx,dirty);}else{if_block1=create_if_block_2$7(ctx);if_block1.c();if_block1.m(if_block1_anchor.parentNode,if_block1_anchor);}}else if(if_block1){if_block1.d(1);if_block1=null;}},i(local){if(current)return;transition_in(if_block0);current=true;},o(local){transition_out(if_block0);current=false;},d(detaching){if(if_block0)if_block0.d(detaching);if(detaching)detach(t);if(if_block1)if_block1.d(detaching);if(detaching)detach(if_block1_anchor);}};}// (214:16) <Scrollable                      scroll={panelIsActive ? { scrollOffset: 0, animate: false } : undefined}                     scrollAutoCancel={shouldRenderPresets}                      elasticity={scrollElasticity}>\nfunction create_default_slot_1$7(ctx){let shapepresetslist;let current;shapepresetslist=new ShapePresetsList({props:{presets:/*presetTabs*/ctx[11][/*panel*/ctx[25]].items,disabled:/*presetTabs*/ctx[11][/*panel*/ctx[25]].disabled,onclickpreset:/*onaddpreset*/ctx[3],ongrabpreset:/*ongrabpreset*/ctx[4],ondragpreset:/*ondragpreset*/ctx[5],ondroppreset:/*ondroppreset*/ctx[6]}});return{c(){create_component(shapepresetslist.$$.fragment);},m(target,anchor){mount_component(shapepresetslist,target,anchor);current=true;},p(ctx,dirty){const shapepresetslist_changes={};if(dirty&/*presetTabs, panel*/33556480)shapepresetslist_changes.presets=/*presetTabs*/ctx[11][/*panel*/ctx[25]].items;if(dirty&/*presetTabs, panel*/33556480)shapepresetslist_changes.disabled=/*presetTabs*/ctx[11][/*panel*/ctx[25]].disabled;if(dirty&/*onaddpreset*/8)shapepresetslist_changes.onclickpreset=/*onaddpreset*/ctx[3];if(dirty&/*ongrabpreset*/16)shapepresetslist_changes.ongrabpreset=/*ongrabpreset*/ctx[4];if(dirty&/*ondragpreset*/32)shapepresetslist_changes.ondragpreset=/*ondragpreset*/ctx[5];if(dirty&/*ondroppreset*/64)shapepresetslist_changes.ondroppreset=/*ondroppreset*/ctx[6];shapepresetslist.$set(shapepresetslist_changes);},i(local){if(current)return;transition_in(shapepresetslist.$$.fragment,local);current=true;},o(local){transition_out(shapepresetslist.$$.fragment,local);current=false;},d(detaching){destroy_component(shapepresetslist,detaching);}};}// (206:12) <TabPanels                  class=\"DokaControlPanels\"                  panelClass=\"DokaControlPanel\"                  {panels}                  {...tabsConfig}                  let:panel                  let:panelIsActive>\nfunction create_default_slot$a(ctx){let scrollable;let current;scrollable=new Scrollable({props:{scroll:/*panelIsActive*/ctx[26]?{scrollOffset:0,animate:false}:undefined,scrollAutoCancel:/*shouldRenderPresets*/ctx[8],elasticity:/*scrollElasticity*/ctx[1],$$slots:{default:[create_default_slot_1$7]},$$scope:{ctx}}});return{c(){create_component(scrollable.$$.fragment);},m(target,anchor){mount_component(scrollable,target,anchor);current=true;},p(ctx,dirty){const scrollable_changes={};if(dirty&/*panelIsActive*/67108864)scrollable_changes.scroll=/*panelIsActive*/ctx[26]?{scrollOffset:0,animate:false}:undefined;if(dirty&/*shouldRenderPresets*/256)scrollable_changes.scrollAutoCancel=/*shouldRenderPresets*/ctx[8];if(dirty&/*scrollElasticity*/2)scrollable_changes.elasticity=/*scrollElasticity*/ctx[1];if(dirty&/*$$scope, presetTabs, panel, onaddpreset, ongrabpreset, ondragpreset, ondroppreset*/301992056){scrollable_changes.$$scope={dirty,ctx};}scrollable.$set(scrollable_changes);},i(local){if(current)return;transition_in(scrollable.$$.fragment,local);current=true;},o(local){transition_out(scrollable.$$.fragment,local);current=false;},d(detaching){destroy_component(scrollable,detaching);}};}function create_fragment$B(ctx){let div;let current_block_type_index;let if_block;let current;const if_block_creators=[create_if_block$b,create_if_block_6$3];const if_blocks=[];function select_block_type(ctx,dirty){if(/*shouldRenderPresets*/ctx[8])return 0;if(/*enableSelectImage*/ctx[2])return 1;return-1;}if(~(current_block_type_index=select_block_type(ctx))){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);}return{c(){div=element(\"div\");if(if_block)if_block.c();attr(div,\"class\",\"DokaShapePresetsPalette\");},m(target,anchor){insert(target,div,anchor);if(~current_block_type_index){if_blocks[current_block_type_index].m(div,null);}current=true;},p(ctx,[dirty]){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if(~current_block_type_index){if_blocks[current_block_type_index].p(ctx,dirty);}}else{if(if_block){group_outros();transition_out(if_blocks[previous_block_index],1,1,()=>{if_blocks[previous_block_index]=null;});check_outros();}if(~current_block_type_index){if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}transition_in(if_block,1);if_block.m(div,null);}else{if_block=null;}}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(div);if(~current_block_type_index){if_blocks[current_block_type_index].d();}}};}function instance$B($$self,$$props,$$invalidate){let{locale}=$$props;let{presets}=$$props;let{scrollElasticity}=$$props;let{enableSelectImage=true}=$$props;let{onaddpreset=noop}=$$props;let{ongrabpreset=noop}=$$props;let{ondragpreset=noop}=$$props;let{ondroppreset=noop}=$$props;const uid=`doka-presets-${getUniqueId()}`;const isPresetGroup=item=>isArray(item)&&isString(item[0])&&isArray(item[1]);const getPresetThumb=(value,alt=\"\")=>{// could be svg\nif(isSVGMarkup(value))return value;// test if is emoji\nif(isEmoji(value))return getEmojiSVG(value,alt);// must be URL\nreturn`<img src=\"${value}\" alt=\"${alt}\"/>`;};const getAltFromSrc=src=>getFilenameWithoutExtension(getFilenameFromURL(src));const excludedStickerItemProps=[\"src\",\"alt\",\"thumb\",\"shape\",\"id\",\"mount\",\"disabled\"];const mapPreset=item=>{let id=item;let src;let shape;let shapeProps;let thumb;let alt;let mount;let disabled;// if item is a string, it's either an emoji or a URL\nif(isString(item)){// is emoji\nif(isEmoji(item)){src=item;alt=item;thumb=getPresetThumb(src,alt);}else// must be URL\n{src=item;alt=getAltFromSrc(src);thumb=getPresetThumb(src,alt);}}else{// set custom thumbnail if defined\nsrc=item.src;alt=item.alt||(isString(src)?getAltFromSrc(src):isString(item.thumb)?getAltFromSrc(item.thumb):undefined);thumb=getPresetThumb(item.thumb||src,alt);shape=item.shape;mount=item.mount;disabled=item.disabled;shapeProps=Object.keys(item).reduce((prev,curr)=>{if(excludedStickerItemProps.includes(curr))return prev;prev[curr]=item[curr];return prev;},{});}return{id,src,thumb,shape,shapeProps,alt,title:alt,mount,disabled};};const mapPresets=items=>items.map(item=>{if(isPresetGroup(item)){return _objectSpread(_objectSpread({},item[2]),{},{id:`${uid}-${item[0].toLowerCase()}`,label:item[0],items:mapPresets(item[1])});}return mapPreset(item);});const select_handler=({detail})=>$$invalidate(12,tabSelected=detail);$$self.$$set=$$props=>{if(\"locale\"in $$props)$$invalidate(0,locale=$$props.locale);if(\"presets\"in $$props)$$invalidate(15,presets=$$props.presets);if(\"scrollElasticity\"in $$props)$$invalidate(1,scrollElasticity=$$props.scrollElasticity);if(\"enableSelectImage\"in $$props)$$invalidate(2,enableSelectImage=$$props.enableSelectImage);if(\"onaddpreset\"in $$props)$$invalidate(3,onaddpreset=$$props.onaddpreset);if(\"ongrabpreset\"in $$props)$$invalidate(4,ongrabpreset=$$props.ongrabpreset);if(\"ondragpreset\"in $$props)$$invalidate(5,ondragpreset=$$props.ondragpreset);if(\"ondroppreset\"in $$props)$$invalidate(6,ondroppreset=$$props.ondroppreset);};let presetsMapped;let shouldRenderPresets;let shouldGroupPresets;let tabs;let presetTabs;let tabSelected;let tabsConfig;let panels;$$self.$$.update=()=>{if($$self.$$.dirty&/*presets*/32768){$$invalidate(7,presetsMapped=mapPresets(presets));}if($$self.$$.dirty&/*presetsMapped*/128){// const handlePresetClick = (preset, e) => onaddpreset(preset);\n// const handlePresetGrab = (preset, e) => ongrabpreset(preset, e);\n// const handlePresetDrag = (preset, e) => ondragpreset(preset, e);\n// const handlePresetDrop = (preset, e) => ondroppreset(preset, e);\n//\n// handle file input\n//\n$$invalidate(8,shouldRenderPresets=presetsMapped.length);}if($$self.$$.dirty&/*shouldRenderPresets, presetsMapped*/384){$$invalidate(9,shouldGroupPresets=shouldRenderPresets&&presetsMapped.some(preset=>!!preset.items));}if($$self.$$.dirty&/*shouldGroupPresets, presetsMapped*/640){$$invalidate(10,tabs=shouldGroupPresets&&presetsMapped);}if($$self.$$.dirty&/*shouldGroupPresets, presetsMapped*/640){$$invalidate(11,presetTabs=shouldGroupPresets&&presetsMapped.reduce((prev,curr)=>{prev[curr.id]=curr;return prev;},{}));}if($$self.$$.dirty&/*tabSelected, tabs*/5120){$$invalidate(12,tabSelected=tabSelected||tabs&&(tabs.find(tab=>!tab.disabled)||{}).id);}if($$self.$$.dirty&/*tabSelected*/4096){$$invalidate(13,tabsConfig={name:uid,selected:tabSelected});}if($$self.$$.dirty&/*tabs*/1024){$$invalidate(14,panels=tabs&&tabs.map(tab=>tab.id));}};return[locale,scrollElasticity,enableSelectImage,onaddpreset,ongrabpreset,ondragpreset,ondroppreset,presetsMapped,shouldRenderPresets,shouldGroupPresets,tabs,presetTabs,tabSelected,tabsConfig,panels,presets,select_handler];}class ShapePresetsPalette extends SvelteComponent{constructor(options){super();init(this,options,instance$B,create_fragment$B,safe_not_equal,{locale:0,presets:15,scrollElasticity:1,enableSelectImage:2,onaddpreset:3,ongrabpreset:4,ondragpreset:5,ondroppreset:6});}}var createPingDispatcher=node=>(type,data)=>{node.dispatchEvent(new CustomEvent('ping',{detail:{type,data},cancelable:true,bubbles:true}));};/* src/core/ui/components/ShapeUtil.svelte generated by Svelte v3.29.4 */function create_if_block_4$5(ctx){let shapelayouteditor;let updating_markup;let updating_ui;let current;const shapelayouteditor_spread_levels=[{locale:/*locale*/ctx[4]},{parentRect:/*$parentRect*/ctx[27]},{rootRect:/*$rootRect*/ctx[18]},{stageRect:/*$stageRect*/ctx[22]},{utilRect:/*$utilRect*/ctx[21]},{offset:/*markupOffset*/ctx[20]},{scale:/*$presentationScalar*/ctx[32]},{rotation:/*imageRotation*/ctx[12]},{opacity:/*$isActiveFraction*/ctx[26]},{enableButtonFlipVertical:/*enableButtonFlipVertical*/ctx[7]},{mapEditorPointToImagePoint:/*mapScreenPointToImagePoint*/ctx[10]},{mapImagePointToEditorPoint:/*mapImagePointToScreenPoint*/ctx[11]},{oninteractionstart:/*handleInteractionStart*/ctx[41]},{oninteractionupdate:/*handleInteractionUpdate*/ctx[42]},{oninteractionrelease:/*handleInteractionRelease*/ctx[43]},{oninteractionend:/*handleInteractionEnd*/ctx[44]},{onaddshape:/*func*/ctx[59]},{onselectshape:/*func_1*/ctx[60]},{onupdateshape:/*func_2*/ctx[61]},{onremoveshape:/*func_3*/ctx[62]},/*hooks*/ctx[14]];function shapelayouteditor_markup_binding(value){/*shapelayouteditor_markup_binding*/ctx[64].call(null,value);}function shapelayouteditor_ui_binding(value){/*shapelayouteditor_ui_binding*/ctx[65].call(null,value);}let shapelayouteditor_props={};for(let i=0;i<shapelayouteditor_spread_levels.length;i+=1){shapelayouteditor_props=assign(shapelayouteditor_props,shapelayouteditor_spread_levels[i]);}if(/*$shapes*/ctx[23]!==void 0){shapelayouteditor_props.markup=/*$shapes*/ctx[23];}if(/*$imageOverlayMarkup*/ctx[31]!==void 0){shapelayouteditor_props.ui=/*$imageOverlayMarkup*/ctx[31];}shapelayouteditor=new ShapeLayoutEditor({props:shapelayouteditor_props});/*shapelayouteditor_binding*/ctx[63](shapelayouteditor);binding_callbacks.push(()=>bind(shapelayouteditor,\"markup\",shapelayouteditor_markup_binding));binding_callbacks.push(()=>bind(shapelayouteditor,\"ui\",shapelayouteditor_ui_binding));shapelayouteditor.$on(\"measure\",/*measure_handler_1*/ctx[66]);return{c(){create_component(shapelayouteditor.$$.fragment);},m(target,anchor){mount_component(shapelayouteditor,target,anchor);current=true;},p(ctx,dirty){const shapelayouteditor_changes=dirty[0]&/*locale, $parentRect, $rootRect, $stageRect, $utilRect, markupOffset, imageRotation, $isActiveFraction, enableButtonFlipVertical, mapScreenPointToImagePoint, mapImagePointToScreenPoint, ping, hooks*/477387920|dirty[1]&/*$presentationScalar, handleInteractionStart, handleInteractionUpdate, handleInteractionRelease, handleInteractionEnd, handleMarkupUpdate*/1063938?get_spread_update(shapelayouteditor_spread_levels,[dirty[0]&/*locale*/16&&{locale:/*locale*/ctx[4]},dirty[0]&/*$parentRect*/134217728&&{parentRect:/*$parentRect*/ctx[27]},dirty[0]&/*$rootRect*/262144&&{rootRect:/*$rootRect*/ctx[18]},dirty[0]&/*$stageRect*/4194304&&{stageRect:/*$stageRect*/ctx[22]},dirty[0]&/*$utilRect*/2097152&&{utilRect:/*$utilRect*/ctx[21]},dirty[0]&/*markupOffset*/1048576&&{offset:/*markupOffset*/ctx[20]},dirty[1]&/*$presentationScalar*/2&&{scale:/*$presentationScalar*/ctx[32]},dirty[0]&/*imageRotation*/4096&&{rotation:/*imageRotation*/ctx[12]},dirty[0]&/*$isActiveFraction*/67108864&&{opacity:/*$isActiveFraction*/ctx[26]},dirty[0]&/*enableButtonFlipVertical*/128&&{enableButtonFlipVertical:/*enableButtonFlipVertical*/ctx[7]},dirty[0]&/*mapScreenPointToImagePoint*/1024&&{mapEditorPointToImagePoint:/*mapScreenPointToImagePoint*/ctx[10]},dirty[0]&/*mapImagePointToScreenPoint*/2048&&{mapImagePointToEditorPoint:/*mapImagePointToScreenPoint*/ctx[11]},dirty[1]&/*handleInteractionStart*/1024&&{oninteractionstart:/*handleInteractionStart*/ctx[41]},dirty[1]&/*handleInteractionUpdate*/2048&&{oninteractionupdate:/*handleInteractionUpdate*/ctx[42]},dirty[1]&/*handleInteractionRelease*/4096&&{oninteractionrelease:/*handleInteractionRelease*/ctx[43]},dirty[1]&/*handleInteractionEnd*/8192&&{oninteractionend:/*handleInteractionEnd*/ctx[44]},dirty[0]&/*ping*/268435456|dirty[1]&/*handleMarkupUpdate*/1048576&&{onaddshape:/*func*/ctx[59]},dirty[0]&/*ping*/268435456&&{onselectshape:/*func_1*/ctx[60]},dirty[0]&/*ping*/268435456|dirty[1]&/*handleMarkupUpdate*/1048576&&{onupdateshape:/*func_2*/ctx[61]},dirty[0]&/*ping*/268435456|dirty[1]&/*handleMarkupUpdate*/1048576&&{onremoveshape:/*func_3*/ctx[62]},dirty[0]&/*hooks*/16384&&get_spread_object(/*hooks*/ctx[14])]):{};if(!updating_markup&&dirty[0]&/*$shapes*/8388608){updating_markup=true;shapelayouteditor_changes.markup=/*$shapes*/ctx[23];add_flush_callback(()=>updating_markup=false);}if(!updating_ui&&dirty[1]&/*$imageOverlayMarkup*/1){updating_ui=true;shapelayouteditor_changes.ui=/*$imageOverlayMarkup*/ctx[31];add_flush_callback(()=>updating_ui=false);}shapelayouteditor.$set(shapelayouteditor_changes);},i(local){if(current)return;transition_in(shapelayouteditor.$$.fragment,local);current=true;},o(local){transition_out(shapelayouteditor.$$.fragment,local);current=false;},d(detaching){/*shapelayouteditor_binding*/ctx[63](null);destroy_component(shapelayouteditor,detaching);}};}// (376:4) <div bind:this={pingHub} slot=\"main\" style=\"cursor: crosshair\" use:dropable on:dropfiles={handleDropFiles}>\nfunction create_main_slot$1(ctx){let div;let dropable_action;let current;let mounted;let dispose;let if_block=/*shouldRenderShapeEditor*/ctx[19]&&create_if_block_4$5(ctx);return{c(){div=element(\"div\");if(if_block)if_block.c();attr(div,\"slot\",\"main\");set_style(div,\"cursor\",\"crosshair\");},m(target,anchor){insert(target,div,anchor);if(if_block)if_block.m(div,null);/*div_binding*/ctx[67](div);current=true;if(!mounted){dispose=[action_destroyer(dropable_action=dropable.call(null,div)),listen(div,\"dropfiles\",/*handleDropFiles*/ctx[50])];mounted=true;}},p(ctx,dirty){if(/*shouldRenderShapeEditor*/ctx[19]){if(if_block){if_block.p(ctx,dirty);if(dirty[0]&/*shouldRenderShapeEditor*/524288){transition_in(if_block,1);}}else{if_block=create_if_block_4$5(ctx);if_block.c();transition_in(if_block,1);if_block.m(div,null);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(div);if(if_block)if_block.d();/*div_binding*/ctx[67](null);mounted=false;run_all(dispose);}};}// (463:38) \nfunction create_if_block_3$5(ctx){let shapepresetspalette;let current;shapepresetspalette=new ShapePresetsPalette({props:{locale:/*locale*/ctx[4],presets:/*shapePresets*/ctx[9],enableSelectImage:/*enablePresetSelectImage*/ctx[8],onaddpreset:/*handleAddPreset*/ctx[49],ongrabpreset:/*handleGrabPreset*/ctx[46],ondragpreset:/*handleDragPreset*/ctx[47],ondroppreset:/*handleDropPreset*/ctx[48],scrollElasticity:/*computedScrollElasticity*/ctx[29]}});return{c(){create_component(shapepresetspalette.$$.fragment);},m(target,anchor){mount_component(shapepresetspalette,target,anchor);current=true;},p(ctx,dirty){const shapepresetspalette_changes={};if(dirty[0]&/*locale*/16)shapepresetspalette_changes.locale=/*locale*/ctx[4];if(dirty[0]&/*shapePresets*/512)shapepresetspalette_changes.presets=/*shapePresets*/ctx[9];if(dirty[0]&/*enablePresetSelectImage*/256)shapepresetspalette_changes.enableSelectImage=/*enablePresetSelectImage*/ctx[8];if(dirty[0]&/*computedScrollElasticity*/536870912)shapepresetspalette_changes.scrollElasticity=/*computedScrollElasticity*/ctx[29];shapepresetspalette.$set(shapepresetspalette_changes);},i(local){if(current)return;transition_in(shapepresetspalette.$$.fragment,local);current=true;},o(local){transition_out(shapepresetspalette.$$.fragment,local);current=false;},d(detaching){destroy_component(shapepresetspalette,detaching);}};}// (419:8) {#if toolsFiltered.length}\nfunction create_if_block$c(ctx){let div;let current_block_type_index;let if_block;let t;let scrollable;let current;const if_block_creators=[create_if_block_2$8,create_else_block$4];const if_blocks=[];function select_block_type_1(ctx,dirty){if(/*shouldRenderPresets*/ctx[25])return 0;return 1;}current_block_type_index=select_block_type_1(ctx);if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);scrollable=new Scrollable({props:{class:\"DokaControlListScroller\",elasticity:/*computedScrollElasticity*/ctx[29],$$slots:{default:[create_default_slot_1$8]},$$scope:{ctx}}});return{c(){div=element(\"div\");if_block.c();t=space();create_component(scrollable.$$.fragment);attr(div,\"class\",\"DokaControlPanels\");},m(target,anchor){insert(target,div,anchor);if_blocks[current_block_type_index].m(div,null);insert(target,t,anchor);mount_component(scrollable,target,anchor);current=true;},p(ctx,dirty){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type_1(ctx);if(current_block_type_index===previous_block_index){if_blocks[current_block_type_index].p(ctx,dirty);}else{group_outros();transition_out(if_blocks[previous_block_index],1,1,()=>{if_blocks[previous_block_index]=null;});check_outros();if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}transition_in(if_block,1);if_block.m(div,null);}const scrollable_changes={};if(dirty[0]&/*computedScrollElasticity*/536870912)scrollable_changes.elasticity=/*computedScrollElasticity*/ctx[29];if(dirty[0]&/*locale, toolsFiltered, toolActive*/131089|dirty[2]&/*$$scope*/268435456){scrollable_changes.$$scope={dirty,ctx};}scrollable.$set(scrollable_changes);},i(local){if(current)return;transition_in(if_block);transition_in(scrollable.$$.fragment,local);current=true;},o(local){transition_out(if_block);transition_out(scrollable.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);if_blocks[current_block_type_index].d();if(detaching)detach(t);destroy_component(scrollable,detaching);}};}// (433:16) {:else}\nfunction create_else_block$4(ctx){let div;let shapestyleeditor;let current;shapestyleeditor=new ShapeStyleEditor({props:{locale:/*locale*/ctx[4],shape:/*markupShapeSelected*/ctx[24],onchange:/*handleUpdateSelectedMarkupShape*/ctx[45],controls:/*shapeControls*/ctx[6],scrollElasticity:/*computedScrollElasticity*/ctx[29]}});return{c(){div=element(\"div\");create_component(shapestyleeditor.$$.fragment);attr(div,\"class\",\"DokaControlPanel\");},m(target,anchor){insert(target,div,anchor);mount_component(shapestyleeditor,div,null);current=true;},p(ctx,dirty){const shapestyleeditor_changes={};if(dirty[0]&/*locale*/16)shapestyleeditor_changes.locale=/*locale*/ctx[4];if(dirty[0]&/*markupShapeSelected*/16777216)shapestyleeditor_changes.shape=/*markupShapeSelected*/ctx[24];if(dirty[0]&/*shapeControls*/64)shapestyleeditor_changes.controls=/*shapeControls*/ctx[6];if(dirty[0]&/*computedScrollElasticity*/536870912)shapestyleeditor_changes.scrollElasticity=/*computedScrollElasticity*/ctx[29];shapestyleeditor.$set(shapestyleeditor_changes);},i(local){if(current)return;transition_in(shapestyleeditor.$$.fragment,local);current=true;},o(local){transition_out(shapestyleeditor.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(shapestyleeditor);}};}// (422:16) {#if shouldRenderPresets}\nfunction create_if_block_2$8(ctx){let div;let shapepresetspalette;let current;shapepresetspalette=new ShapePresetsPalette({props:{locale:/*locale*/ctx[4],presets:/*shapePresets*/ctx[9],enableSelectImage:/*enablePresetSelectImage*/ctx[8],onaddpreset:/*handleAddPreset*/ctx[49],ongrabpreset:/*handleGrabPreset*/ctx[46],ondragpreset:/*handleDragPreset*/ctx[47],ondroppreset:/*handleDropPreset*/ctx[48],scrollElasticity:/*computedScrollElasticity*/ctx[29]}});return{c(){div=element(\"div\");create_component(shapepresetspalette.$$.fragment);attr(div,\"class\",\"DokaControlPanel\");},m(target,anchor){insert(target,div,anchor);mount_component(shapepresetspalette,div,null);current=true;},p(ctx,dirty){const shapepresetspalette_changes={};if(dirty[0]&/*locale*/16)shapepresetspalette_changes.locale=/*locale*/ctx[4];if(dirty[0]&/*shapePresets*/512)shapepresetspalette_changes.presets=/*shapePresets*/ctx[9];if(dirty[0]&/*enablePresetSelectImage*/256)shapepresetspalette_changes.enableSelectImage=/*enablePresetSelectImage*/ctx[8];if(dirty[0]&/*computedScrollElasticity*/536870912)shapepresetspalette_changes.scrollElasticity=/*computedScrollElasticity*/ctx[29];shapepresetspalette.$set(shapepresetspalette_changes);},i(local){if(current)return;transition_in(shapepresetspalette.$$.fragment,local);current=true;},o(local){transition_out(shapepresetspalette.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(div);destroy_component(shapepresetspalette);}};}// (455:24) {#if option.icon}\nfunction create_if_block_1$c(ctx){let icon;let current;icon=new Icon({props:{$$slots:{default:[create_default_slot_3$6]},$$scope:{ctx}}});return{c(){create_component(icon.$$.fragment);},m(target,anchor){mount_component(icon,target,anchor);current=true;},p(ctx,dirty){const icon_changes={};if(dirty[0]&/*locale*/16|dirty[2]&/*$$scope, option*/402653184){icon_changes.$$scope={dirty,ctx};}icon.$set(icon_changes);},i(local){if(current)return;transition_in(icon.$$.fragment,local);current=true;},o(local){transition_out(icon.$$.fragment,local);current=false;},d(detaching){destroy_component(icon,detaching);}};}// (456:24) <Icon>\nfunction create_default_slot_3$6(ctx){let g;let raw_value=(isFunction(/*option*/ctx[89].icon)?/*option*/ctx[89].icon(/*locale*/ctx[4]):/*option*/ctx[89].icon)+\"\";return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=raw_value;},p(ctx,dirty){if(dirty[0]&/*locale*/16|dirty[2]&/*option*/134217728&&raw_value!==(raw_value=(isFunction(/*option*/ctx[89].icon)?/*option*/ctx[89].icon(/*locale*/ctx[4]):/*option*/ctx[89].icon)+\"\"))g.innerHTML=raw_value;},d(detaching){if(detaching)detach(g);}};}// (454:20) <div slot=\"option\">\nfunction create_option_slot$3(ctx){let div;let t0;let span;let t1_value=(isFunction(/*option*/ctx[89].label)?/*option*/ctx[89].label(/*locale*/ctx[4]):/*option*/ctx[89].label)+\"\";let t1;let current;let if_block=/*option*/ctx[89].icon&&create_if_block_1$c(ctx);return{c(){div=element(\"div\");if(if_block)if_block.c();t0=space();span=element(\"span\");t1=text(t1_value);attr(div,\"slot\",\"option\");},m(target,anchor){insert(target,div,anchor);if(if_block)if_block.m(div,null);append(div,t0);append(div,span);append(span,t1);current=true;},p(ctx,dirty){if(/*option*/ctx[89].icon){if(if_block){if_block.p(ctx,dirty);if(dirty[2]&/*option*/134217728){transition_in(if_block,1);}}else{if_block=create_if_block_1$c(ctx);if_block.c();transition_in(if_block,1);if_block.m(div,t0);}}else if(if_block){group_outros();transition_out(if_block,1,1,()=>{if_block=null;});check_outros();}if((!current||dirty[0]&/*locale*/16|dirty[2]&/*option*/134217728)&&t1_value!==(t1_value=(isFunction(/*option*/ctx[89].label)?/*option*/ctx[89].label(/*locale*/ctx[4]):/*option*/ctx[89].label)+\"\"))set_data(t1,t1_value);},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(div);if(if_block)if_block.d();}};}// (444:12) <Scrollable class=\"DokaControlListScroller\" elasticity={computedScrollElasticity}>\nfunction create_default_slot_1$8(ctx){let radiogroup;let current;radiogroup=new RadioGroup({props:{locale:/*locale*/ctx[4],class:\"DokaControlList\",optionClass:\"DokaControlListOption\",layout:\"row\",options:/*toolsFiltered*/ctx[17],selectedIndex:/*toolsFiltered*/ctx[17].findIndex(/*func_4*/ctx[68]),onchange:/*updateActiveTool*/ctx[40],$$slots:{option:[create_option_slot$3,({option})=>({89:option}),({option})=>[0,0,option?134217728:0]]},$$scope:{ctx}}});return{c(){create_component(radiogroup.$$.fragment);},m(target,anchor){mount_component(radiogroup,target,anchor);current=true;},p(ctx,dirty){const radiogroup_changes={};if(dirty[0]&/*locale*/16)radiogroup_changes.locale=/*locale*/ctx[4];if(dirty[0]&/*toolsFiltered*/131072)radiogroup_changes.options=/*toolsFiltered*/ctx[17];if(dirty[0]&/*toolsFiltered, toolActive*/131073)radiogroup_changes.selectedIndex=/*toolsFiltered*/ctx[17].findIndex(/*func_4*/ctx[68]);if(dirty[0]&/*locale*/16|dirty[2]&/*$$scope, option*/402653184){radiogroup_changes.$$scope={dirty,ctx};}radiogroup.$set(radiogroup_changes);},i(local){if(current)return;transition_in(radiogroup.$$.fragment,local);current=true;},o(local){transition_out(radiogroup.$$.fragment,local);current=false;},d(detaching){destroy_component(radiogroup,detaching);}};}// (417:4) <div slot=\"footer\" style={footerStyle}>\nfunction create_footer_slot$3(ctx){let div;let current_block_type_index;let if_block;let current;const if_block_creators=[create_if_block$c,create_if_block_3$5];const if_blocks=[];function select_block_type(ctx,dirty){if(/*toolsFiltered*/ctx[17].length)return 0;if(/*shouldRenderPresets*/ctx[25])return 1;return-1;}if(~(current_block_type_index=select_block_type(ctx))){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);}return{c(){div=element(\"div\");if(if_block)if_block.c();attr(div,\"slot\",\"footer\");attr(div,\"style\",/*footerStyle*/ctx[30]);},m(target,anchor){insert(target,div,anchor);if(~current_block_type_index){if_blocks[current_block_type_index].m(div,null);}current=true;},p(ctx,dirty){let previous_block_index=current_block_type_index;current_block_type_index=select_block_type(ctx);if(current_block_type_index===previous_block_index){if(~current_block_type_index){if_blocks[current_block_type_index].p(ctx,dirty);}}else{if(if_block){group_outros();transition_out(if_blocks[previous_block_index],1,1,()=>{if_blocks[previous_block_index]=null;});check_outros();}if(~current_block_type_index){if_block=if_blocks[current_block_type_index];if(!if_block){if_block=if_blocks[current_block_type_index]=if_block_creators[current_block_type_index](ctx);if_block.c();}transition_in(if_block,1);if_block.m(div,null);}else{if_block=null;}}if(!current||dirty[0]&/*footerStyle*/1073741824){attr(div,\"style\",/*footerStyle*/ctx[30]);}},i(local){if(current)return;transition_in(if_block);current=true;},o(local){transition_out(if_block);current=false;},d(detaching){if(detaching)detach(div);if(~current_block_type_index){if_blocks[current_block_type_index].d();}}};}// (374:0) <Util on:measure>\nfunction create_default_slot$b(ctx){let t;return{c(){t=space();},m(target,anchor){insert(target,t,anchor);},p:noop$1,i:noop$1,o:noop$1,d(detaching){if(detaching)detach(t);}};}function create_fragment$C(ctx){let util;let current;util=new Util({props:{$$slots:{default:[create_default_slot$b],footer:[create_footer_slot$3],main:[create_main_slot$1]},$$scope:{ctx}}});util.$on(\"measure\",/*measure_handler*/ctx[69]);return{c(){create_component(util.$$.fragment);},m(target,anchor){mount_component(util,target,anchor);current=true;},p(ctx,dirty){const util_changes={};if(dirty[0]&/*footerStyle, computedScrollElasticity, locale, toolsFiltered, toolActive, shapePresets, enablePresetSelectImage, shouldRenderPresets, markupShapeSelected, shapeControls, pingHub, $parentRect, $rootRect, $stageRect, $utilRect, markupOffset, imageRotation, $isActiveFraction, enableButtonFlipVertical, mapScreenPointToImagePoint, mapImagePointToScreenPoint, ping, hooks, markupEditor, $shapes, shouldRenderShapeEditor*/2147475409|dirty[1]&/*$presentationScalar, $imageOverlayMarkup*/3|dirty[2]&/*$$scope*/268435456){util_changes.$$scope={dirty,ctx};}util.$set(util_changes);},i(local){if(current)return;transition_in(util.$$.fragment,local);current=true;},o(local){transition_out(util.$$.fragment,local);current=false;},d(detaching){destroy_component(util,detaching);}};}function instance$C($$self,$$props,$$invalidate){let $rootRect;let $isActive,$$unsubscribe_isActive=noop$1,$$subscribe_isActive=()=>($$unsubscribe_isActive(),$$unsubscribe_isActive=subscribe(isActive,$$value=>$$invalidate(73,$isActive=$$value)),isActive);let $imagePreviewModifiers;let $isVisible,$$unsubscribe_isVisible=noop$1,$$subscribe_isVisible=()=>($$unsubscribe_isVisible(),$$unsubscribe_isVisible=subscribe(isVisible,$$value=>$$invalidate(76,$isVisible=$$value)),isVisible);let $utilRect;let $stageRect;let $shapes,$$unsubscribe_shapes=noop$1,$$subscribe_shapes=()=>($$unsubscribe_shapes(),$$unsubscribe_shapes=subscribe(shapes,$$value=>$$invalidate(23,$shapes=$$value)),shapes);let $isActiveFraction,$$unsubscribe_isActiveFraction=noop$1,$$subscribe_isActiveFraction=()=>($$unsubscribe_isActiveFraction(),$$unsubscribe_isActiveFraction=subscribe(isActiveFraction,$$value=>$$invalidate(26,$isActiveFraction=$$value)),isActiveFraction);let $imageCropRect;let $parentRect,$$unsubscribe_parentRect=noop$1,$$subscribe_parentRect=()=>($$unsubscribe_parentRect(),$$unsubscribe_parentRect=subscribe(parentRect,$$value=>$$invalidate(27,$parentRect=$$value)),parentRect);let $footerOffset;let $imageOverlayMarkup;let $presentationScalar;$$self.$$.on_destroy.push(()=>$$unsubscribe_isActive());$$self.$$.on_destroy.push(()=>$$unsubscribe_isVisible());$$self.$$.on_destroy.push(()=>$$unsubscribe_shapes());$$self.$$.on_destroy.push(()=>$$unsubscribe_isActiveFraction());$$self.$$.on_destroy.push(()=>$$unsubscribe_parentRect());let{isActive}=$$props;$$subscribe_isActive();let{isActiveFraction}=$$props;$$subscribe_isActiveFraction();let{isVisible}=$$props;$$subscribe_isVisible();let{stores}=$$props;let{locale={}}=$$props;let{shapes=[]}=$$props;$$subscribe_shapes();let{tools=[]}=$$props;let{toolShapes=[]}=$$props;let{toolActive=\"sharpie\"}=$$props;let{shapeControls=[]}=$$props;let{enableButtonFlipVertical=false}=$$props;let{enablePresetSelectImage=true}=$$props;let{shapePresets=[]}=$$props;let{utilKey}=$$props;let{mapScreenPointToImagePoint}=$$props;let{mapImagePointToScreenPoint}=$$props;let{imageRotation=0}=$$props;let{imageFlipX=false}=$$props;let{imageFlipY=false}=$$props;let{parentRect}=$$props;$$subscribe_parentRect();let{hooks={}}=$$props;const{history,rootRect,stageRect,utilRect,elasticityMultiplier,scrollElasticity,imageOverlayMarkup,imagePreviewModifiers,imageCropRect,presentationScalar}=stores;component_subscribe($$self,rootRect,value=>$$invalidate(18,$rootRect=value));component_subscribe($$self,stageRect,value=>$$invalidate(22,$stageRect=value));component_subscribe($$self,utilRect,value=>$$invalidate(21,$utilRect=value));component_subscribe($$self,imageOverlayMarkup,value=>$$invalidate(31,$imageOverlayMarkup=value));component_subscribe($$self,imagePreviewModifiers,value=>$$invalidate(74,$imagePreviewModifiers=value));component_subscribe($$self,imageCropRect,value=>$$invalidate(80,$imageCropRect=value));component_subscribe($$self,presentationScalar,value=>$$invalidate(32,$presentationScalar=value));const updateActiveTool=({value})=>$$invalidate(0,toolActive=value);const mapScreenEventToImagePoint=e=>mapScreenPointToImagePoint(getEventPositionInEditor(e,$rootRect));// A reference to the markup editor, we need this so we can call exported functions\nlet markupEditor;// the current tool styles\nlet markupToolStyles={};//\n// Create new shape\n//\nlet interactionHandler;const handleInteractionStart=e=>{if(toolShapes[toolActive]){const[shape,options]=toolShapes[toolActive];interactionHandler=markupEditor.createShape(_objectSpread(_objectSpread({},shape),markupToolStylesComputed),options);}else if(toolActive===\"eraser\"){interactionHandler=markupEditor.eraseShape();}else{interactionHandler=undefined;}if(!interactionHandler)return;interactionHandler.start(e);};const handleInteractionUpdate=e=>{if(!interactionHandler)return;interactionHandler.update(e);};const handleInteractionRelease=e=>{if(!interactionHandler)return;interactionHandler.release(e);};const handleInteractionEnd=e=>{if(!interactionHandler)return;interactionHandler.end(e);interactionHandler=undefined;};function handleUpdateSelectedMarkupShape(props){// remember style for when creating or styling other element\nObject.keys(props).forEach(key=>$$invalidate(70,markupToolStyles[key]=props[key],markupToolStyles));// it's possible we're only updating default styles\nif(!markupSelected)return;// update element\nmarkupEditor.updateMarkupShape(markupSelected,props);// update markup style\nhandleMarkupUpdate();}const createPreset=(preset,position)=>{// position defaults to crop center\nlet positionIsCenter=false;if(!position){positionIsCenter=true;position=rectCenter($imageCropRect);}// adjust offset if parent rect is image crop rect\nposition.x-=$parentRect.x||0;position.y-=$parentRect.y||0;// calculate new center if image is rotated\nif(imageRotation!==0){const size={width:$parentRect.width,height:$parentRect.height};sizeRotate(size,imageRotation);const dx=($parentRect.width-Math.abs(size.width))*0.5;const dy=($parentRect.height-Math.abs(size.height))*0.5;position.x+=dx;position.y+=dy;}// create shape\nconst shape=shapeCreateFromPreset(preset,$imageCropRect,(error,shape)=>{// has shape not been added?\nif(!$shapes.find(s=>s.id===shape.id))return;// something went wrong, exit!\nif(error){markupEditor.removeShape(shape);return console.error(error);}// reposition shape\nshapeContain(shape,$imageCropRect);shapeCenter(shape,position);// select if is last shape\nif($shapes[$shapes.length-1]===shape){markupEditor.selectShape(shape);}});// de-flip shape\nshape.flipX=imageFlipX;shape.flipY=imageFlipY;// de-rotate shape\nshape.rotation=imageRotation!==0?-imageRotation:0;// reposition if there's already shapes at position and shape isn't full screen\nconst shapesAlreadyAtPosition=markupEditor.getShapesAtPosition(position);const cropWidth=$imageCropRect.width;const cropHeight=$imageCropRect.height;if(positionIsCenter&&shapesAlreadyAtPosition.length&&shape.width<cropWidth&&shape.height<cropHeight){const size=Math.min(cropWidth,cropHeight)*0.1;position.x+=Math.round(-size+Math.random()*size*2);position.y+=Math.round(-size+Math.random()*size*2);}// shape update position\nif(shape.width&&shape.height){shapeContain(shape,$imageCropRect);shapeCenter(shape,position);}return shape;};const addPreset=(preset,position)=>{const{beforeAddShape=()=>true}=hooks;const shape=createPreset(preset,position);if(!beforeAddShape(shape))return;markupEditor.addShape(shape);history.write();return shape;};let dragCancelled=false;const handleGrabPreset=(preset,e)=>{dragCancelled=false;};const handleDragPreset=(preset,e)=>{if(dragCancelled)return;const{beforeAddShape=()=>true}=hooks;const position=mapScreenEventToImagePoint(e);// create or update if is inside image\nconst draft=markupEditor.getMarkupItemDraft();const inCropRect=rectContainsPoint($imageCropRect,{// adjust offset if parent rect is image crop rect\nx:position.x+($parentRect.x||0),y:position.y+($parentRect.y||0)});// remove draft if not dragging inside image\nif(draft&&!inCropRect)markupEditor.discardMarkupItemDraft();// stop here if we're not in the crop rect\nif(!inCropRect)return;// create draft shape\nif(!draft){const shape=createPreset(preset,position);if(!beforeAddShape(shape)){dragCancelled=true;e.preventDefault();return;}shapeMakeDraft(shape);markupEditor.addShape(shape);return;}// update existing draft\nmarkupEditor.updateMarkupShape(draft,{x:position.x-draft.width*0.5,y:position.y-draft.height*0.5});};const handleDropPreset=(preset,e)=>{if(dragCancelled)return;const position=mapScreenEventToImagePoint(e);// adjust offset if parent rect is image crop rect\nif(!rectContainsPoint($imageCropRect,{x:position.x+($parentRect.x||0),y:position.y+($parentRect.y||0)})){markupEditor.discardMarkupItemDraft();}else{const shape=markupEditor.confirmMarkupItemDraft();markupEditor.selectShape(shape);// update history\nhistory.write();}};const handleAddPreset=preset=>addPreset(preset);const handleAddFiles=(files,position)=>files.forEach(file=>addPreset(file,position));const handleDropFiles=e=>handleAddFiles(e.detail.files,mapScreenEventToImagePoint(e.detail.event));//\n// History\n//\nconst handleMarkupUpdate=()=>history.write();// used to fire ping events from\nlet pingHub;//\n// Footer style\n//\nconst footerOffset=spring(0);component_subscribe($$self,footerOffset,value=>$$invalidate(81,$footerOffset=value));const func=shape=>{ping(\"addshape\",shape);handleMarkupUpdate();};const func_1=shape=>{ping(\"selectshape\",shape);};const func_2=shape=>{ping(\"updateshape\",shape);handleMarkupUpdate();};const func_3=shape=>{ping(\"removeshape\",shape);handleMarkupUpdate();};function shapelayouteditor_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{markupEditor=$$value;$$invalidate(15,markupEditor);});}function shapelayouteditor_markup_binding(value){$shapes=value;shapes.set($shapes);}function shapelayouteditor_ui_binding(value){$imageOverlayMarkup=value;imageOverlayMarkup.set($imageOverlayMarkup);}function measure_handler_1(event){bubble($$self,event);}function div_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{pingHub=$$value;$$invalidate(16,pingHub);});}const func_4=option=>option[0]===toolActive;function measure_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"isActive\"in $$props)$$subscribe_isActive($$invalidate(1,isActive=$$props.isActive));if(\"isActiveFraction\"in $$props)$$subscribe_isActiveFraction($$invalidate(2,isActiveFraction=$$props.isActiveFraction));if(\"isVisible\"in $$props)$$subscribe_isVisible($$invalidate(3,isVisible=$$props.isVisible));if(\"stores\"in $$props)$$invalidate(53,stores=$$props.stores);if(\"locale\"in $$props)$$invalidate(4,locale=$$props.locale);if(\"shapes\"in $$props)$$subscribe_shapes($$invalidate(5,shapes=$$props.shapes));if(\"tools\"in $$props)$$invalidate(54,tools=$$props.tools);if(\"toolShapes\"in $$props)$$invalidate(55,toolShapes=$$props.toolShapes);if(\"toolActive\"in $$props)$$invalidate(0,toolActive=$$props.toolActive);if(\"shapeControls\"in $$props)$$invalidate(6,shapeControls=$$props.shapeControls);if(\"enableButtonFlipVertical\"in $$props)$$invalidate(7,enableButtonFlipVertical=$$props.enableButtonFlipVertical);if(\"enablePresetSelectImage\"in $$props)$$invalidate(8,enablePresetSelectImage=$$props.enablePresetSelectImage);if(\"shapePresets\"in $$props)$$invalidate(9,shapePresets=$$props.shapePresets);if(\"utilKey\"in $$props)$$invalidate(56,utilKey=$$props.utilKey);if(\"mapScreenPointToImagePoint\"in $$props)$$invalidate(10,mapScreenPointToImagePoint=$$props.mapScreenPointToImagePoint);if(\"mapImagePointToScreenPoint\"in $$props)$$invalidate(11,mapImagePointToScreenPoint=$$props.mapImagePointToScreenPoint);if(\"imageRotation\"in $$props)$$invalidate(12,imageRotation=$$props.imageRotation);if(\"imageFlipX\"in $$props)$$invalidate(57,imageFlipX=$$props.imageFlipX);if(\"imageFlipY\"in $$props)$$invalidate(58,imageFlipY=$$props.imageFlipY);if(\"parentRect\"in $$props)$$subscribe_parentRect($$invalidate(13,parentRect=$$props.parentRect));if(\"hooks\"in $$props)$$invalidate(14,hooks=$$props.hooks);};let toolsFiltered;let shouldRenderShapeEditor;let markupOffset;let markupShapeKeys;let markupSelected;let markupToolShape;let markupToolStylesComputed;let markupShapeSelected;let shouldRenderPresets;let ping;let computedScrollElasticity;let footerStyle;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*shapePresets*/512|$$self.$$.dirty[1]&/*tools*/8388608){// remove presets tool if no shape presets defined\n$$invalidate(17,toolsFiltered=shapePresets.length===0?tools.filter(tool=>tool[0]!==\"preset\"):tools);}if($$self.$$.dirty[1]&/*utilKey*/33554432|$$self.$$.dirty[2]&/*$isActive, $imagePreviewModifiers*/6144){//\n// enable seeing the markup outlines outside of the crop area\n// \nif($isActive){set_store_value(imagePreviewModifiers,$imagePreviewModifiers[utilKey]={maskMarkupOpacity:0.85},$imagePreviewModifiers);}else{delete $imagePreviewModifiers[utilKey];}}if($$self.$$.dirty[2]&/*$isVisible*/16384){$$invalidate(19,shouldRenderShapeEditor=$isVisible);}if($$self.$$.dirty[0]&/*$utilRect, $stageRect*/6291456){$$invalidate(20,markupOffset=$utilRect&&vectorCreate($stageRect.x-$utilRect.x,$stageRect.y-$utilRect.y));}if($$self.$$.dirty[0]&/*toolActive, markupEditor*/32769){// if tool is changed, deselect markup items\nif(toolActive&&markupEditor)markupEditor.blurShapes();}if($$self.$$.dirty[0]&/*shapeControls*/64){$$invalidate(77,markupShapeKeys=Object.keys(shapeControls));}if($$self.$$.dirty[0]&/*$shapes*/8388608){$$invalidate(78,markupSelected=($shapes.filter(shapeIsSelected)||[])[0]);}if($$self.$$.dirty[0]&/*toolActive*/1|$$self.$$.dirty[1]&/*toolShapes*/16777216|$$self.$$.dirty[2]&/*$isActive*/2048){$$invalidate(79,markupToolShape=$isActive&&(toolShapes[toolActive]?shapeFormat(shapeDeepCopy(toolShapes[toolActive][0])):{}));}if($$self.$$.dirty[2]&/*markupToolShape, markupShapeKeys, markupToolStyles*/164096){$$invalidate(75,markupToolStylesComputed=markupToolShape&&Object.keys(markupToolShape).reduce((prev,key)=>{const isDisableStyleProp=key===\"disableStyle\";const isStylableProp=markupShapeKeys.find(shapeKey=>shapeKey.split(\"_\").includes(key));// skip props that can't be styled, but keep all `disable` props\nif(!isDisableStyleProp&&!isStylableProp)return prev;// apply this style\nprev[key]=markupToolStyles[key]||markupToolShape[key];return prev;},{}));}if($$self.$$.dirty[2]&/*markupSelected, markupToolStylesComputed*/73728){$$invalidate(24,markupShapeSelected=markupSelected||markupToolStylesComputed);}if($$self.$$.dirty[0]&/*$isActiveFraction, toolActive, shapePresets, enablePresetSelectImage*/67109633){//\n// presets\n//\n$$invalidate(25,shouldRenderPresets=$isActiveFraction>0&&toolActive===\"preset\"&&(shapePresets.length>0||enablePresetSelectImage));}if($$self.$$.dirty[0]&/*pingHub*/65536){$$invalidate(28,ping=pingHub&&createPingDispatcher(pingHub));}if($$self.$$.dirty[2]&/*$isActive*/2048){footerOffset.set($isActive?0:20);}if($$self.$$.dirty[2]&/*$footerOffset*/524288){$$invalidate(30,footerStyle=$footerOffset?`transform: translateY(${$footerOffset}px)`:undefined);}};$$invalidate(29,computedScrollElasticity=elasticityMultiplier*scrollElasticity);return[toolActive,isActive,isActiveFraction,isVisible,locale,shapes,shapeControls,enableButtonFlipVertical,enablePresetSelectImage,shapePresets,mapScreenPointToImagePoint,mapImagePointToScreenPoint,imageRotation,parentRect,hooks,markupEditor,pingHub,toolsFiltered,$rootRect,shouldRenderShapeEditor,markupOffset,$utilRect,$stageRect,$shapes,markupShapeSelected,shouldRenderPresets,$isActiveFraction,$parentRect,ping,computedScrollElasticity,footerStyle,$imageOverlayMarkup,$presentationScalar,rootRect,stageRect,utilRect,imageOverlayMarkup,imagePreviewModifiers,imageCropRect,presentationScalar,updateActiveTool,handleInteractionStart,handleInteractionUpdate,handleInteractionRelease,handleInteractionEnd,handleUpdateSelectedMarkupShape,handleGrabPreset,handleDragPreset,handleDropPreset,handleAddPreset,handleDropFiles,handleMarkupUpdate,footerOffset,stores,tools,toolShapes,utilKey,imageFlipX,imageFlipY,func,func_1,func_2,func_3,shapelayouteditor_binding,shapelayouteditor_markup_binding,shapelayouteditor_ui_binding,measure_handler_1,div_binding,func_4,measure_handler];}class ShapeUtil extends SvelteComponent{constructor(options){super();init(this,options,instance$C,create_fragment$C,safe_not_equal,{isActive:1,isActiveFraction:2,isVisible:3,stores:53,locale:4,shapes:5,tools:54,toolShapes:55,toolActive:0,shapeControls:6,enableButtonFlipVertical:7,enablePresetSelectImage:8,shapePresets:9,utilKey:56,mapScreenPointToImagePoint:10,mapImagePointToScreenPoint:11,imageRotation:12,imageFlipX:57,imageFlipY:58,parentRect:13,hooks:14},[-1,-1,-1]);}get isActive(){return this.$$.ctx[1];}set isActive(isActive){this.$set({isActive});flush();}get isActiveFraction(){return this.$$.ctx[2];}set isActiveFraction(isActiveFraction){this.$set({isActiveFraction});flush();}get isVisible(){return this.$$.ctx[3];}set isVisible(isVisible){this.$set({isVisible});flush();}get stores(){return this.$$.ctx[53];}set stores(stores){this.$set({stores});flush();}get locale(){return this.$$.ctx[4];}set locale(locale){this.$set({locale});flush();}get shapes(){return this.$$.ctx[5];}set shapes(shapes){this.$set({shapes});flush();}get tools(){return this.$$.ctx[54];}set tools(tools){this.$set({tools});flush();}get toolShapes(){return this.$$.ctx[55];}set toolShapes(toolShapes){this.$set({toolShapes});flush();}get toolActive(){return this.$$.ctx[0];}set toolActive(toolActive){this.$set({toolActive});flush();}get shapeControls(){return this.$$.ctx[6];}set shapeControls(shapeControls){this.$set({shapeControls});flush();}get enableButtonFlipVertical(){return this.$$.ctx[7];}set enableButtonFlipVertical(enableButtonFlipVertical){this.$set({enableButtonFlipVertical});flush();}get enablePresetSelectImage(){return this.$$.ctx[8];}set enablePresetSelectImage(enablePresetSelectImage){this.$set({enablePresetSelectImage});flush();}get shapePresets(){return this.$$.ctx[9];}set shapePresets(shapePresets){this.$set({shapePresets});flush();}get utilKey(){return this.$$.ctx[56];}set utilKey(utilKey){this.$set({utilKey});flush();}get mapScreenPointToImagePoint(){return this.$$.ctx[10];}set mapScreenPointToImagePoint(mapScreenPointToImagePoint){this.$set({mapScreenPointToImagePoint});flush();}get mapImagePointToScreenPoint(){return this.$$.ctx[11];}set mapImagePointToScreenPoint(mapImagePointToScreenPoint){this.$set({mapImagePointToScreenPoint});flush();}get imageRotation(){return this.$$.ctx[12];}set imageRotation(imageRotation){this.$set({imageRotation});flush();}get imageFlipX(){return this.$$.ctx[57];}set imageFlipX(imageFlipX){this.$set({imageFlipX});flush();}get imageFlipY(){return this.$$.ctx[58];}set imageFlipY(imageFlipY){this.$set({imageFlipY});flush();}get parentRect(){return this.$$.ctx[13];}set parentRect(parentRect){this.$set({parentRect});flush();}get hooks(){return this.$$.ctx[14];}set hooks(hooks){this.$set({hooks});flush();}}var _mapImagePointToScreenPoint=(imagePoint,canvasSize,imageSize,imageOrigin,imageTranslation,imageRotation,imageScalar,imageFlipX,imageFlipY)=>{const mappedPoint=vectorClone(imagePoint);const imageCenterX=imageSize.width*0.5;const imageCenterY=imageSize.height*0.5;const canvasCenterX=canvasSize.width*0.5;const canvasCenterY=canvasSize.height*0.5;const imageOffsetX=imageTranslation.x+imageOrigin.x;const imageOffsetY=imageTranslation.y+imageOrigin.y;if(imageFlipX)mappedPoint.x=imageSize.width-mappedPoint.x;if(imageFlipY)mappedPoint.y=imageSize.height-mappedPoint.y;// rotate around image center based on if image is rotated\nconst c=Math.cos(imageRotation);const s=Math.sin(imageRotation);mappedPoint.x-=imageCenterX;mappedPoint.y-=imageCenterY;const rx=mappedPoint.x*c-mappedPoint.y*s;const ry=mappedPoint.x*s+mappedPoint.y*c;mappedPoint.x=imageCenterX+rx;mappedPoint.y=imageCenterY+ry;// position based on screen transforms\nmappedPoint.x*=imageScalar;mappedPoint.y*=imageScalar;mappedPoint.x+=canvasCenterX;mappedPoint.y+=canvasCenterY;mappedPoint.x+=imageOffsetX;mappedPoint.y+=imageOffsetY;mappedPoint.x-=imageCenterX*imageScalar;mappedPoint.y-=imageCenterY*imageScalar;const tx=(imageTranslation.x-imageOffsetX)*imageScalar;const ty=(imageTranslation.y-imageOffsetY)*imageScalar;const rtx=tx*c-ty*s;const rty=tx*s+ty*c;mappedPoint.x+=rtx;mappedPoint.y+=rty;return mappedPoint;};var _mapScreenPointToImagePoint=(screenPoint,canvasSize,imageSize,imageOrigin,imageTranslation,imageRotation,imageScalar,imageFlipX,imageFlipY)=>{const mappedPoint=vectorClone(screenPoint);const imageCenter=sizeCenter(imageSize);const canvasCenter=sizeCenter(canvasSize);const imageOffset=vectorCreate(imageTranslation.x+imageOrigin.x,imageTranslation.y+imageOrigin.y);const c=Math.cos(imageRotation);const s=Math.sin(imageRotation);mappedPoint.x-=canvasCenter.x;mappedPoint.y-=canvasCenter.y;const tx=(imageTranslation.x-imageOffset.x)*imageScalar;const ty=(imageTranslation.y-imageOffset.y)*imageScalar;const rtx=tx*c-ty*s;const rty=tx*s+ty*c;mappedPoint.x-=rtx;mappedPoint.y-=rty;mappedPoint.x-=imageOffset.x;mappedPoint.y-=imageOffset.y;mappedPoint.x/=imageScalar;mappedPoint.y/=imageScalar;const rx=mappedPoint.x*c+mappedPoint.y*s;const ry=mappedPoint.x*s-mappedPoint.y*c;mappedPoint.x=rx;mappedPoint.y=-ry;mappedPoint.x+=imageCenter.x;mappedPoint.y+=imageCenter.y;if(imageFlipX)mappedPoint.x=imageSize.width-mappedPoint.x;if(imageFlipY)mappedPoint.y=imageSize.height-mappedPoint.y;return mappedPoint;};/* src/core/ui/plugins/annotate/index.svelte generated by Svelte v3.29.4 */function create_fragment$D(ctx){let shapeutil;let current;shapeutil=new ShapeUtil({props:{stores:/*stores*/ctx[3],locale:/*locale*/ctx[4],isActive:/*isActive*/ctx[0],isActiveFraction:/*isActiveFraction*/ctx[1],isVisible:/*isVisible*/ctx[2],mapScreenPointToImagePoint:/*mapScreenPointToImagePoint*/ctx[31],mapImagePointToScreenPoint:/*mapImagePointToScreenPoint*/ctx[32],utilKey:\"annotate\",imageRotation:/*$imageRotation*/ctx[23],imageFlipX:/*$imageFlipX*/ctx[21],imageFlipY:/*$imageFlipY*/ctx[22],shapes:/*imageAnnotation*/ctx[25],tools:/*annotateTools*/ctx[8]||/*markupEditorToolbar*/ctx[5],toolShapes:/*annotateToolShapes*/ctx[9]||/*markupEditorToolStyles*/ctx[6],toolActive:/*annotateActiveTool*/ctx[11],shapeControls:/*annotateShapeControls*/ctx[10]||/*markupEditorShapeStyleControls*/ctx[7],shapePresets:/*annotatePresets*/ctx[14],enableButtonFlipVertical:/*annotateEnableButtonFlipVertical*/ctx[12],parentRect:/*imageSize*/ctx[26],enablePresetSelectImage:/*annotateEnableSelectImagePreset*/ctx[13],hooks:{willRenderShapeControls:/*willRenderShapeControls*/ctx[15],beforeAddShape:/*beforeAddShape*/ctx[16],beforeRemoveShape:/*beforeRemoveShape*/ctx[17],beforeDeselectShape:/*beforeDeselectShape*/ctx[18],beforeSelectShape:/*beforeSelectShape*/ctx[19],beforeUpdateShape:/*beforeUpdateShape*/ctx[20]}}});shapeutil.$on(\"measure\",/*measure_handler*/ctx[34]);return{c(){create_component(shapeutil.$$.fragment);},m(target,anchor){mount_component(shapeutil,target,anchor);current=true;},p(ctx,dirty){const shapeutil_changes={};if(dirty[0]&/*stores*/8)shapeutil_changes.stores=/*stores*/ctx[3];if(dirty[0]&/*locale*/16)shapeutil_changes.locale=/*locale*/ctx[4];if(dirty[0]&/*isActive*/1)shapeutil_changes.isActive=/*isActive*/ctx[0];if(dirty[0]&/*isActiveFraction*/2)shapeutil_changes.isActiveFraction=/*isActiveFraction*/ctx[1];if(dirty[0]&/*isVisible*/4)shapeutil_changes.isVisible=/*isVisible*/ctx[2];if(dirty[0]&/*$imageRotation*/8388608)shapeutil_changes.imageRotation=/*$imageRotation*/ctx[23];if(dirty[0]&/*$imageFlipX*/2097152)shapeutil_changes.imageFlipX=/*$imageFlipX*/ctx[21];if(dirty[0]&/*$imageFlipY*/4194304)shapeutil_changes.imageFlipY=/*$imageFlipY*/ctx[22];if(dirty[0]&/*annotateTools, markupEditorToolbar*/288)shapeutil_changes.tools=/*annotateTools*/ctx[8]||/*markupEditorToolbar*/ctx[5];if(dirty[0]&/*annotateToolShapes, markupEditorToolStyles*/576)shapeutil_changes.toolShapes=/*annotateToolShapes*/ctx[9]||/*markupEditorToolStyles*/ctx[6];if(dirty[0]&/*annotateActiveTool*/2048)shapeutil_changes.toolActive=/*annotateActiveTool*/ctx[11];if(dirty[0]&/*annotateShapeControls, markupEditorShapeStyleControls*/1152)shapeutil_changes.shapeControls=/*annotateShapeControls*/ctx[10]||/*markupEditorShapeStyleControls*/ctx[7];if(dirty[0]&/*annotatePresets*/16384)shapeutil_changes.shapePresets=/*annotatePresets*/ctx[14];if(dirty[0]&/*annotateEnableButtonFlipVertical*/4096)shapeutil_changes.enableButtonFlipVertical=/*annotateEnableButtonFlipVertical*/ctx[12];if(dirty[0]&/*annotateEnableSelectImagePreset*/8192)shapeutil_changes.enablePresetSelectImage=/*annotateEnableSelectImagePreset*/ctx[13];if(dirty[0]&/*willRenderShapeControls, beforeAddShape, beforeRemoveShape, beforeDeselectShape, beforeSelectShape, beforeUpdateShape*/2064384)shapeutil_changes.hooks={willRenderShapeControls:/*willRenderShapeControls*/ctx[15],beforeAddShape:/*beforeAddShape*/ctx[16],beforeRemoveShape:/*beforeRemoveShape*/ctx[17],beforeDeselectShape:/*beforeDeselectShape*/ctx[18],beforeSelectShape:/*beforeSelectShape*/ctx[19],beforeUpdateShape:/*beforeUpdateShape*/ctx[20]};shapeutil.$set(shapeutil_changes);},i(local){if(current)return;transition_in(shapeutil.$$.fragment,local);current=true;},o(local){transition_out(shapeutil.$$.fragment,local);current=false;},d(detaching){destroy_component(shapeutil,detaching);}};}function instance$D($$self,$$props,$$invalidate){let $rootRect;let $imageSize;let $imageTransforms;let $imageFlipX;let $imageFlipY;let $imageRotation;const name=\"annotate\";let{isActive}=$$props;let{isActiveFraction}=$$props;let{isVisible}=$$props;let{stores}=$$props;let{locale={}}=$$props;let{markupEditorToolbar=undefined}=$$props;let{markupEditorToolStyles=undefined}=$$props;let{markupEditorShapeStyleControls=undefined}=$$props;let{annotateTools=undefined}=$$props;let{annotateToolShapes=undefined}=$$props;let{annotateShapeControls=undefined}=$$props;let{annotateActiveTool=\"sharpie\"}=$$props;let{annotateEnableButtonFlipVertical=false}=$$props;let{annotateEnableSelectImagePreset=false}=$$props;let{annotatePresets=[]}=$$props;let{willRenderShapeControls=undefined}=$$props;let{beforeAddShape=undefined}=$$props;let{beforeRemoveShape=undefined}=$$props;let{beforeDeselectShape=undefined}=$$props;let{beforeSelectShape=undefined}=$$props;let{beforeUpdateShape=undefined}=$$props;// connect filter choice to stores\nconst{rootRect,imageAnnotation,imageSize,imageTransforms,imageRotation,imageFlipX,imageFlipY}=stores;component_subscribe($$self,rootRect,value=>$$invalidate(35,$rootRect=value));component_subscribe($$self,imageSize,value=>$$invalidate(36,$imageSize=value));component_subscribe($$self,imageTransforms,value=>$$invalidate(37,$imageTransforms=value));component_subscribe($$self,imageRotation,value=>$$invalidate(23,$imageRotation=value));component_subscribe($$self,imageFlipX,value=>$$invalidate(21,$imageFlipX=value));component_subscribe($$self,imageFlipY,value=>$$invalidate(22,$imageFlipY=value));//\n// Mapping coordinates\n//\nconst mapScreenPointToImagePoint=point=>_mapScreenPointToImagePoint(point,$rootRect,$imageSize,$imageTransforms.origin,$imageTransforms.translation,$imageTransforms.rotation.z,$imageTransforms.scale,$imageFlipX,$imageFlipY);const mapImagePointToScreenPoint=point=>_mapImagePointToScreenPoint(point,$rootRect,$imageSize,$imageTransforms.origin,$imageTransforms.translation,$imageTransforms.rotation.z,$imageTransforms.scale,$imageFlipX,$imageFlipY);function measure_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"isActive\"in $$props)$$invalidate(0,isActive=$$props.isActive);if(\"isActiveFraction\"in $$props)$$invalidate(1,isActiveFraction=$$props.isActiveFraction);if(\"isVisible\"in $$props)$$invalidate(2,isVisible=$$props.isVisible);if(\"stores\"in $$props)$$invalidate(3,stores=$$props.stores);if(\"locale\"in $$props)$$invalidate(4,locale=$$props.locale);if(\"markupEditorToolbar\"in $$props)$$invalidate(5,markupEditorToolbar=$$props.markupEditorToolbar);if(\"markupEditorToolStyles\"in $$props)$$invalidate(6,markupEditorToolStyles=$$props.markupEditorToolStyles);if(\"markupEditorShapeStyleControls\"in $$props)$$invalidate(7,markupEditorShapeStyleControls=$$props.markupEditorShapeStyleControls);if(\"annotateTools\"in $$props)$$invalidate(8,annotateTools=$$props.annotateTools);if(\"annotateToolShapes\"in $$props)$$invalidate(9,annotateToolShapes=$$props.annotateToolShapes);if(\"annotateShapeControls\"in $$props)$$invalidate(10,annotateShapeControls=$$props.annotateShapeControls);if(\"annotateActiveTool\"in $$props)$$invalidate(11,annotateActiveTool=$$props.annotateActiveTool);if(\"annotateEnableButtonFlipVertical\"in $$props)$$invalidate(12,annotateEnableButtonFlipVertical=$$props.annotateEnableButtonFlipVertical);if(\"annotateEnableSelectImagePreset\"in $$props)$$invalidate(13,annotateEnableSelectImagePreset=$$props.annotateEnableSelectImagePreset);if(\"annotatePresets\"in $$props)$$invalidate(14,annotatePresets=$$props.annotatePresets);if(\"willRenderShapeControls\"in $$props)$$invalidate(15,willRenderShapeControls=$$props.willRenderShapeControls);if(\"beforeAddShape\"in $$props)$$invalidate(16,beforeAddShape=$$props.beforeAddShape);if(\"beforeRemoveShape\"in $$props)$$invalidate(17,beforeRemoveShape=$$props.beforeRemoveShape);if(\"beforeDeselectShape\"in $$props)$$invalidate(18,beforeDeselectShape=$$props.beforeDeselectShape);if(\"beforeSelectShape\"in $$props)$$invalidate(19,beforeSelectShape=$$props.beforeSelectShape);if(\"beforeUpdateShape\"in $$props)$$invalidate(20,beforeUpdateShape=$$props.beforeUpdateShape);};return[isActive,isActiveFraction,isVisible,stores,locale,markupEditorToolbar,markupEditorToolStyles,markupEditorShapeStyleControls,annotateTools,annotateToolShapes,annotateShapeControls,annotateActiveTool,annotateEnableButtonFlipVertical,annotateEnableSelectImagePreset,annotatePresets,willRenderShapeControls,beforeAddShape,beforeRemoveShape,beforeDeselectShape,beforeSelectShape,beforeUpdateShape,$imageFlipX,$imageFlipY,$imageRotation,rootRect,imageAnnotation,imageSize,imageTransforms,imageRotation,imageFlipX,imageFlipY,mapScreenPointToImagePoint,mapImagePointToScreenPoint,name,measure_handler];}class Annotate extends SvelteComponent{constructor(options){super();init(this,options,instance$D,create_fragment$D,safe_not_equal,{name:33,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,markupEditorToolbar:5,markupEditorToolStyles:6,markupEditorShapeStyleControls:7,annotateTools:8,annotateToolShapes:9,annotateShapeControls:10,annotateActiveTool:11,annotateEnableButtonFlipVertical:12,annotateEnableSelectImagePreset:13,annotatePresets:14,willRenderShapeControls:15,beforeAddShape:16,beforeRemoveShape:17,beforeDeselectShape:18,beforeSelectShape:19,beforeUpdateShape:20},[-1,-1]);}get name(){return this.$$.ctx[33];}get isActive(){return this.$$.ctx[0];}set isActive(isActive){this.$set({isActive});flush();}get isActiveFraction(){return this.$$.ctx[1];}set isActiveFraction(isActiveFraction){this.$set({isActiveFraction});flush();}get isVisible(){return this.$$.ctx[2];}set isVisible(isVisible){this.$set({isVisible});flush();}get stores(){return this.$$.ctx[3];}set stores(stores){this.$set({stores});flush();}get locale(){return this.$$.ctx[4];}set locale(locale){this.$set({locale});flush();}get markupEditorToolbar(){return this.$$.ctx[5];}set markupEditorToolbar(markupEditorToolbar){this.$set({markupEditorToolbar});flush();}get markupEditorToolStyles(){return this.$$.ctx[6];}set markupEditorToolStyles(markupEditorToolStyles){this.$set({markupEditorToolStyles});flush();}get markupEditorShapeStyleControls(){return this.$$.ctx[7];}set markupEditorShapeStyleControls(markupEditorShapeStyleControls){this.$set({markupEditorShapeStyleControls});flush();}get annotateTools(){return this.$$.ctx[8];}set annotateTools(annotateTools){this.$set({annotateTools});flush();}get annotateToolShapes(){return this.$$.ctx[9];}set annotateToolShapes(annotateToolShapes){this.$set({annotateToolShapes});flush();}get annotateShapeControls(){return this.$$.ctx[10];}set annotateShapeControls(annotateShapeControls){this.$set({annotateShapeControls});flush();}get annotateActiveTool(){return this.$$.ctx[11];}set annotateActiveTool(annotateActiveTool){this.$set({annotateActiveTool});flush();}get annotateEnableButtonFlipVertical(){return this.$$.ctx[12];}set annotateEnableButtonFlipVertical(annotateEnableButtonFlipVertical){this.$set({annotateEnableButtonFlipVertical});flush();}get annotateEnableSelectImagePreset(){return this.$$.ctx[13];}set annotateEnableSelectImagePreset(annotateEnableSelectImagePreset){this.$set({annotateEnableSelectImagePreset});flush();}get annotatePresets(){return this.$$.ctx[14];}set annotatePresets(annotatePresets){this.$set({annotatePresets});flush();}get willRenderShapeControls(){return this.$$.ctx[15];}set willRenderShapeControls(willRenderShapeControls){this.$set({willRenderShapeControls});flush();}get beforeAddShape(){return this.$$.ctx[16];}set beforeAddShape(beforeAddShape){this.$set({beforeAddShape});flush();}get beforeRemoveShape(){return this.$$.ctx[17];}set beforeRemoveShape(beforeRemoveShape){this.$set({beforeRemoveShape});flush();}get beforeDeselectShape(){return this.$$.ctx[18];}set beforeDeselectShape(beforeDeselectShape){this.$set({beforeDeselectShape});flush();}get beforeSelectShape(){return this.$$.ctx[19];}set beforeSelectShape(beforeSelectShape){this.$set({beforeSelectShape});flush();}get beforeUpdateShape(){return this.$$.ctx[20];}set beforeUpdateShape(beforeUpdateShape){this.$set({beforeUpdateShape});flush();}}// @ts-ignore\nvar index$3={util:['annotate',Annotate]};/* src/core/ui/plugins/decorate/index.svelte generated by Svelte v3.29.4 */function create_fragment$E(ctx){let shapeutil;let current;shapeutil=new ShapeUtil({props:{stores:/*stores*/ctx[3],locale:/*locale*/ctx[4],isActive:/*isActive*/ctx[0],isActiveFraction:/*isActiveFraction*/ctx[1],isVisible:/*isVisible*/ctx[2],mapScreenPointToImagePoint:/*mapScreenPointToImagePoint*/ctx[24],mapImagePointToScreenPoint:/*mapImagePointToScreenPoint*/ctx[25],utilKey:\"decorate\",shapes:/*imageDecoration*/ctx[21],tools:/*decorateTools*/ctx[8]||/*markupEditorToolbar*/ctx[5],toolShapes:/*decorateToolShapes*/ctx[9]||/*markupEditorToolStyles*/ctx[6],toolActive:/*decorateActiveTool*/ctx[11],shapeControls:/*decorateShapeControls*/ctx[10]||/*markupEditorShapeStyleControls*/ctx[7],shapePresets:/*decoratePresets*/ctx[13],enableButtonFlipVertical:/*decorateEnableButtonFlipVertical*/ctx[12],parentRect:/*imageCropRect*/ctx[20],hooks:{willRenderShapeControls:/*willRenderShapeControls*/ctx[14],beforeAddShape:/*beforeAddShape*/ctx[15],beforeRemoveShape:/*beforeRemoveShape*/ctx[16],beforeDeselectShape:/*beforeDeselectShape*/ctx[17],beforeSelectShape:/*beforeSelectShape*/ctx[18],beforeUpdateShape:/*beforeUpdateShape*/ctx[19]}}});shapeutil.$on(\"measure\",/*measure_handler*/ctx[28]);return{c(){create_component(shapeutil.$$.fragment);},m(target,anchor){mount_component(shapeutil,target,anchor);current=true;},p(ctx,[dirty]){const shapeutil_changes={};if(dirty&/*stores*/8)shapeutil_changes.stores=/*stores*/ctx[3];if(dirty&/*locale*/16)shapeutil_changes.locale=/*locale*/ctx[4];if(dirty&/*isActive*/1)shapeutil_changes.isActive=/*isActive*/ctx[0];if(dirty&/*isActiveFraction*/2)shapeutil_changes.isActiveFraction=/*isActiveFraction*/ctx[1];if(dirty&/*isVisible*/4)shapeutil_changes.isVisible=/*isVisible*/ctx[2];if(dirty&/*decorateTools, markupEditorToolbar*/288)shapeutil_changes.tools=/*decorateTools*/ctx[8]||/*markupEditorToolbar*/ctx[5];if(dirty&/*decorateToolShapes, markupEditorToolStyles*/576)shapeutil_changes.toolShapes=/*decorateToolShapes*/ctx[9]||/*markupEditorToolStyles*/ctx[6];if(dirty&/*decorateActiveTool*/2048)shapeutil_changes.toolActive=/*decorateActiveTool*/ctx[11];if(dirty&/*decorateShapeControls, markupEditorShapeStyleControls*/1152)shapeutil_changes.shapeControls=/*decorateShapeControls*/ctx[10]||/*markupEditorShapeStyleControls*/ctx[7];if(dirty&/*decoratePresets*/8192)shapeutil_changes.shapePresets=/*decoratePresets*/ctx[13];if(dirty&/*decorateEnableButtonFlipVertical*/4096)shapeutil_changes.enableButtonFlipVertical=/*decorateEnableButtonFlipVertical*/ctx[12];if(dirty&/*willRenderShapeControls, beforeAddShape, beforeRemoveShape, beforeDeselectShape, beforeSelectShape, beforeUpdateShape*/1032192)shapeutil_changes.hooks={willRenderShapeControls:/*willRenderShapeControls*/ctx[14],beforeAddShape:/*beforeAddShape*/ctx[15],beforeRemoveShape:/*beforeRemoveShape*/ctx[16],beforeDeselectShape:/*beforeDeselectShape*/ctx[17],beforeSelectShape:/*beforeSelectShape*/ctx[18],beforeUpdateShape:/*beforeUpdateShape*/ctx[19]};shapeutil.$set(shapeutil_changes);},i(local){if(current)return;transition_in(shapeutil.$$.fragment,local);current=true;},o(local){transition_out(shapeutil.$$.fragment,local);current=false;},d(detaching){destroy_component(shapeutil,detaching);}};}function instance$E($$self,$$props,$$invalidate){let $imageSelectionRectPresentation;let $presentationScalar;const name=\"decorate\";let{isActive}=$$props;let{isActiveFraction}=$$props;let{isVisible}=$$props;let{stores}=$$props;let{locale={}}=$$props;let{markupEditorToolbar=undefined}=$$props;let{markupEditorToolStyles=undefined}=$$props;let{markupEditorShapeStyleControls=undefined}=$$props;let{decorateTools=undefined}=$$props;let{decorateToolShapes=undefined}=$$props;let{decorateShapeControls=undefined}=$$props;let{decorateActiveTool=\"sharpie\"}=$$props;let{decorateEnableButtonFlipVertical=false}=$$props;let{decorateEnableSelectImagePreset=false}=$$props;let{decoratePresets=[]}=$$props;let{willRenderShapeControls=undefined}=$$props;let{beforeAddShape=undefined}=$$props;let{beforeRemoveShape=undefined}=$$props;let{beforeDeselectShape=undefined}=$$props;let{beforeSelectShape=undefined}=$$props;let{beforeUpdateShape=undefined}=$$props;const{imageCropRect,imageDecoration,imageSelectionRectPresentation,presentationScalar}=stores;component_subscribe($$self,imageSelectionRectPresentation,value=>$$invalidate(29,$imageSelectionRectPresentation=value));component_subscribe($$self,presentationScalar,value=>$$invalidate(30,$presentationScalar=value));const mapScreenPointToImagePoint=screenPoint=>{const mappedPoint=vectorClone(screenPoint);mappedPoint.x-=$imageSelectionRectPresentation.x;mappedPoint.y-=$imageSelectionRectPresentation.y;mappedPoint.x/=$presentationScalar;mappedPoint.y/=$presentationScalar;return mappedPoint;};const mapImagePointToScreenPoint=imagePoint=>{const mappedPoint=vectorClone(imagePoint);mappedPoint.x*=$presentationScalar;mappedPoint.y*=$presentationScalar;mappedPoint.x+=$imageSelectionRectPresentation.x;mappedPoint.y+=$imageSelectionRectPresentation.y;return mappedPoint;};function measure_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"isActive\"in $$props)$$invalidate(0,isActive=$$props.isActive);if(\"isActiveFraction\"in $$props)$$invalidate(1,isActiveFraction=$$props.isActiveFraction);if(\"isVisible\"in $$props)$$invalidate(2,isVisible=$$props.isVisible);if(\"stores\"in $$props)$$invalidate(3,stores=$$props.stores);if(\"locale\"in $$props)$$invalidate(4,locale=$$props.locale);if(\"markupEditorToolbar\"in $$props)$$invalidate(5,markupEditorToolbar=$$props.markupEditorToolbar);if(\"markupEditorToolStyles\"in $$props)$$invalidate(6,markupEditorToolStyles=$$props.markupEditorToolStyles);if(\"markupEditorShapeStyleControls\"in $$props)$$invalidate(7,markupEditorShapeStyleControls=$$props.markupEditorShapeStyleControls);if(\"decorateTools\"in $$props)$$invalidate(8,decorateTools=$$props.decorateTools);if(\"decorateToolShapes\"in $$props)$$invalidate(9,decorateToolShapes=$$props.decorateToolShapes);if(\"decorateShapeControls\"in $$props)$$invalidate(10,decorateShapeControls=$$props.decorateShapeControls);if(\"decorateActiveTool\"in $$props)$$invalidate(11,decorateActiveTool=$$props.decorateActiveTool);if(\"decorateEnableButtonFlipVertical\"in $$props)$$invalidate(12,decorateEnableButtonFlipVertical=$$props.decorateEnableButtonFlipVertical);if(\"decorateEnableSelectImagePreset\"in $$props)$$invalidate(27,decorateEnableSelectImagePreset=$$props.decorateEnableSelectImagePreset);if(\"decoratePresets\"in $$props)$$invalidate(13,decoratePresets=$$props.decoratePresets);if(\"willRenderShapeControls\"in $$props)$$invalidate(14,willRenderShapeControls=$$props.willRenderShapeControls);if(\"beforeAddShape\"in $$props)$$invalidate(15,beforeAddShape=$$props.beforeAddShape);if(\"beforeRemoveShape\"in $$props)$$invalidate(16,beforeRemoveShape=$$props.beforeRemoveShape);if(\"beforeDeselectShape\"in $$props)$$invalidate(17,beforeDeselectShape=$$props.beforeDeselectShape);if(\"beforeSelectShape\"in $$props)$$invalidate(18,beforeSelectShape=$$props.beforeSelectShape);if(\"beforeUpdateShape\"in $$props)$$invalidate(19,beforeUpdateShape=$$props.beforeUpdateShape);};return[isActive,isActiveFraction,isVisible,stores,locale,markupEditorToolbar,markupEditorToolStyles,markupEditorShapeStyleControls,decorateTools,decorateToolShapes,decorateShapeControls,decorateActiveTool,decorateEnableButtonFlipVertical,decoratePresets,willRenderShapeControls,beforeAddShape,beforeRemoveShape,beforeDeselectShape,beforeSelectShape,beforeUpdateShape,imageCropRect,imageDecoration,imageSelectionRectPresentation,presentationScalar,mapScreenPointToImagePoint,mapImagePointToScreenPoint,name,decorateEnableSelectImagePreset,measure_handler];}class Decorate extends SvelteComponent{constructor(options){super();init(this,options,instance$E,create_fragment$E,safe_not_equal,{name:26,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,markupEditorToolbar:5,markupEditorToolStyles:6,markupEditorShapeStyleControls:7,decorateTools:8,decorateToolShapes:9,decorateShapeControls:10,decorateActiveTool:11,decorateEnableButtonFlipVertical:12,decorateEnableSelectImagePreset:27,decoratePresets:13,willRenderShapeControls:14,beforeAddShape:15,beforeRemoveShape:16,beforeDeselectShape:17,beforeSelectShape:18,beforeUpdateShape:19});}get name(){return this.$$.ctx[26];}get isActive(){return this.$$.ctx[0];}set isActive(isActive){this.$set({isActive});flush();}get isActiveFraction(){return this.$$.ctx[1];}set isActiveFraction(isActiveFraction){this.$set({isActiveFraction});flush();}get isVisible(){return this.$$.ctx[2];}set isVisible(isVisible){this.$set({isVisible});flush();}get stores(){return this.$$.ctx[3];}set stores(stores){this.$set({stores});flush();}get locale(){return this.$$.ctx[4];}set locale(locale){this.$set({locale});flush();}get markupEditorToolbar(){return this.$$.ctx[5];}set markupEditorToolbar(markupEditorToolbar){this.$set({markupEditorToolbar});flush();}get markupEditorToolStyles(){return this.$$.ctx[6];}set markupEditorToolStyles(markupEditorToolStyles){this.$set({markupEditorToolStyles});flush();}get markupEditorShapeStyleControls(){return this.$$.ctx[7];}set markupEditorShapeStyleControls(markupEditorShapeStyleControls){this.$set({markupEditorShapeStyleControls});flush();}get decorateTools(){return this.$$.ctx[8];}set decorateTools(decorateTools){this.$set({decorateTools});flush();}get decorateToolShapes(){return this.$$.ctx[9];}set decorateToolShapes(decorateToolShapes){this.$set({decorateToolShapes});flush();}get decorateShapeControls(){return this.$$.ctx[10];}set decorateShapeControls(decorateShapeControls){this.$set({decorateShapeControls});flush();}get decorateActiveTool(){return this.$$.ctx[11];}set decorateActiveTool(decorateActiveTool){this.$set({decorateActiveTool});flush();}get decorateEnableButtonFlipVertical(){return this.$$.ctx[12];}set decorateEnableButtonFlipVertical(decorateEnableButtonFlipVertical){this.$set({decorateEnableButtonFlipVertical});flush();}get decorateEnableSelectImagePreset(){return this.$$.ctx[27];}set decorateEnableSelectImagePreset(decorateEnableSelectImagePreset){this.$set({decorateEnableSelectImagePreset});flush();}get decoratePresets(){return this.$$.ctx[13];}set decoratePresets(decoratePresets){this.$set({decoratePresets});flush();}get willRenderShapeControls(){return this.$$.ctx[14];}set willRenderShapeControls(willRenderShapeControls){this.$set({willRenderShapeControls});flush();}get beforeAddShape(){return this.$$.ctx[15];}set beforeAddShape(beforeAddShape){this.$set({beforeAddShape});flush();}get beforeRemoveShape(){return this.$$.ctx[16];}set beforeRemoveShape(beforeRemoveShape){this.$set({beforeRemoveShape});flush();}get beforeDeselectShape(){return this.$$.ctx[17];}set beforeDeselectShape(beforeDeselectShape){this.$set({beforeDeselectShape});flush();}get beforeSelectShape(){return this.$$.ctx[18];}set beforeSelectShape(beforeSelectShape){this.$set({beforeSelectShape});flush();}get beforeUpdateShape(){return this.$$.ctx[19];}set beforeUpdateShape(beforeUpdateShape){this.$set({beforeUpdateShape});flush();}}// @ts-ignore\nvar index$4={util:['decorate',Decorate]};/* src/core/ui/plugins/sticker/index.svelte generated by Svelte v3.29.4 */function create_fragment$F(ctx){let shapeutil;let current;shapeutil=new ShapeUtil({props:{stores:/*stores*/ctx[3],locale:/*locale*/ctx[4],isActive:/*isActive*/ctx[0],isActiveFraction:/*isActiveFraction*/ctx[1],isVisible:/*isVisible*/ctx[2],mapScreenPointToImagePoint:/*mapScreenPointToImagePoint*/ctx[29],mapImagePointToScreenPoint:/*mapImagePointToScreenPoint*/ctx[30],utilKey:\"sticker\",shapePresets:/*stickers*/ctx[5],shapes:/*stickerStickToImage*/ctx[6]?/*imageAnnotation*/ctx[22]:/*imageDecoration*/ctx[23],toolActive:\"preset\",imageFlipX:/*stickerStickToImage*/ctx[6]?/*$imageFlipX*/ctx[15]:false,imageFlipY:/*stickerStickToImage*/ctx[6]?/*$imageFlipY*/ctx[16]:false,imageRotation:/*stickerStickToImage*/ctx[6]?/*$imageRotation*/ctx[17]:0,parentRect:/*stickerStickToImage*/ctx[6]?/*imageSize*/ctx[24]:/*imageCropRect*/ctx[20],enablePresetSelectImage:/*stickerEnableSelectImage*/ctx[7],enableButtonFlipVertical:/*stickersEnableButtonFlipVertical*/ctx[8],hooks:{willRenderShapeControls:/*willRenderShapeControls*/ctx[9],beforeAddShape:/*beforeAddShape*/ctx[10],beforeRemoveShape:/*beforeRemoveShape*/ctx[11],beforeDeselectShape:/*beforeDeselectShape*/ctx[12],beforeSelectShape:/*beforeSelectShape*/ctx[13],beforeUpdateShape:/*beforeUpdateShape*/ctx[14]}}});shapeutil.$on(\"measure\",/*measure_handler*/ctx[32]);return{c(){create_component(shapeutil.$$.fragment);},m(target,anchor){mount_component(shapeutil,target,anchor);current=true;},p(ctx,dirty){const shapeutil_changes={};if(dirty[0]&/*stores*/8)shapeutil_changes.stores=/*stores*/ctx[3];if(dirty[0]&/*locale*/16)shapeutil_changes.locale=/*locale*/ctx[4];if(dirty[0]&/*isActive*/1)shapeutil_changes.isActive=/*isActive*/ctx[0];if(dirty[0]&/*isActiveFraction*/2)shapeutil_changes.isActiveFraction=/*isActiveFraction*/ctx[1];if(dirty[0]&/*isVisible*/4)shapeutil_changes.isVisible=/*isVisible*/ctx[2];if(dirty[0]&/*stickers*/32)shapeutil_changes.shapePresets=/*stickers*/ctx[5];if(dirty[0]&/*stickerStickToImage*/64)shapeutil_changes.shapes=/*stickerStickToImage*/ctx[6]?/*imageAnnotation*/ctx[22]:/*imageDecoration*/ctx[23];if(dirty[0]&/*stickerStickToImage, $imageFlipX*/32832)shapeutil_changes.imageFlipX=/*stickerStickToImage*/ctx[6]?/*$imageFlipX*/ctx[15]:false;if(dirty[0]&/*stickerStickToImage, $imageFlipY*/65600)shapeutil_changes.imageFlipY=/*stickerStickToImage*/ctx[6]?/*$imageFlipY*/ctx[16]:false;if(dirty[0]&/*stickerStickToImage, $imageRotation*/131136)shapeutil_changes.imageRotation=/*stickerStickToImage*/ctx[6]?/*$imageRotation*/ctx[17]:0;if(dirty[0]&/*stickerStickToImage*/64)shapeutil_changes.parentRect=/*stickerStickToImage*/ctx[6]?/*imageSize*/ctx[24]:/*imageCropRect*/ctx[20];if(dirty[0]&/*stickerEnableSelectImage*/128)shapeutil_changes.enablePresetSelectImage=/*stickerEnableSelectImage*/ctx[7];if(dirty[0]&/*stickersEnableButtonFlipVertical*/256)shapeutil_changes.enableButtonFlipVertical=/*stickersEnableButtonFlipVertical*/ctx[8];if(dirty[0]&/*willRenderShapeControls, beforeAddShape, beforeRemoveShape, beforeDeselectShape, beforeSelectShape, beforeUpdateShape*/32256)shapeutil_changes.hooks={willRenderShapeControls:/*willRenderShapeControls*/ctx[9],beforeAddShape:/*beforeAddShape*/ctx[10],beforeRemoveShape:/*beforeRemoveShape*/ctx[11],beforeDeselectShape:/*beforeDeselectShape*/ctx[12],beforeSelectShape:/*beforeSelectShape*/ctx[13],beforeUpdateShape:/*beforeUpdateShape*/ctx[14]};shapeutil.$set(shapeutil_changes);},i(local){if(current)return;transition_in(shapeutil.$$.fragment,local);current=true;},o(local){transition_out(shapeutil.$$.fragment,local);current=false;},d(detaching){destroy_component(shapeutil,detaching);}};}function instance$F($$self,$$props,$$invalidate){let $rootRect;let $imageSize;let $imageTransforms;let $imageFlipX;let $imageFlipY;let $imageSelectionRectPresentation;let $presentationScalar;let $imageRotation;const name=\"sticker\";let{isActive}=$$props;let{isActiveFraction}=$$props;let{isVisible}=$$props;let{stores}=$$props;let{locale={}}=$$props;let{stickers=[]}=$$props;let{stickerStickToImage=false}=$$props;let{stickerEnableSelectImage=true}=$$props;let{stickersEnableButtonFlipVertical=false}=$$props;let{willRenderShapeControls=undefined}=$$props;let{beforeAddShape=undefined}=$$props;let{beforeRemoveShape=undefined}=$$props;let{beforeDeselectShape=undefined}=$$props;let{beforeSelectShape=undefined}=$$props;let{beforeUpdateShape=undefined}=$$props;// connect filter choice to stores\nconst{presentationScalar,rootRect,imageCropRect,imageSelectionRectPresentation,imageAnnotation,imageDecoration,imageSize,imageTransforms,imageRotation,imageFlipX,imageFlipY}=stores;component_subscribe($$self,presentationScalar,value=>$$invalidate(37,$presentationScalar=value));component_subscribe($$self,rootRect,value=>$$invalidate(33,$rootRect=value));component_subscribe($$self,imageSelectionRectPresentation,value=>$$invalidate(36,$imageSelectionRectPresentation=value));component_subscribe($$self,imageSize,value=>$$invalidate(34,$imageSize=value));component_subscribe($$self,imageTransforms,value=>$$invalidate(35,$imageTransforms=value));component_subscribe($$self,imageRotation,value=>$$invalidate(17,$imageRotation=value));component_subscribe($$self,imageFlipX,value=>$$invalidate(15,$imageFlipX=value));component_subscribe($$self,imageFlipY,value=>$$invalidate(16,$imageFlipY=value));//\n// Mapping coordinates\n//\nconst mapScreenPointToImagePoint=stickerStickToImage?point=>_mapScreenPointToImagePoint(point,$rootRect,$imageSize,$imageTransforms.origin,$imageTransforms.translation,$imageTransforms.rotation.z,$imageTransforms.scale,$imageFlipX,$imageFlipY):point=>{const mappedPoint=vectorClone(point);mappedPoint.x-=$imageSelectionRectPresentation.x;mappedPoint.y-=$imageSelectionRectPresentation.y;mappedPoint.x/=$presentationScalar;mappedPoint.y/=$presentationScalar;return mappedPoint;};const mapImagePointToScreenPoint=stickerStickToImage?point=>_mapImagePointToScreenPoint(point,$rootRect,$imageSize,$imageTransforms.origin,$imageTransforms.translation,$imageTransforms.rotation.z,$imageTransforms.scale,$imageFlipX,$imageFlipY):point=>{const mappedPoint=vectorClone(point);mappedPoint.x*=$presentationScalar;mappedPoint.y*=$presentationScalar;mappedPoint.x+=$imageSelectionRectPresentation.x;mappedPoint.y+=$imageSelectionRectPresentation.y;return mappedPoint;};function measure_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"isActive\"in $$props)$$invalidate(0,isActive=$$props.isActive);if(\"isActiveFraction\"in $$props)$$invalidate(1,isActiveFraction=$$props.isActiveFraction);if(\"isVisible\"in $$props)$$invalidate(2,isVisible=$$props.isVisible);if(\"stores\"in $$props)$$invalidate(3,stores=$$props.stores);if(\"locale\"in $$props)$$invalidate(4,locale=$$props.locale);if(\"stickers\"in $$props)$$invalidate(5,stickers=$$props.stickers);if(\"stickerStickToImage\"in $$props)$$invalidate(6,stickerStickToImage=$$props.stickerStickToImage);if(\"stickerEnableSelectImage\"in $$props)$$invalidate(7,stickerEnableSelectImage=$$props.stickerEnableSelectImage);if(\"stickersEnableButtonFlipVertical\"in $$props)$$invalidate(8,stickersEnableButtonFlipVertical=$$props.stickersEnableButtonFlipVertical);if(\"willRenderShapeControls\"in $$props)$$invalidate(9,willRenderShapeControls=$$props.willRenderShapeControls);if(\"beforeAddShape\"in $$props)$$invalidate(10,beforeAddShape=$$props.beforeAddShape);if(\"beforeRemoveShape\"in $$props)$$invalidate(11,beforeRemoveShape=$$props.beforeRemoveShape);if(\"beforeDeselectShape\"in $$props)$$invalidate(12,beforeDeselectShape=$$props.beforeDeselectShape);if(\"beforeSelectShape\"in $$props)$$invalidate(13,beforeSelectShape=$$props.beforeSelectShape);if(\"beforeUpdateShape\"in $$props)$$invalidate(14,beforeUpdateShape=$$props.beforeUpdateShape);};return[isActive,isActiveFraction,isVisible,stores,locale,stickers,stickerStickToImage,stickerEnableSelectImage,stickersEnableButtonFlipVertical,willRenderShapeControls,beforeAddShape,beforeRemoveShape,beforeDeselectShape,beforeSelectShape,beforeUpdateShape,$imageFlipX,$imageFlipY,$imageRotation,presentationScalar,rootRect,imageCropRect,imageSelectionRectPresentation,imageAnnotation,imageDecoration,imageSize,imageTransforms,imageRotation,imageFlipX,imageFlipY,mapScreenPointToImagePoint,mapImagePointToScreenPoint,name,measure_handler];}class Sticker extends SvelteComponent{constructor(options){super();init(this,options,instance$F,create_fragment$F,safe_not_equal,{name:31,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,stickers:5,stickerStickToImage:6,stickerEnableSelectImage:7,stickersEnableButtonFlipVertical:8,willRenderShapeControls:9,beforeAddShape:10,beforeRemoveShape:11,beforeDeselectShape:12,beforeSelectShape:13,beforeUpdateShape:14},[-1,-1]);}get name(){return this.$$.ctx[31];}get isActive(){return this.$$.ctx[0];}set isActive(isActive){this.$set({isActive});flush();}get isActiveFraction(){return this.$$.ctx[1];}set isActiveFraction(isActiveFraction){this.$set({isActiveFraction});flush();}get isVisible(){return this.$$.ctx[2];}set isVisible(isVisible){this.$set({isVisible});flush();}get stores(){return this.$$.ctx[3];}set stores(stores){this.$set({stores});flush();}get locale(){return this.$$.ctx[4];}set locale(locale){this.$set({locale});flush();}get stickers(){return this.$$.ctx[5];}set stickers(stickers){this.$set({stickers});flush();}get stickerStickToImage(){return this.$$.ctx[6];}set stickerStickToImage(stickerStickToImage){this.$set({stickerStickToImage});flush();}get stickerEnableSelectImage(){return this.$$.ctx[7];}set stickerEnableSelectImage(stickerEnableSelectImage){this.$set({stickerEnableSelectImage});flush();}get stickersEnableButtonFlipVertical(){return this.$$.ctx[8];}set stickersEnableButtonFlipVertical(stickersEnableButtonFlipVertical){this.$set({stickersEnableButtonFlipVertical});flush();}get willRenderShapeControls(){return this.$$.ctx[9];}set willRenderShapeControls(willRenderShapeControls){this.$set({willRenderShapeControls});flush();}get beforeAddShape(){return this.$$.ctx[10];}set beforeAddShape(beforeAddShape){this.$set({beforeAddShape});flush();}get beforeRemoveShape(){return this.$$.ctx[11];}set beforeRemoveShape(beforeRemoveShape){this.$set({beforeRemoveShape});flush();}get beforeDeselectShape(){return this.$$.ctx[12];}set beforeDeselectShape(beforeDeselectShape){this.$set({beforeDeselectShape});flush();}get beforeSelectShape(){return this.$$.ctx[13];}set beforeSelectShape(beforeSelectShape){this.$set({beforeSelectShape});flush();}get beforeUpdateShape(){return this.$$.ctx[14];}set beforeUpdateShape(beforeUpdateShape){this.$set({beforeUpdateShape});flush();}}// @ts-ignore\nvar index$5={util:['sticker',Sticker]};/* src/core/ui/plugins/resize/index.svelte generated by Svelte v3.29.4 */function create_default_slot_2$6(ctx){let g;let raw_value=(isString(/*locale*/ctx[1].resizeIconButtonMaintainAspectRatio)?/*locale*/ctx[1].resizeIconButtonMaintainAspectRatio:/*locale*/ctx[1].resizeIconButtonMaintainAspectRatio(/*maintainAspectRatio*/ctx[3],/*$iconActiveFraction*/ctx[11]))+\"\";return{c(){g=svg_element(\"g\");},m(target,anchor){insert(target,g,anchor);g.innerHTML=raw_value;},p(ctx,dirty){if(dirty[0]&/*locale, maintainAspectRatio, $iconActiveFraction*/2058&&raw_value!==(raw_value=(isString(/*locale*/ctx[1].resizeIconButtonMaintainAspectRatio)?/*locale*/ctx[1].resizeIconButtonMaintainAspectRatio:/*locale*/ctx[1].resizeIconButtonMaintainAspectRatio(/*maintainAspectRatio*/ctx[3],/*$iconActiveFraction*/ctx[11]))+\"\"))g.innerHTML=raw_value;},d(detaching){if(detaching)detach(g);}};}// (389:12) <Button type=\"submit\" class=\"implicit\">\nfunction create_default_slot_1$9(ctx){let t;return{c(){t=text(\"Save\");},m(target,anchor){insert(target,t,anchor);},d(detaching){if(detaching)detach(t);}};}// (362:4) <form slot=\"footer\" style={footerStyle} on:submit|preventDefault={handleSubmit}>\nfunction create_footer_slot$4(ctx){let form;let div4;let fieldset;let legend;let t0_value=/*locale*/ctx[1].resizeLabelFormCaption+\"\";let t0;let t1;let div3;let div0;let label0;let t2_value=/*locale*/ctx[1].resizeLabelInputWidth+\"\";let t2;let label0_for_value;let label0_title_value;let label0_aria_label_value;let t3;let input0;let input0_id_value;let t4;let div1;let input1;let input1_id_value;let t5;let label1;let icon;let label1_for_value;let label1_title_value;let t6;let div2;let label2;let t7_value=/*locale*/ctx[1].resizeLabelInputHeight+\"\";let t7;let label2_for_value;let label2_title_value;let label2_aria_label_value;let t8;let input2;let input2_id_value;let t9;let button;let current;let mounted;let dispose;icon=new Icon({props:{$$slots:{default:[create_default_slot_2$6]},$$scope:{ctx}}});button=new Button({props:{type:\"submit\",class:\"implicit\",$$slots:{default:[create_default_slot_1$9]},$$scope:{ctx}}});return{c(){form=element(\"form\");div4=element(\"div\");fieldset=element(\"fieldset\");legend=element(\"legend\");t0=text(t0_value);t1=space();div3=element(\"div\");div0=element(\"div\");label0=element(\"label\");t2=text(t2_value);t3=space();input0=element(\"input\");t4=space();div1=element(\"div\");input1=element(\"input\");t5=space();label1=element(\"label\");create_component(icon.$$.fragment);t6=space();div2=element(\"div\");label2=element(\"label\");t7=text(t7_value);t8=space();input2=element(\"input\");t9=space();create_component(button.$$.fragment);attr(legend,\"class\",\"implicit\");attr(label0,\"for\",label0_for_value=\"doka-width-\"+/*formId*/ctx[18]);attr(label0,\"title\",label0_title_value=/*locale*/ctx[1].resizeTitleInputWidth);attr(label0,\"aria-label\",label0_aria_label_value=/*locale*/ctx[1].resizeTitleInputWidth);attr(input0,\"id\",input0_id_value=\"doka-width-\"+/*formId*/ctx[18]);attr(input0,\"type\",\"text\");attr(input0,\"inputmode\",\"numeric\");attr(input0,\"pattern\",\"[0-9]*\");attr(input0,\"data-state\",/*widthState*/ctx[8]);attr(input0,\"autocomplete\",\"off\");attr(input0,\"placeholder\",/*widthPlaceholder*/ctx[6]);attr(div0,\"class\",\"DokaInputDimension\");attr(input1,\"class\",\"implicit\");attr(input1,\"id\",input1_id_value=\"doka-maintainAspectRatio-\"+/*formId*/ctx[18]);attr(input1,\"type\",\"checkbox\");attr(label1,\"for\",label1_for_value=\"doka-maintainAspectRatio-\"+/*formId*/ctx[18]);attr(label1,\"title\",label1_title_value=/*locale*/ctx[1].resizeTitleButtonMaintainAspectRatio);attr(label2,\"for\",label2_for_value=\"doka-height-\"+/*formId*/ctx[18]);attr(label2,\"title\",label2_title_value=/*locale*/ctx[1].resizeTitleInputHeight);attr(label2,\"aria-label\",label2_aria_label_value=/*locale*/ctx[1].resizeTitleInputHeight);attr(input2,\"id\",input2_id_value=\"doka-height-\"+/*formId*/ctx[18]);attr(input2,\"type\",\"text\");attr(input2,\"inputmode\",\"numeric\");attr(input2,\"pattern\",\"[0-9]*\");attr(input2,\"autocomplete\",\"off\");attr(input2,\"data-state\",/*heightState*/ctx[9]);attr(input2,\"placeholder\",/*heightPlaceholder*/ctx[7]);attr(div2,\"class\",\"DokaInputDimension\");attr(div3,\"class\",\"DokaFieldsetInner\");attr(div4,\"class\",\"DokaFormInner\");attr(form,\"slot\",\"footer\");attr(form,\"style\",/*footerStyle*/ctx[10]);},m(target,anchor){insert(target,form,anchor);append(form,div4);append(div4,fieldset);append(fieldset,legend);append(legend,t0);append(fieldset,t1);append(fieldset,div3);append(div3,div0);append(div0,label0);append(label0,t2);append(div0,t3);append(div0,input0);set_input_value(input0,/*width*/ctx[4]);append(div3,t4);append(div3,div1);append(div1,input1);input1.checked=/*maintainAspectRatio*/ctx[3];append(div1,t5);append(div1,label1);mount_component(icon,label1,null);append(div3,t6);append(div3,div2);append(div2,label2);append(label2,t7);append(div2,t8);append(div2,input2);set_input_value(input2,/*height*/ctx[5]);/*div3_binding*/ctx[30](div3);append(div4,t9);mount_component(button,div4,null);current=true;if(!mounted){dispose=[listen(input0,\"input\",/*input0_input_handler*/ctx[27]),listen(input1,\"change\",/*input1_change_handler*/ctx[28]),listen(input2,\"input\",/*input2_input_handler*/ctx[29]),listen(div3,\"focusin\",/*handleFocusIn*/ctx[19]),listen(div3,\"focusout\",/*handleFocusOut*/ctx[20]),listen(form,\"submit\",prevent_default(/*handleSubmit*/ctx[21]))];mounted=true;}},p(ctx,dirty){if((!current||dirty[0]&/*locale*/2)&&t0_value!==(t0_value=/*locale*/ctx[1].resizeLabelFormCaption+\"\"))set_data(t0,t0_value);if((!current||dirty[0]&/*locale*/2)&&t2_value!==(t2_value=/*locale*/ctx[1].resizeLabelInputWidth+\"\"))set_data(t2,t2_value);if(!current||dirty[0]&/*locale*/2&&label0_title_value!==(label0_title_value=/*locale*/ctx[1].resizeTitleInputWidth)){attr(label0,\"title\",label0_title_value);}if(!current||dirty[0]&/*locale*/2&&label0_aria_label_value!==(label0_aria_label_value=/*locale*/ctx[1].resizeTitleInputWidth)){attr(label0,\"aria-label\",label0_aria_label_value);}if(!current||dirty[0]&/*widthState*/256){attr(input0,\"data-state\",/*widthState*/ctx[8]);}if(!current||dirty[0]&/*widthPlaceholder*/64){attr(input0,\"placeholder\",/*widthPlaceholder*/ctx[6]);}if(dirty[0]&/*width*/16&&input0.value!==/*width*/ctx[4]){set_input_value(input0,/*width*/ctx[4]);}if(dirty[0]&/*maintainAspectRatio*/8){input1.checked=/*maintainAspectRatio*/ctx[3];}const icon_changes={};if(dirty[0]&/*locale, maintainAspectRatio, $iconActiveFraction*/2058|dirty[1]&/*$$scope*/65536){icon_changes.$$scope={dirty,ctx};}icon.$set(icon_changes);if(!current||dirty[0]&/*locale*/2&&label1_title_value!==(label1_title_value=/*locale*/ctx[1].resizeTitleButtonMaintainAspectRatio)){attr(label1,\"title\",label1_title_value);}if((!current||dirty[0]&/*locale*/2)&&t7_value!==(t7_value=/*locale*/ctx[1].resizeLabelInputHeight+\"\"))set_data(t7,t7_value);if(!current||dirty[0]&/*locale*/2&&label2_title_value!==(label2_title_value=/*locale*/ctx[1].resizeTitleInputHeight)){attr(label2,\"title\",label2_title_value);}if(!current||dirty[0]&/*locale*/2&&label2_aria_label_value!==(label2_aria_label_value=/*locale*/ctx[1].resizeTitleInputHeight)){attr(label2,\"aria-label\",label2_aria_label_value);}if(!current||dirty[0]&/*heightState*/512){attr(input2,\"data-state\",/*heightState*/ctx[9]);}if(!current||dirty[0]&/*heightPlaceholder*/128){attr(input2,\"placeholder\",/*heightPlaceholder*/ctx[7]);}if(dirty[0]&/*height*/32&&input2.value!==/*height*/ctx[5]){set_input_value(input2,/*height*/ctx[5]);}const button_changes={};if(dirty[1]&/*$$scope*/65536){button_changes.$$scope={dirty,ctx};}button.$set(button_changes);if(!current||dirty[0]&/*footerStyle*/1024){attr(form,\"style\",/*footerStyle*/ctx[10]);}},i(local){if(current)return;transition_in(icon.$$.fragment,local);transition_in(button.$$.fragment,local);current=true;},o(local){transition_out(icon.$$.fragment,local);transition_out(button.$$.fragment,local);current=false;},d(detaching){if(detaching)detach(form);destroy_component(icon);/*div3_binding*/ctx[30](null);destroy_component(button);mounted=false;run_all(dispose);}};}function create_fragment$G(ctx){let util;let current;util=new Util({props:{$$slots:{footer:[create_footer_slot$4]},$$scope:{ctx}}});util.$on(\"measure\",/*measure_handler*/ctx[31]);return{c(){create_component(util.$$.fragment);},m(target,anchor){mount_component(util,target,anchor);current=true;},p(ctx,dirty){const util_changes={};if(dirty[0]&/*footerStyle, fieldsGroup, heightState, heightPlaceholder, height, locale, maintainAspectRatio, $iconActiveFraction, widthState, widthPlaceholder, width*/4094|dirty[1]&/*$$scope*/65536){util_changes.$$scope={dirty,ctx};}util.$set(util_changes);},i(local){if(current)return;transition_in(util.$$.fragment,local);current=true;},o(local){transition_out(util.$$.fragment,local);current=false;},d(detaching){destroy_component(util,detaching);}};}function instance$G($$self,$$props,$$invalidate){let $imageCropRectAspectRatio;let $imageCropRect;let $imageOutputSize;let $imageCropAspectRatio;let $imageSize;let $isActive,$$unsubscribe_isActive=noop$1,$$subscribe_isActive=()=>($$unsubscribe_isActive(),$$unsubscribe_isActive=subscribe(isActive,$$value=>$$invalidate(41,$isActive=$$value)),isActive);let $footerOffset;let $iconActiveFraction;$$self.$$.on_destroy.push(()=>$$unsubscribe_isActive());const formatValue=(value,min=0,max=9999)=>{if(isString(value)){value=value.replace(/\\D/g,\"\");if(!value.length)return;}const v=Math.round(value);if(Number.isNaN(v))return;return clamp(v,min,max);};const name=\"resize\";let{isActive}=$$props;$$subscribe_isActive();let{stores}=$$props;let{locale={}}=$$props;let{resizeMinSize=sizeCreate(1,1)}=$$props;let{resizeMaxSize=sizeCreate(9999,9999)}=$$props;// offset\nconst iconActiveFraction=spring(0,{stiffness:0.15,damping:0.3});component_subscribe($$self,iconActiveFraction,value=>$$invalidate(11,$iconActiveFraction=value));const{imageSize,imageCropRect,imageCropRectAspectRatio,imageCropAspectRatio,imageOutputSize,history}=stores;component_subscribe($$self,imageSize,value=>$$invalidate(40,$imageSize=value));component_subscribe($$self,imageCropRect,value=>$$invalidate(37,$imageCropRect=value));component_subscribe($$self,imageCropRectAspectRatio,value=>$$invalidate(36,$imageCropRectAspectRatio=value));component_subscribe($$self,imageCropAspectRatio,value=>$$invalidate(39,$imageCropAspectRatio=value));component_subscribe($$self,imageOutputSize,value=>$$invalidate(38,$imageOutputSize=value));const formId=getUniqueId();let fieldsGroup;let maintainAspectRatio=false;let width;let height;let widthFormatted;let heightFormatted;let widthPlaceholder;let heightPlaceholder;let activeField;let lastActiveField;// populate active field\nconst handleFocusIn=e=>{const id=e.target.id;if(/width/.test(id)){$$invalidate(34,activeField=\"width\");}else if(/height/.test(id)){$$invalidate(34,activeField=\"height\");}else if(/aspectRatio/i.test(id)){$$invalidate(34,activeField=\"lock\");}else{$$invalidate(34,activeField=undefined);}};const handleFocusOut=e=>{if(!fieldsGroup.contains(e.relatedTarget))handleSubmit();$$invalidate(34,activeField=undefined);};// sync fields if one has a value and aspect ratio should be maintained\nconst syncFields=()=>{if(activeField===\"width\"){// sync height field\n$$invalidate(5,height=Math.round(width/$imageCropRectAspectRatio));}else if(activeField===\"height\"){// sync width field\n$$invalidate(4,width=Math.round(height*$imageCropRectAspectRatio));}else{if(lastActiveField===\"width\"){$$invalidate(5,height=Math.round(width/$imageCropRectAspectRatio));}else if(lastActiveField===\"height\"){$$invalidate(4,width=Math.round(height*$imageCropRectAspectRatio));}consolidateSize();}};const consolidateSize=forcedAspectRatio=>{// first need to limit values\nlet inputWidth=formatValue(width);let inputHeight=formatValue(height);let currentWidth=inputWidth;let currentHeight=inputHeight;let bothAxisDefined=currentWidth&&currentHeight;let aspectRatio=forcedAspectRatio||$imageCropRectAspectRatio;// done, no consolidation needed\nif(!currentWidth&&!currentHeight)return;// need to fill in missing values\nif(currentWidth&&!currentHeight){currentHeight=Math.round(currentWidth/aspectRatio);}else if(currentHeight&&!currentWidth){currentWidth=Math.round(currentHeight*aspectRatio);}aspectRatio=forcedAspectRatio||bothAxisDefined?getAspectRatio(currentWidth,currentHeight):$imageCropRectAspectRatio;// now we have both width and height let's re-fit the min max size\nlet currentSize=sizeCreate(currentWidth,currentHeight);if(!sizeContains(resizeMaxSize,currentSize)){// too big\ncurrentSize=rectContainRect(resizeMaxSize,aspectRatio);}if(!sizeContains(currentSize,resizeMinSize)){// too small\ncurrentSize=rectCoverRect(resizeMinSize,aspectRatio);}$$invalidate(4,width=inputWidth!=null?Math.round(currentSize.width):undefined);$$invalidate(5,height=inputHeight!=null?Math.round(currentSize.height):undefined);};const handleSubmit=()=>{// calculate correct values\nconsolidateSize();// get curent values so we can check if they were changed (if not, no need to write history or update)\nconst{width:currentWidth,height:currentHeight}=$imageOutputSize||{};// no need to update\nif(currentWidth===width&&currentHeight===height)return;// update state\nif(!width&&!height){// reset image crop\nset_store_value(imageCropAspectRatio,$imageCropAspectRatio=$imageSize.width/$imageSize.height,$imageCropAspectRatio);set_store_value(imageCropAspectRatio,$imageCropAspectRatio=undefined,$imageCropAspectRatio);// reset output size\nset_store_value(imageOutputSize,$imageOutputSize=undefined,$imageOutputSize);}else{if(width&&height)set_store_value(imageCropAspectRatio,$imageCropAspectRatio=width/height,$imageCropAspectRatio);set_store_value(imageOutputSize,$imageOutputSize=sizeCreate(width,height),$imageOutputSize);}history.write();};// handle external updates to outputSize\nimageOutputSize.subscribe(size=>{if(!size){$$invalidate(4,width=undefined);$$invalidate(5,height=undefined);return;}$$invalidate(4,width=size.width);$$invalidate(5,height=size.height);// make sure the size conforms to min max\nconsolidateSize();});// if the crop aspect ratio is changed we need to align width/height\nimageCropAspectRatio.subscribe(cropAspectRatio=>{// exit if no dimensions supplied\nif(!width&&!height)return;// no crop aspect ratio has been selected, so all is fine\nif(!cropAspectRatio)return;// fix size to match new aspect ratio of the crop\nif(width&&height&&getAspectRatio(width,height)!==cropAspectRatio){$$invalidate(5,height=width/cropAspectRatio);consolidateSize(cropAspectRatio);}else{consolidateSize();}});//\n// Footer\n//\nconst footerOffset=spring(0);component_subscribe($$self,footerOffset,value=>$$invalidate(42,$footerOffset=value));function input0_input_handler(){width=this.value;$$invalidate(4,width);}function input1_change_handler(){maintainAspectRatio=this.checked;$$invalidate(3,maintainAspectRatio);}function input2_input_handler(){height=this.value;$$invalidate(5,height);}function div3_binding($$value){binding_callbacks[$$value?\"unshift\":\"push\"](()=>{fieldsGroup=$$value;$$invalidate(2,fieldsGroup);});}function measure_handler(event){bubble($$self,event);}$$self.$$set=$$props=>{if(\"isActive\"in $$props)$$subscribe_isActive($$invalidate(0,isActive=$$props.isActive));if(\"stores\"in $$props)$$invalidate(24,stores=$$props.stores);if(\"locale\"in $$props)$$invalidate(1,locale=$$props.locale);if(\"resizeMinSize\"in $$props)$$invalidate(25,resizeMinSize=$$props.resizeMinSize);if(\"resizeMaxSize\"in $$props)$$invalidate(26,resizeMaxSize=$$props.resizeMaxSize);};let widthState;let heightState;let footerStyle;$$self.$$.update=()=>{if($$self.$$.dirty[0]&/*maintainAspectRatio*/8){iconActiveFraction.set(maintainAspectRatio?1:0);}if($$self.$$.dirty[1]&/*activeField*/8){if(activeField)lastActiveField=activeField;}if($$self.$$.dirty[0]&/*width*/16){$$invalidate(32,widthFormatted=formatValue(width));}if($$self.$$.dirty[0]&/*height*/32){$$invalidate(33,heightFormatted=formatValue(height));}if($$self.$$.dirty[0]&/*resizeMinSize, resizeMaxSize*/100663296|$$self.$$.dirty[1]&/*widthFormatted, activeField*/10){$$invalidate(8,widthState=widthFormatted!=null&&activeField!==\"width\"?widthFormatted>=resizeMinSize.width&&widthFormatted<=resizeMaxSize.width?\"valid\":\"invalid\":\"undetermined\");}if($$self.$$.dirty[0]&/*resizeMinSize, resizeMaxSize*/100663296|$$self.$$.dirty[1]&/*heightFormatted, activeField*/12){$$invalidate(9,heightState=heightFormatted!=null&&activeField!==\"height\"?heightFormatted>=resizeMinSize.height&&heightFormatted<=resizeMaxSize.height?\"valid\":\"invalid\":\"undetermined\");}if($$self.$$.dirty[1]&/*heightFormatted, $imageCropRectAspectRatio, $imageCropRect*/100){$$invalidate(6,widthPlaceholder=Math.round(heightFormatted!=null?heightFormatted*$imageCropRectAspectRatio:$imageCropRect.width));}if($$self.$$.dirty[1]&/*widthFormatted, $imageCropRectAspectRatio, $imageCropRect*/98){$$invalidate(7,heightPlaceholder=Math.round(widthFormatted!=null?widthFormatted/$imageCropRectAspectRatio:$imageCropRect.height));}if($$self.$$.dirty[0]&/*maintainAspectRatio, width, height*/56){if(maintainAspectRatio&&width&&height)syncFields();}if($$self.$$.dirty[1]&/*$isActive*/1024){footerOffset.set($isActive?0:20);}if($$self.$$.dirty[1]&/*$footerOffset*/2048){$$invalidate(10,footerStyle=$footerOffset?`transform: translateY(${$footerOffset}px)`:undefined);}};return[isActive,locale,fieldsGroup,maintainAspectRatio,width,height,widthPlaceholder,heightPlaceholder,widthState,heightState,footerStyle,$iconActiveFraction,iconActiveFraction,imageSize,imageCropRect,imageCropRectAspectRatio,imageCropAspectRatio,imageOutputSize,formId,handleFocusIn,handleFocusOut,handleSubmit,footerOffset,name,stores,resizeMinSize,resizeMaxSize,input0_input_handler,input1_change_handler,input2_input_handler,div3_binding,measure_handler];}class Resize extends SvelteComponent{constructor(options){super();init(this,options,instance$G,create_fragment$G,safe_not_equal,{name:23,isActive:0,stores:24,locale:1,resizeMinSize:25,resizeMaxSize:26},[-1,-1]);}get name(){return this.$$.ctx[23];}get isActive(){return this.$$.ctx[0];}set isActive(isActive){this.$set({isActive});flush();}get stores(){return this.$$.ctx[24];}set stores(stores){this.$set({stores});flush();}get locale(){return this.$$.ctx[1];}set locale(locale){this.$set({locale});flush();}get resizeMinSize(){return this.$$.ctx[25];}set resizeMinSize(resizeMinSize){this.$set({resizeMinSize});flush();}get resizeMaxSize(){return this.$$.ctx[26];}set resizeMaxSize(resizeMaxSize){this.$set({resizeMaxSize});flush();}}// @ts-ignore\nvar index$6={util:['resize',Resize]};const cropSelectPresetOptionsDefault=[['Crop',[[undefined,'Custom'],[1,'Square'],[4/3,'Landscape'],[3/4,'Portrait']]],['Size',[[[180,180],'Profile Picture'],[[1200,600],'Header Image'],[[800,400],'Timeline Photo']]]];var defaults$2={cropSelectPresetOptions:cropSelectPresetOptionsDefault};const IconCross='<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M18 6L6 18M6 6l12 12\"></path></path></g>';var en_gb={// generic\nlabelReset:'Reset',labelDefault:'Default',labelAuto:'Auto',labelNone:'None',labelEdit:'Edit',labelClose:'Close',labelSupportError:features=>`${features.join(', ')} not supported on this browser`,// sizes\nlabelSizeExtraSmall:'Extra small',labelSizeSmall:'Small',labelSizeMediumSmall:'Medium small',labelSizeMedium:'Medium',labelSizeMediumLarge:'Medium large',labelSizeLarge:'Large',labelSizeExtraLarge:'Extra large',// unused?\nlabelButtonRevert:'Revert',labelButtonCancel:'Cancel',labelButtonUndo:'Undo',labelButtonRedo:'Redo',labelButtonExport:'Done',iconSupportError:`<g fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/><g><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/></g>`,iconButtonClose:IconCross,iconButtonRevert:`<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M7.388 18.538a8 8 0 10-2.992-9.03\"/><path fill=\"currentColor\" d=\"M2.794 11.696L2.37 6.714l5.088 3.18z\"/><path d=\"M12 8v4M12 12l4 2\"/></g>`,iconButtonUndo:`<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M10 8h4c2.485 0 5 2 5 5s-2.515 5-5 5h-4\"/><path fill=\"currentColor\" d=\"M5 8l4-3v6z\"/></g>`,iconButtonRedo:`<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M14 8h-4c-2.485 0-5 2-5 5s2.515 5 5 5h4\"/><path fill=\"currentColor\" d=\"M19 8l-4-3v6z\"/></g>`,iconButtonExport:`<polyline points=\"20 6 9 17 4 12\" fill=\"none\" stroke=\"currentColor\" stroke-width=\".125em\"></polyline>`,// status\nstatusLabelButtonClose:'Close',statusIconButtonClose:IconCross,statusLabelLoadImage:state=>{if(!state||!state.task)return'Waiting for image';if(state.error)return state.error.code==='IMAGE_TOO_SMALL'?'Minimum image size is {minWidth}  {minHeight}':'Error loading image';if(state.task==='blob-to-bitmap')return'Creating preview';return'Loading image';},// processing status message\nstatusLabelProcessImage:state=>{if(!state||!state.task)return undefined;if(state.task==='store'){if(state.error)return'Error uploading image';return'Uploading image';}if(state.error)return'Error processing image';return'Processing image';}};const MarkupEditor={shapeLabelButtonSelectSticker:'Select image',shapeIconButtonSelectSticker:`<g><circle fill=\"currentColor\" cx=\"5\" cy=\"6\" r=\"1.333\"/><g fill=\"none\" stroke=\"currentColor\" stroke-width=\"0.0625em\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"1\" y=\"1\" width=\"14\" height=\"14\" rx=\"2\"/><path d=\"M15 13l-5-6-5 8\"/></g></g>`,shapeIconButtonFlipHorizontal:`<svg width=\"24\" height=\"24\" xmlns=\"http://www.w3.org/2000/svg\"><g stroke=\"#FFF\" stroke-width=\"2\" fill=\"none\" fill-rule=\"evenodd\"><path d=\"M6 6.5h5v11H6z\"/><path fill=\"#FFF\" d=\"M15 6.5h3v11h-3z\"/><path d=\"M11 4v16\" fill=\"#fff\"/></g></svg>`,shapeIconButtonFlipVertical:`<g stroke=\"currentColor\" stroke-width=\".125em\"><rect x=\"7\" y=\"8\" width=\"11\" height=\"5\" fill=\"none\"/><rect x=\"7\" y=\"17\" width=\"11\" height=\"2\" fill=\"currentColor\"/><line x1=\"5\" y1=\"13\" x2=\"20\" y2=\"13\"/></g>`,shapeIconButtonRemove:`<g fill=\"none\" fill-rule=\"evenodd\"><path stroke=\"#FFF\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M7.5 7h9z\"/><path d=\"M7.916 9h8.168a1 1 0 01.99 1.14l-.972 6.862a2 2 0 01-1.473 1.653c-.877.23-1.753.345-2.629.345-.876 0-1.752-.115-2.628-.345a2 2 0 01-1.473-1.653l-.973-6.862A1 1 0 017.916 9z\" fill=\"#FFF\"/><rect fill=\"#FFF\" x=\"10\" y=\"5\" width=\"4\" height=\"3\" rx=\"1\"/></g>`,shapeIconButtonDuplicate:`<g fill=\"none\" fill-rule=\"evenodd\"><path d=\"M15 13.994V16a2 2 0 01-2 2H8a2 2 0 01-2-2v-5a2 2 0 012-2h2.142\" stroke=\"currentColor\" stroke-width=\".125em\"/><path d=\"M15 9V8a1 1 0 00-2 0v1h-1a1 1 0 000 2h1v1a1 1 0 002 0v-1h1a1 1 0 000-2h-1zm-4-4h6a2 2 0 012 2v6a2 2 0 01-2 2h-6a2 2 0 01-2-2V7a2 2 0 012-2z\" fill=\"currentColor\"/></g>`,shapeIconButtonMoveToFront:`<g fill=\"none\" fill-rule=\"evenodd\"><rect fill=\"currentColor\" x=\"11\" y=\"13\" width=\"8\" height=\"2\" rx=\"1\"/><rect fill=\"currentColor\" x=\"9\" y=\"17\" width=\"10\" height=\"2\" rx=\"1\"/><path d=\"M11.364 8H10a5 5 0 000 10M12 6.5L14.5 8 12 9.5z\" stroke=\"currentColor\" stroke-width=\".125em\" stroke-linecap=\"round\"/></g>`,shapeTitleButtonFlipHorizontal:'Flip Horizontal',shapeTitleButtonFlipVertical:'Flip Vertical',shapeTitleButtonRemove:'Remove',shapeTitleButtonDuplicate:'Duplicate',shapeTitleButtonMoveToFront:'Move to front',shapeLabelInputText:'Edit text',shapeIconInputCancel:`<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M18 6L6 18M6 6l12 12\"/></g>`,shapeIconInputConfirm:`<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><polyline points=\"20 6 9 17 4 12\"/></g>`,shapeLabelInputCancel:'Cancel',shapeLabelInputConfirm:'Confirm',shapeLabelStrokeNone:'No outline',shapeLabelFontStyleNormal:'Normal',shapeLabelFontStyleBold:'Bold',shapeLabelFontStyleItalic:'Italic',shapeLabelFontStyleItalicBold:'Italic Bold',shapeTitleBackgroundColor:'Fill color',shapeTitleFontFamily:'Font',shapeTitleFontSize:'Font size',shapeTitleFontStyle:'Font style',shapeTitleLineHeight:'Leading',shapeTitleLineStart:'Start',shapeTitleLineEnd:'End',shapeTitleStrokeWidth:'Line width',shapeTitleStrokeColor:'Line color',shapeTitleLineDecorationBar:'Bar',shapeTitleLineDecorationCircle:'Circle',shapeTitleLineDecorationSquare:'Square',shapeTitleLineDecorationArrow:'Arrow',shapeTitleLineDecorationCircleSolid:'Circle solid',shapeTitleLineDecorationSquareSolid:'Square solid',shapeTitleLineDecorationArrowSolid:'Arrow solid',shapeIconLineDecorationBar:`<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H16\"/><path d=\"M16,8 V16\"/></g>`,shapeIconLineDecorationCircle:`<g stroke=\"currentColor\" stroke-linecap=\"round\"><path stroke-width=\".125em\" d=\"M5,12 H12\"/><circle fill=\"none\" stroke-width=\".125em\" cx=\"16\" cy=\"12\" r=\"4\"/></g>`,shapeIconLineDecorationSquare:`<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H16\"/><path d=\"M13,7 l6,5 l-6,5z\" fill=\"currentColor\"/></g>`,shapeIconLineDecorationArrow:`<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H16 M13,7 l6,5 l-6,5\" fill=\"none\"/></g>`,shapeIconLineDecorationCircleSolid:`<g stroke=\"currentColor\" stroke-linecap=\"round\"><path stroke-width=\".125em\" d=\"M5,12 H12\"/><circle fill=\"currentColor\" cx=\"16\" cy=\"12\" r=\"4\"/></g>`,shapeIconLineDecorationSquareSolid:`<g stroke=\"currentColor\" stroke-linecap=\"round\"><path stroke-width=\".125em\" d=\"M5,12 H12\"/><rect fill=\"currentColor\" x=\"12\" y=\"8\" width=\"8\" height=\"8\"/></g>`,shapeIconLineDecorationArrowSolid:`<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H16\"/><path d=\"M13,7 l6,5 l-6,5z\" fill=\"currentColor\"/></g>`,shapeTitleColorTransparent:'Transparent',shapeTitleColorWhite:'White',shapeTitleColorSilver:'Silver',shapeTitleColorGray:'Gray',shapeTitleColorBlack:'Black',shapeTitleColorNavy:'Navy',shapeTitleColorBlue:'Blue',shapeTitleColorAqua:'Aqua',shapeTitleColorTeal:'Teal',shapeTitleColorOlive:'Olive',shapeTitleColorGreen:'Green',shapeTitleColorYellow:'Yellow',shapeTitleColorOrange:'Orange',shapeTitleColorRed:'Red',shapeTitleColorMaroon:'Maroon',shapeTitleColorFuchsia:'Fuchsia',shapeTitleColorPurple:'Purple',shapeTitleTextColor:'Font color',shapeTitleTextAlign:'Text align',shapeTitleTextAlignLeft:'Left align text',shapeTitleTextAlignCenter:'Center align text',shapeTitleTextAlignRight:'Right align text',shapeIconTextAlignLeft:`<g stroke-width=\".125em\" stroke=\"currentColor\"><line x1=\"5\" y1=\"8\" x2=\"15\" y2=\"8\"/><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/><line x1=\"5\" y1=\"16\" x2=\"14\" y2=\"16\"/></g>`,shapeIconTextAlignCenter:`<g stroke-width=\".125em\" stroke=\"currentColor\"><line x1=\"7\" y1=\"8\" x2=\"17\" y2=\"8\"/><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/><line x1=\"8\" y1=\"16\" x2=\"16\" y2=\"16\"/></g>`,shapeIconTextAlignRight:`<g stroke-width=\".125em\" stroke=\"currentColor\"><line x1=\"9\" y1=\"8\" x2=\"19\" y2=\"8\"/><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/><line x1=\"11\" y1=\"16\" x2=\"19\" y2=\"16\"/></g>`,shapeLabelToolSharpie:'Sharpie',shapeLabelToolEraser:'Eraser',shapeLabelToolRectangle:'Rectangle',shapeLabelToolEllipse:'Ellipse',shapeLabelToolArrow:'Arrow',shapeLabelToolLine:'Line',shapeLabelToolText:'Text',shapeLabelToolPreset:'Stickers',shapeIconToolSharpie:`<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1\" stroke=\"currentColor\" stroke-width=\".125em\" fill=\"none\" fill-rule=\"evenodd\" stroke-linejoin=\"round\"/></g>`,shapeIconToolEraser:`<g stroke-width=\".125em\" stroke=\"currentColor\" stroke-linecap=\"round\" fill=\"none\"><g transform=\"translate(3, 15) rotate(-45)\"><rect x=\"0\" y=\"0\" width=\"18\" height=\"10\" rx=\"3\"/></g><line x1=\"11\" y1=\"21\" x2=\"18\" y2=\"21\"/><line x1=\"20\" y1=\"21\" x2=\"22\" y2=\"21\"/></g>`,shapeIconToolRectangle:`<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><rect x=\"2\" y=\"2\" width=\"20\" height=\"20\" rx=\"3\"/></g>`,shapeIconToolEllipse:`<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><circle cx=\"12\" cy=\"12\" r=\"11\"/></g>`,shapeIconToolArrow:`<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><line x1=\"20\" y1=\"3\" x2=\"6\" y2=\"21\"/><path d=\"m10 5 L22 1 L21 13\" fill=\"currentColor\" stroke=\"none\"/></g>`,shapeIconToolLine:`<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><line x1=\"20\" y1=\"3\" x2=\"6\" y2=\"21\"/></g>`,shapeIconToolText:`<g stroke=\"none\" fill=\"currentColor\" transform=\"translate(6,0)\"><path d=\"M8.14 20.085c.459 0 .901-.034 1.329-.102a8.597 8.597 0 001.015-.21v1.984c-.281.135-.695.247-1.242.336a9.328 9.328 0 01-1.477.133c-3.312 0-4.968-1.745-4.968-5.235V6.804H.344v-1.25l2.453-1.078L3.89.819h1.5v3.97h4.97v2.015H5.39v10.078c0 1.031.245 1.823.735 2.375s1.161.828 2.015.828z\"/>`,shapeIconToolPreset:`<g fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z\"></path><path d=\"M20 17c-3 3-5 5-8 5\"></path></g>`};var en_gb$1={cropLabel:'Crop',cropIcon:'<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M23 17H9a2 2 0 0 1-2-2v-5m0-3V1\"/><path d=\"M1 7h14a2 2 0 0 1 2 2v7m0 4v3\"/></g>',cropIconButtonRecenter:`<path stroke=\"currentColor\" fill=\"none\" stroke-width=\"2\" stroke-linejoin=\"bevel\" d=\"M1.5 7.5v-6h6M1.5 16.5v6h6M22.5 16.5v6h-6M22.5 7.5v-6h-6\"/><circle cx=\"12\" cy=\"12\" r=\"3.5\" fill=\"currentColor\" stroke=\"none\"/>`,cropIconButtonRotateLeft:'<g stroke=\"none\" fill=\"currentColor\"><path fill=\"none\" d=\"M-1-1h582v402H-1z\"/><rect x=\"3\" rx=\"1\" height=\"12\" width=\"12\" y=\"9\"/><path d=\"M15 5h-1a5 5 0 015 5 1 1 0 002 0 7 7 0 00-7-7h-1.374l.747-.747A1 1 0 0011.958.84L9.603 3.194a1 1 0 000 1.415l2.355 2.355a1 1 0 001.415-1.414l-.55-.55H15z\"/></g>',cropIconButtonRotateRight:'<g stroke=\"none\" fill=\"currentColor\"><path fill=\"none\" d=\"M-1-1h582v402H-1z\"/><path d=\"M11.177 5H10a5 5 0 00-5 5 1 1 0 01-2 0 7 7 0 017-7h1.374l-.747-.747A1 1 0 0112.042.84l2.355 2.355a1 1 0 010 1.415l-2.355 2.354a1 1 0 01-1.415-1.414l.55-.55z\"/><rect rx=\"1\" height=\"12\" width=\"12\" y=\"9\" x=\"9\"/></g>',cropIconButtonFlipVertical:'<g stroke=\"none\" fill=\"currentColor\"><path d=\"M19.993 12.143H7a1 1 0 0 1-1-1V5.994a1 1 0 0 1 1.368-.93l12.993 5.15a1 1 0 0 1-.368 1.93z\"/><path d=\"M19.993 14a1 1 0 0 1 .368 1.93L7.368 21.078A1 1 0 0 1 6 20.148V15a1 1 0 0 1 1-1h12.993z\" opacity=\".6\"/></g>',cropIconButtonFlipHorizontal:'<g stroke=\"none\" fill=\"currentColor\"><path d=\"M11.93 7.007V20a1 1 0 0 1-1 1H5.78a1 1 0 0 1-.93-1.368l5.15-12.993a1 1 0 0 1 1.929.368z\"/><path d=\"M14 7.007V20a1 1 0 0 0 1 1h5.149a1 1 0 0 0 .93-1.368l-5.15-12.993A1 1 0 0 0 14 7.007z\" opacity=\".6\"/></g>',cropLabelButtonRecenter:'Recenter',cropLabelButtonRotateLeft:'Rotate left',cropLabelButtonRotateRight:'Rotate right',cropLabelButtonFlipHorizontal:'Flip horizontal',cropLabelButtonFlipVertical:'Flip vertical',cropLabelSelectPreset:'Crop shape',cropLabelCropBoundary:'Crop boundary',cropLabelCropBoundaryEdge:'Edge of image',cropLabelCropBoundaryNone:'None',cropLabelTabRotation:'Rotation',cropLabelTabZoom:'Zoom'};var en_gb$2={filterLabel:'Filter',filterIcon:'<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M18.347 9.907a6.5 6.5 0 1 0-1.872 3.306M3.26 11.574a6.5 6.5 0 1 0 2.815-1.417\"/><path d=\"M10.15 17.897A6.503 6.503 0 0 0 16.5 23a6.5 6.5 0 1 0-6.183-8.51\"/></g>',filterLabelChrome:'Chrome',filterLabelFade:'Fade',filterLabelCold:'Cold',filterLabelWarm:'Warm',filterLabelPastel:'Pastel',filterLabelMonoDefault:'Mono',filterLabelMonoNoir:'Noir',filterLabelMonoWash:'Wash',filterLabelMonoStark:'Stark',filterLabelSepiaDefault:'Sepia',filterLabelSepiaBlues:'Blues',filterLabelSepiaRust:'Rust',filterLabelSepiaColor:'Color'};var en_gb$3={finetuneLabel:'Finetune',finetuneIcon:'<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M4 1v5.5m0 3.503V23M12 1v10.5m0 3.5v8M20 1v15.5m0 3.5v3M2 7h4M10 12h4M18 17h4\"/></g>',finetuneLabelBrightness:'Brightness',finetuneLabelContrast:'Contrast',finetuneLabelSaturation:'Saturation',finetuneLabelExposure:'Exposure',finetuneLabelTemperature:'Temperature',finetuneLabelGamma:'Gamma',finetuneLabelClarity:'Clarity',finetuneLabelVignette:'Vignette'};var en_gb$4={resizeLabel:'Resize',resizeIcon:'<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><rect x=\"2\" y=\"12\" width=\"10\" height=\"10\" rx=\"2\"/><path d=\"M4 11.5V4a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5\"/><path d=\"M14 10l3.365-3.365M14 6h4v4\"/></g>',resizeLabelFormCaption:'Image output size',resizeLabelInputWidth:'w',resizeTitleInputWidth:'Width',resizeLabelInputHeight:'h',resizeTitleInputHeight:'Height',resizeTitleButtonMaintainAspectRatio:'Maintain aspectratio',resizeIconButtonMaintainAspectRatio:(active,activeFraction)=>`\n        <defs>\n            <mask id=\"mask1\" x=\"0\" y=\"0\" width=\"24\" height=\"24\" >\n                <rect x=\"0\" y=\"0\" width=\"24\" height=\"10\" fill=\"#fff\" stroke=\"none\"/>\n            </mask>\n        </defs>\n        <g fill=\"none\" fill-rule=\"evenodd\">\n            <g  mask=\"url(#mask1)\">\n                <path transform=\"translate(0 ${(activeFraction-1)*3})\" stroke=\"currentColor\" stroke-width=\"1.5\" stroke-linecap=\"round\" d=\"M9.401 10.205v-.804a2.599 2.599 0 0 1 5.198 0V17\"/>\n            </g>\n            <rect fill=\"currentColor\" x=\"7\" y=\"10\" width=\"10\" height=\"7\" rx=\"1.5\"/>\n        </g>\n    `};var en_gb$5={decorateLabel:'Decorate',decorateIcon:'<g fill=\"none\" fill-rule=\"evenodd\"><path stroke=\"currentColor\" stroke-width=\".125em\" stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 18.5l-6.466 3.4 1.235-7.2-5.23-5.1 7.228-1.05L12 2l3.233 6.55 7.229 1.05-5.231 5.1 1.235 7.2z\"/></g>'};var en_gb$6={annotateLabel:'Annotate',annotateIcon:'<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M17.086 2.914a2.828 2.828 0 1 1 4 4l-14.5 14.5-5.5 1.5 1.5-5.5 14.5-14.5z\"/></g>'};var en_gb$7={stickerLabel:'Sticker',stickerIcon:'<g fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z\"/><path d=\"M20 17c-3 3-5 5-8 5\"/></g>'};/* Deprecated, remove in v8, use `createDefaultImageOrienter` instead */const imageOrienter={read:getImageOrientationFromFile,apply:orientImageData};const createDefaultImageOrienter=()=>({read:getImageOrientationFromFile,apply:orientImageData});const createEditor=createImageEditor;const getEditorProps$1=()=>getEditorProps().concat(getEditorViewProps());const processImage=(src,options)=>{const{processImage}=createImageEditor();return processImage(src,options);};const createMarkupEditorToolbar=createToolbar;const createMarkupEditorToolStyles=createToolStyles;// markup editor style controls\nconst createMarkupEditorShapeStyleControls=createShapeStyleControls;const markup_editor_defaults={markupEditorToolbar:createToolbar(),markupEditorToolStyles:createToolStyles(),markupEditorShapeStyleControls:createShapeStyleControls()};//\n// deprecated exports\n//\nconst plugin_annotate_defaults=_objectSpread(_objectSpread({},markup_editor_defaults),{},{annotateTools:createToolbar(),annotateToolShapes:createToolStyles(),annotateShapeControls:createShapeStyleControls()});const plugin_decorate_defaults=_objectSpread(_objectSpread({},markup_editor_defaults),{},{decorateTools:createToolbar(),decorateToolShapes:createToolStyles(),decorateShapeControls:createShapeStyleControls()});const plugin_resize_defaults={};const plugin_sticker_defaults={};export{appendEditor,appendEditors,appendNode,blobToFile,colorStringToColorArray,MarkupEditor as component_shape_editor_locale_en_gb,createDefaultColorOptions,createDefaultFontFamilyOptions,createDefaultFontScaleOptions,createDefaultFontSizeOptions,createDefaultFontStyleOptions,createDefaultImageOrienter,createDefaultImageReader,createDefaultImageWriter,createDefaultLineEndStyleOptions,createDefaultStrokeScaleOptions,createDefaultStrokeWidthOptions,createDefaultTextAlignOptions,createEditor,createBackgroundColorControl as createMarkupEditorBackgroundColorControl,createColorOptions as createMarkupEditorColorOptions,createFontColorControl as createMarkupEditorFontColorControl,createFontFamilyControl as createMarkupEditorFontFamilyControl,createFontFamilyOptions as createMarkupEditorFontFamilyOptions,createFontScaleOptions as createMarkupEditorFontScaleOptions,createFontSizeControl as createMarkupEditorFontSizeControl,createFontSizeOptions as createMarkupEditorFontSizeOptions,createFontStyleControl as createMarkupEditorFontStyleControl,createFontStyleOptions as createMarkupEditorFontStyleOptions,createLineEndStyleControl as createMarkupEditorLineEndStyleControl,createLineEndStyleOptions as createMarkupEditorLineEndStyleOptions,createLineHeightControl as createMarkupEditorLineHeightControl,createLineStartStyleControl as createMarkupEditorLineStartStyleControl,createMarkupEditorShapeStyleControls,createStrokeColorControl as createMarkupEditorStrokeColorControl,createStrokeScaleOptions as createMarkupEditorStrokeScaleOptions,createStrokeWidthControl as createMarkupEditorStrokeWidthControl,createStrokeWidthOptions as createMarkupEditorStrokeWidthOptions,createTextAlignControl as createMarkupEditorTextAlignControl,createToolStyle as createMarkupEditorToolStyle,createMarkupEditorToolStyles,createMarkupEditorToolbar,createNode,customElement as defineCustomElements,degToRad,dispatchEditorEvents,brightness as effectBrightness,clarity as effectClarity,contrast as effectContrast,exposure as effectExposure,gamma as effectGamma,saturation as effectSaturation,temperature as effectTemperature,vignette as effectVignette,chrome as filterChrome,cold as filterCold,fade$1 as filterFade,invert as filterInvert,monoDefault as filterMonoDefault,monoNoir as filterMonoNoir,monoStark as filterMonoStark,monoWash as filterMonoWash,pastel as filterPastel,sepiaBlues as filterSepiaBlues,sepiaColor as filterSepiaColor,sepiaDefault as filterSepiaDefault,sepiaRust as filterSepiaRust,warm as filterWarm,findNode,getEditorProps$1 as getEditorProps,imageOrienter,insertNodeAfter,insertNodeBefore,isModernBrowser as isSupported,legacyDataToImageState,en_gb as locale_en_gb,markup_editor_defaults,MarkupEditor as markup_editor_locale_en_gb,openEditor,overlayEditor,index$3 as plugin_annotate,plugin_annotate_defaults,en_gb$6 as plugin_annotate_locale_en_gb,index as plugin_crop,defaults$2 as plugin_crop_defaults,en_gb$1 as plugin_crop_locale_en_gb,index$4 as plugin_decorate,plugin_decorate_defaults,en_gb$5 as plugin_decorate_locale_en_gb,index$1 as plugin_filter,defaults$1 as plugin_filter_defaults,en_gb$2 as plugin_filter_locale_en_gb,index$2 as plugin_finetune,defaults as plugin_finetune_defaults,en_gb$3 as plugin_finetune_locale_en_gb,index$6 as plugin_resize,plugin_resize_defaults,en_gb$4 as plugin_resize_locale_en_gb,index$5 as plugin_sticker,plugin_sticker_defaults,en_gb$7 as plugin_sticker_locale_en_gb,processImage,removeNode,setEditorViewPlugins as setPlugins};","map":{"version":3,"sources":["/Users/shannoncode/repo/Emblem.Currentwork/emblem-vault-site/node_modules/doka/doka.js"],"names":["backup","getNativeAPIRef","API","window","createProgressEvent","loaded","lengthComputable","type","data","total","err","noop","args","FileReaderDataFormat","ArrayBuffer","readFile","file","onprogress","options","Promise","resolve","reject","dataFormat","reader","onload","result","onerror","readExifOrientation","view","offset","getUint32","intelByteAligned","getUint16","tags","i","readData","DataView","length","byteLength","marker","getImageOrientationFromFile","slice","isBrowser","document","result$1","canOrientImages","testSrc","testImage","Image","naturalWidth","undefined","src","canvasToImageData","canvas","imageData","getContext","getImageData","width","height","h","name","attributes","children","el","createElement","descriptors","Object","getOwnPropertyDescriptors","__proto__","key","style","cssText","set","test","setAttribute","forEach","child","appendChild","MATRICES","getImageOrientationMatrix","orientation","releaseCanvas","ctx","clearRect","isImageData","obj","imageDataToCanvas","inMemoryCanvas","putImageData","transform","apply","drawImage","HTMLCanvasElement","orientImageData","imageToCanvas","image","canvasMemoryLimit","canvasWidth","canvasHeight","naturalHeight","requiredCanvasMemory","canvasScalar","Math","sqrt","floor","imageToCanvasSafe","ready","complete","blobToCanvas","imageBlob","imageElement","URL","createObjectURL","revokeObjectURL","canCreateImageBitmap","canCreateOffscreenCanvas","isSVGFile","blob","getUniqueId","random","toString","substr","functionToBlob","fn","Blob","wrapFunction","workerPool","Map","thread","transferList","workerKey","pooledWorker","get","workerFn","url","messages","worker","Worker","terminate","onmessage","e","id","content","error","has","message","delete","messageId","postMessage","blobToImageData","done","createImageBitmap","then","bitmap","OffscreenCanvas","catch","canvasToBlob","mimeType","quality","toBlob","imageDataToBlob","blobReadSection","size","blobWriteSection","section","getExtensionFromMimeType","match","getFilenameWithoutExtension","lastIndexOf","getExtensionFromFilename","filename","split","pop","ImageExtensionsRegex","getMimeTypeFromExtension","ext","getMimeTypeFromFilename","toLowerCase","matchFilenameToMimeType","fileMimeType","targetMimeTypeExtension","blobToFile","mimetype","lastModified","Date","getTime","blobHasMimeType","blobMimeType","getAspectRatio","w","passthrough","v","PI","HALF_PI","QUART_PI","isRotatedSideways","a","rotationLimited","abs","scale","value","scalar","pivot","ellipseCreateFromRect","rect","x","y","rx","ry","vectorCreateEmpty","vectorCreate","vectorCreateFromSize","vectorCreateFromPointerEvent","pageX","pageY","vectorCreateFromPointerEventOffset","offsetX","offsetY","vectorClone","vectorInvert","vectorPerpendicular","vectorRotate","radians","cos","sin","tx","ty","vectorLength","vectorNormalize","vectorAngle","atan2","vectorAngleBetween","b","vectorEqual","vectorApply","vectorAdd","vectorSubtract","vectorMultiply","f","vectorDot","vectorDistanceSquared","vectorDistance","vectorCenter","vectorsFlip","points","flipX","flipY","cx","cy","point","vectorsRotate","angle","s","c","p","toSize","sizeClone","sizeCreateFromAny","sizeCreateFromRect","r","sizeCreateFromArray","sizeCreate","sizeEqual","format","sizeScale","sizeCenter","sizeRotate","sizeTurn","sizeContains","sizeApply","sizeHypotenuse","sizeMin","min","lineCreate","start","end","lineClone","line","lineExtend","amount","vn","vm","lineMultiply","CornerSigns","toRect","rectClone","rectCreateEmpty","rectCreateFromDimensions","rectCreateFromSize","rectCreateFromAny","rectCreateFromPoints","pts","Array","isArray","xMin","xMax","yMin","yMax","max","rectCreateFromEllipse","ellipse","rectCreate","rectCreateWithCenter","center","rectCenter","rectTranslate","t","rectScale","rectMultiply","factor","rectDivide","rectSubtract","rectAdd","rectEqual","rectAspectRatio","rectUpdate","rectUpdateWithRect","rectRotate","rectGetCorners","map","vertex","rectCenterRect","rectContainsPoint","rectCoverRect","aspectRatio","inputAspectRatio","rectContainRect","rectToBounds","rectApply","rectApplyPerspective","perspective","corner","index","sign","rectNormalizeOffset","quadCentroid","first","last","push","twicearea","nPts","p1","p2","j","lineLineIntersection","_lineLineIntersection","d","uA","uB","linePointsIntersection","vertices","l","intersections","intersection","polyPointIntersectionConvex","ax","ay","bx","by","edgex","edgey","quadLines","arr","next","getImageTransformedRect","imageSize","imageRotation","imageRect","imageCenter","imageTransformedVertices","isElement","HTMLElement","RegExp","nodeName","isFile","File","isString","canvasToFile","getFilenameFromURL","shift","isSafari","isSafari$1","navigator","userAgent","getImageElementSize","shouldAutoRemove","parentNode","body","measure","hasSize","removeChild","clearInterval","intervalId","setInterval","getImageSize","awaitComplete","imageToFile","isDataURI","str","isUserAgent","result$2","isInternetExplorer","dataURIToBlob","dataURI","parts","byteString","atob","ab","ia","Uint8Array","charCodeAt","dataURIToFile","res","fetch","getResponseHeader","xhr","header","parse","getAllResponseHeaders","indexOf","getFilenameFromContentDisposition","matches","splice","trim","replace","filter","decodeURI","DokaErrorCode","URL_REQUEST","DOCTYPE_MISSING","DokaError","Error","constructor","code","metadata","fetchFile","handleError","XMLHttpRequest","response","status","open","responseType","send","urlToFile","isBlob","srcToFile","orientImageSize","arrayBufferReadImageHead","markerLength","isData","readExifOrientation$1","arrayBufferReadExifOrientationTag","arrayBufferWriteExifOrientationTag","orientationCorrected","writeExifOrientation","setUint16","isJPEG","isPlainObject","stringify","JSON","post","dataset","token","beforeSend","cancel","request","abort","upload","ontimeout","encodeURI","reduce","formData","append","FormData","ctxRotate","rotation","translate","rotate","ctxTranslate","ctxScale","cropImageData","crop","shouldFlip","shouldRotate","cropDefined","cropCoversImage","shouldCrop","imageDataOut","restore","outputSize","resizeTransform","originWidth","originHeight","targetWidth","round","targetHeight","inputData","outputData","Uint8ClampedArray","ratioWidth","ratioHeight","ratioWidthHalf","ceil","ratioHeightHalf","x2","weight","weights","weightsAlpha","g","centerY","yy","dy","centerX","w0","xx","dx","ref","imageDataObjectToImageData","ImageData","createImageData","resizeImageData","fit","upscale","scalarWidth","scalarHeight","buffer","colorEffect","matrix","m11","m12","m13","m14","m15","m21","m22","m23","m24","m25","m31","m32","m33","m34","m35","m41","m42","m43","m44","m45","mr","mg","mb","ma","or","og","ob","convolutionEffect","kernelWeight","prev","curr","inputWidth","inputHeight","side","sideHalf","scy","scx","srcOff","vignetteEffect","strength","dist","dm","noiseEffect","level","monochrome","average","rand","gammaEffect","pow","isIdentityMatrix","filterImageData","colorMatrix","convolutionMatrix","gamma","gammaLevel","noise","noiseLevel","vignette","vignetteStrength","filters","clarity","chain","transforms","filterChain","filterInstructions","isNumber","isEmoji","hasProp","hasOwnProperty","isObject","copy","val","deepCopy","dst","keys","isFunction","result$3","isMac","platform","result$4","isIOS","maxTouchPoints","isApple","isWindows","fontSize","hasSetValues","getEmojiSVG","emoji","alt","SVGToDataURL","svg","isBinary","toPercentage","loadImage","onsize","sizeCalculated","reportSize","colorArrayToRGBA","color","textPadding","fontOffsetBrowser","getBrowserFontOffset","createSimpleContext","updateTextContext","fillText","step","to","from","fontFamily","fontWeight","fontVariant","fontStyle","textAlign","font","textBaseline","fillStyle","createSimpleTextContext","computeLineHeight","lineHeight","getMeasureVisibleWidth","actualBoundingBoxLeft","actualBoundingBoxRight","resizeContextToFitText","text","measureTextContext","computedLineHeight","storedTextAlign","lines","lineWidth","measureText","TextSizeCache","createTextSizeHash","join","textSize","wrapText","hash","lineBuffer","lineIndex","measureWidth","paragraphs","pushLine","fitChar","char","testLine","fitWord","word","drawText","browserFontOffset","fontOffsetX","fontOffsetY","lineHeightComputed","shapeContain","shape","parentRect","shapeAspectRatio","containedShape","shapeCenter","position","shapeDeepCopy","shapeShallowCopy","backgroundImageElement","getContextSize","context","contextAspectRatio","parseFloat","Number","MAX_SAFE_INTEGER","shapeCreateFromEmoji","props","backgroundImage","shapeCreateFromImage","oncomplete","backgroundColor","shapeLoadResources","isComplete","isError","isLoading","updateShapeSize","backgroundSize","finally","shapeCreateFromPreset","preset","setTimeout","shapeOptions","disableStyle","disableFlip","shapeComputeDisplay","shapeLineGetStartPoint","x1","y1","shapeLineGetEndPoint","y2","shapeTextUID","shapeIsText","shapeIsTextLine","shapeHasRelativeSize","shapeIsTextBox","shapeIsRect","shapeHasComputedSize","shapeIsEllipse","shapeIsLine","shapeIsTriangle","shapeIsPath","shapeIsTextEmpty","shapeIsTextEditing","isEditing","shapeIsVisible","opacity","shapeIsSelected","isSelected","shapeIsDraft","isDraft","shapeHasSize","shapeHasNumericStroke","strokeWidth","shapeHasRelativePosition","hasRight","hasBottom","shapeHasTexture","shapeSelect","shapeMakeDraft","shapeCanStyle","includes","shapeCanErase","disableErase","shapeCanSelect","disableSelect","shapeCanRemove","disableRemove","shapeCanDuplicate","disableDuplicate","shapeCanMove","shapeCanReorder","disableReorder","shapeCanFlip","shapeCanInput","input","disableInput","disableMove","shapeCanResize","disableResize","shapeCanRotate","disableRotate","shapeDeleteRelativeProps","left","right","top","bottom","shapeDeleteTransformProps","shapeFormatStroke","strokeColor","shapeFormatFill","autoLineHeight","shapeFormatText","shapeFormatTextLine","shapeFormatTextBox","shapeFormatRect","cornerRadius","shapeFormatTriangle","shapeFormatEllipse","shapeFormatPath","shapeFormatLine","lineStart","lineEnd","shapeFormatDefaults","shapeFormat","shapeGetDescription","toPixelValue","percentage","shapeComputeValue","prop","displayProps","shapeComputeRect","shapeGetPropPixelTotal","shapeUpdateProp","shapeGetPropPixelValue","shapeGetPropsPixelValues","shapeUpdateProps","shapeComputeTransform","x3","y3","shapeGetCenter","shapeComputeLineEnd","direction","isSolid","scaledSize","sh","normal","anchor","positionUpdated","tipOffset","inset","arrowOffset","tipLeft","tipRight","ctxRoundRect","radius","beginPath","moveTo","arcTo","closePath","defineRectShape","fillRectShape","fill","strokeRectShape","stroke","drawRect","strokeStyle","globalAlpha","sX","sY","sWidth","sHeight","dX","dY","dWidth","dHeight","save","clip","drawEllipse","drawText$1","drawLine","lineStartPosition","lineEndPosition","lineStartDescription","lineEndDescription","lineTo","Boolean","drawPath","ctxFlip","drawShape","drawShapes","shapes","drawnShapes","drawImageData","computedShapes","fillImageData","globalCompositeOperation","fillRect","dotColorMatrix","getColorMatrixFromColorMatrices","colorMatrices","previous","current","connect","getter","setter","state","progressUpdated","event","AnyToFile","srcProp","destProp","BlobReadImageSize","ImageSizeMatchOrientation","srcSize","srcOrientation","destSize","BlobReadImageHead","head","ImageHeadReadExifOrientationTag","ImageHeadClearExifOrientationTag","ApplyCanvasScalar","srcImageSize","srcCanvasSize","srcImageState","destImageSize","destScalar","naturalSize","canvasSize","imageState","annotation","decoration","origin","BlobToImageData","ImageDataMatchOrientation","srcImageData","ImageDataFill","ImageDataCrop","ImageDataResize","resize","destImageScaledSize","targetSize","ImageDataFilter","destImageData","ImageDataAnnotate","rotatedRect","rotatedSize","ImageDataDecorate","ImageDataToBlob","srcFile","destBlob","BlobWriteImageHead","srcBlob","srcHead","BlobToFile","renameFile","destFile","defaultFilename","Store","dest","destStore","PropFilter","allowlist","createDefaultImageReader","orientImage","outputProps","preprocessImageFile","createDefaultImageWriter","Infinity","copyImageHead","store","preprocessImageState","postprocessImageData","noop$1","identity","assign","tar","k","run","blank_object","create","run_all","fns","is_function","thing","safe_not_equal","is_empty","subscribe","callbacks","unsub","unsubscribe","get_store_value","_","component_subscribe","component","callback","$$","on_destroy","create_slot","definition","$$scope","slot_ctx","get_slot_context","get_slot_changes","dirty","lets","merged","len","update_slot","slot","slot_definition","get_slot_changes_fn","get_slot_context_fn","slot_changes","slot_context","exclude_internal_props","set_store_value","ret","action_destroyer","action_result","destroy","is_client","now","performance","raf","cb","requestAnimationFrame","tasks","Set","run_tasks","task","loop","promise","fulfill","add","target","node","insert","insertBefore","detach","element","svg_element","createElementNS","createTextNode","space","empty","listen","handler","addEventListener","removeEventListener","prevent_default","preventDefault","call","stop_propagation","stopPropagation","attr","attribute","removeAttribute","getAttribute","set_attributes","childNodes","set_data","wholeText","set_input_value","set_style","important","setProperty","custom_event","detail","createEvent","initCustomEvent","active_docs","active","create_rule","duration","delay","ease","uid","keyframes","rule","doc","ownerDocument","stylesheet","__svelte_stylesheet","sheet","current_rules","__svelte_rules","insertRule","cssRules","animation","delete_rule","anim","deleted","clear_rules","deleteRule","clear","current_component","set_current_component","get_current_component","onMount","on_mount","afterUpdate","after_update","onDestroy","createEventDispatcher","setContext","bubble","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","update_scheduled","schedule_update","flush","add_render_callback","add_flush_callback","flushing","seen_callbacks","update","fragment","before_update","wait","dispatch","kind","dispatchEvent","outroing","outros","group_outros","check_outros","transition_in","block","local","transition_out","o","null_transition","create_bidirectional_transition","params","intro","config","running_program","pending_program","animation_name","clear_animation","init","program","group","go","easing","tick","css","globals","globalThis","global","destroy_block","lookup","outro_and_destroy_block","update_keyed_each","old_blocks","get_key","dynamic","list","create_each_block","get_context","n","old_indexes","new_blocks","new_lookup","deltas","child_ctx","will_move","did_move","m","new_block","old_block","new_key","old_key","get_spread_update","levels","updates","to_null_out","accounted_for","get_spread_object","spread_props","bind","bound","create_component","mount_component","new_on_destroy","destroy_component","detaching","make_dirty","instance","create_fragment","not_equal","parent_component","prop_values","skip_bound","rest","hydrate","nodes","SvelteComponent","$destroy","$on","$set","$$props","$$set","subscriber_queue","readable","writable","stop","subscribers","new_value","run_queue","invalidate","subscriber","derived","stores","initial_value","single","stores_array","auto","inited","values","pending","cleanup","sync","unsubscribers","mergeObjects","objects","UPDATE_VALUE","updateValue","DEFAULT_VALUE","defaultValue","CUSTOM_STORE","DERIVED_STORE","UNIQUE_DERIVED_STORE","selectedStores","isEqual","isFirst","currentValue","storeValues","MAP_STORE","valueMapper","paramStores","storedItems","$paramStores","mapValue","item","setValue","items","mappedItems","createStore","accessors","storeInstance","onUpdate","ignoreFirstCallback","updateStoreValue","nextValue","previousValue","createStores","opts","property","defineProperty","pubsub","subs","sub","pub","capitalizeFirstLetter","charAt","toUpperCase","defineMethods","object","api","descriptor","fixPrecision","precision","toFixed","offsetRectToFitPolygon","poly","polyLines","rectVertexes","ray","lineExtended","rectOffset","rectOffsetVertices","fits","every","limitCropRectToImage","rectCenterPosition","rectVertex","intersectionFound","tlbr","trbl","rectLimitedVertices","rectLimitedToImage","getImagePolygon","imagePerspective","imagePoly","imageVertex","imagePolyBounds","getMaxSizeInRect","innerAngle","rotationSigned","rotationSignedMod","rotationSignedModHalf","hyp","limitRectToImage","minSize","imagePolygon","maxSizeInRect","canFit","wasLimited","intendedAspectRatio","intendedCenter","containedRect","applyCropRectAction","cropRectPrevious","cropRectNext","cropLimitToImageBounds","cropMinSize","cropMaxSize","maxSize","maxScalar","minScalar","cropRectOut","previousCropRectCenter","nextCropRectCenter","cw","ch","getBaseCropRect","transformedCropRect","imageRotatedBoundsCenter","cropCenterInTransformedImage","deRotatedCropCenter","cropFromCenterOfTransformedImage","originalCropCenterOffset","clamp","applyRotationAction","imageRotationPrevious","imageRotationRange","cropRect","cropRectOrigin","didAttemptDoubleTurn","rotationPrevious","cropRectBase","imageTransformedCorners","perspectiveOffset","cropCenter","rotateCropOffset","imageBoundsRect","imageCentroid","cropOffset","isTurn","imageTurns","imageRotationClamped","ORDERED_STATE_PROPS","clone","excludedShapeProps","isSerializeAble","filterShapeState","stateStore","observedStores","setState","cropOrigin","toNumericAspectRatio","arrayEqual","result$5","isAndroid","result$6","isFirefox","result$7","isEdge","vendor","getBrowserVendor","maxCanvasSze","getMaxCanvasSize","sizes","android","ios","chrome","firefox","edge","ie","density","padColorArray","MIN_ROTATION","MAX_ROTATION","isCropCentered","imageRotatedVertices","imageBoundsCenter","isCropMaxSize","updateCropRect","cropNext","cropPrevious","loadState","cropLimitToImage","beforeComplete","cropOut","updateCropAspectRatio","aspectRatioNext","cropSize","updateCropLimitToImage","limitToImageNext","limitToImagePrevious","updateRotation","rotationNext","rotationRange","cropWasAtMaxSize","cropWasCentered","updateRotationRange","imageIsRotatedSideways","requiredSpace","availableSpace","imageWidth","imageHeight","acos","asin","rangeHorizontal","rangeVertical","isNaN","range","rangeMin","rangeMax","updateCropRange","cropAspectRatio","prepareShape","isFormatted","imageProps","$size","perspectiveX","perspectiveY","$rotation","prevValue","$crop","$cropSize","cropRectAspectRatio","$cropRectAspectRatio","$cropMinSize","$cropMaxSize","$cropLimitToImage","prevRange","nextRange","$isRotatedSideways","process","chainTasks","chainOptions","processOptions","ontaskstart","ontaskprogress","ontaskend","cancelled","entries","createImage","createProcessingHandler","stateProp","eventKey","getStore","setStore","timeStamp","hasError","onabort","taskProgress","taskLengthComputable","ontaskerror","read","imageReadToken","imageReadCancelled","imageReadHandler","readerState","readerOptions","output","minWidth","minHeight","write","writer","processState","imageWriteHandler","writerState","imageWriteToken","writerOptions","on","editorEventsToBubble","imagePrivateProps","editorPrivateProps","getImagePropGroupedName","getEditorProps","imageProperties","getImagePublicPropNames","editorProperties","concat","createImageEditor","getImageObjSafe","images","initialImageProps","unsubSrc","imageReader","loadSrc","unsubReader","getImage","imageLoadAbort","minImageSize","removeImage","unsubReject","unsubResolve","normalizedOptions","groupedPropName","imageWriter","imageProcessAbort","processImage","abortProcessImage","abortLoadImage","editImage","getComponentExportedProps","Component","prototype","circOut","is_date","get_interpolator","bi","delta","interpolators","tweened","defaults","target_value","previous_task","started","interpolate","elapsed","tick_spring","last_value","current_value","velocity","dt","spring","stiffness","damper","damping","acceleration","inv_mass","settled","next_value","last_time","current_token","inv_mass_recovery_rate","cancel_task","hard","soft","rate","fulfil","prefersReducedMotion","mql","matchMedia","onchange","hasResizeObserver","rectNext","updateNodeRect","CustomEvent","measureViewRect","clientRect","getBoundingClientRect","measureOffset","offsetLeft","offsetTop","offsetWidth","offsetHeight","elements","frame","observer","measurable","observePosition","observeViewRect","once","disabled","ResizeObserver","entry","observe","unobserve","focusvisible","isKeyboardInteraction","handlePointerdown","handleKeydown","handleKeyup","handleFocus","focusVisible","handleBlur","pointerdown","keydown","keyup","focus","blur","isImage","getFilesFromEvent","files","dataTransfer","getAsFile","dropable","handleDragOver","handleDrop","result$8","supportsWebGL2","isPowerOf2","stringReplace","prefix","postfix","SHADER_FRAG_HEAD","SHADER_FRAG_INIT","SHADER_FRAG_MASK","SHADER_FRAG_MASK_APPLY","SHADER_FRAG_MASK_FEATHER_APPLY","SHADER_FRAG_RECT_AA","SHADER_FRAG_CORNER_RADIUS","SHADER_FRAG_SHAPE_BLEND_COLOR","SHADER_FRAG_TEXTURE_COLORIZE","SHADER_VERT_HEAD","SHADER_VERT_MULTIPLY_MATRUX","SHADER_VERT_TEXTURE","SHADER_VERT_SNIPPETS","SHADER_FRAG_SNIPPETS","mask","colorize","maskapply","maskfeatherapply","edgeaa","cornerradius","fragcolor","transpileShader","gl","VERTEX_SHADER","FRAGMENT_SHADER","compileShader","shader","createShader","transpiledSrc","shaderSource","getShaderParameter","COMPILE_STATUS","console","getShaderInfoLog","vertexShader","fragmentShader","attribs","uniforms","createProgram","attachShader","linkProgram","locations","getAttribLocation","getUniformLocation","canMipMap","source","applyTextureProperties","texParameteri","TEXTURE_2D","TEXTURE_MIN_FILTER","LINEAR_MIPMAP_LINEAR","LINEAR","TEXTURE_MAG_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","generateMipmap","createTexture","texture","bindTexture","texImage2D","RGBA","UNSIGNED_BYTE","applyOpacity","mat4Create","mat","Float32Array","mat4Perspective","fovy","aspect","near","far","tan","nf","mat4Ortho","lr","bt","mat4Translate","z","mat4Scale","mat4ScaleX","mat4ScaleY","mat4RotateX","rad","a10","a11","a12","a13","a20","a21","a22","a23","mat4RotateY","a00","a01","a02","a03","mat4RotateZ","degToRad","degrees","previewFragmentShader","previewVertexShader","pathVertexShader","pathFragmentShader","rectVertexShader","rectFragmentShader","ellipseVertexShader","ellipseFragmentShader","triangleVertexShader","triangleFragmentShader","createPathSegment","bc","tangent","miter","miterLength","createPathVertices","close","stride","rectPointsToVertices","trianglePointToVertices","createRectPoints","corners","createEllipseOutline","createRectOutline","tl","tr","bl","br","pushRectCornerPoints","getWebGLContext","attrs","rectUV","createGLImageDrawer","pixelDensity","viewSize","viewSizeVisual","viewAspectRatio","viewPixelDensity","viewZ","markupMatrixCanvas","markupMatrixFrameBuffer","markupMatrix","imagePositions","maskTop","maskRight","maskBottom","maskLeft","maskOpacity","maskBounds","canvasColor","TEXTURE_WHITE_INDEX","TEXTURE_TRANSPARENT_INDEX","TEXTURE_PREVIEW_MARKUP_INDEX","TEXTURE_PREVIEW_INDEX","TEXTURE_OFFSET","textures","setTextureObject","storedTexture","deleteTexture","textureAspectRatio","getTextureSize","getAvailableTextureIndex","findIndex","addTextureObject","addTexture","setTexture","reserveTexture","removeTexture","bindFramebuffer","FRAMEBUFFER","fb","framebufferTexture2D","COLOR_ATTACHMENT0","bindBuffer","ARRAY_BUFFER","imagePositionsBuffer","bufferData","STATIC_DRAW","FOV_TAN_HALF","FOV","antialias","alpha","premultipliedAlpha","getExtension","disable","DEPTH_TEST","enable","BLEND","blendFunc","ONE","ONE_MINUS_SRC_ALPHA","pixelStorei","UNPACK_PREMULTIPLY_ALPHA_WEBGL","whiteTexture","transparentTexture","imageMarkupTexture","createFramebuffer","createBuffer","texturePositionsBuffer","imageCoordinateCount","previewShader","useProgram","drawPreviewImage","originX","originY","translateX","translateY","rotateX","rotateY","rotateZ","maskFeather","maskCornerRadius","imageBackgroundColor","imageOverlayColor","enableMarkup","enableVertexAttribArray","aPosition","aTexCoord","previewTexture","uniform1i","uTexture","uniform2f","uTextureSize","activeTexture","TEXTURE0","textureIndex","markupTexture","uTextureMarkup","vertexAttribPointer","FLOAT","uniformMatrix4fv","uMatrix","uniform4fv","uOverlayColor","uFillColor","clarityWeight","uniform1fv","uClarityKernel","uniform1f","uClarityKernelWeight","uColorGamma","uColorVignette","uniform4f","uColorOffset","uColorMatrix","uOpacity","uMaskOpacity","uMaskBounds","uMaskCornerRadius","uMaskFeather","drawArrays","TRIANGLE_STRIP","disableVertexAttribArray","pathShader","pathBuffer","strokePath","aNormal","aMiter","BYTES_PER_ELEMENT","normalOffset","miterOffset","uWidth","uColor","uCanvasColor","triangleShader","triangleBuffer","fillTriangle","rectShaderAttributes","rectShaderUniforms","rectShader","rectBuffer","rectTextureBuffer","rectCornerBuffer","rectTextureColorFilter","colorFilter","uv","aRectCoord","uTextureColor","uTextureOpacity","uniform2fv","uSize","uPosition","uCornerRadius","ellipseShader","ellipseBuffer","ellipseTextureBuffer","fillEllipse","inverted","uRadius","uInverted","drawTriangle","clonedPoints","getBackgroundUV","backgroundPosition","limitCornerRadius","rectOut","cornerRadiusOut","rectFill","setCanvasColor","drawToCanvas","viewport","drawingBufferWidth","drawingBufferHeight","colorMask","clearColor","COLOR_BUFFER_BIT","drawToFramebuffer","enableMask","maskX","maskY","maskWidth","maskHeight","disableMask","release","div","canvas_1","measurable_action","mounted","dispose","$$self","$$invalidate","$imageMain","$background","$mask","COLOR_MATRIX_IDENTITY","animate","imagePreviews","maskRect","pixelRatio","willRender","loadImageData","updateSpring","blendWithCanvasBackground","back","front","bR","bG","bB","fR","fG","fB","fA","SPRING_PROPS","SPRING_PROPS_FRACTION","background","translation","imageMain","$origin","$translation","$perspective","$scale","$opacity","$colorMatrix","$maskOpacity","$clarity","$gamma","$vignette","$imageBackgroundColor","maskOpacityClamped","overlayColor","webGLImageDrawer","enableShapes","TextureUnits","getShapeImageTexture","drawUpdate","TEXT_MEASURE_CONTEXT","getShapeTextTexture","textString","textUID","contextMinWidth","getShapeTexture","textureSize","shapeRect","shapeCornerRadius","redraw","imageMask","imageMaskOpacity","hasAnnotations","annotationShapes","hasImageBackgroundColor","hasTransparentOverlay","usedTextures","backR","backG","backB","frontA","frontR","frontG","frontB","decorationShapes","interfaceShapes","registeredTextureUnit","isUsed","find","usedTextureUnit","handleSizeChange","canvas_1_binding","$$value","canDraw","Canvas","arrayJoin","get_default_slot_changes","tab","get_default_slot_context","get_each_context","key_1","li","button","button_aria_controls_value","button_id_value","button_aria_selected_value","button_disabled_value","default_slot_template","default","default_slot","keydown_handler","click_handler","href","tabId","selected","new_ctx","create_fragment$1","ul","each_blocks","each_1_lookup","ul_class_value","each_value","instance$1","$$slots","slots","root","class","klass","tabs","layout","focusTab","querySelectorAll","handleClickTab","handleKeyTab","ul_binding","tabNodes","isActive","TabList","get_default_slot_changes$1","panel","panelIsActive","get_default_slot_context$1","get_each_context$1","panelId","tabindex","labelledBy","hidden","visible","create_each_block$1","div_class_value","div_hidden_value","div_id_value","div_tabindex_value","div_aria_labelledby_value","div_data_inert_value","create_fragment$2","instance$2","panelClass","panels","measure_handler","panelNodes","isVisible","TabPanels","create_fragment$3","switch_instance","updating_name","switch_instance_spread_levels","switch_instance_name_binding","switch_value","switch_props","switch_instance_props","switch_instance_changes","old_component","instance$3","$opacityClamped","$isActivePrivateStore","locale","opacityClamped","isHidden","isActivePrivateStore","stateProps","isActiveFraction","componentView","componentExportedProps","componentComputedProps","computedProps","componentComputedStateProps","computedStateProps","panelName","hasBeenMounted","preMountRect","mountRectTimeout","clearTimeout","switch_instance_binding","componentProps","Panel","create_fragment$4","svg_viewBox_value","instance$4","Icon","isEventTarget","contains","create_if_block_1","icon_1","create_default_slot","icon_1_changes","innerHTML","create_if_block","span","fallback_block","if_block0","if_block1","create_fragment$5","action_action","default_slot_or_fallback","arguments","instance$5","label","labelClass","innerClass","hideLabel","icon","onclick","onkeydown","action","isEventTarget$1","getElement","button_binding","elButtonInnerClass","elButtonClass","elLabelClass","Button","arrayRemove","array","predicate","INERTIA_THRESHOLD","INERTIA_DISTANCE_MULTIPLIER","INERTIA_DURATION_MULTIPLIER","TAP_DURATION_MAX","TAP_DISTANCE_MAX","DOUBLE_TAP_DURATION_MAX","DOUBLE_TAP_DISTANCE_MAX","isContextMenuAction","getPinchScalar","interactable","inertia","matchTarget","pinch","getEventPosition","clientX","clientY","resetInertia","inertiaTweenUnsubscribe","pointers","addPointer","pointer","timeStampInitial","interactionState","getInteractionState","removePointer","pointerId","getPointerIndex","flattenPointerOrigin","updatePointer","getPointer","eventPosition","interactionDuration","isSingleTouching","isMultiTouching","getDistance","distanceTotal","distance","inertiaTween","pinchOffset","currentTranslation","currentScale","isGesture","lastTapTimeStamp","lastTapPosition","documentElement","handlePointermove","handlePointerup","pinchCurrent","removedPointer","isTap","isDoubleTap","interactionEnd","interactionDistanceSquared","inertiaPrevented","preventInertia","force","handleEnd","handleInertiaUpdate","inertiaTranslation","tapState","nudgeable","shiftMultiplier","bubbles","stopKeydownPropagation","isHorizontalDirection","isVerticalDirection","isShift","shiftKey","isHorizontalAction","isVerticalAction","multiplier","elastify","log10","elastifyRects","unitToPixels","parseInt","getWheelDelta","wheelDelta","wheelDeltaY","deltaY","create_fragment$6","div1","div0","interactable_action","div1_class_value","measurable_action_1","nudgeable_action","instance$6","$scrollOffset","$keysPressedStore","keysPressedStore","scrollState","scrollOrigin","scrollRect","scrollContainerRect","scrollReleased","scrollOffset","scrollBlockInteractionDist","scrollStep","scrollFocusMargin","scrollDirection","scrollAutoCancel","elasticity","onscroll","maskFeatherSize","maskFeatherStartOpacity","maskFeatherEndOpacity","scroll","container","overflowStyle","scrollAtRest","pos","limitOffsetToContainer","scrollFirstMove","scrollCancelled","scrollTranslationPrev","isHorizontalTranslation","speed","diff","handleDragStart","overflows","handleDragRelease","handleDragMove","setScrollOffset","elastic","handleDragEnd","offsetLimited","handleResizeScrollContainer","offsetVisual","snapToPosition","handleWheel","classList","currentScrollOffset","margin","handleScroll","handleNudge","div1_binding","axis","containerStyle","containerFeatherSize","containerState","childStyle","getComputedStyle","getPropertyValue","startOffset","endOffset","Scrollable","fade","create_fragment$7","measure_action","span_transition","instance$7","onmeasure","StatusMessage","create_fragment$8","span1","circle0","circle1","t0","span0","t1","instance$8","$animatedProgressClamped","progress","labelBusy","animatedValue","animatedProgressClamped","$animatedValue","formattedValue","circleValue","circleOpacity","ProgressIndicator","create_fragment$9","progressindicator","progressindicator_changes","instance$9","StatusProgress","get_each_context$2","create_else_block","switch_instance_anchor","create_if_block$1","dynamiccomponenttree","DynamicComponentTree_1","discardEmptyItems","div_levels","div_data","dynamiccomponenttree_changes","create_each_block$2","show_if","current_block_type_index","if_block","if_block_anchor","if_block_creators","if_blocks","select_block_type","previous_block_index","create_fragment$a","each_1_anchor","instance$a","shouldRenderItem","some","ImageStoreProps","proxy","publish","createImageProxy","unsubs","proxyStores","newImage","createPingRouter","route","isTextarea","isTextInput","isTextField","toKebabCase","abbr","matchMedia$1","query","addListener","removeListener","mediaQueryStore","formatValue","mm","canPreventNavSwipe","major","minor","calculateImageTransforms","stageRect","rootRect","imageSelectionRect","imageScale","imagePerspectiveX","imagePerspectiveY","imageFlipX","imageFlipY","viewRect","viewCenter","stageCenter","cropRectBaseCenter","imageTranslation","imageOffset","imageOrigin","imageSelectionCenter","imageSelectionOffset","historyCreate","getState","baseState","updateSubs","history","isInteger","undo","newIndex","redo","revert","isChrome","imageBitmapToImageData","imageBitmap","blobToImageBitmap","ImageOrienter","toImageData","imageDataContain","limit","getWebGLTextureSizeLimit","getParameter","MAX_TEXTURE_SIZE","getDevicePixelRatio","devicePixelRatio","hexToRGB","q","exec","colorStringToColorArray","isDarkColor","result$9","supportsWebGL","create_if_block$2","if_block1_anchor","create_if_block_5","create_if_block_1$1","p_style_value","div_style_value","create_if_block_6","create_if_block_7","create_if_block_9","statusmessage","statusprogress","create_if_block_10","statusmessage_changes","statusprogress_changes","create_if_block_8","span_style_value","create_default_slot_4","icon_changes","statusLabelButtonClose","statusIconButtonClose","button_changes","raw_value","iconSupportError","if_block2","t2","t3","create_if_block_4","create_if_block_3","create_if_block_2","create_else_block$1","select_block_type_1","canvas_changes","scrollable","scrollElasticity","create_default_slot_1","scrollable_changes","create_default_slot_3","create_default_slot_2","t1_value","tablist","tablist_spread_levels","tablist_props","tablist_changes","updating_component","panel_component_binding_1","panel_props","panel_changes","tabpanels","tabpanels_spread_levels","tabpanels_props","create_default_slot$1","tabpanels_changes","func","panel_component_binding","show_handler","hide_handler","fade_handler","create_fragment$b","focusvisible_action","dropable_action","imageCropRectElasticity","imageSelectionRectElasticity","rangeInputElasticity","instance$b","$images","$clientRect","$rootRect","$imageState","$imageLoadState","$imageCropRectSnapshot","$imageCropRectIntent","$previewShouldUpscale","$imageCropRect","$isInteracting","$imageSelectionRect","$imageSelectionRectIntent","$stageRect","$stageScalar","$imageSize","$presentationScalar","$imageSelectionRectSnapshot","$prefersReducedMotion","$tabRect","$history","$$unsubscribe_history","$$subscribe_history","$imageProcessingPreparing","$rootBackgroundColor","$env","$pointerAccuracy","$pointerHoverable","$imageTransforms","$imagePreviewModifiers","$imageEffects","$imageSelectionRectPresentation","$imageVisualLoadComplete","$imageFile","$imagePreview","$imageProcessState","$statusOpacity","$statusOffsetX","$progressOffsetX","$pressedKeysStore","$isInteractingFraction","$toolRect","$utilRect","$pixelRatio","$imagePreviews","$imageDecoration","$imageAnnotation","$imageOverlay","eventProxy","layoutMode","util","utils","animations","previewUpscale","elasticityMultiplier","willRevert","willRenderCanvas","willRenderToolbar","enableButtonExport","enableButtonRevert","enableNavigateHistory","enableToolbar","enableUtils","enableButtonClose","previewImageDataMaxSize","enableDropImage","imageOrienter","pluginComponents","pluginOptions","pluginInterface","registeredPluginsComponents","glMaxTextureSize","maxTextureSize","imageSourceToImageData","maxImageDataSize","imageProxy","imageFile","imageLoadState","imageProcessState","imageCropAspectRatio","imageCropLimitToImage","imageCropRect","imageCropMinSize","imageCropMaxSize","cropRange","imageCropRange","imageCropRectOrigin","imageCropRectAspectRatio","imageOutputSize","imageColorMatrix","imageConvolutionMatrix","imageGamma","imageVignette","imageNoise","imageDecoration","imageAnnotation","rootBackgroundColor","syncRootAspectRatio","tabRect","toolRect","utilRect","utiloffsetX","utilOffsetY","shouldRenderTabs","showUtils","isOverlayModeEnabled","pointerAccuracy","pointerHoverable","isInteracting","isInteractingFraction","animator","updater","previewShouldUpscale","stageScalar","isManipulatingImageCropRect","imageCropRectSnapshot","imageCropRectIntent","imageCropRectPresentation","instantUpdate","elasticRect","imageSelectionRectSnapshot","imageSelectionRectIntent","imageSelectionRectPresentation","imageCropRectFitsStage","centeredImageSelectionRect","presentationScalarSnapshot","cropRectClone","imageSelectionRectAspectRatio","selectionRect","imageScalar","selectionScaledWidth","selectionScaledHeight","presentationScalar","$imageScalar","imageSelectionGuides","$rect","showGrid","rows","cols","guides","yo","xo","imageOverlayMarkup","imageOverlay","$imageSelectionGuides","$imageOverlayMarkup","imageVisualLoadComplete","imagePreviewLoaderCancelToken","createImagePreviewLoader","timer","imagePreview","imagePreviewModifiers","imageTransforms","$imageCropRectPresentation","$imageRotation","$imageFlipX","$imageFlipY","imageEffects","$convolutionMatrix","$noise","effects","windowWidth","windowHeight","shouldPreventSwipe","env","initialPixelRatio","handleResolutionChange","resolutionObserver","shouldReset","imageProcessingPreparing","handleExport","statusOpacity","utilStores","utilsUniqueId","utilsVisible","iOS","syncBackgroundColor","colorString","rootElementComputedStyle","colorArray","handleTransitionEnd","propertyName","positionDecorationShape","canvasState","transformDecorationShape","flattenShapes","flattenedShapes","flattenShape","drawableShapes","loadTimer","statusOffsetX","progressOffsetX","hideStatus","offsetProgress","handleCloseImageLoadError","handleCloseImageProcessError","pressedKeysStore","keyCode","keySet","pressedKey","handleWindowBlur","handleContextMenu","handleDropFiles","getStageState","utilVisibility","utilsVisibleFraction","createCanvasState","rootPortal","rootPortalStore","onwindowresize","innerWidth","innerHeight","select_handler","utilSelected","measure_handler_1","measure_handler_2","func_1","measure_handler_3","show_handler_1","hide_handler_1","fade_handler_1","func_2","drawState","div_binding","div_binding_1","measure_handler_4","canAnimate","acceptsAnimations","shouldAnimate","canUndo","canRedo","utilsFiltered","utilsAvailable","utilsDefined","utilsMerged","utilTools","tabsConfig","className","isLandscape","horizontalSpace","hasLimitedSpace","verticalSpace","isModal","isCenteredHorizontally","isCenteredVertically","isCentered","isNarrow","isCompact","hasSwipeNavigation","shouldRenderUtilTools","envStr","missingFeatures","isSupportsError","isImageLoadError","isWaitingForImage","imageLoadProgress","isLoadingImageData","isCreatingImagePreview","isProcessingImage","imageLoadShowProgressIndicator","imageLoadStatusLabel","imageProcessStatusLabel","imageProcessProgress","imageProcessShowProgressIndicator","isImageProcessingError","isStatusVisible","handleTouchStart","toolbarItems","hasClientRect","canRender","routePing","plugin","changed","utilId","tabIcon","tabLabel","tools","hasToolbar","hasNavigation","labelSupportError","statusLabelLoadImage","statusLabelProcessImage","touches","labelClose","iconButtonClose","labelButtonRevert","iconButtonRevert","labelButtonUndo","iconButtonUndo","labelButtonRedo","iconButtonRedo","labelButtonExport","iconButtonExport","Ui","utilPrivateProps","viewPrivateProps","editorProps","pluginProps","propPluginRef","setEditorViewPlugins","getEditorViewProps","attachEditorView","editor","plugins","linkAccessors","destination","editorEvents","hasDoctype","doctype","initEditorView","warn","core","unsubInit","unsubCore","unsubView","handleEvent","handleEventUnsubs","appendEditor","querySelector","appendEditors","targets","document_1","create_fragment$c","instance$c","preventZoomViewport","hiding","showing","hasFocussedTextField","viewportDefaults","showTimeoutId","getViewPortElement","show","viewportElement","viewportRules","hide","focusOutTimer","focusInWindowHeight","handleFocusIn","handleFocusOut","windowCurrentHeight","runWhen","handleKey","targetElement","windowHeightComputed","measureElement","measureElementHeight","spawnMeasureElement","isIOSFooterVisible","Modal","createModal","parent","openEditor","modal","modalHandleEventUnsubs","overlayEditor","dispatchElementEvent","cancelable","dispatchEditorEvents","TAG","customElement","DokaImageEditorElement","customElements","define","whenDefined","_editor","_unsubs","observedAttributes","attributeChangedCallback","attrName","oldValue","newValue","connectedCallback","disconnectedCallback","arrayInsert","isNode","isNodeList","getNodeId","getNodeChildren","createNode","insertNode","needle","haystack","getIndex","nodeList","findNodeList","targetIndex","insertNodeBefore","insertNodeAfter","appendNode","findNode","removeNode","propertyMap","borderColor","borderWidth","fontColor","lineColor","convertValue","addValues","_a","_b","shapeFromLegacyMarkup","lineDecoration","lineStyle","borderStyle","widthAbsolute","heightAbsolute","getOffsetPointOnEdge","A","B","C","sinA","sinB","sinC","cosC","ratio","getRotatedRectSize","hor","ver","getBoundsAroundCenter","getCanvasSize","canvasAspectRatio","zoom","imageAspectRatio","imgWidth","imgHeight","getCenteredCropRect","getCorrectedLegacyAspectRatio","imagePropertiesFromLegacyCrop","flip","scaleToFit","isCenteredCrop","horizontal","flipHorizontal","vertical","flipVertical","correctedAspectRatio","cropLimit","cropCentered","rotatedCropSize","rotatedImageSize","rotatedImageCenter","rotatedImageOffset","cropPoints","cropBoundsPoints","cropBoundsPointsCenter","deRotatedCropBoundsPoints","isLegacyData","legacyDataToImageState","markup","sort","zIndex","brightness","contrast","exposure","saturation","isOperaMini","hasPromises","hasCreateObjectURL","hasVisibility","hasTiming","hasFileConstructor","result$a","isModernBrowser","toPercentageNumber","base","getLabel","getValue","matrices","temperature","finetuneControlConfigurationDefault","finetuneOptionsDefault","finetuneLabelBrightness","finetuneLabelContrast","finetuneLabelSaturation","finetuneLabelExposure","finetuneLabelTemperature","finetuneLabelGamma","finetuneLabelClarity","finetuneLabelVignette","finetuneControlConfiguration","finetuneOptions","pastel","fade$1","warm","cold","invert","monoDefault","monoNoir","monoWash","monoStark","sepiaDefault","sepiaBlues","sepiaRust","sepiaColor","filterFunctionsDefault","filterOptionsDefault","labelDefault","filterLabelChrome","filterLabelFade","filterLabelCold","filterLabelWarm","filterLabelPastel","filterLabelMonoDefault","filterLabelMonoNoir","filterLabelMonoStark","filterLabelMonoWash","filterLabelSepiaDefault","filterLabelSepiaRust","filterLabelSepiaBlues","filterLabelSepiaColor","defaults$1","filterFunctions","filterOptions","snapToPixel","get_details_slot_changes","get_details_slot_context","get_label_slot_changes","get_label_slot_context","create_default_slot$2","label_slot_template","label_slot","create_if_block_1$2","details_slot_template","details","details_slot","create_fragment$d","button_props","panelMargin","instance$d","$portalRootRect","$position","$offset","$portal","buttonClass","onshow","portal","portalRootRect","panelSize","buttonComponent","buttonRect","dir","isTargetSelf","downOutsidePanel","detailPanel","trigger","handleClick","buttonElement","handleButtonKeydown","handlePanelKeydown","isAnimating","handleDown","handleUp","parentLeft","parentTop","parentRight","parentBottom","panelLeft","panelTop","panelRight","panelBottom","positionedAboveButtonY","panelFitsAboveButton","Details","create_fragment$e","label_1","li_class_value","checked","instance$e","$keysPressedStored","keysPressedStored","change_handler","inputId","RadioItem","flattenOptions","isGroup","mapOption","option","optionMapper","mappedOption","mapOptions","opop","localize","localizeOptions","localizeOptions$1","get_option_slot_changes_1","get_option_slot_context_1","get_option_slot_changes","get_option_slot_context","get_each_context_1","get_group_slot_changes","get_group_slot_context","get_each_context$3","create_if_block_1$3","fieldset","fieldset_class_value","create_if_block_7$1","create_each_block$3","legend","legend_class_value","create_else_block$2","radioitem","create_default_slot_2$1","radioitem_changes","create_if_block_2$1","group_slot_template","group_slot","group_slot_or_fallback","fallback_block_1","each_value_1","create_each_block_1","create_if_block_6$1","create_default_slot_3$1","create_if_block_5$1","t_value","fallback_block_2","option_slot_template","option_slot","option_slot_or_fallback","create_if_block_4$1","create_default_slot_1$1","create_if_block_3$1","fallback_block$1","create_default_slot$3","create_fragment$f","instance$f","selectedIndex","optionFilter","optionLabelClass","title","optionClass","optionGroupClass","getOptionIndex","flattenedOptions","flattenedOption","isConfirm","changeSelection","payload","handleRadioKeydown","handleRadioClick","localizedOptions","mappedOptions","RadioGroup","isDeepEqual","create_if_block_2$2","create_default_slot_3$2","create_if_block_1$4","span_class_value","create_label_slot","span_title_value","create_group_slot","create_if_block$3","create_default_slot_2$2","create_option_slot","span1_style_value","span1_class_value","create_default_slot_1$2","create_details_slot","radiogroup","radiogroup_changes","create_default_slot$4","create_fragment$g","updating_isActive","details_isActive_binding","details_props","details_changes","instance$g","optionIconStyle","optionLabelStyle","getUndefinedOptionLabel","dropdownVisible","handleSelect","selectedLabel","handleShowPanel","optionValue","optionLabel","Dropdown","create_fragment$h","div3","input_1","div2","div2_style_value","div3_class_value","instance$h","trackStyle","knobStyle","inputOffsetX","pageOffsetX","setValueByOffsetX","handleInput","handlePointerDown","handlePointerMove","handlePointerUp","input_1_binding","Slider","RGBToHSV","HSVToRGB","create_fragment$i","instance$i","colorValue","ColorPreview","create_if_block_4$2","create_label_slot$1","colorpreview","colorpreview_changes","create_if_block_2$3","div0_style_value","div1_style_value","slider","create_if_block_3$2","slider_changes","create_if_block$4","create_default_slot_1$3","create_option_slot$1","create_group_slot$1","create_if_block_1$5","create_details_slot$1","create_default_slot$5","create_fragment$j","instance$j","hidePresetLabel","enableOpacity","enablePresets","enablePicker","hue","valueAsRGB","valueAsRGBA","valueAsRGBAFullyTransparent","valueAsRGBAFullyOpaque","valueAsRGBAFullySaturated","updateProps","syncControls","valueAsHSV","rgb","rgba","updateColorArray","updateHue","updateSaturationAndBrightness","updateOpacity","setValueByOffset","inputSize","inputOffset","inputPageOffset","sx","sy","div2_binding","ColorPicker","upperCaseFirstLetter","toLocaleFn","localePrefix","mapToSizeOption","createLocaleMapper","toolColorDefault","toolStrokeColorDefault","toolShapeDefaults","path","rectangle","createToolStyle","shapeDef","createToolStyles","sharpie","arrow","createToolbarItem","tool","createToolbar","createDefaultColorOptions","transparent","white","silver","gray","black","navy","blue","aqua","teal","olive","green","yellow","orange","red","maroon","fuchsia","purple","createDefaultFontSizeOptions","createDefaultFontScaleOptions","extraSmall","small","mediumSmall","medium","mediumLarge","large","extraLarge","createDefaultStrokeWidthOptions","createDefaultStrokeScaleOptions","createDefaultLineEndStyleOptions","createDefaultFontFamilyOptions","createDefaultTextAlignOptions","createDefaultFontStyleOptions","createColorOptions","colors","createFontSizeOptions","createFontScaleOptions","scales","createStrokeWidthOptions","createStrokeScaleOptions","createFontFamilyOptions","fonts","createFontStyleOptions","styles","createLineEndStyleOptions","createTextAlignOptions","align","createControlOptions","defaultKey","defaultOptions","createFontFamilyControl","fontFamilies","shapeTitleFontFamily","fontFamilyOption","stack","check","createBackgroundColorControl","shapeTitleBackgroundColor","createStrokeColorControl","shapeTitleStrokeColor","strokeWidthParsed","defaultStrokeWidth","createStrokeWidthControl","shapeTitleStrokeWidth","createLineControl","titleKey","createLineStartStyleControl","createLineEndStyleControl","createFontColorControl","shapeTitleTextColor","createFontStyleControl","shapeTitleFontStyle","createFontSizeControl","shapeTitleFontSize","createTextAlignControl","shapeTitleTextAlign","createLineHeightControl","shapeTitleLineHeight","createShapeStyleControls","colorOptions","strokeWidthOptions","lineEndStyleOptions","fontFamilyOptions","fontStyleOptions","fontSizeOptions","textAlignOptions","fontStyle_fontWeight","create_fragment$k","instance$k","handleResize","Measure","get_footer_slot_changes","get_footer_slot_context","get_main_slot_changes","get_main_slot_context","get_header_slot_changes","get_header_slot_context","create_if_block_2$4","header_slot_template","header_slot","fallback_block$2","create_if_block_1$6","footer_slot_template","footer","footer_slot","create_fragment$l","if_block2_anchor","main_slot_template","main","main_slot","main_slot_or_fallback","instance$l","hasHeader","hasFooter","$$new_props","Util","toFraction","create_if_block$5","create_fragment$m","radiusBig","radiusSmall","indicatorSpacing","indicatorInterval","indicatorCount","instance$m","labelReset","valueLabel","valueMin","valueMax","oninputstart","oninputmove","oninputend","number","increment","svgSize","svgPadding","getMask","limitedMin","limitedMax","fromSnapped","toSnapped","interactionOrigin","interactionReleased","interactionRange","interactionOptions","snap","valueToPosition","translatePosition","valueAtPosition","targetLimited","targetElastic","targetVisual","targetValid","positionToValue","handleReset","valueMinLimited","valueMaxLimited","barSize","fraction","currentPosition","updatePosition","positionTarget","baseFraction","isLimited","rangeMask","indicatorCenter","indicators","svgWidth","svgHeight","RangeInput","create_fragment$n","instance$n","childWidth","childMaxWidth","parentWidth","overflow","testOverflow","handleParentResizeEvent","handleChildResizeEvent","Toolbar","Direction","Top","Right","Bottom","Left","TopLeft","TopRight","BottomRight","BottomLeft","DirectionRectMap","get_each_context$4","create_each_block$4","div_data_direction_value","div_data_shape_value","create_fragment$o","instance$o","$selectionScale","$selectionOpacity","selectionScale","selectionOpacity","nudge","mappedDirections","isCorner","RectManipulator","getEventPositionInViewport","getEventPositionInStage","viewOffset","stageOffset","positionInViewport","DirectionInversionTable","DirectionCoordinateTable","getTranslationInfo","translateToRight","translateToLeft","translateToTop","translateToBottom","translateHorizontally","translateVertically","translateAxis","limitRectDirectionTranslation","bounds","anchorDirectionCoordinates","anchorPosition","targetDirectionCoordinates","targetPosition","interactionBounds","getInteractionBounds","innerR","inner","outerR","outer","innerL","outerL","innerB","outerB","innerT","outerT","pointerLength","pointerLengthMin","pointerLengthMax","pointerLengthLimited","pointerAspectRatio","pointerScaled","limitedBounds","maxSizeLimitedToBounds","maxSizeLimited","minSizeLimited","applyRectDirectionTranslation","radToDeg","create_fragment$p","rangeinput","rangeinput_changes","MARGIN","instance$p","QUARTER_PI","turns","ImageRotator","create_fragment$q","instance$q","ImageInfo","getSelectionPresetOptionIcon","aspectRatioDefined","strokeDashArray","create_default_slot_3$3","create_header_slot","toolbar","toolbar_changes","create_if_block_6$2","cropLabelButtonRecenter","cropIconButtonRecenter","create_if_block_5$2","rectmanipulator","rectmanipulator_changes","create_if_block_4$3","imageinfo","imageinfo_changes","create_main_slot","drag","create_if_block$6","create_if_block_3$3","create_default_slot_1$4","create_default_slot_2$3","create_if_block_2$5","imageZoomLevelBase","imageZoomLevelMax","create_if_block_1$7","imagerotator","imagerotator_changes","create_footer_slot","create_default_slot$6","create_fragment$r","updating_root","util_root_binding","util_props","util_changes","instance$r","$imageCropAspectRatio","$selectedPresetIndex","$imageOutputSize","$imageCropMinSize","$imageCropLimitToImage","$imageCropMaxSize","$imageCropRectOrigin","$imageCropRange","$imageCropRangeAspectRatio","$isActive","$$unsubscribe_isActive","$$subscribe_isActive","$footerOffset","$recenterOpacity","$recenterOffset","$imageRotationRange","$imageZoomLevelRange","$imageZoomLevel","cropImageSelectionCornerStyle","cropAutoCenterImageSelectionTimeout","cropEnableZoomMatchImageAspectRatio","cropEnableRotateMatchImageAspectRatio","cropEnableRotationInput","cropEnableZoom","cropEnableZoomInput","cropEnableImageSelection","cropEnableInfoIndicator","cropEnableZoomTowardsWheelPosition","cropEnableLimitWheelInputToCropSelection","cropEnableCenterImageSelection","cropEnableButtonRotateLeft","cropEnableButtonRotateRight","cropEnableButtonFlipHorizontal","cropEnableButtonFlipVertical","cropSelectPresetOptions","cropEnableSelectPreset","cropEnableButtonToggleCropLimit","isCustomCrop","turnAspectRatio","hasValidRotatedCropAspectRatio","rotatedImageCropAspectRatio","imageSizeRotated","canMatchCropAspectRatioToRotation","applyRotation","isRotated","imageSelectionRectMinSize","imageSelectionRectMaxSize","handleSelectionGrab","handleSelectionDrag","boundsLimited","boundsIntent","translateSelection","handleSelectionRelease","directionTranslation","rectIntended","cropAspectRatioLimited","translateUp","translateRight","translateLeft","translateDown","couldExceedBounds","cropSizeMax","imageIsRotated","rectLimited","handleRotateStart","handleRotateMove","handleRotateEnd","interactionCropRect","interactionCropRectForce","handleImageDragStart","handleImageDrag","manipulateImage","handleImageDragEnd","handleImageDragRelease","imageSelectionRectZoomFactor","scaledTranslation","cropIntent","forceTranslation","calculateZoomLevel","imageCropRangeAspectRatio","imageZoomLevelRange","rangeMinSize","rangeMaxSize","minZoom","maxZoom","imageZoomLevel","currentCropWidth","currentCropHeight","currentCropAspectRatio","imageCropMaxRect","snapshotCropRect","resizeImage","rangeWidth","rangeHeight","targetX","targetY","handleResizeStart","handleResizeMove","handleResizeEnd","zoomHistoryTimeoutId","stageWheelPosition","currentCropRect","isMinSize","isAtMaxCropSize","isImageSelectionCentered","newCropRect","selectionOffset","imageSelectionScale","expandedImageSelection","handleRecenterAction","cropAutoCenterImageSelectionTimeoutId","recenterOpacity","recenterOffset","footerOffset","selectedPresetIndex","$cropAspectRatio","matchedOptionValue","outputSizeMatches","aspectRatioMatches","getSelectionPresetLabelIcon","selectedValue","getCropBoundaryLabelIcon","isBoundToImage","cropUniqueId","transformInitial","transformToolInitial","transformSelected","interactable_function","imageZoomLevelMin","imageSelectionCenteredRect","isImageSelectionDisplayed","isResizingSelection","isMaxSelectionRect","isOverlayMode","canZoomToCenter","canCenter","shouldRenderInfoIndicator","shouldRenderImageSelection","shouldRenderImageSelectionRecenterButton","imageSelectionRectOffset","shouldRenderPresetSelect","hasPlentyVerticalSpace","shouldRenderToolbar","shouldRenderZoomInput","shouldRenderFooter","footerStyle","cropLabelButtonRotateLeft","cropIconButtonRotateLeft","cropLabelButtonRotateRight","cropIconButtonRotateRight","cropLabelButtonFlipHorizontal","cropIconButtonFlipHorizontal","cropLabelButtonFlipVertical","cropIconButtonFlipVertical","cropLabelSelectPreset","optionAspectRatio","maxCropSize","cropLabelCropBoundary","cropLabelCropBoundaryEdge","cropLabelCropBoundaryNone","maskMarkupOpacity","cropLabelTabRotation","cropLabelTabZoom","Crop","create_option_slot$2","assign_div1","unassign_div1","FILTER_PREVIEW_CLASS_NAME","create_default_slot_1$5","create_footer_slot$1","updating_maskFeatherStartOpacity","updating_maskFeatherEndOpacity","updating_maskFeatherSize","scrollable_maskFeatherStartOpacity_binding","scrollable_maskFeatherEndOpacity_binding","scrollable_maskFeatherSize_binding","scrollable_props","create_fragment$s","instance$s","$imageColorMatrix","$tileRects","$canvasSize","$imageGamma","$isActiveFraction","$$unsubscribe_isActiveFraction","$$subscribe_isActiveFraction","$imageTiles","getFilterIndex","filterOptionsFlattened","filterColorMatrix","tileRects","handleTileResize","tileRectFirst","cloneImageTransforms","tileCornerRadius","tileElements","tileLeftOpacity","tileRightOpacity","tileMargin","tileScrollOffset","tileScrollContainerRect","tileWrapperOffset","imageTiles","cloneImageTile","tile","handleChangeFilter","selectedFilterIndex","tileTopOffset","boundsX","containerLeft","containerRight","tileRect","tileLeft","tileRight","preview","clipX","clipWidth","Filter","index$1","create_default_slot_3$4","create_default_slot_2$4","create_default_slot_1$6","rangeinput_spread_levels","rangeinput_props","create_footer_slot$2","create_fragment$t","instance$t","$rangeInputConfig","$panelValues","imageEffectStores","panelValues","rangeInputConfig","updateRangeInputState","subscribePanelStores","tabSelected","Finetune","index$2","get_each_context$5","create_if_block_1$8","create_each_block$5","div_data_control_value","nudge_handler","create_if_block$7","create_fragment$u","instance$u","EIGTH_PI","N","N0","N1","S","S0","S1","E","E0","E1","W0","W1","NW","NW0","NW1","NE","NE0","NE1","SE","SE0","SE1","SW","SW0","SW1","rotatorPoint","enableResizing","enableRotating","handleKeyDown","handleKeyUp","indexes","getDirectionByAngle","isNorth","isSouth","isEast","isWest","isNorthEast","isNorthWest","isSouthEast","isSouthWest","mapPointsToControls","out","isLine","isAxisLimited","p0","cornerVector","mid","handleResizeNudge","handleRotateNudge","resizeAxis","resizeControls","rotationControlActive","ShapeManipulator","getEventPositionInEditor","cursorMoveToEnd","field","selectionStart","selectionEnd","result$b","supportsVisualViewport","createSoftKeyboardObserver","heightNormal","visualViewport","testState","create_fragment$v","button0","button1","button0_changes","button1_changes","panelDelay","instance$v","onconfirm","oncancel","autoFocus","autoPositionCursor","labelConfirm","labelConfirmShow","iconConfirm","labelCancel","labelCancelShow","iconCancel","panelOffset","panelVisible","panelHeight","panelRevealTimeout","panelPosition","panelOpacity","preventTextAreaScrollingOnIOS","lastScreenY","screenY","handleTouchMove","currentScreenY","scrollTop","scrollHeight","unsubSoftKeyboardListener","handleSoftKeyboard","keyboardState","shouldStickToKeyboard","focusDateTime","focusDuration","handleMeasure","computedStyle","InputForm","get_each_context$6","create_each_block$6","button_aria_label_value","create_if_block_2$6","shapemanipulator","shapemanipulator_changes","create_if_block_1$9","inputform","shapeLabelInputCancel","shapeIconInputCancel","shapeLabelInputConfirm","shapeIconInputConfirm","create_default_slot$7","inputform_changes","textarea","create_if_block$8","create_fragment$w","nav","ROTATION_CONTROL_OFFSET","MIN_TEXT_MARKUP_WIDTH","shapeControlDist","instance$w","$markupControlsOpacity","ui","oninteractionstart","oninteractionupdate","oninteractionrelease","oninteractionend","onaddshape","onupdateshape","onselectshape","onremoveshape","beforeSelectShape","beforeDeselectShape","beforeAddShape","beforeRemoveShape","beforeUpdateShape","willRenderShapeControls","mapEditorPointToImagePoint","mapImagePointToEditorPoint","enableButtonFlipVertical","updateShape","propsToUpdate","isPositionInRect","isPositionInEllipse","rx2","ry2","aa","bb","isPositionNearLine","begin","treshold","ba","ea","discriminant","createShape","shapeDefault","interactionRadius","interactionPosition","isEllipse","isText","isRelative","originPoint","addMarkupItemDraft","draft","getMarkupItemDraft","pointerPosition","moveDist","syncShapes","discardMarkupItemDraft","confirmMarkupItemDraft","mappedOriginPosition","mappedPointerPosition","selectShape","editMarkupItem","originMapped","originSnapped","interactionTarget","angleSnapInterval","angleSnapped","updateMarkupShape","eraseShape","positionPrevious","positionCurrent","shapesFound","getMarkupBetweenPoints","shapesRemoved","removeMarkupItems","getImagePointWithScreenTranslation","pointInScreenSpace","translateShape","shapeCurrent","shapeOriginComputed","beginImageOffset","endImageOffset","imagePoint","resizeMarkup","hasAutoHeight","shapeOriginRect","rectAligned","rectAlignedCenterPosition","rectRotation","rectAlignedCorners","rectCorners","cornerIndex","screenTargetPosition","imageTargetPosition","imageTargetTranslation","imageTargetTranslationAligned","imageTargetPositionAligned","rectAlignedResized","rr","rrc","rectUpdated","cornerA","cornerB","cornerAlignedA","cornerAlignedB","cornerAlignedC","cornerAlignedD","mappedIndex","midAligned","midAnchorAligned","rotatorInitialPosition","rotateMarkup","getMarkupShapeRect","shapeRotation","rotatorSnapInterval","lastMarkupItem","addShape","markupItem","updateMarkupShapeProperty","createMarkupItem","updateMarkupItemsShapeProperty","updateMarkupShapeItems","getActiveMarkupItem","reverse","hasActiveMarkupItem","removeShape","shapeToRemove","markupWithoutShape","removeActiveMarkupItem","activeShape","removableShapes","didRemove","previousSelectedShape","blurShapes","indexNext","getSelectedShape","selectedShape","deselectMarkupItem","finishEditMarkupItem","shapesToRemove","shapesToRemoveFiltered","getTextShapeRect","getShapesAtPosition","priority","computedShape","isPositionInBounds","isPositionInVisual","visualRect","eraseLine","getMarkupShapePoints","interactionTimer","interactionShape","interactionShapeOriginComputed","handleInteractionStart","foundShapes","targettedMarkupItem","handleInteractionUpdate","handleInteractionRelease","handleTextCancel","handleInteractionEnd","currentSelectedShape","isSelectInteraction","allowDeselectShape","getShapeRotationPoint","getShapeRotationPointOnScreen","markupPoint","screenPosition","screenOrigin","shapeManipulatorUid","guide","handleManipulatorResizeGrab","activeMarkup","activeMarkupComputed","handleManipulatorResizeDrag","handleManipulatorResizeEnd","handleManipulatorRotateGrab","handleManipulatorRotateDrag","handleManipulatorRotateEnd","textInput","getTextShapeOriginSnapshot","handleTextInput","filterNewlines","canInput","textShapeOrigin","textSizeCurrent","textRectCurrent","currentTopLeft","originTopLeft","textRectOrigin","handleEditTextActiveMarkup","handleTextInputAttempt","currentValueStart","substring","currentValueEnd","intendedValue","filteredValue","handleTextInputKeyDown","handleTextInputKeyUp","ctrlKey","altKey","handleTextConfirm","wasDraft","handleFlipX","handleFlipY","handleRemoveActiveMarkup","handleMoveToFrontActiveMarkup","handleDuplicateActiveMarkup","duplicationOffset","linePosition","getMarkupControlsAnchorPosition","markupControlsOpacity","shapeControlsSize","getShapeControlPositionOnCanvas","handleViewResize","isTextMarkupSelected","showShapeList","relatedTarget","textarea_binding","activeShapeId","activeMarkupItemIsDraft","shapeProps","shapeActivePoints","allowResizeControls","allowRotateControls","allowedResizeControls","shouldRenderShapeManipulator","shapeActiveScreenPoints","shapeManipulatorPoints","shapeManipulatorRotationPoint","shapeManipulatorRotationPointPosition","shapeOpacity","shouldRenderTextInput","textSizeOrigin","textInputText","markupTextInputStyle","controlledMarkupItem","allowShapeFlip","allowShapeDuplicate","allowShapeRemove","allowShapeReorder","allowShapeInput","markupControlsAnchorPosition","shapeControlsPosition","markupControlsStyle","shapeControls","shapeNavList","segments","shapeTitleButtonFlipHorizontal","shapeIconButtonFlipHorizontal","shapeTitleButtonFlipVertical","shapeIconButtonFlipVertical","shapeTitleButtonMoveToFront","shapeIconButtonMoveToFront","shapeTitleButtonDuplicate","shapeIconButtonDuplicate","shapeTitleButtonRemove","shapeIconButtonRemove","shapeLabelInputText","ShapeLayoutEditor","get_each_context$7","create_if_block$9","previous_key","key_block_anchor","key_block","create_key_block","create_each_block$7","t0_value","create_default_slot$8","ul_transition","create_fragment$x","instance$x","controls","getShapeControls","shapeId","activeControls","controlKeys","styleKey","styleKeys","activeShapeHash","activeShapeHashPrev","ShapeStyleEditor","create_if_block_1$a","create_default_slot$9","shapeIconButtonSelectSticker","create_if_block$a","shapeLabelButtonSelectSticker","create_fragment$y","form","instance$y","oninput","formFileInput","handleFileInput","reset","form_binding","ShapePresetSelect","create_fragment$z","instance$z","html","ongrab","ondrag","ondrop","isOverButton","downPosition","handleMove","upPosition","DragButton","get_each_context$8","create_each_block$8","dragbutton","didMountPresetThumb_action","func_3","thumb","dragbutton_changes","create_fragment$A","instance$A","$anim","presets","onclickpreset","ongrabpreset","ondragpreset","ondroppreset","didMountPresetThumb","mount","firstChild","ShapePresetsList","isSVGMarkup","create_if_block_6$3","shapepresetselect","shapepresetselect_changes","create_if_block$b","create_if_block_1$b","create_else_block$3","create_if_block_5$3","create_default_slot_4$1","create_if_block_4$4","create_default_slot_2$5","create_default_slot$a","shapepresetslist","shapepresetslist_changes","create_if_block_3$4","create_default_slot_3$5","create_if_block_2$7","create_default_slot_1$7","create_fragment$B","instance$B","enableSelectImage","onaddpreset","isPresetGroup","getPresetThumb","getAltFromSrc","excludedStickerItemProps","mapPreset","mapPresets","presetsMapped","shouldRenderPresets","shouldGroupPresets","presetTabs","ShapePresetsPalette","createPingDispatcher","create_if_block_4$5","shapelayouteditor","updating_markup","updating_ui","shapelayouteditor_spread_levels","shapelayouteditor_markup_binding","shapelayouteditor_ui_binding","shapelayouteditor_props","shapelayouteditor_changes","create_main_slot$1","create_if_block_3$5","shapepresetspalette","shapepresetspalette_changes","create_if_block$c","create_if_block_2$8","create_else_block$4","create_default_slot_1$8","shapestyleeditor","shapestyleeditor_changes","create_if_block_1$c","create_default_slot_3$6","create_option_slot$3","create_footer_slot$3","create_default_slot$b","create_fragment$C","instance$C","$isVisible","$$unsubscribe_isVisible","$$subscribe_isVisible","$shapes","$$unsubscribe_shapes","$$subscribe_shapes","$parentRect","$$unsubscribe_parentRect","$$subscribe_parentRect","toolShapes","toolActive","enablePresetSelectImage","shapePresets","utilKey","mapScreenPointToImagePoint","mapImagePointToScreenPoint","hooks","updateActiveTool","mapScreenEventToImagePoint","markupEditor","markupToolStyles","interactionHandler","markupToolStylesComputed","handleUpdateSelectedMarkupShape","markupSelected","handleMarkupUpdate","createPreset","positionIsCenter","shapesAlreadyAtPosition","cropWidth","cropHeight","addPreset","dragCancelled","handleGrabPreset","handleDragPreset","inCropRect","handleDropPreset","handleAddPreset","handleAddFiles","pingHub","ping","shapelayouteditor_binding","func_4","toolsFiltered","shouldRenderShapeEditor","markupOffset","markupShapeKeys","markupToolShape","markupShapeSelected","computedScrollElasticity","isDisableStyleProp","isStylableProp","shapeKey","ShapeUtil","_mapImagePointToScreenPoint","mappedPoint","imageCenterX","imageCenterY","canvasCenterX","canvasCenterY","imageOffsetX","imageOffsetY","rtx","rty","_mapScreenPointToImagePoint","screenPoint","canvasCenter","create_fragment$D","shapeutil","shapeutil_changes","instance$D","markupEditorToolbar","markupEditorToolStyles","markupEditorShapeStyleControls","annotateTools","annotateToolShapes","annotateShapeControls","annotateActiveTool","annotateEnableButtonFlipVertical","annotateEnableSelectImagePreset","annotatePresets","Annotate","index$3","create_fragment$E","instance$E","decorateTools","decorateToolShapes","decorateShapeControls","decorateActiveTool","decorateEnableButtonFlipVertical","decorateEnableSelectImagePreset","decoratePresets","Decorate","index$4","create_fragment$F","instance$F","stickers","stickerStickToImage","stickerEnableSelectImage","stickersEnableButtonFlipVertical","Sticker","index$5","create_default_slot_2$6","resizeIconButtonMaintainAspectRatio","create_default_slot_1$9","create_footer_slot$4","div4","resizeLabelFormCaption","label0","t2_value","resizeLabelInputWidth","label0_for_value","label0_title_value","label0_aria_label_value","input0","input0_id_value","t4","input1","input1_id_value","t5","label1","label1_for_value","label1_title_value","t6","label2","t7_value","resizeLabelInputHeight","t7","label2_for_value","label2_title_value","label2_aria_label_value","t8","input2","input2_id_value","t9","resizeTitleInputWidth","resizeTitleButtonMaintainAspectRatio","resizeTitleInputHeight","create_fragment$G","instance$G","$imageCropRectAspectRatio","$iconActiveFraction","resizeMinSize","resizeMaxSize","iconActiveFraction","formId","fieldsGroup","maintainAspectRatio","widthFormatted","heightFormatted","widthPlaceholder","heightPlaceholder","activeField","lastActiveField","handleSubmit","syncFields","consolidateSize","forcedAspectRatio","currentWidth","currentHeight","bothAxisDefined","currentSize","input0_input_handler","input1_change_handler","input2_input_handler","div3_binding","widthState","heightState","Resize","index$6","cropSelectPresetOptionsDefault","defaults$2","IconCross","en_gb","labelAuto","labelNone","labelEdit","features","labelSizeExtraSmall","labelSizeSmall","labelSizeMediumSmall","labelSizeMedium","labelSizeMediumLarge","labelSizeLarge","labelSizeExtraLarge","labelButtonCancel","MarkupEditor","shapeLabelStrokeNone","shapeLabelFontStyleNormal","shapeLabelFontStyleBold","shapeLabelFontStyleItalic","shapeLabelFontStyleItalicBold","shapeTitleLineStart","shapeTitleLineEnd","shapeTitleLineDecorationBar","shapeTitleLineDecorationCircle","shapeTitleLineDecorationSquare","shapeTitleLineDecorationArrow","shapeTitleLineDecorationCircleSolid","shapeTitleLineDecorationSquareSolid","shapeTitleLineDecorationArrowSolid","shapeIconLineDecorationBar","shapeIconLineDecorationCircle","shapeIconLineDecorationSquare","shapeIconLineDecorationArrow","shapeIconLineDecorationCircleSolid","shapeIconLineDecorationSquareSolid","shapeIconLineDecorationArrowSolid","shapeTitleColorTransparent","shapeTitleColorWhite","shapeTitleColorSilver","shapeTitleColorGray","shapeTitleColorBlack","shapeTitleColorNavy","shapeTitleColorBlue","shapeTitleColorAqua","shapeTitleColorTeal","shapeTitleColorOlive","shapeTitleColorGreen","shapeTitleColorYellow","shapeTitleColorOrange","shapeTitleColorRed","shapeTitleColorMaroon","shapeTitleColorFuchsia","shapeTitleColorPurple","shapeTitleTextAlignLeft","shapeTitleTextAlignCenter","shapeTitleTextAlignRight","shapeIconTextAlignLeft","shapeIconTextAlignCenter","shapeIconTextAlignRight","shapeLabelToolSharpie","shapeLabelToolEraser","shapeLabelToolRectangle","shapeLabelToolEllipse","shapeLabelToolArrow","shapeLabelToolLine","shapeLabelToolText","shapeLabelToolPreset","shapeIconToolSharpie","shapeIconToolEraser","shapeIconToolRectangle","shapeIconToolEllipse","shapeIconToolArrow","shapeIconToolLine","shapeIconToolText","shapeIconToolPreset","en_gb$1","cropLabel","cropIcon","en_gb$2","filterLabel","filterIcon","en_gb$3","finetuneLabel","finetuneIcon","en_gb$4","resizeLabel","resizeIcon","activeFraction","en_gb$5","decorateLabel","decorateIcon","en_gb$6","annotateLabel","annotateIcon","en_gb$7","stickerLabel","stickerIcon","createDefaultImageOrienter","createEditor","getEditorProps$1","createMarkupEditorToolbar","createMarkupEditorToolStyles","createMarkupEditorShapeStyleControls","markup_editor_defaults","plugin_annotate_defaults","plugin_decorate_defaults","plugin_resize_defaults","plugin_sticker_defaults","component_shape_editor_locale_en_gb","createMarkupEditorBackgroundColorControl","createMarkupEditorColorOptions","createMarkupEditorFontColorControl","createMarkupEditorFontFamilyControl","createMarkupEditorFontFamilyOptions","createMarkupEditorFontScaleOptions","createMarkupEditorFontSizeControl","createMarkupEditorFontSizeOptions","createMarkupEditorFontStyleControl","createMarkupEditorFontStyleOptions","createMarkupEditorLineEndStyleControl","createMarkupEditorLineEndStyleOptions","createMarkupEditorLineHeightControl","createMarkupEditorLineStartStyleControl","createMarkupEditorStrokeColorControl","createMarkupEditorStrokeScaleOptions","createMarkupEditorStrokeWidthControl","createMarkupEditorStrokeWidthOptions","createMarkupEditorTextAlignControl","createMarkupEditorToolStyle","defineCustomElements","effectBrightness","effectClarity","effectContrast","effectExposure","effectGamma","effectSaturation","effectTemperature","effectVignette","filterChrome","filterCold","filterFade","filterInvert","filterMonoDefault","filterMonoNoir","filterMonoStark","filterMonoWash","filterPastel","filterSepiaBlues","filterSepiaColor","filterSepiaDefault","filterSepiaRust","filterWarm","isSupported","locale_en_gb","markup_editor_locale_en_gb","plugin_annotate","plugin_annotate_locale_en_gb","plugin_crop","plugin_crop_defaults","plugin_crop_locale_en_gb","plugin_decorate","plugin_decorate_locale_en_gb","plugin_filter","plugin_filter_defaults","plugin_filter_locale_en_gb","plugin_finetune","plugin_finetune_defaults","plugin_finetune_locale_en_gb","plugin_resize","plugin_resize_locale_en_gb","plugin_sticker","plugin_sticker_locale_en_gb","setPlugins"],"mappings":"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","sourcesContent":["/*!\n * Doka Image Editor 7.8.0\n * (c) 2018-2021 PQINA Inc. - All Rights Reserved\n * License: https://pqina.nl/doka/license/\n */\n/* eslint-disable */\n\nconst backup = '__doka_webapi__';\nvar getNativeAPIRef = (API) => (window[backup] ? window[backup][API] : window[API]);\n\nvar createProgressEvent = (loaded, lengthComputable = true) => {\n    // assigning 0 to 1 somehow doesn't work\n    const type = 'progress';\n    const data = {\n        loaded: loaded * 100,\n        total: 100,\n        lengthComputable,\n    };\n    try {\n        return new (getNativeAPIRef('ProgressEvent'))(type, data);\n    }\n    catch (err) {\n        // IE11\n        return { type, ...data };\n    }\n};\n\nvar noop = (...args) => { };\n\nconst FileReaderDataFormat = {\n    ArrayBuffer: 'readAsArrayBuffer',\n};\nvar readFile = (file, onprogress = noop, options = {}) => new Promise((resolve, reject) => {\n    const { dataFormat = FileReaderDataFormat.ArrayBuffer } = options;\n    const reader = new (getNativeAPIRef('FileReader'))();\n    reader.onload = () => resolve(reader.result);\n    reader.onerror = reject;\n    reader.onprogress = onprogress;\n    reader[dataFormat](file);\n});\n\nconst readExifOrientation = (view, offset) => {\n    // Missing 0x45786966 Marker? No Exif Header, stop here\n    if (view.getUint32((offset += 2), false) !== 0x45786966)\n        return -1;\n    // First 2bytes defines byte align of TIFF data.\n    // If it is 0x4949=\"I I\", it means \"Intel\" type byte align\n    const intelByteAligned = view.getUint16((offset += 6), false) === 0x4949;\n    offset += view.getUint32(offset + 4, intelByteAligned);\n    const tags = view.getUint16(offset, intelByteAligned);\n    offset += 2;\n    // find Orientation tag\n    for (let i = 0; i < tags; i++) {\n        if (view.getUint16(offset + i * 12, intelByteAligned) === 0x0112)\n            return view.getUint16(offset + i * 12 + 8, intelByteAligned);\n    }\n};\nconst readData = (data) => {\n    const view = new DataView(data);\n    // Every JPEG file starts from binary value '0xFFD8', so if it's not present, exit here\n    if (view.getUint16(0, false) != 0xffd8)\n        return null;\n    const length = view.byteLength;\n    let offset = 2;\n    let marker;\n    while (offset < length) {\n        if (view.getUint16(offset + 2, false) <= 8)\n            return -1;\n        marker = view.getUint16(offset, false);\n        offset += 2;\n        // Exif Marker found\n        if (marker === 0xffe1)\n            return readExifOrientation(view, offset);\n        // Invalid marker, exit here\n        else if ((marker & 0xff00) !== 0xff00)\n            return null;\n        // Next!\n        else\n            offset += view.getUint16(offset, false);\n    }\n};\nvar getImageOrientationFromFile = async (file, onprogress = noop) => {\n    onprogress(createProgressEvent(0));\n    const result = (await readFile(file.slice(0, 256 * 1024)));\n    return readData(result) || 1;\n};\n\nlet result = null;\nvar isBrowser = () => {\n    if (result === null)\n        result = typeof window !== 'undefined' && typeof window.document !== 'undefined';\n    return result;\n};\n\nlet result$1 = null;\nvar canOrientImages = () => new Promise((resolve) => {\n    if (result$1 === null) {\n        // 2x1 pixel image 90CW rotated with orientation EXIF header\n        const testSrc = 'data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=';\n        let testImage = isBrowser() ? new Image() : {};\n        testImage.onload = () => {\n            // should correct orientation if is presented in landscape,\n            // in which case the browser doesn't autocorrect\n            result$1 = testImage.naturalWidth === 1;\n            testImage = undefined;\n            resolve(result$1);\n        };\n        testImage.src = testSrc;\n        return;\n    }\n    return resolve(result$1);\n});\n\nvar canvasToImageData = (canvas) => {\n    const imageData = canvas\n        .getContext('2d')\n        .getImageData(0, 0, canvas.width, canvas.height);\n    return imageData;\n};\n\nvar h = (name, attributes, children = []) => {\n    const el = document.createElement(name);\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(el.__proto__);\n    for (const key in attributes) {\n        if (key === 'style') {\n            el.style.cssText = attributes[key];\n        }\n        else if ((descriptors[key] && descriptors[key].set) ||\n            /textContent|innerHTML/.test(key) ||\n            typeof attributes[key] === 'function') {\n            el[key] = attributes[key];\n        }\n        else {\n            el.setAttribute(key, attributes[key]);\n        }\n    }\n    children.forEach((child) => el.appendChild(child));\n    return el;\n};\n\nconst MATRICES = {\n    1: () => [1, 0, 0, 1, 0, 0],\n    2: (width) => [-1, 0, 0, 1, width, 0],\n    3: (width, height) => [-1, 0, 0, -1, width, height],\n    4: (width, height) => [1, 0, 0, -1, 0, height],\n    5: () => [0, 1, 1, 0, 0, 0],\n    6: (width, height) => [0, 1, -1, 0, height, 0],\n    7: (width, height) => [0, -1, -1, 0, height, width],\n    8: (width) => [0, -1, 1, 0, 0, width],\n};\nvar getImageOrientationMatrix = (width, height, orientation = -1) => {\n    if (orientation === -1)\n        orientation = 1;\n    return MATRICES[orientation](width, height);\n};\n\nvar releaseCanvas = (canvas) => {\n    canvas.width = 1;\n    canvas.height = 1;\n    const ctx = canvas.getContext('2d');\n    ctx && ctx.clearRect(0, 0, 1, 1);\n};\n\nvar isImageData = (obj) => 'data' in obj;\n\nvar imageDataToCanvas = async (imageData, orientation = 1) => {\n    const [width, height] = (await canOrientImages()) || orientation < 5\n        ? [imageData.width, imageData.height]\n        : [imageData.height, imageData.width];\n    const canvas = h('canvas', { width, height });\n    const ctx = canvas.getContext('2d');\n    // transform image data ojects into in memory canvas elements so we can transform them (putImageData isn't affect by transforms)\n    if (isImageData(imageData) && !(await canOrientImages()) && orientation > 1) {\n        const inMemoryCanvas = h('canvas', imageData);\n        const ctx = inMemoryCanvas.getContext('2d');\n        ctx.putImageData(imageData, 0, 0);\n        imageData = inMemoryCanvas;\n    }\n    // get base transformation matrix\n    if (!(await canOrientImages()) && orientation > 1) {\n        ctx.transform.apply(ctx, getImageOrientationMatrix(imageData.width, imageData.height, orientation));\n    }\n    // can't test for instanceof ImageBitmap as Safari doesn't support it\n    // if still imageData object by this point, we'll use put\n    if (isImageData(imageData)) {\n        ctx.putImageData(imageData, 0, 0);\n    }\n    else {\n        ctx.drawImage(imageData, 0, 0);\n    }\n    // if image data is of type canvas, clean it up\n    if (imageData instanceof HTMLCanvasElement)\n        releaseCanvas(imageData);\n    return canvas;\n};\n\nvar orientImageData = async (imageData, orientation = 1) => {\n    if (orientation === 1)\n        return imageData;\n    // correct image data for when the browser does not correctly read exif orientation headers\n    if (!(await canOrientImages()))\n        return canvasToImageData(await imageDataToCanvas(imageData, orientation));\n    return imageData;\n};\n\nvar imageToCanvas = (image, canvasMemoryLimit) => {\n    // if these are 0 it's possible that we're trying to convert an SVG that doesn't have width or height attributes\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1328124\n    let canvasWidth = image.naturalWidth;\n    let canvasHeight = image.naturalHeight;\n    // determine if requires more memory than limit, if so limit target size\n    const requiredCanvasMemory = canvasWidth * canvasHeight;\n    if (canvasMemoryLimit && requiredCanvasMemory > canvasMemoryLimit) {\n        const canvasScalar = Math.sqrt(canvasMemoryLimit) / Math.sqrt(requiredCanvasMemory);\n        canvasWidth = Math.floor(canvasWidth * canvasScalar);\n        canvasHeight = Math.floor(canvasHeight * canvasScalar);\n    }\n    // create new canvas element\n    const canvas = h('canvas');\n    canvas.width = canvasWidth;\n    canvas.height = canvasHeight;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(image, 0, 0, canvasWidth, canvasHeight);\n    return canvas;\n};\n\n// turns image into canvas only after it's fully loaded\nvar imageToCanvasSafe = (image, canvasMemoryLimit) => new Promise((resolve, reject) => {\n    const ready = () => resolve(imageToCanvas(image, canvasMemoryLimit));\n    if (image.complete && image.width) {\n        // need to test for image.width, on ie11 it will be 0 for object urls\n        ready();\n    }\n    else {\n        image.onload = ready;\n        image.onerror = reject;\n    }\n});\n\nvar blobToCanvas = async (imageBlob, canvasMemoryLimit) => {\n    const imageElement = h('img', { src: URL.createObjectURL(imageBlob) });\n    const canvas = await imageToCanvasSafe(imageElement, canvasMemoryLimit);\n    URL.revokeObjectURL(imageElement.src);\n    return canvas;\n};\n\nvar canCreateImageBitmap = () => 'createImageBitmap' in window;\n\nvar canCreateOffscreenCanvas = () => 'OffscreenCanvas' in window;\n\nvar isSVGFile = (blob) => /svg/.test(blob.type);\n\nvar getUniqueId = () => Math.random()\n    .toString(36)\n    .substr(2, 9);\n\nvar functionToBlob = (fn) => new Blob(['(', typeof fn === 'function' ? fn.toString() : fn, ')()'], {\n    type: 'application/javascript',\n});\n\nconst wrapFunction = (fn) => `function () {self.onmessage = function (message) {(${fn.toString()}).apply(null, message.data.content.concat([function (err, response) {\n    response = response || {};\n    const transfer = 'data' in response ? [response.data.buffer] : 'width' in response ? [response] : [];\n    return self.postMessage({ id: message.data.id, content: response, error: err }, transfer);\n}]))}}`;\nconst workerPool = new Map();\nvar thread = (fn, args, transferList) => new Promise((resolve, reject) => {\n    let workerKey = fn.toString();\n    let pooledWorker = workerPool.get(workerKey);\n    if (!pooledWorker) {\n        // create worker for this function\n        const workerFn = wrapFunction(fn);\n        // create a new web worker\n        const url = URL.createObjectURL(functionToBlob(workerFn));\n        const messages = new Map();\n        const worker = new Worker(url);\n        // create a pooled worker, this object will contain the worker and active messages\n        pooledWorker = {\n            url,\n            worker,\n            messages,\n            terminate: () => {\n                pooledWorker.worker.terminate();\n                URL.revokeObjectURL(url);\n            },\n        };\n        // handle received messages\n        worker.onmessage = function (e) {\n            // should receive message id and message\n            const { id, content, error } = e.data;\n            // message route no longer valid\n            if (!messages.has(id))\n                return;\n            // get related thread and resolve with returned content\n            const message = messages.get(id);\n            // remove thread from threads cache\n            messages.delete(id);\n            // resolve or reject message based on response from worker\n            error != null ? message.reject(error) : message.resolve(content);\n        };\n        // pool this worker\n        workerPool.set(workerKey, pooledWorker);\n    }\n    // we need a way to remember this message so we generate a unique id and use that as a key for this request, that way we can link the response back to request in the pooledWorker.onmessage handler\n    const messageId = getUniqueId();\n    pooledWorker.messages.set(messageId, { resolve, reject });\n    // use pooled worker and await response\n    pooledWorker.worker.postMessage({ id: messageId, content: args }, transferList);\n});\n\nvar blobToImageData = async (imageBlob, canvasMemoryLimit) => {\n    let imageData;\n    // if can use OffscreenCanvas let's go for it as it will mean we can run this operation on a separate thread\n    if (canCreateImageBitmap() && !isSVGFile(imageBlob) && canCreateOffscreenCanvas()) {\n        try {\n            imageData = await thread((file, canvasMemoryLimit, done) => {\n                createImageBitmap(file)\n                    .then((bitmap) => {\n                    let canvasWidth = bitmap.width;\n                    let canvasHeight = bitmap.height;\n                    // determine if requires more memory than limit, if so limit target size\n                    const requiredCanvasMemory = canvasWidth * canvasHeight;\n                    if (canvasMemoryLimit && requiredCanvasMemory > canvasMemoryLimit) {\n                        const canvasScalar = Math.sqrt(canvasMemoryLimit) / Math.sqrt(requiredCanvasMemory);\n                        canvasWidth = Math.floor(canvasWidth * canvasScalar);\n                        canvasHeight = Math.floor(canvasHeight * canvasScalar);\n                    }\n                    const canvas = new OffscreenCanvas(canvasWidth, canvasHeight);\n                    const ctx = canvas.getContext('2d');\n                    ctx.drawImage(bitmap, 0, 0);\n                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n                    done(null, imageData);\n                })\n                    .catch((err) => {\n                    // fail silently\n                    done(err);\n                });\n            }, [imageBlob, canvasMemoryLimit]);\n        }\n        catch (err) {\n            // fails silently on purpose, we'll try to turn the blob into image data in the main thread\n            // console.error(err);\n        }\n    }\n    // use main thread to generate ImageData\n    if (!imageData || !imageData.width) {\n        const canvas = await blobToCanvas(imageBlob, canvasMemoryLimit);\n        imageData = canvasToImageData(canvas);\n        releaseCanvas(canvas);\n    }\n    return imageData;\n};\n\nvar canvasToBlob = (canvas, mimeType = undefined, quality = undefined) => new Promise((resolve, reject) => {\n    try {\n        canvas.toBlob((blob) => {\n            resolve(blob);\n        }, mimeType, quality);\n    }\n    catch (err) {\n        reject(err);\n    }\n});\n\nvar imageDataToBlob = async (imageData, mimeType, quality) => {\n    try {\n        const canvas = await imageDataToCanvas(imageData);\n        const blob = await canvasToBlob(canvas, mimeType, quality);\n        releaseCanvas(canvas);\n        return blob;\n    }\n    catch (err) {\n        throw err;\n    }\n};\n\nvar blobReadSection = async (blob, slice = [0, blob.size], onprogress) => (await readFile(blob.slice(...slice), onprogress));\n\nvar blobWriteSection = (blob, section, slice = [0, blob.size]) => {\n    if (!section)\n        return blob;\n    return new Blob([section, blob.slice(...slice)], { type: blob.type });\n};\n\nvar getExtensionFromMimeType = (mimeType) => mimeType.match(/\\/([a-z]+)/)[1];\n\nvar getFilenameWithoutExtension = (name) => name.substr(0, name.lastIndexOf('.')) || name;\n\nvar getExtensionFromFilename = (filename) => filename.split('.').pop();\n\nconst ImageExtensionsRegex = /avif|bmp|gif|jpg|jpeg|jpe|jif|jfif|png|svg|tiff|webp/;\n/*\nSupport image mime types\n- image/webp\n- image/gif\n- image/avif\n- image/jpeg\n- image/png\n- image/bmp\n- image/svg+xml\n*/\nvar getMimeTypeFromExtension = (ext) => {\n    // empty string returned if extension not found\n    if (!ImageExtensionsRegex.test(ext))\n        return '';\n    // return MimeType for this extension\n    return 'image/' + (/jfif|jif|jpe|jpg/.test(ext) ? 'jpeg' : ext === 'svg' ? 'svg+xml' : ext);\n};\n\nvar getMimeTypeFromFilename = (name) => name && getMimeTypeFromExtension(getExtensionFromFilename(name).toLowerCase());\n\nvar matchFilenameToMimeType = (filename, mimeType) => {\n    // get the mime type that matches this extension\n    const fileMimeType = getMimeTypeFromFilename(filename);\n    // test if type already matches current mime type, no need to change name\n    if (fileMimeType === mimeType)\n        return filename;\n    // get the extension for this mimetype (gets all characters after the \"image/\" part)\n    const targetMimeTypeExtension = getExtensionFromMimeType(mimeType);\n    return `${getFilenameWithoutExtension(filename)}.${targetMimeTypeExtension}`;\n};\n\nvar blobToFile = (blob, filename, mimetype) => {\n    const lastModified = new Date().getTime();\n    const blobHasMimeType = blob.type.length && blob.type !== 'null';\n    const blobMimeType = blobHasMimeType ? blob.type : mimetype;\n    const name = matchFilenameToMimeType(filename, blobMimeType);\n    try {\n        return new (getNativeAPIRef('File'))([blob], name, {\n            lastModified,\n            type: blobHasMimeType ? blob.type : blobMimeType,\n        });\n    }\n    catch (err) {\n        const file = blobHasMimeType ? blob.slice() : blob.slice(0, blob.size, blobMimeType);\n        file.lastModified = lastModified;\n        file.name = name;\n        return file;\n    }\n};\n\nvar getAspectRatio = (w, h) => w / h;\n\nvar passthrough = (v) => (v);\n\nconst PI = Math.PI;\nconst HALF_PI = Math.PI / 2;\nconst QUART_PI = HALF_PI / 2;\n\nvar isRotatedSideways = (a) => {\n    const rotationLimited = Math.abs(a) % Math.PI;\n    return rotationLimited > QUART_PI && rotationLimited < Math.PI - QUART_PI;\n};\n\n//\n// generic\n//\nconst scale = (value, scalar, pivot) => pivot + (value - pivot) * scalar;\nconst ellipseCreateFromRect = (rect) => ({\n    x: rect.x + rect.width * 0.5,\n    y: rect.y + rect.height * 0.5,\n    rx: rect.width * 0.5,\n    ry: rect.height * 0.5,\n});\n//\n// vector\n//\nconst vectorCreateEmpty = () => vectorCreate(0, 0);\nconst vectorCreate = (x, y) => ({ x, y });\nconst vectorCreateFromSize = (size) => vectorCreate(size.width, size.height);\nconst vectorCreateFromPointerEvent = (e) => vectorCreate(e.pageX, e.pageY);\nconst vectorCreateFromPointerEventOffset = (e) => vectorCreate(e.offsetX, e.offsetY);\nconst vectorClone = (v) => vectorCreate(v.x, v.y);\nconst vectorInvert = (v) => {\n    v.x = -v.x;\n    v.y = -v.y;\n    return v;\n};\nconst vectorPerpendicular = (v) => {\n    const x = v.x;\n    v.x = -v.y;\n    v.y = x;\n    return v;\n};\nconst vectorRotate = (v, radians, pivot = vectorCreateEmpty()) => {\n    const cos = Math.cos(radians);\n    const sin = Math.sin(radians);\n    const tx = v.x - pivot.x;\n    const ty = v.y - pivot.y;\n    v.x = pivot.x + cos * tx - sin * ty;\n    v.y = pivot.y + sin * tx + cos * ty;\n    return v;\n};\nconst vectorLength = (v) => Math.sqrt(v.x * v.x + v.y * v.y);\nconst vectorNormalize = (v) => {\n    const length = Math.sqrt(v.x * v.x + v.y * v.y);\n    if (length === 0)\n        return vectorCreateEmpty();\n    v.x /= length;\n    v.y /= length;\n    return v;\n};\nconst vectorAngle = (v) => Math.atan2(v.y, v.x);\nconst vectorAngleBetween = (a, b) => Math.atan2(b.y - a.y, b.x - a.x);\nconst vectorEqual = (a, b) => a.x === b.x && a.y === b.y;\nconst vectorApply = (v, fn) => {\n    v.x = fn(v.x);\n    v.y = fn(v.y);\n    return v;\n};\nconst vectorAdd = (a, b) => {\n    a.x += b.x;\n    a.y += b.y;\n    return a;\n};\nconst vectorSubtract = (a, b) => {\n    a.x -= b.x;\n    a.y -= b.y;\n    return a;\n};\nconst vectorMultiply = (v, f) => {\n    v.x *= f;\n    v.y *= f;\n    return v;\n};\nconst vectorDot = (a, b) => a.x * b.x + a.y * b.y;\nconst vectorDistanceSquared = (a, b = vectorCreateEmpty()) => {\n    const x = a.x - b.x;\n    const y = a.y - b.y;\n    return x * x + y * y;\n};\nconst vectorDistance = (a, b = vectorCreateEmpty()) => Math.sqrt(vectorDistanceSquared(a, b));\nconst vectorCenter = (v) => {\n    let x = 0;\n    let y = 0;\n    v.forEach((v) => {\n        x += v.x;\n        y += v.y;\n    });\n    return vectorCreate(x / v.length, y / v.length);\n};\nconst vectorsFlip = (points, flipX, flipY, cx, cy) => {\n    points.forEach((point) => {\n        point.x = flipX ? cx - (point.x - cx) : point.x;\n        point.y = flipY ? cy - (point.y - cy) : point.y;\n    });\n    return points;\n};\nconst vectorsRotate = (points, angle, cx, cy) => {\n    const s = Math.sin(angle);\n    const c = Math.cos(angle);\n    points.forEach((p) => {\n        p.x -= cx;\n        p.y -= cy;\n        const rx = p.x * c - p.y * s;\n        const ry = p.x * s + p.y * c;\n        p.x = cx + rx;\n        p.y = cy + ry;\n    });\n    return points;\n};\n//\n// size\n//\nconst toSize = (width, height) => ({ width, height });\nconst sizeClone = (size) => toSize(size.width, size.height);\nconst sizeCreateFromAny = (obj) => toSize(obj.width, obj.height);\nconst sizeCreateFromRect = (r) => toSize(r.width, r.height);\nconst sizeCreateFromArray = (a) => toSize(a[0], a[1]);\nconst sizeCreate = (width, height) => toSize(width, height);\nconst sizeEqual = (a, b, format = passthrough) => format(a.width) === format(b.width) && format(a.height) === format(b.height);\nconst sizeScale = (size, scalar) => {\n    size.width *= scalar;\n    size.height *= scalar;\n    return size;\n};\nconst sizeCenter = (size) => vectorCreate(size.width * 0.5, size.height * 0.5);\nconst sizeRotate = (size, radians) => {\n    const cos = Math.cos(radians);\n    const sin = Math.sin(radians);\n    const w = cos * size.width + sin * size.height;\n    const h = sin * size.width + cos * size.height;\n    size.width = w;\n    size.height = h;\n    return size;\n};\nconst sizeTurn = (size, radians) => {\n    const w = size.width;\n    const h = size.height;\n    if (isRotatedSideways(radians)) {\n        size.width = h;\n        size.height = w;\n    }\n    return size;\n};\nconst sizeContains = (a, b) => a.width >= b.width && a.height >= b.height;\nconst sizeApply = (size, fn) => {\n    size.width = fn(size.width);\n    size.height = fn(size.height);\n    return size;\n};\nconst sizeHypotenuse = (size) => Math.sqrt(size.width * size.width + size.height * size.height);\nconst sizeMin = (a, b) => sizeCreate(Math.min(a.width, b.width), Math.min(a.height, b.height));\n//\n// line\n//\nconst lineCreate = (start, end) => ({ start, end });\nconst lineClone = (line) => lineCreate(vectorClone(line.start), vectorClone(line.end));\nconst lineExtend = (line, amount) => {\n    const v = vectorCreate(line.start.x - line.end.x, line.start.y - line.end.y);\n    const vn = vectorNormalize(v);\n    const vm = vectorMultiply(vn, amount);\n    line.start.x += vm.x;\n    line.start.y += vm.y;\n    line.end.x -= vm.x;\n    line.end.y -= vm.y;\n    return line;\n};\nconst lineMultiply = (line, amount) => {\n    const v = vectorCreate(line.start.x - line.end.x, line.start.y - line.end.y);\n    const vn = vectorNormalize(v);\n    const vm = vectorMultiply(vn, amount);\n    line.end.x += vm.x;\n    line.end.y += vm.y;\n    return line;\n};\n//\n// rect\n//\nconst CornerSigns = [\n    vectorCreate(-1, -1),\n    vectorCreate(-1, 1),\n    vectorCreate(1, 1),\n    vectorCreate(1, -1),\n];\nconst toRect = (x, y, width, height) => ({\n    x,\n    y,\n    width,\n    height,\n});\nconst rectClone = (rect) => toRect(rect.x, rect.y, rect.width, rect.height);\nconst rectCreateEmpty = () => toRect(0, 0, 0, 0);\nconst rectCreateFromDimensions = (width, height) => toRect(0, 0, width, height);\nconst rectCreateFromSize = (size) => toRect(0, 0, size.width, size.height);\nconst rectCreateFromAny = (obj) => toRect(obj.x || 0, obj.y || 0, obj.width || 0, obj.height || 0);\nconst rectCreateFromPoints = (...args) => {\n    const pts = Array.isArray(args[0]) ? args[0] : args;\n    let xMin = pts[0].x;\n    let xMax = pts[0].x;\n    let yMin = pts[0].y;\n    let yMax = pts[0].y;\n    pts.forEach((point) => {\n        xMin = Math.min(xMin, point.x);\n        xMax = Math.max(xMax, point.x);\n        yMin = Math.min(yMin, point.y);\n        yMax = Math.max(yMax, point.y);\n    });\n    return toRect(xMin, yMin, xMax - xMin, yMax - yMin);\n};\nconst rectCreateFromEllipse = (ellipse) => rectCreate(ellipse.x - ellipse.rx, ellipse.y - ellipse.ry, ellipse.rx * 2, ellipse.ry * 2);\nconst rectCreateWithCenter = (center, size) => toRect(center.x - size.width * 0.5, center.y - size.height * 0.5, size.width, size.height);\nconst rectCreate = (x, y, width, height) => toRect(x, y, width, height);\nconst rectCenter = (rect) => vectorCreate(rect.x + rect.width * 0.5, rect.y + rect.height * 0.5);\nconst rectTranslate = (rect, t) => {\n    rect.x += t.x;\n    rect.y += t.y;\n    return rect;\n};\nconst rectScale = (rect, scalar, pivot) => {\n    pivot = pivot || rectCenter(rect);\n    rect.x = scalar * (rect.x - pivot.x) + pivot.x;\n    rect.y = scalar * (rect.y - pivot.y) + pivot.y;\n    rect.width = scalar * rect.width;\n    rect.height = scalar * rect.height;\n    return rect;\n};\nconst rectMultiply = (rect, factor) => {\n    rect.x *= factor;\n    rect.y *= factor;\n    rect.width *= factor;\n    rect.height *= factor;\n    return rect;\n};\nconst rectDivide = (rect, factor) => {\n    rect.x /= factor;\n    rect.y /= factor;\n    rect.width /= factor;\n    rect.height /= factor;\n    return rect;\n};\nconst rectSubtract = (a, b) => {\n    a.x -= b.x;\n    a.y -= b.y;\n    a.width -= b.width;\n    a.height -= b.height;\n    return a;\n};\nconst rectAdd = (a, b) => {\n    a.x += b.x;\n    a.y += b.y;\n    a.width += b.width;\n    a.height += b.height;\n    return a;\n};\nconst rectEqual = (a, b, format = passthrough) => format(a.x) === format(b.x) &&\n    format(a.y) === format(b.y) &&\n    format(a.width) === format(b.width) &&\n    format(a.height) === format(b.height);\nconst rectAspectRatio = (rect) => getAspectRatio(rect.width, rect.height);\nconst rectUpdate = (rect, x, y, width, height) => {\n    rect.x = x;\n    rect.y = y;\n    rect.width = width;\n    rect.height = height;\n    return rect;\n};\nconst rectUpdateWithRect = (a, b) => {\n    a.x = b.x;\n    a.y = b.y;\n    a.width = b.width;\n    a.height = b.height;\n    return a;\n};\nconst rectRotate = (rect, radians, pivot) => {\n    if (!pivot)\n        pivot = rectCenter(rect);\n    return rectGetCorners(rect).map((vertex) => vectorRotate(vertex, radians, pivot));\n};\nconst rectCenterRect = (a, b) => toRect(a.width * 0.5 - b.width * 0.5, a.height * 0.5 - b.height * 0.5, b.width, b.height);\nconst rectContainsPoint = (rect, point) => {\n    if (point.x < rect.x)\n        return false;\n    if (point.y < rect.y)\n        return false;\n    if (point.x > rect.x + rect.width)\n        return false;\n    if (point.y > rect.y + rect.height)\n        return false;\n    return true;\n};\nconst rectCoverRect = (rect, aspectRatio, offset = vectorCreateEmpty()) => {\n    if (rect.width === 0 || rect.height === 0)\n        return rectCreateEmpty();\n    const inputAspectRatio = rectAspectRatio(rect);\n    if (!aspectRatio)\n        aspectRatio = inputAspectRatio;\n    let width = rect.width;\n    let height = rect.height;\n    if (aspectRatio > inputAspectRatio) {\n        // height remains the same, width is expanded\n        width = height * aspectRatio;\n    }\n    else {\n        // width remains the same, height is expanded\n        height = width / aspectRatio;\n    }\n    return toRect(offset.x + (rect.width - width) * 0.5, offset.y + (rect.height - height) * 0.5, width, height);\n};\nconst rectContainRect = (rect, aspectRatio = rectAspectRatio(rect), offset = vectorCreateEmpty()) => {\n    if (rect.width === 0 || rect.height === 0)\n        return rectCreateEmpty();\n    let width = rect.width;\n    let height = width / aspectRatio;\n    if (height > rect.height) {\n        height = rect.height;\n        width = height * aspectRatio;\n    }\n    return toRect(offset.x + (rect.width - width) * 0.5, offset.y + (rect.height - height) * 0.5, width, height);\n};\nconst rectToBounds = (rect) => [\n    Math.min(rect.y, rect.y + rect.height),\n    Math.max(rect.x, rect.x + rect.width),\n    Math.max(rect.y, rect.y + rect.height),\n    Math.min(rect.x, rect.x + rect.width),\n];\nconst rectGetCorners = (rect) => [\n    vectorCreate(rect.x, rect.y),\n    vectorCreate(rect.x + rect.width, rect.y),\n    vectorCreate(rect.x + rect.width, rect.y + rect.height),\n    vectorCreate(rect.x, rect.y + rect.height),\n];\nconst rectApply = (rect, fn) => {\n    if (!rect)\n        return;\n    rect.x = fn(rect.x);\n    rect.y = fn(rect.y);\n    rect.width = fn(rect.width);\n    rect.height = fn(rect.height);\n    return rect;\n};\nconst rectApplyPerspective = (rect, perspective, pivot = rectCenter(rect)) => rectGetCorners(rect).map((corner, index) => {\n    const sign = CornerSigns[index];\n    return vectorCreate(scale(corner.x, 1.0 + sign.x * perspective.x, pivot.x), scale(corner.y, 1.0 + sign.y * perspective.y, pivot.y));\n});\nconst rectNormalizeOffset = (rect) => {\n    rect.x = 0;\n    rect.y = 0;\n    return rect;\n};\n// https://stackoverflow.com/questions/9692448/how-can-you-find-the-centroid-of-a-concave-irregular-polygon-in-javascript\nconst quadCentroid = (points) => {\n    const pts = points.map(vectorClone);\n    const first = pts[0];\n    const last = pts[pts.length - 1];\n    if (first.x != last.x || first.y != last.y) {\n        pts.push(first);\n    }\n    let twicearea = 0;\n    let x = 0;\n    let y = 0;\n    let nPts = pts.length;\n    let p1;\n    let p2;\n    let f;\n    for (let i = 0, j = nPts - 1; i < nPts; j = i++) {\n        p1 = pts[i];\n        p2 = pts[j];\n        f = (p1.y - first.y) * (p2.x - first.x) - (p2.y - first.y) * (p1.x - first.x);\n        twicearea += f;\n        x += (p1.x + p2.x - 2 * first.x) * f;\n        y += (p1.y + p2.y - 2 * first.y) * f;\n    }\n    f = twicearea * 3;\n    return vectorCreate(x / f + first.x, y / f + first.y);\n};\nconst lineLineIntersection = (a, b) => _lineLineIntersection(a.start, a.end, b.start, b.end);\nconst _lineLineIntersection = (a, b, c, d) => {\n    const uA = ((d.x - c.x) * (a.y - c.y) - (d.y - c.y) * (a.x - c.x)) /\n        ((d.y - c.y) * (b.x - a.x) - (d.x - c.x) * (b.y - a.y));\n    const uB = ((b.x - a.x) * (a.y - c.y) - (b.y - a.y) * (a.x - c.x)) /\n        ((d.y - c.y) * (b.x - a.x) - (d.x - c.x) * (b.y - a.y));\n    if (uA >= 0 && uA <= 1 && uB >= 0 && uB <= 1) {\n        return vectorCreate(a.x + uA * (b.x - a.x), a.y + uA * (b.y - a.y));\n    }\n    return undefined;\n};\nconst linePointsIntersection = (line, points) => {\n    const vertices = [...points, points[0]];\n    const l = vertices.length;\n    const intersections = [];\n    for (let i = 0; i < l - 1; i++) {\n        const intersection = _lineLineIntersection(line.start, line.end, vectorCreate(vertices[i].x, vertices[i].y), vectorCreate(vertices[i + 1].x, vertices[i + 1].y));\n        if (!intersection)\n            continue;\n        intersections.push(intersection);\n    }\n    return intersections.length ? intersections : undefined;\n};\n// First translate the polygon so that `point` is the origin. Then, for each\n// edge, get the angle between two vectors: 1) the edge vector and 2) the\n// vector of the first vertex of the edge. If all of the angles are the same\n// sign (which is negative since they will be counter-clockwise) then the\n// point is inside the polygon; otherwise, the point is outside.\nconst polyPointIntersectionConvex = (point, vertices) => {\n    let i, a, b, ax, ay, bx, by, edgex, edgey, x;\n    const l = vertices.length;\n    for (i = 0; i < l; i++) {\n        a = vertices[i];\n        b = vertices[i + 1 > l - 1 ? 0 : i + 1];\n        ax = a.x - point.x;\n        ay = a.y - point.y;\n        bx = b.x - point.x;\n        by = b.y - point.y;\n        edgex = ax - bx;\n        edgey = ay - by;\n        x = edgex * ay - edgey * ax;\n        // 0 is ON the edge, but we check for -0.00001 to fix floating point errors\n        if (x < -0.00001)\n            return false;\n    }\n    return true;\n};\nconst quadLines = (vertices) => {\n    const arr = [];\n    for (let i = 0; i < vertices.length; i++) {\n        let next = i + 1;\n        if (next === vertices.length)\n            next = 0;\n        arr.push(lineCreate(vectorClone(vertices[i]), vectorClone(vertices[next])));\n    }\n    return arr;\n};\n\nvar getImageTransformedRect = (imageSize, imageRotation) => {\n    const imageRect = rectCreateFromSize(imageSize);\n    const imageCenter = rectCenter(imageRect);\n    const imageTransformedVertices = rectRotate(imageRect, imageRotation, imageCenter);\n    return rectNormalizeOffset(rectCreateFromPoints(imageTransformedVertices));\n};\n\nvar isElement = (v, name) => v instanceof HTMLElement && (name ? new RegExp(`^${name}$`, 'i').test(v.nodeName) : true);\n\nvar isFile = (v) => v instanceof File;\n\nvar isString = (v) => typeof v === 'string';\n\nvar canvasToFile = async (canvas, mimeType, quality) => {\n    const blob = await canvasToBlob(canvas, mimeType, quality);\n    return blobToFile(blob, 'canvas');\n};\n\nvar getFilenameFromURL = (url) => url\n    .split('/')\n    .pop()\n    .split(/\\?|\\#/)\n    .shift();\n\nlet isSafari = null;\nvar isSafari$1 = () => {\n    if (isSafari === null)\n        isSafari = isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\n    return isSafari;\n};\n\nvar getImageElementSize = (imageElement) => new Promise((resolve, reject) => {\n    let shouldAutoRemove = false;\n    // test if image is attached to DOM, if not attached, attach so measurement is correct on Safari\n    if (!imageElement.parentNode && isSafari$1()) {\n        shouldAutoRemove = true;\n        // has width 0 and height 0 to prevent rendering very big SVGs (without width and height) that will for one frame overflow the window and show a scrollbar\n        imageElement.style.cssText = `position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;`;\n        document.body.appendChild(imageElement);\n    }\n    // start testing size\n    const measure = () => {\n        const width = imageElement.naturalWidth;\n        const height = imageElement.naturalHeight;\n        const hasSize = width && height;\n        if (!hasSize)\n            return;\n        // clean up image if was attached for measuring\n        if (shouldAutoRemove)\n            imageElement.parentNode.removeChild(imageElement);\n        clearInterval(intervalId);\n        resolve({ width, height });\n    };\n    imageElement.onerror = (err) => {\n        clearInterval(intervalId);\n        reject(err);\n    };\n    const intervalId = setInterval(measure, 1);\n    measure();\n});\n\nvar getImageSize = async (image) => {\n    // the image element we'll use to load the image\n    let imageElement = image;\n    // if is not an image element, it must be a valid image source\n    if (!imageElement.src) {\n        imageElement = new Image();\n        imageElement.src = isString(image) ? image : URL.createObjectURL(image);\n    }\n    let size;\n    try {\n        size = await getImageElementSize(imageElement);\n    }\n    catch (err) {\n        throw err;\n    }\n    finally {\n        isFile(image) && URL.revokeObjectURL(imageElement.src);\n    }\n    return size;\n};\n\nconst awaitComplete = (image) => new Promise((resolve, reject) => {\n    if (image.complete)\n        return resolve(image);\n    image.onload = () => resolve(image);\n    image.onerror = reject;\n});\nvar imageToFile = async (imageElement) => {\n    try {\n        const size = await getImageSize(imageElement);\n        const image = await awaitComplete(imageElement);\n        const canvas = document.createElement('canvas');\n        canvas.width = size.width;\n        canvas.height = size.height;\n        const ctx = canvas.getContext('2d');\n        ctx.drawImage(image, 0, 0);\n        const blob = await canvasToBlob(canvas);\n        return blobToFile(blob, getFilenameFromURL(image.src));\n    }\n    catch (err) {\n        throw err;\n    }\n};\n\nvar isDataURI = (str) => /^data:/.test(str);\n\nvar isUserAgent = (test) => (isBrowser() ? RegExp(test).test(window.navigator.userAgent) : undefined);\n\nlet result$2 = null;\nvar isInternetExplorer = () => {\n    if (result$2 === null)\n        result$2 = isUserAgent(/MSIE|Trident/);\n    return result$2;\n};\n\n// IE11 does not support getting blobs with fetch, so we use this fallback method\nconst dataURIToBlob = (dataURI) => {\n    const parts = dataURI.split(',');\n    const type = parts[0].substr(4);\n    const byteString = atob(parts[1]);\n    const l = byteString.length;\n    const ab = new ArrayBuffer(byteString.length);\n    const ia = new Uint8Array(ab);\n    for (var i = 0; i < l; i++) {\n        ia[i] = byteString.charCodeAt(i);\n    }\n    return new Blob([ab], { type: type });\n};\nvar dataURIToFile = async (dataURI, filename = 'data-uri', onprogress = noop) => {\n    // basic loader, no size info\n    onprogress(createProgressEvent(0));\n    let blob;\n    if (isInternetExplorer()) {\n        blob = dataURIToBlob(dataURI);\n        onprogress(createProgressEvent(0.5));\n    }\n    else {\n        const res = await fetch(dataURI);\n        onprogress(createProgressEvent(0.33));\n        blob = await res.blob();\n        onprogress(createProgressEvent(0.66));\n    }\n    const file = blobToFile(blob, filename);\n    onprogress(createProgressEvent(1));\n    return file;\n};\n\nvar getResponseHeader = (xhr, header, parse = (header) => header) => xhr.getAllResponseHeaders().indexOf(header) >= 0\n    ? parse(xhr.getResponseHeader(header))\n    : undefined;\n\nvar getFilenameFromContentDisposition = (header) => {\n    if (!header)\n        return null;\n    const matches = header.split(/filename=|filename\\*=.+''/)\n        .splice(1)\n        .map(name => name.trim().replace(/^[\"']|[;\"']{0,2}$/g, ''))\n        .filter(name => name.length);\n    return matches.length ? decodeURI(matches[matches.length - 1]) : null;\n};\n\nconst DokaErrorCode = {\n    URL_REQUEST: 'URL_REQUEST',\n    DOCTYPE_MISSING: 'DOCTYPE_MISSING',\n};\nclass DokaError extends Error {\n    constructor(message, code, metadata) {\n        super(message);\n        this.name = 'DokaError';\n        this.code = code;\n        this.metadata = metadata;\n    }\n}\n\nvar fetchFile = (url, onprogress) => new Promise((resolve, reject) => {\n    const handleError = () => reject(new DokaError('Error fetching image', DokaErrorCode.URL_REQUEST, xhr));\n    const xhr = new XMLHttpRequest();\n    xhr.onprogress = onprogress;\n    (xhr.onerror = handleError),\n        (xhr.onload = () => {\n            if (!xhr.response || xhr.status >= 300 || xhr.status < 200)\n                return handleError();\n            // we store the response mime type so we can add it to the blob later on, if it's missing (happens on Safari 10)\n            const mimetype = getResponseHeader(xhr, 'Content-Type');\n            // try to get filename and any file instructions as well\n            const filename = getResponseHeader(xhr, 'Content-Disposition', getFilenameFromContentDisposition) || getFilenameFromURL(url);\n            // convert to actual file if possible\n            resolve(blobToFile(xhr.response, filename, mimetype || getMimeTypeFromFilename(filename)));\n        });\n    xhr.open('GET', url);\n    xhr.responseType = 'blob';\n    xhr.send();\n});\n\nvar urlToFile = (url, onprogress) => {\n    // use fetch to create blob from data uri\n    if (isDataURI(url))\n        return dataURIToFile(url, undefined, onprogress);\n    // load file from url\n    return fetchFile(url, onprogress);\n};\n\nvar isBlob = (v) => v instanceof Blob && !(v instanceof File);\n\nvar srcToFile = async (src, onprogress) => {\n    if (isFile(src) || isBlob(src))\n        return src;\n    else if (isString(src))\n        return await urlToFile(src, onprogress);\n    else if (isElement(src, 'canvas'))\n        return await canvasToFile(src);\n    else if (isElement(src, 'img'))\n        return await imageToFile(src);\n    else {\n        throw new DokaError('Invalid image source', 'invalid-image-source');\n    }\n};\n\nvar orientImageSize = async (size, orientation = 1) => {\n    // browser can handle image orientation\n    if (await canOrientImages())\n        return size;\n    // no need to fix orientation\n    if (orientation < 5)\n        return size;\n    // correct image size\n    return sizeCreate(size.height, size.width);\n};\n\nvar arrayBufferReadImageHead = (data) => {\n    const view = new DataView(data);\n    // Every JPEG file starts from binary value '0xFFD8', so if it's not present, exit here\n    if (view.getUint16(0) !== 0xffd8)\n        return null;\n    let offset = 2; // Start at 2 as we skipped two bytes (FFD8)\n    let marker;\n    let markerLength;\n    while (offset < view.byteLength) {\n        marker = view.getUint16(offset, false);\n        markerLength = view.getUint16(offset + 2, false) + 2;\n        // Test if is APP and COM markers\n        const isData = (marker >= 0xffe0 && marker <= 0xffef) || marker === 0xfffe;\n        if (!isData)\n            break;\n        if (offset + markerLength > view.byteLength)\n            break;\n        offset += markerLength;\n    }\n    return data.slice(0, offset);\n};\n\nconst readExifOrientation$1 = (view, offset) => {\n    // Missing 0x45786966 Marker? No Exif Header, stop here\n    if (view.getUint32((offset += 2), false) !== 0x45786966)\n        return -1;\n    // First 2bytes defines byte align of TIFF data.\n    // If it is 0x4949=\"I I\", it means \"Intel\" type byte align\n    const intelByteAligned = view.getUint16((offset += 6), false) === 0x4949;\n    offset += view.getUint32(offset + 4, intelByteAligned);\n    const tags = view.getUint16(offset, intelByteAligned);\n    offset += 2;\n    // find Orientation tag\n    for (let i = 0; i < tags; i++) {\n        if (view.getUint16(offset + i * 12, intelByteAligned) === 0x0112)\n            return view.getUint16(offset + i * 12 + 8, intelByteAligned);\n    }\n};\nvar arrayBufferReadExifOrientationTag = (data) => {\n    if (!data)\n        return;\n    const view = new DataView(data);\n    // Every JPEG file starts from binary value '0xFFD8', so if it's not present, exit here\n    if (view.getUint16(0, false) != 0xffd8)\n        return;\n    const length = view.byteLength;\n    let offset = 2;\n    let marker;\n    while (offset < length) {\n        if (view.getUint16(offset + 2, false) <= 8)\n            return;\n        marker = view.getUint16(offset, false);\n        offset += 2;\n        // Exif Marker found\n        if (marker === 0xffe1)\n            return readExifOrientation$1(view, offset);\n        // Invalid marker, exit here\n        else if ((marker & 0xff00) !== 0xff00)\n            return;\n        // Next!\n        else\n            offset += view.getUint16(offset, false);\n    }\n};\n\nvar arrayBufferWriteExifOrientationTag = (data, value = 1) => {\n    if (!data)\n        return false;\n    const view = new DataView(data);\n    // Every JPEG file starts from binary value '0xFFD8', so if it's not present, exit here\n    if (view.getUint16(0) !== 0xffd8)\n        return false;\n    let offset = 2; // Start at 2 as we skipped two bytes (FFD8)\n    let marker;\n    let markerLength;\n    let orientationCorrected = false;\n    while (offset < view.byteLength) {\n        marker = view.getUint16(offset, false);\n        markerLength = view.getUint16(offset + 2, false) + 2;\n        // Test if is APP and COM markers\n        const isData = (marker >= 0xffe0 && marker <= 0xffef) || marker === 0xfffe;\n        if (!isData)\n            break;\n        if (!orientationCorrected)\n            orientationCorrected = writeExifOrientation(view, offset, value);\n        if (offset + markerLength > view.byteLength)\n            break;\n        offset += markerLength;\n    }\n    return orientationCorrected;\n};\nconst writeExifOrientation = (view, offset, orientation) => {\n    // Missing 0x45786966 Marker? No Exif Header, stop here\n    if (view.getUint32(offset + 4, false) !== 0x45786966)\n        return;\n    // next byte!\n    offset += 4;\n    // First 2bytes defines byte align of TIFF data.\n    // If it is 0x4949=\"I I\", it means \"Intel\" type byte align\n    const intelByteAligned = view.getUint16((offset += 6), false) === 0x4949;\n    offset += view.getUint32(offset + 4, intelByteAligned);\n    const tags = view.getUint16(offset, intelByteAligned);\n    offset += 2;\n    // find Orientation tag and overwrite with orientation value\n    for (let i = 0; i < tags; i++) {\n        if (view.getUint16(offset + i * 12, intelByteAligned) === 0x0112) {\n            view.setUint16(offset + i * 12 + 8, orientation, intelByteAligned);\n            return true;\n        }\n    }\n    return false;\n};\n\nvar isJPEG = (file) => /jpeg/.test(file.type);\n\nvar isPlainObject = (obj) => typeof obj == 'object' && obj.constructor == Object;\n\nvar stringify = (value) => (!isPlainObject(value) ? value : JSON.stringify(value));\n\nvar post = (url, dataset, options) => new Promise((resolve, reject) => {\n    const { token = {}, beforeSend = noop, onprogress = noop } = options;\n    token.cancel = () => request.abort();\n    const request = new XMLHttpRequest();\n    request.upload.onprogress = onprogress;\n    request.onload = () => request.status >= 200 && request.status < 300 ? resolve(request) : reject(request);\n    request.onerror = () => reject(request);\n    request.ontimeout = () => reject(request);\n    request.open('POST', encodeURI(url));\n    beforeSend(request);\n    request.send(dataset.reduce((formData, args) => {\n        // @ts-ignore\n        formData.append(...args.map(stringify));\n        return formData;\n    }, new FormData()));\n});\n\nvar ctxRotate = (ctx, rotation = 0, pivot) => {\n    if (rotation === 0)\n        return ctx;\n    ctx.translate(pivot.x, pivot.y);\n    ctx.rotate(rotation);\n    ctx.translate(-pivot.x, -pivot.y);\n    return ctx;\n};\n\nvar ctxTranslate = (ctx, x, y) => {\n    ctx.translate(x, y);\n    return ctx;\n};\n\nvar ctxScale = (ctx, x, y) => {\n    ctx.scale(x, y);\n    return ctx;\n};\n\nvar cropImageData = async (imageData, options = {}) => {\n    const { flipX, flipY, rotation, crop } = options;\n    const imageSize = sizeCreateFromAny(imageData);\n    const shouldFlip = flipX || flipY;\n    const shouldRotate = !!rotation;\n    const cropDefined = crop && (crop.x || crop.y || crop.width || crop.height);\n    const cropCoversImage = cropDefined && rectEqual(crop, rectCreateFromSize(imageSize));\n    const shouldCrop = cropDefined && !cropCoversImage;\n    // skip!\n    if (!shouldFlip && !shouldRotate && !shouldCrop)\n        return imageData;\n    // create drawing context\n    let imageDataOut;\n    let image = h('canvas', {\n        width: imageData.width,\n        height: imageData.height,\n    });\n    image.getContext('2d').putImageData(imageData, 0, 0);\n    // flip image data\n    if (shouldFlip) {\n        const ctx = h('canvas', {\n            width: image.width,\n            height: image.height,\n        }).getContext('2d');\n        ctxScale(ctx, flipX ? -1 : 1, flipY ? -1 : 1);\n        ctx.drawImage(image, flipX ? -image.width : 0, flipY ? -image.height : 0);\n        ctx.restore();\n        releaseCanvas(image);\n        image = ctx.canvas;\n    }\n    // rotate image data\n    if (shouldRotate) {\n        // if shouldRotate is true we also receive a crop rect\n        const outputSize = sizeApply(sizeCreateFromRect(rectCreateFromPoints(rectRotate(rectCreateFromAny(image), rotation))), Math.floor);\n        const ctx = h('canvas', {\n            width: crop.width,\n            height: crop.height,\n        }).getContext('2d');\n        ctxTranslate(ctx, -crop.x, -crop.y);\n        ctxRotate(ctx, rotation, sizeCenter(outputSize));\n        ctx.drawImage(image, (outputSize.width - image.width) * 0.5, (outputSize.height - image.height) * 0.5);\n        ctx.restore();\n        releaseCanvas(image);\n        image = ctx.canvas;\n    }\n    // crop image data\n    else if (shouldCrop) {\n        const ctx = image.getContext('2d');\n        imageDataOut = ctx.getImageData(crop.x, crop.y, crop.width, crop.height);\n        releaseCanvas(image);\n        return imageDataOut;\n    }\n    // done, return resulting image data\n    const ctx = image.getContext('2d');\n    imageDataOut = ctx.getImageData(0, 0, image.width, image.height);\n    releaseCanvas(image);\n    return imageDataOut;\n};\n\nvar resizeTransform = (options, done) => {\n    const { imageData, width, height } = options;\n    const originWidth = imageData.width;\n    const originHeight = imageData.height;\n    const targetWidth = Math.round(width);\n    const targetHeight = Math.round(height);\n    const inputData = imageData.data;\n    const outputData = new Uint8ClampedArray(targetWidth * targetHeight * 4);\n    const ratioWidth = originWidth / targetWidth;\n    const ratioHeight = originHeight / targetHeight;\n    const ratioWidthHalf = Math.ceil(ratioWidth * 0.5);\n    const ratioHeightHalf = Math.ceil(ratioHeight * 0.5);\n    for (let j = 0; j < targetHeight; j++) {\n        for (let i = 0; i < targetWidth; i++) {\n            const x2 = (i + j * targetWidth) * 4;\n            let weight = 0;\n            let weights = 0;\n            let weightsAlpha = 0;\n            let r = 0;\n            let g = 0;\n            let b = 0;\n            let a = 0;\n            const centerY = (j + 0.5) * ratioHeight;\n            for (let yy = Math.floor(j * ratioHeight); yy < (j + 1) * ratioHeight; yy++) {\n                const dy = Math.abs(centerY - (yy + 0.5)) / ratioHeightHalf;\n                const centerX = (i + 0.5) * ratioWidth;\n                const w0 = dy * dy;\n                for (let xx = Math.floor(i * ratioWidth); xx < (i + 1) * ratioWidth; xx++) {\n                    let dx = Math.abs(centerX - (xx + 0.5)) / ratioWidthHalf;\n                    const w = Math.sqrt(w0 + dx * dx);\n                    if (w >= -1 && w <= 1) {\n                        weight = 2 * w * w * w - 3 * w * w + 1;\n                        if (weight > 0) {\n                            dx = 4 * (xx + yy * originWidth);\n                            const ref = inputData[dx + 3];\n                            a += weight * ref;\n                            weightsAlpha += weight;\n                            if (ref < 255) {\n                                weight = (weight * ref) / 250;\n                            }\n                            r += weight * inputData[dx];\n                            g += weight * inputData[dx + 1];\n                            b += weight * inputData[dx + 2];\n                            weights += weight;\n                        }\n                    }\n                }\n            }\n            outputData[x2] = r / weights;\n            outputData[x2 + 1] = g / weights;\n            outputData[x2 + 2] = b / weights;\n            outputData[x2 + 3] = a / weightsAlpha;\n        }\n    }\n    done(null, {\n        data: outputData,\n        width: targetWidth,\n        height: targetHeight,\n    });\n};\n\nvar imageDataObjectToImageData = (obj) => {\n    if (obj instanceof ImageData) {\n        return obj;\n    }\n    let imageData;\n    try {\n        imageData = new ImageData(obj.width, obj.height);\n    }\n    catch (err) {\n        // IE + Old EDGE (tested on 12)\n        const canvas = h('canvas');\n        imageData = canvas.getContext('2d').createImageData(obj.width, obj.height);\n    }\n    imageData.data.set(obj.data);\n    return imageData;\n};\n\nvar resizeImageData = async (imageData, options = {}) => {\n    const { width, height, fit, upscale } = options;\n    // no need to rescale\n    if (!width && !height)\n        return imageData;\n    let targetWidth = width;\n    let targetHeight = height;\n    if (!width) {\n        targetWidth = height;\n    }\n    else if (!height) {\n        targetHeight = width;\n    }\n    if (fit !== 'force') {\n        let scalarWidth = targetWidth / imageData.width;\n        let scalarHeight = targetHeight / imageData.height;\n        let scalar = 1;\n        if (fit === 'cover') {\n            scalar = Math.max(scalarWidth, scalarHeight);\n        }\n        else if (fit === 'contain') {\n            scalar = Math.min(scalarWidth, scalarHeight);\n        }\n        // if image is too small, exit here with original image\n        if (scalar > 1 && upscale === false)\n            return imageData;\n        targetWidth = Math.round(imageData.width * scalar);\n        targetHeight = Math.round(imageData.height * scalar);\n    }\n    // no need to resize?\n    if (imageData.width === targetWidth && imageData.height === targetHeight)\n        return imageData;\n    // let's resize!\n    imageData = await thread(resizeTransform, [{ imageData: imageData, width: targetWidth, height: targetHeight }], [imageData.data.buffer]);\n    // the resizer returns a plain object, not an actual image data object, lets create one\n    return imageDataObjectToImageData(imageData);\n};\n\nvar colorEffect = (options, done) => {\n    const { imageData, matrix } = options;\n    if (!matrix)\n        return done(null, imageData);\n    const outputData = new Uint8ClampedArray(imageData.width * imageData.height * 4);\n    const data = imageData.data;\n    const l = data.length;\n    const m11 = matrix[0];\n    const m12 = matrix[1];\n    const m13 = matrix[2];\n    const m14 = matrix[3];\n    const m15 = matrix[4];\n    const m21 = matrix[5];\n    const m22 = matrix[6];\n    const m23 = matrix[7];\n    const m24 = matrix[8];\n    const m25 = matrix[9];\n    const m31 = matrix[10];\n    const m32 = matrix[11];\n    const m33 = matrix[12];\n    const m34 = matrix[13];\n    const m35 = matrix[14];\n    const m41 = matrix[15];\n    const m42 = matrix[16];\n    const m43 = matrix[17];\n    const m44 = matrix[18];\n    const m45 = matrix[19];\n    let index = 0;\n    let r = 0.0;\n    let g = 0.0;\n    let b = 0.0;\n    let a = 0.0;\n    let mr = 0.0;\n    let mg = 0.0;\n    let mb = 0.0;\n    let ma = 0.0;\n    let or = 0.0;\n    let og = 0.0;\n    let ob = 0.0;\n    for (; index < l; index += 4) {\n        r = data[index] / 255;\n        g = data[index + 1] / 255;\n        b = data[index + 2] / 255;\n        a = data[index + 3] / 255;\n        mr = r * m11 + g * m12 + b * m13 + a * m14 + m15;\n        mg = r * m21 + g * m22 + b * m23 + a * m24 + m25;\n        mb = r * m31 + g * m32 + b * m33 + a * m34 + m35;\n        ma = r * m41 + g * m42 + b * m43 + a * m44 + m45;\n        or = Math.max(0, mr * ma) + (1.0 - ma);\n        og = Math.max(0, mg * ma) + (1.0 - ma);\n        ob = Math.max(0, mb * ma) + (1.0 - ma);\n        outputData[index] = Math.max(0.0, Math.min(1.0, or)) * 255;\n        outputData[index + 1] = Math.max(0.0, Math.min(1.0, og)) * 255;\n        outputData[index + 2] = Math.max(0.0, Math.min(1.0, ob)) * 255;\n        outputData[index + 3] = a * 255;\n    }\n    done(null, {\n        data: outputData,\n        width: imageData.width,\n        height: imageData.height,\n    });\n};\n\nvar convolutionEffect = (options, done) => {\n    const { imageData, matrix } = options;\n    if (!matrix)\n        return done(null, imageData);\n    // calculate kernel weight\n    let kernelWeight = matrix.reduce((prev, curr) => prev + curr);\n    // input info\n    const inputWidth = imageData.width;\n    const inputHeight = imageData.height;\n    const inputData = imageData.data;\n    let i = 0;\n    let x = 0;\n    let y = 0;\n    const side = Math.round(Math.sqrt(matrix.length));\n    const sideHalf = Math.floor(side / 2);\n    let r = 0, g = 0, b = 0, a = 0, cx = 0, cy = 0, scy = 0, scx = 0, srcOff = 0, weight = 0;\n    const outputData = new Uint8ClampedArray(inputWidth * inputHeight * 4);\n    for (y = 0; y < inputHeight; y++) {\n        for (x = 0; x < inputWidth; x++) {\n            // calculate the weighed sum of the source image pixels that\n            // fall under the convolution matrix\n            r = 0;\n            g = 0;\n            b = 0;\n            a = 0;\n            for (cy = 0; cy < side; cy++) {\n                for (cx = 0; cx < side; cx++) {\n                    scy = y + cy - sideHalf;\n                    scx = x + cx - sideHalf;\n                    if (scy < 0 || scy >= inputHeight || scx < 0 || scx >= inputWidth)\n                        continue;\n                    srcOff = (scy * inputWidth + scx) * 4;\n                    weight = matrix[cy * side + cx];\n                    r += inputData[srcOff] * weight;\n                    g += inputData[srcOff + 1] * weight;\n                    b += inputData[srcOff + 2] * weight;\n                    a += inputData[srcOff + 3] * weight;\n                }\n            }\n            outputData[i] = r / kernelWeight;\n            outputData[i + 1] = g / kernelWeight;\n            outputData[i + 2] = b / kernelWeight;\n            outputData[i + 3] = a / kernelWeight;\n            i += 4;\n        }\n    }\n    done(null, {\n        data: outputData,\n        width: inputWidth,\n        height: inputHeight,\n    });\n};\n\nvar vignetteEffect = (options, done) => {\n    const { imageData, strength } = options;\n    if (!strength)\n        return done(null, imageData);\n    const outputData = new Uint8ClampedArray(imageData.width * imageData.height * 4);\n    const inputWidth = imageData.width;\n    const inputHeight = imageData.height;\n    const data = imageData.data;\n    const dist = (x, y) => {\n        dx = x - cx;\n        dy = y - cy;\n        return Math.sqrt(dx * dx + dy * dy);\n    };\n    let index = 0;\n    let x = 0;\n    let y = 0;\n    let cx = inputWidth * 0.5;\n    let cy = inputHeight * 0.5;\n    let dx;\n    let dy;\n    let f;\n    let dm = dist(0, 0);\n    for (y = 0; y < inputHeight; y++) {\n        for (x = 0; x < inputWidth; x++) {\n            index = (x + y * inputWidth) * 4;\n            f = (dist(x, y) * strength) / dm;\n            if (strength > 0) {\n                outputData[index] = data[index] * (1 - f);\n                outputData[index + 1] = data[index + 1] * (1 - f);\n                outputData[index + 2] = data[index + 2] * (1 - f);\n            }\n            else {\n                outputData[index] = data[index] + f * -(255 - data[index]);\n                outputData[index + 1] = data[index + 1] + f * -(255 - data[index + 1]);\n                outputData[index + 2] = data[index + 2] + f * -(255 - data[index + 2]);\n            }\n            outputData[index + 3] = data[index + 3];\n        }\n    }\n    done(null, {\n        data: outputData,\n        width: imageData.width,\n        height: imageData.height,\n    });\n};\n\nvar noiseEffect = (options, done) => {\n    const { imageData, level, monochrome = false } = options;\n    if (!level)\n        return done(null, imageData);\n    const outputData = new Uint8ClampedArray(imageData.width * imageData.height * 4);\n    const data = imageData.data;\n    const l = data.length;\n    let index = 0;\n    let r;\n    let g;\n    let b;\n    let average;\n    const rand = () => (-1 + Math.random() * 2) * 255 * level;\n    for (; index < l; index += 4) {\n        if (monochrome) {\n            average = rand();\n            r = average;\n            g = average;\n            b = average;\n        }\n        else {\n            r = rand();\n            g = rand();\n            b = rand();\n        }\n        outputData[index] = data[index] + r;\n        outputData[index + 1] = data[index + 1] + g;\n        outputData[index + 2] = data[index + 2] + b;\n        outputData[index + 3] = data[index + 3];\n    }\n    done(null, {\n        data: outputData,\n        width: imageData.width,\n        height: imageData.height,\n    });\n};\n\nvar gammaEffect = (options, done) => {\n    const { imageData, level } = options;\n    if (!level)\n        return done(null, imageData);\n    const outputData = new Uint8ClampedArray(imageData.width * imageData.height * 4);\n    const data = imageData.data;\n    const l = data.length;\n    let index = 0;\n    let r;\n    let g;\n    let b;\n    for (; index < l; index += 4) {\n        r = data[index] / 255;\n        g = data[index + 1] / 255;\n        b = data[index + 2] / 255;\n        outputData[index] = Math.pow(r, level) * 255;\n        outputData[index + 1] = Math.pow(g, level) * 255;\n        outputData[index + 2] = Math.pow(b, level) * 255;\n        outputData[index + 3] = data[index + 3];\n    }\n    done(null, {\n        data: outputData,\n        width: imageData.width,\n        height: imageData.height,\n    });\n};\n\nvar isIdentityMatrix = (matrix) => {\n    /*\n    [\n        1, 0, 0, 0, 0\n        0, 1, 0, 0, 0\n        0, 0, 1, 0, 0\n        0, 0, 0, 1, 0\n    ]\n    */\n    const l = matrix.length;\n    let v;\n    let s = l >= 20 ? 6 : l >= 16 ? 5 : 3;\n    for (let i = 0; i < l; i++) {\n        v = matrix[i];\n        if (v === 1 && i % s !== 0)\n            return false;\n        else if (v !== 0 && v !== 1)\n            return false;\n    }\n    return true;\n};\n\nvar filterImageData = async (imageData, options = {}) => {\n    const { colorMatrix, convolutionMatrix, gamma: gammaLevel, noise: noiseLevel, vignette: vignetteStrength, } = options;\n    // filters\n    const filters = [];\n    // apply convolution matrix\n    if (convolutionMatrix) {\n        filters.push([convolutionEffect, { matrix: convolutionMatrix.clarity }]);\n    }\n    // apply noise\n    if (gammaLevel > 0) {\n        filters.push([gammaEffect, { level: 1.0 / gammaLevel }]);\n    }\n    // apply color matrix\n    if (colorMatrix && !isIdentityMatrix(colorMatrix)) {\n        filters.push([colorEffect, { matrix: colorMatrix }]);\n    }\n    // apply noise\n    if (noiseLevel > 0 || noiseLevel < 0) {\n        filters.push([noiseEffect, { level: noiseLevel }]);\n    }\n    // apply vignette\n    if (vignetteStrength > 0 || vignetteStrength < 0) {\n        filters.push([vignetteEffect, { strength: vignetteStrength }]);\n    }\n    // no changes\n    if (!filters.length)\n        return imageData;\n    // builds effect chain\n    const chain = (transforms, i) => `(err, imageData) => {\n            (${transforms[i][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${i}]), \n                ${transforms[i + 1] ? chain(transforms, i + 1) : 'done'})\n        }`;\n    const filterChain = `function (options, done) {\n        const filterInstructions = options.filterInstructions;\n        const imageData = options.imageData;\n        (${chain(filters, 0)})(null, imageData)\n    }`;\n    imageData = await thread(filterChain, [\n        {\n            imageData: imageData,\n            filterInstructions: filters.map((t) => t[1]),\n        },\n    ], [imageData.data.buffer]);\n    // the resizer returns a plain object, not an actual image data object, lets create one\n    return imageDataObjectToImageData(imageData);\n};\n\nvar isNumber = (v) => typeof v === 'number';\n\nvar isEmoji = (str) => isString(str) &&\n    str.match(/(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|\\ud83c[\\ude32-\\ude3a]|\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/g) !== null;\n\nvar hasProp = (obj, key) => obj.hasOwnProperty(key);\n\nvar isObject = (v) => typeof v === 'object';\n\nconst copy = (val) => (isObject(val) ? deepCopy(val) : val);\nconst deepCopy = (src) => {\n    let dst;\n    if (Array.isArray(src)) {\n        dst = [];\n        src.forEach((val, i) => {\n            dst[i] = copy(val);\n        });\n    }\n    else {\n        dst = {};\n        Object.keys(src).forEach((key) => {\n            const val = src[key];\n            dst[key] = copy(val);\n        });\n    }\n    return dst;\n};\n\nvar isFunction = (v) => typeof v === 'function';\n\nvar isArray = (arr) => Array.isArray(arr);\n\nlet result$3 = null;\nvar isMac = () => {\n    if (result$3 === null)\n        result$3 = isBrowser() && /^mac/i.test(navigator.platform);\n    return result$3;\n};\n\nlet result$4 = null;\nvar isIOS = () => {\n    if (result$4 === null)\n        // first part is for iPhones and iPads iOS 12 and below second part is for iPads with iOS 13 and up\n        result$4 =\n            isBrowser() &&\n                (isUserAgent(/iPhone|iPad|iPod/) || (isMac() && navigator.maxTouchPoints >= 1));\n    return result$4;\n};\n\nvar isApple = () => isIOS() || isMac();\n\nvar isWindows = () => /^win/i.test(navigator.platform);\n\n// macos:   font-size: 123, x: 63.5, y: 110\n// windows: font-size: 112, x: 64, y: 103\n// android: font-size: 112, x: 64, y: 102\nlet x = 64;\nlet y = 102;\nlet fontSize = 112;\nlet hasSetValues = false;\nvar getEmojiSVG = (emoji, alt) => {\n    if (!hasSetValues && isBrowser()) {\n        if (isWindows())\n            y = 103;\n        if (isApple()) {\n            x = 63.5;\n            y = 110;\n            fontSize = 123;\n        }\n        hasSetValues = true;\n    }\n    return `<svg${alt ? ` aria-label=\"${alt}\"` : ''} width=\"128\" height=\"128\" viewBox=\"0 0 128 128\" preserveAspectRatio=\"xMinYMin meet\" xmlns=\"http://www.w3.org/2000/svg\"><text x=\"${x}\" y=\"${y}\" alignment-baseline=\"text-top\" dominant-baseline=\"text-top\" text-anchor=\"middle\" font-size=\"${fontSize}px\">${emoji}</text></svg>`;\n};\n\nvar SVGToDataURL = (svg) => `data:image/svg+xml,${svg.replace('<', '%3C').replace('>', '%3E')}`;\n\nvar isBinary = (v) => v instanceof Blob;\n\nvar toPercentage = (value, total) => `${(value / total) * 100}%`;\n\nvar loadImage = (image, onsize = undefined) => new Promise((resolve, reject) => {\n    // the image element we'll use to load the image\n    let imageElement = image;\n    let sizeCalculated = false;\n    const reportSize = () => {\n        if (sizeCalculated)\n            return;\n        sizeCalculated = true;\n        isFunction(onsize) &&\n            /* Use Promise.resolve to make async but place before resolve of parent promise */\n            Promise.resolve().then(() => onsize(sizeCreate(imageElement.naturalWidth, imageElement.naturalHeight)));\n    };\n    // if is not an image element, it must be a valid image source\n    if (!imageElement.src) {\n        imageElement = new Image();\n        imageElement.src = isString(image) ? image : URL.createObjectURL(image);\n    }\n    if (imageElement.complete) {\n        reportSize();\n        return resolve(imageElement);\n    }\n    // try to calculate size faster\n    if (isFunction(onsize))\n        getImageElementSize(imageElement).then(reportSize).catch(reject);\n    imageElement.onload = () => {\n        reportSize();\n        resolve(imageElement);\n    };\n    imageElement.onerror = reject;\n});\n\nvar colorArrayToRGBA = (color) => `rgba(${Math.round(color[0] * 255)}, ${Math.round(color[1] * 255)}, ${Math.round(color[2] * 255)}, ${isNumber(color[3]) ? color[3] : 1})`;\n\nconst textPadding = 20;\n// font offset\n// font size 16 -> 2, 4\n// font size 32 -> 4, 6\n// font size 64 -> 8, 12\n// font size 128 -> 16, 24\n// font size 256 -> 32, 48\nlet fontOffsetBrowser = undefined;\nconst getBrowserFontOffset = (fontSize) => {\n    if (!fontOffsetBrowser) {\n        // size\n        const size = 32;\n        // let's calculate it\n        const ctx = createSimpleContext(size, size);\n        updateTextContext(ctx, { fontSize: 100, color: '#fff' });\n        ctx.fillText('F', 0, 0);\n        // get pixel data so we can find the white pixels\n        const data = ctx.getImageData(0, 0, size, size).data;\n        // find x offset\n        let p = 0;\n        let step = 4;\n        let to = data.length;\n        let from = to - size * 4;\n        for (p = from; p < to; p += step) {\n            if (data[p])\n                break;\n        }\n        const x = (p - from) / step;\n        // find y offset\n        from = (size - 1) * 4;\n        step = size * 4;\n        for (p = from; p < to; p += step) {\n            if (data[p])\n                break;\n        }\n        const y = (p - from) / step;\n        fontOffsetBrowser = vectorCreate(x, y);\n        // done with canvas\n        releaseCanvas(ctx.canvas);\n    }\n    return vectorCreate(-fontOffsetBrowser.x * fontSize * 0.01, -fontOffsetBrowser.y * fontSize * 0.01);\n};\nconst createSimpleContext = (width = 1, height = 1) => {\n    const canvas = h('canvas');\n    const ctx = canvas.getContext('2d');\n    ctx.canvas.width = width;\n    ctx.canvas.height = height;\n    return ctx;\n};\nconst updateTextContext = (ctx, options) => {\n    const { fontSize = 16, fontFamily = 'sans-serif', fontWeight = 'normal', fontVariant = 'normal', fontStyle = 'normal', textAlign = 'left', color = '#000', } = options;\n    ctx.font = `${fontStyle} ${fontVariant} ${fontWeight} ${fontSize}px ${fontFamily}`;\n    ctx.textBaseline = 'top';\n    ctx.textAlign = textAlign;\n    ctx.fillStyle = Array.isArray(color) ? colorArrayToRGBA(color) : color;\n};\nconst createSimpleTextContext = (options) => {\n    const ctx = createSimpleContext();\n    updateTextContext(ctx, options);\n    return ctx;\n};\nconst computeLineHeight = (fontSize, lineHeight) => isFunction(lineHeight) ? lineHeight(fontSize) : lineHeight;\nconst getMeasureVisibleWidth = (measure) => Math.abs(measure.actualBoundingBoxLeft) + Math.abs(measure.actualBoundingBoxRight);\nconst resizeContextToFitText = (ctx, text, options) => {\n    const { width, height } = measureTextContext(ctx, text, computeLineHeight(options.fontSize, options.lineHeight));\n    ctx.canvas.width = Math.ceil(width);\n    ctx.canvas.height = Math.ceil(height);\n    return ctx;\n};\nconst measureTextContext = (ctx, text, computedLineHeight) => {\n    const storedTextAlign = ctx.textAlign;\n    ctx.textAlign = 'left';\n    // calculate width\n    const lines = text.split('\\n');\n    const width = lines.reduce((prev, curr) => {\n        const lineWidth = getMeasureVisibleWidth(ctx.measureText(curr));\n        if (lineWidth > prev) {\n            prev = lineWidth;\n        }\n        return prev;\n    }, 1);\n    ctx.textAlign = storedTextAlign;\n    // calculate height\n    const height = computedLineHeight * lines.length;\n    return sizeCreate(Math.ceil(width), Math.ceil(height));\n};\nconst TextSizeCache = new Map();\nconst createTextSizeHash = (text, { fontSize, fontFamily, lineHeight, fontWeight, fontStyle, fontVariant }) => `${[text, fontSize, fontWeight, fontStyle, fontVariant, fontFamily].join('_')}_${isFunction(lineHeight) ? lineHeight(fontSize) : lineHeight}`;\nconst textSize = (text, options) => {\n    const ctx = createSimpleTextContext(options);\n    if (options.width)\n        text = wrapText(ctx, text, options.width);\n    const hash = createTextSizeHash(text, options);\n    let size = TextSizeCache.get(hash);\n    if (size)\n        return { ...size };\n    size = measureTextContext(ctx, text, computeLineHeight(options.fontSize, options.lineHeight));\n    TextSizeCache.set(hash, size);\n    return { ...size };\n};\nconst wrapText = (ctx, text, lineWidth) => {\n    // exit if no text\n    if (text.length === 0)\n        return '';\n    const res = [];\n    let lineBuffer = '';\n    let lineIndex = 0;\n    let measureWidth;\n    const paragraphs = text.split('\\n\\n');\n    // draw the current line\n    const pushLine = () => {\n        if (!lineBuffer.length)\n            return;\n        if (!res[lineIndex]) {\n            res[lineIndex] = [];\n        }\n        res[lineIndex].push(lineBuffer);\n        // clear buffer\n        lineBuffer = '';\n    };\n    const fitChar = (char) => {\n        const testLine = lineBuffer + char;\n        // measure width of entire line if adding these chars\n        measureWidth = ctx.measureText(testLine).width;\n        // fits on line?\n        if (measureWidth < lineWidth) {\n            lineBuffer = testLine;\n        }\n        else {\n            // doesn't fit but line buffer is empty, just print the character and move to next line\n            if (!lineBuffer.length) {\n                lineBuffer = testLine;\n                pushLine();\n            }\n            // fits, lets print current line and move char to next line\n            else {\n                pushLine();\n                lineBuffer = char;\n            }\n            lineIndex++;\n        }\n    };\n    const fitWord = (word) => {\n        const testLine = lineBuffer.length ? lineBuffer + ' ' + word : word;\n        // measure width of entire line if adding these chars\n        measureWidth = ctx.measureText(testLine).width;\n        // fits on line?\n        if (measureWidth < lineWidth) {\n            lineBuffer = testLine;\n        }\n        // wrap to next line\n        else {\n            // if line buffer is empty, whole word doesn't fit, need to cut it up\n            if (!lineBuffer.length) {\n                word.split('').forEach(fitChar);\n            }\n            // there are words in the buffer that do fit, let's draw the line and move this word to the next line\n            else {\n                // draw current buffer\n                pushLine();\n                lineIndex++;\n                // retry to fit this word\n                fitWord(word);\n            }\n        }\n    };\n    paragraphs.forEach((p) => {\n        const lines = p.split('\\n');\n        lines.forEach((l) => {\n            l.split(' ').forEach(fitWord);\n            // end of line reached, if we have words in our buffer\n            // at this point we need to draw them and then move to the next line\n            if (lineBuffer.length)\n                pushLine();\n            // forced new line\n            lineIndex++;\n        });\n        // forced new line\n        lineIndex++;\n    });\n    return res.map((line) => line.join(' ')).join('\\n');\n};\nconst drawText = (ctx, text = '', options = {}) => {\n    // exit if no text\n    if (text.length === 0)\n        return ctx;\n    const { x = 0, y = 0, lineWidth = 0, textAlign, fontSize, lineHeight } = options;\n    // determine where the browser will render the font and correct for browser differences\n    const browserFontOffset = vectorAdd(getBrowserFontOffset(fontSize), vectorCreate(fontSize / 12, fontSize / 3.75));\n    const fontOffsetX = x + browserFontOffset.x;\n    const fontOffsetY = y + browserFontOffset.y;\n    const lineHeightComputed = isFunction(lineHeight) ? lineHeight(fontSize) : lineHeight;\n    let offset = textAlign === 'right' ? lineWidth : textAlign === 'center' ? lineWidth * 0.5 : 0;\n    text.split('\\n').forEach((line, i) => {\n        ctx.fillText(line, fontOffsetX + offset, fontOffsetY + i * lineHeightComputed);\n    });\n    return ctx;\n};\n\n//#region shape generic\nconst shapeContain = (shape, parentRect) => {\n    const shapeAspectRatio = shape.width / shape.height;\n    const containedShape = rectContainRect(parentRect, shapeAspectRatio);\n    if (shape.width > containedShape.width || shape.height > containedShape.height) {\n        shape.width = containedShape.width;\n        shape.height = containedShape.height;\n    }\n    return shape;\n};\nconst shapeCenter = (shape, position) => {\n    shape.x = position.x - shape.width * 0.5;\n    shape.y = position.y - shape.height * 0.5;\n    return shape;\n};\nconst shapeDeepCopy = (shape) => {\n    // don't attempt to clone background image element\n    // TODO: MOVE IMAGE ELEMENT TO SOME INTERNAL CACHE\n    const shapeShallowCopy = { ...shape };\n    shapeShallowCopy.backgroundImageElement = undefined;\n    const shapeDeepCopy = deepCopy(shapeShallowCopy);\n    // we don't want a million image elements so we'll reference the original one\n    if (shape.backgroundImageElement)\n        shapeDeepCopy.backgroundImageElement = shape.backgroundImageElement;\n    return shapeDeepCopy;\n};\nconst getContextSize = (context, size = {}) => {\n    const contextAspectRatio = rectAspectRatio(context);\n    let width;\n    let height;\n    if (size.width && size.height)\n        return sizeClone(size);\n    if (size.width || size.height) {\n        width = parseFloat(size.width || Number.MAX_SAFE_INTEGER);\n        height = parseFloat(size.height || Number.MAX_SAFE_INTEGER);\n        const min = Math.min(width, height);\n        if (isString(size.width) || isString(size.height)) {\n            width = `${min}%`;\n            height = `${min * contextAspectRatio}%`;\n        }\n        else {\n            width = min;\n            height = min;\n        }\n    }\n    else {\n        const min = 10;\n        width = `${min}%`;\n        height = `${min * contextAspectRatio}%`;\n    }\n    return {\n        width,\n        height,\n    };\n};\nconst shapeCreateFromEmoji = (emoji, props = {}) => {\n    return {\n        width: undefined,\n        height: undefined,\n        ...props,\n        aspectRatio: 1,\n        backgroundImage: SVGToDataURL(getEmojiSVG(emoji)),\n    };\n};\nconst shapeCreateFromImage = (src, oncomplete, props = {}) => {\n    const shape = {\n        // required/default image shape props\n        width: undefined,\n        height: undefined,\n        aspectRatio: undefined,\n        backgroundColor: [0, 0, 0, 0],\n        // custom props\n        ...props,\n        // set image\n        backgroundImage: isString(src) ? src : URL.createObjectURL(src),\n    };\n    return shapeLoadResources(shape, oncomplete);\n};\nconst shapeLoadResources = (shape, oncomplete = noop) => {\n    if (shape.backgroundImage) {\n        // done loading\n        if (shape.isComplete) {\n            oncomplete(shape.isError, shape);\n            return shape;\n        }\n        // is still loading\n        if (shape.isLoading)\n            return shape;\n        // default state before loading\n        shape.isComplete = false;\n        shape.isError = false;\n        shape.isLoading = true;\n        // updates the size of the shape relative to the image\n        const updateShapeSize = (imageSize) => {\n            // if background size is not set the shape is not locked to the image aspect ratio\n            if (shape.backgroundSize)\n                return;\n            // always locked to aspect ratio\n            const aspectRatio = imageSize.width / imageSize.height;\n            // check if width has been defined, if so, we update height to match aspect ratio\n            const width = shape.width || imageSize.width;\n            const height = width / aspectRatio;\n            // set final dimensions\n            shape.width = width;\n            shape.height = height;\n            shape.aspectRatio = imageSize.width / imageSize.height;\n        };\n        // now loading\n        loadImage(shape.backgroundImage, updateShapeSize)\n            .then((image) => {\n            shape.backgroundImageElement = image;\n        })\n            .catch((error) => {\n            shape.isError = error;\n        })\n            .finally(() => {\n            shape.isLoading = false;\n            shape.isComplete = true;\n            oncomplete(shape.isError, shape);\n        });\n    }\n    return shape;\n};\nconst shapeCreateFromPreset = (preset, parentRect, oncomplete) => {\n    let shape;\n    if (isString(preset) || isBinary(preset)) {\n        // if is emoji, create default markup,\n        if (isEmoji(preset)) {\n            // create markup\n            shape = shapeCreateFromEmoji(preset, getContextSize(parentRect));\n            setTimeout(() => oncomplete(undefined, shape), 0);\n        }\n        // is URL, create default markup for image\n        else {\n            shape = shapeCreateFromImage(preset, oncomplete, {\n                // disableStyle: true,\n                ...getContextSize(parentRect),\n            });\n        }\n    }\n    else {\n        // is using src shortcut\n        if (preset.src) {\n            // shape options\n            const shapeOptions = {\n                // default shape styles\n                ...preset.shape,\n                // precalcualte size of shape in context\n                ...getContextSize(parentRect, preset.shape || preset),\n            };\n            // emoji markup\n            if (isEmoji(preset.src)) {\n                shape = shapeCreateFromEmoji(preset.src, shapeOptions);\n                setTimeout(() => oncomplete(undefined, shape), 0);\n            }\n            // is url\n            else if (isString(preset.src)) {\n                shape = shapeCreateFromImage(preset.src, oncomplete, shapeOptions);\n            }\n        }\n        // should have markup defined\n        else if (preset.shape) {\n            shape = shapeDeepCopy(preset.shape);\n        }\n    }\n    if (hasProp(shape, 'backgroundImage')) {\n        // set transparent background if no background color defined\n        if (!hasProp(shape, 'backgroundColor')) {\n            shape.backgroundColor = [0, 0, 0, 0];\n        }\n        // for image presets, disable styles by default\n        if (!hasProp(shape, 'disableStyle')) {\n            shape.disableStyle = true;\n        }\n        // by default don't allow flipping\n        if (!hasProp(shape, 'disableFlip')) {\n            shape.disableFlip = true;\n        }\n    }\n    return parentRect ? shapeComputeDisplay(shape, parentRect) : shape;\n};\nconst shapeLineGetStartPoint = (line) => vectorCreate(line.x1, line.y1);\nconst shapeLineGetEndPoint = (line) => vectorCreate(line.x2, line.y2);\nconst shapeTextUID = ({ text, textAlign, fontSize, fontFamily, lineHeight, fontWeight, fontStyle, fontVariant, }) => `${[text, textAlign, fontSize, fontWeight, fontStyle, fontVariant, fontFamily].join('_')}_${isFunction(lineHeight) ? lineHeight(fontSize) : lineHeight}`;\n//#endregion\n//#region shape testing\n// shape types\nconst shapeIsText = (shape) => hasProp(shape, 'text');\nconst shapeIsTextLine = (shape) => shapeIsText(shape) && !(shapeHasRelativeSize(shape) || hasProp(shape, 'width'));\nconst shapeIsTextBox = (shape) => shapeIsText(shape) && (shapeHasRelativeSize(shape) || hasProp(shape, 'width'));\nconst shapeIsRect = (shape) => !shapeIsText(shape) && shapeHasComputedSize(shape);\nconst shapeIsEllipse = (shape) => hasProp(shape, 'rx');\nconst shapeIsLine = (shape) => hasProp(shape, 'x1') && !shapeIsTriangle(shape);\nconst shapeIsTriangle = (shape) => hasProp(shape, 'x3');\nconst shapeIsPath = (shape) => hasProp(shape, 'points');\n// shape state\nconst shapeIsTextEmpty = (shape) => shapeIsText(shape) && !shape.text.length;\nconst shapeIsTextEditing = (shape) => shapeIsText(shape) && shape.isEditing;\nconst shapeIsVisible = (shape) => hasProp(shape, 'opacity') ? shape.opacity > 0 : true;\nconst shapeIsSelected = (shape) => shape.isSelected;\nconst shapeIsDraft = (shape) => shape.isDraft;\nconst shapeHasSize = (shape) => hasProp(shape, 'width') && hasProp(shape, 'height');\nconst shapeHasNumericStroke = (shape) => isNumber(shape.strokeWidth) && shape.strokeWidth > 0; // only relevant if is bigger than 0\nconst shapeHasRelativePosition = (shape) => {\n    const hasRight = hasProp(shape, 'right');\n    const hasBottom = hasProp(shape, 'bottom');\n    return hasRight || hasBottom;\n};\nconst shapeHasTexture = (shape) => hasProp(shape, 'backgroundImage') || hasProp(shape, 'text');\nconst shapeHasRelativeSize = (shape) => ((hasProp(shape, 'x') || hasProp(shape, 'left')) && hasProp(shape, 'right')) ||\n    ((hasProp(shape, 'y') || hasProp(shape, 'top')) && hasProp(shape, 'bottom'));\nconst shapeHasComputedSize = (shape) => shapeHasSize(shape) || shapeHasRelativeSize(shape);\n// actions\nconst shapeSelect = (shape) => {\n    shape.isSelected = true;\n    return shape;\n};\nconst shapeMakeDraft = (shape) => {\n    shape.isDraft = true;\n    return shape;\n};\n// rights\nconst shapeCanStyle = (shape, style) => {\n    if (shape.disableStyle === true)\n        return false;\n    if (isArray(shape.disableStyle)) {\n        return !shape.disableStyle.includes(style);\n    }\n    return true;\n};\nconst shapeCanErase = (shape) => shape.disableErase !== true;\nconst shapeCanSelect = (shape) => shape.disableSelect !== true && !shapeIsPath(shape) && !shapeIsTriangle(shape);\nconst shapeCanRemove = (shape) => shape.disableRemove !== true;\nconst shapeCanDuplicate = (shape) => shape.disableDuplicate !== true && shapeCanMove(shape);\nconst shapeCanReorder = (shape) => shape.disableReorder !== true;\nconst shapeCanFlip = (shape) => {\n    if (shape.disableFlip)\n        return false;\n    if (shapeIsDraft(shape) || shapeHasRelativePosition(shape))\n        return false;\n    return shapeHasTexture(shape);\n};\nconst shapeCanInput = (shape, input) => {\n    if (!shapeIsText(shape))\n        return false;\n    if (shape.disableInput === true)\n        return false;\n    if (isFunction(shape.disableInput))\n        return shape.disableInput(input != null ? input : shape.text);\n    return input || true;\n};\nconst shapeCanMove = (shape) => shape.disableMove !== true &&\n    !shapeIsDraft(shape) &&\n    !shapeIsPath(shape) &&\n    !shapeHasRelativePosition(shape);\nconst shapeCanResize = (shape) => shape.disableResize !== true &&\n    !shapeIsDraft(shape) &&\n    (shapeHasSize(shape) || shapeIsTextBox(shape) || shapeIsEllipse(shape) || shapeIsLine(shape)) &&\n    !shapeHasRelativePosition(shape) &&\n    shapeCanMove(shape);\nconst shapeCanRotate = (shape) => shape.disableRotate !== true &&\n    !shapeIsDraft(shape) &&\n    (shapeHasSize(shape) || hasProp(shape, 'text') || shapeIsEllipse(shape)) &&\n    !shapeHasRelativePosition(shape);\n//#endregion\n//#region shape formatting\nconst shapeDeleteRelativeProps = (shape) => {\n    delete shape.left;\n    delete shape.right;\n    delete shape.top;\n    delete shape.bottom;\n    return shape;\n};\nconst shapeDeleteTransformProps = (shape) => {\n    delete shape.rotation;\n    return shape;\n};\nconst shapeFormatStroke = (shape) => {\n    shape.strokeWidth = shape.strokeWidth || 1;\n    shape.strokeColor = shape.strokeColor || [0, 0, 0];\n    return shape;\n};\nconst shapeFormatFill = (shape) => {\n    shape.backgroundColor = shape.backgroundColor\n        ? shape.backgroundColor\n        : shape.strokeWidth || shape.backgroundImage\n            ? undefined\n            : [0, 0, 0];\n    return shape;\n};\nconst autoLineHeight = (fontSize) => fontSize * 1.2;\nconst shapeFormatText = (shape) => {\n    shape.fontSize = shape.fontSize || 16;\n    shape.fontFamily = shape.fontFamily || 'sans-serif';\n    shape.fontWeight = shape.fontWeight || 'normal';\n    shape.fontStyle = shape.fontStyle || 'normal';\n    shape.fontVariant = shape.fontVariant || 'normal';\n    shape.lineHeight = isNumber(shape.lineHeight) ? shape.lineHeight : autoLineHeight;\n    shape.color = shape.color || [0, 0, 0];\n    return shapeIsTextLine(shape) ? shapeFormatTextLine(shape) : shapeFormatTextBox(shape);\n};\nconst shapeFormatTextLine = (shape) => {\n    delete shape.textAlign;\n    return shapeDeleteRelativeProps(shape);\n};\nconst shapeFormatTextBox = (shape) => {\n    shape.textAlign = shape.textAlign || 'left';\n    return shape;\n};\nconst shapeFormatRect = (shape) => {\n    shape.cornerRadius = shape.cornerRadius || 0;\n    shape.strokeWidth = shape.strokeWidth || 0;\n    shape.strokeColor = shape.strokeColor || [0, 0, 0];\n    return shapeFormatFill(shape);\n};\nconst shapeFormatTriangle = (shape) => {\n    shape.strokeWidth = shape.strokeWidth || 0;\n    shape.strokeColor = shape.strokeColor || [0, 0, 0];\n    shapeFormatFill(shape);\n    return shapeDeleteRelativeProps(shape);\n};\nconst shapeFormatEllipse = (shape) => {\n    shape.strokeWidth = shape.strokeWidth || 0;\n    shape.strokeColor = shape.strokeColor || [0, 0, 0];\n    return shapeFormatFill(shape);\n};\nconst shapeFormatPath = (shape) => {\n    shapeFormatStroke(shape);\n    shapeDeleteTransformProps(shape);\n    return shapeDeleteRelativeProps(shape);\n};\nconst shapeFormatLine = (shape) => {\n    shapeFormatStroke(shape);\n    shape.lineStart = shape.lineStart || undefined;\n    shape.lineEnd = shape.lineEnd || undefined;\n    shapeDeleteTransformProps(shape);\n    return shapeDeleteRelativeProps(shape);\n};\nconst shapeFormatDefaults = (shape) => {\n    if (!isString(shape.id))\n        shape.id = getUniqueId();\n    if (!hasProp(shape, 'rotation'))\n        shape.rotation = 0;\n    if (!hasProp(shape, 'opacity'))\n        shape.opacity = 1;\n    if (!hasProp(shape, 'disableErase'))\n        shape.disableErase = true;\n};\nconst shapeFormat = (shape) => {\n    shapeFormatDefaults(shape);\n    if (shapeIsText(shape)) {\n        shapeFormatText(shape);\n    }\n    else if (shapeIsRect(shape)) {\n        shapeFormatRect(shape);\n    }\n    else if (shapeIsPath(shape)) {\n        shapeFormatPath(shape);\n    }\n    else if (shapeIsLine(shape)) {\n        shapeFormatLine(shape);\n    }\n    else if (shapeIsEllipse(shape)) {\n        shapeFormatEllipse(shape);\n    }\n    else if (shapeIsTriangle(shape)) {\n        shapeFormatTriangle(shape);\n    }\n    shapeLoadResources(shape);\n    return shape;\n};\nconst shapeGetDescription = (shape) => {\n    if (shapeIsText(shape)) {\n        return 'text';\n    }\n    else if (shapeIsRect(shape)) {\n        return 'rectangle';\n    }\n    else if (shapeIsPath(shape)) {\n        return 'path';\n    }\n    else if (shapeIsLine(shape)) {\n        return 'line';\n    }\n    else if (shapeIsEllipse(shape)) {\n        return 'ellipse';\n    }\n    else if (shapeIsTriangle(shape)) {\n        return 'triangle';\n    }\n    return;\n};\n//#endregion\nconst toPixelValue = (percentage, total) => (parseFloat(percentage) / 100) * total;\n//#region shape transforming\nconst shapeComputeValue = (shape, prop, { width, height }) => {\n    if (!hasProp(shape, prop))\n        return;\n    let value = shape[prop];\n    if (/points/.test(prop)) {\n        const arr = shape[prop];\n        if (!isString(arr[0].x))\n            return;\n        shape[prop] = arr.map((p) => vectorCreate(toPixelValue(p.x, width), toPixelValue(p.y, height)));\n    }\n    else if (isString(value)) {\n        const f = parseFloat(value) / 100;\n        if (/^x|left|width|rx|fontSize|cornerRadius|strokeWidth/.test(prop))\n            shape[prop] = width * f;\n        else if (/^right/.test(prop))\n            shape[prop] = width - width * f;\n        else if (/^y|top|height|ry/.test(prop))\n            shape[prop] = height * f;\n        else if (/^bottom/.test(prop))\n            shape[prop] = height - height * f;\n    }\n};\nconst displayProps = [\n    'width',\n    'height',\n    'left',\n    'top',\n    'right',\n    'bottom',\n    'x',\n    'y',\n    'rx',\n    'ry',\n    'points',\n    'fontSize',\n    'strokeWidth',\n    'lineHeight',\n    'x1',\n    'y1',\n    'x2',\n    'y2',\n    'x3',\n    'y3',\n];\nconst shapeComputeDisplay = (shape, parentRect) => {\n    displayProps.forEach((prop) => shapeComputeValue(shape, prop, parentRect));\n    shapeComputeRect(shape, parentRect);\n    return shape;\n};\nconst shapeGetPropPixelTotal = (prop, parentRect) => {\n    let total;\n    if (/^x|width|rx|fontSize|strokeWidth|cornerRadius/.test(prop)) {\n        total = parentRect.width;\n    }\n    else if (/^y|height|ry/.test(prop)) {\n        total = parentRect.height;\n    }\n    return total;\n};\nconst shapeUpdateProp = (shape, prop, value, parentRect) => {\n    if (!isString(shape[prop]))\n        return (shape[prop] = value);\n    let total = shapeGetPropPixelTotal(prop, parentRect);\n    shape[prop] = toPercentage(value, total);\n    return shape;\n};\nconst shapeGetPropPixelValue = (shape, prop, parentRect) => {\n    if (!isString(shape[prop]))\n        return shape[prop];\n    return toPixelValue(shape[prop], shapeGetPropPixelTotal(prop, parentRect));\n};\nconst shapeGetPropsPixelValues = (shape, props, parentRect) => {\n    return props.reduce((prev, prop) => {\n        const value = shapeGetPropPixelValue(shape, prop, parentRect);\n        prev[prop] = value;\n        return prev;\n    }, {});\n};\nconst shapeUpdateProps = (shape, props, parentRect) => {\n    Object.keys(props).forEach((key) => shapeUpdateProp(shape, key, props[key], parentRect));\n    return shape;\n};\nconst shapeComputeRect = (shape, parentRect) => {\n    if (hasProp(shape, 'left'))\n        shape.x = shape.left;\n    if (hasProp(shape, 'right')) {\n        const r = parentRect.width - shape.right;\n        if (hasProp(shape, 'left')) {\n            shape.x = shape.left;\n            shape.width = Math.max(0, r - shape.left);\n        }\n        else if (hasProp(shape, 'width')) {\n            shape.x = r - shape.width;\n        }\n    }\n    if (hasProp(shape, 'top'))\n        shape.y = shape.top;\n    if (hasProp(shape, 'bottom')) {\n        const b = parentRect.height - shape.bottom;\n        if (hasProp(shape, 'top')) {\n            shape.y = shape.top;\n            shape.height = Math.max(0, b - shape.top);\n        }\n        else if (hasProp(shape, 'height')) {\n            shape.y = b - shape.height;\n        }\n    }\n    return shape;\n};\nconst shapeComputeTransform = (shape, translate, scale) => {\n    if (shapeIsPath(shape)) {\n        shape.points\n            .filter((point) => isNumber(point.x))\n            .forEach((point) => {\n            point.x *= scale;\n            point.y *= scale;\n            point.x += translate.x;\n            point.y += translate.y;\n        });\n    }\n    if (shapeIsTriangle(shape) && isNumber(shape.x1)) {\n        shape.x1 *= scale;\n        shape.y1 *= scale;\n        shape.x2 *= scale;\n        shape.y2 *= scale;\n        shape.x3 *= scale;\n        shape.y3 *= scale;\n        shape.x1 += translate.x;\n        shape.y1 += translate.y;\n        shape.x2 += translate.x;\n        shape.y2 += translate.y;\n        shape.x3 += translate.x;\n        shape.y3 += translate.y;\n    }\n    if (shapeIsLine(shape) && isNumber(shape.x1)) {\n        shape.x1 *= scale;\n        shape.y1 *= scale;\n        shape.x2 *= scale;\n        shape.y2 *= scale;\n        shape.x1 += translate.x;\n        shape.y1 += translate.y;\n        shape.x2 += translate.x;\n        shape.y2 += translate.y;\n    }\n    if (isNumber(shape.x) && isNumber(shape.y)) {\n        shape.x *= scale;\n        shape.y *= scale;\n        shape.x += translate.x;\n        shape.y += translate.y;\n    }\n    if (isNumber(shape.width) && isNumber(shape.height)) {\n        shape.width *= scale;\n        shape.height *= scale;\n    }\n    if (isNumber(shape.rx) && isNumber(shape.ry)) {\n        shape.rx *= scale;\n        shape.ry *= scale;\n    }\n    if (shapeHasNumericStroke(shape)) {\n        shape.strokeWidth *= scale;\n    }\n    if (shapeIsText(shape) && isNumber(shape.fontSize)) {\n        shape.fontSize *= scale;\n        if (isNumber(shape.width))\n            shape.width *= scale;\n    }\n    if (hasProp(shape, 'cornerRadius') && isNumber(shape.cornerRadius)) {\n        shape.cornerRadius *= scale;\n    }\n    return shape;\n};\nconst shapeGetCenter = (shape) => {\n    if (shapeIsRect(shape)) {\n        return vectorCreate(shape.x + shape.width * 0.5, shape.y + shape.height * 0.5);\n    }\n    if (shapeIsEllipse(shape)) {\n        return vectorCreate(shape.x, shape.y);\n    }\n    if (shapeIsTextBox(shape)) {\n        const height = shape.height || textSize(shape.text, shape).height;\n        return vectorCreate(shape.x + shape.width * 0.5, shape.y + height * 0.5);\n    }\n    if (shapeIsTextLine(shape)) {\n        const size = textSize(shape.text, shape);\n        return vectorCreate(shape.x + size.width * 0.5, shape.y + size.height * 0.5);\n    }\n    if (shapeIsPath(shape)) {\n        return vectorCenter(shape.points);\n    }\n    if (shapeIsLine(shape)) {\n        return vectorCenter([\n            shapeLineGetStartPoint(shape),\n            shapeLineGetEndPoint(shape),\n        ]);\n    }\n    return undefined;\n};\nconst shapeComputeLineEnd = (position, strokeWidth, color, style, direction) => {\n    let shape = {};\n    const isSolid = /solid/.test(style);\n    const scaledSize = 5 * strokeWidth;\n    const s = isSolid ? scaledSize : scaledSize - 1;\n    const sh = isSolid ? s * 0.5 : Math.ceil(s * 0.5);\n    const normal = vectorNormalize(direction);\n    const offset = vectorMultiply(vectorClone(normal), sh);\n    const anchor = vectorClone(position);\n    const positionUpdated = vectorClone(position);\n    if (/arrow/.test(style)) {\n        let x = position.x;\n        let y = position.y;\n        const tipOffset = vectorMultiply(vectorClone(normal), scaledSize);\n        const inset = vectorCreate(x + tipOffset.x, y + tipOffset.y);\n        vectorMultiply(tipOffset, 0.55);\n        if (isSolid) {\n            const arrowOffset = vectorMultiply(vectorClone(normal), sh * 0.5);\n            x -= arrowOffset.x;\n            y -= arrowOffset.y;\n            shape = {\n                points: [\n                    vectorCreate(x, y),\n                    vectorCreate(inset.x - tipOffset.y, inset.y + tipOffset.x),\n                    vectorCreate(inset.x + tipOffset.y, inset.y - tipOffset.x),\n                ],\n                backgroundColor: color,\n            };\n            // move back so arrow triangle overlaps with end of line (otherwise line sticks out of triangle tip)\n            positionUpdated.x += offset.x;\n            positionUpdated.y += offset.y;\n        }\n        else {\n            // this prevents trouble with sharp line rendering in webgl\n            const p = vectorMultiply(vectorPerpendicular(vectorClone(normal)), 0.5);\n            const tipLeft = vectorCreate(x - p.x, y - p.y);\n            const tipRight = vectorCreate(x + p.x, y + p.y);\n            shape = {\n                points: [\n                    vectorCreate(inset.x + tipOffset.y, inset.y - tipOffset.x),\n                    tipLeft,\n                    vectorCreate(x, y),\n                    tipRight,\n                    vectorCreate(inset.x - tipOffset.y, inset.y + tipOffset.x),\n                ],\n                strokeWidth: strokeWidth,\n                strokeColor: color,\n            };\n        }\n    }\n    else if (/circle/.test(style)) {\n        // adjust line point offset\n        positionUpdated.x += offset.x;\n        positionUpdated.y += offset.y;\n        // add line cap\n        shape = {\n            x: anchor.x,\n            y: anchor.y,\n            rx: sh,\n            ry: sh,\n            backgroundColor: isSolid ? color : undefined,\n            strokeWidth: isSolid ? undefined : strokeWidth,\n            strokeColor: isSolid ? undefined : color,\n        };\n    }\n    else if (/square/.test(style)) {\n        // adjust line point offset\n        positionUpdated.x += offset.x;\n        positionUpdated.y += offset.y;\n        shape = {\n            x: anchor.x - sh,\n            y: anchor.y - sh,\n            width: sh * 2,\n            height: sh * 2,\n            rotation: vectorAngle(normal),\n            backgroundColor: isSolid ? color : undefined,\n            strokeWidth: isSolid ? undefined : strokeWidth,\n            strokeColor: isSolid ? undefined : color,\n        };\n    }\n    else if (style === 'bar') {\n        shape = {\n            points: [\n                vectorCreate(anchor.x - offset.y, anchor.y + offset.x),\n                vectorCreate(anchor.x + offset.y, anchor.y - offset.x),\n            ],\n            strokeWidth: strokeWidth,\n            strokeColor: color,\n        };\n    }\n    return {\n        position: positionUpdated,\n        shape,\n    };\n};\n//#endregion\n\nvar ctxRoundRect = (ctx, x, y, width, height, radius) => {\n    if (width < 2 * radius)\n        radius = width / 2;\n    if (height < 2 * radius)\n        radius = height / 2;\n    ctx.beginPath();\n    ctx.moveTo(x + radius, y);\n    ctx.arcTo(x + width, y, x + width, y + height, radius);\n    ctx.arcTo(x + width, y + height, x, y + height, radius);\n    ctx.arcTo(x, y + height, x, y, radius);\n    ctx.arcTo(x, y, x + width, y, radius);\n    ctx.closePath();\n    return ctx;\n};\n\nconst defineRectShape = (ctx, shape) => {\n    shape.cornerRadius > 0\n        ? ctxRoundRect(ctx, shape.x, shape.y, shape.width, shape.height, shape.cornerRadius)\n        : ctx.rect(shape.x, shape.y, shape.width, shape.height);\n    return ctx;\n};\nconst fillRectShape = (ctx, shape) => {\n    shape.backgroundColor && ctx.fill();\n    return ctx;\n};\nconst strokeRectShape = (ctx, shape) => {\n    shape.strokeWidth && ctx.stroke();\n    return ctx;\n};\nvar drawRect = async (ctx, shape) => new Promise((resolve, reject) => {\n    ctx.lineWidth = shape.strokeWidth ? shape.strokeWidth : 1; // 1 is default value for lineWidth prop\n    ctx.strokeStyle = shape.strokeColor ? colorArrayToRGBA(shape.strokeColor) : 'none';\n    ctx.fillStyle = shape.backgroundColor ? colorArrayToRGBA(shape.backgroundColor) : 'none';\n    ctx.globalAlpha = shape.opacity;\n    if (shape.backgroundImage) {\n        shapeLoadResources(shape, (error, shape) => {\n            if (error)\n                return reject(error);\n            let sX = 0;\n            let sY = 0;\n            let sWidth = shape.backgroundImageElement.naturalWidth;\n            let sHeight = shape.backgroundImageElement.naturalHeight;\n            let dX = shape.x;\n            let dY = shape.y;\n            let dWidth = shape.width;\n            let dHeight = shape.height;\n            if (shape.backgroundSize === 'contain') {\n                const rect = rectContainRect(shape, sWidth / sHeight);\n                dWidth = rect.width;\n                dHeight = rect.height;\n                dX += rect.x;\n                dY += rect.y;\n            }\n            else if (shape.backgroundSize === 'cover') {\n                const rect = rectContainRect(rectCreate(0, 0, sWidth, sHeight), dWidth / dHeight);\n                sWidth = rect.width;\n                sHeight = rect.height;\n                sX = rect.x;\n                sY = rect.y;\n            }\n            defineRectShape(ctx, shape);\n            fillRectShape(ctx, shape);\n            ctx.save();\n            ctx.clip();\n            ctx.drawImage(shape.backgroundImageElement, sX, sY, sWidth, sHeight, dX, dY, dWidth, dHeight);\n            ctx.restore();\n            strokeRectShape(ctx, shape);\n            resolve([]);\n        });\n    }\n    else {\n        defineRectShape(ctx, shape);\n        fillRectShape(ctx, shape);\n        strokeRectShape(ctx, shape);\n        resolve([]);\n    }\n});\n\nvar drawEllipse = async (ctx, shape) => new Promise((resolve, reject) => {\n    ctx.lineWidth = shape.strokeWidth || 1; // 1 is default value for lineWidth prop\n    ctx.strokeStyle = shape.strokeColor ? colorArrayToRGBA(shape.strokeColor) : 'none';\n    ctx.fillStyle = shape.backgroundColor ? colorArrayToRGBA(shape.backgroundColor) : 'none';\n    ctx.globalAlpha = shape.opacity;\n    ctx.ellipse(shape.x, shape.y, shape.rx, shape.ry, 0, 0, Math.PI * 2);\n    shape.backgroundColor && ctx.fill();\n    if (shape.backgroundImage) {\n        shapeLoadResources(shape, (error, image) => {\n            if (error)\n                return reject(error);\n            ctx.drawImage(image.backgroundImageElement, shape.x, shape.y, shape.width, shape.height);\n            shape.strokeWidth && ctx.stroke();\n            resolve([]);\n        });\n    }\n    else {\n        shape.strokeWidth && ctx.stroke();\n    }\n    resolve([]);\n});\n\nvar drawText$1 = async (ctx, shape) => {\n    const size = shape.width && shape.height\n        ? sizeCreateFromAny(shape)\n        : textSize(shape.text, shape);\n    const rect = {\n        x: shape.x,\n        y: shape.y,\n        width: shape.width || size.width,\n        height: size.height,\n    };\n    drawRect(ctx, {\n        ...shape,\n        ...rect,\n    });\n    updateTextContext(ctx, shape);\n    let tx = 0;\n    if (shape.textAlign == 'center') {\n        tx = -textPadding * 0.5;\n    }\n    else if (shape.textAlign === 'right') {\n        tx = -textPadding;\n    }\n    ctx.rect(shape.x + tx, shape.y, shape.width + textPadding * 2, shape.height);\n    ctx.save();\n    ctx.clip();\n    drawText(ctx, shape.width ? wrapText(ctx, shape.text, shape.width) : shape.text, {\n        x: shape.x,\n        y: shape.y,\n        fontSize: shape.fontSize,\n        textAlign: shape.textAlign,\n        lineHeight: shape.lineHeight,\n        lineWidth: shape.width,\n    });\n    ctx.restore();\n    return [];\n};\n\nvar drawLine = async (ctx, shape) => new Promise(async (resolve, reject) => {\n    ctx.lineWidth = shape.strokeWidth || 1; // 1 is default value for lineWidth prop\n    ctx.strokeStyle = shape.strokeColor ? colorArrayToRGBA(shape.strokeColor) : 'none';\n    ctx.globalAlpha = shape.opacity;\n    let lineStartPosition = shapeLineGetStartPoint(shape);\n    let lineEndPosition = shapeLineGetEndPoint(shape);\n    const lineStartDescription = shape.lineStart &&\n        shapeComputeLineEnd(lineStartPosition, shape.strokeWidth, shape.strokeColor, shape.lineStart, vectorCreate(lineEndPosition.x - lineStartPosition.x, lineEndPosition.y - lineStartPosition.y));\n    const lineEndDescription = shape.lineEnd &&\n        shapeComputeLineEnd(lineEndPosition, shape.strokeWidth, shape.strokeColor, shape.lineEnd, vectorCreate(lineStartPosition.x - lineEndPosition.x, lineStartPosition.y - lineEndPosition.y));\n    // update start and end position of line if required to draw caps\n    lineStartPosition = lineStartDescription\n        ? lineStartDescription.position\n        : lineStartPosition;\n    lineEndPosition = lineEndDescription ? lineEndDescription.position : lineEndPosition;\n    // draw line\n    ctx.moveTo(lineStartPosition.x, lineStartPosition.y);\n    ctx.lineTo(lineEndPosition.x, lineEndPosition.y);\n    shape.strokeWidth && ctx.stroke();\n    // draw other shapes\n    resolve([\n        lineStartDescription && lineStartDescription.shape,\n        lineEndDescription && lineEndDescription.shape,\n    ].filter(Boolean));\n});\n\nvar drawPath = async (ctx, shape) => new Promise((resolve, reject) => {\n    ctx.lineWidth = shape.strokeWidth || 1; // 1 is default value for lineWidth prop\n    ctx.strokeStyle = shape.strokeColor ? colorArrayToRGBA(shape.strokeColor) : 'none';\n    ctx.fillStyle = shape.backgroundColor ? colorArrayToRGBA(shape.backgroundColor) : 'none';\n    ctx.globalAlpha = shape.opacity;\n    // draw line\n    const { points } = shape;\n    ctx.moveTo(points[0].x, points[0].y);\n    const l = points.length;\n    for (let i = 1; i < l; i++) {\n        ctx.lineTo(points[i].x, points[i].y);\n    }\n    shape.strokeWidth && ctx.stroke();\n    shape.backgroundColor && ctx.fill();\n    resolve([]);\n});\n\nvar ctxFlip = (ctx, flipX, flipY, pivot) => {\n    if (!flipX && !flipY)\n        return ctx;\n    ctx.translate(pivot.x, pivot.y);\n    ctx.scale(flipX ? -1 : 1, flipY ? -1 : 1);\n    ctx.translate(-pivot.x, -pivot.y);\n    return ctx;\n};\n\nconst drawShape = async (ctx, shape) => {\n    // center, needed for transforms\n    const center = shapeGetCenter(shape);\n    // rotate context\n    ctxRotate(ctx, shape.rotation, center);\n    // flip context\n    ctxFlip(ctx, shape.flipX, shape.flipY, center);\n    let fn;\n    if (shapeIsRect(shape)) {\n        fn = drawRect;\n    }\n    else if (shapeIsEllipse(shape)) {\n        fn = drawEllipse;\n    }\n    else if (shapeIsLine(shape)) {\n        fn = drawLine;\n    }\n    else if (shapeIsPath(shape)) {\n        fn = drawPath;\n    }\n    else if (shapeIsText(shape)) {\n        fn = drawText$1;\n    }\n    // get shapes\n    return [shape, ...(await drawShapes(ctx, await fn(ctx, shape)))];\n};\n\nvar drawShapes = async (ctx, shapes) => {\n    let drawnShapes = [];\n    for (const shape of shapes) {\n        ctx.save();\n        // clears previous shape's path\n        ctx.beginPath();\n        // wait for shape to draw before drawing next shape\n        drawnShapes = [...drawnShapes, ...(await drawShape(ctx, shape))];\n        ctx.restore();\n    }\n    return drawnShapes;\n};\n\nvar drawImageData = async (imageData, options = {}) => {\n    const { shapes = [], context = imageData, transform = noop } = options;\n    // no shapes to draw\n    if (!shapes.length)\n        return imageData;\n    // output\n    let imageDataOut;\n    // create drawing context\n    const canvas = h('canvas');\n    canvas.width = imageData.width;\n    canvas.height = imageData.height;\n    const ctx = canvas.getContext('2d');\n    ctx.putImageData(imageData, 0, 0);\n    // compute the position of all shapes\n    const computedShapes = shapes.map(shapeDeepCopy).map((shape) => shapeComputeDisplay(shape, {\n        x: 0,\n        y: 0,\n        width: context.width,\n        height: context.height,\n    }));\n    // compute transforms for all shapes\n    transform(ctx);\n    // draw shapes to canvas\n    await drawShapes(ctx, computedShapes);\n    imageDataOut = ctx.getImageData(0, 0, canvas.width, canvas.height);\n    releaseCanvas(canvas);\n    return imageDataOut;\n};\n\nvar fillImageData = async (imageData, options = {}) => {\n    const { backgroundColor } = options;\n    // no background color set or is fully transparent background color\n    if (!backgroundColor || (backgroundColor && backgroundColor[3] === 0))\n        return imageData;\n    // fill\n    let imageDataOut;\n    let image = h('canvas');\n    image.width = imageData.width;\n    image.height = imageData.height;\n    const ctx = image.getContext('2d');\n    ctx.putImageData(imageData, 0, 0);\n    // fill behind image\n    ctx.globalCompositeOperation = 'destination-over';\n    ctx.fillStyle = colorArrayToRGBA(backgroundColor);\n    ctx.fillRect(0, 0, image.width, image.height);\n    imageDataOut = ctx.getImageData(0, 0, image.width, image.height);\n    releaseCanvas(image);\n    return imageDataOut;\n};\n\nvar dotColorMatrix = (a, b) => {\n    const res = new Array(20);\n    // R\n    res[0] = a[0] * b[0] + a[1] * b[5] + a[2] * b[10] + a[3] * b[15];\n    res[1] = a[0] * b[1] + a[1] * b[6] + a[2] * b[11] + a[3] * b[16];\n    res[2] = a[0] * b[2] + a[1] * b[7] + a[2] * b[12] + a[3] * b[17];\n    res[3] = a[0] * b[3] + a[1] * b[8] + a[2] * b[13] + a[3] * b[18];\n    res[4] = a[0] * b[4] + a[1] * b[9] + a[2] * b[14] + a[3] * b[19] + a[4];\n    // G\n    res[5] = a[5] * b[0] + a[6] * b[5] + a[7] * b[10] + a[8] * b[15];\n    res[6] = a[5] * b[1] + a[6] * b[6] + a[7] * b[11] + a[8] * b[16];\n    res[7] = a[5] * b[2] + a[6] * b[7] + a[7] * b[12] + a[8] * b[17];\n    res[8] = a[5] * b[3] + a[6] * b[8] + a[7] * b[13] + a[8] * b[18];\n    res[9] = a[5] * b[4] + a[6] * b[9] + a[7] * b[14] + a[8] * b[19] + a[9];\n    // B\n    res[10] = a[10] * b[0] + a[11] * b[5] + a[12] * b[10] + a[13] * b[15];\n    res[11] = a[10] * b[1] + a[11] * b[6] + a[12] * b[11] + a[13] * b[16];\n    res[12] = a[10] * b[2] + a[11] * b[7] + a[12] * b[12] + a[13] * b[17];\n    res[13] = a[10] * b[3] + a[11] * b[8] + a[12] * b[13] + a[13] * b[18];\n    res[14] = a[10] * b[4] + a[11] * b[9] + a[12] * b[14] + a[13] * b[19] + a[14];\n    // A\n    res[15] = a[15] * b[0] + a[16] * b[5] + a[17] * b[10] + a[18] * b[15];\n    res[16] = a[15] * b[1] + a[16] * b[6] + a[17] * b[11] + a[18] * b[16];\n    res[17] = a[15] * b[2] + a[16] * b[7] + a[17] * b[12] + a[18] * b[17];\n    res[18] = a[15] * b[3] + a[16] * b[8] + a[17] * b[13] + a[18] * b[18];\n    res[19] = a[15] * b[4] + a[16] * b[9] + a[17] * b[14] + a[18] * b[19] + a[19];\n    return res;\n};\n\nvar getColorMatrixFromColorMatrices = (colorMatrices) => colorMatrices.length\n    ? colorMatrices.reduce((previous, current) => dotColorMatrix([...previous], current), colorMatrices.shift())\n    : [];\n\n// connect function in process chain\nconst connect = (fn, getter = (...args) => args, setter) => async (state, options, onprogress) => {\n    // will hold function result\n    let res;\n    // at this point we don't know if the length of this task can be computed\n    onprogress(createProgressEvent(0, false));\n    // try to run the function\n    let progressUpdated = false;\n    try {\n        res = await fn(...getter(state, options, (event) => {\n            progressUpdated = true;\n            onprogress(event);\n        }));\n    }\n    catch (err) {\n        throw err;\n    }\n    // a setter isn't required\n    setter && setter(state, res);\n    // if progress was updated, we expect the connected function to fire the 1/1 event, else we fire it here\n    if (!progressUpdated)\n        onprogress(createProgressEvent(1, false));\n    return state;\n};\n//\n// Reader/Writer Presets\n//\nconst AnyToFile = ({ srcProp = 'src', destProp = 'dest' } = {}) => [\n    connect(srcToFile, (state, options, onprogress) => [state[srcProp], onprogress], (state, file) => (state[destProp] = file)),\n    'any-to-file',\n];\nconst BlobReadImageSize = ({ srcProp = 'src', destProp = 'size' } = {}) => [\n    connect(getImageSize, (state, options) => [state[srcProp]], (state, size) => (state[destProp] = size)),\n    'read-image-size',\n];\nconst ImageSizeMatchOrientation = ({ srcSize = 'size', srcOrientation = 'orientation', destSize = 'size', } = {}) => [\n    connect(orientImageSize, (state) => [state[srcSize], state[srcOrientation]], (state, size) => (state[destSize] = size)),\n    'image-size-match-orientation',\n];\nconst BlobReadImageHead = ({ srcProp = 'src', destProp = 'head' } = {}) => [\n    connect((blob, slice) => (isJPEG(blob) ? blobReadSection(blob, slice) : undefined), \n    // 64 * 1024 should be enough bytes to find orientation header in next step\n    // Exif metadata are restricted in size to 64 kB in JPEG images because according to the specification this information must be contained within a single JPEG APP1 segment.\n    (state) => [state[srcProp], [0, 64 * 1024], onprogress], (state, head) => (state[destProp] = head)),\n    'read-image-head',\n];\nconst ImageHeadReadExifOrientationTag = ({ srcProp = 'head', destProp = 'orientation', } = {}) => [\n    connect(arrayBufferReadExifOrientationTag, (state) => [state[srcProp]], (state, orientation) => (state[destProp] = orientation)),\n    'read-exif-orientation-tag',\n];\nconst ImageHeadClearExifOrientationTag = ({ srcProp = 'head' } = {}) => [\n    connect(arrayBufferWriteExifOrientationTag, (state) => [state[srcProp], 1]),\n    'clear-exif-orientation-tag',\n];\nconst ApplyCanvasScalar = ({ srcImageSize = 'size', srcCanvasSize = 'imageData', srcImageState = 'imageState', destImageSize = 'size', destScalar = 'scalar', } = {}) => [\n    connect((naturalSize, canvasSize, imageState) => {\n        // calculate canvas scalar\n        const scalar = Math.min(canvasSize.width / naturalSize.width, canvasSize.height / naturalSize.height);\n        // done because not scaling\n        if (scalar !== 1) {\n            const { crop, annotation, decoration } = imageState;\n            // origin to scale to\n            const origin = vectorCreateEmpty();\n            // scale select.crop\n            if (crop)\n                imageState.crop = rectScale(crop, scalar, origin);\n            // scale annotation\n            const translate = vectorCreateEmpty();\n            imageState.annotation = annotation.map((shape) => shapeComputeTransform(shape, translate, scalar));\n            // scale decoration\n            imageState.decoration = decoration.map((shape) => shapeComputeTransform(shape, translate, scalar));\n        }\n        return [scalar, sizeCreateFromAny(canvasSize)];\n    }, (state) => [state[srcImageSize], state[srcCanvasSize], state[srcImageState]], (state, [scalar, imageSize]) => {\n        state[destScalar] = scalar;\n        state[destImageSize] = imageSize;\n    }),\n    'calculate-canvas-scalar',\n];\nconst BlobToImageData = ({ srcProp = 'src', destProp = 'imageData', canvasMemoryLimit = undefined, }) => [\n    connect(blobToImageData, (state) => [state[srcProp], canvasMemoryLimit], (state, imageData) => (state[destProp] = imageData)),\n    'blob-to-image-data',\n];\nconst ImageDataMatchOrientation = ({ srcImageData = 'imageData', srcOrientation = 'orientation', } = {}) => [\n    connect(orientImageData, (state) => [state[srcImageData], state[srcOrientation]], (state, imageData) => (state.imageData = imageData)),\n    'image-data-match-orientation',\n];\nconst ImageDataFill = ({ srcImageData = 'imageData', srcImageState = 'imageState', } = {}) => [\n    connect(fillImageData, (state) => [\n        state[srcImageData],\n        { backgroundColor: state[srcImageState].backgroundColor },\n    ], (state, imageData) => (state.imageData = imageData)),\n    'image-data-fill',\n];\nconst ImageDataCrop = ({ srcImageData = 'imageData', srcImageState = 'imageState', } = {}) => [\n    connect(cropImageData, (state) => [\n        state[srcImageData],\n        {\n            crop: state[srcImageState].crop,\n            rotation: state[srcImageState].rotation,\n            flipX: state[srcImageState].flipX,\n            flipY: state[srcImageState].flipY,\n        },\n    ], (state, imageData) => (state.imageData = imageData)),\n    'image-data-crop',\n];\nconst ImageDataResize = ({ resize = {\n    width: undefined,\n    height: undefined,\n    fit: undefined,\n    upscale: undefined,\n}, srcProp = 'imageData', srcImageState = 'imageState', destImageScaledSize = 'imageScaledSize', }) => [\n    connect(resizeImageData, (state) => [\n        state[srcProp],\n        {\n            width: Math.min(resize.width || Number.MAX_SAFE_INTEGER, (state[srcImageState].targetSize && state[srcImageState].targetSize.width) ||\n                Number.MAX_SAFE_INTEGER),\n            height: Math.min(resize.height || Number.MAX_SAFE_INTEGER, (state[srcImageState].targetSize && state[srcImageState].targetSize.height) ||\n                Number.MAX_SAFE_INTEGER),\n            fit: resize.fit || 'contain',\n            upscale: resize.upscale || false,\n        },\n    ], (state, imageData) => {\n        if (!sizeEqual(state.imageData, imageData))\n            state[destImageScaledSize] = sizeCreateFromAny(imageData);\n        state.imageData = imageData;\n    }),\n    'image-data-resize',\n];\nconst ImageDataFilter = ({ srcImageData = 'imageData', srcImageState = 'imageState', destImageData = 'imageData', } = {}) => [\n    connect(filterImageData, (state) => {\n        const { colorMatrix } = state[srcImageState];\n        const colorMatrices = colorMatrix &&\n            Object.keys(colorMatrix)\n                .map((name) => colorMatrix[name])\n                .filter(Boolean);\n        return [\n            state[srcImageData],\n            {\n                colorMatrix: colorMatrices && getColorMatrixFromColorMatrices(colorMatrices),\n                convolutionMatrix: state[srcImageState].convolutionMatrix,\n                gamma: state[srcImageState].gamma,\n                noise: state[srcImageState].noise,\n                vignette: state[srcImageState].vignette,\n            },\n        ];\n    }, (state, imageData) => (state[destImageData] = imageData)),\n    'image-data-filter',\n];\nconst ImageDataAnnotate = ({ srcImageData = 'imageData', srcSize = 'size', srcImageState = 'imageState', destImageData = 'imageData', destImageScaledSize = 'imageScaledSize', } = {}) => [\n    connect(drawImageData, (state) => [\n        state[srcImageData],\n        {\n            shapes: state[srcImageState].annotation,\n            context: state[srcSize],\n            transform: (ctx) => {\n                const imageSize = state[srcSize];\n                const { crop = rectCreateFromSize(imageSize), rotation = 0, flipX, flipY, } = state[srcImageState];\n                const rotatedRect = getImageTransformedRect(imageSize, rotation);\n                const rotatedSize = {\n                    width: rotatedRect.width,\n                    height: rotatedRect.height,\n                };\n                // calculate image scalar so we can scale annotations accordingly\n                const scaledSize = state[destImageScaledSize];\n                const scalar = scaledSize\n                    ? Math.min(scaledSize.width / crop.width, scaledSize.height / crop.height)\n                    : 1;\n                // calculate center\n                const dx = imageSize.width * 0.5 - rotatedSize.width * 0.5;\n                const dy = imageSize.height * 0.5 - rotatedSize.height * 0.5;\n                const center = sizeCenter(imageSize);\n                // image scalar\n                ctx.scale(scalar, scalar);\n                // offset\n                ctx.translate(-dx, -dy);\n                ctx.translate(-crop.x, -crop.y);\n                // rotation\n                ctx.translate(center.x, center.y);\n                ctx.rotate(rotation);\n                ctx.translate(-center.x, -center.y);\n                // flipping\n                ctx.scale(flipX ? -1 : 1, flipY ? -1 : 1);\n                ctx.translate(flipX ? -imageSize.width : 0, flipY ? -imageSize.height : 0);\n                // annotations are clipped clip to image\n                ctx.rect(0, 0, imageSize.width, imageSize.height);\n                ctx.clip();\n            },\n        },\n    ], (state, imageData) => (state[destImageData] = imageData)),\n    'image-data-annotate',\n];\nconst ImageDataDecorate = ({ srcImageData = 'imageData', srcImageState = 'imageState', destImageData = 'imageData', destImageScaledSize = 'imageScaledSize', } = {}) => [\n    connect(drawImageData, (state) => [\n        state[srcImageData],\n        {\n            shapes: state[srcImageState].decoration,\n            context: state[srcImageState].crop,\n            transform: (ctx) => {\n                // calculate image scalar so we can scale decoration accordingly\n                const { crop } = state.imageState;\n                const scaledSize = state[destImageScaledSize];\n                const scalar = scaledSize\n                    ? Math.min(scaledSize.width / crop.width, scaledSize.height / crop.height)\n                    : 1;\n                ctx.scale(scalar, scalar);\n            },\n        },\n    ], (state, imageData) => (state[destImageData] = imageData)),\n    'image-data-decorate',\n];\nconst ImageDataToBlob = ({ mimeType = undefined, quality = undefined, srcImageData = 'imageData', srcFile = 'src', destBlob = 'blob', } = {}) => [\n    connect(imageDataToBlob, (state) => [\n        state[srcImageData],\n        mimeType || getMimeTypeFromFilename(state[srcFile].name) || state[srcFile].type,\n        quality,\n    ], (state, blob) => (state[destBlob] = blob)),\n    'image-data-to-blob',\n];\nconst BlobWriteImageHead = (srcBlob = 'blob', srcHead = 'head', destBlob = 'blob') => [\n    connect((blob, head) => isJPEG(blob) && head\n        ? blobWriteSection(blob, arrayBufferReadImageHead(head), \n        // location and size of the JPEG header\n        [20])\n        : blob, (state) => [state[srcBlob], state[srcHead]], (state, blob) => (state[destBlob] = blob)),\n    'blob-write-image-head',\n];\nconst BlobToFile = ({ renameFile = undefined, srcBlob = 'blob', srcFile = 'src', destFile = 'dest', defaultFilename = undefined, } = {}) => [\n    connect(blobToFile, (state) => [\n        state[srcBlob],\n        renameFile\n            ? renameFile(state[srcFile])\n            : state[srcFile].name ||\n                `${defaultFilename}.${getExtensionFromMimeType(state[srcBlob].type)}`,\n    ], (state, file) => (state[destFile] = file)),\n    'blob-to-file',\n];\nconst Store = ({ url = './', dataset = (state) => [\n    ['dest', state.dest, state.dest.name],\n    ['imageState', state.imageState],\n], destStore = 'store', }) => [\n    connect(\n    // upload function\n    async (dataset, onprogress) => {\n        try {\n            return await post(url, dataset, { onprogress });\n        }\n        catch (err) {\n            throw err;\n        }\n    }, \n    // get state values\n    (state, options, onprogress) => [dataset(state), onprogress], \n    // set state values\n    (state, xhr) => (state[destStore] = xhr) // logs XHR request returned by `post`\n    ),\n    'store',\n];\nconst PropFilter = (allowlist) => [\n    connect((state) => {\n        // if no allowlist suppleid or is empty array we don't filter\n        if (!allowlist || !allowlist.length)\n            return state;\n        // else we only allow the props defined in the list and delete non matching props\n        Object.keys(state).forEach((key) => {\n            if (allowlist.includes(key))\n                return;\n            delete state[key];\n        });\n        return state;\n    }),\n    'prop-filter',\n];\n// Generic image reader, suitable for most use cases\nconst createDefaultImageReader = (options = {}) => {\n    const { orientImage = true, outputProps = ['src', 'dest', 'size'], preprocessImageFile, } = options;\n    return [\n        // can read most source files and turn them into blobs\n        AnyToFile(),\n        // TODO: test if supported mime/type\n        // called when file created, can be used to read unrecognized files\n        preprocessImageFile && [\n            connect(preprocessImageFile, (state, options, onprogress) => [\n                state.dest,\n                options,\n                onprogress,\n            ], (state, file) => (state.dest = file)),\n            'preprocess-image-file',\n        ],\n        // quickly read size (only reads first part of image)\n        BlobReadImageSize({ srcProp: 'dest' }),\n        // fix image orientation\n        orientImage && BlobReadImageHead({ srcProp: 'dest' }),\n        orientImage && ImageHeadReadExifOrientationTag(),\n        orientImage && ImageSizeMatchOrientation(),\n        // remove unwanted props\n        PropFilter(outputProps),\n    ].filter(Boolean);\n};\n// Generic image writer, suitable for most use cases\nconst createDefaultImageWriter = (options = {}) => {\n    const { canvasMemoryLimit = isIOS() ? 4096 * 4096 : Infinity, orientImage = true, copyImageHead = true, mimeType = undefined, quality = undefined, renameFile = undefined, targetSize = undefined, store = undefined, outputProps = ['src', 'dest', 'imageState', 'store'], preprocessImageState, postprocessImageData, } = options;\n    return [\n        // get orientation info (if is jpeg)\n        (orientImage || copyImageHead) && BlobReadImageHead(),\n        orientImage && ImageHeadReadExifOrientationTag(),\n        // get image size\n        BlobReadImageSize(),\n        // allow preproccesing of image state for example to replace placeholders\n        preprocessImageState && [\n            connect(preprocessImageState, (state, options, onprogress) => [\n                state.imageState,\n                options,\n                onprogress,\n            ], (state, imageState) => (state.imageState = imageState)),\n            'preprocess-image-state',\n        ],\n        // get image data\n        BlobToImageData({ canvasMemoryLimit }),\n        // get canvas scalar for when scaled down\n        ApplyCanvasScalar(),\n        // fix image orientation\n        orientImage && ImageSizeMatchOrientation(),\n        orientImage && ImageDataMatchOrientation(),\n        // apply image state\n        ImageDataCrop(),\n        ImageDataResize({ resize: targetSize }),\n        ImageDataFilter(),\n        ImageDataFill(),\n        ImageDataAnnotate(),\n        ImageDataDecorate(),\n        // run post processing on image data, for example to apply circular crop\n        postprocessImageData && [\n            connect(postprocessImageData, (state, options, onprogress) => [\n                state.imageData,\n                options,\n                onprogress,\n            ], (state, imageData) => (state.imageData = imageData)),\n            'postprocess-image-data',\n        ],\n        // convert to file\n        ImageDataToBlob({ mimeType, quality }),\n        // we overwite the exif orientation tag so the image is oriented correctly\n        orientImage && ImageHeadClearExifOrientationTag(),\n        // we write the new image head to the target blob\n        copyImageHead && BlobWriteImageHead(),\n        // turn the image blob into a file, will also rename the file\n        BlobToFile({ defaultFilename: 'image', renameFile }),\n        // upload or process data\n        store &&\n            (isString(store)\n                ? // a basic store to post to\n                    Store({ url: store })\n                : // see if is fully custom or store config\n                    isFunction(store)\n                        ? // fully custom store function\n                            [store, 'store']\n                        : // a store configuration object\n                            Store(store)),\n        // remove unwanted props\n        PropFilter(outputProps),\n    ].filter(Boolean);\n};\n\nfunction noop$1() { }\nconst identity = x => x;\nfunction assign(tar, src) {\n    // @ts-ignore\n    for (const k in src)\n        tar[k] = src[k];\n    return tar;\n}\nfunction run(fn) {\n    return fn();\n}\nfunction blank_object() {\n    return Object.create(null);\n}\nfunction run_all(fns) {\n    fns.forEach(run);\n}\nfunction is_function(thing) {\n    return typeof thing === 'function';\n}\nfunction safe_not_equal(a, b) {\n    return a != a ? b == b : a !== b || ((a && typeof a === 'object') || typeof a === 'function');\n}\nfunction is_empty(obj) {\n    return Object.keys(obj).length === 0;\n}\nfunction subscribe(store, ...callbacks) {\n    if (store == null) {\n        return noop$1;\n    }\n    const unsub = store.subscribe(...callbacks);\n    return unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\nfunction get_store_value(store) {\n    let value;\n    subscribe(store, _ => value = _)();\n    return value;\n}\nfunction component_subscribe(component, store, callback) {\n    component.$$.on_destroy.push(subscribe(store, callback));\n}\nfunction create_slot(definition, ctx, $$scope, fn) {\n    if (definition) {\n        const slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n        return definition[0](slot_ctx);\n    }\n}\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n    return definition[1] && fn\n        ? assign($$scope.ctx.slice(), definition[1](fn(ctx)))\n        : $$scope.ctx;\n}\nfunction get_slot_changes(definition, $$scope, dirty, fn) {\n    if (definition[2] && fn) {\n        const lets = definition[2](fn(dirty));\n        if ($$scope.dirty === undefined) {\n            return lets;\n        }\n        if (typeof lets === 'object') {\n            const merged = [];\n            const len = Math.max($$scope.dirty.length, lets.length);\n            for (let i = 0; i < len; i += 1) {\n                merged[i] = $$scope.dirty[i] | lets[i];\n            }\n            return merged;\n        }\n        return $$scope.dirty | lets;\n    }\n    return $$scope.dirty;\n}\nfunction update_slot(slot, slot_definition, ctx, $$scope, dirty, get_slot_changes_fn, get_slot_context_fn) {\n    const slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n    if (slot_changes) {\n        const slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n        slot.p(slot_context, slot_changes);\n    }\n}\nfunction exclude_internal_props(props) {\n    const result = {};\n    for (const k in props)\n        if (k[0] !== '$')\n            result[k] = props[k];\n    return result;\n}\nfunction set_store_value(store, ret, value = ret) {\n    store.set(value);\n    return ret;\n}\nfunction action_destroyer(action_result) {\n    return action_result && is_function(action_result.destroy) ? action_result.destroy : noop$1;\n}\n\nconst is_client = typeof window !== 'undefined';\nlet now = is_client\n    ? () => window.performance.now()\n    : () => Date.now();\nlet raf = is_client ? cb => requestAnimationFrame(cb) : noop$1;\n\nconst tasks = new Set();\nfunction run_tasks(now) {\n    tasks.forEach(task => {\n        if (!task.c(now)) {\n            tasks.delete(task);\n            task.f();\n        }\n    });\n    if (tasks.size !== 0)\n        raf(run_tasks);\n}\n/**\n * Creates a new task that runs on each raf frame\n * until it returns a falsy value or is aborted\n */\nfunction loop(callback) {\n    let task;\n    if (tasks.size === 0)\n        raf(run_tasks);\n    return {\n        promise: new Promise(fulfill => {\n            tasks.add(task = { c: callback, f: fulfill });\n        }),\n        abort() {\n            tasks.delete(task);\n        }\n    };\n}\n\nfunction append(target, node) {\n    target.appendChild(node);\n}\nfunction insert(target, node, anchor) {\n    target.insertBefore(node, anchor || null);\n}\nfunction detach(node) {\n    node.parentNode.removeChild(node);\n}\nfunction element(name) {\n    return document.createElement(name);\n}\nfunction svg_element(name) {\n    return document.createElementNS('http://www.w3.org/2000/svg', name);\n}\nfunction text(data) {\n    return document.createTextNode(data);\n}\nfunction space() {\n    return text(' ');\n}\nfunction empty() {\n    return text('');\n}\nfunction listen(node, event, handler, options) {\n    node.addEventListener(event, handler, options);\n    return () => node.removeEventListener(event, handler, options);\n}\nfunction prevent_default(fn) {\n    return function (event) {\n        event.preventDefault();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction stop_propagation(fn) {\n    return function (event) {\n        event.stopPropagation();\n        // @ts-ignore\n        return fn.call(this, event);\n    };\n}\nfunction attr(node, attribute, value) {\n    if (value == null)\n        node.removeAttribute(attribute);\n    else if (node.getAttribute(attribute) !== value)\n        node.setAttribute(attribute, value);\n}\nfunction set_attributes(node, attributes) {\n    // @ts-ignore\n    const descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n    for (const key in attributes) {\n        if (attributes[key] == null) {\n            node.removeAttribute(key);\n        }\n        else if (key === 'style') {\n            node.style.cssText = attributes[key];\n        }\n        else if (key === '__value') {\n            node.value = node[key] = attributes[key];\n        }\n        else if (descriptors[key] && descriptors[key].set) {\n            node[key] = attributes[key];\n        }\n        else {\n            attr(node, key, attributes[key]);\n        }\n    }\n}\nfunction children(element) {\n    return Array.from(element.childNodes);\n}\nfunction set_data(text, data) {\n    data = '' + data;\n    if (text.wholeText !== data)\n        text.data = data;\n}\nfunction set_input_value(input, value) {\n    input.value = value == null ? '' : value;\n}\nfunction set_style(node, key, value, important) {\n    node.style.setProperty(key, value, important ? 'important' : '');\n}\nfunction custom_event(type, detail) {\n    const e = document.createEvent('CustomEvent');\n    e.initCustomEvent(type, false, false, detail);\n    return e;\n}\n\nconst active_docs = new Set();\nlet active = 0;\n// https://github.com/darkskyapp/string-hash/blob/master/index.js\nfunction hash(str) {\n    let hash = 5381;\n    let i = str.length;\n    while (i--)\n        hash = ((hash << 5) - hash) ^ str.charCodeAt(i);\n    return hash >>> 0;\n}\nfunction create_rule(node, a, b, duration, delay, ease, fn, uid = 0) {\n    const step = 16.666 / duration;\n    let keyframes = '{\\n';\n    for (let p = 0; p <= 1; p += step) {\n        const t = a + (b - a) * ease(p);\n        keyframes += p * 100 + `%{${fn(t, 1 - t)}}\\n`;\n    }\n    const rule = keyframes + `100% {${fn(b, 1 - b)}}\\n}`;\n    const name = `__svelte_${hash(rule)}_${uid}`;\n    const doc = node.ownerDocument;\n    active_docs.add(doc);\n    const stylesheet = doc.__svelte_stylesheet || (doc.__svelte_stylesheet = doc.head.appendChild(element('style')).sheet);\n    const current_rules = doc.__svelte_rules || (doc.__svelte_rules = {});\n    if (!current_rules[name]) {\n        current_rules[name] = true;\n        stylesheet.insertRule(`@keyframes ${name} ${rule}`, stylesheet.cssRules.length);\n    }\n    const animation = node.style.animation || '';\n    node.style.animation = `${animation ? `${animation}, ` : ''}${name} ${duration}ms linear ${delay}ms 1 both`;\n    active += 1;\n    return name;\n}\nfunction delete_rule(node, name) {\n    const previous = (node.style.animation || '').split(', ');\n    const next = previous.filter(name\n        ? anim => anim.indexOf(name) < 0 // remove specific animation\n        : anim => anim.indexOf('__svelte') === -1 // remove all Svelte animations\n    );\n    const deleted = previous.length - next.length;\n    if (deleted) {\n        node.style.animation = next.join(', ');\n        active -= deleted;\n        if (!active)\n            clear_rules();\n    }\n}\nfunction clear_rules() {\n    raf(() => {\n        if (active)\n            return;\n        active_docs.forEach(doc => {\n            const stylesheet = doc.__svelte_stylesheet;\n            let i = stylesheet.cssRules.length;\n            while (i--)\n                stylesheet.deleteRule(i);\n            doc.__svelte_rules = {};\n        });\n        active_docs.clear();\n    });\n}\n\nlet current_component;\nfunction set_current_component(component) {\n    current_component = component;\n}\nfunction get_current_component() {\n    if (!current_component)\n        throw new Error('Function called outside component initialization');\n    return current_component;\n}\nfunction onMount(fn) {\n    get_current_component().$$.on_mount.push(fn);\n}\nfunction afterUpdate(fn) {\n    get_current_component().$$.after_update.push(fn);\n}\nfunction onDestroy(fn) {\n    get_current_component().$$.on_destroy.push(fn);\n}\nfunction createEventDispatcher() {\n    const component = get_current_component();\n    return (type, detail) => {\n        const callbacks = component.$$.callbacks[type];\n        if (callbacks) {\n            // TODO are there situations where events could be dispatched\n            // in a server (non-DOM) environment?\n            const event = custom_event(type, detail);\n            callbacks.slice().forEach(fn => {\n                fn.call(component, event);\n            });\n        }\n    };\n}\nfunction setContext(key, context) {\n    get_current_component().$$.context.set(key, context);\n}\nfunction getContext(key) {\n    return get_current_component().$$.context.get(key);\n}\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\nfunction bubble(component, event) {\n    const callbacks = component.$$.callbacks[event.type];\n    if (callbacks) {\n        callbacks.slice().forEach(fn => fn(event));\n    }\n}\n\nconst dirty_components = [];\nconst binding_callbacks = [];\nconst render_callbacks = [];\nconst flush_callbacks = [];\nconst resolved_promise = Promise.resolve();\nlet update_scheduled = false;\nfunction schedule_update() {\n    if (!update_scheduled) {\n        update_scheduled = true;\n        resolved_promise.then(flush);\n    }\n}\nfunction add_render_callback(fn) {\n    render_callbacks.push(fn);\n}\nfunction add_flush_callback(fn) {\n    flush_callbacks.push(fn);\n}\nlet flushing = false;\nconst seen_callbacks = new Set();\nfunction flush() {\n    if (flushing)\n        return;\n    flushing = true;\n    do {\n        // first, call beforeUpdate functions\n        // and update components\n        for (let i = 0; i < dirty_components.length; i += 1) {\n            const component = dirty_components[i];\n            set_current_component(component);\n            update(component.$$);\n        }\n        set_current_component(null);\n        dirty_components.length = 0;\n        while (binding_callbacks.length)\n            binding_callbacks.pop()();\n        // then, once components are updated, call\n        // afterUpdate functions. This may cause\n        // subsequent updates...\n        for (let i = 0; i < render_callbacks.length; i += 1) {\n            const callback = render_callbacks[i];\n            if (!seen_callbacks.has(callback)) {\n                // ...so guard against infinite loops\n                seen_callbacks.add(callback);\n                callback();\n            }\n        }\n        render_callbacks.length = 0;\n    } while (dirty_components.length);\n    while (flush_callbacks.length) {\n        flush_callbacks.pop()();\n    }\n    update_scheduled = false;\n    flushing = false;\n    seen_callbacks.clear();\n}\nfunction update($$) {\n    if ($$.fragment !== null) {\n        $$.update();\n        run_all($$.before_update);\n        const dirty = $$.dirty;\n        $$.dirty = [-1];\n        $$.fragment && $$.fragment.p($$.ctx, dirty);\n        $$.after_update.forEach(add_render_callback);\n    }\n}\n\nlet promise;\nfunction wait() {\n    if (!promise) {\n        promise = Promise.resolve();\n        promise.then(() => {\n            promise = null;\n        });\n    }\n    return promise;\n}\nfunction dispatch(node, direction, kind) {\n    node.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\nconst outroing = new Set();\nlet outros;\nfunction group_outros() {\n    outros = {\n        r: 0,\n        c: [],\n        p: outros // parent group\n    };\n}\nfunction check_outros() {\n    if (!outros.r) {\n        run_all(outros.c);\n    }\n    outros = outros.p;\n}\nfunction transition_in(block, local) {\n    if (block && block.i) {\n        outroing.delete(block);\n        block.i(local);\n    }\n}\nfunction transition_out(block, local, detach, callback) {\n    if (block && block.o) {\n        if (outroing.has(block))\n            return;\n        outroing.add(block);\n        outros.c.push(() => {\n            outroing.delete(block);\n            if (callback) {\n                if (detach)\n                    block.d(1);\n                callback();\n            }\n        });\n        block.o(local);\n    }\n}\nconst null_transition = { duration: 0 };\nfunction create_bidirectional_transition(node, fn, params, intro) {\n    let config = fn(node, params);\n    let t = intro ? 0 : 1;\n    let running_program = null;\n    let pending_program = null;\n    let animation_name = null;\n    function clear_animation() {\n        if (animation_name)\n            delete_rule(node, animation_name);\n    }\n    function init(program, duration) {\n        const d = program.b - t;\n        duration *= Math.abs(d);\n        return {\n            a: t,\n            b: program.b,\n            d,\n            duration,\n            start: program.start,\n            end: program.start + duration,\n            group: program.group\n        };\n    }\n    function go(b) {\n        const { delay = 0, duration = 300, easing = identity, tick = noop$1, css } = config || null_transition;\n        const program = {\n            start: now() + delay,\n            b\n        };\n        if (!b) {\n            // @ts-ignore todo: improve typings\n            program.group = outros;\n            outros.r += 1;\n        }\n        if (running_program || pending_program) {\n            pending_program = program;\n        }\n        else {\n            // if this is an intro, and there's a delay, we need to do\n            // an initial tick and/or apply CSS animation immediately\n            if (css) {\n                clear_animation();\n                animation_name = create_rule(node, t, b, duration, delay, easing, css);\n            }\n            if (b)\n                tick(0, 1);\n            running_program = init(program, duration);\n            add_render_callback(() => dispatch(node, b, 'start'));\n            loop(now => {\n                if (pending_program && now > pending_program.start) {\n                    running_program = init(pending_program, duration);\n                    pending_program = null;\n                    dispatch(node, running_program.b, 'start');\n                    if (css) {\n                        clear_animation();\n                        animation_name = create_rule(node, t, running_program.b, running_program.duration, 0, easing, config.css);\n                    }\n                }\n                if (running_program) {\n                    if (now >= running_program.end) {\n                        tick(t = running_program.b, 1 - t);\n                        dispatch(node, running_program.b, 'end');\n                        if (!pending_program) {\n                            // we're done\n                            if (running_program.b) {\n                                // intro  we can tidy up immediately\n                                clear_animation();\n                            }\n                            else {\n                                // outro  needs to be coordinated\n                                if (!--running_program.group.r)\n                                    run_all(running_program.group.c);\n                            }\n                        }\n                        running_program = null;\n                    }\n                    else if (now >= running_program.start) {\n                        const p = now - running_program.start;\n                        t = running_program.a + running_program.d * easing(p / running_program.duration);\n                        tick(t, 1 - t);\n                    }\n                }\n                return !!(running_program || pending_program);\n            });\n        }\n    }\n    return {\n        run(b) {\n            if (is_function(config)) {\n                wait().then(() => {\n                    // @ts-ignore\n                    config = config();\n                    go(b);\n                });\n            }\n            else {\n                go(b);\n            }\n        },\n        end() {\n            clear_animation();\n            running_program = pending_program = null;\n        }\n    };\n}\n\nconst globals = (typeof window !== 'undefined'\n    ? window\n    : typeof globalThis !== 'undefined'\n        ? globalThis\n        : global);\n\nfunction destroy_block(block, lookup) {\n    block.d(1);\n    lookup.delete(block.key);\n}\nfunction outro_and_destroy_block(block, lookup) {\n    transition_out(block, 1, 1, () => {\n        lookup.delete(block.key);\n    });\n}\nfunction update_keyed_each(old_blocks, dirty, get_key, dynamic, ctx, list, lookup, node, destroy, create_each_block, next, get_context) {\n    let o = old_blocks.length;\n    let n = list.length;\n    let i = o;\n    const old_indexes = {};\n    while (i--)\n        old_indexes[old_blocks[i].key] = i;\n    const new_blocks = [];\n    const new_lookup = new Map();\n    const deltas = new Map();\n    i = n;\n    while (i--) {\n        const child_ctx = get_context(ctx, list, i);\n        const key = get_key(child_ctx);\n        let block = lookup.get(key);\n        if (!block) {\n            block = create_each_block(key, child_ctx);\n            block.c();\n        }\n        else if (dynamic) {\n            block.p(child_ctx, dirty);\n        }\n        new_lookup.set(key, new_blocks[i] = block);\n        if (key in old_indexes)\n            deltas.set(key, Math.abs(i - old_indexes[key]));\n    }\n    const will_move = new Set();\n    const did_move = new Set();\n    function insert(block) {\n        transition_in(block, 1);\n        block.m(node, next);\n        lookup.set(block.key, block);\n        next = block.first;\n        n--;\n    }\n    while (o && n) {\n        const new_block = new_blocks[n - 1];\n        const old_block = old_blocks[o - 1];\n        const new_key = new_block.key;\n        const old_key = old_block.key;\n        if (new_block === old_block) {\n            // do nothing\n            next = new_block.first;\n            o--;\n            n--;\n        }\n        else if (!new_lookup.has(old_key)) {\n            // remove old block\n            destroy(old_block, lookup);\n            o--;\n        }\n        else if (!lookup.has(new_key) || will_move.has(new_key)) {\n            insert(new_block);\n        }\n        else if (did_move.has(old_key)) {\n            o--;\n        }\n        else if (deltas.get(new_key) > deltas.get(old_key)) {\n            did_move.add(new_key);\n            insert(new_block);\n        }\n        else {\n            will_move.add(old_key);\n            o--;\n        }\n    }\n    while (o--) {\n        const old_block = old_blocks[o];\n        if (!new_lookup.has(old_block.key))\n            destroy(old_block, lookup);\n    }\n    while (n)\n        insert(new_blocks[n - 1]);\n    return new_blocks;\n}\n\nfunction get_spread_update(levels, updates) {\n    const update = {};\n    const to_null_out = {};\n    const accounted_for = { $$scope: 1 };\n    let i = levels.length;\n    while (i--) {\n        const o = levels[i];\n        const n = updates[i];\n        if (n) {\n            for (const key in o) {\n                if (!(key in n))\n                    to_null_out[key] = 1;\n            }\n            for (const key in n) {\n                if (!accounted_for[key]) {\n                    update[key] = n[key];\n                    accounted_for[key] = 1;\n                }\n            }\n            levels[i] = n;\n        }\n        else {\n            for (const key in o) {\n                accounted_for[key] = 1;\n            }\n        }\n    }\n    for (const key in to_null_out) {\n        if (!(key in update))\n            update[key] = undefined;\n    }\n    return update;\n}\nfunction get_spread_object(spread_props) {\n    return typeof spread_props === 'object' && spread_props !== null ? spread_props : {};\n}\n\nfunction bind(component, name, callback) {\n    const index = component.$$.props[name];\n    if (index !== undefined) {\n        component.$$.bound[index] = callback;\n        callback(component.$$.ctx[index]);\n    }\n}\nfunction create_component(block) {\n    block && block.c();\n}\nfunction mount_component(component, target, anchor) {\n    const { fragment, on_mount, on_destroy, after_update } = component.$$;\n    fragment && fragment.m(target, anchor);\n    // onMount happens before the initial afterUpdate\n    add_render_callback(() => {\n        const new_on_destroy = on_mount.map(run).filter(is_function);\n        if (on_destroy) {\n            on_destroy.push(...new_on_destroy);\n        }\n        else {\n            // Edge case - component was destroyed immediately,\n            // most likely as a result of a binding initialising\n            run_all(new_on_destroy);\n        }\n        component.$$.on_mount = [];\n    });\n    after_update.forEach(add_render_callback);\n}\nfunction destroy_component(component, detaching) {\n    const $$ = component.$$;\n    if ($$.fragment !== null) {\n        run_all($$.on_destroy);\n        $$.fragment && $$.fragment.d(detaching);\n        // TODO null out other refs, including component.$$ (but need to\n        // preserve final state?)\n        $$.on_destroy = $$.fragment = null;\n        $$.ctx = [];\n    }\n}\nfunction make_dirty(component, i) {\n    if (component.$$.dirty[0] === -1) {\n        dirty_components.push(component);\n        schedule_update();\n        component.$$.dirty.fill(0);\n    }\n    component.$$.dirty[(i / 31) | 0] |= (1 << (i % 31));\n}\nfunction init(component, options, instance, create_fragment, not_equal, props, dirty = [-1]) {\n    const parent_component = current_component;\n    set_current_component(component);\n    const prop_values = options.props || {};\n    const $$ = component.$$ = {\n        fragment: null,\n        ctx: null,\n        // state\n        props,\n        update: noop$1,\n        not_equal,\n        bound: blank_object(),\n        // lifecycle\n        on_mount: [],\n        on_destroy: [],\n        before_update: [],\n        after_update: [],\n        context: new Map(parent_component ? parent_component.$$.context : []),\n        // everything else\n        callbacks: blank_object(),\n        dirty,\n        skip_bound: false\n    };\n    let ready = false;\n    $$.ctx = instance\n        ? instance(component, prop_values, (i, ret, ...rest) => {\n            const value = rest.length ? rest[0] : ret;\n            if ($$.ctx && not_equal($$.ctx[i], $$.ctx[i] = value)) {\n                if (!$$.skip_bound && $$.bound[i])\n                    $$.bound[i](value);\n                if (ready)\n                    make_dirty(component, i);\n            }\n            return ret;\n        })\n        : [];\n    $$.update();\n    ready = true;\n    run_all($$.before_update);\n    // `false` as a special case of no DOM component\n    $$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n    if (options.target) {\n        if (options.hydrate) {\n            const nodes = children(options.target);\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.l(nodes);\n            nodes.forEach(detach);\n        }\n        else {\n            // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n            $$.fragment && $$.fragment.c();\n        }\n        if (options.intro)\n            transition_in(component.$$.fragment);\n        mount_component(component, options.target, options.anchor);\n        flush();\n    }\n    set_current_component(parent_component);\n}\nclass SvelteComponent {\n    $destroy() {\n        destroy_component(this, 1);\n        this.$destroy = noop$1;\n    }\n    $on(type, callback) {\n        const callbacks = (this.$$.callbacks[type] || (this.$$.callbacks[type] = []));\n        callbacks.push(callback);\n        return () => {\n            const index = callbacks.indexOf(callback);\n            if (index !== -1)\n                callbacks.splice(index, 1);\n        };\n    }\n    $set($$props) {\n        if (this.$$set && !is_empty($$props)) {\n            this.$$.skip_bound = true;\n            this.$$set($$props);\n            this.$$.skip_bound = false;\n        }\n    }\n}\n\nconst subscriber_queue = [];\n/**\n * Creates a `Readable` store that allows reading by subscription.\n * @param value initial value\n * @param {StartStopNotifier}start start and stop notifications for subscriptions\n */\nfunction readable(value, start) {\n    return {\n        subscribe: writable(value, start).subscribe\n    };\n}\n/**\n * Create a `Writable` store that allows both updating and reading by subscription.\n * @param {*=}value initial value\n * @param {StartStopNotifier=}start start and stop notifications for subscriptions\n */\nfunction writable(value, start = noop$1) {\n    let stop;\n    const subscribers = [];\n    function set(new_value) {\n        if (safe_not_equal(value, new_value)) {\n            value = new_value;\n            if (stop) { // store is ready\n                const run_queue = !subscriber_queue.length;\n                for (let i = 0; i < subscribers.length; i += 1) {\n                    const s = subscribers[i];\n                    s[1]();\n                    subscriber_queue.push(s, value);\n                }\n                if (run_queue) {\n                    for (let i = 0; i < subscriber_queue.length; i += 2) {\n                        subscriber_queue[i][0](subscriber_queue[i + 1]);\n                    }\n                    subscriber_queue.length = 0;\n                }\n            }\n        }\n    }\n    function update(fn) {\n        set(fn(value));\n    }\n    function subscribe(run, invalidate = noop$1) {\n        const subscriber = [run, invalidate];\n        subscribers.push(subscriber);\n        if (subscribers.length === 1) {\n            stop = start(set) || noop$1;\n        }\n        run(value);\n        return () => {\n            const index = subscribers.indexOf(subscriber);\n            if (index !== -1) {\n                subscribers.splice(index, 1);\n            }\n            if (subscribers.length === 0) {\n                stop();\n                stop = null;\n            }\n        };\n    }\n    return { set, update, subscribe };\n}\nfunction derived(stores, fn, initial_value) {\n    const single = !Array.isArray(stores);\n    const stores_array = single\n        ? [stores]\n        : stores;\n    const auto = fn.length < 2;\n    return readable(initial_value, (set) => {\n        let inited = false;\n        const values = [];\n        let pending = 0;\n        let cleanup = noop$1;\n        const sync = () => {\n            if (pending) {\n                return;\n            }\n            cleanup();\n            const result = fn(single ? values[0] : values, set);\n            if (auto) {\n                set(result);\n            }\n            else {\n                cleanup = is_function(result) ? result : noop$1;\n            }\n        };\n        const unsubscribers = stores_array.map((store, i) => subscribe(store, (value) => {\n            values[i] = value;\n            pending &= ~(1 << i);\n            if (inited) {\n                sync();\n            }\n        }, () => {\n            pending |= (1 << i);\n        }));\n        inited = true;\n        sync();\n        return function stop() {\n            run_all(unsubscribers);\n            cleanup();\n        };\n    });\n}\n\nvar mergeObjects = (objects) => objects.reduce((prev, curr) => Object.assign(prev, curr), {});\n\n// @ts-ignore\nconst UPDATE_VALUE = (updateValue) => ({ updateValue });\nconst DEFAULT_VALUE = (defaultValue) => ({ defaultValue });\nconst CUSTOM_STORE = (fn) => ({ store: fn });\n// @ts-ignore\nconst DERIVED_STORE = (fn) => ({ store: (defaultValue, stores) => derived(...fn(stores)) });\nconst UNIQUE_DERIVED_STORE = (fn) => ({\n    store: (defaultValue, stores) => {\n        const [selectedStores, update, isEqual = () => false] = fn(stores);\n        let isFirst = true;\n        let currentValue;\n        return derived(selectedStores, (storeValues, set) => {\n            update(storeValues, (value) => {\n                if (!isFirst && isEqual(currentValue, value))\n                    return;\n                currentValue = value;\n                isFirst = false;\n                set(value);\n            });\n        });\n    },\n});\nconst MAP_STORE = (fn) => ({\n    store: (defaultValue, stores) => {\n        const [valueMapper, paramStores = {}] = fn(stores);\n        let storedItems = [];\n        let $paramStores = {};\n        const mapValue = (item) => valueMapper(item, $paramStores);\n        // set default properties for each shape\n        const setValue = (items) => {\n            // was empty, still empty\n            if (!storedItems.length && !items.length)\n                return;\n            // update value\n            storedItems = items;\n            updateValue();\n        };\n        const updateValue = () => {\n            const mappedItems = storedItems.map(mapValue);\n            storedItems = mappedItems;\n            set(mappedItems);\n        };\n        Object.keys(paramStores).forEach((name) => {\n            const store = paramStores[name];\n            store.subscribe((value) => {\n                $paramStores[name] = value;\n                if (!value)\n                    return;\n                updateValue();\n            });\n        });\n        const { subscribe, set } = writable(defaultValue);\n        return {\n            set: setValue,\n            update: (fn) => setValue(fn(null)),\n            subscribe,\n        };\n    },\n});\nconst createStore = (accessors, stores, options) => {\n    const { store = (defaultValue) => writable(defaultValue), defaultValue = noop, // should be a function returning the default value\n    updateValue = undefined, } = options;\n    // create our private store\n    const storeInstance = store(defaultValue(), stores, accessors);\n    const { subscribe, update = noop } = storeInstance; // update = noop because not all stores can be updated\n    // on update private store\n    let unsub;\n    const onUpdate = (cb) => {\n        let ignoreFirstCallback = true;\n        if (unsub)\n            unsub();\n        unsub = subscribe((value) => {\n            // need to ignore first callback because that returns current value\n            if (ignoreFirstCallback)\n                return (ignoreFirstCallback = false);\n            // now we have the newly assigned value\n            cb(value);\n            unsub();\n            unsub = undefined;\n        });\n    };\n    // create the value updater function, needs access to stores so can read all store values\n    const updateStoreValue = updateValue ? updateValue(accessors) : passthrough;\n    // set and validate value\n    storeInstance.set = (nextValue) => update((previousValue) => updateStoreValue(nextValue, previousValue, onUpdate));\n    // set default value for external reference\n    storeInstance.defaultValue = defaultValue;\n    // expose store api\n    return storeInstance;\n};\nvar createStores = (props) => {\n    const stores = {};\n    const accessors = {};\n    props.forEach(([name, ...options]) => {\n        const opts = mergeObjects(options);\n        const store = (stores[name] = createStore(accessors, stores, opts));\n        const property = {\n            get: () => get_store_value(store),\n            set: store.set,\n        };\n        Object.defineProperty(accessors, name, property);\n    });\n    return {\n        stores,\n        accessors,\n    };\n};\n\nvar props = [\n    // io\n    ['src'],\n    ['imageReader'],\n    ['imageWriter'],\n    // current images\n    ['images', DEFAULT_VALUE(() => [])],\n];\n\nvar pubsub = () => {\n    let subs = [];\n    return {\n        sub: (event, callback) => {\n            subs.push({ event, callback });\n            return () => (subs = subs.filter((subscriber) => subscriber.event !== event || subscriber.callback !== callback));\n        },\n        pub: (event, value) => {\n            subs\n                .filter((sub) => sub.event === event)\n                .forEach((sub) => sub.callback(value));\n        }\n    };\n};\n\nvar capitalizeFirstLetter = (str) => str.charAt(0).toUpperCase() + str.slice(1);\n\nvar defineMethods = (object, api) => {\n    Object.keys(api).forEach((name) => {\n        const descriptor = isFunction(api[name])\n            ? {\n                value: api[name],\n                writable: false,\n            }\n            : api[name];\n        Object.defineProperty(object, name, descriptor);\n    });\n};\n\nvar fixPrecision = (value, precision = 12) => parseFloat(value.toFixed(precision));\n\nconst scalar = 10000;\nvar offsetRectToFitPolygon = (rect, poly) => {\n    const polyLines = quadLines(poly);\n    const offset = vectorCreateEmpty();\n    const rectVertexes = rectGetCorners(rect);\n    // we can fit it\n    rectVertexes.forEach((vertex) => {\n        // we update each corner by adding the current offset\n        vectorAdd(vertex, offset);\n        // test if point lies in polygon, if so, all is fine and we can exit\n        if (polyPointIntersectionConvex(vertex, poly))\n            return;\n        polyLines.forEach((line) => {\n            // get angle of edge and draw a ray from the corner perpendicular to the edge\n            const a = Math.atan2(line.start.y - line.end.y, line.start.x - line.end.x);\n            const x = Math.sin(Math.PI - a) * scalar;\n            const y = Math.cos(Math.PI - a) * scalar;\n            const ray = vectorCreate(vertex.x + x, vertex.y + y);\n            // extend the poly line so even if we overshoot the polygon we hit it\n            const lineExtended = lineExtend(lineClone(line), scalar);\n            // get the resulting intersection (there's always an intersection)\n            const intersection = lineLineIntersection(lineCreate(vertex, ray), lineExtended);\n            // no intersection, no need to do anything\n            if (!intersection)\n                return;\n            // update offset to move towards image\n            vectorAdd(offset, vectorSubtract(vectorClone(intersection), vertex));\n        });\n    });\n    // test if any vertexes still fall outside of poly, if so, we can't fit the rect\n    const rectOffset = rectClone(rect);\n    vectorAdd(rectOffset, offset);\n    const rectOffsetVertices = rectGetCorners(rectOffset);\n    const fits = rectOffsetVertices.every((vertex) => polyPointIntersectionConvex(vertex, poly));\n    if (fits) {\n        rectUpdateWithRect(rect, rectOffset);\n        return true;\n    }\n    return false;\n};\n\nvar limitCropRectToImage = (rect, poly) => {\n    // get crop rect polygon vertexes\n    const rectVertexes = rectGetCorners(rect);\n    // if we end up here it doesn't fit, we might need to adjust\n    const polyLines = quadLines(poly)\n        // extend the poly lines a tiny bit so we\n        // don't shoot rays between line gaps at corners\n        // this caused one intersection to be missing resulting\n        // in error while manipulating crop edges\n        // (rotate image 90degrees -> drag bottom edge) (2021-04-09)\n        .map((line) => lineExtend(line, 5));\n    const rectCenterPosition = rectCenter(rect);\n    const intersections = [];\n    rectVertexes.forEach((rectVertex) => {\n        const ray = lineMultiply(lineCreate(vectorClone(rectCenterPosition), vectorClone(rectVertex)), 1000000);\n        let intersectionFound = false;\n        polyLines.map(lineClone).forEach((line) => {\n            const intersection = lineLineIntersection(ray, line);\n            if (!intersection || intersectionFound)\n                return;\n            intersections.push(intersection);\n            intersectionFound = true;\n        });\n    });\n    // top left -> bottom right\n    const tlbr = vectorDistance(intersections[0], intersections[2]);\n    // top right -> bottom left\n    const trbl = vectorDistance(intersections[1], intersections[3]);\n    // calculate smallest rectangle we can make, use that\n    const rectLimitedVertices = tlbr < trbl ? [intersections[0], intersections[2]] : [intersections[1], intersections[3]];\n    const rectLimitedToImage = rectCreateFromPoints(rectLimitedVertices);\n    // only use our fitted crop rectangle if it's smaller than our current rectangle,\n    // this would mean that our current rectangle couldn't be moved to make it fit\n    if (rectLimitedToImage.width < rect.width) {\n        // need to center on previous rect\n        rectUpdateWithRect(rect, rectLimitedToImage);\n        return true;\n    }\n    return false;\n};\n\nvar getImagePolygon = (image, imageRotation, imagePerspective = { x: 0, y: 0 }) => {\n    const imageRect = rectCreateFromSize(image);\n    const imageCenter = rectCenter(imageRect);\n    const imagePoly = rectApplyPerspective(imageRect, imagePerspective, imageCenter).map((imageVertex) => vectorRotate(imageVertex, imageRotation, imageCenter));\n    // get image poly bounds, we need this to offset the poly vertices from 0,0\n    const imagePolyBounds = rectCreateFromPoints(imagePoly);\n    // get image polygon vertexes\n    return imagePoly.map((imageVertex) => vectorSubtract(imageVertex, imagePolyBounds));\n};\n\nvar getMaxSizeInRect = (size, rotation = 0, aspectRatio = rectAspectRatio(size)) => {\n    let width;\n    let height;\n    if (rotation !== 0) {\n        const innerAngle = Math.atan2(1, aspectRatio);\n        const rotationSigned = Math.sign(rotation) * rotation;\n        const rotationSignedMod = rotationSigned % Math.PI;\n        const rotationSignedModHalf = rotationSigned % HALF_PI;\n        // determine if is turned on side\n        let hyp;\n        let r;\n        if (rotationSignedMod > QUART_PI && rotationSignedMod < HALF_PI + QUART_PI) {\n            r = rotationSignedModHalf > QUART_PI ? rotationSigned : HALF_PI - rotationSignedModHalf;\n        }\n        else {\n            r = rotationSignedModHalf > QUART_PI ? HALF_PI - rotationSignedModHalf : rotationSigned;\n        }\n        hyp = Math.min(Math.abs(size.height / Math.sin(innerAngle + r)), Math.abs(size.width / Math.cos(innerAngle - r)));\n        width = Math.cos(innerAngle) * hyp;\n        height = width / aspectRatio;\n    }\n    else {\n        width = size.width;\n        height = width / aspectRatio;\n        if (height > size.height) {\n            height = size.height;\n            width = height * aspectRatio;\n        }\n    }\n    return sizeCreate(width, height);\n};\n\nvar limitRectToImage = (rect, imageSize, imageRotation = 0, imagePerspective = vectorCreateEmpty(), minSize) => {\n    // rotation and/or perspective, let's use the \"advanced\" collision detection method\n    if ((isNumber(imageRotation) && imageRotation !== 0) ||\n        imagePerspective.x ||\n        imagePerspective.y) {\n        const inputAspectRatio = rectAspectRatio(rect);\n        // test if crop can fit image, if it can, offset the crop so it fits\n        const imagePolygon = getImagePolygon(imageSize, imageRotation, imagePerspective);\n        const maxSizeInRect = getMaxSizeInRect(imageSize, imageRotation, inputAspectRatio);\n        const canFit = rect.width < maxSizeInRect.width && rect.height < maxSizeInRect.height;\n        if (!canFit) {\n            const dx = rect.width * 0.5 - maxSizeInRect.width * 0.5;\n            const dy = rect.height * 0.5 - maxSizeInRect.height * 0.5;\n            // adjust crop rect to max size\n            if (rect.width > maxSizeInRect.width) {\n                rect.width = maxSizeInRect.width;\n                rect.x += dx;\n            }\n            if (rect.height > maxSizeInRect.height) {\n                rect.height = maxSizeInRect.height;\n                rect.y += dy;\n            }\n            // test if has exceeded min size, if so we need to limit the size and recalculate the other edge\n            /*\n                        -\\\n                       /  ---\\\n                      h2      ---\\\n                     /            ---\\\n                    +--------w---------+\\\n                   /|                  | ---\\\n                  / |                  |     ---\\\n                 /  |                  |         ---\\\n                /   |                  |             --\n               h1   |                  |             /\n              /     |                  |            /\n             /      |                  |           /\n            -\\      |                  |          /\n              ---\\  |                  |         /\n                  --+------------------+        /\n                      ---\\                     /\n                          --\\                 /\n                             ---\\            /\n                                 ---\\       /\n                                     ---\\  /\n                                         --\n            */\n        }\n        offsetRectToFitPolygon(rect, imagePolygon);\n        const wasLimited = limitCropRectToImage(rect, imagePolygon);\n        // this makes sure that after limiting the size, the crop rect is moved to a position that is inside the image\n        if (wasLimited)\n            offsetRectToFitPolygon(rect, imagePolygon);\n    }\n    // no rotation, no perspective, use simple bounds method\n    else {\n        // remember intended aspect ratio so we can try and recreate it\n        let intendedAspectRatio = rectAspectRatio(rect);\n        // limit to image size first, can never exceed that\n        rect.width = Math.min(rect.width, imageSize.width);\n        rect.height = Math.min(rect.height, imageSize.height);\n        // reposition rect so it's always inside image bounds\n        rect.x = Math.max(rect.x, 0);\n        if (rect.x + rect.width > imageSize.width) {\n            rect.x -= rect.x + rect.width - imageSize.width;\n        }\n        rect.y = Math.max(rect.y, 0);\n        if (rect.y + rect.height > imageSize.height) {\n            rect.y -= rect.y + rect.height - imageSize.height;\n        }\n        // we get the center of the current rect so we can center the contained rect to it\n        const intendedCenter = rectCenter(rect);\n        // make sure still adheres to aspect ratio\n        const containedRect = rectContainRect(rect, intendedAspectRatio);\n        containedRect.width = Math.max(minSize.width, containedRect.width);\n        containedRect.height = Math.max(minSize.height, containedRect.height);\n        containedRect.x = intendedCenter.x - containedRect.width * 0.5;\n        containedRect.y = intendedCenter.y - containedRect.height * 0.5;\n        rectUpdateWithRect(rect, containedRect);\n    }\n};\n\nvar applyCropRectAction = (cropRectPrevious, cropRectNext, imageSize, imageRotation, imagePerspective, cropLimitToImageBounds, cropMinSize, cropMaxSize) => {\n    // clone\n    const minSize = sizeClone(cropMinSize);\n    // set upper bounds to crop max size\n    const maxSize = sizeClone(cropMaxSize);\n    // limit max size (more important that min size is respected so first limit max size)\n    const maxScalar = fixPrecision(Math.max(cropRectNext.width / maxSize.width, cropRectNext.height / maxSize.height));\n    const minScalar = fixPrecision(Math.min(cropRectNext.width / minSize.width, cropRectNext.height / minSize.height));\n    // clone for resulting crop rect\n    const cropRectOut = rectClone(cropRectNext);\n    //\n    // if exceeds min or max scale correct next crop rectangle to conform to bounds\n    //\n    if (minScalar < 1 || maxScalar > 1) {\n        // center of both previous and next crop rects\n        const previousCropRectCenter = rectCenter(cropRectPrevious);\n        const nextCropRectCenter = rectCenter(cropRectNext);\n        // calculate scales\n        const scalar = minScalar < 1 ? minScalar : maxScalar;\n        const cx = (nextCropRectCenter.x + previousCropRectCenter.x) / 2;\n        const cy = (nextCropRectCenter.y + previousCropRectCenter.y) / 2;\n        const cw = cropRectOut.width / scalar;\n        const ch = cropRectOut.height / scalar;\n        rectUpdate(cropRectOut, cx - cw * 0.5, cy - ch * 0.5, cw, ch);\n    }\n    // no need to limit to bounds, let's go!\n    if (!cropLimitToImageBounds)\n        return {\n            crop: cropRectOut,\n        };\n    //\n    // make sure the crop is made inside the bounds of the image\n    //\n    limitRectToImage(cropRectOut, imageSize, imageRotation, imagePerspective, minSize);\n    return {\n        crop: cropRectOut,\n    };\n};\n\nvar getBaseCropRect = (imageSize, transformedCropRect, imageRotation, imagePerspective = { x: 0, y: 0 }) => {\n    const imageRect = rectCreateFromSize(imageSize);\n    const imageCenter = rectCenter(imageRect);\n    const imageTransformedVertices = rectRotate(imageRect, imageRotation, imageCenter);\n    // get the rotated image bounds center (offset isn't relevant as crop is relative to top left image position)\n    const imageRotatedBoundsCenter = rectCenter(rectNormalizeOffset(rectCreateFromPoints(imageTransformedVertices)));\n    // get the center of the crop inside the rotated image\n    const cropCenterInTransformedImage = rectCenter(transformedCropRect);\n    // invert the rotation of the crop center around the rotated image center\n    const deRotatedCropCenter = vectorRotate(cropCenterInTransformedImage, -imageRotation, imageRotatedBoundsCenter);\n    // calculate crop distance from rotated image center\n    const cropFromCenterOfTransformedImage = vectorSubtract(deRotatedCropCenter, imageRotatedBoundsCenter);\n    // calculate original crop offset (from untransformed image)\n    const originalCropCenterOffset = vectorApply(vectorAdd(imageCenter, cropFromCenterOfTransformedImage), fixPrecision);\n    return rectCreate(originalCropCenterOffset.x - transformedCropRect.width * 0.5, originalCropCenterOffset.y - transformedCropRect.height * 0.5, transformedCropRect.width, transformedCropRect.height);\n};\n\nvar clamp = (value, min, max) => Math.max(min, Math.min(value, max));\n\nvar applyRotationAction = (imageRotationPrevious, imageRotation, imageRotationRange, cropRect, imageSize, imagePerspective, cropLimitToImageBounds, cropRectOrigin, cropMinSize, cropMaxSize) => {\n    // clone\n    const minSize = sizeClone(cropMinSize);\n    // set upper bounds to crop max size if image is bigger than max size,\n    // else if should limit to image bounds use image size as limit\n    let maxSize = sizeClone(cropMaxSize);\n    if (cropLimitToImageBounds) {\n        maxSize.width = Math.min(cropMaxSize.width, imageSize.width);\n        maxSize.height = Math.min(cropMaxSize.height, imageSize.height);\n    }\n    let didAttemptDoubleTurn = false;\n    const rotate = (rotationPrevious, rotation) => {\n        // get the base crop rect (position of crop rect in untransformed image)\n        // if we have the base crop rect we can apply the new rotation to it\n        const cropRectBase = getBaseCropRect(imageSize, cropRect, rotationPrevious, null);\n        // calculate transforms based on new rotation and base crop rect\n        const imageRect = rectCreateFromSize(imageSize);\n        const imageCenter = rectCenter(imageRect);\n        const imageTransformedCorners = rectApplyPerspective(imageRect, imagePerspective, imageCenter);\n        // need this to correct for perspective centroid displacement\n        const perspectiveOffset = vectorSubtract(vectorClone(imageCenter), quadCentroid(imageTransformedCorners));\n        // rotate around center of image\n        const cropCenter = vectorRotate(rectCenter(cropRectBase), rotation, imageCenter);\n        const rotateCropOffset = vectorSubtract(vectorClone(imageCenter), cropCenter);\n        // get center of image bounds and move to correct position\n        imageTransformedCorners.forEach((imageVertex) => vectorRotate(imageVertex, rotation, imageCenter));\n        const imageBoundsRect = rectCreateFromPoints(imageTransformedCorners);\n        const imageCentroid = quadCentroid(imageTransformedCorners);\n        const cropOffset = vectorAdd(vectorSubtract(vectorSubtract(imageCentroid, rotateCropOffset), imageBoundsRect), perspectiveOffset);\n        // create output cropRect\n        const cropRectOut = rectCreate(cropOffset.x - cropRectBase.width * 0.5, cropOffset.y - cropRectBase.height * 0.5, cropRectBase.width, cropRectBase.height);\n        // if has size target, scale croprect to target size\n        if (cropRectOrigin) {\n            rectScale(cropRectOut, cropRectOrigin.width / cropRectOut.width);\n        }\n        // if should limit to image bounds\n        if (cropLimitToImageBounds) {\n            const imagePoly = getImagePolygon(imageSize, rotation, imagePerspective);\n            // offsetRectToFitPolygon(cropRectOut, imagePoly);\n            // commenting this fixes poly sliding problem when adjusting rotation\n            limitCropRectToImage(cropRectOut, imagePoly);\n        }\n        //#region if exceeds min or max adjust rotation to conform to bounds\n        const minScalar = fixPrecision(Math.min(cropRectOut.width / minSize.width, cropRectOut.height / minSize.height), 8);\n        const maxScalar = fixPrecision(Math.max(cropRectOut.width / maxSize.width, cropRectOut.height / maxSize.height), 8);\n        if (minScalar < 1 || maxScalar > 1) {\n            // determine if is full image turn\n            const isTurn = fixPrecision(Math.abs(rotation - rotationPrevious)) === fixPrecision(Math.PI / 2);\n            // try another turn if is turning image\n            if (isTurn && !didAttemptDoubleTurn) {\n                didAttemptDoubleTurn = true;\n                return rotate(imageRotationPrevious, imageRotationPrevious + Math.sign(rotation - rotationPrevious) * Math.PI);\n            }\n        }\n        //#endregion\n        return {\n            rotation,\n            crop: rectApply(cropRectOut, (v) => fixPrecision(v, 8)),\n        };\n    };\n    // amount of turns applied, we need this to correctly determine the allowed rotation range\n    const imageTurns = Math.sign(imageRotation) * Math.round(Math.abs(imageRotation) / HALF_PI) * HALF_PI;\n    const imageRotationClamped = clamp(imageRotation, imageTurns + imageRotationRange[0], imageTurns + imageRotationRange[1]);\n    // set new crop position\n    return rotate(imageRotationPrevious, imageRotationClamped);\n};\n\nconst ORDERED_STATE_PROPS = [\n    // requirements\n    'cropLimitToImage',\n    'cropMinSize',\n    'cropMaxSize',\n    'cropAspectRatio',\n    // selection -> flip -> rotate -> perspective -> crop\n    'flipX',\n    'flipY',\n    'rotation',\n    'crop',\n    // 'perspectiveX',\n    // 'perspectiveY',\n    // effects\n    'colorMatrix',\n    'convolutionMatrix',\n    'gamma',\n    'vignette',\n    // 'noise',\n    // shapes\n    'annotation',\n    'decoration',\n    // other\n    'backgroundColor',\n    'targetSize',\n];\nconst clone = (value) => {\n    if (isArray(value)) {\n        return value.map(clone);\n    }\n    else if (isObject(value)) {\n        return { ...value };\n    }\n    return value;\n};\n/* TODO: keep this state outside of the shape array? */\nconst excludedShapeProps = [\n    'isDraft',\n    'isFormatted',\n    'isComplete',\n    'isError',\n    'isLoading',\n    'isEditing',\n    'isSelected',\n];\n/* note this method doesn't actually test if the value is fully serializable it simlpy excludes known prop values that can't be serialized */\nconst isSerializeAble = (value) => {\n    // isFunction(value) ||\n    return !isElement(value);\n};\nconst filterShapeState = (shapes) => shapes.map((shape) => Object.keys(shape).reduce((copy, prop) => {\n    if (excludedShapeProps.includes(prop) || !isSerializeAble(shape[prop]))\n        return copy;\n    copy[prop] = shape[prop];\n    return copy;\n}, {}));\nvar stateStore = (defaultValue, stores, accessors) => {\n    const observedStores = ORDERED_STATE_PROPS.map((key) => stores[key]);\n    // can only subscribe, setting is done directly through store accessors\n    // @ts-ignore\n    const { subscribe } = derived(observedStores, (values, set) => {\n        const state = ORDERED_STATE_PROPS.reduce((prev, curr, i) => {\n            prev[curr] = clone(values[i]);\n            return prev;\n        }, {});\n        // round crop if defined\n        state.crop && rectApply(state.crop, Math.round);\n        // remove state props from decoration and annotation\n        state.annotation = state.annotation && filterShapeState(state.annotation);\n        state.decoration = state.decoration && filterShapeState(state.decoration);\n        set(state);\n    });\n    const setState = (state) => {\n        // requires at least some state to be supplied\n        if (!state)\n            return;\n        // make sure crop origin is reset\n        accessors.cropOrigin = undefined;\n        // apply new values\n        ORDERED_STATE_PROPS\n            // remove keys that weren't set\n            .filter((key) => state.hasOwnProperty(key))\n            // apply each key in order\n            .forEach((key) => {\n            accessors[key] = clone(state[key]);\n        });\n    };\n    return {\n        set: setState,\n        update: (fn) => setState(fn(null)),\n        subscribe,\n    };\n};\n\nvar toNumericAspectRatio = (v) => {\n    if (!v)\n        return undefined;\n    if (/:/.test(v)) {\n        const [w, h] = v.split(':');\n        return w / h;\n    }\n    return parseFloat(v);\n};\n\nvar arrayEqual = (a, b) => {\n    if (a.length !== b.length)\n        return false;\n    for (let i = 0; i < a.length; i++) {\n        if (a[i] !== b[i])\n            return false;\n    }\n    return true;\n};\n\nlet result$5 = null;\nvar isAndroid = () => {\n    if (result$5 === null)\n        result$5 = isUserAgent(/Android/);\n    return result$5;\n};\n\nlet result$6 = null;\nvar isFirefox = () => {\n    if (result$6 === null)\n        result$6 = isUserAgent(/Firefox/);\n    return result$6;\n};\n\nlet result$7 = null;\nvar isEdge = () => {\n    if (result$7 === null)\n        result$7 = isUserAgent(/Edge/);\n    return result$7;\n};\n\nlet vendor;\nvar getBrowserVendor = () => {\n    if (vendor)\n        return vendor;\n    vendor = isIOS()\n        ? 'ios'\n        : isAndroid()\n            ? 'android'\n            : isFirefox()\n                ? 'firefox'\n                : isInternetExplorer()\n                    ? 'ie'\n                    : isEdge()\n                        ? 'edge'\n                        : 'chrome';\n    return vendor;\n};\n\n// https://github.com/jhildenbiddle/canvas-size#test-results\nlet maxCanvasSze;\nvar getMaxCanvasSize = () => {\n    if (!maxCanvasSze) {\n        const sizes = {\n            android: [32767, 32767, 10836],\n            ios: [4194303, 8388607, 16777216],\n            chrome: [32767, 32767, 268435456],\n            firefox: [32767, 32767, 124992400],\n            edge: [16384, 16384, 268435456],\n            ie: [16384, 16384, 67108864],\n        };\n        maxCanvasSze = sizes[getBrowserVendor()] || sizes['chrome'];\n    }\n    const [width, height, density] = maxCanvasSze;\n    return {\n        width,\n        height,\n        density,\n    };\n};\n\nvar padColorArray = (color = [0, 0, 0, 0], opacity = 1.0) => color.length === 4 ? color : [...color, opacity];\n\n//\n// constants\n//\nconst MIN_ROTATION = -QUART_PI;\nconst MAX_ROTATION = QUART_PI;\n//\n// helper methods\n//\nconst isCropCentered = (crop, imageSize, imageRotation) => {\n    const cropCenter = vectorApply(rectCenter(crop), (v) => fixPrecision(v, 8));\n    const imageRect = rectCreateFromSize(imageSize);\n    const imageCenter = rectCenter(imageRect);\n    const imageRotatedVertices = rectRotate(imageRect, imageRotation, imageCenter);\n    const imageBoundsCenter = vectorApply(sizeCenter(rectCreateFromPoints(imageRotatedVertices)), (v) => fixPrecision(v, 8));\n    const dx = Math.abs(imageBoundsCenter.x - cropCenter.x);\n    const dy = Math.abs(imageBoundsCenter.y - cropCenter.y);\n    return dx < 1 && dy < 1;\n};\nconst isCropMaxSize = (cropRect, imageSize, rotation) => {\n    const maxSize = getMaxSizeInRect(imageSize, rotation, rectAspectRatio(cropRect));\n    return sizeEqual(sizeApply(maxSize, Math.round), sizeApply(sizeClone(cropRect), Math.round));\n};\n//\n// updater methods\n//\nconst updateCropRect = (props) => (cropNext, cropPrevious = cropNext) => {\n    // wait for image to load\n    const { loadState, size, cropMinSize, cropMaxSize, cropLimitToImage, rotation, perspective, } = props;\n    // image hasn't loaded yet, use supplied crop rect\n    if (!cropNext || !loadState || !loadState.beforeComplete)\n        return cropNext;\n    // apply the action\n    const res = applyCropRectAction(cropPrevious, cropNext, size, rotation, perspective, cropLimitToImage, cropMinSize, cropMaxSize);\n    const cropOut = rectApply(res.crop, (v) => fixPrecision(v, 8));\n    return cropOut;\n};\nconst updateCropAspectRatio = (props) => (aspectRatioNext) => {\n    const { loadState, crop, size, rotation } = props;\n    const aspectRatio = toNumericAspectRatio(aspectRatioNext);\n    // no aspect ratio means custom aspect ratio so set to undefined\n    if (!aspectRatio)\n        return undefined;\n    // can't update crop if not defined yet\n    if (!loadState || !loadState.beforeComplete)\n        return aspectRatio;\n    // if crop centered scale up\n    if (isCropCentered(crop, size, rotation)) {\n        const imageSize = sizeTurn(sizeClone(size), rotation);\n        props.crop = rectApply(rectContainRect(rectCreateFromSize(imageSize), aspectRatioNext), fixPrecision);\n    }\n    else {\n        const cropSize = {\n            width: crop.height * aspectRatio,\n            height: crop.height,\n        };\n        const tx = (crop.width - cropSize.width) * 0.5;\n        const ty = (crop.height - cropSize.height) * 0.5;\n        props.crop = rectApply(rectCreate(crop.x + tx, crop.y + ty, cropSize.width, cropSize.height), fixPrecision);\n    }\n    return aspectRatio;\n};\nconst updateCropLimitToImage = (props) => (limitToImageNext, limitToImagePrevious, onUpdate) => {\n    // if was not limiting previously and now set limiting make sure crop fits bounds\n    if (!limitToImagePrevious && limitToImageNext) {\n        onUpdate(() => (props.crop = rectClone(props.crop)));\n    }\n    return limitToImageNext;\n};\nconst updateRotation = (props) => (rotationNext, rotationPrevious, onUpdate) => {\n    // when image rotation is updated we need to adjust the\n    // cropRect offset so rotation happens from cropRect center\n    // no change\n    if (rotationNext === rotationPrevious)\n        return rotationNext;\n    // get relevant data from store state\n    const { loadState, size, rotationRange, cropMinSize, cropMaxSize, crop, perspective, cropLimitToImage, cropOrigin, } = props;\n    // image not ready, exit!\n    if (!loadState || !loadState.beforeComplete)\n        return rotationNext;\n    // remember if current crop was at max size and centered, if so, resulting crop should also be at max size\n    const cropWasAtMaxSize = isCropMaxSize(crop, size, rotationPrevious);\n    const cropWasCentered = isCropCentered(crop, size, rotationPrevious);\n    // get new state\n    const res = applyRotationAction(rotationPrevious, rotationNext, rotationRange, crop, size, perspective, cropLimitToImage, cropOrigin, cropMinSize, cropMaxSize);\n    // if is centered, and initial crop was at max size expand crop to max size\n    if (cropWasAtMaxSize && cropWasCentered) {\n        const rect = getMaxSizeInRect(size, rotationNext, rectAspectRatio(res.crop));\n        // move top left corner\n        res.crop.x += res.crop.width * 0.5;\n        res.crop.y += res.crop.height * 0.5;\n        res.crop.x -= rect.width * 0.5;\n        res.crop.y -= rect.height * 0.5;\n        // update size to max size\n        res.crop.width = rect.width;\n        res.crop.height = rect.height;\n    }\n    // return validated rotation value, then, after we assign that value, we update the crop rect\n    // we may only call onUpdate if a change was made\n    onUpdate(() => {\n        props.crop = rectApply(res.crop, (v) => fixPrecision(v, 8));\n    });\n    // return result rotation (might have been rotated twice to fit crop rectangle)\n    return res.rotation;\n};\n// updates the range of valid rotation input\nconst updateRotationRange = (imageSize, imageIsRotatedSideways, cropMinSize, cropSize) => {\n    /*\n    - 'a' is angle between diagonal and image height\n    - 'b' is angle between diagonal and crop height\n    - 'c' is angle between diagonal and image width\n    - resulting range is then a - b\n    +----------/\\------------------------+\n    |         / \\ \\                      |\n    |        /   \\  \\                    |\n    |       /     \\   \\                  |\n    |       \\      \\    \\                |\n    |         \\     \\     \\              |\n    |           \\    \\      \\            |\n    |             \\   \\       /          |\n    |               \\  \\     /           |\n    |                 \\ \\   /            |\n    |                   \\\\a/b            |\n    +---------------------\\--------------+\n    */\n    const scalar = Math.max(cropMinSize.width / cropSize.width, cropMinSize.height / cropSize.height);\n    const minSize = sizeCreate(cropSize.width * scalar, cropSize.height * scalar);\n    // the hypotenus is the length of the diagonal of the min crop size\n    const requiredSpace = sizeHypotenuse(minSize);\n    // minimum space available in horizontal / vertical direction\n    const availableSpace = Math.min(imageSize.width, imageSize.height);\n    // if there's enough space available, we can return the max range\n    if (requiredSpace < availableSpace)\n        return [MIN_ROTATION, MAX_ROTATION];\n    // if the image is turned we need to swap the width and height\n    const imageWidth = imageIsRotatedSideways ? imageSize.height : imageSize.width;\n    const imageHeight = imageIsRotatedSideways ? imageSize.width : imageSize.height;\n    // subtracting the angle between the hypotenuse and the crop itself\n    const a = Math.acos(minSize.height / requiredSpace);\n    const b = Math.acos(imageHeight / requiredSpace);\n    const c = Math.asin(imageWidth / requiredSpace);\n    const rangeHorizontal = a - b;\n    const rangeVertical = c - a;\n    // range is not a number, it means we can rotate as much as we want\n    if (Number.isNaN(rangeHorizontal) && Number.isNaN(rangeVertical))\n        return [MIN_ROTATION, MAX_ROTATION];\n    // get minimum range\n    const range = Number.isNaN(rangeHorizontal)\n        ? rangeVertical\n        : Number.isNaN(rangeVertical)\n            ? rangeHorizontal\n            : Math.min(rangeHorizontal, rangeVertical);\n    // if not, limit range to min and max rotation\n    const rangeMin = Math.max(-range, MIN_ROTATION);\n    const rangeMax = Math.min(range, MAX_ROTATION);\n    return [rangeMin, rangeMax];\n};\n// updates the range of valid crop rectangle input\nconst updateCropRange = (imageSize, rotation, cropAspectRatio, cropMinSize, cropMaxSize, cropLimitToImage) => {\n    // ! rotation doesn't affect min size, only max size\n    // set lower bounds to crop min size\n    let minSize = sizeClone(cropMinSize);\n    // set upper bounds to crop max size\n    let maxSize = sizeClone(cropMaxSize);\n    // now we got basic bounds, let's see if we should limit to the image bounds, else we done\n    if (!cropLimitToImage)\n        return [minSize, maxSize];\n    return [minSize, sizeApply(getMaxSizeInRect(imageSize, rotation, cropAspectRatio), Math.round)];\n};\nconst prepareShape = (shape, options) => {\n    // only auto-format once\n    if (!shape.isFormatted) {\n        shape = shapeFormat(shape);\n        shape.isFormatted = true;\n    }\n    // we need to make sure shape is still correctly positioned relative to parent\n    // draft cannot be relative\n    // if context changed\n    // if has left top right or bottom\n    if (!shape.isDraft &&\n        shapeHasRelativeSize(shape) &&\n        (!shape.context || !rectEqual(options.context, shape.context))) {\n        shape = shapeComputeRect(shape, options.context);\n        shape.context = { ...options.context };\n    }\n    return shape;\n};\nvar imageProps = [\n    // image info received from read\n    ['file'],\n    ['size'],\n    // loading and processing state\n    ['loadState'],\n    ['processState'],\n    // derived info\n    [\n        'aspectRatio',\n        DERIVED_STORE(({ size }) => [\n            size,\n            ($size) => ($size ? rectAspectRatio($size) : undefined),\n        ]),\n    ],\n    // image modifications\n    ['perspectiveX', DEFAULT_VALUE(() => 0)],\n    ['perspectiveY', DEFAULT_VALUE(() => 0)],\n    [\n        'perspective',\n        DERIVED_STORE(({ perspectiveX, perspectiveY }) => [\n            [perspectiveX, perspectiveY],\n            ([x, y]) => ({ x, y }),\n        ]),\n    ],\n    ['rotation', DEFAULT_VALUE(() => 0), UPDATE_VALUE(updateRotation)],\n    ['flipX', DEFAULT_VALUE(() => false)],\n    ['flipY', DEFAULT_VALUE(() => false)],\n    ['flip', DERIVED_STORE(({ flipX, flipY }) => [[flipX, flipY], ([x, y]) => ({ x, y })])],\n    [\n        'isRotatedSideways',\n        UNIQUE_DERIVED_STORE(({ rotation }) => [\n            [rotation],\n            ([$rotation], set) => set(isRotatedSideways($rotation)),\n            (prevValue, nextValue) => prevValue !== nextValue,\n        ]),\n    ],\n    ['crop', UPDATE_VALUE(updateCropRect)],\n    ['cropAspectRatio', UPDATE_VALUE(updateCropAspectRatio)],\n    ['cropOrigin'],\n    ['cropMinSize', DEFAULT_VALUE(() => ({ width: 1, height: 1 }))],\n    ['cropMaxSize', DEFAULT_VALUE(() => sizeClone(getMaxCanvasSize()))],\n    ['cropLimitToImage', DEFAULT_VALUE(() => true), UPDATE_VALUE(updateCropLimitToImage)],\n    [\n        'cropSize',\n        UNIQUE_DERIVED_STORE(({ crop }) => [\n            [crop],\n            ([$crop], set) => {\n                if (!$crop)\n                    return;\n                set(sizeCreate($crop.width, $crop.height));\n            },\n            // if is same as previous size, don't trigger update (happens when updating only the crop offset)\n            (prevValue, nextValue) => sizeEqual(prevValue, nextValue),\n        ]),\n    ],\n    [\n        'cropRectAspectRatio',\n        DERIVED_STORE(({ cropSize }) => [\n            [cropSize],\n            ([$cropSize], set) => {\n                if (!$cropSize)\n                    return;\n                set(fixPrecision(rectAspectRatio($cropSize), 5));\n            },\n        ]),\n    ],\n    [\n        'cropRange',\n        UNIQUE_DERIVED_STORE(({ size, rotation, cropRectAspectRatio, cropMinSize, cropMaxSize, cropLimitToImage, }) => [\n            [size, rotation, cropRectAspectRatio, cropMinSize, cropMaxSize, cropLimitToImage],\n            ([$size, $rotation, $cropRectAspectRatio, $cropMinSize, $cropMaxSize, $cropLimitToImage,], set) => {\n                // wait for image size\n                if (!$size)\n                    return;\n                const range = updateCropRange($size, $rotation, $cropRectAspectRatio, $cropMinSize, $cropMaxSize, $cropLimitToImage);\n                set(range);\n            },\n            // if is same range as previous range, don't trigger update\n            (prevRange, nextRange) => arrayEqual(prevRange, nextRange),\n        ]),\n    ],\n    [\n        'rotationRange',\n        UNIQUE_DERIVED_STORE(({ size, isRotatedSideways, cropMinSize, cropSize }) => [\n            [size, isRotatedSideways, cropMinSize, cropSize],\n            ([$size, $isRotatedSideways, $cropMinSize, $cropSize], set) => {\n                // wait for image size\n                if (!$size || !$cropSize)\n                    return;\n                const range = updateRotationRange($size, $isRotatedSideways, $cropMinSize, $cropSize);\n                set(range);\n            },\n            // if is same range as previous range, don't trigger update\n            (prevRange, nextRange) => arrayEqual(prevRange, nextRange),\n        ]),\n    ],\n    // canvas\n    ['backgroundColor', UPDATE_VALUE(() => (color) => padColorArray(color))],\n    // size\n    ['targetSize'],\n    // effects\n    ['colorMatrix'],\n    ['convolutionMatrix'],\n    ['gamma'],\n    ['noise'],\n    ['vignette'],\n    // annotations live in image space\n    [\n        'annotation',\n        MAP_STORE(({ size }) => [prepareShape, { context: size }]),\n        DEFAULT_VALUE(() => []),\n    ],\n    // decorations live in crop space\n    [\n        'decoration',\n        MAP_STORE(({ crop }) => [prepareShape, { context: crop }]),\n        DEFAULT_VALUE(() => []),\n    ],\n    // state of image, used to restore a previous state or request the current state\n    ['state', CUSTOM_STORE(stateStore)],\n];\n\nvar process = async (value, chainTasks, chainOptions = {}, processOptions) => {\n    // options relevant to the process method itself\n    const { ontaskstart, ontaskprogress, ontaskend, token } = processOptions;\n    // has been cancelled\n    let cancelled = false;\n    // set cancel handler method\n    token.cancel = () => {\n        // cancel called from outside of the process method\n        cancelled = true;\n    };\n    // step through chain\n    for (const [index, task] of chainTasks.entries()) {\n        // exit when cancelled\n        if (cancelled)\n            return;\n        // get the task function and the id so we can notify the callee of the task that is being started\n        const [fn, id] = task;\n        // start task\n        ontaskstart(index, id);\n        try {\n            value = await fn(value, { ...chainOptions }, (event) => ontaskprogress(index, id, event));\n        }\n        catch (err) {\n            // stop processing more items in the chain\n            cancelled = true;\n            // pass error back to parent\n            throw err;\n        }\n        ontaskend(index, id);\n    }\n    return value;\n};\n\n// TODO: find better location for minSize / file load validation\nvar createImage = ({ minSize = { width: 1, height: 1 } } = {}) => {\n    // create default store\n    const { stores, accessors } = createStores(imageProps);\n    // pub/sub\n    const { pub, sub } = pubsub();\n    // processing handler\n    const createProcessingHandler = (stateProp, eventKey) => {\n        const getStore = () => accessors[stateProp] || {};\n        const setStore = (obj) => (accessors[stateProp] = {\n            ...getStore(),\n            ...obj,\n            timeStamp: Date.now(),\n        });\n        const hasError = () => getStore().error;\n        const handleError = (error) => {\n            if (hasError())\n                return;\n            setStore({\n                error: error,\n            });\n            pub(`${eventKey}error`, { ...getStore() });\n        };\n        return {\n            start() {\n                pub(`${eventKey}start`);\n            },\n            onabort() {\n                pub(`${eventKey}abort`);\n            },\n            ontaskstart(index, id) {\n                if (hasError())\n                    return;\n                setStore({\n                    index,\n                    task: id,\n                    taskProgress: undefined,\n                    taskLengthComputable: undefined,\n                });\n                pub(`${eventKey}taskstart`, { ...getStore() });\n            },\n            ontaskprogress(index, id, event) {\n                if (hasError())\n                    return;\n                setStore({\n                    index,\n                    task: id,\n                    taskProgress: event.loaded / event.total,\n                    taskLengthComputable: event.lengthComputable,\n                });\n                pub(`${eventKey}taskprogress`, { ...getStore() });\n                pub(`${eventKey}progress`, { ...getStore() });\n            },\n            ontaskend(index, id) {\n                if (hasError())\n                    return;\n                setStore({\n                    index,\n                    task: id,\n                });\n                pub(`${eventKey}taskend`, { ...getStore() });\n            },\n            ontaskerror(error) {\n                handleError(error);\n            },\n            error(error) {\n                handleError(error);\n            },\n            beforeComplete(data) {\n                if (hasError())\n                    return;\n                setStore({ beforeComplete: true });\n                pub(`before${eventKey}`, data);\n            },\n            complete(data) {\n                if (hasError())\n                    return;\n                setStore({ complete: true });\n                pub(eventKey, data);\n            },\n        };\n    };\n    //#region read image\n    const read = (src, { reader }) => {\n        // exit if no reader supplied\n        if (!reader)\n            return;\n        // reset file data to undefined as we're loading a new image\n        Object.assign(accessors, {\n            file: undefined,\n            size: undefined,\n            loadState: undefined,\n        });\n        // our cancel token so we can abort load if needed, cancel will be set by process\n        let imageReadToken = { cancel: noop };\n        let imageReadCancelled = false;\n        const imageReadHandler = createProcessingHandler('loadState', 'load');\n        const processOptions = {\n            token: imageReadToken,\n            ...imageReadHandler,\n        };\n        const readerState = {\n            src,\n            size: undefined,\n            dest: undefined,\n        };\n        const readerOptions = {};\n        // start reading image\n        (async () => {\n            try {\n                imageReadHandler.start();\n                const output = (await process(readerState, reader, readerOptions, processOptions));\n                // was cancelled\n                if (imageReadCancelled)\n                    return imageReadHandler.onabort();\n                // get shortcuts for validation\n                const { size, dest } = output || {};\n                // if we don't have a size\n                if (!size || !size.width || !size.height)\n                    throw new DokaError('Image size missing', 'IMAGE_SIZE_MISSING', output);\n                // size of image is too small\n                if (size.width < minSize.width || size.height < minSize.height)\n                    throw new DokaError('Image too small', 'IMAGE_TOO_SMALL', {\n                        ...output,\n                        minWidth: minSize.width,\n                        minHeight: minSize.height,\n                    });\n                // update internal data\n                Object.assign(accessors, {\n                    size: size,\n                    file: dest,\n                });\n                // set base crop rect if not already has crop defined\n                if (!accessors.crop) {\n                    accessors.crop = rectContainRect(rectCreateFromSize(size), accessors.cropAspectRatio);\n                }\n                // apply current image state in correct order,\n                // there's a difference between the actions `rotate -> crop` and `crop -> rotate`\n                // this makes sure the initial state is always `rotate -> crop`\n                accessors.state = accessors.state;\n                // before load complete\n                imageReadHandler.beforeComplete(output);\n                // done loading image\n                imageReadHandler.complete(output);\n            }\n            catch (err) {\n                imageReadHandler.error(err);\n            }\n            finally {\n                imageReadToken = undefined;\n            }\n        })();\n        // call to abort load\n        return () => {\n            imageReadCancelled = true;\n            imageReadToken && imageReadToken.cancel();\n        };\n    };\n    //#endregion\n    //#region write image\n    const write = (writer) => {\n        // not ready to start processing\n        if (!accessors.loadState.complete)\n            return;\n        // reset process state to undefined\n        accessors.processState = undefined;\n        const imageWriteHandler = createProcessingHandler('processState', 'process');\n        const writerState = {\n            src: accessors.file,\n            imageState: accessors.state,\n            dest: undefined,\n        };\n        // willProcessImageState\n        if (!writer) {\n            imageWriteHandler.start();\n            imageWriteHandler.complete(writerState);\n            return;\n        }\n        // we need this token to be a blet to cancel the processing operation\n        let imageWriteToken = { cancel: noop };\n        const writerOptions = {};\n        const processOptions = {\n            token: imageWriteToken,\n            ...imageWriteHandler,\n        };\n        // start writing image\n        (async () => {\n            imageWriteHandler.start();\n            try {\n                const output = (await process(writerState, writer, writerOptions, processOptions));\n                imageWriteHandler.complete(output);\n            }\n            catch (err) {\n                imageWriteHandler.error(err);\n            }\n            finally {\n                imageWriteToken = undefined;\n            }\n        })();\n        // call to abort processing\n        return () => imageWriteToken && imageWriteToken.cancel();\n    };\n    //#endregion\n    //#region api\n    defineMethods(accessors, {\n        read,\n        write,\n        on: sub,\n    });\n    //#endregion\n    // expose store API\n    return {\n        accessors,\n        stores,\n    };\n};\n\n// @ts-ignore\nconst editorEventsToBubble = [\n    'loadstart',\n    'loadabort',\n    'loaderror',\n    'loadprogress',\n    'load',\n    'processstart',\n    'processabort',\n    'processerror',\n    'processprogress',\n    'process',\n];\nconst imagePrivateProps = [\n    'flip',\n    'cropOrigin',\n    'isRotatedSideways',\n    'perspective',\n    'perspectiveX',\n    'perspectiveY',\n    'cropRange',\n];\nconst editorPrivateProps = ['images'];\nconst getImagePropGroupedName = (prop) => `image${capitalizeFirstLetter(prop)}`;\nconst getEditorProps = () => {\n    const imageProperties = getImagePublicPropNames(imageProps).map(getImagePropGroupedName);\n    const editorProperties = props\n        .map(([prop]) => prop)\n        .filter((prop) => !editorPrivateProps.includes(prop));\n    return imageProperties.concat(editorProperties);\n};\nconst getImagePublicPropNames = (imageProps) => imageProps.map(([prop]) => prop).filter((prop) => !imagePrivateProps.includes(prop));\nvar createImageEditor = () => {\n    // create default stores\n    const { stores, accessors } = createStores(props);\n    // set up pub/sub for the app layer\n    const { sub, pub } = pubsub();\n    const bubble = (name) => (value) => pub(name, value);\n    // helper method\n    const getImageObjSafe = () => (accessors.images ? accessors.images[0] : {});\n    // create shortcuts to image props : `crop` -> `imageCrop`\n    let initialImageProps = {};\n    getImagePublicPropNames(imageProps).forEach((prop) => {\n        Object.defineProperty(accessors, getImagePropGroupedName(prop), {\n            get: () => {\n                const image = getImageObjSafe();\n                if (!image)\n                    return;\n                return image.accessors[prop];\n            },\n            set: (value) => {\n                const image = getImageObjSafe();\n                if (!image) {\n                    initialImageProps[prop] = value;\n                    return;\n                }\n                image.accessors[prop] = value;\n            },\n        });\n    });\n    // handling loading an image if a src is set\n    const unsubSrc = stores.src.subscribe((src) => {\n        // no image set, means clear active image\n        if (!src)\n            return (accessors.images = []);\n        // exit here if we don't have an imageReader we'll wait for an imageReader to be defined\n        if (!accessors.imageReader)\n            return;\n        // this is the first image so let's use `loadSrc` so we can also apply initial props\n        if (!accessors.images.length)\n            return loadSrc(src);\n        loadImage(src).catch(() => {\n            // fail silently, is handled with 'loaderror' event\n        });\n    });\n    const unsubReader = stores.imageReader.subscribe((reader) => {\n        // can't do anything without an image reader\n        if (!reader)\n            return;\n        // an image has already been loaded no need to load images that were set earlier\n        if (accessors.images.length)\n            return;\n        // no image to load, we'll wait for images to be set to the `src` prop\n        if (!accessors.src)\n            return;\n        // src is waiting to be loaded so let's pick it up,\n        // push it back a tick so we know initialImageProps are set\n        loadSrc(accessors.src).catch(() => {\n            // fail silently, is handled with 'loaderror' event\n        });\n    });\n    // loads the initial source, differs from loadImage as this method picks up any set image props\n    const loadSrc = (src) => Promise.resolve().then(() => loadImage(src, initialImageProps));\n    // internal helper method to get active image\n    const getImage = () => accessors.images && accessors.images[0];\n    //#endregion\n    //#region public method (note that these are also called from UI, name of method is name of dispatched event in UI)\n    // load image, resolve when image is loaded\n    let imageLoadAbort;\n    const loadImage = (src, options = {}) => new Promise((resolve, reject) => {\n        // get current image\n        let image = getImage();\n        // determine min defined image size (is crop min size)\n        const minImageSize = options.cropMinSize || (image && image.accessors.cropMinSize);\n        // if already has image, remove existing image\n        if (image)\n            removeImage();\n        // access image props and stores\n        image = createImage({ minSize: minImageSize });\n        editorEventsToBubble.map((event) => image.accessors.on(event, bubble(event)));\n        // done, clean up listeners\n        const done = () => {\n            initialImageProps = {};\n            unsubReject();\n            unsubResolve();\n        };\n        const unsubReject = image.accessors.on('loaderror', (error) => {\n            done();\n            reject(error);\n        });\n        image.accessors.on('beforeload', () => {\n            // normalize all prefixed options (from imageRotation -> rotation)\n            const normalizedOptions = getImagePublicPropNames(imageProps).reduce((prev, prop) => {\n                // test if already has image prop (rotation)\n                if (prop in options) {\n                    prev[prop] = options[prop];\n                    return prev;\n                }\n                // test if has prefixed image prop (imageRotation)\n                else {\n                    const groupedPropName = getImagePropGroupedName(prop);\n                    if (groupedPropName in options) {\n                        prev[prop] = options[groupedPropName];\n                    }\n                }\n                return prev;\n            }, {});\n            // if set as initial props we apply in most logical order\n            ['cropLimitToImage', 'crop', 'cropAspectRatio', 'rotation'].forEach((prop) => {\n                if (!(prop in normalizedOptions))\n                    return;\n                // asign to `image`\n                image.accessors[prop] = normalizedOptions[prop];\n                // remove from normalizedOptions\n                delete normalizedOptions[prop];\n            });\n            // assign remaining options to `image`\n            Object.assign(image.accessors, normalizedOptions);\n        });\n        const unsubResolve = image.accessors.on('load', (output) => {\n            imageLoadAbort = undefined;\n            done();\n            resolve(output);\n        });\n        // set new image\n        accessors.images = [image];\n        // assign passed options to editor accessors, we ignore 'src'\n        if (options.imageReader)\n            accessors.imageReader = options.imageReader;\n        if (options.imageWriter)\n            accessors.imageWriter = options.imageWriter;\n        // start reading image\n        imageLoadAbort = image.accessors.read(src, { reader: accessors.imageReader });\n    });\n    // start processing a loaded image, resolve when image is processed\n    let imageProcessAbort;\n    const processImage = (src, options) => {\n        return new Promise(async (resolve, reject) => {\n            // if src supplied, first load src, then process\n            src && (await loadImage(src, options));\n            // get current active image\n            const image = getImage();\n            // needs image for processing\n            if (!image)\n                return reject('no image');\n            // done, clean up listeners\n            const done = () => {\n                imageProcessAbort = undefined;\n                unsubReject();\n                unsubResolve();\n            };\n            const unsubReject = image.accessors.on('processerror', (error) => {\n                done();\n                reject(error);\n            });\n            const unsubResolve = image.accessors.on('process', (output) => {\n                done();\n                resolve(output);\n            });\n            imageProcessAbort = image.accessors.write(accessors.imageWriter);\n        });\n    };\n    const abortProcessImage = () => {\n        const image = getImage();\n        if (!image)\n            return;\n        if (imageProcessAbort)\n            imageProcessAbort();\n        image.accessors.processState = undefined;\n    };\n    // used internally (triggered by 'x' button when error loading image in UI)\n    const abortLoadImage = () => {\n        accessors.images = [];\n    };\n    // edit image, loads an image and resolve when image is processed\n    const editImage = (src, options) => new Promise((resolve, reject) => {\n        loadImage(src, options)\n            .then(() => {\n            // access image props and stores\n            const { images } = accessors;\n            const image = images[0];\n            // done, clean up listeners\n            const done = () => {\n                unsubReject();\n                unsubResolve();\n            };\n            const unsubReject = image.accessors.on('processerror', (error) => {\n                done();\n                reject(error);\n            });\n            const unsubResolve = image.accessors.on('process', (output) => {\n                done();\n                resolve(output);\n            });\n        })\n            .catch(reject);\n    });\n    const removeImage = () => {\n        // no images, nothing to remove\n        const image = getImage();\n        if (!image)\n            return;\n        // try to abort image load\n        if (imageLoadAbort)\n            imageLoadAbort();\n        image.accessors.loadState = undefined;\n        // clear images\n        accessors.images = [];\n    };\n    //#endregion\n    Object.defineProperty(accessors, 'stores', {\n        get: () => stores,\n    });\n    //#region API\n    defineMethods(accessors, {\n        on: sub,\n        loadImage,\n        abortLoadImage,\n        editImage,\n        removeImage,\n        processImage,\n        abortProcessImage,\n        destroy: () => {\n            unsubSrc();\n            unsubReader();\n        },\n    });\n    return accessors;\n    //#endregion\n};\n\nvar getComponentExportedProps = (Component) => {\n    const descriptors = Object.getOwnPropertyDescriptors(Component.prototype);\n    return Object.keys(descriptors).filter((key) => !!descriptors[key]['get']);\n};\n\nfunction circOut(t) {\n    return Math.sqrt(1 - --t * t);\n}\n\nfunction is_date(obj) {\n    return Object.prototype.toString.call(obj) === '[object Date]';\n}\n\nfunction get_interpolator(a, b) {\n    if (a === b || a !== a)\n        return () => a;\n    const type = typeof a;\n    if (type !== typeof b || Array.isArray(a) !== Array.isArray(b)) {\n        throw new Error('Cannot interpolate values of different type');\n    }\n    if (Array.isArray(a)) {\n        const arr = b.map((bi, i) => {\n            return get_interpolator(a[i], bi);\n        });\n        return t => arr.map(fn => fn(t));\n    }\n    if (type === 'object') {\n        if (!a || !b)\n            throw new Error('Object cannot be null');\n        if (is_date(a) && is_date(b)) {\n            a = a.getTime();\n            b = b.getTime();\n            const delta = b - a;\n            return t => new Date(a + t * delta);\n        }\n        const keys = Object.keys(b);\n        const interpolators = {};\n        keys.forEach(key => {\n            interpolators[key] = get_interpolator(a[key], b[key]);\n        });\n        return t => {\n            const result = {};\n            keys.forEach(key => {\n                result[key] = interpolators[key](t);\n            });\n            return result;\n        };\n    }\n    if (type === 'number') {\n        const delta = b - a;\n        return t => a + t * delta;\n    }\n    throw new Error(`Cannot interpolate ${type} values`);\n}\nfunction tweened(value, defaults = {}) {\n    const store = writable(value);\n    let task;\n    let target_value = value;\n    function set(new_value, opts) {\n        if (value == null) {\n            store.set(value = new_value);\n            return Promise.resolve();\n        }\n        target_value = new_value;\n        let previous_task = task;\n        let started = false;\n        let { delay = 0, duration = 400, easing = identity, interpolate = get_interpolator } = assign(assign({}, defaults), opts);\n        if (duration === 0) {\n            if (previous_task) {\n                previous_task.abort();\n                previous_task = null;\n            }\n            store.set(value = target_value);\n            return Promise.resolve();\n        }\n        const start = now() + delay;\n        let fn;\n        task = loop(now => {\n            if (now < start)\n                return true;\n            if (!started) {\n                fn = interpolate(value, new_value);\n                if (typeof duration === 'function')\n                    duration = duration(value, new_value);\n                started = true;\n            }\n            if (previous_task) {\n                previous_task.abort();\n                previous_task = null;\n            }\n            const elapsed = now - start;\n            if (elapsed > duration) {\n                store.set(value = new_value);\n                return false;\n            }\n            // @ts-ignore\n            store.set(value = fn(easing(elapsed / duration)));\n            return true;\n        });\n        return task.promise;\n    }\n    return {\n        set,\n        update: (fn, opts) => set(fn(target_value, value), opts),\n        subscribe: store.subscribe\n    };\n}\n\nfunction tick_spring(ctx, last_value, current_value, target_value) {\n    if (typeof current_value === 'number') {\n        // @ts-ignore\n        const delta = target_value - current_value;\n        // @ts-ignore\n        const velocity = (current_value - last_value) / (ctx.dt || 1 / 60); // guard div by 0\n        const spring = ctx.opts.stiffness * delta;\n        const damper = ctx.opts.damping * velocity;\n        const acceleration = (spring - damper) * ctx.inv_mass;\n        const d = (velocity + acceleration) * ctx.dt;\n        if (Math.abs(d) < ctx.opts.precision && Math.abs(delta) < ctx.opts.precision) {\n            return target_value; // settled\n        }\n        else {\n            ctx.settled = false; // signal loop to keep ticking\n            // @ts-ignore\n            return current_value + d;\n        }\n    }\n    else if (isArray(current_value)) {\n        // @ts-ignore\n        return current_value.map((_, i) => tick_spring(ctx, last_value[i], current_value[i], target_value[i]));\n    }\n    else if (typeof current_value === 'object') {\n        const next_value = {};\n        // @ts-ignore\n        for (const k in current_value) {\n            // @ts-ignore\n            next_value[k] = tick_spring(ctx, last_value[k], current_value[k], target_value[k]);\n        }\n        // @ts-ignore\n        return next_value;\n    }\n    else {\n        throw new Error(`Cannot spring ${typeof current_value} values`);\n    }\n}\nfunction spring(value, opts = {}) {\n    const store = writable(value);\n    const { stiffness = 0.15, damping = 0.8, precision = 0.01 } = opts;\n    let last_time;\n    let task;\n    let current_token;\n    let last_value = value;\n    let target_value = value;\n    let inv_mass = 1;\n    let inv_mass_recovery_rate = 0;\n    let cancel_task = false;\n    function set(new_value, opts = {}) {\n        target_value = new_value;\n        const token = (current_token = {});\n        if (value == null || opts.hard || (spring.stiffness >= 1 && spring.damping >= 1)) {\n            cancel_task = true; // cancel any running animation\n            last_time = null;\n            last_value = new_value;\n            store.set((value = target_value));\n            return Promise.resolve();\n        }\n        else if (opts.soft) {\n            const rate = opts.soft === true ? 0.5 : +opts.soft;\n            inv_mass_recovery_rate = 1 / (rate * 60);\n            inv_mass = 0; // infinite mass, unaffected by spring forces\n        }\n        if (!task) {\n            last_time = null;\n            cancel_task = false;\n            const ctx = {\n                inv_mass: undefined,\n                opts: spring,\n                settled: true,\n                dt: undefined,\n            };\n            task = loop((now) => {\n                if (last_time === null)\n                    last_time = now;\n                if (cancel_task) {\n                    cancel_task = false;\n                    task = null;\n                    return false;\n                }\n                inv_mass = Math.min(inv_mass + inv_mass_recovery_rate, 1);\n                // altered so doesn't create a new object\n                ctx.inv_mass = inv_mass;\n                ctx.opts = spring;\n                ctx.settled = true; // tick_spring may signal false\n                ctx.dt = ((now - last_time) * 60) / 1000;\n                const next_value = tick_spring(ctx, last_value, value, target_value);\n                last_time = now;\n                last_value = value;\n                store.set((value = next_value));\n                if (ctx.settled)\n                    task = null;\n                return !ctx.settled;\n            });\n        }\n        return new Promise((fulfil) => {\n            task.promise.then(() => {\n                if (token === current_token)\n                    fulfil();\n            });\n        });\n    }\n    const spring = {\n        set,\n        update: (fn, opts) => set(fn(target_value, value), opts),\n        subscribe: store.subscribe,\n        stiffness,\n        damping,\n        precision,\n    };\n    return spring;\n}\n\nvar prefersReducedMotion = readable(false, set => {\n    const mql = window.matchMedia('(prefers-reduced-motion:reduce)');\n    set(mql.matches);\n    mql.onchange = () => set(mql.matches);\n});\n\nvar hasResizeObserver = () => 'ResizeObserver' in window;\n\n//\nconst rectNext = rectCreateEmpty();\nconst updateNodeRect = (node, x, y, width, height) => {\n    if (!node.rect)\n        node.rect = rectCreateEmpty();\n    const rect = node.rect;\n    rectUpdate(rectNext, x, y, width, height);\n    if (rectEqual(rect, rectNext))\n        return;\n    rectUpdateWithRect(rect, rectNext);\n    node.dispatchEvent(new CustomEvent('measure', { detail: rect }));\n};\n// measures the element\nconst r = Math.round;\nconst measureViewRect = (node) => {\n    const clientRect = node.getBoundingClientRect();\n    updateNodeRect(node, r(clientRect.x), r(clientRect.y), r(clientRect.width), r(clientRect.height));\n};\nconst measureOffset = (node) => updateNodeRect(node, node.offsetLeft, node.offsetTop, node.offsetWidth, node.offsetHeight);\n// holds all the elements to measure using requestAnimationFrame\nconst elements = [];\n// draw loop\nlet frame = null;\nfunction tick() {\n    if (!elements.length) {\n        frame = null;\n        return;\n    }\n    elements.forEach((node) => node.measure(node));\n    frame = requestAnimationFrame(tick);\n}\nlet observer; // ResizeObserver API not known by TypeScript\nvar measurable = (node, options = {}) => {\n    const { observePosition = false, observeViewRect = false, once = false, disabled = false, } = options;\n    // exit\n    if (disabled)\n        return;\n    // use resize observe if available\n    if (hasResizeObserver() && !observePosition && !observeViewRect) {\n        // we only create one observer, it will observe all registered elements\n        if (!observer) {\n            // @ts-ignore: [2020-02-20] ResizeObserver API not known by TypeScript\n            observer = new ResizeObserver((entries) => {\n                entries.forEach((entry) => measureOffset(entry.target));\n            });\n        }\n        // start observing this node\n        observer.observe(node);\n        // measure our node for the first time\n        measureOffset(node);\n        // if should only measure once, remove now\n        if (once)\n            observer.unobserve(node);\n        // and we done, need to return a clean up method for when our node is destroyed\n        return {\n            destroy() {\n                // already unobserved this node\n                if (once)\n                    return;\n                observer.unobserve(node);\n                // TODO: test if all nodes have been removed, if so, remove observer\n            },\n        };\n    }\n    // set measure function\n    node.measure = observeViewRect ? measureViewRect : measureOffset;\n    // add so the element is measured\n    elements.push(node);\n    // start measuring on next frame, we set up a single measure loop,\n    // the loop will check if there's still elements that need to be measured,\n    // else it will stop running\n    if (!frame)\n        frame = requestAnimationFrame(tick);\n    // measure this element now\n    node.measure(node);\n    // remove method\n    return {\n        destroy() {\n            const index = elements.indexOf(node);\n            elements.splice(index, 1);\n        },\n    };\n};\n\nvar focusvisible = (element) => {\n    let isKeyboardInteraction = false;\n    const handlePointerdown = () => {\n        isKeyboardInteraction = false;\n    };\n    const handleKeydown = () => {\n        isKeyboardInteraction = true;\n    };\n    const handleKeyup = () => {\n        isKeyboardInteraction = false;\n    };\n    const handleFocus = (e) => {\n        if (!isKeyboardInteraction)\n            return;\n        e.target.dataset.focusVisible = '';\n    };\n    const handleBlur = (e) => {\n        delete e.target.dataset.focusVisible;\n    };\n    const map = {\n        pointerdown: handlePointerdown,\n        keydown: handleKeydown,\n        keyup: handleKeyup,\n        focus: handleFocus,\n        blur: handleBlur,\n    };\n    Object.keys(map).forEach((event) => element.addEventListener(event, map[event], true));\n    return {\n        destroy() {\n            Object.keys(map).forEach((event) => element.removeEventListener(event, map[event], true));\n        },\n    };\n};\n\nvar isImage = (file) => /^image/.test(file.type);\n\nconst getFilesFromEvent = (e) => {\n    const { items, files } = e.dataTransfer;\n    if (items) {\n        return Array.from(items)\n            .filter((item) => item.kind === 'file')\n            .map((item) => item.getAsFile());\n    }\n    return Array.from(files) || [];\n};\nvar dropable = (node) => {\n    const handleDragOver = (e) => {\n        // need to be prevent default to allow drop\n        e.preventDefault();\n    };\n    const handleDrop = (e) => {\n        e.preventDefault();\n        e.stopPropagation(); // prevents parents from catching this drop\n        node.dispatchEvent(new CustomEvent('dropfiles', {\n            detail: {\n                event: e,\n                files: getFilesFromEvent(e).filter((file) => isImage(file)),\n            },\n        }));\n    };\n    node.addEventListener('drop', handleDrop);\n    node.addEventListener('dragover', handleDragOver);\n    // remove method\n    return {\n        destroy() {\n            node.removeEventListener('drop', handleDrop);\n            node.removeEventListener('dragover', handleDragOver);\n        },\n    };\n};\n\nlet result$8 = null;\nvar supportsWebGL2 = () => {\n    if (result$8 === null) {\n        if ('WebGL2RenderingContext' in window) {\n            let canvas;\n            try {\n                canvas = h('canvas');\n                result$8 = !!canvas.getContext('webgl2');\n            }\n            catch (err) {\n                result$8 = false;\n            }\n            canvas && releaseCanvas(canvas);\n        }\n        else {\n            result$8 = false;\n        }\n    }\n    return result$8;\n};\n\nvar isPowerOf2 = (value) => (value & (value - 1)) === 0;\n\nvar stringReplace = (str, entries = {}, prefix = '', postfix = '') => {\n    return Object.keys(entries)\n        .filter((key) => !isObject(entries[key]))\n        .reduce((prev, curr) => {\n        return prev.replace(new RegExp(prefix + curr + postfix), entries[curr]);\n    }, str);\n};\n\nvar SHADER_FRAG_HEAD = \"#version 300 es\\nprecision highp float;\\n\\nout vec4 fragColor;\"; // eslint-disable-line\n\nvar SHADER_FRAG_INIT = \"\\nfloat a=1.0;vec4 fillColor=uColor;vec4 textureColor=texture(uTexture,vTexCoord);textureColor*=(1.0-step(1.0,vTexCoord.y))*step(0.0,vTexCoord.y)*(1.0-step(1.0,vTexCoord.x))*step(0.0,vTexCoord.x);\"; // eslint-disable-line\n\nvar SHADER_FRAG_MASK = \"\\nuniform float uMaskFeather[8];uniform float uMaskBounds[4];uniform float uMaskOpacity;float mask(float x,float y,float bounds[4],float opacity){return 1.0-(1.0-(smoothstep(bounds[3],bounds[3]+1.0,x)*(1.0-smoothstep(bounds[1]-1.0,bounds[1],x))*(1.0-step(bounds[0],y))*step(bounds[2],y)))*(1.0-opacity);}\"; // eslint-disable-line\n\nvar SHADER_FRAG_MASK_APPLY = \"\\nfloat m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);\"; // eslint-disable-line\n\nvar SHADER_FRAG_MASK_FEATHER_APPLY = \"\\nfloat leftFeatherOpacity=step(uMaskFeather[1],gl_FragCoord.x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],gl_FragCoord.x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],gl_FragCoord.x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],gl_FragCoord.x));a*=leftFeatherOpacity*rightFeatherOpacity;\"; // eslint-disable-line\n\nvar SHADER_FRAG_RECT_AA = \"\\nvec2 scaledPoint=vec2(vRectCoord.x*uSize.x,vRectCoord.y*uSize.y);a*=smoothstep(0.0,1.0,uSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);\"; // eslint-disable-line\n\nvar SHADER_FRAG_CORNER_RADIUS = \"\\nvec2 s=(uSize-2.0)*.5;vec2 r=(vRectCoord*uSize);vec2 p=r-(uSize*.5);float cornerRadius=uCornerRadius[0];bool left=r.x<s.x;bool top=r.y<s.x;if(!left&&top){cornerRadius=uCornerRadius[1];}if(!left&&!top){cornerRadius=uCornerRadius[3];}if(left&&!top){cornerRadius=uCornerRadius[2];}a*=1.0-clamp(length(max(abs(p)-(s-cornerRadius),0.0))-cornerRadius,0.0,1.0);\"; // eslint-disable-line\n\nvar SHADER_FRAG_SHAPE_BLEND_COLOR = \"\\nfillColor.a*=a;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);textureColor*=uTextureOpacity;textureColor.a*=a;textureColor.rgb*=m*a;textureColor.rgb+=(1.0-m)*(uCanvasColor.rgb*textureColor.a);fragColor=textureColor+(fillColor*(1.0-textureColor.a));\"; // eslint-disable-line\n\nvar SHADER_FRAG_TEXTURE_COLORIZE = \"\\nif(uTextureColor.a!=0.0&&textureColor.a>0.0){vec3 colorFlattened=textureColor.rgb/textureColor.a;if(colorFlattened.r>.999999&&colorFlattened.g==0.0&&colorFlattened.b>.999999){textureColor.rgb=uTextureColor.rgb*textureColor.a;}textureColor*=uTextureColor.a;}\"; // eslint-disable-line\n\nvar SHADER_VERT_HEAD = \"#version 300 es\\n\\nin vec4 aPosition;uniform mat4 uMatrix;\"; // eslint-disable-line\n\nvar SHADER_VERT_MULTIPLY_MATRUX = \"\\ngl_Position=uMatrix*vec4(aPosition.x,aPosition.y,0,1);\"; // eslint-disable-line\n\nvar SHADER_VERT_TEXTURE = \"\\nin vec2 aTexCoord;out vec2 vTexCoord;\"; // eslint-disable-line\n\nconst SHADER_VERT_SNIPPETS = {\n    head: SHADER_VERT_HEAD,\n    text: SHADER_VERT_TEXTURE,\n    matrix: SHADER_VERT_MULTIPLY_MATRUX,\n};\nconst SHADER_FRAG_SNIPPETS = {\n    head: SHADER_FRAG_HEAD,\n    mask: SHADER_FRAG_MASK,\n    init: SHADER_FRAG_INIT,\n    colorize: SHADER_FRAG_TEXTURE_COLORIZE,\n    maskapply: SHADER_FRAG_MASK_APPLY,\n    maskfeatherapply: SHADER_FRAG_MASK_FEATHER_APPLY,\n    edgeaa: SHADER_FRAG_RECT_AA,\n    cornerradius: SHADER_FRAG_CORNER_RADIUS,\n    fragcolor: SHADER_FRAG_SHAPE_BLEND_COLOR,\n};\nconst transpileShader = (gl, src, type) => {\n    src = stringReplace(src, type === gl.VERTEX_SHADER ? SHADER_VERT_SNIPPETS : SHADER_FRAG_SNIPPETS, '##').trim();\n    // ready if supports webgl\n    if (supportsWebGL2())\n        return src;\n    src = src.replace(/#version.+/gm, '').trim();\n    src = src.replace(/^\\/\\/\\#/gm, '#');\n    if (type === gl.VERTEX_SHADER) {\n        src = src.replace(/in /gm, 'attribute ').replace(/out /g, 'varying ');\n    }\n    if (type === gl.FRAGMENT_SHADER) {\n        src = src\n            .replace(/in /gm, 'varying ')\n            .replace(/out.*?;/gm, '')\n            .replace(/texture\\(/g, 'texture2D(')\n            .replace(/fragColor/g, 'gl_FragColor');\n    }\n    return `${src}`;\n};\nconst compileShader = (gl, src, type) => {\n    const shader = gl.createShader(type);\n    const transpiledSrc = transpileShader(gl, src, type);\n    gl.shaderSource(shader, transpiledSrc);\n    gl.compileShader(shader);\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        console.error(gl.getShaderInfoLog(shader));\n    }\n    return shader;\n};\nconst createShader = (gl, vertexShader, fragmentShader, attribs, uniforms) => {\n    const program = gl.createProgram();\n    gl.attachShader(program, compileShader(gl, vertexShader, gl.VERTEX_SHADER));\n    gl.attachShader(program, compileShader(gl, fragmentShader, gl.FRAGMENT_SHADER));\n    gl.linkProgram(program);\n    const locations = {};\n    attribs.forEach((name) => {\n        locations[name] = gl.getAttribLocation(program, name);\n    });\n    uniforms.forEach((name) => {\n        locations[name] = gl.getUniformLocation(program, name);\n    });\n    return {\n        program,\n        locations,\n    };\n};\nconst canMipMap = (source) => {\n    if (supportsWebGL2())\n        return true;\n    return isPowerOf2(source.width) && isPowerOf2(source.height);\n};\nconst applyTextureProperties = (gl, source) => {\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, canMipMap(source) ? gl.LINEAR_MIPMAP_LINEAR : gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    if (canMipMap(source)) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n    }\n};\nconst createTexture = (gl, source) => {\n    const texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source);\n    applyTextureProperties(gl, source);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    return texture;\n};\nconst applyOpacity = (color, opacity = 1) => color\n    ? [color[0], color[1], color[2], isNumber(color[3]) ? opacity * color[3] : opacity]\n    : [0, 0, 0, 0];\n\nconst mat4Create = () => {\n    const mat = new Float32Array(16);\n    mat[0] = 1;\n    mat[5] = 1;\n    mat[10] = 1;\n    mat[15] = 1;\n    return mat;\n};\nconst mat4Perspective = (mat, fovy, aspect, near, far) => {\n    const f = 1.0 / Math.tan(fovy / 2);\n    const nf = 1 / (near - far);\n    mat[0] = f / aspect;\n    mat[1] = 0;\n    mat[2] = 0;\n    mat[3] = 0;\n    mat[4] = 0;\n    mat[5] = f;\n    mat[6] = 0;\n    mat[7] = 0;\n    mat[8] = 0;\n    mat[9] = 0;\n    mat[10] = (far + near) * nf;\n    mat[11] = -1;\n    mat[12] = 0;\n    mat[13] = 0;\n    mat[14] = 2 * far * near * nf;\n    mat[15] = 0;\n};\nconst mat4Ortho = (mat, left, right, bottom, top, near, far) => {\n    const lr = 1 / (left - right);\n    const bt = 1 / (bottom - top);\n    const nf = 1 / (near - far);\n    mat[0] = -2 * lr;\n    mat[1] = 0;\n    mat[2] = 0;\n    mat[3] = 0;\n    mat[4] = 0;\n    mat[5] = -2 * bt;\n    mat[6] = 0;\n    mat[7] = 0;\n    mat[8] = 0;\n    mat[9] = 0;\n    mat[10] = 2 * nf;\n    mat[11] = 0;\n    mat[12] = (left + right) * lr;\n    mat[13] = (top + bottom) * bt;\n    mat[14] = (far + near) * nf;\n    mat[15] = 1;\n};\nconst mat4Translate = (mat, x, y, z) => {\n    mat[12] = mat[0] * x + mat[4] * y + mat[8] * z + mat[12];\n    mat[13] = mat[1] * x + mat[5] * y + mat[9] * z + mat[13];\n    mat[14] = mat[2] * x + mat[6] * y + mat[10] * z + mat[14];\n    mat[15] = mat[3] * x + mat[7] * y + mat[11] * z + mat[15];\n};\nconst mat4Scale = (mat, s) => {\n    mat[0] = mat[0] * s;\n    mat[1] = mat[1] * s;\n    mat[2] = mat[2] * s;\n    mat[3] = mat[3] * s;\n    mat[4] = mat[4] * s;\n    mat[5] = mat[5] * s;\n    mat[6] = mat[6] * s;\n    mat[7] = mat[7] * s;\n    mat[8] = mat[8] * s;\n    mat[9] = mat[9] * s;\n    mat[10] = mat[10] * s;\n    mat[11] = mat[11] * s;\n};\nconst mat4ScaleX = (mat, s) => {\n    mat[0] = mat[0] * s;\n    mat[1] = mat[1] * s;\n    mat[2] = mat[2] * s;\n    mat[3] = mat[3] * s;\n};\nconst mat4ScaleY = (mat, s) => {\n    mat[4] = mat[4] * s;\n    mat[5] = mat[5] * s;\n    mat[6] = mat[6] * s;\n    mat[7] = mat[7] * s;\n};\nconst mat4RotateX = (mat, rad) => {\n    const s = Math.sin(rad);\n    const c = Math.cos(rad);\n    const a10 = mat[4];\n    const a11 = mat[5];\n    const a12 = mat[6];\n    const a13 = mat[7];\n    const a20 = mat[8];\n    const a21 = mat[9];\n    const a22 = mat[10];\n    const a23 = mat[11];\n    mat[4] = a10 * c + a20 * s;\n    mat[5] = a11 * c + a21 * s;\n    mat[6] = a12 * c + a22 * s;\n    mat[7] = a13 * c + a23 * s;\n    mat[8] = a20 * c - a10 * s;\n    mat[9] = a21 * c - a11 * s;\n    mat[10] = a22 * c - a12 * s;\n    mat[11] = a23 * c - a13 * s;\n};\nconst mat4RotateY = (mat, rad) => {\n    const s = Math.sin(rad);\n    const c = Math.cos(rad);\n    const a00 = mat[0];\n    const a01 = mat[1];\n    const a02 = mat[2];\n    const a03 = mat[3];\n    const a20 = mat[8];\n    const a21 = mat[9];\n    const a22 = mat[10];\n    const a23 = mat[11];\n    mat[0] = a00 * c - a20 * s;\n    mat[1] = a01 * c - a21 * s;\n    mat[2] = a02 * c - a22 * s;\n    mat[3] = a03 * c - a23 * s;\n    mat[8] = a00 * s + a20 * c;\n    mat[9] = a01 * s + a21 * c;\n    mat[10] = a02 * s + a22 * c;\n    mat[11] = a03 * s + a23 * c;\n};\nconst mat4RotateZ = (mat, rad) => {\n    const s = Math.sin(rad);\n    const c = Math.cos(rad);\n    const a00 = mat[0];\n    const a01 = mat[1];\n    const a02 = mat[2];\n    const a03 = mat[3];\n    const a10 = mat[4];\n    const a11 = mat[5];\n    const a12 = mat[6];\n    const a13 = mat[7];\n    mat[0] = a00 * c + a10 * s;\n    mat[1] = a01 * c + a11 * s;\n    mat[2] = a02 * c + a12 * s;\n    mat[3] = a03 * c + a13 * s;\n    mat[4] = a10 * c - a00 * s;\n    mat[5] = a11 * c - a01 * s;\n    mat[6] = a12 * c - a02 * s;\n    mat[7] = a13 * c - a03 * s;\n};\n\nvar degToRad = (degrees) => degrees * Math.PI / 180;\n\nvar previewFragmentShader = \"\\n##head\\nin vec2 vTexCoord;uniform sampler2D uTexture;uniform sampler2D uTextureMarkup;uniform vec2 uTextureSize;uniform float uOpacity;uniform vec4 uFillColor;uniform vec4 uOverlayColor;uniform mat4 uColorMatrix;uniform vec4 uColorOffset;uniform float uClarityKernel[9];uniform float uClarityKernelWeight;uniform float uColorGamma;uniform float uColorVignette;uniform float uMaskClip;uniform float uMaskOpacity;uniform float uMaskBounds[4];uniform float uMaskCornerRadius[4];uniform float uMaskFeather[8];vec4 applyGamma(vec4 c,float g){c.r=pow(c.r,g);c.g=pow(c.g,g);c.b=pow(c.b,g);return c;}vec4 applyColorMatrix(vec4 c,mat4 m,vec4 o){vec4 cM=(c*m)+o;cM*=cM.a;return cM;}vec4 applyConvolutionMatrix(vec4 c,float k0,float k1,float k2,float k3,float k4,float k5,float k6,float k7,float k8,float w){if(w<=0.0)return c;vec2 pixel=vec2(1)/uTextureSize;vec4 colorSum=texture(uTexture,vTexCoord+pixel*vec2(-1.0,-1.0))*k0+texture(uTexture,vTexCoord+pixel*vec2(0.0,-1.0))*k1+texture(uTexture,vTexCoord+pixel*vec2(1.0,-1.0))*k2+texture(uTexture,vTexCoord+pixel*vec2(-1.0,0.0))*k3+texture(uTexture,vTexCoord+pixel*vec2(0.0,0.0))*k4+texture(uTexture,vTexCoord+pixel*vec2(1.0,0.0))*k5+texture(uTexture,vTexCoord+pixel*vec2(-1.0,1.0))*k6+texture(uTexture,vTexCoord+pixel*vec2(0.0,1.0))*k7+texture(uTexture,vTexCoord+pixel*vec2(1.0,1.0))*k8;vec4 color=vec4((colorSum/w).rgb,c.a);color.rgb=clamp(color.rgb,0.0,1.0);return color;}vec4 applyVignette(vec4 c,vec2 pos,vec2 center,float v){float d=distance(pos,center)/length(center);float f=1.0-(d*abs(v));if(v>0.0){c.rgb*=f;}else if(v<0.0){c.rgb+=(1.0-f)*(1.0-c.rgb);}return c;}vec4 blendPremultipliedAlpha(vec4 back,vec4 front){return front+(back*(1.0-front.a));}void main(){float x=gl_FragCoord.x;float y=gl_FragCoord.y;float a=1.0;float maskTop=uMaskBounds[0];float maskRight=uMaskBounds[1];float maskBottom=uMaskBounds[2];float maskLeft=uMaskBounds[3];float leftFeatherOpacity=step(uMaskFeather[1],x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],x));a*=leftFeatherOpacity*rightFeatherOpacity;float overlayColorAlpha=(smoothstep(maskLeft,maskLeft+1.0,x)*(1.0-smoothstep(maskRight-1.0,maskRight,x))*(1.0-step(maskTop,y))*step(maskBottom,y));if(uOverlayColor.a==0.0){a*=overlayColorAlpha;}vec2 offset=vec2(maskLeft,maskBottom);vec2 size=vec2(maskRight-maskLeft,maskTop-maskBottom)*.5;vec2 center=offset.xy+size.xy;int pixelX=int(step(center.x,x));int pixelY=int(step(y,center.y));float cornerRadius=0.0;if(pixelX==0&&pixelY==0)cornerRadius=uMaskCornerRadius[0];if(pixelX==1&&pixelY==0)cornerRadius=uMaskCornerRadius[1];if(pixelX==0&&pixelY==1)cornerRadius=uMaskCornerRadius[2];if(pixelX==1&&pixelY==1)cornerRadius=uMaskCornerRadius[3];float cornerOffset=sign(cornerRadius)*length(max(abs(gl_FragCoord.xy-size-offset)-size+cornerRadius,0.0))-cornerRadius;float cornerOpacity=1.0-smoothstep(0.0,1.0,cornerOffset);a*=cornerOpacity;vec2 scaledPoint=vec2(vTexCoord.x*uTextureSize.x,vTexCoord.y*uTextureSize.y);a*=smoothstep(0.0,1.0,uTextureSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uTextureSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);vec4 color=texture(uTexture,vTexCoord);color=applyConvolutionMatrix(color,uClarityKernel[0],uClarityKernel[1],uClarityKernel[2],uClarityKernel[3],uClarityKernel[4],uClarityKernel[5],uClarityKernel[6],uClarityKernel[7],uClarityKernel[8],uClarityKernelWeight);color=applyGamma(color,uColorGamma);color=applyColorMatrix(color,uColorMatrix,uColorOffset);color=blendPremultipliedAlpha(uFillColor,color);color*=a;color=blendPremultipliedAlpha(color,texture(uTextureMarkup,vTexCoord));if(uColorVignette!=0.0){vec2 pos=gl_FragCoord.xy-offset;color=applyVignette(color,pos,center-offset,uColorVignette);}vec4 overlayColor=uOverlayColor*(1.0-overlayColorAlpha);overlayColor.rgb*=overlayColor.a;color=blendPremultipliedAlpha(color,overlayColor);if(uOverlayColor.a>0.0&&color.a<1.0&&uFillColor.a>0.0){color=blendPremultipliedAlpha(uFillColor,overlayColor);}color*=uOpacity;fragColor=color;}\"; // eslint-disable-line\n\nvar previewVertexShader = \"\\n##head\\n##text\\nvoid main(){vTexCoord=aTexCoord;gl_Position=uMatrix*aPosition;}\"; // eslint-disable-line\n\nvar pathVertexShader = \"#version 300 es\\n\\nin vec4 aPosition;in vec2 aNormal;in float aMiter;out vec2 vNormal;out float vMiter;uniform float uWidth;uniform mat4 uMatrix;void main(){vMiter=aMiter;vNormal=aNormal;float w=uWidth;gl_Position=uMatrix*vec4(aPosition.x+(aNormal.x*w*.5*aMiter),aPosition.y+(aNormal.y*w*.5*aMiter),0,1);}\"; // eslint-disable-line\n\nvar pathFragmentShader = \"\\n##head\\n##mask\\nin vec2 vNormal;in float vMiter;uniform float uWidth;uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;float w=(uWidth-1.0)*.5;float d=1.0-abs(vMiter);float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);fillColor.a*=clamp(smoothstep(0.25,1.0,d*w),0.0,1.0);fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}\"; // eslint-disable-line\n\nvar rectVertexShader = \"\\n##head\\n##text\\nin vec2 aRectCoord;out vec2 vRectCoord;void main(){vTexCoord=aTexCoord;vRectCoord=aRectCoord;\\n##matrix\\n}\"; // eslint-disable-line\n\nvar rectFragmentShader = \"\\n##head\\n##mask\\nin vec2 vTexCoord;in vec2 vRectCoord;uniform sampler2D uTexture;uniform vec4 uTextureColor;uniform float uTextureOpacity;uniform vec4 uColor;uniform float uCornerRadius[4];uniform vec2 uSize;uniform vec2 uPosition;uniform vec4 uCanvasColor;void main(){\\n##init\\n##colorize\\n##edgeaa\\n##cornerradius\\n##maskfeatherapply\\n##maskapply\\n##fragcolor\\n}\"; // eslint-disable-line\n\nvar ellipseVertexShader = \"\\n##head\\n##text\\nvoid main(){vTexCoord=vec2(aTexCoord.x*2.0-1.0,aTexCoord.y*2.0-1.0);\\n##matrix\\n}\"; // eslint-disable-line\n\nvar ellipseFragmentShader = \"\\n##head\\n##mask\\nin vec2 vTexCoord;uniform sampler2D uTexture;uniform float uTextureOpacity;uniform vec2 uRadius;uniform vec4 uColor;uniform int uInverted;uniform vec4 uCanvasColor;void main(){\\n##init\\nfloat ar=uRadius.x/uRadius.y;vec2 rAA=vec2(uRadius.x-1.0,uRadius.y-(1.0/ar));vec2 scaledPointSq=vec2((vTexCoord.x*uRadius.x)*(vTexCoord.x*uRadius.x),(vTexCoord.y*uRadius.y)*(vTexCoord.y*uRadius.y));float p=(scaledPointSq.x/(uRadius.x*uRadius.x))+(scaledPointSq.y/(uRadius.y*uRadius.y));float pAA=(scaledPointSq.x/(rAA.x*rAA.x))+(scaledPointSq.y/(rAA.y*rAA.y));a=smoothstep(1.0,p/pAA,p);if(uInverted==1)a=1.0-a;\\n##maskapply\\n##fragcolor\\n}\"; // eslint-disable-line\n\nvar triangleVertexShader = \"\\n##head\\nvoid main(){\\n##matrix\\n}\"; // eslint-disable-line\n\nvar triangleFragmentShader = \"\\n##head\\n##mask\\nuniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;\\n##maskapply\\nfillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}\"; // eslint-disable-line\n\nconst createPathSegment = (vertices, index, a, b, c) => {\n    let ab;\n    let bc;\n    ab = vectorNormalize(vectorCreate(b.x - a.x, b.y - a.y));\n    bc = vectorNormalize(vectorCreate(c.x - b.x, c.y - b.y));\n    const tangent = vectorNormalize(vectorCreate(ab.x + bc.x, ab.y + bc.y));\n    const miter = vectorCreate(-tangent.y, tangent.x);\n    const normal = vectorCreate(-ab.y, ab.x);\n    // TODO: The Math.min is a \"dirty\" hack to prevent miter spikes, should bevel line edges\n    // const dist = Math.min(1, 1 / vectorDot(miter, normal));\n    const miterLength = 1 / vectorDot(miter, normal);\n    vertices[index] = b.x;\n    vertices[index + 1] = b.y;\n    vertices[index + 2] = miter.x;\n    vertices[index + 3] = miter.y;\n    vertices[index + 4] = -miterLength;\n    vertices[index + 5] = b.x;\n    vertices[index + 6] = b.y;\n    vertices[index + 7] = miter.x;\n    vertices[index + 8] = miter.y;\n    vertices[index + 9] = miterLength;\n};\nconst createPathVertices = (points, close) => {\n    let a, b, c, i = 0;\n    const l = points.length;\n    const stride = 10;\n    const vertices = new Float32Array((close ? l + 1 : l) * stride);\n    const first = points[0];\n    const last = points[l - 1];\n    for (i = 0; i < l; i++) {\n        a = points[i - 1];\n        b = points[i];\n        c = points[i + 1];\n        // if previous point not available use inverse vector to next point\n        if (!a)\n            a = close ? last : vectorCreate(b.x + (b.x - c.x), b.y + (b.y - c.y));\n        // if next point not available use inverse vector from previous point\n        if (!c)\n            c = close ? first : vectorCreate(b.x + (b.x - a.x), b.y + (b.y - a.y));\n        createPathSegment(vertices, i * stride, a, b, c);\n    }\n    if (close)\n        createPathSegment(vertices, l * stride, last, first, points[1]);\n    return vertices;\n};\nconst rectPointsToVertices = (points) => {\n    // [tl, tr, br, bl]\n    // B   D\n    // | \\ |\n    // A  C\n    const vertices = new Float32Array(8);\n    vertices[0] = points[3].x;\n    vertices[1] = points[3].y;\n    vertices[2] = points[0].x;\n    vertices[3] = points[0].y;\n    vertices[4] = points[2].x;\n    vertices[5] = points[2].y;\n    vertices[6] = points[1].x;\n    vertices[7] = points[1].y;\n    return vertices;\n};\nconst trianglePointToVertices = (points) => {\n    const vertices = new Float32Array(6);\n    vertices[0] = points[0].x;\n    vertices[1] = points[0].y;\n    vertices[2] = points[1].x;\n    vertices[3] = points[1].y;\n    vertices[4] = points[2].x;\n    vertices[5] = points[2].y;\n    return vertices;\n};\nconst createRectPoints = (rect, rotation = 0, flipX, flipY) => {\n    const corners = rectGetCorners(rect);\n    const cx = rect.x + rect.width * 0.5;\n    const cy = rect.y + rect.height * 0.5;\n    if (flipX || flipY)\n        vectorsFlip(corners, flipX, flipY, cx, cy);\n    if (rotation !== 0)\n        vectorsRotate(corners, rotation, cx, cy);\n    return corners;\n};\nconst createEllipseOutline = (x, y, width, height, rotation, flipX, flipY) => {\n    const points = [];\n    // decide how much points we need to describe the circle\n    const size = Math.abs(width) + Math.abs(height);\n    const precision = Math.max(20, Math.round(size / 6));\n    const w = width * 0.5;\n    const h = height * 0.5;\n    const cx = x + w;\n    const cy = y + h;\n    for (let i = 0; i < precision; i++) {\n        points.push(vectorCreate(cx + w * Math.cos((i * (Math.PI * 2)) / precision), cy + h * Math.sin((i * (Math.PI * 2)) / precision)));\n    }\n    if (flipX || flipY)\n        vectorsFlip(points, flipX, flipY, cx, cy);\n    if (rotation)\n        vectorsRotate(points, rotation, cx, cy);\n    return points;\n};\nconst createRectOutline = (x, y, width, height, rotation, cornerRadius, flipX, flipY) => {\n    const points = [];\n    if (cornerRadius.every((v) => v === 0)) {\n        points.push(vectorCreate(x, y), // top left corner\n        vectorCreate(x + width, y), // top right corner\n        vectorCreate(x + width, y + height), // bottom right corner\n        vectorCreate(x, y + height) // bottom left corner\n        );\n    }\n    else {\n        const [tl, tr, bl, br] = cornerRadius;\n        const l = x;\n        const r = x + width;\n        const t = y;\n        const b = y + height;\n        // start at end of top left corner\n        points.push(vectorCreate(l + tl, t));\n        pushRectCornerPoints(points, r - tr, t + tr, tr, -1);\n        // move to bottom right corner\n        points.push(vectorCreate(r, t + tr));\n        pushRectCornerPoints(points, r - br, b - br, br, 0);\n        // move to bottom left corner\n        points.push(vectorCreate(r - br, b));\n        pushRectCornerPoints(points, l + bl, b - bl, bl, 1);\n        // move to top left corner\n        points.push(vectorCreate(l, b - bl));\n        pushRectCornerPoints(points, l + tl, t + tl, tl, 2);\n    }\n    if (flipX || flipY)\n        vectorsFlip(points, flipX, flipY, x + width * 0.5, y + height * 0.5);\n    if (rotation)\n        vectorsRotate(points, rotation, x + width * 0.5, y + height * 0.5);\n    return points;\n};\nconst pushRectCornerPoints = (points, x, y, radius, offset) => {\n    const precision = Math.min(20, Math.max(4, Math.round(radius / 2)));\n    let p = 0;\n    let s = 0;\n    let rx = 0;\n    let ry = 0;\n    let i = 0;\n    for (; i < precision; i++) {\n        p = i / precision;\n        s = offset * HALF_PI + p * HALF_PI;\n        rx = radius * Math.cos(s);\n        ry = radius * Math.sin(s);\n        points.push(vectorCreate(x + rx, y + ry));\n    }\n};\n\nvar getWebGLContext = (canvas, attrs) => canvas.getContext('webgl2', attrs) ||\n    canvas.getContext('webgl', attrs) ||\n    canvas.getContext('experimental-webgl', attrs);\n\n// prettier-ignore\n// B   D\n// | \\ |\n// A  C\nconst rectUV = new Float32Array([\n    0.0, 1.0,\n    0.0, 0.0,\n    1.0, 1.0,\n    1.0, 0.0,\n]);\nvar createGLImageDrawer = (canvas, imageData, imageSize, pixelDensity) => {\n    let viewSize = { width: 0, height: 0 };\n    let viewSizeVisual = { width: 0, height: 0 };\n    let viewAspectRatio;\n    let viewPixelDensity;\n    let viewZ;\n    let markupMatrixCanvas;\n    let markupMatrixFrameBuffer;\n    let markupMatrix;\n    let imagePositions;\n    let maskTop;\n    let maskRight;\n    let maskBottom;\n    let maskLeft;\n    let maskOpacity;\n    let maskBounds;\n    let canvasColor = [0, 0, 0];\n    //#region texture handling\n    // offset +   0 : white\n    // offset +   1 : transparent\n    // offset +   2 : preview markup\n    // offset +   3 : preview\n    // offset + >=4 : markup\n    const TEXTURE_WHITE_INDEX = 0;\n    const TEXTURE_TRANSPARENT_INDEX = 1;\n    const TEXTURE_PREVIEW_MARKUP_INDEX = 2;\n    const TEXTURE_PREVIEW_INDEX = 3;\n    const TEXTURE_OFFSET = 4;\n    const textures = [];\n    const setTextureObject = (index, texture, source = undefined) => {\n        const storedTexture = textures[index];\n        if (storedTexture)\n            gl.deleteTexture(storedTexture.texture);\n        textures[index] = {\n            texture,\n            source,\n            textureAspectRatio: source ? getAspectRatio(source.width, source.height) : undefined,\n        };\n        return index;\n    };\n    const getTextureSize = (index) => {\n        const source = textures[index].source;\n        return (source && {\n            width: source.width,\n            height: source.height,\n        });\n    };\n    const getAvailableTextureIndex = () => {\n        const index = textures.findIndex((value) => value === undefined);\n        return index < TEXTURE_OFFSET ? textures.length : index;\n    };\n    const addTextureObject = (texture, source = undefined) => setTextureObject(getAvailableTextureIndex(), texture, source);\n    const addTexture = (source) => addTextureObject(createTexture(gl, source), source);\n    const setTexture = (index, source) => {\n        setTextureObject(index, createTexture(gl, source), source);\n    };\n    const reserveTexture = (index) => {\n        textures[index] = {};\n    };\n    const removeTexture = (index) => {\n        const item = textures[index];\n        gl.deleteTexture(item.texture);\n        if (item.source instanceof HTMLCanvasElement)\n            releaseCanvas(item.source);\n        textures[index] = undefined;\n    };\n    //#endregion\n    // resize view\n    const resize = (width, height, pixelDensity) => {\n        // density\n        viewPixelDensity = pixelDensity;\n        // visual size\n        viewSizeVisual.width = width;\n        viewSizeVisual.height = height;\n        // size\n        viewSize.width = width * pixelDensity;\n        viewSize.height = height * pixelDensity;\n        // calculate the aspect ratio, we use this to determine quad size\n        viewAspectRatio = getAspectRatio(viewSize.width, viewSize.height);\n        // sync dimensions with image data\n        canvas.width = viewSize.width;\n        canvas.height = viewSize.height;\n        // redefine matrices\n        markupMatrixCanvas = mat4Create();\n        mat4Ortho(markupMatrixCanvas, 0, viewSize.width, viewSize.height, 0, -1, 1);\n        markupMatrixFrameBuffer = mat4Create();\n        const w = imageData.width * pixelDensity;\n        const h = imageData.height * pixelDensity;\n        mat4Ortho(markupMatrixFrameBuffer, 0, w, h, 0, -1, 1);\n        mat4Translate(markupMatrixFrameBuffer, 0, h, 0);\n        mat4ScaleX(markupMatrixFrameBuffer, 1);\n        mat4ScaleY(markupMatrixFrameBuffer, -1);\n        // update preview markup texture\n        gl.bindTexture(gl.TEXTURE_2D, textures[TEXTURE_PREVIEW_MARKUP_INDEX].texture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, imageData.width, imageData.height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\n        // set the filtering, we don't need mips\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n        gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, textures[TEXTURE_PREVIEW_MARKUP_INDEX].texture, 0);\n        // update image texture\n        const imageWidth = imageSize.width * pixelDensity;\n        const imageHeight = imageSize.height * pixelDensity;\n        const l = imageWidth * -0.5;\n        const t = imageHeight * 0.5;\n        const r = imageWidth * 0.5;\n        const b = imageHeight * -0.5;\n        // prettier-ignore\n        // B   D\n        // | \\ |\n        // A  C\n        imagePositions = new Float32Array([\n            l, b, 0,\n            l, t, 0,\n            r, b, 0,\n            r, t, 0,\n        ]);\n        gl.bindBuffer(gl.ARRAY_BUFFER, imagePositionsBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, imagePositions, gl.STATIC_DRAW);\n        // move image backwards so it's presented in actual pixel size\n        viewZ = // 1. we calculate the z offset required to have the\n            //    image height match the view height\n            /*        /|\n                     / |\n                    /  | height / 2\n                   /   |\n            f / 2 /__z_|\n                  \\    |\n                   \\   |\n                    \\  |\n                     \\ |\n                      \\|\n            */\n            (imageSize.height / 2 / FOV_TAN_HALF) *\n                // 2. we want to render the image at the actual height, viewsize / height gets us results in a 1:1 presentation\n                (viewSize.height / imageSize.height) *\n                // 3. z has to be negative, therefor multiply by -1\n                -1;\n    };\n    // fov is fixed\n    const FOV = degToRad(30);\n    const FOV_TAN_HALF = Math.tan(FOV / 2);\n    // get gl drawing context\n    const gl = getWebGLContext(canvas, {\n        antialias: false,\n        alpha: false,\n        premultipliedAlpha: true,\n    });\n    // no drawing context received, exit\n    if (!gl)\n        return;\n    // enable derivatives\n    gl.getExtension('OES_standard_derivatives');\n    // toggle gl settings\n    gl.disable(gl.DEPTH_TEST);\n    // set blend mode, we need it for alpha blending\n    gl.enable(gl.BLEND);\n    /*\n    https://webglfundamentals.org/webgl/lessons/webgl-and-alpha.html\n    most if not all Canvas 2D implementations work with pre-multiplied alpha.\n    That means when you transfer them to WebGL and UNPACK_PREMULTIPLY_ALPHA_WEBGL\n    is false WebGL will convert them back to un-premultipiled.\n    With pre-multiplied alpha on, [1, .5, .5, 0] does not exist, it's always [0, 0, 0, 0]\n    */\n    gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n    gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, true);\n    // something to look into:\n    // gl.UNPACK_COLORSPACE_CONVERSION_WEBGL\n    // create white base shape texture\n    const whiteTexture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, whiteTexture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, // width\n    1, // height\n    0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array([255, 255, 255, 255]) // white background\n    );\n    setTextureObject(TEXTURE_WHITE_INDEX, whiteTexture);\n    const transparentTexture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, transparentTexture);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 1, // width\n    1, // height\n    0, gl.RGBA, gl.UNSIGNED_BYTE, new Uint8Array([0, 0, 0, 0]) // transparent background\n    );\n    setTextureObject(TEXTURE_TRANSPARENT_INDEX, transparentTexture);\n    // create image markup texture and framebuffer\n    const imageMarkupTexture = gl.createTexture();\n    setTextureObject(TEXTURE_PREVIEW_MARKUP_INDEX, imageMarkupTexture);\n    const fb = gl.createFramebuffer();\n    // #region image\n    // create preview texture\n    setTexture(TEXTURE_PREVIEW_INDEX, imageData);\n    const imagePositionsBuffer = gl.createBuffer();\n    const texturePositionsBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, texturePositionsBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, rectUV, gl.STATIC_DRAW);\n    // prettier-ignore\n    // B   D\n    // | \\ |\n    // A  C\n    const imageCoordinateCount = 4;\n    // create default pixel drawing program, supports what we need\n    const previewShader = createShader(gl, previewVertexShader, previewFragmentShader, ['aPosition', 'aTexCoord'], [\n        'uMatrix',\n        'uTexture',\n        'uTextureMarkup',\n        'uTextureSize',\n        'uColorGamma',\n        'uColorVignette',\n        'uColorOffset',\n        'uColorMatrix',\n        'uClarityKernel',\n        'uClarityKernelWeight',\n        'uOpacity',\n        'uMaskOpacity',\n        'uMaskBounds',\n        'uMaskCornerRadius',\n        'uMaskFeather',\n        'uFillColor',\n        'uOverlayColor',\n    ]);\n    // tell canvas context to use program\n    gl.useProgram(previewShader.program);\n    // transform vars\n    let matrix;\n    const drawPreviewImage = (originX, originY, translateX, translateY, rotateX, rotateY, rotateZ, scale, colorMatrix, opacity = 1, clarity, gamma = 1, vignette = 0, maskFeather = [1, 0, 1, 0, 1, viewSizeVisual.width, 1, viewSizeVisual.width], maskCornerRadius = [0, 0, 0, 0], imageBackgroundColor = [0, 0, 0, 0], imageOverlayColor = [0, 0, 0, 0], enableMarkup = true) => {\n        const { program, locations } = previewShader;\n        // convert to pixel density\n        translateX *= viewPixelDensity;\n        translateY *= viewPixelDensity;\n        originX *= viewPixelDensity;\n        originY *= viewPixelDensity;\n        // apply\n        matrix = mat4Create();\n        mat4Perspective(matrix, FOV, viewAspectRatio, 1, -viewZ * 2);\n        // move image\n        mat4Translate(matrix, translateX, -translateY, viewZ);\n        // set rotation origin in view\n        mat4Translate(matrix, originX, -originY, 0);\n        // rotate image\n        mat4RotateZ(matrix, -rotateZ);\n        // resize\n        mat4Scale(matrix, scale);\n        // reset rotation origin\n        mat4Translate(matrix, -originX, originY, 0);\n        // flip\n        mat4RotateY(matrix, rotateY);\n        mat4RotateX(matrix, rotateX);\n        //\n        // tell context to draw preview\n        //\n        gl.useProgram(program);\n        gl.enableVertexAttribArray(locations.aPosition);\n        gl.enableVertexAttribArray(locations.aTexCoord);\n        // set up texture\n        const previewTexture = textures[TEXTURE_PREVIEW_INDEX];\n        gl.uniform1i(locations.uTexture, TEXTURE_PREVIEW_INDEX);\n        gl.uniform2f(locations.uTextureSize, imageData.width, imageData.height);\n        gl.activeTexture(gl.TEXTURE0 + TEXTURE_PREVIEW_INDEX);\n        gl.bindTexture(gl.TEXTURE_2D, previewTexture.texture);\n        // set up markup texture\n        const textureIndex = enableMarkup\n            ? TEXTURE_PREVIEW_MARKUP_INDEX\n            : TEXTURE_TRANSPARENT_INDEX;\n        const markupTexture = textures[textureIndex];\n        gl.uniform1i(locations.uTextureMarkup, textureIndex);\n        gl.activeTexture(gl.TEXTURE0 + textureIndex);\n        gl.bindTexture(gl.TEXTURE_2D, markupTexture.texture);\n        // set up buffers\n        gl.bindBuffer(gl.ARRAY_BUFFER, imagePositionsBuffer);\n        gl.vertexAttribPointer(locations.aPosition, 3, gl.FLOAT, false, 0, 0);\n        gl.bindBuffer(gl.ARRAY_BUFFER, texturePositionsBuffer);\n        gl.vertexAttribPointer(locations.aTexCoord, 2, gl.FLOAT, false, 0, 0);\n        // update matrix\n        gl.uniformMatrix4fv(locations.uMatrix, false, matrix);\n        // overlay color\n        gl.uniform4fv(locations.uOverlayColor, imageOverlayColor);\n        gl.uniform4fv(locations.uFillColor, imageBackgroundColor);\n        // convolution\n        let clarityWeight;\n        if (!clarity) {\n            clarity = [0, 0, 0, 0, 1, 0, 0, 0, 0];\n            clarityWeight = -1;\n        }\n        else {\n            clarityWeight = clarity.reduce((prev, curr) => prev + curr, 0);\n            clarityWeight = clarityWeight <= 0 ? 1 : clarityWeight;\n        }\n        gl.uniform1fv(locations.uClarityKernel, clarity);\n        gl.uniform1f(locations.uClarityKernelWeight, clarityWeight);\n        gl.uniform1f(locations.uColorGamma, 1.0 / gamma);\n        gl.uniform1f(locations.uColorVignette, vignette);\n        // set color matrix values\n        gl.uniform4f(locations.uColorOffset, colorMatrix[4], colorMatrix[9], colorMatrix[14], colorMatrix[19]);\n        gl.uniformMatrix4fv(locations.uColorMatrix, false, [\n            colorMatrix[0],\n            colorMatrix[1],\n            colorMatrix[2],\n            colorMatrix[3],\n            colorMatrix[5],\n            colorMatrix[6],\n            colorMatrix[7],\n            colorMatrix[8],\n            colorMatrix[10],\n            colorMatrix[11],\n            colorMatrix[12],\n            colorMatrix[13],\n            colorMatrix[15],\n            colorMatrix[16],\n            colorMatrix[17],\n            colorMatrix[18],\n        ]);\n        // opacity level\n        gl.uniform1f(locations.uOpacity, opacity);\n        // mask\n        gl.uniform1f(locations.uMaskOpacity, maskOpacity);\n        gl.uniform1fv(locations.uMaskBounds, maskBounds);\n        gl.uniform1fv(locations.uMaskCornerRadius, maskCornerRadius.map((v) => v * pixelDensity));\n        gl.uniform1fv(locations.uMaskFeather, maskFeather.map((v, i) => (i % 2 === 0 ? v : v * pixelDensity)));\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, imageCoordinateCount);\n        gl.disableVertexAttribArray(locations.aPosition);\n        gl.disableVertexAttribArray(locations.aTexCoord);\n    };\n    //#endregion\n    // #region path\n    const pathShader = createShader(gl, pathVertexShader, pathFragmentShader, ['aPosition', 'aNormal', 'aMiter'], ['uColor', 'uCanvasColor', 'uMatrix', 'uWidth', 'uMaskBounds', 'uMaskOpacity']);\n    const pathBuffer = gl.createBuffer();\n    const strokePath = (points, width, color, close) => {\n        const { program, locations } = pathShader;\n        gl.useProgram(program);\n        gl.enableVertexAttribArray(locations.aPosition);\n        gl.enableVertexAttribArray(locations.aNormal);\n        gl.enableVertexAttribArray(locations.aMiter);\n        const vertices = createPathVertices(points, close);\n        const stride = Float32Array.BYTES_PER_ELEMENT * 5;\n        const normalOffset = Float32Array.BYTES_PER_ELEMENT * 2; // at position 2\n        const miterOffset = Float32Array.BYTES_PER_ELEMENT * 4; // at position 4\n        gl.uniform1f(locations.uWidth, width + 2.0);\n        gl.uniform4fv(locations.uColor, color);\n        gl.uniformMatrix4fv(locations.uMatrix, false, markupMatrix);\n        gl.uniform4f(locations.uCanvasColor, canvasColor[0], canvasColor[1], canvasColor[2], 1);\n        gl.uniform1fv(locations.uMaskBounds, maskBounds);\n        gl.uniform1f(locations.uMaskOpacity, maskOpacity);\n        gl.bindBuffer(gl.ARRAY_BUFFER, pathBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n        gl.vertexAttribPointer(locations.aPosition, 2, gl.FLOAT, false, stride, 0);\n        gl.vertexAttribPointer(locations.aNormal, 2, gl.FLOAT, false, stride, normalOffset);\n        gl.vertexAttribPointer(locations.aMiter, 1, gl.FLOAT, false, stride, miterOffset);\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, vertices.length / 5);\n        gl.disableVertexAttribArray(locations.aPosition);\n        gl.disableVertexAttribArray(locations.aNormal);\n        gl.disableVertexAttribArray(locations.aMiter);\n    };\n    //#endregion\n    // #region triangle\n    const triangleShader = createShader(gl, triangleVertexShader, triangleFragmentShader, ['aPosition'], ['uColor', 'uCanvasColor', 'uMatrix', 'uMaskBounds', 'uMaskOpacity']);\n    const triangleBuffer = gl.createBuffer();\n    const fillTriangle = (vertices, backgroundColor) => {\n        const { program, locations } = triangleShader;\n        gl.useProgram(program);\n        gl.enableVertexAttribArray(locations.aPosition);\n        gl.uniform4fv(locations.uColor, backgroundColor);\n        gl.uniformMatrix4fv(locations.uMatrix, false, markupMatrix);\n        gl.uniform1fv(locations.uMaskBounds, maskBounds);\n        gl.uniform1f(locations.uMaskOpacity, maskOpacity);\n        gl.uniform4f(locations.uCanvasColor, canvasColor[0], canvasColor[1], canvasColor[2], 1);\n        gl.bindBuffer(gl.ARRAY_BUFFER, triangleBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n        gl.vertexAttribPointer(locations.aPosition, 2, gl.FLOAT, false, 0, 0);\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, vertices.length / 2);\n        gl.disableVertexAttribArray(locations.aPosition);\n        return vertices;\n    };\n    //#endregion\n    // #region rect\n    const rectShaderAttributes = ['aPosition', 'aTexCoord', 'aRectCoord'];\n    const rectShaderUniforms = [\n        'uTexture',\n        'uColor',\n        'uMatrix',\n        'uCanvasColor',\n        'uTextureColor',\n        'uTextureOpacity',\n        'uPosition',\n        'uSize',\n        'uMaskBounds',\n        'uMaskOpacity',\n        'uMaskFeather',\n        'uCornerRadius',\n    ];\n    const rectShader = createShader(gl, rectVertexShader, rectFragmentShader, rectShaderAttributes, rectShaderUniforms);\n    const rectBuffer = gl.createBuffer();\n    const rectTextureBuffer = gl.createBuffer();\n    const rectCornerBuffer = gl.createBuffer();\n    const rectTextureColorFilter = [0, 0, 0, 0];\n    const fillRect = (vertices, width, height, cornerRadius, backgroundColor, backgroundImage, opacity = 1.0, colorFilter = rectTextureColorFilter, uv = rectUV, maskFeather = [\n        1,\n        0,\n        1,\n        0,\n        1,\n        Math.max(viewSize.width, imageData.width),\n        1,\n        Math.max(viewSize.width, imageData.width),\n    ]) => {\n        const { program, locations } = rectShader;\n        gl.useProgram(program);\n        gl.enableVertexAttribArray(locations.aPosition);\n        gl.enableVertexAttribArray(locations.aTexCoord);\n        gl.enableVertexAttribArray(locations.aRectCoord);\n        gl.uniform4fv(locations.uColor, backgroundColor);\n        gl.uniform4fv(locations.uTextureColor, colorFilter);\n        gl.uniform1f(locations.uTextureOpacity, opacity);\n        gl.uniform2fv(locations.uSize, [width, height]);\n        gl.uniform2fv(locations.uPosition, [vertices[2], vertices[3]]);\n        gl.uniform1fv(locations.uCornerRadius, cornerRadius);\n        gl.uniform4f(locations.uCanvasColor, canvasColor[0], canvasColor[1], canvasColor[2], 1);\n        // mask\n        gl.uniform1fv(locations.uMaskFeather, maskFeather.map((v, i) => (i % 2 === 0 ? v : v * pixelDensity)));\n        gl.uniform1fv(locations.uMaskBounds, maskBounds);\n        gl.uniform1f(locations.uMaskOpacity, maskOpacity);\n        gl.uniformMatrix4fv(locations.uMatrix, false, markupMatrix);\n        const textureIndex = textures[backgroundImage] && textures[backgroundImage].texture\n            ? backgroundImage\n            : TEXTURE_TRANSPARENT_INDEX;\n        gl.uniform1i(locations.uTexture, textureIndex);\n        gl.activeTexture(gl.TEXTURE0 + textureIndex);\n        gl.bindTexture(gl.TEXTURE_2D, textures[textureIndex].texture);\n        gl.bindBuffer(gl.ARRAY_BUFFER, rectTextureBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, uv, gl.STATIC_DRAW);\n        gl.vertexAttribPointer(locations.aTexCoord, 2, gl.FLOAT, false, 0, 0);\n        // we use these coordinates combined with the size of the rect to interpolate and alias edges\n        gl.bindBuffer(gl.ARRAY_BUFFER, rectCornerBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, rectUV, gl.STATIC_DRAW);\n        gl.vertexAttribPointer(locations.aRectCoord, 2, gl.FLOAT, false, 0, 0);\n        gl.bindBuffer(gl.ARRAY_BUFFER, rectBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n        gl.vertexAttribPointer(locations.aPosition, 2, gl.FLOAT, false, 0, 0);\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, vertices.length / 2);\n        gl.disableVertexAttribArray(locations.aPosition);\n        gl.disableVertexAttribArray(locations.aTexCoord);\n        gl.disableVertexAttribArray(locations.aRectCoord);\n        return vertices;\n    };\n    //#endregion\n    // #region ellipse\n    const ellipseShader = createShader(gl, ellipseVertexShader, ellipseFragmentShader, ['aPosition', 'aTexCoord'], [\n        'uTexture',\n        'uTextureOpacity',\n        'uColor',\n        'uCanvasColor',\n        'uMatrix',\n        'uRadius',\n        'uInverted',\n        'uMaskBounds',\n        'uMaskOpacity',\n    ]);\n    const ellipseBuffer = gl.createBuffer();\n    const ellipseTextureBuffer = gl.createBuffer();\n    const fillEllipse = (vertices, width, height, backgroundColor, backgroundImage = TEXTURE_TRANSPARENT_INDEX, opacity = 1.0, inverted = false) => {\n        const { program, locations } = ellipseShader;\n        gl.useProgram(program);\n        gl.enableVertexAttribArray(locations.aPosition);\n        gl.enableVertexAttribArray(locations.aTexCoord);\n        gl.uniform2fv(locations.uRadius, [width * 0.5, height * 0.5]);\n        gl.uniform1i(locations.uInverted, inverted ? 1 : 0);\n        gl.uniform4fv(locations.uColor, backgroundColor);\n        gl.uniformMatrix4fv(locations.uMatrix, false, markupMatrix);\n        gl.uniform4f(locations.uCanvasColor, canvasColor[0], canvasColor[1], canvasColor[2], 1);\n        gl.uniform1fv(locations.uMaskBounds, maskBounds);\n        gl.uniform1f(locations.uMaskOpacity, maskOpacity);\n        gl.uniform1i(locations.uTexture, backgroundImage);\n        gl.uniform1f(locations.uTextureOpacity, opacity);\n        gl.activeTexture(gl.TEXTURE0 + backgroundImage);\n        gl.bindTexture(gl.TEXTURE_2D, textures[backgroundImage].texture);\n        gl.bindBuffer(gl.ARRAY_BUFFER, ellipseTextureBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, rectUV, gl.STATIC_DRAW);\n        gl.vertexAttribPointer(locations.aTexCoord, 2, gl.FLOAT, false, 0, 0);\n        gl.bindBuffer(gl.ARRAY_BUFFER, ellipseBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n        gl.vertexAttribPointer(locations.aPosition, 2, gl.FLOAT, false, 0, 0);\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, vertices.length / 2);\n        gl.disableVertexAttribArray(locations.aPosition);\n        gl.disableVertexAttribArray(locations.aTexCoord);\n    };\n    //#endregion\n    //\n    // draw calls\n    //\n    const drawPath = (points, strokeWidth, strokeColor, opacity) => {\n        // is no line\n        if (points.length < 2)\n            return;\n        strokePath(points.map((p) => ({\n            x: p.x * pixelDensity,\n            y: p.y * pixelDensity,\n        })), strokeWidth * pixelDensity, applyOpacity(strokeColor, opacity), false);\n    };\n    const drawTriangle = (points, rotation = 0, flipX = false, flipY = false, backgroundColor, opacity) => {\n        if (!backgroundColor)\n            return;\n        const clonedPoints = points.map((p) => ({\n            x: p.x * pixelDensity,\n            y: p.y * pixelDensity,\n        }));\n        const center = quadCentroid(clonedPoints);\n        if (flipX || flipY)\n            vectorsFlip(clonedPoints, flipX, flipY, center.x, center.y);\n        vectorsRotate(clonedPoints, rotation, center.x, center.y);\n        const vertices = trianglePointToVertices(clonedPoints);\n        fillTriangle(vertices, applyOpacity(backgroundColor, opacity));\n    };\n    const getBackgroundUV = (width, height, backgroundSize, backgroundPosition) => {\n        if (!backgroundSize && !backgroundPosition)\n            return rectUV;\n        let x = backgroundPosition.x / backgroundSize.width;\n        let y = backgroundPosition.y / backgroundSize.height;\n        let w = width / backgroundSize.width / pixelDensity;\n        let h = height / backgroundSize.height / pixelDensity;\n        w -= x;\n        h -= y;\n        // prettier-ignore\n        // B   D\n        // | \\ |\n        // A  C\n        // bottom left\n        const ax = -x;\n        const ay = h;\n        // top left\n        const bx = -x;\n        const by = -y;\n        // bottom right\n        const cx = w;\n        const cy = h;\n        // top right\n        const dx = w;\n        const dy = -y;\n        return new Float32Array([\n            ax,\n            ay,\n            bx,\n            by,\n            cx,\n            cy,\n            dx,\n            dy,\n        ]);\n    };\n    const limitCornerRadius = (r, size) => Math.floor(clamp(r, 0, Math.min((size.width - 1) * 0.5, (size.height - 1) * 0.5)));\n    const drawRect = (rect, rotation = 0, flipX = false, flipY = false, cornerRadius, backgroundColor, backgroundImage, backgroundSize = undefined, backgroundPosition = undefined, strokeWidth, strokeColor, opacity, maskFeather = undefined, colorize) => {\n        // clone first\n        let rectOut = rectMultiply(rectClone(rect), pixelDensity);\n        // has radius, doesn't matter for coordinates\n        const cornerRadiusOut = cornerRadius\n            .map((r) => limitCornerRadius(r || 0, rect))\n            .map((r) => r * viewPixelDensity);\n        // should fill\n        if (backgroundColor || backgroundImage) {\n            // adjust for edge anti-aliasing, if we don't do this the\n            // visible rectangle will be 1 pixel smaller than the actual rectangle\n            const rectFill = rectClone(rectOut);\n            rectFill.x -= 0.5;\n            rectFill.y -= 0.5;\n            rectFill.width += 1.0;\n            rectFill.height += 1.0;\n            const points = createRectPoints(rectFill, rotation, flipX, flipY);\n            const vertices = rectPointsToVertices(points);\n            let color;\n            if (colorize) {\n                color = applyOpacity(colorize);\n                // as 0 transparancy is used to test if the colorize filter should be applied we set it to 0.001\n                if (color[3] === 0)\n                    color[3] = 0.001;\n            }\n            fillRect(vertices, rectFill.width, rectFill.height, cornerRadiusOut, applyOpacity(backgroundColor, opacity), backgroundImage, opacity, color, getBackgroundUV(rectFill.width, rectFill.height, backgroundSize, backgroundPosition), maskFeather);\n        }\n        // should draw outline\n        if (strokeWidth) {\n            // fixes issue where stroke would render weirdly\n            strokeWidth = Math.min(strokeWidth, rectOut.width, rectOut.height);\n            strokePath(\n            // rect out is already multiplied by pixel density\n            createRectOutline(rectOut.x, rectOut.y, rectOut.width, rectOut.height, rotation, cornerRadiusOut, flipX, flipY), strokeWidth * pixelDensity, applyOpacity(strokeColor, opacity), true);\n        }\n    };\n    const drawEllipse = (center, rx, ry, rotation, flipX, flipY, backgroundColor, backgroundImage, strokeWidth, strokeColor, opacity, inverted) => {\n        let rectOut = rectMultiply(rectCreate(center.x - rx, center.y - ry, rx * 2, ry * 2), pixelDensity);\n        if (backgroundColor || backgroundImage) {\n            // adjust for edge anti-aliasing, if we don't do this the\n            // visible rectangle will be 1 pixel smaller than the actual rectangle\n            const rectFill = rectClone(rectOut);\n            rectFill.x -= 0.5;\n            rectFill.y -= 0.5;\n            rectFill.width += 1.0;\n            rectFill.height += 1.0;\n            const points = createRectPoints(rectFill, rotation, flipX, flipY);\n            const vertices = rectPointsToVertices(points);\n            fillEllipse(vertices, rectFill.width, rectFill.height, applyOpacity(backgroundColor, opacity), backgroundImage, opacity, inverted);\n        }\n        if (strokeWidth)\n            strokePath(\n            // rect out is already multiplied by pixeldensity\n            createEllipseOutline(rectOut.x, rectOut.y, rectOut.width, rectOut.height, rotation, flipX, flipY), strokeWidth * pixelDensity, applyOpacity(strokeColor, opacity), true);\n    };\n    //#endregion\n    return {\n        // draw api\n        drawPath,\n        drawTriangle,\n        drawRect,\n        drawEllipse,\n        drawPreviewImage,\n        setCanvasColor(color) {\n            canvasColor = color;\n        },\n        drawToCanvas() {\n            gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n            // switch transform matrix\n            markupMatrix = markupMatrixCanvas;\n            // tell webgl about the viewport\n            gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n            // black (or other color depending on background)\n            gl.colorMask(true, true, true, false);\n            gl.clearColor(canvasColor[0], canvasColor[1], canvasColor[2], 1);\n            // gl.clearColor(0.25, 0.25, 0.25, 1); // for debugging\n            gl.clear(gl.COLOR_BUFFER_BIT);\n        },\n        drawToFramebuffer() {\n            // is twice as big as the loaded image\n            gl.bindFramebuffer(gl.FRAMEBUFFER, fb);\n            // switch transform matrix\n            markupMatrix = markupMatrixFrameBuffer;\n            // tell webgl about the \"viewport\"\n            gl.viewport(0, 0, imageData.width, imageData.height);\n            // always transparent\n            gl.colorMask(true, true, true, true);\n            gl.clearColor(0, 0, 0, 0);\n            gl.clear(gl.COLOR_BUFFER_BIT);\n        },\n        // texture management\n        addTexture,\n        setTexture,\n        reserveTexture,\n        removeTexture,\n        getTextureSize,\n        getAvailableTextureIndex,\n        // set mask\n        enableMask(rect, opacity) {\n            const maskX = rect.x * viewPixelDensity;\n            const maskY = rect.y * viewPixelDensity;\n            const maskWidth = rect.width * viewPixelDensity;\n            const maskHeight = rect.height * viewPixelDensity;\n            maskLeft = maskX;\n            maskRight = maskLeft + maskWidth;\n            maskTop = viewSize.height - maskY;\n            maskBottom = viewSize.height - (maskY + maskHeight);\n            maskOpacity = 1.0 - opacity;\n            maskBounds = [maskTop, maskRight, maskBottom, maskLeft];\n        },\n        disableMask() {\n            maskLeft = 0;\n            maskRight = viewSize.width;\n            maskTop = viewSize.height;\n            maskBottom = 0;\n            maskOpacity = 1;\n            maskBounds = [maskTop, maskRight, maskBottom, maskLeft];\n        },\n        // canvas\n        resize,\n        release() {\n            canvas.width = 1;\n            canvas.height = 1;\n        },\n    };\n};\n\n/* src/core/ui/components/Canvas.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment(ctx) {\n\tlet div;\n\tlet canvas_1;\n\tlet measurable_action;\n\tlet mounted;\n\tlet dispose;\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcanvas_1 = element(\"canvas\");\n\t\t\tattr(div, \"class\", \"DokaCanvas\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tappend(div, canvas_1);\n\t\t\t/*canvas_1_binding*/ ctx[15](canvas_1);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(canvas_1, \"measure\", /*handleSizeChange*/ ctx[4]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, canvas_1))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp: noop$1,\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\t/*canvas_1_binding*/ ctx[15](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance($$self, $$props, $$invalidate) {\n\tlet $imageMain;\n\tlet $background;\n\tlet $mask;\n\tconst dispatch = createEventDispatcher();\n\n\t// fallback matrix\n\tconst COLOR_MATRIX_IDENTITY = [1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0];\n\n\tlet { animate } = $$props;\n\tlet { imageData } = $$props;\n\tlet { imageSize } = $$props;\n\tlet { imageProps } = $$props;\n\tlet { imagePreviews = [] } = $$props;\n\tlet { maskRect } = $$props;\n\tlet { pixelRatio = 1 } = $$props;\n\tlet { willRender = passthrough } = $$props;\n\tlet { loadImageData = passthrough } = $$props;\n\tlet { backgroundColor } = $$props;\n\n\t//\n\t// springyness for main preview\n\t//\n\tconst updateSpring = (spring, value) => spring.set(value, { hard: !animate });\n\n\tconst blendWithCanvasBackground = (back, front) => {\n\t\tconst [bR, bG, bB] = back;\n\t\tconst [fR, fG, fB, fA] = front;\n\t\treturn [fR * fA + bR * (1 - fA), fG * fA + bG * (1 - fA), fB * fA + bB * (1 - fA), 1];\n\t};\n\n\tconst SPRING_PROPS = { precision: 0.0001 };\n\tconst SPRING_PROPS_FRACTION = { precision: SPRING_PROPS.precision * 0.01 };\n\tconst background = tweened(undefined, { duration: 250 });\n\tcomponent_subscribe($$self, background, value => $$invalidate(22, $background = value));\n\tconst translation = spring(undefined, SPRING_PROPS);\n\tconst rotation = spring(undefined, SPRING_PROPS_FRACTION);\n\tconst origin = spring(undefined, SPRING_PROPS);\n\tconst perspective = spring(undefined, SPRING_PROPS_FRACTION);\n\tconst scale = spring(undefined, SPRING_PROPS_FRACTION);\n\tconst gamma = spring(undefined, SPRING_PROPS_FRACTION);\n\tconst vignette = spring(undefined, SPRING_PROPS_FRACTION);\n\tconst colorMatrix = spring([...COLOR_MATRIX_IDENTITY], SPRING_PROPS);\n\tconst clarity = writable(undefined);\n\tconst opacity = spring(0, SPRING_PROPS_FRACTION);\n\tconst maskOpacity = spring(1, SPRING_PROPS_FRACTION);\n\tconst mask = writable();\n\tcomponent_subscribe($$self, mask, value => $$invalidate(24, $mask = value));\n\tconst imageBackgroundColor = writable();\n\n\tconst imageMain = derived(\n\t\t[\n\t\t\torigin,\n\t\t\ttranslation,\n\t\t\tperspective,\n\t\t\trotation,\n\t\t\tscale,\n\t\t\topacity,\n\t\t\tcolorMatrix,\n\t\t\tmask,\n\t\t\tmaskOpacity,\n\t\t\tclarity,\n\t\t\tgamma,\n\t\t\tvignette,\n\t\t\timageBackgroundColor,\n\t\t\tbackground\n\t\t],\n\t\t([\n\t\t\t\t$origin,\n\t\t\t\t$translation,\n\t\t\t\t$perspective,\n\t\t\t\t$rotation,\n\t\t\t\t$scale,\n\t\t\t\t$opacity,\n\t\t\t\t$colorMatrix,\n\t\t\t\t$mask,\n\t\t\t\t$maskOpacity,\n\t\t\t\t$clarity,\n\t\t\t\t$gamma,\n\t\t\t\t$vignette,\n\t\t\t\t$imageBackgroundColor,\n\t\t\t\t$background\n\t\t\t], set) => {\n\t\t\tif (!imageProps || !$background) return set(undefined);\n\t\t\tconst maskOpacityClamped = clamp($maskOpacity, 0, 1);\n\n\t\t\tset({\n\t\t\t\torigin: $origin,\n\t\t\t\ttranslation: $translation,\n\t\t\t\tperspective: $perspective,\n\t\t\t\trotation: $rotation,\n\t\t\t\tscale: $scale,\n\t\t\t\tcolorMatrix: $colorMatrix,\n\t\t\t\topacity: clamp($opacity, 0, 1),\n\t\t\t\tclarity: $clarity,\n\t\t\t\tgamma: $gamma,\n\t\t\t\tvignette: $vignette,\n\t\t\t\tmask: $mask,\n\t\t\t\tmaskOpacity: maskOpacityClamped,\n\t\t\t\toverlayColor: [$background[0], $background[1], $background[2], maskOpacityClamped],\n\t\t\t\tbackgroundColor: $imageBackgroundColor\n\t\t\t});\n\t\t}\n\t);\n\n\tcomponent_subscribe($$self, imageMain, value => $$invalidate(21, $imageMain = value));\n\n\t//\n\t// rendering\n\t//\n\tlet canvas;\n\n\tlet webGLImageDrawer = null;\n\tlet width = null;\n\tlet height = null;\n\n\tconst drawPreviewImage = ({ origin, translation, rotation, scale, colorMatrix, opacity, clarity, gamma, vignette, offset, maskFeather, maskCornerRadius, backgroundColor, overlayColor, enableShapes }) => {\n\t\tlet tx = translation.x;\n\t\tlet ty = translation.y;\n\n\t\tif (offset) {\n\t\t\ttx += offset.x - width * 0.5;\n\t\t\tty += offset.y - height * 0.5;\n\t\t}\n\n\t\t// calculate opaque backgroundColor if is background color is transparent and visible\n\t\tif (backgroundColor[3] < 1 && backgroundColor[3] > 0) {\n\t\t\tbackgroundColor = blendWithCanvasBackground($background, backgroundColor);\n\t\t}\n\n\t\twebGLImageDrawer.drawPreviewImage(origin.x, origin.y, tx, ty, rotation.x, rotation.y, rotation.z, scale, colorMatrix || COLOR_MATRIX_IDENTITY, opacity, clarity, gamma, vignette, maskFeather, maskCornerRadius, backgroundColor, overlayColor, enableShapes);\n\t};\n\n\t// shape texture cache\n\tconst TextureUnits = new Map([]);\n\n\tconst getShapeImageTexture = ({ backgroundImage }) => {\n\t\t// get texture unit assigned to this image\n\t\tlet texture = TextureUnits.get(backgroundImage);\n\n\t\t// texture already available, we done\n\t\tif (texture) return texture;\n\n\t\t// reserve texture unit\n\t\ttexture = webGLImageDrawer.getAvailableTextureIndex();\n\n\t\twebGLImageDrawer.reserveTexture(texture);\n\n\t\t// this background is now available in this texture unit\n\t\tTextureUnits.set(backgroundImage, texture);\n\n\t\t// load the new background image data\n\t\tloadImageData(backgroundImage).then(imageData => {\n\t\t\t// create new texture\n\t\t\twebGLImageDrawer.setTexture(texture, imageData);\n\n\t\t\t// need to redraw because texture is now available\n\t\t\trequestAnimationFrame(drawUpdate);\n\t\t}).catch(err => {\n\t\t\tconsole.error(err);\n\t\t});\n\n\t\treturn texture;\n\t};\n\n\tconst TEXT_MEASURE_CONTEXT = createSimpleContext();\n\n\tconst getShapeTextTexture = shape => {\n\t\tlet { text, textAlign, fontFamily, fontSize, fontWeight, fontVariant, fontStyle, lineHeight, width } = shape;\n\n\t\t// we need this context to correctly wrap text\n\t\tupdateTextContext(TEXT_MEASURE_CONTEXT, {\n\t\t\tfontSize,\n\t\t\tfontFamily,\n\t\t\tfontWeight,\n\t\t\tfontVariant,\n\t\t\tfontStyle,\n\t\t\ttextAlign\n\t\t});\n\n\t\t// wrap the text\n\t\tconst textString = width\n\t\t? wrapText(TEXT_MEASURE_CONTEXT, text, width)\n\t\t: text;\n\n\t\t// create UID for this texture so we can cache it and fetch it later on\n\t\tconst textUID = shapeTextUID({ ...shape, text: textString });\n\n\t\t// get texture unit assigned to this specific text shape\n\t\tlet texture = TextureUnits.get(textUID);\n\n\t\tif (texture) return texture;\n\n\t\t// we need to create a new texture\n\t\tconst ctx = createSimpleContext();\n\n\t\tupdateTextContext(ctx, {\n\t\t\tfontSize,\n\t\t\tfontFamily,\n\t\t\tfontWeight,\n\t\t\tfontVariant,\n\t\t\tfontStyle,\n\t\t\ttextAlign\n\t\t});\n\n\t\t// calculate canvas height\n\t\tresizeContextToFitText(ctx, textString, {\n\t\t\tfontSize,\n\t\t\tfontFamily,\n\t\t\tfontWeight,\n\t\t\tfontVariant,\n\t\t\tfontStyle,\n\t\t\ttextAlign,\n\t\t\tlineHeight\n\t\t});\n\n\t\tconst contextMinWidth = ctx.canvas.width;\n\n\t\t// scale context to account for italic styles\n\t\tctx.canvas.width += textPadding;\n\n\t\t// context resized, we now need to re-apply style\n\t\tupdateTextContext(ctx, {\n\t\t\tfontSize,\n\t\t\tfontFamily,\n\t\t\tfontWeight,\n\t\t\tfontVariant,\n\t\t\tfontStyle,\n\t\t\ttextAlign,\n\t\t\tcolor: [1, 0, 1], // color we'll replace in the shader\n\t\t\t\n\t\t});\n\n\t\t// if so, draw text and update texture\n\t\tdrawText(ctx, textString, {\n\t\t\tfontSize,\n\t\t\ttextAlign,\n\t\t\tlineHeight,\n\t\t\tlineWidth: contextMinWidth\n\t\t});\n\n\t\t// TODO: Create power of 2 texture and update texture instead of delete -> replace\n\t\t// add this texture\n\t\ttexture = webGLImageDrawer.addTexture(ctx.canvas);\n\n\t\t// Store reference to the texture\n\t\tTextureUnits.set(textUID, texture);\n\n\t\treturn texture;\n\t};\n\n\tconst getShapeTexture = shape => {\n\t\tlet texture;\n\n\t\t// let's create textures for backgrounds and texts\n\t\tif (shape.backgroundImage) {\n\t\t\ttexture = getShapeImageTexture(shape);\n\t\t} else if (isString(shape.text)) {\n\t\t\tif (shape.width && shape.width < 1 || shape.height && shape.height < 1) return undefined;\n\t\t\ttexture = getShapeTextTexture(shape);\n\t\t}\n\n\t\treturn texture;\n\t};\n\n\tconst drawShapes = (shapes = []) => shapes.map(shape => {\n\t\tlet texture = getShapeTexture(shape);\n\n\t\tif (isArray(shape.points)) {\n\t\t\t// is triangle\n\t\t\tif (shape.points.length === 3 && shape.backgroundColor) {\n\t\t\t\twebGLImageDrawer.drawTriangle(shape.points, shape.rotation, shape.flipX, shape.flipY, shape.backgroundColor, shape.strokeWidth, shape.strokeColor, shape.opacity);\n\t\t\t} else // is normal path\n\t\t\t{\n\t\t\t\twebGLImageDrawer.drawPath(shape.points, shape.strokeWidth, shape.strokeColor, shape.opacity);\n\t\t\t}\n\t\t} else // is ellipse \n\t\tif (isNumber(shape.rx)) {\n\t\t\twebGLImageDrawer.drawEllipse(shape, shape.rx, shape.ry, shape.rotation, shape.flipX, shape.flipY, shape.backgroundColor, texture, shape.strokeWidth, shape.strokeColor, shape.opacity, shape.inverted);\n\t\t} else // is rect\n\t\tif (isString(shape.text) && texture || shape.width) {\n\t\t\tconst textureSize = texture && webGLImageDrawer.getTextureSize(texture);\n\t\t\tlet colorize = undefined;\n\t\t\tlet shapeRect;\n\n\t\t\tlet shapeCornerRadius = [\n\t\t\t\tshape.cornerRadius,\n\t\t\t\tshape.cornerRadius,\n\t\t\t\tshape.cornerRadius,\n\t\t\t\tshape.cornerRadius\n\t\t\t];\n\n\t\t\tif (shape.width) {\n\t\t\t\tshapeRect = shape;\n\t\t\t} else {\n\t\t\t\tshapeRect = { x: shape.x, y: shape.y, ...textureSize };\n\t\t\t}\n\n\t\t\tlet backgroundSize;\n\t\t\tlet backgroundPosition;\n\n\t\t\tif (textureSize) {\n\t\t\t\t// background should be scaled\n\t\t\t\tif (shape.backgroundImage && shape.backgroundSize) {\n\t\t\t\t\t// always respect texture aspect ratio\n\t\t\t\t\tconst textureAspectRatio = getAspectRatio(textureSize.width, textureSize.height);\n\n\t\t\t\t\t// adjust position of background\n\t\t\t\t\tif (shape.backgroundSize === \"contain\") {\n\t\t\t\t\t\tconst rect = rectContainRect(shape, textureAspectRatio, shapeRect);\n\t\t\t\t\t\tbackgroundSize = sizeCreateFromRect(rect);\n\t\t\t\t\t\tbackgroundPosition = vectorCreate((shape.width - backgroundSize.width) * 0.5, (shape.height - backgroundSize.height) * 0.5);\n\t\t\t\t\t} else if (shape.backgroundSize === \"cover\") {\n\t\t\t\t\t\tconst rect = rectCoverRect(shape, textureAspectRatio, shapeRect);\n\t\t\t\t\t\tbackgroundSize = sizeCreateFromRect(rect);\n\t\t\t\t\t\tbackgroundPosition = vectorCreate(rect.x, rect.y);\n\t\t\t\t\t\tbackgroundPosition = vectorCreate((shape.width - backgroundSize.width) * 0.5, (shape.height - backgroundSize.height) * 0.5);\n\t\t\t\t\t}\n\t\t\t\t} else // is text, \"background\" should be texture size and be positioned based on alignment\n\t\t\t\tif (shape.text && shape.width) {\n\t\t\t\t\t// position texture based on text alignment\n\t\t\t\t\tbackgroundSize = textureSize;\n\n\t\t\t\t\tbackgroundPosition = vectorCreate(0, 0);\n\n\t\t\t\t\t// auto height\n\t\t\t\t\tif (!shape.height) shape.height = textureSize.height;\n\n\t\t\t\t\t// textPadding so text doesn't clip on left and right edges\n\t\t\t\t\tshape.x -= textPadding;\n\n\t\t\t\t\tshape.width += textPadding * 2;\n\n\t\t\t\t\tif (shape.textAlign === \"left\") {\n\t\t\t\t\t\tbackgroundPosition.x = textPadding;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (shape.textAlign === \"center\") {\n\t\t\t\t\t\tbackgroundPosition.x = textPadding * 0.5 + (shape.width - textureSize.width) * 0.5;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (shape.textAlign === \"right\") {\n\t\t\t\t\t\tbackgroundPosition.x = shape.width - textureSize.width;\n\t\t\t\t\t}\n\t\t\t\t} else if (shape.text) {\n\t\t\t\t\tbackgroundPosition = vectorCreate(0, 0);\n\n\t\t\t\t\tbackgroundSize = {\n\t\t\t\t\t\twidth: shapeRect.width,\n\t\t\t\t\t\theight: shapeRect.height\n\t\t\t\t\t};\n\n\t\t\t\t\t// texture is slightly larger because of text padding, need to compensate for this in single line mode\n\t\t\t\t\tshapeRect.width -= textPadding;\n\t\t\t\t}\n\n\t\t\t\tif (shape.text) colorize = shape.color;\n\t\t\t}\n\n\t\t\twebGLImageDrawer.drawRect(shapeRect, shape.rotation, shape.flipX, shape.flipY, shapeCornerRadius, shape.backgroundColor, texture, backgroundSize, backgroundPosition, shape.strokeWidth, shape.strokeColor, shape.opacity, undefined, colorize);\n\t\t}\n\n\t\treturn texture ? [shape.id, texture] : undefined;\n\t}).filter(Boolean);\n\n\t// redraws state\n\tconst redraw = () => {\n\t\t// allow dev to inject more shapes\n\t\tconst canvas = willRender({\n\t\t\topacity: $imageMain.opacity, // opacity of main image, can be used to change opacity of other elements\n\t\t\trotation: $imageMain.rotation,\n\t\t\tscale: $imageMain.scale,\n\t\t\tsize: canvasSize,\n\t\t\tbackgroundColor: [...$background]\n\t\t});\n\n\t\tcanvas.backgroundColor = [...$background];\n\t\tcanvas.image = $imageMain;\n\t\tcanvas.imageMask = $imageMain.mask;\n\t\tcanvas.imageMaskOpacity = $imageMain.maskOpacity;\n\t\tcanvas.imagePreviews = imagePreviews;\n\n\t\t// no need to draw to framebuffer is no annotations\n\t\tconst hasAnnotations = canvas.annotationShapes.length > 0;\n\n\t\t// if image has background color\n\t\tconst hasImageBackgroundColor = $imageMain.backgroundColor[3] > 0;\n\n\t\t// if the overlay is transparent so we can see the canvas\n\t\tconst hasTransparentOverlay = $imageMain.maskOpacity < 1;\n\n\t\t// array of textures used in this draw call\n\t\tconst usedTextures = [];\n\n\t\t// set canvas background color to image background color if is defined\n\t\tif (hasTransparentOverlay && hasImageBackgroundColor) {\n\t\t\tconst backR = canvas.backgroundColor[0];\n\t\t\tconst backG = canvas.backgroundColor[1];\n\t\t\tconst backB = canvas.backgroundColor[2];\n\t\t\tconst frontA = 1 - $imageMain.maskOpacity;\n\t\t\tconst frontR = $imageMain.backgroundColor[0] * frontA;\n\t\t\tconst frontG = $imageMain.backgroundColor[1] * frontA;\n\t\t\tconst frontB = $imageMain.backgroundColor[2] * frontA;\n\t\t\tconst fA = 1 - frontA;\n\t\t\tcanvas.backgroundColor = [frontR + backR * fA, frontG + backG * fA, frontB + backB * fA, 1];\n\t\t}\n\n\t\twebGLImageDrawer.setCanvasColor(canvas.backgroundColor);\n\n\t\t// if has annotations draw annotation shapes to framebuffer\n\t\t// TODO: only run this if annotations have changed\n\t\tif (hasAnnotations) {\n\t\t\twebGLImageDrawer.disableMask();\n\t\t\twebGLImageDrawer.drawToFramebuffer();\n\t\t\tusedTextures.push(...drawShapes(canvas.annotationShapes));\n\t\t}\n\n\t\t// switch to canvas drawing for other elements\n\t\twebGLImageDrawer.drawToCanvas();\n\n\t\twebGLImageDrawer.enableMask(canvas.imageMask, canvas.imageMaskOpacity);\n\n\t\t// draw a colored rectangle behind main preview image\n\t\tif (hasImageBackgroundColor) {\n\t\t\twebGLImageDrawer.drawRect($mask, 0, false, false, [0, 0, 0, 0], blendWithCanvasBackground($background, $imageMain.backgroundColor));\n\t\t}\n\n\t\t// draw main preview image\n\t\tcanvas.image.enableShapes = hasAnnotations;\n\n\t\tdrawPreviewImage(canvas.image);\n\n\t\t// TODO: move vignette here (draw with colorized circular gradient texture instead of in shader)\n\t\t// draw decorations shapes relative to crop\n\t\tusedTextures.push(...drawShapes(canvas.decorationShapes));\n\n\t\t// crop mask not used for interface\n\t\twebGLImageDrawer.disableMask();\n\n\t\t// draw custom interface shapes\n\t\tusedTextures.push(...drawShapes(canvas.interfaceShapes));\n\n\t\tcanvas.imagePreviews.forEach(image => {\n\t\t\twebGLImageDrawer.enableMask(image.mask, image.maskOpacity);\n\n\t\t\t// draw background fill\n\t\t\tif (hasImageBackgroundColor) {\n\t\t\t\twebGLImageDrawer.drawRect(image.mask, 0, false, false, image.maskCornerRadius, $imageMain.backgroundColor, undefined, undefined, undefined, undefined, undefined, image.opacity, image.maskFeather);\n\t\t\t}\n\n\t\t\tdrawPreviewImage({\n\t\t\t\t...image,\n\t\t\t\tbackgroundColor: $imageMain.backgroundColor,\n\t\t\t\toverlayColor: [0, 0, 0, 0],\n\t\t\t\tenableShapes: false\n\t\t\t});\n\t\t});\n\n\t\twebGLImageDrawer.disableMask();\n\n\t\t// determine which textures can be dropped\n\t\tTextureUnits.forEach((registeredTextureUnit, key, map) => {\n\t\t\tconst isUsed = !!usedTextures.find(([id, usedTextureUnit]) => usedTextureUnit === registeredTextureUnit);\n\n\t\t\t// stil used, no need to release\n\t\t\tif (isUsed) return;\n\n\t\t\t// remove this texture\n\t\t\tTextureUnits.delete(key);\n\n\t\t\twebGLImageDrawer.removeTexture(registeredTextureUnit);\n\t\t});\n\t};\n\n\t//\n\t// events\n\t//\n\t// auto update when size changes\n\tconst handleSizeChange = e => {\n\t\t$$invalidate(17, width = e.detail.width);\n\t\t$$invalidate(18, height = e.detail.height);\n\t\tdispatch(\"measure\", { width, height });\n\t};\n\n\t//\n\t// hooks\n\t//\n\t// after DOM has been altered, draw to canvas\n\tafterUpdate(() => drawUpdate());\n\n\t// hook up canvas and image\n\tonMount(() => $$invalidate(16, webGLImageDrawer = createGLImageDrawer(canvas, imageData, imageSize, pixelRatio)));\n\n\t// clean up canvas\n\tonDestroy(() => {\n\t\t// if canvas wasn't created we don't need to release it\n\t\tif (!webGLImageDrawer) return;\n\n\t\t// done drawing\n\t\twebGLImageDrawer.release();\n\n\t\t// force release canvas for Safari\n\t\treleaseCanvas(TEXT_MEASURE_CONTEXT.canvas);\n\t});\n\n\tfunction canvas_1_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tcanvas = $$value;\n\t\t\t$$invalidate(0, canvas);\n\t\t});\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"animate\" in $$props) $$invalidate(5, animate = $$props.animate);\n\t\tif (\"imageData\" in $$props) $$invalidate(6, imageData = $$props.imageData);\n\t\tif (\"imageSize\" in $$props) $$invalidate(7, imageSize = $$props.imageSize);\n\t\tif (\"imageProps\" in $$props) $$invalidate(8, imageProps = $$props.imageProps);\n\t\tif (\"imagePreviews\" in $$props) $$invalidate(9, imagePreviews = $$props.imagePreviews);\n\t\tif (\"maskRect\" in $$props) $$invalidate(10, maskRect = $$props.maskRect);\n\t\tif (\"pixelRatio\" in $$props) $$invalidate(11, pixelRatio = $$props.pixelRatio);\n\t\tif (\"willRender\" in $$props) $$invalidate(12, willRender = $$props.willRender);\n\t\tif (\"loadImageData\" in $$props) $$invalidate(13, loadImageData = $$props.loadImageData);\n\t\tif (\"backgroundColor\" in $$props) $$invalidate(14, backgroundColor = $$props.backgroundColor);\n\t};\n\n\tlet canvasSize;\n\tlet canDraw;\n\tlet drawUpdate;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*backgroundColor*/ 16384) {\n\t\t\t// canvas style\n\t\t\t backgroundColor && updateSpring(background, backgroundColor);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t// image transforms\n\t\t\t imageProps && updateSpring(origin, imageProps.origin);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && updateSpring(translation, imageProps.translation);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && updateSpring(perspective, imageProps.perspective);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && updateSpring(rotation, imageProps.rotation);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && updateSpring(scale, imageProps.scale);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && updateSpring(colorMatrix, imageProps.colorMatrix || [...COLOR_MATRIX_IDENTITY]);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && updateSpring(vignette, imageProps.vignette || 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && updateSpring(gamma, imageProps.gamma || 1);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && clarity.set(imageProps.convolutionMatrix && imageProps.convolutionMatrix.clarity || undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t// image ui style\n\t\t\t imageProps && updateSpring(opacity, 1);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && updateSpring(maskOpacity, isNumber(imageProps.maskOpacity)\n\t\t\t? imageProps.maskOpacity\n\t\t\t: 1);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*maskRect*/ 1024) {\n\t\t\t maskRect && mask.set(maskRect);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageProps*/ 256) {\n\t\t\t imageProps && imageBackgroundColor.set(imageProps.backgroundColor);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*width, height*/ 393216) {\n\t\t\t// canvas size\n\t\t\t canvasSize = { width, height };\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*webGLImageDrawer, width, height, $imageMain*/ 2555904) {\n\t\t\t// can draw view\n\t\t\t $$invalidate(20, canDraw = webGLImageDrawer && width && height && $imageMain);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*width, height, webGLImageDrawer, pixelRatio*/ 460800) {\n\t\t\t// observe width and height changes and resize the canvas proportionally\n\t\t\t width && height && webGLImageDrawer && webGLImageDrawer.resize(width, height, pixelRatio);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*canDraw*/ 1048576) {\n\t\t\t// switch to draw method when can draw\n\t\t\t drawUpdate = canDraw ? redraw : noop;\n\t\t}\n\t};\n\n\treturn [\n\t\tcanvas,\n\t\tbackground,\n\t\tmask,\n\t\timageMain,\n\t\thandleSizeChange,\n\t\tanimate,\n\t\timageData,\n\t\timageSize,\n\t\timageProps,\n\t\timagePreviews,\n\t\tmaskRect,\n\t\tpixelRatio,\n\t\twillRender,\n\t\tloadImageData,\n\t\tbackgroundColor,\n\t\tcanvas_1_binding\n\t];\n}\n\nclass Canvas extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance,\n\t\t\tcreate_fragment,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tanimate: 5,\n\t\t\t\timageData: 6,\n\t\t\t\timageSize: 7,\n\t\t\t\timageProps: 8,\n\t\t\t\timagePreviews: 9,\n\t\t\t\tmaskRect: 10,\n\t\t\t\tpixelRatio: 11,\n\t\t\t\twillRender: 12,\n\t\t\t\tloadImageData: 13,\n\t\t\t\tbackgroundColor: 14\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n}\n\nvar arrayJoin = (arr, filter = Boolean, str = ' ') => arr.filter(filter).join(str);\n\n/* src/core/ui/components/TabList.svelte generated by Svelte v3.29.4 */\nconst get_default_slot_changes = dirty => ({ tab: dirty & /*tabNodes*/ 8 });\nconst get_default_slot_context = ctx => ({ tab: /*tab*/ ctx[16] });\n\nfunction get_each_context(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[16] = list[i];\n\treturn child_ctx;\n}\n\n// (72:4) {#each tabNodes as tab (tab.id) }\nfunction create_each_block(key_1, ctx) {\n\tlet li;\n\tlet button;\n\tlet button_aria_controls_value;\n\tlet button_id_value;\n\tlet button_aria_selected_value;\n\tlet button_disabled_value;\n\tlet t;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tconst default_slot_template = /*#slots*/ ctx[10].default;\n\tconst default_slot = create_slot(default_slot_template, ctx, /*$$scope*/ ctx[9], get_default_slot_context);\n\n\tfunction keydown_handler(...args) {\n\t\treturn /*keydown_handler*/ ctx[11](/*tab*/ ctx[16], ...args);\n\t}\n\n\tfunction click_handler(...args) {\n\t\treturn /*click_handler*/ ctx[12](/*tab*/ ctx[16], ...args);\n\t}\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tli = element(\"li\");\n\t\t\tbutton = element(\"button\");\n\t\t\tif (default_slot) default_slot.c();\n\t\t\tt = space();\n\t\t\tattr(button, \"role\", \"tab\");\n\t\t\tattr(button, \"aria-controls\", button_aria_controls_value = /*tab*/ ctx[16].href);\n\t\t\tattr(button, \"id\", button_id_value = /*tab*/ ctx[16].tabId);\n\t\t\tattr(button, \"aria-selected\", button_aria_selected_value = /*tab*/ ctx[16].selected);\n\t\t\tbutton.disabled = button_disabled_value = /*tab*/ ctx[16].disabled;\n\t\t\tthis.first = li;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, li, anchor);\n\t\t\tappend(li, button);\n\n\t\t\tif (default_slot) {\n\t\t\t\tdefault_slot.m(button, null);\n\t\t\t}\n\n\t\t\tappend(li, t);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(button, \"keydown\", keydown_handler),\n\t\t\t\t\tlisten(button, \"click\", click_handler)\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\n\t\t\tif (default_slot) {\n\t\t\t\tif (default_slot.p && dirty & /*$$scope, tabNodes*/ 520) {\n\t\t\t\t\tupdate_slot(default_slot, default_slot_template, ctx, /*$$scope*/ ctx[9], dirty, get_default_slot_changes, get_default_slot_context);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*tabNodes*/ 8 && button_aria_controls_value !== (button_aria_controls_value = /*tab*/ ctx[16].href)) {\n\t\t\t\tattr(button, \"aria-controls\", button_aria_controls_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*tabNodes*/ 8 && button_id_value !== (button_id_value = /*tab*/ ctx[16].tabId)) {\n\t\t\t\tattr(button, \"id\", button_id_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*tabNodes*/ 8 && button_aria_selected_value !== (button_aria_selected_value = /*tab*/ ctx[16].selected)) {\n\t\t\t\tattr(button, \"aria-selected\", button_aria_selected_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*tabNodes*/ 8 && button_disabled_value !== (button_disabled_value = /*tab*/ ctx[16].disabled)) {\n\t\t\t\tbutton.disabled = button_disabled_value;\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(default_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(default_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(li);\n\t\t\tif (default_slot) default_slot.d(detaching);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction create_fragment$1(ctx) {\n\tlet ul;\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet ul_class_value;\n\tlet current;\n\tlet each_value = /*tabNodes*/ ctx[3];\n\tconst get_key = ctx => /*tab*/ ctx[16].id;\n\n\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\tlet child_ctx = get_each_context(ctx, each_value, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block(key, child_ctx));\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tul = element(\"ul\");\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\tattr(ul, \"class\", ul_class_value = arrayJoin([\"DokaTabList\", /*klass*/ ctx[0]]));\n\t\t\tattr(ul, \"role\", \"tablist\");\n\t\t\tattr(ul, \"data-layout\", /*layout*/ ctx[1]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, ul, anchor);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(ul, null);\n\t\t\t}\n\n\t\t\t/*ul_binding*/ ctx[13](ul);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*tabNodes, handleKeyTab, handleClickTab, $$scope*/ 568) {\n\t\t\t\tconst each_value = /*tabNodes*/ ctx[3];\n\t\t\t\tgroup_outros();\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value, each_1_lookup, ul, outro_and_destroy_block, create_each_block, null, get_each_context);\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*klass*/ 1 && ul_class_value !== (ul_class_value = arrayJoin([\"DokaTabList\", /*klass*/ ctx[0]]))) {\n\t\t\t\tattr(ul, \"class\", ul_class_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*layout*/ 2) {\n\t\t\t\tattr(ul, \"data-layout\", /*layout*/ ctx[1]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\n\t\t\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\t\t\ttransition_in(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\ttransition_out(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(ul);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d();\n\t\t\t}\n\n\t\t\t/*ul_binding*/ ctx[13](null);\n\t\t}\n\t};\n}\n\nfunction instance$1($$self, $$props, $$invalidate) {\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tlet root;\n\tlet { class: klass = undefined } = $$props;\n\tlet { name } = $$props;\n\tlet { selected } = $$props;\n\tlet { tabs = [] } = $$props;\n\tlet { layout = undefined } = $$props;\n\tconst dispatch = createEventDispatcher();\n\n\tconst focusTab = index => {\n\t\tconst tab = root.querySelectorAll(\"button[role=\\\"tab\\\"]\")[index];\n\t\tif (!tab) return;\n\t\ttab.focus();\n\t};\n\n\tconst handleClickTab = (e, id) => {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\tdispatch(\"select\", id);\n\t};\n\n\tconst handleKeyTab = ({ key }, id) => {\n\t\tif (!(/arrow/i).test(key)) return;\n\t\tconst index = tabs.findIndex(tab => tab.id === id);\n\n\t\t// next\n\t\tif ((/right|down/i).test(key)) return focusTab(index < tabs.length - 1 ? index + 1 : 0);\n\n\t\t// prev\n\t\tif ((/left|up/i).test(key)) return focusTab(index > 0 ? index - 1 : tabs.length - 1);\n\t};\n\n\tconst keydown_handler = (tab, e) => handleKeyTab(e, tab.id);\n\tconst click_handler = (tab, e) => handleClickTab(e, tab.id);\n\n\tfunction ul_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\troot = $$value;\n\t\t\t$$invalidate(2, root);\n\t\t});\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"class\" in $$props) $$invalidate(0, klass = $$props.class);\n\t\tif (\"name\" in $$props) $$invalidate(6, name = $$props.name);\n\t\tif (\"selected\" in $$props) $$invalidate(7, selected = $$props.selected);\n\t\tif (\"tabs\" in $$props) $$invalidate(8, tabs = $$props.tabs);\n\t\tif (\"layout\" in $$props) $$invalidate(1, layout = $$props.layout);\n\t\tif (\"$$scope\" in $$props) $$invalidate(9, $$scope = $$props.$$scope);\n\t};\n\n\tlet tabNodes;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*tabs, selected, name*/ 448) {\n\t\t\t $$invalidate(3, tabNodes = tabs.map(tab => {\n\t\t\t\tconst isActive = tab.id === selected;\n\n\t\t\t\treturn {\n\t\t\t\t\t...tab,\n\t\t\t\t\ttabId: `doka-tab-${name}-${tab.id}`,\n\t\t\t\t\thref: `#doka-${name}-${tab.id}`,\n\t\t\t\t\tselected: isActive\n\t\t\t\t};\n\t\t\t}));\n\t\t}\n\t};\n\n\treturn [\n\t\tklass,\n\t\tlayout,\n\t\troot,\n\t\ttabNodes,\n\t\thandleClickTab,\n\t\thandleKeyTab,\n\t\tname,\n\t\tselected,\n\t\ttabs,\n\t\t$$scope,\n\t\tslots,\n\t\tkeydown_handler,\n\t\tclick_handler,\n\t\tul_binding\n\t];\n}\n\nclass TabList extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$1, create_fragment$1, safe_not_equal, {\n\t\t\tclass: 0,\n\t\t\tname: 6,\n\t\t\tselected: 7,\n\t\t\ttabs: 8,\n\t\t\tlayout: 1\n\t\t});\n\t}\n}\n\n/* src/core/ui/components/TabPanels.svelte generated by Svelte v3.29.4 */\n\nconst get_default_slot_changes$1 = dirty => ({\n\tpanel: dirty & /*panelNodes*/ 16,\n\tpanelIsActive: dirty & /*panelNodes*/ 16\n});\n\nconst get_default_slot_context$1 = ctx => ({\n\tpanel: /*id*/ ctx[11],\n\tpanelIsActive: !/*hidden*/ ctx[15]\n});\n\nfunction get_each_context$1(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[11] = list[i].id;\n\tchild_ctx[12] = list[i].panelId;\n\tchild_ctx[13] = list[i].tabindex;\n\tchild_ctx[14] = list[i].labelledBy;\n\tchild_ctx[15] = list[i].hidden;\n\tchild_ctx[3] = list[i].visible;\n\treturn child_ctx;\n}\n\n// (61:4) {#each panelNodes as { id, panelId, tabindex, labelledBy, hidden, visible }\nfunction create_each_block$1(key_1, ctx) {\n\tlet div;\n\tlet t;\n\tlet div_class_value;\n\tlet div_hidden_value;\n\tlet div_id_value;\n\tlet div_tabindex_value;\n\tlet div_aria_labelledby_value;\n\tlet div_data_inert_value;\n\tlet current;\n\tconst default_slot_template = /*#slots*/ ctx[9].default;\n\tconst default_slot = create_slot(default_slot_template, ctx, /*$$scope*/ ctx[8], get_default_slot_context$1);\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (default_slot) default_slot.c();\n\t\t\tt = space();\n\t\t\tattr(div, \"class\", div_class_value = arrayJoin([\"DokaTabPanel\", /*panelClass*/ ctx[1]]));\n\t\t\tdiv.hidden = div_hidden_value = /*hidden*/ ctx[15];\n\t\t\tattr(div, \"id\", div_id_value = /*panelId*/ ctx[12]);\n\t\t\tattr(div, \"tabindex\", div_tabindex_value = /*tabindex*/ ctx[13]);\n\t\t\tattr(div, \"aria-labelledby\", div_aria_labelledby_value = /*labelledBy*/ ctx[14]);\n\t\t\tattr(div, \"data-inert\", div_data_inert_value = !/*visible*/ ctx[3]);\n\t\t\tthis.first = div;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (default_slot) {\n\t\t\t\tdefault_slot.m(div, null);\n\t\t\t}\n\n\t\t\tappend(div, t);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (default_slot) {\n\t\t\t\tif (default_slot.p && dirty & /*$$scope, panelNodes*/ 272) {\n\t\t\t\t\tupdate_slot(default_slot, default_slot_template, ctx, /*$$scope*/ ctx[8], dirty, get_default_slot_changes$1, get_default_slot_context$1);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*panelClass*/ 2 && div_class_value !== (div_class_value = arrayJoin([\"DokaTabPanel\", /*panelClass*/ ctx[1]]))) {\n\t\t\t\tattr(div, \"class\", div_class_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*panelNodes*/ 16 && div_hidden_value !== (div_hidden_value = /*hidden*/ ctx[15])) {\n\t\t\t\tdiv.hidden = div_hidden_value;\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*panelNodes*/ 16 && div_id_value !== (div_id_value = /*panelId*/ ctx[12])) {\n\t\t\t\tattr(div, \"id\", div_id_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*panelNodes*/ 16 && div_tabindex_value !== (div_tabindex_value = /*tabindex*/ ctx[13])) {\n\t\t\t\tattr(div, \"tabindex\", div_tabindex_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*panelNodes*/ 16 && div_aria_labelledby_value !== (div_aria_labelledby_value = /*labelledBy*/ ctx[14])) {\n\t\t\t\tattr(div, \"aria-labelledby\", div_aria_labelledby_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*panelNodes*/ 16 && div_data_inert_value !== (div_data_inert_value = !/*visible*/ ctx[3])) {\n\t\t\t\tattr(div, \"data-inert\", div_data_inert_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(default_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(default_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (default_slot) default_slot.d(detaching);\n\t\t}\n\t};\n}\n\nfunction create_fragment$2(ctx) {\n\tlet div;\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet div_class_value;\n\tlet measurable_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tlet each_value = /*panelNodes*/ ctx[4];\n\tconst get_key = ctx => /*id*/ ctx[11];\n\n\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\tlet child_ctx = get_each_context$1(ctx, each_value, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block$1(key, child_ctx));\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\tattr(div, \"class\", div_class_value = arrayJoin([\"DokaTabPanels\", /*klass*/ ctx[0]]));\n\t\t\tattr(div, \"style\", /*style*/ ctx[2]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(div, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div, \"measure\", /*measure_handler*/ ctx[10]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*arrayJoin, panelClass, panelNodes, $$scope*/ 274) {\n\t\t\t\tconst each_value = /*panelNodes*/ ctx[4];\n\t\t\t\tgroup_outros();\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value, each_1_lookup, div, outro_and_destroy_block, create_each_block$1, null, get_each_context$1);\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*klass*/ 1 && div_class_value !== (div_class_value = arrayJoin([\"DokaTabPanels\", /*klass*/ ctx[0]]))) {\n\t\t\t\tattr(div, \"class\", div_class_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*style*/ 4) {\n\t\t\t\tattr(div, \"style\", /*style*/ ctx[2]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\n\t\t\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\t\t\ttransition_in(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\ttransition_out(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d();\n\t\t\t}\n\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance$2($$self, $$props, $$invalidate) {\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tlet { class: klass = undefined } = $$props;\n\tlet { name } = $$props;\n\tlet { selected } = $$props;\n\tlet { visible = undefined } = $$props;\n\tlet { panelClass = undefined } = $$props;\n\tlet { panels = [] } = $$props;\n\tlet { style = undefined } = $$props;\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"class\" in $$props) $$invalidate(0, klass = $$props.class);\n\t\tif (\"name\" in $$props) $$invalidate(5, name = $$props.name);\n\t\tif (\"selected\" in $$props) $$invalidate(6, selected = $$props.selected);\n\t\tif (\"visible\" in $$props) $$invalidate(3, visible = $$props.visible);\n\t\tif (\"panelClass\" in $$props) $$invalidate(1, panelClass = $$props.panelClass);\n\t\tif (\"panels\" in $$props) $$invalidate(7, panels = $$props.panels);\n\t\tif (\"style\" in $$props) $$invalidate(2, style = $$props.style);\n\t\tif (\"$$scope\" in $$props) $$invalidate(8, $$scope = $$props.$$scope);\n\t};\n\n\tlet panelNodes;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*panels, selected, visible, name*/ 232) {\n\t\t\t $$invalidate(4, panelNodes = panels.map(id => {\n\t\t\t\tconst isActive = id === selected;\n\t\t\t\tconst isVisible = visible ? visible.indexOf(id) !== -1 : true;\n\n\t\t\t\treturn {\n\t\t\t\t\tid,\n\t\t\t\t\tpanelId: `doka-${name}_${id}`,\n\t\t\t\t\tlabelledBy: `doka-tab-${name}_${id}`,\n\t\t\t\t\thidden: !isActive,\n\t\t\t\t\tvisible: isVisible,\n\t\t\t\t\ttabindex: isActive ? 0 : -1\n\t\t\t\t};\n\t\t\t}));\n\t\t}\n\t};\n\n\treturn [\n\t\tklass,\n\t\tpanelClass,\n\t\tstyle,\n\t\tvisible,\n\t\tpanelNodes,\n\t\tname,\n\t\tselected,\n\t\tpanels,\n\t\t$$scope,\n\t\tslots,\n\t\tmeasure_handler\n\t];\n}\n\nclass TabPanels extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$2, create_fragment$2, safe_not_equal, {\n\t\t\tclass: 0,\n\t\t\tname: 5,\n\t\t\tselected: 6,\n\t\t\tvisible: 3,\n\t\t\tpanelClass: 1,\n\t\t\tpanels: 7,\n\t\t\tstyle: 2\n\t\t});\n\t}\n}\n\n/* src/core/ui/components/Panel.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$3(ctx) {\n\tlet div;\n\tlet switch_instance;\n\tlet updating_name;\n\tlet div_class_value;\n\tlet current;\n\tconst switch_instance_spread_levels = [/*componentProps*/ ctx[7]];\n\n\tfunction switch_instance_name_binding(value) {\n\t\t/*switch_instance_name_binding*/ ctx[17].call(null, value);\n\t}\n\n\tvar switch_value = /*componentView*/ ctx[11];\n\n\tfunction switch_props(ctx) {\n\t\tlet switch_instance_props = {};\n\n\t\tfor (let i = 0; i < switch_instance_spread_levels.length; i += 1) {\n\t\t\tswitch_instance_props = assign(switch_instance_props, switch_instance_spread_levels[i]);\n\t\t}\n\n\t\tif (/*panelName*/ ctx[3] !== void 0) {\n\t\t\tswitch_instance_props.name = /*panelName*/ ctx[3];\n\t\t}\n\n\t\treturn { props: switch_instance_props };\n\t}\n\n\tif (switch_value) {\n\t\tswitch_instance = new switch_value(switch_props(ctx));\n\t\tbinding_callbacks.push(() => bind(switch_instance, \"name\", switch_instance_name_binding));\n\t\t/*switch_instance_binding*/ ctx[18](switch_instance);\n\t\tswitch_instance.$on(\"measure\", /*measure_handler*/ ctx[19]);\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (switch_instance) create_component(switch_instance.$$.fragment);\n\t\t\tattr(div, \"data-util\", /*panelName*/ ctx[3]);\n\t\t\tattr(div, \"class\", div_class_value = arrayJoin([\"DokaPanel\", /*klass*/ ctx[1]]));\n\t\t\tattr(div, \"style\", /*style*/ ctx[6]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (switch_instance) {\n\t\t\t\tmount_component(switch_instance, div, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tconst switch_instance_changes = (dirty & /*componentProps*/ 128)\n\t\t\t? get_spread_update(switch_instance_spread_levels, [get_spread_object(/*componentProps*/ ctx[7])])\n\t\t\t: {};\n\n\t\t\tif (!updating_name && dirty & /*panelName*/ 8) {\n\t\t\t\tupdating_name = true;\n\t\t\t\tswitch_instance_changes.name = /*panelName*/ ctx[3];\n\t\t\t\tadd_flush_callback(() => updating_name = false);\n\t\t\t}\n\n\t\t\tif (switch_value !== (switch_value = /*componentView*/ ctx[11])) {\n\t\t\t\tif (switch_instance) {\n\t\t\t\t\tgroup_outros();\n\t\t\t\t\tconst old_component = switch_instance;\n\n\t\t\t\t\ttransition_out(old_component.$$.fragment, 1, 0, () => {\n\t\t\t\t\t\tdestroy_component(old_component, 1);\n\t\t\t\t\t});\n\n\t\t\t\t\tcheck_outros();\n\t\t\t\t}\n\n\t\t\t\tif (switch_value) {\n\t\t\t\t\tswitch_instance = new switch_value(switch_props(ctx));\n\t\t\t\t\tbinding_callbacks.push(() => bind(switch_instance, \"name\", switch_instance_name_binding));\n\t\t\t\t\t/*switch_instance_binding*/ ctx[18](switch_instance);\n\t\t\t\t\tswitch_instance.$on(\"measure\", /*measure_handler*/ ctx[19]);\n\t\t\t\t\tcreate_component(switch_instance.$$.fragment);\n\t\t\t\t\ttransition_in(switch_instance.$$.fragment, 1);\n\t\t\t\t\tmount_component(switch_instance, div, null);\n\t\t\t\t} else {\n\t\t\t\t\tswitch_instance = null;\n\t\t\t\t}\n\t\t\t} else if (switch_value) {\n\t\t\t\tswitch_instance.$set(switch_instance_changes);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*panelName*/ 8) {\n\t\t\t\tattr(div, \"data-util\", /*panelName*/ ctx[3]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*klass*/ 2 && div_class_value !== (div_class_value = arrayJoin([\"DokaPanel\", /*klass*/ ctx[1]]))) {\n\t\t\t\tattr(div, \"class\", div_class_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*style*/ 64) {\n\t\t\t\tattr(div, \"style\", /*style*/ ctx[6]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\tif (switch_instance) transition_in(switch_instance.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tif (switch_instance) transition_out(switch_instance.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\t/*switch_instance_binding*/ ctx[18](null);\n\t\t\tif (switch_instance) destroy_component(switch_instance);\n\t\t}\n\t};\n}\n\nfunction instance$3($$self, $$props, $$invalidate) {\n\tlet $opacityClamped;\n\tlet $isActivePrivateStore;\n\tconst dispatch = createEventDispatcher();\n\tlet { isActive = true } = $$props;\n\tlet { stores } = $$props;\n\tlet { content } = $$props;\n\tlet { component } = $$props;\n\tlet { locale } = $$props;\n\tlet { class: klass = undefined } = $$props;\n\n\t// we remember the view rect in this variable\n\tlet rect;\n\n\tconst opacity = spring(0);\n\tconst opacityClamped = derived(opacity, $opacity => clamp($opacity, 0, 1));\n\tcomponent_subscribe($$self, opacityClamped, value => $$invalidate(22, $opacityClamped = value));\n\n\t// throw hide / show events\n\tlet isHidden = !isActive;\n\n\t// create active store so can be used in derived stores\n\tconst isActivePrivateStore = writable(isActive);\n\n\tcomponent_subscribe($$self, isActivePrivateStore, value => $$invalidate(23, $isActivePrivateStore = value));\n\n\tconst stateProps = {\n\t\tisActive: derived(isActivePrivateStore, $isActivePrivateStore => $isActivePrivateStore),\n\t\tisActiveFraction: derived(opacityClamped, $opacityClamped => $opacityClamped),\n\t\tisVisible: derived(opacityClamped, $opacityClamped => $opacityClamped > 0)\n\t};\n\n\t// build the component props\n\tconst componentView = content.view;\n\n\tconst componentExportedProps = getComponentExportedProps(componentView);\n\n\tconst componentComputedProps = Object.keys(content.props || {}).reduce(\n\t\t(computedProps, key) => {\n\t\t\tif (!componentExportedProps.includes(key)) return computedProps;\n\t\t\tcomputedProps[key] = content.props[key];\n\t\t\treturn computedProps;\n\t\t},\n\t\t{}\n\t);\n\n\tconst componentComputedStateProps = Object.keys(stateProps).reduce(\n\t\t(computedStateProps, key) => {\n\t\t\tif (!componentExportedProps.includes(key)) return computedStateProps;\n\t\t\tcomputedStateProps[key] = stateProps[key];\n\t\t\treturn computedStateProps;\n\t\t},\n\t\t{}\n\t);\n\n\t// class used on panel element\n\tlet panelName;\n\n\t// we use the `hasBeenMounted` bool to block rect updates until the entire panel is ready\n\tlet hasBeenMounted = false;\n\n\tlet preMountRect;\n\tlet mountRectTimeout;\n\n\tonMount(() => {\n\t\t$$invalidate(4, hasBeenMounted = true);\n\n\t\t// this fixes a weird issue where the measure event isn't fired \n\t\t// when no components active in subview\n\t\tclearTimeout(mountRectTimeout);\n\n\t\tmountRectTimeout = setTimeout(\n\t\t\t() => {\n\t\t\t\tif (rect || !preMountRect) return;\n\t\t\t\tdispatch(\"measure\", { ...preMountRect });\n\t\t\t},\n\t\t\t0\n\t\t);\n\t});\n\n\tfunction switch_instance_name_binding(value) {\n\t\tpanelName = value;\n\t\t$$invalidate(3, panelName);\n\t}\n\n\tfunction switch_instance_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tcomponent = $$value;\n\t\t\t$$invalidate(0, component);\n\t\t});\n\t}\n\n\tconst measure_handler = e => {\n\t\t$$invalidate(5, preMountRect = { ...e.detail });\n\t\tif (!hasBeenMounted) return;\n\t\t$$invalidate(2, rect = e.detail);\n\t\tdispatch(\"measure\", { ...rect });\n\t};\n\n\t$$self.$$set = $$props => {\n\t\tif (\"isActive\" in $$props) $$invalidate(12, isActive = $$props.isActive);\n\t\tif (\"stores\" in $$props) $$invalidate(13, stores = $$props.stores);\n\t\tif (\"content\" in $$props) $$invalidate(14, content = $$props.content);\n\t\tif (\"component\" in $$props) $$invalidate(0, component = $$props.component);\n\t\tif (\"locale\" in $$props) $$invalidate(15, locale = $$props.locale);\n\t\tif (\"class\" in $$props) $$invalidate(1, klass = $$props.class);\n\t};\n\n\tlet style;\n\tlet componentProps;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*rect, isActive, component*/ 4101) {\n\t\t\t// when the view rect changes and the panel is in active state or became active, dispatch measure event\n\t\t\t if (rect && isActive && component) dispatch(\"measure\", rect);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*isActive*/ 4096) {\n\t\t\t opacity.set(isActive ? 1 : 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*$opacityClamped, isHidden*/ 5242880) {\n\t\t\t if ($opacityClamped <= 0 && !isHidden) {\n\t\t\t\t$$invalidate(20, isHidden = true);\n\t\t\t\tdispatch(\"hide\");\n\t\t\t} else if ($opacityClamped > 0 && isHidden) {\n\t\t\t\t$$invalidate(20, isHidden = false);\n\t\t\t\tdispatch(\"show\");\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*$opacityClamped*/ 4194304) {\n\t\t\t dispatch(\"fade\", $opacityClamped);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*$opacityClamped*/ 4194304) {\n\t\t\t// only set opacity prop if is below 0\n\t\t\t $$invalidate(6, style = $opacityClamped < 1\n\t\t\t? `opacity: ${$opacityClamped}`\n\t\t\t: undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*isActive*/ 4096) {\n\t\t\t set_store_value(isActivePrivateStore, $isActivePrivateStore = isActive, $isActivePrivateStore);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*stores, locale*/ 40960) {\n\t\t\t $$invalidate(7, componentProps = {\n\t\t\t\t...componentComputedProps,\n\t\t\t\t...componentComputedStateProps,\n\t\t\t\tstores,\n\t\t\t\tlocale\n\t\t\t});\n\t\t}\n\t};\n\n\treturn [\n\t\tcomponent,\n\t\tklass,\n\t\trect,\n\t\tpanelName,\n\t\thasBeenMounted,\n\t\tpreMountRect,\n\t\tstyle,\n\t\tcomponentProps,\n\t\tdispatch,\n\t\topacityClamped,\n\t\tisActivePrivateStore,\n\t\tcomponentView,\n\t\tisActive,\n\t\tstores,\n\t\tcontent,\n\t\tlocale,\n\t\topacity,\n\t\tswitch_instance_name_binding,\n\t\tswitch_instance_binding,\n\t\tmeasure_handler\n\t];\n}\n\nclass Panel extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$3, create_fragment$3, safe_not_equal, {\n\t\t\tisActive: 12,\n\t\t\tstores: 13,\n\t\t\tcontent: 14,\n\t\t\tcomponent: 0,\n\t\t\tlocale: 15,\n\t\t\tclass: 1,\n\t\t\topacity: 16\n\t\t});\n\t}\n\n\tget opacity() {\n\t\treturn this.$$.ctx[16];\n\t}\n}\n\n/* src/core/ui/components/Icon.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$4(ctx) {\n\tlet svg;\n\tlet svg_viewBox_value;\n\tlet current;\n\tconst default_slot_template = /*#slots*/ ctx[5].default;\n\tconst default_slot = create_slot(default_slot_template, ctx, /*$$scope*/ ctx[4], null);\n\n\treturn {\n\t\tc() {\n\t\t\tsvg = svg_element(\"svg\");\n\t\t\tif (default_slot) default_slot.c();\n\t\t\tattr(svg, \"class\", /*klass*/ ctx[3]);\n\t\t\tattr(svg, \"style\", /*style*/ ctx[2]);\n\t\t\tattr(svg, \"width\", /*width*/ ctx[0]);\n\t\t\tattr(svg, \"height\", /*height*/ ctx[1]);\n\t\t\tattr(svg, \"viewBox\", svg_viewBox_value = \"0 0 \" + /*width*/ ctx[0] + \"\\n    \" + /*height*/ ctx[1]);\n\t\t\tattr(svg, \"xmlns\", \"http://www.w3.org/2000/svg\");\n\t\t\tattr(svg, \"aria-hidden\", \"true\");\n\t\t\tattr(svg, \"focusable\", \"false\");\n\t\t\tattr(svg, \"stroke-linecap\", \"round\");\n\t\t\tattr(svg, \"stroke-linejoin\", \"round\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, svg, anchor);\n\n\t\t\tif (default_slot) {\n\t\t\t\tdefault_slot.m(svg, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (default_slot) {\n\t\t\t\tif (default_slot.p && dirty & /*$$scope*/ 16) {\n\t\t\t\t\tupdate_slot(default_slot, default_slot_template, ctx, /*$$scope*/ ctx[4], dirty, null, null);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*klass*/ 8) {\n\t\t\t\tattr(svg, \"class\", /*klass*/ ctx[3]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*style*/ 4) {\n\t\t\t\tattr(svg, \"style\", /*style*/ ctx[2]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*width*/ 1) {\n\t\t\t\tattr(svg, \"width\", /*width*/ ctx[0]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*height*/ 2) {\n\t\t\t\tattr(svg, \"height\", /*height*/ ctx[1]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*width, height*/ 3 && svg_viewBox_value !== (svg_viewBox_value = \"0 0 \" + /*width*/ ctx[0] + \"\\n    \" + /*height*/ ctx[1])) {\n\t\t\t\tattr(svg, \"viewBox\", svg_viewBox_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(default_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(default_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(svg);\n\t\t\tif (default_slot) default_slot.d(detaching);\n\t\t}\n\t};\n}\n\nfunction instance$4($$self, $$props, $$invalidate) {\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tlet { width = 24 } = $$props;\n\tlet { height = 24 } = $$props;\n\tlet { style = undefined } = $$props;\n\tlet { class: klass = undefined } = $$props;\n\n\t$$self.$$set = $$props => {\n\t\tif (\"width\" in $$props) $$invalidate(0, width = $$props.width);\n\t\tif (\"height\" in $$props) $$invalidate(1, height = $$props.height);\n\t\tif (\"style\" in $$props) $$invalidate(2, style = $$props.style);\n\t\tif (\"class\" in $$props) $$invalidate(3, klass = $$props.class);\n\t\tif (\"$$scope\" in $$props) $$invalidate(4, $$scope = $$props.$$scope);\n\t};\n\n\treturn [width, height, style, klass, $$scope, slots];\n}\n\nclass Icon extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$4, create_fragment$4, safe_not_equal, { width: 0, height: 1, style: 2, class: 3 });\n\t}\n}\n\nvar isEventTarget = (e, element) => element === e.target || element.contains(e.target);\n\n/* src/core/ui/components/Button.svelte generated by Svelte v3.29.4 */\n\nfunction create_if_block_1(ctx) {\n\tlet icon_1;\n\tlet current;\n\n\ticon_1 = new Icon({\n\t\t\tprops: {\n\t\t\t\tclass: \"DokaButtonIcon\",\n\t\t\t\t$$slots: { default: [create_default_slot] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(icon_1.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(icon_1, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst icon_1_changes = {};\n\n\t\t\tif (dirty & /*$$scope, icon*/ 1048578) {\n\t\t\t\ticon_1_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon_1.$set(icon_1_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon_1.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon_1.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(icon_1, detaching);\n\t\t}\n\t};\n}\n\n// (40:16) <Icon class=\"DokaButtonIcon\">\nfunction create_default_slot(ctx) {\n\tlet g;\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = /*icon*/ ctx[1];\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*icon*/ 2) g.innerHTML = /*icon*/ ctx[1];\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (46:12) {#if label}\nfunction create_if_block(ctx) {\n\tlet span;\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(/*label*/ ctx[0]);\n\t\t\tattr(span, \"class\", /*elLabelClass*/ ctx[11]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*label*/ 1) set_data(t, /*label*/ ctx[0]);\n\n\t\t\tif (dirty & /*elLabelClass*/ 2048) {\n\t\t\t\tattr(span, \"class\", /*elLabelClass*/ ctx[11]);\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (37:10)          \nfunction fallback_block(ctx) {\n\tlet span;\n\tlet t;\n\tlet current;\n\tlet if_block0 = /*icon*/ ctx[1] && create_if_block_1(ctx);\n\tlet if_block1 = /*label*/ ctx[0] && create_if_block(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tattr(span, \"class\", /*elButtonInnerClass*/ ctx[9]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tif (if_block0) if_block0.m(span, null);\n\t\t\tappend(span, t);\n\t\t\tif (if_block1) if_block1.m(span, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*icon*/ ctx[1]) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*icon*/ 2) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_1(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(span, t);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (/*label*/ ctx[0]) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\tif_block1.m(span, null);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tif_block1.d(1);\n\t\t\t\tif_block1 = null;\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*elButtonInnerClass*/ 512) {\n\t\t\t\tattr(span, \"class\", /*elButtonInnerClass*/ ctx[9]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t\tif (if_block0) if_block0.d();\n\t\t\tif (if_block1) if_block1.d();\n\t\t}\n\t};\n}\n\nfunction create_fragment$5(ctx) {\n\tlet button;\n\tlet action_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tconst default_slot_template = /*#slots*/ ctx[18].default;\n\tconst default_slot = create_slot(default_slot_template, ctx, /*$$scope*/ ctx[20], null);\n\tconst default_slot_or_fallback = default_slot || fallback_block(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tbutton = element(\"button\");\n\t\t\tif (default_slot_or_fallback) default_slot_or_fallback.c();\n\t\t\tattr(button, \"type\", /*type*/ ctx[4]);\n\t\t\tattr(button, \"style\", /*style*/ ctx[2]);\n\t\t\tbutton.disabled = /*disabled*/ ctx[3];\n\t\t\tattr(button, \"class\", /*elButtonClass*/ ctx[10]);\n\t\t\tattr(button, \"title\", /*label*/ ctx[0]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, button, anchor);\n\n\t\t\tif (default_slot_or_fallback) {\n\t\t\t\tdefault_slot_or_fallback.m(button, null);\n\t\t\t}\n\n\t\t\t/*button_binding*/ ctx[19](button);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(button, \"keydown\", function () {\n\t\t\t\t\t\tif (is_function(/*onkeydown*/ ctx[6])) /*onkeydown*/ ctx[6].apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(button, \"click\", function () {\n\t\t\t\t\t\tif (is_function(/*onclick*/ ctx[5])) /*onclick*/ ctx[5].apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\taction_destroyer(action_action = /*action*/ ctx[7].call(null, button))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, [dirty]) {\n\t\t\tctx = new_ctx;\n\n\t\t\tif (default_slot) {\n\t\t\t\tif (default_slot.p && dirty & /*$$scope*/ 1048576) {\n\t\t\t\t\tupdate_slot(default_slot, default_slot_template, ctx, /*$$scope*/ ctx[20], dirty, null, null);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (default_slot_or_fallback && default_slot_or_fallback.p && dirty & /*elButtonInnerClass, elLabelClass, label, icon*/ 2563) {\n\t\t\t\t\tdefault_slot_or_fallback.p(ctx, dirty);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*type*/ 16) {\n\t\t\t\tattr(button, \"type\", /*type*/ ctx[4]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*style*/ 4) {\n\t\t\t\tattr(button, \"style\", /*style*/ ctx[2]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*disabled*/ 8) {\n\t\t\t\tbutton.disabled = /*disabled*/ ctx[3];\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*elButtonClass*/ 1024) {\n\t\t\t\tattr(button, \"class\", /*elButtonClass*/ ctx[10]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*label*/ 1) {\n\t\t\t\tattr(button, \"title\", /*label*/ ctx[0]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(default_slot_or_fallback, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(default_slot_or_fallback, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(button);\n\t\t\tif (default_slot_or_fallback) default_slot_or_fallback.d(detaching);\n\t\t\t/*button_binding*/ ctx[19](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance$5($$self, $$props, $$invalidate) {\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tlet { class: klass = undefined } = $$props;\n\tlet { label = undefined } = $$props;\n\tlet { labelClass = undefined } = $$props;\n\tlet { innerClass = undefined } = $$props;\n\tlet { hideLabel = false } = $$props;\n\tlet { icon = undefined } = $$props;\n\tlet { style = undefined } = $$props;\n\tlet { disabled = undefined } = $$props;\n\tlet { type = \"button\" } = $$props;\n\tlet { onclick = undefined } = $$props;\n\tlet { onkeydown = undefined } = $$props;\n\n\tlet { action = () => {\n\t\t\n\t} } = $$props;\n\n\tlet root;\n\tconst isEventTarget$1 = e => isEventTarget(e, root);\n\tconst getElement = () => root;\n\n\tfunction button_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\troot = $$value;\n\t\t\t$$invalidate(8, root);\n\t\t});\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"class\" in $$props) $$invalidate(12, klass = $$props.class);\n\t\tif (\"label\" in $$props) $$invalidate(0, label = $$props.label);\n\t\tif (\"labelClass\" in $$props) $$invalidate(13, labelClass = $$props.labelClass);\n\t\tif (\"innerClass\" in $$props) $$invalidate(14, innerClass = $$props.innerClass);\n\t\tif (\"hideLabel\" in $$props) $$invalidate(15, hideLabel = $$props.hideLabel);\n\t\tif (\"icon\" in $$props) $$invalidate(1, icon = $$props.icon);\n\t\tif (\"style\" in $$props) $$invalidate(2, style = $$props.style);\n\t\tif (\"disabled\" in $$props) $$invalidate(3, disabled = $$props.disabled);\n\t\tif (\"type\" in $$props) $$invalidate(4, type = $$props.type);\n\t\tif (\"onclick\" in $$props) $$invalidate(5, onclick = $$props.onclick);\n\t\tif (\"onkeydown\" in $$props) $$invalidate(6, onkeydown = $$props.onkeydown);\n\t\tif (\"action\" in $$props) $$invalidate(7, action = $$props.action);\n\t\tif (\"$$scope\" in $$props) $$invalidate(20, $$scope = $$props.$$scope);\n\t};\n\n\tlet elButtonInnerClass;\n\tlet elButtonClass;\n\tlet elLabelClass;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*innerClass*/ 16384) {\n\t\t\t $$invalidate(9, elButtonInnerClass = arrayJoin([\"DokaButtonInner\", innerClass]));\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*hideLabel, klass*/ 36864) {\n\t\t\t $$invalidate(10, elButtonClass = arrayJoin([\"DokaButton\", hideLabel && \"DokaButtonIconOnly\", klass]));\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*hideLabel, labelClass*/ 40960) {\n\t\t\t $$invalidate(11, elLabelClass = arrayJoin([hideLabel ? \"implicit\" : \"DokaButtonLabel\", labelClass]));\n\t\t}\n\t};\n\n\treturn [\n\t\tlabel,\n\t\ticon,\n\t\tstyle,\n\t\tdisabled,\n\t\ttype,\n\t\tonclick,\n\t\tonkeydown,\n\t\taction,\n\t\troot,\n\t\telButtonInnerClass,\n\t\telButtonClass,\n\t\telLabelClass,\n\t\tklass,\n\t\tlabelClass,\n\t\tinnerClass,\n\t\thideLabel,\n\t\tisEventTarget$1,\n\t\tgetElement,\n\t\tslots,\n\t\tbutton_binding,\n\t\t$$scope\n\t];\n}\n\nclass Button extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$5, create_fragment$5, safe_not_equal, {\n\t\t\tclass: 12,\n\t\t\tlabel: 0,\n\t\t\tlabelClass: 13,\n\t\t\tinnerClass: 14,\n\t\t\thideLabel: 15,\n\t\t\ticon: 1,\n\t\t\tstyle: 2,\n\t\t\tdisabled: 3,\n\t\t\ttype: 4,\n\t\t\tonclick: 5,\n\t\t\tonkeydown: 6,\n\t\t\taction: 7,\n\t\t\tisEventTarget: 16,\n\t\t\tgetElement: 17\n\t\t});\n\t}\n\n\tget isEventTarget() {\n\t\treturn this.$$.ctx[16];\n\t}\n\n\tget getElement() {\n\t\treturn this.$$.ctx[17];\n\t}\n}\n\nvar arrayRemove = (array, predicate) => {\n    const index = array.findIndex(predicate);\n    if (index >= 0)\n        return array.splice(index, 1);\n    return undefined;\n};\n\n// svelte\n// constants\nconst INERTIA_THRESHOLD = 0.25; // when force of velocity exceeds this value we drift\nconst INERTIA_DISTANCE_MULTIPLIER = 50;\nconst INERTIA_DURATION_MULTIPLIER = 80;\nconst TAP_DURATION_MAX = 300;\nconst TAP_DISTANCE_MAX = 64;\nconst DOUBLE_TAP_DURATION_MAX = 700;\nconst DOUBLE_TAP_DISTANCE_MAX = 128;\nconst isContextMenuAction = (e) => isNumber(e.button) && e.button !== 0;\nconst getPinchScalar = (offset, current) => {\n    return (current - offset) / offset;\n};\nvar interactable = (node, options = {}) => {\n    // set defaults\n    const { inertia = false, matchTarget = false, pinch = false, getEventPosition = (e) => vectorCreate(e.clientX, e.clientY), } = options;\n    //\n    // helpers\n    //\n    function dispatch(type, detail) {\n        node.dispatchEvent(new CustomEvent(type, { detail }));\n    }\n    function resetInertia() {\n        if (inertiaTweenUnsubscribe)\n            inertiaTweenUnsubscribe();\n        inertiaTweenUnsubscribe = undefined;\n    }\n    //#region pointer registry\n    const pointers = [];\n    const addPointer = (e) => {\n        const pointer = {\n            timeStamp: e.timeStamp,\n            timeStampInitial: e.timeStamp,\n            position: getEventPosition(e),\n            origin: getEventPosition(e),\n            velocity: vectorCreateEmpty(),\n            translation: vectorCreateEmpty(),\n            interactionState: undefined,\n            event: e,\n        };\n        pointers.push(pointer);\n        pointer.interactionState = getInteractionState(pointers);\n    };\n    const removePointer = (e) => {\n        const pointer = arrayRemove(pointers, (pointer) => pointer.event.pointerId === e.pointerId);\n        if (pointer)\n            return pointer[0];\n    };\n    const getPointerIndex = (e) => pointers.findIndex((pointer) => pointer.event.pointerId === e.pointerId);\n    const flattenPointerOrigin = (pointer) => {\n        pointer.origin.x = pointer.position.x;\n        pointer.origin.y = pointer.position.y;\n        pointer.translation.x = 0;\n        pointer.translation.y = 0;\n    };\n    const updatePointer = (e) => {\n        const pointer = getPointer(e);\n        if (!pointer)\n            return;\n        const { timeStamp } = e;\n        // position\n        const eventPosition = getEventPosition(e);\n        // duration between previous interaction and new interaction, an interaction duration cannot be faster than 1 millisecond\n        const interactionDuration = Math.max(1, timeStamp - pointer.timeStamp);\n        // calculate velocity\n        pointer.velocity.x = (eventPosition.x - pointer.position.x) / interactionDuration;\n        pointer.velocity.y = (eventPosition.y - pointer.position.y) / interactionDuration;\n        // update the translation\n        pointer.translation.x = eventPosition.x - pointer.origin.x;\n        pointer.translation.y = eventPosition.y - pointer.origin.y;\n        // set new state\n        pointer.timeStamp = timeStamp;\n        pointer.position.x = eventPosition.x;\n        pointer.position.y = eventPosition.y;\n        pointer.event = e;\n    };\n    const getPointer = (e) => {\n        const i = getPointerIndex(e);\n        if (i < 0)\n            return;\n        return pointers[i];\n    };\n    const isSingleTouching = () => pointers.length === 1;\n    const isMultiTouching = () => pointers.length === 2;\n    const getDistance = (pointers, position) => {\n        const distanceTotal = pointers.reduce((prev, curr) => {\n            prev += vectorDistance(position, curr.position);\n            return prev;\n        }, 0);\n        return distanceTotal / pointers.length;\n    };\n    const getInteractionState = (pointers) => {\n        const center = vectorCenter(pointers.map((pointer) => pointer.position));\n        const distance = getDistance(pointers, center);\n        return {\n            center,\n            distance,\n            velocity: vectorCenter(pointers.map((pointer) => pointer.velocity)),\n            translation: vectorCenter(pointers.map((pointer) => pointer.translation)),\n        };\n    };\n    //#endregion\n    let inertiaTween;\n    let inertiaTweenUnsubscribe;\n    let pinchOffset;\n    let currentTranslation;\n    let currentScale;\n    let isGesture;\n    let lastTapTimeStamp = 0;\n    let lastTapPosition = undefined;\n    // start handling interactions\n    node.addEventListener('pointerdown', handlePointerdown);\n    function handlePointerdown(e) {\n        // ignore more than two pointers for now\n        if (isMultiTouching())\n            return;\n        // not interested in context menu\n        if (isContextMenuAction(e))\n            return;\n        // target should equal node, if it doesn't user might have clicked one of the nodes children\n        if (matchTarget && e.target !== node)\n            return;\n        // stop any previous inertia tweens\n        resetInertia();\n        // register this pointer\n        addPointer(e);\n        // if is first pointer we need to init the drag gesture\n        if (isSingleTouching()) {\n            // handle pointer events\n            document.documentElement.addEventListener('pointermove', handlePointermove);\n            document.documentElement.addEventListener('pointerup', handlePointerup);\n            document.documentElement.addEventListener('pointercancel', handlePointerup);\n            // clear vars\n            isGesture = false;\n            currentScale = 0;\n            currentTranslation = vectorCreateEmpty();\n            pinchOffset = undefined;\n            dispatch('interactionstart', {\n                origin: vectorClone(getPointer(e).origin),\n            });\n        }\n        else if (pinch) {\n            isGesture = true;\n            pinchOffset = vectorDistance(pointers[0].position, pointers[1].position);\n            currentTranslation.x += pointers[0].translation.x;\n            currentTranslation.y += pointers[0].translation.y;\n            flattenPointerOrigin(pointers[0]);\n        }\n    }\n    //\n    // pointer move can only be a primary event (other pointers are not handled)\n    //\n    function handlePointermove(e) {\n        // prevent selection of text (Safari)\n        e.preventDefault();\n        // update pointer state\n        updatePointer(e);\n        let scalar = currentScale;\n        let translation = vectorClone(pointers[0].translation);\n        if (pinch && isMultiTouching()) {\n            // current offset\n            translation.x += pointers[1].translation.x;\n            translation.y += pointers[1].translation.y;\n            // current pinch distance\n            const pinchCurrent = vectorDistance(pointers[0].position, pointers[1].position);\n            // to find out scalar we calculate the difference between the pinch offset and the new pinch\n            scalar += getPinchScalar(pinchOffset, pinchCurrent);\n        }\n        translation.x += currentTranslation.x;\n        translation.y += currentTranslation.y;\n        dispatch('interactionupdate', {\n            translation,\n            scalar: pinch ? scalar : undefined,\n        });\n    }\n    //\n    // pointer up can only be a primary event (other pointers are not handled)\n    //\n    function handlePointerup(e) {\n        // remove pointer from active pointers array\n        const removedPointer = removePointer(e);\n        // store current size\n        if (pinch && isSingleTouching()) {\n            // calculate current scale\n            const pinchCurrent = vectorDistance(pointers[0].position, removedPointer.position);\n            currentScale = (currentScale || 0) + getPinchScalar(pinchOffset, pinchCurrent);\n            currentTranslation.x += pointers[0].translation.x + removedPointer.translation.x;\n            currentTranslation.y += pointers[0].translation.y + removedPointer.translation.y;\n            flattenPointerOrigin(pointers[0]);\n        }\n        // check if this was a tap\n        let isTap = false;\n        let isDoubleTap = false;\n        if (!isGesture) {\n            const interactionEnd = performance.now();\n            const interactionDuration = interactionEnd - removedPointer.timeStampInitial;\n            const interactionDistanceSquared = vectorDistanceSquared(removedPointer.translation);\n            isTap =\n                interactionDistanceSquared < TAP_DISTANCE_MAX &&\n                    interactionDuration < TAP_DURATION_MAX;\n            isDoubleTap = !!(lastTapPosition &&\n                isTap &&\n                interactionEnd - lastTapTimeStamp < DOUBLE_TAP_DURATION_MAX &&\n                vectorDistanceSquared(lastTapPosition, removedPointer.position) <\n                    DOUBLE_TAP_DISTANCE_MAX);\n            if (isTap) {\n                lastTapPosition = vectorClone(removedPointer.position);\n                lastTapTimeStamp = interactionEnd;\n            }\n        }\n        // we wait till last multi-touch interaction is finished, all pointers need to be de-registered before proceeding\n        if (pointers.length > 0)\n            return;\n        // stop listening\n        document.documentElement.removeEventListener('pointermove', handlePointermove);\n        document.documentElement.removeEventListener('pointerup', handlePointerup);\n        document.documentElement.removeEventListener('pointercancel', handlePointerup);\n        const translation = vectorClone(removedPointer.translation);\n        const velocity = vectorClone(removedPointer.velocity);\n        // allows cancelling inertia from release handler\n        let inertiaPrevented = false;\n        // user has released interaction\n        dispatch('interactionrelease', {\n            isTap,\n            isDoubleTap,\n            translation,\n            scalar: currentScale,\n            preventInertia: () => (inertiaPrevented = true),\n        });\n        // stop intantly if not a lot of force applied\n        const force = vectorDistance(velocity);\n        if (inertiaPrevented || !inertia || force < INERTIA_THRESHOLD) {\n            return handleEnd(translation, { isTap, isDoubleTap });\n        }\n        // drift\n        inertiaTween = tweened(vectorClone(translation), {\n            easing: circOut,\n            duration: force * INERTIA_DURATION_MULTIPLIER,\n        });\n        inertiaTween\n            .set({\n            x: translation.x + velocity.x * INERTIA_DISTANCE_MULTIPLIER,\n            y: translation.y + velocity.y * INERTIA_DISTANCE_MULTIPLIER,\n        })\n            .then(() => {\n            // if has unsubscribed (tween was reset)\n            if (!inertiaTweenUnsubscribe)\n                return;\n            // go!\n            handleEnd(get_store_value(inertiaTween), { isTap, isDoubleTap });\n        });\n        inertiaTweenUnsubscribe = inertiaTween.subscribe(handleInertiaUpdate);\n    }\n    function handleInertiaUpdate(inertiaTranslation) {\n        // if is same as previous position, ignore\n        if (!inertiaTranslation)\n            return; // || vectorEqual(inertiaTranslation, translation)) return;\n        // this will handle drift interactions\n        dispatch('interactionupdate', {\n            translation: inertiaTranslation,\n            scalar: pinch ? currentScale : undefined,\n        });\n    }\n    function handleEnd(translation, tapState) {\n        resetInertia();\n        dispatch('interactionend', {\n            ...tapState,\n            translation,\n            scalar: pinch ? currentScale : undefined,\n        });\n    }\n    return {\n        destroy() {\n            resetInertia();\n            node.removeEventListener('pointerdown', handlePointerdown);\n        },\n    };\n};\n\nvar nudgeable = (element, options = {}) => {\n    // if added as action on non focusable element you should add tabindex=0 attribute\n    const { direction = undefined, shiftMultiplier = 10, bubbles = false, stopKeydownPropagation = true, } = options;\n    const isHorizontalDirection = direction === 'horizontal';\n    const isVerticalDirection = direction === 'vertical';\n    const handleKeydown = (e) => {\n        const { key } = e;\n        const isShift = e.shiftKey;\n        const isHorizontalAction = /up|down/i.test(key);\n        const isVerticalAction = /left|right/i.test(key);\n        // no directional key\n        if (!isHorizontalAction && !isVerticalAction)\n            return;\n        // is horizontal but up or down pressed\n        if (isHorizontalDirection && isVerticalAction)\n            return;\n        // is vertical but left or right pressed\n        if (isVerticalDirection && isHorizontalAction)\n            return;\n        // if holding shift move by a factor 10\n        const multiplier = isShift ? shiftMultiplier : 1;\n        if (stopKeydownPropagation)\n            e.stopPropagation();\n        element.dispatchEvent(new CustomEvent('nudge', {\n            bubbles,\n            detail: vectorCreate((/left/i.test(key) ? -1 : /right/i.test(key) ? 1 : 0) * multiplier, (/up/i.test(key) ? -1 : /down/i.test(key) ? 1 : 0) * multiplier),\n        }));\n    };\n    element.addEventListener('keydown', handleKeydown);\n    return {\n        destroy() {\n            element.removeEventListener('keydown', handleKeydown);\n        },\n    };\n};\n\nfunction elastify(translation, dist) {\n    return dist * Math.sign(translation) * Math.log10(1 + Math.abs(translation) / dist);\n}\nconst elastifyRects = (a, b, dist) => {\n    if (!b)\n        return rectClone(a);\n    const left = a.x + elastify(b.x - a.x, dist);\n    const right = a.x + a.width + elastify(b.x + b.width - (a.x + a.width), dist);\n    const top = a.y + elastify(b.y - a.y, dist);\n    const bottom = a.y + a.height + elastify(b.y + b.height - (a.y + a.height), dist);\n    return {\n        x: left,\n        y: top,\n        width: right - left,\n        height: bottom - top,\n    };\n};\n\nvar unitToPixels = (value, element) => {\n    if (!value)\n        return;\n    if (/em/.test(value))\n        return parseInt(value, 10) * 16;\n    if (/px/.test(value))\n        return parseInt(value, 10);\n};\n\nvar getWheelDelta = (e) => {\n    let d = e.detail || 0;\n    // @ts-ignore\n    if (e.wheelDelta || e.wheelDeltaY)\n        d = (-e.wheelDelta || -e.wheelDeltaY) / 120;\n    if (!d)\n        d = e.deltaY;\n    return d;\n};\n\n/* src/core/ui/components/Scrollable.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$6(ctx) {\n\tlet div1;\n\tlet div0;\n\tlet interactable_action;\n\tlet measurable_action;\n\tlet div1_class_value;\n\tlet measurable_action_1;\n\tlet nudgeable_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tconst default_slot_template = /*#slots*/ ctx[29].default;\n\tconst default_slot = create_slot(default_slot_template, ctx, /*$$scope*/ ctx[28], null);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv1 = element(\"div\");\n\t\t\tdiv0 = element(\"div\");\n\t\t\tif (default_slot) default_slot.c();\n\t\t\tattr(div0, \"style\", /*childStyle*/ ctx[6]);\n\t\t\tattr(div1, \"class\", div1_class_value = arrayJoin([\"DokaScrollable\", /*klass*/ ctx[0]]));\n\t\t\tattr(div1, \"style\", /*overflowStyle*/ ctx[4]);\n\t\t\tattr(div1, \"data-direction\", /*scrollDirection*/ ctx[1]);\n\t\t\tattr(div1, \"data-state\", /*containerState*/ ctx[5]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div1, anchor);\n\t\t\tappend(div1, div0);\n\n\t\t\tif (default_slot) {\n\t\t\t\tdefault_slot.m(div0, null);\n\t\t\t}\n\n\t\t\t/*div1_binding*/ ctx[31](div1);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div0, \"interactionstart\", /*handleDragStart*/ ctx[9]),\n\t\t\t\t\tlisten(div0, \"interactionupdate\", /*handleDragMove*/ ctx[11]),\n\t\t\t\t\tlisten(div0, \"interactionend\", /*handleDragEnd*/ ctx[12]),\n\t\t\t\t\tlisten(div0, \"interactionrelease\", /*handleDragRelease*/ ctx[10]),\n\t\t\t\t\taction_destroyer(interactable_action = interactable.call(null, div0, { inertia: true })),\n\t\t\t\t\tlisten(div0, \"measure\", /*measure_handler*/ ctx[30]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div0)),\n\t\t\t\t\tlisten(div1, \"wheel\", /*handleWheel*/ ctx[14]),\n\t\t\t\t\tlisten(div1, \"scroll\", /*handleScroll*/ ctx[16]),\n\t\t\t\t\tlisten(div1, \"focusin\", /*handleFocus*/ ctx[15]),\n\t\t\t\t\tlisten(div1, \"nudge\", /*handleNudge*/ ctx[17]),\n\t\t\t\t\tlisten(div1, \"measure\", /*handleResizeScrollContainer*/ ctx[13]),\n\t\t\t\t\taction_destroyer(measurable_action_1 = measurable.call(null, div1, { observePosition: true })),\n\t\t\t\t\taction_destroyer(nudgeable_action = nudgeable.call(null, div1, {\n\t\t\t\t\t\tdirection: /*scrollDirection*/ ctx[1] === \"x\"\n\t\t\t\t\t\t? \"horizontal\"\n\t\t\t\t\t\t: \"vertical\",\n\t\t\t\t\t\tstopKeydownPropagation: false\n\t\t\t\t\t}))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (default_slot) {\n\t\t\t\tif (default_slot.p && dirty[0] & /*$$scope*/ 268435456) {\n\t\t\t\t\tupdate_slot(default_slot, default_slot_template, ctx, /*$$scope*/ ctx[28], dirty, null, null);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*childStyle*/ 64) {\n\t\t\t\tattr(div0, \"style\", /*childStyle*/ ctx[6]);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*klass*/ 1 && div1_class_value !== (div1_class_value = arrayJoin([\"DokaScrollable\", /*klass*/ ctx[0]]))) {\n\t\t\t\tattr(div1, \"class\", div1_class_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*overflowStyle*/ 16) {\n\t\t\t\tattr(div1, \"style\", /*overflowStyle*/ ctx[4]);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*scrollDirection*/ 2) {\n\t\t\t\tattr(div1, \"data-direction\", /*scrollDirection*/ ctx[1]);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*containerState*/ 32) {\n\t\t\t\tattr(div1, \"data-state\", /*containerState*/ ctx[5]);\n\t\t\t}\n\n\t\t\tif (nudgeable_action && is_function(nudgeable_action.update) && dirty[0] & /*scrollDirection*/ 2) nudgeable_action.update.call(null, {\n\t\t\t\tdirection: /*scrollDirection*/ ctx[1] === \"x\"\n\t\t\t\t? \"horizontal\"\n\t\t\t\t: \"vertical\",\n\t\t\t\tstopKeydownPropagation: false\n\t\t\t});\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(default_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(default_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div1);\n\t\t\tif (default_slot) default_slot.d(detaching);\n\t\t\t/*div1_binding*/ ctx[31](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance$6($$self, $$props, $$invalidate) {\n\tlet $scrollOffset;\n\tlet $keysPressedStore;\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tconst dispatch = createEventDispatcher();\n\tconst keysPressedStore = getContext(\"keysPressed\");\n\tcomponent_subscribe($$self, keysPressedStore, value => $$invalidate(46, $keysPressedStore = value));\n\tlet scrollState = \"idle\";\n\tlet scrollOrigin;\n\tlet scrollRect;\n\tlet scrollContainerRect;\n\tlet scrollReleased;\n\tlet scrollOffset = spring(0);\n\tcomponent_subscribe($$self, scrollOffset, value => $$invalidate(44, $scrollOffset = value));\n\tlet { class: klass = undefined } = $$props;\n\tlet { scrollBlockInteractionDist = 5 } = $$props;\n\tlet { scrollStep = 10 } = $$props; // the distance multiplier for each mouse scroll interaction (delta)\n\tlet { scrollFocusMargin = 64 } = $$props; // the margin used around elements to decided where to move the focus so elements are positioned into view with some spacing around them, this allows peaking at next/previous elements\n\tlet { scrollDirection = \"x\" } = $$props;\n\tlet { scrollAutoCancel = false } = $$props;\n\tlet { elasticity = 0 } = $$props;\n\tlet { onscroll = noop } = $$props;\n\tlet { maskFeatherSize = undefined } = $$props;\n\tlet { maskFeatherStartOpacity = undefined } = $$props;\n\tlet { maskFeatherEndOpacity = undefined } = $$props;\n\tlet { scroll = undefined } = $$props;\n\n\t// logic\n\tlet container;\n\n\tlet overflowStyle = \"\";\n\n\t// is scroll in reset state\n\tlet scrollAtRest = true;\n\n\t// triggers onscroll callback\n\tscrollOffset.subscribe(value => {\n\t\tconst pos = vectorCreateEmpty();\n\t\tpos[scrollDirection] = value;\n\t\tonscroll(pos);\n\t});\n\n\tconst limitOffsetToContainer = offset => Math.max(Math.min(0, offset), scrollContainerRect[size] - scrollRect[size]);\n\tlet scrollFirstMove;\n\tlet scrollCancelled;\n\tlet scrollTranslationPrev;\n\n\tconst isHorizontalTranslation = translation => {\n\t\tconst velocity = vectorApply(vectorCreate(translation.x - scrollTranslationPrev.x, translation.y - scrollTranslationPrev.y), Math.abs);\n\t\tscrollTranslationPrev = vectorClone(translation);\n\t\tconst speed = vectorDistanceSquared(velocity);\n\t\tconst diff = velocity.x - velocity.y;\n\t\treturn !(speed > 1 && diff < -0.5);\n\t};\n\n\tconst handleDragStart = () => {\n\t\t// not overflowing so no need to handle\n\t\tif (!overflows) return;\n\n\t\tscrollCancelled = false;\n\t\tscrollFirstMove = true;\n\t\tscrollTranslationPrev = vectorCreate(0, 0);\n\t\tscrollReleased = false;\n\t\t$$invalidate(32, scrollState = \"idle\");\n\t\tscrollOrigin = get_store_value(scrollOffset);\n\t};\n\n\tconst handleDragRelease = ({ detail }) => {\n\t\tif (!overflows) return;\n\t\tscrollReleased = true;\n\t\t$$invalidate(32, scrollState = \"idle\");\n\t};\n\n\tconst handleDragMove = ({ detail }) => {\n\t\tif (!overflows) return;\n\t\tif (scrollCancelled) return;\n\n\t\t// fixes problem with single move event fired when clicking\n\t\tif (scrollFirstMove) {\n\t\t\tscrollFirstMove = false;\n\t\t\tif (vectorDistanceSquared(detail.translation) < 0.1) return;\n\t\t}\n\n\t\tif (scrollAutoCancel && scrollDirection === \"x\" && !isHorizontalTranslation(detail.translation)) {\n\t\t\tscrollCancelled = true;\n\t\t\treturn;\n\t\t}\n\n\t\tsetScrollOffset(scrollOrigin + detail.translation[scrollDirection], { elastic: true });\n\t};\n\n\tconst handleDragEnd = ({ detail }) => {\n\t\tif (!overflows) return;\n\t\tif (scrollCancelled) return;\n\t\tconst offset = scrollOrigin + detail.translation[scrollDirection];\n\t\tconst offsetLimited = limitOffsetToContainer(offset);\n\t\tscrollAtRest = false;\n\n\t\tscrollOffset.set(offsetLimited).then(res => {\n\t\t\tif (!scrollReleased) return;\n\t\t\tscrollAtRest = true;\n\t\t});\n\t};\n\n\tconst handleResizeScrollContainer = ({ detail }) => {\n\t\t$$invalidate(34, scrollContainerRect = detail);\n\n\t\tdispatch(\"measure\", {\n\t\t\tx: detail.x,\n\t\t\ty: detail.y,\n\t\t\twidth: detail.width,\n\t\t\theight: detail.height\n\t\t});\n\t};\n\n\tconst setScrollOffset = (offset, options = {}) => {\n\t\tconst { elastic = false, animate = false } = options;\n\n\t\t// prevents clicks on child elements if the container is being scrolled\n\t\tif (Math.abs(offset) > scrollBlockInteractionDist && scrollState === \"idle\" && !scrollReleased) {\n\t\t\t$$invalidate(32, scrollState = \"scrolling\");\n\t\t}\n\n\t\tconst offsetLimited = limitOffsetToContainer(offset);\n\n\t\tconst offsetVisual = elastic && elasticity && !scrollReleased\n\t\t? offsetLimited + elastify(offset - offsetLimited, elasticity)\n\t\t: offsetLimited;\n\n\t\tlet snapToPosition = true;\n\n\t\tif (animate) {\n\t\t\tsnapToPosition = false;\n\t\t} else if (!scrollAtRest) {\n\t\t\tsnapToPosition = !scrollReleased;\n\t\t}\n\n\t\tscrollAtRest = false;\n\n\t\tscrollOffset.set(offsetVisual, { hard: snapToPosition }).then(res => {\n\t\t\tif (!scrollReleased) return;\n\t\t\tscrollAtRest = true;\n\t\t});\n\t};\n\n\tconst handleWheel = e => {\n\t\t// don't do anything if isn't overflowing\n\t\tif (!overflows) return;\n\n\t\t// scroll down -> move to right/down\n\t\t// scroll up -> move to left/up\n\t\t// don't run default actions, prevent other actions from running\n\t\te.preventDefault();\n\n\t\te.stopPropagation();\n\n\t\t// apply wheel delta to offset\n\t\tconst delta = getWheelDelta(e);\n\n\t\tconst offset = get_store_value(scrollOffset);\n\t\tsetScrollOffset(offset + delta * scrollStep, { animate: true });\n\t};\n\n\tconst handleFocus = e => {\n\t\t// don't do anything if isn't overflowing\n\t\tif (!overflows) return;\n\n\t\t// ignore this handler if is dragging\n\t\tif (!scrollReleased && !$keysPressedStore.length) return;\n\n\t\tlet target = e.target;\n\n\t\t// when a target is marked as implicit we use its parent elemetn\n\t\tif (e.target.classList.contains(\"implicit\")) target = target.parentNode;\n\n\t\t// get bounds\n\t\tconst start = target[scrollDirection === \"x\" ? \"offsetLeft\" : \"offsetTop\"]; //.offsetLeft;\n\n\t\tconst space = target[scrollDirection === \"x\" ? \"offsetWidth\" : \"offsetHeight\"]; //.offsetWidth;\n\t\tconst end = start + space;\n\n\t\t// we need to know the current offset of the scroll so we can determine if the target is in view\n\t\tconst currentScrollOffset = get_store_value(scrollOffset);\n\n\t\t// the margin around elements to keep in mind when focussing items\n\t\tconst margin = scrollFocusMargin + maskFeatherSize;\n\n\t\tif (currentScrollOffset + start < margin) {\n\t\t\tsetScrollOffset(-start + margin);\n\t\t} else if (currentScrollOffset + end > scrollContainerRect[size] - margin) {\n\t\t\tsetScrollOffset(scrollContainerRect[size] - end - margin, { animate: true });\n\t\t}\n\t};\n\n\tconst handleScroll = () => {\n\t\t// the scroll handler corrects auto browser scroll, \n\t\t// is triggered when browser tries to focus an \n\t\t// element outside of the scrollcontiner\n\t\t$$invalidate(3, container[scrollDirection === \"x\" ? \"scrollLeft\" : \"scrollTop\"] = 0, container);\n\t};\n\n\tconst handleNudge = ({ detail }) => {\n\t\tconst delta = -2 * detail[scrollDirection];\n\t\tconst offset = get_store_value(scrollOffset);\n\t\tsetScrollOffset(offset + delta * scrollStep, { animate: true });\n\t};\n\n\tconst measure_handler = e => $$invalidate(2, scrollRect = e.detail);\n\n\tfunction div1_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tcontainer = $$value;\n\t\t\t$$invalidate(3, container);\n\t\t});\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"class\" in $$props) $$invalidate(0, klass = $$props.class);\n\t\tif (\"scrollBlockInteractionDist\" in $$props) $$invalidate(21, scrollBlockInteractionDist = $$props.scrollBlockInteractionDist);\n\t\tif (\"scrollStep\" in $$props) $$invalidate(22, scrollStep = $$props.scrollStep);\n\t\tif (\"scrollFocusMargin\" in $$props) $$invalidate(23, scrollFocusMargin = $$props.scrollFocusMargin);\n\t\tif (\"scrollDirection\" in $$props) $$invalidate(1, scrollDirection = $$props.scrollDirection);\n\t\tif (\"scrollAutoCancel\" in $$props) $$invalidate(24, scrollAutoCancel = $$props.scrollAutoCancel);\n\t\tif (\"elasticity\" in $$props) $$invalidate(25, elasticity = $$props.elasticity);\n\t\tif (\"onscroll\" in $$props) $$invalidate(26, onscroll = $$props.onscroll);\n\t\tif (\"maskFeatherSize\" in $$props) $$invalidate(18, maskFeatherSize = $$props.maskFeatherSize);\n\t\tif (\"maskFeatherStartOpacity\" in $$props) $$invalidate(19, maskFeatherStartOpacity = $$props.maskFeatherStartOpacity);\n\t\tif (\"maskFeatherEndOpacity\" in $$props) $$invalidate(20, maskFeatherEndOpacity = $$props.maskFeatherEndOpacity);\n\t\tif (\"scroll\" in $$props) $$invalidate(27, scroll = $$props.scroll);\n\t\tif (\"$$scope\" in $$props) $$invalidate(28, $$scope = $$props.$$scope);\n\t};\n\n\tlet size;\n\tlet axis;\n\tlet containerStyle;\n\tlet containerFeatherSize;\n\tlet overflows;\n\tlet containerState;\n\tlet childStyle;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*scrollDirection*/ 2) {\n\t\t\t $$invalidate(40, size = scrollDirection === \"x\" ? \"width\" : \"height\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*scrollDirection*/ 2) {\n\t\t\t $$invalidate(41, axis = scrollDirection.toUpperCase());\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*container*/ 8) {\n\t\t\t $$invalidate(42, containerStyle = container && getComputedStyle(container));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*container*/ 8 | $$self.$$.dirty[1] & /*containerStyle*/ 2048) {\n\t\t\t $$invalidate(43, containerFeatherSize = containerStyle && unitToPixels(containerStyle.getPropertyValue(\"--scrollable-feather-size\")));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*scrollRect, maskFeatherStartOpacity, maskFeatherEndOpacity*/ 1572868 | $$self.$$.dirty[1] & /*$scrollOffset, scrollContainerRect, containerFeatherSize, size*/ 12808) {\n\t\t\t if ($scrollOffset != null && scrollContainerRect && containerFeatherSize != null && scrollRect) {\n\t\t\t\tconst startOffset = -$scrollOffset / containerFeatherSize;\n\t\t\t\tconst endOffset = -(scrollContainerRect[size] - scrollRect[size] - $scrollOffset) / containerFeatherSize;\n\t\t\t\t$$invalidate(19, maskFeatherStartOpacity = clamp(1 - startOffset, 0, 1));\n\t\t\t\t$$invalidate(20, maskFeatherEndOpacity = clamp(1 - endOffset, 0, 1));\n\t\t\t\t$$invalidate(18, maskFeatherSize = containerFeatherSize);\n\t\t\t\t$$invalidate(4, overflowStyle = `--scrollable-feather-start-opacity: ${maskFeatherStartOpacity};--scrollable-feather-end-opacity: ${maskFeatherEndOpacity}`);\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*container, scroll*/ 134217736) {\n\t\t\t// update scroll position\n\t\t\t if (container && scroll !== undefined) {\n\t\t\t\tif (isNumber(scroll)) setScrollOffset(scroll); else setScrollOffset(scroll.scrollOffset, scroll);\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*scrollRect*/ 4 | $$self.$$.dirty[1] & /*scrollContainerRect, size*/ 520) {\n\t\t\t $$invalidate(45, overflows = scrollContainerRect && scrollRect\n\t\t\t? scrollRect[size] > scrollContainerRect[size]\n\t\t\t: undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*scrollState, overflows*/ 16386) {\n\t\t\t $$invalidate(5, containerState = arrayJoin([scrollState, overflows ? \"overflows\" : undefined]));\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*overflows, axis, $scrollOffset*/ 25600) {\n\t\t\t $$invalidate(6, childStyle = overflows\n\t\t\t? `transform: translate${axis}(${$scrollOffset}px)`\n\t\t\t: undefined);\n\t\t}\n\t};\n\n\treturn [\n\t\tklass,\n\t\tscrollDirection,\n\t\tscrollRect,\n\t\tcontainer,\n\t\toverflowStyle,\n\t\tcontainerState,\n\t\tchildStyle,\n\t\tkeysPressedStore,\n\t\tscrollOffset,\n\t\thandleDragStart,\n\t\thandleDragRelease,\n\t\thandleDragMove,\n\t\thandleDragEnd,\n\t\thandleResizeScrollContainer,\n\t\thandleWheel,\n\t\thandleFocus,\n\t\thandleScroll,\n\t\thandleNudge,\n\t\tmaskFeatherSize,\n\t\tmaskFeatherStartOpacity,\n\t\tmaskFeatherEndOpacity,\n\t\tscrollBlockInteractionDist,\n\t\tscrollStep,\n\t\tscrollFocusMargin,\n\t\tscrollAutoCancel,\n\t\telasticity,\n\t\tonscroll,\n\t\tscroll,\n\t\t$$scope,\n\t\tslots,\n\t\tmeasure_handler,\n\t\tdiv1_binding\n\t];\n}\n\nclass Scrollable extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$6,\n\t\t\tcreate_fragment$6,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tclass: 0,\n\t\t\t\tscrollBlockInteractionDist: 21,\n\t\t\t\tscrollStep: 22,\n\t\t\t\tscrollFocusMargin: 23,\n\t\t\t\tscrollDirection: 1,\n\t\t\t\tscrollAutoCancel: 24,\n\t\t\t\telasticity: 25,\n\t\t\t\tonscroll: 26,\n\t\t\t\tmaskFeatherSize: 18,\n\t\t\t\tmaskFeatherStartOpacity: 19,\n\t\t\t\tmaskFeatherEndOpacity: 20,\n\t\t\t\tscroll: 27\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n}\n\nfunction fade(node, { delay = 0, duration = 400, easing = identity }) {\n    const o = +getComputedStyle(node).opacity;\n    return {\n        delay,\n        duration,\n        easing,\n        css: t => `opacity: ${t * o}`\n    };\n}\n\n/* src/core/ui/components/StatusMessage.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$7(ctx) {\n\tlet span;\n\tlet t;\n\tlet measure_action;\n\tlet span_transition;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(/*text*/ ctx[0]);\n\t\t\tattr(span, \"class\", \"DokaStatusMessage\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(span, \"measure\", function () {\n\t\t\t\t\t\tif (is_function(/*onmeasure*/ ctx[1])) /*onmeasure*/ ctx[1].apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\taction_destroyer(measure_action = measurable.call(null, span))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, [dirty]) {\n\t\t\tctx = new_ctx;\n\t\t\tif (!current || dirty & /*text*/ 1) set_data(t, /*text*/ ctx[0]);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\n\t\t\tadd_render_callback(() => {\n\t\t\t\tif (!span_transition) span_transition = create_bidirectional_transition(span, fade, {}, true);\n\t\t\t\tspan_transition.run(1);\n\t\t\t});\n\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tif (!span_transition) span_transition = create_bidirectional_transition(span, fade, {}, false);\n\t\t\tspan_transition.run(0);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t\tif (detaching && span_transition) span_transition.end();\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance$7($$self, $$props, $$invalidate) {\n\tlet { text } = $$props;\n\tlet { onmeasure = noop } = $$props;\n\n\t$$self.$$set = $$props => {\n\t\tif (\"text\" in $$props) $$invalidate(0, text = $$props.text);\n\t\tif (\"onmeasure\" in $$props) $$invalidate(1, onmeasure = $$props.onmeasure);\n\t};\n\n\treturn [text, onmeasure];\n}\n\nclass StatusMessage extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$7, create_fragment$7, safe_not_equal, { text: 0, onmeasure: 1 });\n\t}\n}\n\n/* src/core/ui/components/ProgressIndicator.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$8(ctx) {\n\tlet span1;\n\tlet svg;\n\tlet g;\n\tlet circle0;\n\tlet circle1;\n\tlet t0;\n\tlet span0;\n\tlet t1;\n\n\treturn {\n\t\tc() {\n\t\t\tspan1 = element(\"span\");\n\t\t\tsvg = svg_element(\"svg\");\n\t\t\tg = svg_element(\"g\");\n\t\t\tcircle0 = svg_element(\"circle\");\n\t\t\tcircle1 = svg_element(\"circle\");\n\t\t\tt0 = space();\n\t\t\tspan0 = element(\"span\");\n\t\t\tt1 = text(/*formattedValue*/ ctx[0]);\n\t\t\tattr(circle0, \"class\", \"DokaProgressIndicatorBar\");\n\t\t\tattr(circle0, \"r\", \"8.5\");\n\t\t\tattr(circle0, \"cx\", \"10\");\n\t\t\tattr(circle0, \"cy\", \"10\");\n\t\t\tattr(circle0, \"stroke-linecap\", \"round\");\n\t\t\tattr(circle0, \"opacity\", \".25\");\n\t\t\tattr(circle1, \"class\", \"DokaProgressIndicatorFill\");\n\t\t\tattr(circle1, \"r\", \"8.5\");\n\t\t\tattr(circle1, \"stroke-dasharray\", /*circleValue*/ ctx[1]);\n\t\t\tattr(circle1, \"cx\", \"10\");\n\t\t\tattr(circle1, \"cy\", \"10\");\n\t\t\tattr(circle1, \"transform\", \"rotate(-90) translate(-20)\");\n\t\t\tattr(g, \"fill\", \"none\");\n\t\t\tattr(g, \"stroke\", \"currentColor\");\n\t\t\tattr(g, \"stroke-width\", \"2.5\");\n\t\t\tattr(g, \"stroke-linecap\", \"round\");\n\t\t\tattr(g, \"opacity\", /*circleOpacity*/ ctx[2]);\n\t\t\tattr(svg, \"width\", \"20\");\n\t\t\tattr(svg, \"height\", \"20\");\n\t\t\tattr(svg, \"viewBox\", \"0 0 20 20\");\n\t\t\tattr(svg, \"xmlns\", \"http://www.w3.org/2000/svg\");\n\t\t\tattr(svg, \"aria-hidden\", \"true\");\n\t\t\tattr(svg, \"focusable\", \"false\");\n\t\t\tattr(span0, \"class\", \"implicit\");\n\t\t\tattr(span1, \"class\", \"DokaProgressIndicator\");\n\t\t\tattr(span1, \"data-status\", /*status*/ ctx[3]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span1, anchor);\n\t\t\tappend(span1, svg);\n\t\t\tappend(svg, g);\n\t\t\tappend(g, circle0);\n\t\t\tappend(g, circle1);\n\t\t\tappend(span1, t0);\n\t\t\tappend(span1, span0);\n\t\t\tappend(span0, t1);\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*circleValue*/ 2) {\n\t\t\t\tattr(circle1, \"stroke-dasharray\", /*circleValue*/ ctx[1]);\n\t\t\t}\n\n\t\t\tif (dirty & /*circleOpacity*/ 4) {\n\t\t\t\tattr(g, \"opacity\", /*circleOpacity*/ ctx[2]);\n\t\t\t}\n\n\t\t\tif (dirty & /*formattedValue*/ 1) set_data(t1, /*formattedValue*/ ctx[0]);\n\n\t\t\tif (dirty & /*status*/ 8) {\n\t\t\t\tattr(span1, \"data-status\", /*status*/ ctx[3]);\n\t\t\t}\n\t\t},\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span1);\n\t\t}\n\t};\n}\n\nfunction instance$8($$self, $$props, $$invalidate) {\n\tlet $animatedProgressClamped;\n\tconst dispatch = createEventDispatcher();\n\tlet { progress } = $$props;\n\tlet { min = 0 } = $$props;\n\tlet { max = 100 } = $$props;\n\tlet { labelBusy = \"Busy\" } = $$props;\n\tconst animatedValue = spring(0, { precision: 0.01 });\n\tconst animatedProgressClamped = derived([animatedValue], $animatedValue => clamp($animatedValue, min, max));\n\tcomponent_subscribe($$self, animatedProgressClamped, value => $$invalidate(9, $animatedProgressClamped = value));\n\n\tanimatedProgressClamped.subscribe(value => {\n\t\tif (progress === 1 && Math.round(value) >= 100) dispatch(\"complete\");\n\t});\n\n\t$$self.$$set = $$props => {\n\t\tif (\"progress\" in $$props) $$invalidate(5, progress = $$props.progress);\n\t\tif (\"min\" in $$props) $$invalidate(6, min = $$props.min);\n\t\tif (\"max\" in $$props) $$invalidate(7, max = $$props.max);\n\t\tif (\"labelBusy\" in $$props) $$invalidate(8, labelBusy = $$props.labelBusy);\n\t};\n\n\tlet formattedValue;\n\tlet circleValue;\n\tlet circleOpacity;\n\tlet status;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*progress*/ 32) {\n\t\t\t progress && progress !== Infinity && animatedValue.set(progress * 100);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*progress, labelBusy, $animatedProgressClamped*/ 800) {\n\t\t\t $$invalidate(0, formattedValue = progress === Infinity\n\t\t\t? labelBusy\n\t\t\t: `${Math.round($animatedProgressClamped)}%`);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*progress, $animatedProgressClamped*/ 544) {\n\t\t\t $$invalidate(1, circleValue = progress === Infinity\n\t\t\t? \"26.5 53\"\n\t\t\t: `${$animatedProgressClamped / 100 * 53} 53`);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*progress, $animatedProgressClamped*/ 544) {\n\t\t\t $$invalidate(2, circleOpacity = Math.min(1, progress === Infinity\n\t\t\t? 1\n\t\t\t: $animatedProgressClamped / 10));\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*progress*/ 32) {\n\t\t\t $$invalidate(3, status = progress === Infinity ? \"busy\" : \"loading\");\n\t\t}\n\t};\n\n\treturn [\n\t\tformattedValue,\n\t\tcircleValue,\n\t\tcircleOpacity,\n\t\tstatus,\n\t\tanimatedProgressClamped,\n\t\tprogress,\n\t\tmin,\n\t\tmax,\n\t\tlabelBusy\n\t];\n}\n\nclass ProgressIndicator extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$8, create_fragment$8, safe_not_equal, {\n\t\t\tprogress: 5,\n\t\t\tmin: 6,\n\t\t\tmax: 7,\n\t\t\tlabelBusy: 8\n\t\t});\n\t}\n}\n\n/* src/core/ui/components/StatusProgress.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$9(ctx) {\n\tlet span;\n\tlet progressindicator;\n\tlet current;\n\tprogressindicator = new ProgressIndicator({ props: { progress: /*progress*/ ctx[0] } });\n\n\tprogressindicator.$on(\"complete\", function () {\n\t\tif (is_function(/*oncomplete*/ ctx[1])) /*oncomplete*/ ctx[1].apply(this, arguments);\n\t});\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tcreate_component(progressindicator.$$.fragment);\n\t\t\tattr(span, \"class\", \"DokaStatusProgress\");\n\t\t\tattr(span, \"style\", /*style*/ ctx[2]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tmount_component(progressindicator, span, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(new_ctx, [dirty]) {\n\t\t\tctx = new_ctx;\n\t\t\tconst progressindicator_changes = {};\n\t\t\tif (dirty & /*progress*/ 1) progressindicator_changes.progress = /*progress*/ ctx[0];\n\t\t\tprogressindicator.$set(progressindicator_changes);\n\n\t\t\tif (!current || dirty & /*style*/ 4) {\n\t\t\t\tattr(span, \"style\", /*style*/ ctx[2]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(progressindicator.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(progressindicator.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t\tdestroy_component(progressindicator);\n\t\t}\n\t};\n}\n\nfunction instance$9($$self, $$props, $$invalidate) {\n\tlet { offset = 0 } = $$props;\n\tlet { visible = true } = $$props;\n\tlet { progress } = $$props;\n\tlet { oncomplete = noop } = $$props;\n\n\t$$self.$$set = $$props => {\n\t\tif (\"offset\" in $$props) $$invalidate(3, offset = $$props.offset);\n\t\tif (\"visible\" in $$props) $$invalidate(4, visible = $$props.visible);\n\t\tif (\"progress\" in $$props) $$invalidate(0, progress = $$props.progress);\n\t\tif (\"oncomplete\" in $$props) $$invalidate(1, oncomplete = $$props.oncomplete);\n\t};\n\n\tlet style;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*offset, visible*/ 24) {\n\t\t\t $$invalidate(2, style = `transform: translateX(${offset}px); opacity: ${visible ? 1 : 0}`);\n\t\t}\n\t};\n\n\treturn [progress, oncomplete, style, offset, visible];\n}\n\nclass StatusProgress extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$9, create_fragment$9, safe_not_equal, {\n\t\t\toffset: 3,\n\t\t\tvisible: 4,\n\t\t\tprogress: 0,\n\t\t\toncomplete: 1\n\t\t});\n\t}\n}\n\n/* src/core/ui/components/DynamicComponentTree.svelte generated by Svelte v3.29.4 */\n\nfunction get_each_context$2(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[4] = list[i][0];\n\tchild_ctx[5] = list[i][1];\n\tchild_ctx[6] = list[i][2];\n\tchild_ctx[0] = list[i][3];\n\treturn child_ctx;\n}\n\n// (28:4) {:else}\nfunction create_else_block(ctx) {\n\tlet switch_instance;\n\tlet switch_instance_anchor;\n\tlet current;\n\tconst switch_instance_spread_levels = [/*props*/ ctx[6]];\n\tvar switch_value = /*node*/ ctx[4];\n\n\tfunction switch_props(ctx) {\n\t\tlet switch_instance_props = {};\n\n\t\tfor (let i = 0; i < switch_instance_spread_levels.length; i += 1) {\n\t\t\tswitch_instance_props = assign(switch_instance_props, switch_instance_spread_levels[i]);\n\t\t}\n\n\t\treturn { props: switch_instance_props };\n\t}\n\n\tif (switch_value) {\n\t\tswitch_instance = new switch_value(switch_props());\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tif (switch_instance) create_component(switch_instance.$$.fragment);\n\t\t\tswitch_instance_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (switch_instance) {\n\t\t\t\tmount_component(switch_instance, target, anchor);\n\t\t\t}\n\n\t\t\tinsert(target, switch_instance_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst switch_instance_changes = (dirty & /*children*/ 1)\n\t\t\t? get_spread_update(switch_instance_spread_levels, [get_spread_object(/*props*/ ctx[6])])\n\t\t\t: {};\n\n\t\t\tif (switch_value !== (switch_value = /*node*/ ctx[4])) {\n\t\t\t\tif (switch_instance) {\n\t\t\t\t\tgroup_outros();\n\t\t\t\t\tconst old_component = switch_instance;\n\n\t\t\t\t\ttransition_out(old_component.$$.fragment, 1, 0, () => {\n\t\t\t\t\t\tdestroy_component(old_component, 1);\n\t\t\t\t\t});\n\n\t\t\t\t\tcheck_outros();\n\t\t\t\t}\n\n\t\t\t\tif (switch_value) {\n\t\t\t\t\tswitch_instance = new switch_value(switch_props());\n\t\t\t\t\tcreate_component(switch_instance.$$.fragment);\n\t\t\t\t\ttransition_in(switch_instance.$$.fragment, 1);\n\t\t\t\t\tmount_component(switch_instance, switch_instance_anchor.parentNode, switch_instance_anchor);\n\t\t\t\t} else {\n\t\t\t\t\tswitch_instance = null;\n\t\t\t\t}\n\t\t\t} else if (switch_value) {\n\t\t\t\tswitch_instance.$set(switch_instance_changes);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\tif (switch_instance) transition_in(switch_instance.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tif (switch_instance) transition_out(switch_instance.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(switch_instance_anchor);\n\t\t\tif (switch_instance) destroy_component(switch_instance, detaching);\n\t\t}\n\t};\n}\n\n// (26:4) {#if isString(node)}\nfunction create_if_block$1(ctx) {\n\tlet div;\n\tlet dynamiccomponenttree;\n\tlet current;\n\n\tdynamiccomponenttree = new DynamicComponentTree_1({\n\t\t\tprops: {\n\t\t\t\titems: /*children*/ ctx[0],\n\t\t\t\tdiscardEmptyItems: true\n\t\t\t}\n\t\t});\n\n\tlet div_levels = [/*props*/ ctx[6]];\n\tlet div_data = {};\n\n\tfor (let i = 0; i < div_levels.length; i += 1) {\n\t\tdiv_data = assign(div_data, div_levels[i]);\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(dynamiccomponenttree.$$.fragment);\n\t\t\tset_attributes(div, div_data);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(dynamiccomponenttree, div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst dynamiccomponenttree_changes = {};\n\t\t\tif (dirty & /*children*/ 1) dynamiccomponenttree_changes.items = /*children*/ ctx[0];\n\t\t\tdynamiccomponenttree.$set(dynamiccomponenttree_changes);\n\t\t\tset_attributes(div, div_data = get_spread_update(div_levels, [dirty & /*children*/ 1 && /*props*/ ctx[6]]));\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(dynamiccomponenttree.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(dynamiccomponenttree.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(dynamiccomponenttree);\n\t\t}\n\t};\n}\n\n// (25:0) {#each children as [node, key, props, children] (key) }\nfunction create_each_block$2(key_1, ctx) {\n\tlet first;\n\tlet show_if;\n\tlet current_block_type_index;\n\tlet if_block;\n\tlet if_block_anchor;\n\tlet current;\n\tconst if_block_creators = [create_if_block$1, create_else_block];\n\tconst if_blocks = [];\n\n\tfunction select_block_type(ctx, dirty) {\n\t\tif (dirty & /*children*/ 1) show_if = !!isString(/*node*/ ctx[4]);\n\t\tif (show_if) return 0;\n\t\treturn 1;\n\t}\n\n\tcurrent_block_type_index = select_block_type(ctx, -1);\n\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tfirst = empty();\n\t\t\tif_block.c();\n\t\t\tif_block_anchor = empty();\n\t\t\tthis.first = first;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, first, anchor);\n\t\t\tif_blocks[current_block_type_index].m(target, anchor);\n\t\t\tinsert(target, if_block_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tlet previous_block_index = current_block_type_index;\n\t\t\tcurrent_block_type_index = select_block_type(ctx, dirty);\n\n\t\t\tif (current_block_type_index === previous_block_index) {\n\t\t\t\tif_blocks[current_block_type_index].p(ctx, dirty);\n\t\t\t} else {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_blocks[previous_block_index], 1, 1, () => {\n\t\t\t\t\tif_blocks[previous_block_index] = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t\tif_block = if_blocks[current_block_type_index];\n\n\t\t\t\tif (!if_block) {\n\t\t\t\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t}\n\n\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\tif_block.m(if_block_anchor.parentNode, if_block_anchor);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(first);\n\t\t\tif_blocks[current_block_type_index].d(detaching);\n\t\t\tif (detaching) detach(if_block_anchor);\n\t\t}\n\t};\n}\n\nfunction create_fragment$a(ctx) {\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet each_1_anchor;\n\tlet current;\n\tlet each_value = /*children*/ ctx[0];\n\tconst get_key = ctx => /*key*/ ctx[5];\n\n\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\tlet child_ctx = get_each_context$2(ctx, each_value, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block$2(key, child_ctx));\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\teach_1_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(target, anchor);\n\t\t\t}\n\n\t\t\tinsert(target, each_1_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*children, isString*/ 1) {\n\t\t\t\tconst each_value = /*children*/ ctx[0];\n\t\t\t\tgroup_outros();\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value, each_1_lookup, each_1_anchor.parentNode, outro_and_destroy_block, create_each_block$2, each_1_anchor, get_each_context$2);\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\n\t\t\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\t\t\ttransition_in(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\ttransition_out(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d(detaching);\n\t\t\t}\n\n\t\t\tif (detaching) detach(each_1_anchor);\n\t\t}\n\t};\n}\n\nfunction instance$a($$self, $$props, $$invalidate) {\n\tlet { items } = $$props;\n\tlet { discardEmptyItems = true } = $$props;\n\n\tconst shouldRenderItem = item => {\n\t\t// don't render falsy items\n\t\tif (!item) return false;\n\n\t\t// get relevant props\n\t\tconst [node, ,,children] = item;\n\n\t\t// if item is component, we always render it\n\t\tif (!isString(node)) return true;\n\n\t\t// item is tag, we have to check if children are empty\n\t\treturn children.some(shouldRenderItem);\n\t};\n\n\t$$self.$$set = $$props => {\n\t\tif (\"items\" in $$props) $$invalidate(1, items = $$props.items);\n\t\tif (\"discardEmptyItems\" in $$props) $$invalidate(2, discardEmptyItems = $$props.discardEmptyItems);\n\t};\n\n\tlet children;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*items, discardEmptyItems*/ 6) {\n\t\t\t $$invalidate(0, children = (items && discardEmptyItems\n\t\t\t? items.filter(shouldRenderItem)\n\t\t\t: items) || []);\n\t\t}\n\t};\n\n\treturn [children, items, discardEmptyItems];\n}\n\nclass DynamicComponentTree_1 extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$a, create_fragment$a, safe_not_equal, { items: 1, discardEmptyItems: 2 });\n\t}\n}\n\nconst ImageStoreProps = [\n    'file',\n    'size',\n    'loadState',\n    'processState',\n    'cropAspectRatio',\n    'cropLimitToImage',\n    'crop',\n    'cropMinSize',\n    'cropMaxSize',\n    'cropRange',\n    'cropOrigin',\n    'cropRectAspectRatio',\n    'rotation',\n    'rotationRange',\n    'targetSize',\n    'flipX',\n    'flipY',\n    'perspectiveX',\n    'perspectiveY',\n    'perspective',\n    'colorMatrix',\n    'convolutionMatrix',\n    'gamma',\n    'vignette',\n    'noise',\n    'decoration',\n    'annotation',\n    'backgroundColor',\n    'state',\n];\nconst proxy = function (get, set, update) {\n    let subscribers = [];\n    return {\n        set,\n        update,\n        publish: (value) => {\n            subscribers.forEach((cb) => cb(value));\n        },\n        subscribe: (cb) => {\n            subscribers.push(cb);\n            get(cb);\n            return () => {\n                subscribers = subscribers.filter((item) => item !== cb);\n            };\n        },\n    };\n};\nvar createImageProxy = () => {\n    let unsubs;\n    let image;\n    const proxyStores = ImageStoreProps.reduce((prev, curr) => {\n        prev[curr] = proxy(\n        // getter\n        (cb) => {\n            // subscribe\n            if (!image)\n                return cb();\n            const unsub = image.stores[curr].subscribe(cb);\n            unsub();\n        }, \n        // setter\n        (value) => {\n            // set value on actual store if is defined\n            if (!image)\n                return;\n            image.stores[curr].set(value);\n        }, \n        // updater\n        (cb) => {\n            if (!image)\n                return;\n            image.stores[curr].update(cb);\n        });\n        return prev;\n    }, {});\n    const update = (newImage) => {\n        image = newImage;\n        if (unsubs) {\n            // remove subscribers\n            unsubs.forEach((unsub) => unsub());\n            unsubs = undefined;\n        }\n        if (!newImage) {\n            // need to reset load state\n            proxyStores['file'].publish(undefined);\n            proxyStores['loadState'].publish(undefined);\n            return;\n        }\n        unsubs = ImageStoreProps.map((prop) => newImage.stores[prop].subscribe((value) => proxyStores[prop].publish(value)));\n    };\n    return {\n        update,\n        stores: proxyStores,\n    };\n};\n\nvar createPingRouter = (route, cancel = true) => (e) => {\n    if (e.type !== 'ping')\n        return;\n    if (cancel)\n        e.stopPropagation();\n    route(e.detail.type, e.detail.data);\n};\n\nvar isTextarea = (element) => /textarea/i.test(element.nodeName);\n\nvar isTextInput = (node) => /date|email|number|search|text|url/.test(node.type);\n\nvar isTextField = (node) => isTextarea(node) || isTextInput(node);\n\nvar toKebabCase = (str, abbr) => {\n    return (abbr ? stringReplace(str, abbr) : str)\n        .replace(/([a-z])([A-Z])/g, '$1-$2')\n        .replace(/\\s+/g, '-')\n        .toLowerCase();\n};\n\nvar matchMedia$1 = (query, cb) => {\n    const mql = matchMedia(query);\n    mql.addListener(cb);\n    cb(mql);\n    return {\n        get matches() { return mql.matches; },\n        destroy: () => mql.removeListener(cb)\n    };\n};\n\nvar mediaQueryStore = (query, formatValue = passthrough) => {\n    const { subscribe, set } = writable(undefined);\n    const mm = matchMedia$1(query, ({ matches }) => set(formatValue(matches)));\n    return {\n        subscribe,\n        unsubscribe: mm.destroy\n    };\n};\n\nvar canPreventNavSwipe = () => {\n    // if not iOS we can't prevent swipe because it probably isn't a thing\n    if (!isIOS())\n        return false;\n    // extract version number\n    const matches = navigator.userAgent.match(/OS (\\d+)_(\\d+)_?(\\d+)?/i) || [];\n    const [, major, minor] = matches.map((v) => parseInt(v, 10) || 0);\n    // is atleast version 13.4+\n    return major > 13 || (major === 13 && minor >= 4);\n};\n\nvar calculateImageTransforms = (stageRect, rootRect, imageSize, cropRect, imageSelectionRect, imageScale, imagePerspectiveX, imagePerspectiveY, imageRotation, imageFlipX, imageFlipY) => {\n    if (!stageRect || !rootRect || !imageSize || !cropRect || !imageScale)\n        return undefined;\n    const viewRect = rectNormalizeOffset(rectClone(rootRect));\n    const viewCenter = rectCenter(viewRect);\n    const stageCenter = rectCenter(stageRect);\n    const imageRect = rectCreateFromSize(imageSize);\n    const imageCenter = rectCenter(imageRect);\n    const imagePerspective = vectorCreate(imagePerspectiveX, imagePerspectiveY);\n    // get base crop rect so we can correctly apply transforms\n    const cropRectBase = getBaseCropRect(imageSize, cropRect, imageRotation, imagePerspective);\n    const cropRectBaseCenter = rectCenter(cropRectBase);\n    const imageTranslation = vectorSubtract(vectorClone(imageCenter), cropRectBaseCenter);\n    // calculate stage center offset from view center\n    const imageOffset = vectorSubtract(vectorClone(stageCenter), viewCenter);\n    // correct for stage offset\n    imageTranslation.x += imageOffset.x;\n    imageTranslation.y += imageOffset.y;\n    // set origin of translation (so rotates around center of selection)\n    const imageOrigin = vectorInvert(vectorClone(imageTranslation));\n    // correct for stage offset\n    imageOrigin.x += imageOffset.x;\n    imageOrigin.y += imageOffset.y;\n    // correct for image selection offset relative to view\n    const imageSelectionCenter = rectCenter(rectTranslate(rectClone(imageSelectionRect), stageRect));\n    const imageSelectionOffset = vectorSubtract(imageSelectionCenter, stageCenter);\n    vectorAdd(imageTranslation, imageSelectionOffset);\n    return {\n        // offset: imageOffset,\n        origin: imageOrigin,\n        translation: imageTranslation,\n        rotation: {\n            x: imageFlipY ? Math.PI : 0,\n            y: imageFlipX ? Math.PI : 0,\n            z: imageRotation,\n        },\n        perspective: imagePerspective,\n        scale: imageScale,\n    };\n};\n\n// @ts-ignore\nvar historyCreate = (getState, setState) => {\n    // set up pub/sub for history object\n    const { sub, pub } = pubsub();\n    // current history state\n    let baseState;\n    const entries = [];\n    const index = writable(-1);\n    const subs = [];\n    const updateSubs = () => subs.forEach((cb) => cb({ index: get_store_value(index), length: entries.length }));\n    const history = {\n        get index() {\n            return get_store_value(index);\n        },\n        set index(i) {\n            // validate new index\n            i = Number.isInteger(i) ? i : -1;\n            i = clamp(i, -1, entries.length - 1);\n            // remember\n            index.set(i);\n            setState(entries[history.index] || baseState);\n            // update subs\n            updateSubs();\n        },\n        get state() {\n            return entries[entries.length - 1] || baseState;\n        },\n        length() {\n            return entries.length;\n        },\n        undo() {\n            const newIndex = history.index--;\n            pub('undo', newIndex);\n            return newIndex;\n        },\n        redo() {\n            const newIndex = history.index++;\n            pub('redo', history.index);\n            return newIndex;\n        },\n        revert() {\n            entries.length = 0;\n            history.index = -1;\n            pub('revert');\n        },\n        write() {\n            // reset length to current index\n            entries.length = history.index + 1;\n            // add new entry\n            entries.push(getState());\n            // move pointer to last added index\n            index.set(entries.length - 1);\n            updateSubs();\n        },\n        set(state = {}) {\n            baseState = state;\n        },\n        subscribe(cb) {\n            subs.push(cb);\n            cb({ index: history.index, length: entries.length });\n            return () => subs.splice(subs.indexOf(cb), 1);\n        },\n        on: sub,\n    };\n    return history;\n};\n\nvar isChrome = () => isBrowser() && !!window['chrome'];\n\nvar imageBitmapToImageData = async (imageBitmap) => canvasToImageData(await imageDataToCanvas(imageBitmap));\n\nvar blobToImageBitmap = (file, ImageOrienter, canvasMemoryLimit) => new Promise(async (resolve, reject) => {\n    // get orientation of image, should return 1 for normal orientation\n    const orientation = await ImageOrienter.read(file);\n    // helper method to apply orientation fix if needed\n    const toImageData = (file) => blobToImageData(file, canvasMemoryLimit)\n        .then((imageData) => ImageOrienter.apply(imageData, orientation))\n        .then(resolve)\n        .catch(reject);\n    // cannot create image bitmaps in worker\n    if (!canCreateImageBitmap() || isSVGFile(file))\n        return toImageData(file);\n    // create image bitmap in thread\n    let imageBitmap;\n    try {\n        imageBitmap = await thread((file, done) => createImageBitmap(file)\n            .then((bitmap) => done(null, bitmap))\n            .catch(done), [file]);\n    }\n    catch (err) {\n        // fails silently on purpose, we'll try to turn the blob into image data in the main thread\n        // console.error(err);\n    }\n    // no bitmap returned, something went wrong in `createImageBitmap` logic\n    if (!imageBitmap || !imageBitmap.width)\n        return toImageData(file);\n    // if the browser can't orient images, we need to correct the orientation now\n    if (!(await canOrientImages()))\n        return resolve(ImageOrienter.apply(imageBitmap, orientation));\n    // need to convert so oriented image can be used as WebGL texture\n    // converting ImageBitmap to <canvas> (and then optionally to image data) fixes a Chrome render bug where the\n    // ImageBitmap when used in WebGL doesn't render in the correct orientation\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=1082451&q=orientation%20imagebitmap&can=2\n    if (isChrome() && orientation > 1)\n        return resolve(await imageBitmapToImageData(imageBitmap));\n    // yay we got our bitmap\n    resolve(imageBitmap);\n});\n\nvar imageDataContain = (imageData, size) => new Promise(async (resolve) => {\n    if (imageData.width < size.width && imageData.height < size.height)\n        return resolve(imageData);\n    const scalar = Math.min(size.width / imageData.width, size.height / imageData.height);\n    // scale\n    const targetWidth = scalar * imageData.width;\n    const targetHeight = scalar * imageData.height;\n    const canvas = h('canvas', {\n        width: targetWidth,\n        height: targetHeight,\n    });\n    const ctx = canvas.getContext('2d');\n    const data = isImageData(imageData)\n        ? (await imageDataToCanvas(imageData))\n        : imageData;\n    ctx.drawImage(data, 0, 0, targetWidth, targetHeight);\n    resolve(canvasToImageData(canvas));\n});\n\nlet limit = null;\nvar getWebGLTextureSizeLimit = () => {\n    if (limit !== null)\n        return limit;\n    const canvas = h('canvas');\n    const gl = getWebGLContext(canvas);\n    limit = gl ? gl.getParameter(gl.MAX_TEXTURE_SIZE) : undefined;\n    releaseCanvas(canvas);\n    return limit;\n};\n\nvar getDevicePixelRatio = () => (isBrowser() && window.devicePixelRatio) || 1;\n\nvar hexToRGB = (str) => {\n    const [, q, w, e] = str.split('');\n    str = str.length === 4 ? `#${q}${q}${w}${w}${e}${e}` : str;\n    const [, r, g, b] = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(str);\n    return [r, g, b].map((v) => parseInt(v, 16) / 255);\n};\n\nvar colorStringToColorArray = (color) => {\n    // if rgba(128, 128, 128, .5)\n    if (/^rgba/.test(color)) {\n        return color\n            .substr(5)\n            .split(',')\n            .map(parseFloat)\n            .map((v, i) => v / (i === 3 ? 1 : 255));\n    }\n    // if rgb(128, 128, 128)\n    if (/^rgb/.test(color)) {\n        return color\n            .substr(4)\n            .split(',')\n            .map(parseFloat)\n            .map((v) => v / 255);\n    }\n    // if #777\n    if (/^#/.test(color)) {\n        return hexToRGB(color);\n    }\n};\n\nvar isDarkColor = (color) => {\n    return color[0] < 0.25 && color[1] < 0.25 && color[2] < 0.25;\n};\n\nlet result$9 = null;\nvar supportsWebGL = () => {\n    if (result$9 === null) {\n        const canvas = h('canvas');\n        result$9 = !!getWebGLContext(canvas);\n        releaseCanvas(canvas);\n    }\n    return result$9;\n};\n\n/* src/core/ui/index.svelte generated by Svelte v3.29.4 */\n\nfunction create_if_block$2(ctx) {\n\tlet t;\n\tlet if_block1_anchor;\n\tlet current;\n\tlet if_block0 = /*isStatusVisible*/ ctx[47] && create_if_block_5(ctx);\n\tlet if_block1 = /*$imagePreview*/ ctx[38] && !/*isSupportsError*/ ctx[32] && create_if_block_1$1(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tif_block1_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (if_block0) if_block0.m(target, anchor);\n\t\t\tinsert(target, t, anchor);\n\t\t\tif (if_block1) if_block1.m(target, anchor);\n\t\t\tinsert(target, if_block1_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*isStatusVisible*/ ctx[47]) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[1] & /*isStatusVisible*/ 65536) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_5(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(t.parentNode, t);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (/*$imagePreview*/ ctx[38] && !/*isSupportsError*/ ctx[32]) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[1] & /*$imagePreview, isSupportsError*/ 130) {\n\t\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block_1$1(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\tif_block1.m(if_block1_anchor.parentNode, if_block1_anchor);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block1, 1, 1, () => {\n\t\t\t\t\tif_block1 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\ttransition_in(if_block1);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\ttransition_out(if_block1);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (if_block0) if_block0.d(detaching);\n\t\t\tif (detaching) detach(t);\n\t\t\tif (if_block1) if_block1.d(detaching);\n\t\t\tif (detaching) detach(if_block1_anchor);\n\t\t}\n\t};\n}\n\n// (1410:2) {#if isStatusVisible}\nfunction create_if_block_5(ctx) {\n\tlet div;\n\tlet p;\n\tlet current_block_type_index;\n\tlet if_block;\n\tlet p_style_value;\n\tlet div_style_value;\n\tlet current;\n\tconst if_block_creators = [create_if_block_6, create_if_block_7, create_if_block_9];\n\tconst if_blocks = [];\n\n\tfunction select_block_type(ctx, dirty) {\n\t\tif (/*isSupportsError*/ ctx[32]) return 0;\n\t\tif (/*isWaitingForImage*/ ctx[34] || /*isImageLoadError*/ ctx[33] || /*isLoadingImageData*/ ctx[36] || /*isCreatingImagePreview*/ ctx[37]) return 1;\n\t\tif (/*isProcessingImage*/ ctx[39] && /*imageProcessStatusLabel*/ ctx[42]) return 2;\n\t\treturn -1;\n\t}\n\n\tif (~(current_block_type_index = select_block_type(ctx))) {\n\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tp = element(\"p\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(p, \"style\", p_style_value = `transform: translateX(${/*$statusOffsetX*/ ctx[48]}px)`);\n\t\t\tattr(div, \"class\", \"DokaStatus\");\n\t\t\tattr(div, \"style\", div_style_value = `opacity: ${/*$statusOpacity*/ ctx[46]}`);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tappend(div, p);\n\n\t\t\tif (~current_block_type_index) {\n\t\t\t\tif_blocks[current_block_type_index].m(p, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tlet previous_block_index = current_block_type_index;\n\t\t\tcurrent_block_type_index = select_block_type(ctx);\n\n\t\t\tif (current_block_type_index === previous_block_index) {\n\t\t\t\tif (~current_block_type_index) {\n\t\t\t\t\tif_blocks[current_block_type_index].p(ctx, dirty);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tgroup_outros();\n\n\t\t\t\t\ttransition_out(if_blocks[previous_block_index], 1, 1, () => {\n\t\t\t\t\t\tif_blocks[previous_block_index] = null;\n\t\t\t\t\t});\n\n\t\t\t\t\tcheck_outros();\n\t\t\t\t}\n\n\t\t\t\tif (~current_block_type_index) {\n\t\t\t\t\tif_block = if_blocks[current_block_type_index];\n\n\t\t\t\t\tif (!if_block) {\n\t\t\t\t\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t\t\t\t\t\tif_block.c();\n\t\t\t\t\t}\n\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(p, null);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty[1] & /*$statusOffsetX*/ 131072 && p_style_value !== (p_style_value = `transform: translateX(${/*$statusOffsetX*/ ctx[48]}px)`)) {\n\t\t\t\tattr(p, \"style\", p_style_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[1] & /*$statusOpacity*/ 32768 && div_style_value !== (div_style_value = `opacity: ${/*$statusOpacity*/ ctx[46]}`)) {\n\t\t\t\tattr(div, \"style\", div_style_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\n\t\t\tif (~current_block_type_index) {\n\t\t\t\tif_blocks[current_block_type_index].d();\n\t\t\t}\n\t\t}\n\t};\n}\n\n// (1433:58) \nfunction create_if_block_9(ctx) {\n\tlet statusmessage;\n\tlet t0;\n\tlet statusprogress;\n\tlet t1;\n\tlet if_block_anchor;\n\tlet current;\n\n\tstatusmessage = new StatusMessage({\n\t\t\tprops: {\n\t\t\t\ttext: /*imageProcessStatusLabel*/ ctx[42],\n\t\t\t\tonmeasure: /*offsetProgress*/ ctx[106]\n\t\t\t}\n\t\t});\n\n\tstatusprogress = new StatusProgress({\n\t\t\tprops: {\n\t\t\t\toffset: /*$progressOffsetX*/ ctx[49],\n\t\t\t\tvisible: /*imageProcessShowProgressIndicator*/ ctx[44],\n\t\t\t\tprogress: /*imageProcessProgress*/ ctx[43]\n\t\t\t}\n\t\t});\n\n\tlet if_block = /*isImageProcessingError*/ ctx[45] && create_if_block_10(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(statusmessage.$$.fragment);\n\t\t\tt0 = space();\n\t\t\tcreate_component(statusprogress.$$.fragment);\n\t\t\tt1 = space();\n\t\t\tif (if_block) if_block.c();\n\t\t\tif_block_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(statusmessage, target, anchor);\n\t\t\tinsert(target, t0, anchor);\n\t\t\tmount_component(statusprogress, target, anchor);\n\t\t\tinsert(target, t1, anchor);\n\t\t\tif (if_block) if_block.m(target, anchor);\n\t\t\tinsert(target, if_block_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst statusmessage_changes = {};\n\t\t\tif (dirty[1] & /*imageProcessStatusLabel*/ 2048) statusmessage_changes.text = /*imageProcessStatusLabel*/ ctx[42];\n\t\t\tstatusmessage.$set(statusmessage_changes);\n\t\t\tconst statusprogress_changes = {};\n\t\t\tif (dirty[1] & /*$progressOffsetX*/ 262144) statusprogress_changes.offset = /*$progressOffsetX*/ ctx[49];\n\t\t\tif (dirty[1] & /*imageProcessShowProgressIndicator*/ 8192) statusprogress_changes.visible = /*imageProcessShowProgressIndicator*/ ctx[44];\n\t\t\tif (dirty[1] & /*imageProcessProgress*/ 4096) statusprogress_changes.progress = /*imageProcessProgress*/ ctx[43];\n\t\t\tstatusprogress.$set(statusprogress_changes);\n\n\t\t\tif (/*isImageProcessingError*/ ctx[45]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[1] & /*isImageProcessingError*/ 16384) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_10(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(if_block_anchor.parentNode, if_block_anchor);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(statusmessage.$$.fragment, local);\n\t\t\ttransition_in(statusprogress.$$.fragment, local);\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(statusmessage.$$.fragment, local);\n\t\t\ttransition_out(statusprogress.$$.fragment, local);\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(statusmessage, detaching);\n\t\t\tif (detaching) detach(t0);\n\t\t\tdestroy_component(statusprogress, detaching);\n\t\t\tif (detaching) detach(t1);\n\t\t\tif (if_block) if_block.d(detaching);\n\t\t\tif (detaching) detach(if_block_anchor);\n\t\t}\n\t};\n}\n\n// (1422:99) \nfunction create_if_block_7(ctx) {\n\tlet statusmessage;\n\tlet t0;\n\tlet statusprogress;\n\tlet t1;\n\tlet if_block_anchor;\n\tlet current;\n\n\tstatusmessage = new StatusMessage({\n\t\t\tprops: {\n\t\t\t\ttext: /*imageLoadStatusLabel*/ ctx[41],\n\t\t\t\tonmeasure: /*offsetProgress*/ ctx[106]\n\t\t\t}\n\t\t});\n\n\tstatusprogress = new StatusProgress({\n\t\t\tprops: {\n\t\t\t\toffset: /*$progressOffsetX*/ ctx[49],\n\t\t\t\tvisible: /*imageLoadShowProgressIndicator*/ ctx[40],\n\t\t\t\tprogress: /*imageLoadProgress*/ ctx[35]\n\t\t\t}\n\t\t});\n\n\tlet if_block = /*isImageLoadError*/ ctx[33] && create_if_block_8(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(statusmessage.$$.fragment);\n\t\t\tt0 = space();\n\t\t\tcreate_component(statusprogress.$$.fragment);\n\t\t\tt1 = space();\n\t\t\tif (if_block) if_block.c();\n\t\t\tif_block_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(statusmessage, target, anchor);\n\t\t\tinsert(target, t0, anchor);\n\t\t\tmount_component(statusprogress, target, anchor);\n\t\t\tinsert(target, t1, anchor);\n\t\t\tif (if_block) if_block.m(target, anchor);\n\t\t\tinsert(target, if_block_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst statusmessage_changes = {};\n\t\t\tif (dirty[1] & /*imageLoadStatusLabel*/ 1024) statusmessage_changes.text = /*imageLoadStatusLabel*/ ctx[41];\n\t\t\tstatusmessage.$set(statusmessage_changes);\n\t\t\tconst statusprogress_changes = {};\n\t\t\tif (dirty[1] & /*$progressOffsetX*/ 262144) statusprogress_changes.offset = /*$progressOffsetX*/ ctx[49];\n\t\t\tif (dirty[1] & /*imageLoadShowProgressIndicator*/ 512) statusprogress_changes.visible = /*imageLoadShowProgressIndicator*/ ctx[40];\n\t\t\tif (dirty[1] & /*imageLoadProgress*/ 16) statusprogress_changes.progress = /*imageLoadProgress*/ ctx[35];\n\t\t\tstatusprogress.$set(statusprogress_changes);\n\n\t\t\tif (/*isImageLoadError*/ ctx[33]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[1] & /*isImageLoadError*/ 4) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_8(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(if_block_anchor.parentNode, if_block_anchor);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(statusmessage.$$.fragment, local);\n\t\t\ttransition_in(statusprogress.$$.fragment, local);\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(statusmessage.$$.fragment, local);\n\t\t\ttransition_out(statusprogress.$$.fragment, local);\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(statusmessage, detaching);\n\t\t\tif (detaching) detach(t0);\n\t\t\tdestroy_component(statusprogress, detaching);\n\t\t\tif (detaching) detach(t1);\n\t\t\tif (if_block) if_block.d(detaching);\n\t\t\tif (detaching) detach(if_block_anchor);\n\t\t}\n\t};\n}\n\n// (1414:3) {#if isSupportsError}\nfunction create_if_block_6(ctx) {\n\tlet statusmessage;\n\tlet t;\n\tlet span;\n\tlet icon;\n\tlet span_style_value;\n\tlet current;\n\n\tstatusmessage = new StatusMessage({\n\t\t\tprops: {\n\t\t\t\ttext: /*isSupportsError*/ ctx[32],\n\t\t\t\tonmeasure: /*offsetProgress*/ ctx[106]\n\t\t\t}\n\t\t});\n\n\ticon = new Icon({\n\t\t\tprops: {\n\t\t\t\t$$slots: { default: [create_default_slot_4] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(statusmessage.$$.fragment);\n\t\t\tt = space();\n\t\t\tspan = element(\"span\");\n\t\t\tcreate_component(icon.$$.fragment);\n\t\t\tattr(span, \"class\", \"DokaStatusIcon\");\n\t\t\tattr(span, \"style\", span_style_value = `transform: translateX(${/*$progressOffsetX*/ ctx[49]}px)`);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(statusmessage, target, anchor);\n\t\t\tinsert(target, t, anchor);\n\t\t\tinsert(target, span, anchor);\n\t\t\tmount_component(icon, span, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst statusmessage_changes = {};\n\t\t\tif (dirty[1] & /*isSupportsError*/ 2) statusmessage_changes.text = /*isSupportsError*/ ctx[32];\n\t\t\tstatusmessage.$set(statusmessage_changes);\n\t\t\tconst icon_changes = {};\n\n\t\t\tif (dirty[0] & /*locale*/ 4 | dirty[8] & /*$$scope*/ 4096) {\n\t\t\t\ticon_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon.$set(icon_changes);\n\n\t\t\tif (!current || dirty[1] & /*$progressOffsetX*/ 262144 && span_style_value !== (span_style_value = `transform: translateX(${/*$progressOffsetX*/ ctx[49]}px)`)) {\n\t\t\t\tattr(span, \"style\", span_style_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(statusmessage.$$.fragment, local);\n\t\t\ttransition_in(icon.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(statusmessage.$$.fragment, local);\n\t\t\ttransition_out(icon.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(statusmessage, detaching);\n\t\t\tif (detaching) detach(t);\n\t\t\tif (detaching) detach(span);\n\t\t\tdestroy_component(icon);\n\t\t}\n\t};\n}\n\n// (1438:4) {#if isImageProcessingError}\nfunction create_if_block_10(ctx) {\n\tlet span;\n\tlet button;\n\tlet span_style_value;\n\tlet current;\n\n\tbutton = new Button({\n\t\t\tprops: {\n\t\t\t\tonclick: /*handleCloseImageProcessError*/ ctx[108],\n\t\t\t\tlabel: /*locale*/ ctx[2].statusLabelButtonClose,\n\t\t\t\ticon: /*locale*/ ctx[2].statusIconButtonClose,\n\t\t\t\thideLabel: true\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tcreate_component(button.$$.fragment);\n\t\t\tattr(span, \"class\", \"DokaStatusButton\");\n\t\t\tattr(span, \"style\", span_style_value = `transform: translateX(${/*$progressOffsetX*/ ctx[49]}px)`);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tmount_component(button, span, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst button_changes = {};\n\t\t\tif (dirty[0] & /*locale*/ 4) button_changes.label = /*locale*/ ctx[2].statusLabelButtonClose;\n\t\t\tif (dirty[0] & /*locale*/ 4) button_changes.icon = /*locale*/ ctx[2].statusIconButtonClose;\n\t\t\tbutton.$set(button_changes);\n\n\t\t\tif (!current || dirty[1] & /*$progressOffsetX*/ 262144 && span_style_value !== (span_style_value = `transform: translateX(${/*$progressOffsetX*/ ctx[49]}px)`)) {\n\t\t\t\tattr(span, \"style\", span_style_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(button.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(button.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t\tdestroy_component(button);\n\t\t}\n\t};\n}\n\n// (1427:4) {#if isImageLoadError}\nfunction create_if_block_8(ctx) {\n\tlet span;\n\tlet button;\n\tlet span_style_value;\n\tlet current;\n\n\tbutton = new Button({\n\t\t\tprops: {\n\t\t\t\tonclick: /*handleCloseImageLoadError*/ ctx[107],\n\t\t\t\tlabel: /*locale*/ ctx[2].statusLabelButtonClose,\n\t\t\t\ticon: /*locale*/ ctx[2].statusIconButtonClose,\n\t\t\t\thideLabel: true\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tcreate_component(button.$$.fragment);\n\t\t\tattr(span, \"class\", \"DokaStatusButton\");\n\t\t\tattr(span, \"style\", span_style_value = `transform: translateX(${/*$progressOffsetX*/ ctx[49]}px)`);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tmount_component(button, span, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst button_changes = {};\n\t\t\tif (dirty[0] & /*locale*/ 4) button_changes.label = /*locale*/ ctx[2].statusLabelButtonClose;\n\t\t\tif (dirty[0] & /*locale*/ 4) button_changes.icon = /*locale*/ ctx[2].statusIconButtonClose;\n\t\t\tbutton.$set(button_changes);\n\n\t\t\tif (!current || dirty[1] & /*$progressOffsetX*/ 262144 && span_style_value !== (span_style_value = `transform: translateX(${/*$progressOffsetX*/ ctx[49]}px)`)) {\n\t\t\t\tattr(span, \"style\", span_style_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(button.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(button.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t\tdestroy_component(button);\n\t\t}\n\t};\n}\n\n// (1419:5) <Icon>\nfunction create_default_slot_4(ctx) {\n\tlet g;\n\tlet raw_value = /*locale*/ ctx[2].iconSupportError + \"\";\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = raw_value;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*locale*/ 4 && raw_value !== (raw_value = /*locale*/ ctx[2].iconSupportError + \"\")) g.innerHTML = raw_value;\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (1449:2) {#if $imagePreview && !isSupportsError}\nfunction create_if_block_1$1(ctx) {\n\tlet t0;\n\tlet t1;\n\tlet current_block_type_index;\n\tlet if_block2;\n\tlet t2;\n\tlet canvas;\n\tlet t3;\n\tlet div;\n\tlet current;\n\tlet if_block0 = /*enableToolbar*/ ctx[6] && create_if_block_4(ctx);\n\tlet if_block1 = /*shouldRenderTabs*/ ctx[16] && /*showUtils*/ ctx[14] && create_if_block_3(ctx);\n\tconst if_block_creators = [create_if_block_2, create_else_block$1];\n\tconst if_blocks = [];\n\n\tfunction select_block_type_1(ctx, dirty) {\n\t\tif (/*shouldRenderTabs*/ ctx[16]) return 0;\n\t\treturn 1;\n\t}\n\n\tcurrent_block_type_index = select_block_type_1(ctx);\n\tif_block2 = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\n\tcanvas = new Canvas({\n\t\t\tprops: {\n\t\t\t\tanimate: /*shouldAnimate*/ ctx[18],\n\t\t\t\tpixelRatio: /*$pixelRatio*/ ctx[56],\n\t\t\t\tbackgroundColor: /*$rootBackgroundColor*/ ctx[28],\n\t\t\t\tmaskRect: /*$imageSelectionRectPresentation*/ ctx[31],\n\t\t\t\timageSize: /*$imageSize*/ ctx[17],\n\t\t\t\timageData: /*$imagePreview*/ ctx[38],\n\t\t\t\timageProps: /*imageProps*/ ctx[30],\n\t\t\t\timagePreviews: /*$imagePreviews*/ ctx[57],\n\t\t\t\tloadImageData: /*imageSourceToImageData*/ ctx[8],\n\t\t\t\twillRender: /*func_2*/ ctx[152]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt0 = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tt1 = space();\n\t\t\tif_block2.c();\n\t\t\tt2 = space();\n\t\t\tcreate_component(canvas.$$.fragment);\n\t\t\tt3 = space();\n\t\t\tdiv = element(\"div\");\n\t\t\tattr(div, \"class\", \"DokaRootPortal\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (if_block0) if_block0.m(target, anchor);\n\t\t\tinsert(target, t0, anchor);\n\t\t\tif (if_block1) if_block1.m(target, anchor);\n\t\t\tinsert(target, t1, anchor);\n\t\t\tif_blocks[current_block_type_index].m(target, anchor);\n\t\t\tinsert(target, t2, anchor);\n\t\t\tmount_component(canvas, target, anchor);\n\t\t\tinsert(target, t3, anchor);\n\t\t\tinsert(target, div, anchor);\n\t\t\t/*div_binding*/ ctx[153](div);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*enableToolbar*/ ctx[6]) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*enableToolbar*/ 64) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_4(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(t0.parentNode, t0);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (/*shouldRenderTabs*/ ctx[16] && /*showUtils*/ ctx[14]) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*shouldRenderTabs, showUtils*/ 81920) {\n\t\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block_3(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\tif_block1.m(t1.parentNode, t1);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block1, 1, 1, () => {\n\t\t\t\t\tif_block1 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tlet previous_block_index = current_block_type_index;\n\t\t\tcurrent_block_type_index = select_block_type_1(ctx);\n\n\t\t\tif (current_block_type_index === previous_block_index) {\n\t\t\t\tif_blocks[current_block_type_index].p(ctx, dirty);\n\t\t\t} else {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_blocks[previous_block_index], 1, 1, () => {\n\t\t\t\t\tif_blocks[previous_block_index] = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t\tif_block2 = if_blocks[current_block_type_index];\n\n\t\t\t\tif (!if_block2) {\n\t\t\t\t\tif_block2 = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t\t\t\t\tif_block2.c();\n\t\t\t\t}\n\n\t\t\t\ttransition_in(if_block2, 1);\n\t\t\t\tif_block2.m(t2.parentNode, t2);\n\t\t\t}\n\n\t\t\tconst canvas_changes = {};\n\t\t\tif (dirty[0] & /*shouldAnimate*/ 262144) canvas_changes.animate = /*shouldAnimate*/ ctx[18];\n\t\t\tif (dirty[1] & /*$pixelRatio*/ 33554432) canvas_changes.pixelRatio = /*$pixelRatio*/ ctx[56];\n\t\t\tif (dirty[0] & /*$rootBackgroundColor*/ 268435456) canvas_changes.backgroundColor = /*$rootBackgroundColor*/ ctx[28];\n\t\t\tif (dirty[1] & /*$imageSelectionRectPresentation*/ 1) canvas_changes.maskRect = /*$imageSelectionRectPresentation*/ ctx[31];\n\t\t\tif (dirty[0] & /*$imageSize*/ 131072) canvas_changes.imageSize = /*$imageSize*/ ctx[17];\n\t\t\tif (dirty[1] & /*$imagePreview*/ 128) canvas_changes.imageData = /*$imagePreview*/ ctx[38];\n\t\t\tif (dirty[0] & /*imageProps*/ 1073741824) canvas_changes.imageProps = /*imageProps*/ ctx[30];\n\t\t\tif (dirty[1] & /*$imagePreviews*/ 67108864) canvas_changes.imagePreviews = /*$imagePreviews*/ ctx[57];\n\t\t\tif (dirty[0] & /*imageSourceToImageData*/ 256) canvas_changes.loadImageData = /*imageSourceToImageData*/ ctx[8];\n\t\t\tif (dirty[0] & /*willRenderCanvas*/ 32 | dirty[1] & /*$imageDecoration, $imageAnnotation, $imageOverlay*/ 939524096) canvas_changes.willRender = /*func_2*/ ctx[152];\n\t\t\tcanvas.$set(canvas_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\ttransition_in(if_block1);\n\t\t\ttransition_in(if_block2);\n\t\t\ttransition_in(canvas.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\ttransition_out(if_block1);\n\t\t\ttransition_out(if_block2);\n\t\t\ttransition_out(canvas.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (if_block0) if_block0.d(detaching);\n\t\t\tif (detaching) detach(t0);\n\t\t\tif (if_block1) if_block1.d(detaching);\n\t\t\tif (detaching) detach(t1);\n\t\t\tif_blocks[current_block_type_index].d(detaching);\n\t\t\tif (detaching) detach(t2);\n\t\t\tdestroy_component(canvas, detaching);\n\t\t\tif (detaching) detach(t3);\n\t\t\tif (detaching) detach(div);\n\t\t\t/*div_binding*/ ctx[153](null);\n\t\t}\n\t};\n}\n\n// (1451:3) {#if enableToolbar}\nfunction create_if_block_4(ctx) {\n\tlet div;\n\tlet dynamiccomponenttree;\n\tlet measurable_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\tdynamiccomponenttree = new DynamicComponentTree_1({\n\t\t\tprops: { items: /*toolbarItems*/ ctx[51] }\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(dynamiccomponenttree.$$.fragment);\n\t\t\tattr(div, \"class\", \"DokaNav DokaNavTools\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(dynamiccomponenttree, div, null);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div, \"measure\", /*measure_handler*/ ctx[137]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst dynamiccomponenttree_changes = {};\n\t\t\tif (dirty[1] & /*toolbarItems*/ 1048576) dynamiccomponenttree_changes.items = /*toolbarItems*/ ctx[51];\n\t\t\tdynamiccomponenttree.$set(dynamiccomponenttree_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(dynamiccomponenttree.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(dynamiccomponenttree.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(dynamiccomponenttree);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\n// (1457:3) {#if shouldRenderTabs && showUtils }\nfunction create_if_block_3(ctx) {\n\tlet div;\n\tlet scrollable;\n\tlet current;\n\n\tscrollable = new Scrollable({\n\t\t\tprops: {\n\t\t\t\telasticity: /*elasticityMultiplier*/ ctx[4] * scrollElasticity,\n\t\t\t\tscrollDirection: /*isLandscape*/ ctx[27] ? \"y\" : \"x\",\n\t\t\t\t$$slots: { default: [create_default_slot_1] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(scrollable.$$.fragment);\n\t\t\tattr(div, \"class\", \"DokaNav DokaNavMain\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(scrollable, div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst scrollable_changes = {};\n\t\t\tif (dirty[0] & /*elasticityMultiplier*/ 16) scrollable_changes.elasticity = /*elasticityMultiplier*/ ctx[4] * scrollElasticity;\n\t\t\tif (dirty[0] & /*isLandscape*/ 134217728) scrollable_changes.scrollDirection = /*isLandscape*/ ctx[27] ? \"y\" : \"x\";\n\n\t\t\tif (dirty[0] & /*tabsConfig, tabs, utilSelected*/ 27262976 | dirty[8] & /*$$scope*/ 4096) {\n\t\t\t\tscrollable_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tscrollable.$set(scrollable_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(scrollable.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(scrollable.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(scrollable);\n\t\t}\n\t};\n}\n\n// (1461:6) <Icon>\nfunction create_default_slot_3(ctx) {\n\tlet g;\n\tlet raw_value = /*tab*/ ctx[259].icon + \"\";\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = raw_value;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[8] & /*tab*/ 2048 && raw_value !== (raw_value = /*tab*/ ctx[259].icon + \"\")) g.innerHTML = raw_value;\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (1460:5) <TabList {...tabsConfig} {tabs} on:select={({ detail }) => utilSelected = detail} let:tab={tab}>\nfunction create_default_slot_2(ctx) {\n\tlet icon;\n\tlet t0;\n\tlet span;\n\tlet t1_value = /*tab*/ ctx[259].label + \"\";\n\tlet t1;\n\tlet current;\n\n\ticon = new Icon({\n\t\t\tprops: {\n\t\t\t\t$$slots: { default: [create_default_slot_3] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(icon.$$.fragment);\n\t\t\tt0 = space();\n\t\t\tspan = element(\"span\");\n\t\t\tt1 = text(t1_value);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(icon, target, anchor);\n\t\t\tinsert(target, t0, anchor);\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t1);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst icon_changes = {};\n\n\t\t\tif (dirty[8] & /*$$scope, tab*/ 6144) {\n\t\t\t\ticon_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon.$set(icon_changes);\n\t\t\tif ((!current || dirty[8] & /*tab*/ 2048) && t1_value !== (t1_value = /*tab*/ ctx[259].label + \"\")) set_data(t1, t1_value);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(icon, detaching);\n\t\t\tif (detaching) detach(t0);\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (1459:4) <Scrollable elasticity={elasticityMultiplier * scrollElasticity} scrollDirection={isLandscape ? 'y' : 'x'}>\nfunction create_default_slot_1(ctx) {\n\tlet tablist;\n\tlet current;\n\tconst tablist_spread_levels = [/*tabsConfig*/ ctx[23], { tabs: /*tabs*/ ctx[24] }];\n\n\tlet tablist_props = {\n\t\t$$slots: {\n\t\t\tdefault: [\n\t\t\t\tcreate_default_slot_2,\n\t\t\t\t({ tab }) => ({ 259: tab }),\n\t\t\t\t({ tab }) => [0, 0, 0, 0, 0, 0, 0, 0, tab ? 2048 : 0]\n\t\t\t]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tfor (let i = 0; i < tablist_spread_levels.length; i += 1) {\n\t\ttablist_props = assign(tablist_props, tablist_spread_levels[i]);\n\t}\n\n\ttablist = new TabList({ props: tablist_props });\n\ttablist.$on(\"select\", /*select_handler*/ ctx[138]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(tablist.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(tablist, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst tablist_changes = (dirty[0] & /*tabsConfig, tabs*/ 25165824)\n\t\t\t? get_spread_update(tablist_spread_levels, [\n\t\t\t\t\tdirty[0] & /*tabsConfig*/ 8388608 && get_spread_object(/*tabsConfig*/ ctx[23]),\n\t\t\t\t\tdirty[0] & /*tabs*/ 16777216 && { tabs: /*tabs*/ ctx[24] }\n\t\t\t\t])\n\t\t\t: {};\n\n\t\t\tif (dirty[8] & /*$$scope, tab*/ 6144) {\n\t\t\t\ttablist_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ttablist.$set(tablist_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(tablist.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(tablist.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(tablist, detaching);\n\t\t}\n\t};\n}\n\n// (1481:3) {:else}\nfunction create_else_block$1(ctx) {\n\tlet panel;\n\tlet updating_component;\n\tlet current;\n\n\tfunction panel_component_binding_1(value) {\n\t\t/*panel_component_binding_1*/ ctx[147].call(null, value);\n\t}\n\n\tlet panel_props = {\n\t\tclass: \"DokaMain\",\n\t\tcontent: {\n\t\t\t.../*utilsMerged*/ ctx[20].find(/*func_1*/ ctx[146]),\n\t\t\tprops: /*pluginOptions*/ ctx[7][/*utilSelected*/ ctx[21]]\n\t\t},\n\t\tlocale: /*locale*/ ctx[2],\n\t\tstores: /*utilStores*/ ctx[101]\n\t};\n\n\tif (/*pluginInterface*/ ctx[0][/*utilSelected*/ ctx[21]] !== void 0) {\n\t\tpanel_props.component = /*pluginInterface*/ ctx[0][/*utilSelected*/ ctx[21]];\n\t}\n\n\tpanel = new Panel({ props: panel_props });\n\tbinding_callbacks.push(() => bind(panel, \"component\", panel_component_binding_1));\n\tpanel.$on(\"measure\", /*measure_handler_3*/ ctx[148]);\n\tpanel.$on(\"show\", /*show_handler_1*/ ctx[149]);\n\tpanel.$on(\"hide\", /*hide_handler_1*/ ctx[150]);\n\tpanel.$on(\"fade\", /*fade_handler_1*/ ctx[151]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(panel.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(panel, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst panel_changes = {};\n\n\t\t\tif (dirty[0] & /*utilsMerged, utilSelected, pluginOptions*/ 3145856) panel_changes.content = {\n\t\t\t\t.../*utilsMerged*/ ctx[20].find(/*func_1*/ ctx[146]),\n\t\t\t\tprops: /*pluginOptions*/ ctx[7][/*utilSelected*/ ctx[21]]\n\t\t\t};\n\n\t\t\tif (dirty[0] & /*locale*/ 4) panel_changes.locale = /*locale*/ ctx[2];\n\n\t\t\tif (!updating_component && dirty[0] & /*pluginInterface, utilSelected*/ 2097153) {\n\t\t\t\tupdating_component = true;\n\t\t\t\tpanel_changes.component = /*pluginInterface*/ ctx[0][/*utilSelected*/ ctx[21]];\n\t\t\t\tadd_flush_callback(() => updating_component = false);\n\t\t\t}\n\n\t\t\tpanel.$set(panel_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(panel.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(panel.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(panel, detaching);\n\t\t}\n\t};\n}\n\n// (1468:3) {#if shouldRenderTabs}\nfunction create_if_block_2(ctx) {\n\tlet tabpanels;\n\tlet current;\n\n\tconst tabpanels_spread_levels = [\n\t\t{ class: \"DokaMain\" },\n\t\t{ visible: /*utilsVisible*/ ctx[12] },\n\t\t/*tabsConfig*/ ctx[23],\n\t\t{ panels: /*panels*/ ctx[25] }\n\t];\n\n\tlet tabpanels_props = {\n\t\t$$slots: {\n\t\t\tdefault: [\n\t\t\t\tcreate_default_slot$1,\n\t\t\t\t({ panel }) => ({ 258: panel }),\n\t\t\t\t({ panel }) => [0, 0, 0, 0, 0, 0, 0, 0, panel ? 1024 : 0]\n\t\t\t]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tfor (let i = 0; i < tabpanels_spread_levels.length; i += 1) {\n\t\ttabpanels_props = assign(tabpanels_props, tabpanels_spread_levels[i]);\n\t}\n\n\ttabpanels = new TabPanels({ props: tabpanels_props });\n\ttabpanels.$on(\"measure\", /*measure_handler_2*/ ctx[145]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(tabpanels.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(tabpanels, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst tabpanels_changes = (dirty[0] & /*utilsVisible, tabsConfig, panels*/ 41947136)\n\t\t\t? get_spread_update(tabpanels_spread_levels, [\n\t\t\t\t\ttabpanels_spread_levels[0],\n\t\t\t\t\tdirty[0] & /*utilsVisible*/ 4096 && { visible: /*utilsVisible*/ ctx[12] },\n\t\t\t\t\tdirty[0] & /*tabsConfig*/ 8388608 && get_spread_object(/*tabsConfig*/ ctx[23]),\n\t\t\t\t\tdirty[0] & /*panels*/ 33554432 && { panels: /*panels*/ ctx[25] }\n\t\t\t\t])\n\t\t\t: {};\n\n\t\t\tif (dirty[0] & /*utilsMerged, pluginOptions, locale, utilSelected, pluginInterface, utilsVisible, utilsVisibleFraction*/ 7344261 | dirty[1] & /*$utilRect*/ 16777216 | dirty[8] & /*$$scope, panel*/ 5120) {\n\t\t\t\ttabpanels_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ttabpanels.$set(tabpanels_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(tabpanels.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(tabpanels.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(tabpanels, detaching);\n\t\t}\n\t};\n}\n\n// (1469:3) <TabPanels class=\"DokaMain\" visible={utilsVisible} {...tabsConfig} {panels} let:panel on:measure={e => $tabRect = e.detail}>\nfunction create_default_slot$1(ctx) {\n\tlet panel;\n\tlet updating_component;\n\tlet current;\n\n\tfunction func(...args) {\n\t\treturn /*func*/ ctx[139](/*panel*/ ctx[258], ...args);\n\t}\n\n\tfunction panel_component_binding(value) {\n\t\t/*panel_component_binding*/ ctx[140].call(null, value, /*panel*/ ctx[258]);\n\t}\n\n\tfunction show_handler(...args) {\n\t\treturn /*show_handler*/ ctx[142](/*panel*/ ctx[258], ...args);\n\t}\n\n\tfunction hide_handler(...args) {\n\t\treturn /*hide_handler*/ ctx[143](/*panel*/ ctx[258], ...args);\n\t}\n\n\tfunction fade_handler(...args) {\n\t\treturn /*fade_handler*/ ctx[144](/*panel*/ ctx[258], ...args);\n\t}\n\n\tlet panel_props = {\n\t\tcontent: {\n\t\t\t.../*utilsMerged*/ ctx[20].find(func),\n\t\t\tprops: /*pluginOptions*/ ctx[7][/*panel*/ ctx[258]]\n\t\t},\n\t\tlocale: /*locale*/ ctx[2],\n\t\tisActive: /*panel*/ ctx[258] === /*utilSelected*/ ctx[21],\n\t\tstores: /*utilStores*/ ctx[101]\n\t};\n\n\tif (/*pluginInterface*/ ctx[0][/*panel*/ ctx[258]] !== void 0) {\n\t\tpanel_props.component = /*pluginInterface*/ ctx[0][/*panel*/ ctx[258]];\n\t}\n\n\tpanel = new Panel({ props: panel_props });\n\tbinding_callbacks.push(() => bind(panel, \"component\", panel_component_binding));\n\tpanel.$on(\"measure\", /*measure_handler_1*/ ctx[141]);\n\tpanel.$on(\"show\", show_handler);\n\tpanel.$on(\"hide\", hide_handler);\n\tpanel.$on(\"fade\", fade_handler);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(panel.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(panel, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\t\t\tconst panel_changes = {};\n\n\t\t\tif (dirty[0] & /*utilsMerged, pluginOptions*/ 1048704 | dirty[8] & /*panel*/ 1024) panel_changes.content = {\n\t\t\t\t.../*utilsMerged*/ ctx[20].find(func),\n\t\t\t\tprops: /*pluginOptions*/ ctx[7][/*panel*/ ctx[258]]\n\t\t\t};\n\n\t\t\tif (dirty[0] & /*locale*/ 4) panel_changes.locale = /*locale*/ ctx[2];\n\t\t\tif (dirty[0] & /*utilSelected*/ 2097152 | dirty[8] & /*panel*/ 1024) panel_changes.isActive = /*panel*/ ctx[258] === /*utilSelected*/ ctx[21];\n\n\t\t\tif (!updating_component && dirty[0] & /*pluginInterface*/ 1 | dirty[8] & /*panel*/ 1024) {\n\t\t\t\tupdating_component = true;\n\t\t\t\tpanel_changes.component = /*pluginInterface*/ ctx[0][/*panel*/ ctx[258]];\n\t\t\t\tadd_flush_callback(() => updating_component = false);\n\t\t\t}\n\n\t\t\tpanel.$set(panel_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(panel.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(panel.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(panel, detaching);\n\t\t}\n\t};\n}\n\nfunction create_fragment$b(ctx) {\n\tlet div;\n\tlet measurable_action;\n\tlet focusvisible_action;\n\tlet dropable_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tadd_render_callback(/*onwindowresize*/ ctx[136]);\n\tlet if_block = /*canRender*/ ctx[52] && create_if_block$2(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(div, \"id\", /*id*/ ctx[3]);\n\t\t\tattr(div, \"class\", /*className*/ ctx[26]);\n\t\t\tattr(div, \"data-env\", /*envStr*/ ctx[29]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tif (if_block) if_block.m(div, null);\n\t\t\t/*div_binding_1*/ ctx[154](div);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(window, \"keydown\", /*handleKeydown*/ ctx[110]),\n\t\t\t\t\tlisten(window, \"keyup\", /*handleKeyup*/ ctx[111]),\n\t\t\t\t\tlisten(window, \"blur\", /*handleWindowBlur*/ ctx[112]),\n\t\t\t\t\tlisten(window, \"resize\", /*onwindowresize*/ ctx[136]),\n\t\t\t\t\tlisten(div, \"ping\", function () {\n\t\t\t\t\t\tif (is_function(/*routePing*/ ctx[53])) /*routePing*/ ctx[53].apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(div, \"contextmenu\", /*handleContextMenu*/ ctx[113]),\n\t\t\t\t\tlisten(div, \"touchstart\", function () {\n\t\t\t\t\t\tif (is_function(/*handleTouchStart*/ ctx[50])) /*handleTouchStart*/ ctx[50].apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(div, \"transitionend\", /*handleTransitionEnd*/ ctx[102]),\n\t\t\t\t\tlisten(div, \"dropfiles\", /*handleDropFiles*/ ctx[114]),\n\t\t\t\t\tlisten(div, \"measure\", /*measure_handler_4*/ ctx[155]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div, { observeViewRect: true })),\n\t\t\t\t\taction_destroyer(focusvisible_action = focusvisible.call(null, div)),\n\t\t\t\t\taction_destroyer(dropable_action = dropable.call(null, div))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\n\t\t\tif (/*canRender*/ ctx[52]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[1] & /*canRender*/ 2097152) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block$2(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div, null);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*id*/ 8) {\n\t\t\t\tattr(div, \"id\", /*id*/ ctx[3]);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*className*/ 67108864) {\n\t\t\t\tattr(div, \"class\", /*className*/ ctx[26]);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*envStr*/ 536870912) {\n\t\t\t\tattr(div, \"data-env\", /*envStr*/ ctx[29]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (if_block) if_block.d();\n\t\t\t/*div_binding_1*/ ctx[154](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nconst imageCropRectElasticity = 5;\n\n// updating crop selection / the intended selection rect, combined with actual selection rect, used to render elasticity visualisation\nconst imageSelectionRectElasticity = 1;\n\nconst scrollElasticity = 10;\nconst rangeInputElasticity = 5;\n\nfunction instance$b($$self, $$props, $$invalidate) {\n\tlet $images;\n\tlet $clientRect;\n\tlet $rootRect;\n\tlet $imageState;\n\tlet $imageLoadState;\n\tlet $imageCropRectSnapshot;\n\tlet $imageCropRectIntent;\n\tlet $previewShouldUpscale;\n\tlet $imageCropRect;\n\tlet $isInteracting;\n\tlet $imageSelectionRect;\n\tlet $imageSelectionRectIntent;\n\tlet $stageRect;\n\tlet $stageScalar;\n\tlet $imageSize;\n\tlet $presentationScalar;\n\tlet $imageSelectionRectSnapshot;\n\tlet $prefersReducedMotion;\n\tlet $tabRect;\n\n\tlet $history,\n\t\t$$unsubscribe_history = noop$1,\n\t\t$$subscribe_history = () => ($$unsubscribe_history(), $$unsubscribe_history = subscribe(history, $$value => $$invalidate(181, $history = $$value)), history);\n\n\tlet $imageProcessingPreparing;\n\tlet $rootBackgroundColor;\n\tlet $env;\n\tlet $pointerAccuracy;\n\tlet $pointerHoverable;\n\tlet $imageTransforms;\n\tlet $imagePreviewModifiers;\n\tlet $imageEffects;\n\tlet $imageBackgroundColor;\n\tlet $imageSelectionRectPresentation;\n\tlet $imageVisualLoadComplete;\n\tlet $imageFile;\n\tlet $imagePreview;\n\tlet $imageProcessState;\n\tlet $statusOpacity;\n\tlet $statusOffsetX;\n\tlet $progressOffsetX;\n\tlet $pressedKeysStore;\n\tlet $isInteractingFraction;\n\tlet $toolRect;\n\tlet $utilRect;\n\tlet $pixelRatio;\n\tlet $imagePreviews;\n\tlet $imageDecoration;\n\tlet $imageAnnotation;\n\tlet $imageOverlay;\n\tcomponent_subscribe($$self, prefersReducedMotion, $$value => $$invalidate(179, $prefersReducedMotion = $$value));\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_history());\n\tconst eventProxy = pubsub();\n\tconst dispatch = createEventDispatcher();\n\n\t//\n\t// View Props\n\t//\n\tlet { class: klass = undefined } = $$props;\n\n\tlet { layout: layoutMode = undefined } = $$props;\n\tlet { stores } = $$props;\n\tlet { locale = undefined } = $$props;\n\tlet { id = undefined } = $$props;\n\tlet { util = undefined } = $$props;\n\tlet { utils = undefined } = $$props; // which utils are active (list of ids), or is derived from plugins automatically\n\tlet { animations = \"auto\" } = $$props;\n\tlet { previewUpscale = false } = $$props;\n\tlet { elasticityMultiplier = 10 } = $$props;\n\tlet { willRevert = () => Promise.resolve(true) } = $$props;\n\tlet { willRenderCanvas = passthrough } = $$props;\n\tlet { willRenderToolbar = passthrough } = $$props;\n\tlet { enableButtonExport = true } = $$props;\n\tlet { enableButtonRevert = true } = $$props;\n\tlet { enableNavigateHistory = true } = $$props;\n\tlet { enableToolbar = true } = $$props;\n\tlet { enableUtils = true } = $$props;\n\tlet { enableButtonClose = false } = $$props;\n\tlet { previewImageDataMaxSize = undefined } = $$props;\n\tlet { enableDropImage = false } = $$props;\n\tlet { imageOrienter = { read: () => 1, apply: v => v } } = $$props;\n\tlet { pluginComponents = undefined } = $$props;\n\tlet { pluginOptions = {} } = $$props;\n\tconst sub = eventProxy.sub;\n\tconst pluginInterface = {};\n\tlet { root } = $$props;\n\tlet registeredPluginsComponents = [];\n\n\t// \n\t// this method is used to read image resources (preview image / shape images)\n\tconst glMaxTextureSize = getWebGLTextureSizeLimit() || 1024;\n\n\tconst maxTextureSize = sizeCreate(glMaxTextureSize, glMaxTextureSize);\n\tconst canvasMemoryLimit = isIOS() ? 4096 * 4096 : Infinity;\n\n\tlet { imageSourceToImageData = src => isString(src)\n\t? fetch(src).then(res => res.blob()).then(blob => blobToImageBitmap(blob, imageOrienter, canvasMemoryLimit)).then(imageData => imageDataContain(imageData, maxImageDataSize))\n\t: blobToImageBitmap(src, imageOrienter, canvasMemoryLimit).then(imageData => imageDataContain(imageData, maxImageDataSize)) } = $$props;\n\n\tconst imageProxy = createImageProxy();\n\tconst { file: imageFile, size: imageSize, loadState: imageLoadState, processState: imageProcessState, cropAspectRatio: imageCropAspectRatio, cropLimitToImage: imageCropLimitToImage, crop: imageCropRect, cropMinSize: imageCropMinSize, cropMaxSize: imageCropMaxSize, cropRange: imageCropRange, cropOrigin: imageCropRectOrigin, cropRectAspectRatio: imageCropRectAspectRatio, rotation: imageRotation, rotationRange: imageRotationRange, targetSize: imageOutputSize, flipX: imageFlipX, flipY: imageFlipY, backgroundColor: imageBackgroundColor, colorMatrix: imageColorMatrix, convolutionMatrix: imageConvolutionMatrix, gamma: imageGamma, vignette: imageVignette, noise: imageNoise, decoration: imageDecoration, annotation: imageAnnotation, state: imageState } = imageProxy.stores;\n\tcomponent_subscribe($$self, imageFile, value => $$invalidate(210, $imageFile = value));\n\tcomponent_subscribe($$self, imageSize, value => $$invalidate(17, $imageSize = value));\n\tcomponent_subscribe($$self, imageLoadState, value => $$invalidate(165, $imageLoadState = value));\n\tcomponent_subscribe($$self, imageProcessState, value => $$invalidate(211, $imageProcessState = value));\n\tcomponent_subscribe($$self, imageCropRect, value => $$invalidate(169, $imageCropRect = value));\n\tcomponent_subscribe($$self, imageBackgroundColor, value => $$invalidate(207, $imageBackgroundColor = value));\n\tcomponent_subscribe($$self, imageDecoration, value => $$invalidate(58, $imageDecoration = value));\n\tcomponent_subscribe($$self, imageAnnotation, value => $$invalidate(59, $imageAnnotation = value));\n\tcomponent_subscribe($$self, imageState, value => $$invalidate(164, $imageState = value));\n\tconst { images, imageReader } = stores;\n\tcomponent_subscribe($$self, images, value => $$invalidate(162, $images = value));\n\n\t//\n\t// handles the view rect size, makes sure it is offset from the top\n\t//\n\t// root element reference used to read styles\n\tconst rootBackgroundColor = writable([0, 0, 0]);\n\n\tcomponent_subscribe($$self, rootBackgroundColor, value => $$invalidate(28, $rootBackgroundColor = value));\n\n\t// client rect is the doka editor rect excluding scroll offset\n\tconst clientRect = writable();\n\n\tcomponent_subscribe($$self, clientRect, value => $$invalidate(15, $clientRect = value));\n\n\t// root rect is the doka editor rect including scroll offset\n\tconst rootRect = writable();\n\n\tcomponent_subscribe($$self, rootRect, value => $$invalidate(163, $rootRect = value));\n\n\t// when in overlay mode force aspect ratio to aspect ratio of editor root\n\tconst syncRootAspectRatio = () => {\n\t\t// set aspect ratio\n\t\timageCropAspectRatio.set(rectAspectRatio($rootRect));\n\n\t\t// need to set history 0 point to this state\n\t\thistory.set($imageState);\n\t};\n\n\tconst tabRect = writable(rectCreateEmpty());\n\tcomponent_subscribe($$self, tabRect, value => $$invalidate(19, $tabRect = value));\n\tconst toolRect = writable(rectCreateEmpty());\n\tcomponent_subscribe($$self, toolRect, value => $$invalidate(54, $toolRect = value));\n\tconst utilRect = writable(); // is undefined because we wait till util is set before defining stage rect\n\tcomponent_subscribe($$self, utilRect, value => $$invalidate(55, $utilRect = value));\n\n\tconst stageRect = derived([utilRect, tabRect, toolRect], ([$utilRect, $tabRect, $toolRect], set) => {\n\t\tif (!$utilRect) return set(undefined);\n\t\tconst utiloffsetX = $tabRect.x;\n\n\t\tconst utilOffsetY = $tabRect.y + (shouldRenderTabs && showUtils || isOverlayModeEnabled\n\t\t? 0\n\t\t: $toolRect.y + $toolRect.height);\n\n\t\tset(rectCreate(utiloffsetX + $utilRect.x, utilOffsetY + $utilRect.y, $utilRect.width, $utilRect.height));\n\t});\n\n\tcomponent_subscribe($$self, stageRect, value => $$invalidate(173, $stageRect = value));\n\n\t//\n\t// environment\n\t//\n\tconst pointerAccuracy = mediaQueryStore(\"(pointer: fine)\", matches => matches ? \"pointer-fine\" : \"pointer-coarse\");\n\n\tcomponent_subscribe($$self, pointerAccuracy, value => $$invalidate(202, $pointerAccuracy = value));\n\tconst pointerHoverable = mediaQueryStore(\"(hover: hover)\", matches => matches ? \"pointer-hover\" : \"pointer-no-hover\");\n\tcomponent_subscribe($$self, pointerHoverable, value => $$invalidate(203, $pointerHoverable = value));\n\n\t//\n\t// app API\n\t//\n\tconst isInteracting = writable(false);\n\n\tcomponent_subscribe($$self, isInteracting, value => $$invalidate(170, $isInteracting = value));\n\n\tconst isInteractingFraction = readable(undefined, set => {\n\t\tconst animator = spring(0);\n\n\t\tconst updater = value => {\n\t\t\tanimator.set(value ? 1 : 0);\n\t\t};\n\n\t\tconst subs = [isInteracting.subscribe(updater), animator.subscribe(set)];\n\n\t\t// destroy subs\n\t\treturn () => subs.forEach(unsub => unsub());\n\t});\n\n\tcomponent_subscribe($$self, isInteractingFraction, value => $$invalidate(214, $isInteractingFraction = value));\n\tconst previewShouldUpscale = writable(previewUpscale);\n\tcomponent_subscribe($$self, previewShouldUpscale, value => $$invalidate(168, $previewShouldUpscale = value));\n\n\t//\n\t// image related\n\t//\n\tconst stageScalar = derived([stageRect, imageCropRect], ([$stageRect, $imageCropRect], set) => {\n\t\tconst isManipulatingImageCropRect = !!($imageCropRectSnapshot || $imageCropRectIntent);\n\n\t\t// update stage scalar, the crop output size relative to the stage, if image fits it's 1\n\t\tif (!$stageRect || !$imageCropRect || isManipulatingImageCropRect) return;\n\n\t\t// calculate scale factor needed to fit crop rect to stage\n\t\tconst scalar = Math.min($stageRect.width / $imageCropRect.width, $stageRect.height / $imageCropRect.height);\n\n\t\t// always scaled down to fit stage, if is allowed to upscale, zoom to fit stage\n\t\tconst scale = $previewShouldUpscale ? scalar : Math.min(1, scalar);\n\n\t\tset(scale);\n\t});\n\n\tcomponent_subscribe($$self, stageScalar, value => $$invalidate(174, $stageScalar = value));\n\tconst imageCropRectSnapshot = writable();\n\tcomponent_subscribe($$self, imageCropRectSnapshot, value => $$invalidate(166, $imageCropRectSnapshot = value));\n\tconst imageCropRectIntent = writable(); // should always be set before setting `imageCropRect`\n\tcomponent_subscribe($$self, imageCropRectIntent, value => $$invalidate(167, $imageCropRectIntent = value));\n\n\tconst imageCropRectPresentation = readable(undefined, set => {\n\t\tconst animator = spring(undefined, { precision: 0.0001 });\n\n\t\tconst update = () => {\n\t\t\tif (!$imageCropRect) return;\n\t\t\tconst instantUpdate = $imageCropRectIntent === undefined || $isInteracting;\n\t\t\tconst elasticRect = elastifyRects($imageCropRect, $imageCropRectIntent, imageCropRectElasticity * elasticityMultiplier);\n\t\t\tanimator.set(elasticRect, { hard: instantUpdate });\n\t\t};\n\n\t\tconst subs = [\n\t\t\t// need to update presentation rect when crop rect is updated\n\t\t\timageCropRect.subscribe(update),\n\t\t\t// update parent store\n\t\t\tanimator.subscribe(set)\n\t\t];\n\n\t\treturn () => subs.forEach(unsub => unsub());\n\t});\n\n\tconst imageSelectionRect = writable();\n\tcomponent_subscribe($$self, imageSelectionRect, value => $$invalidate(171, $imageSelectionRect = value));\n\tconst imageSelectionRectSnapshot = writable();\n\tcomponent_subscribe($$self, imageSelectionRectSnapshot, value => $$invalidate(176, $imageSelectionRectSnapshot = value));\n\tconst imageSelectionRectIntent = writable(undefined); // should always be set before setting `imageSelectionRect`\n\tcomponent_subscribe($$self, imageSelectionRectIntent, value => $$invalidate(172, $imageSelectionRectIntent = value));\n\n\t//\n\t// Image selection\n\t//\n\tconst imageSelectionRectPresentation = readable(undefined, set => {\n\t\tconst animator = spring(undefined, { precision: 0.0001 });\n\n\t\tconst updater = () => {\n\t\t\tif (!$imageSelectionRect) return;\n\t\t\tconst instantUpdate = $isInteracting;\n\t\t\tconst elasticRect = elastifyRects($imageSelectionRect, $imageSelectionRectIntent, imageSelectionRectElasticity * elasticityMultiplier);\n\n\t\t\t// prevent negative size (can happen because of elastics)\n\t\t\tif (elasticRect.width < 0) {\n\t\t\t\telasticRect.width = 0;\n\t\t\t\telasticRect.x = $imageSelectionRect.x;\n\t\t\t}\n\n\t\t\tif (elasticRect.height < 0) {\n\t\t\t\telasticRect.height = 0;\n\t\t\t\telasticRect.y = $imageSelectionRect.y;\n\t\t\t}\n\n\t\t\t// translate elastic rect x,y by stage rect x,y\n\t\t\trectTranslate(elasticRect, $stageRect);\n\n\t\t\tanimator.set(elasticRect, { hard: instantUpdate });\n\t\t};\n\n\t\tconst subs = [\n\t\t\t// need to update selection rect when stage is resized\n\t\t\tstageRect.subscribe(updater),\n\t\t\t// listen for selection rect changes (as is assigned rect will always trigger, even if assigned same rect, this is needed to also update when intent changes)\n\t\t\timageSelectionRect.subscribe(updater),\n\t\t\t// update parent store\n\t\t\tanimator.subscribe(set)\n\t\t];\n\n\t\t// destroy subs\n\t\treturn () => subs.forEach(unsub => unsub());\n\t});\n\n\tcomponent_subscribe($$self, imageSelectionRectPresentation, value => $$invalidate(31, $imageSelectionRectPresentation = value));\n\n\t// when scaling the stage we need to recenter the image selection\n\tstageRect.subscribe(() => {\n\t\tif (!$stageRect || !$imageCropRect) return;\n\t\tconst imageCropRectFitsStage = $imageCropRect.width <= $stageRect.width && $imageCropRect.height <= $stageRect.height;\n\n\t\tconst centeredImageSelectionRect = // if we have a crop rect and it fits the stage, center it\n\t\timageCropRectFitsStage\n\t\t? // center the crop rectangle to the stage\n\t\t\trectCenterRect($stageRect, rectMultiply(rectClone($imageCropRect), $stageScalar || 1))\n\t\t: // render a rectangle based on the fixed crop aspect ratio, or the aspect ratio of the current crop rectangle, or as a last resort the input image\n\t\t\trectContainRect($stageRect, rectAspectRatio($imageCropRect || $imageSize));\n\n\t\timageSelectionRect.set(centeredImageSelectionRect);\n\t});\n\n\t// if we've taken a snapshot of the selection, also take a snapshot of the crop rect and the presentationScalar\n\t// - cropRect so we can adjust it based on the adjustments to the imageSelectionRect\n\t// - presentationScalar so we can use the snapshot for the calculation of the cropRect scale relative to the original imageSelectionRect (if we use the live $presentationScalar small rounding errors of the scalar result in weird glitches)\n\tlet presentationScalarSnapshot;\n\n\timageSelectionRectSnapshot.subscribe(rect => {\n\t\tif (!rect) {\n\t\t\tpresentationScalarSnapshot = undefined;\n\t\t\tset_store_value(imageCropRectSnapshot, $imageCropRectSnapshot = undefined, $imageCropRectSnapshot);\n\t\t\treturn;\n\t\t}\n\n\t\tpresentationScalarSnapshot = $presentationScalar;\n\t\tconst cropRectClone = rectClone($imageCropRect);\n\t\timageCropRectSnapshot.set(cropRectClone);\n\t});\n\n\t// if image selection rect is being manipulated, and imageSelectionRectSnapshot has been defined, we also need to update the crop rect\n\timageSelectionRect.subscribe(rect => {\n\t\t// only sync crop rect with image selection rect when no longer manipulating\n\t\tif (!rect || !$imageSelectionRectSnapshot) return;\n\n\t\tconst offset = rectSubtract(rectClone(rect), $imageSelectionRectSnapshot);\n\t\trectDivide(offset, presentationScalarSnapshot);\n\t\tconst crop = rectAdd(rectClone($imageCropRectSnapshot), offset);\n\t\timageCropRect.set(crop);\n\t});\n\n\timageCropRect.subscribe(rect => {\n\t\t// don't update image selection rect while we're intertacting with the view, this prevents feedback loop from cropRect model updates\n\t\tif ($isInteracting || $imageSelectionRectSnapshot || $imageCropRectIntent) return;\n\n\t\t// if no rect, we can't do anything\n\t\t// if no selection rect yet, we wait for a selection rect to be loaded\n\t\tif (!rect || !$imageSelectionRect) return;\n\n\t\t// only if crop aspect ratio differs from image selection aspect ratio we update image selection rectangle\n\t\tconst imageSelectionRectAspectRatio = rectAspectRatio($imageSelectionRect);\n\n\t\tconst cropRectAspectRatio = rectAspectRatio(rect);\n\t\tif (fixPrecision(imageSelectionRectAspectRatio, 6) === fixPrecision(cropRectAspectRatio, 6)) return;\n\n\t\t// TEMP DUPLICATE OF STAGESCALAR DERIVED STORE TO FIX ZOOM OUT AFTER WHEEL ISSUE\n\t\t// reproduce -> crop view => resize selection rect vertically, tap recenter, zoom out with scroll wheel\n\t\tconst scalar = Math.min($stageRect.width / $imageCropRect.width, $stageRect.height / $imageCropRect.height);\n\n\t\t// const scale = $previewShouldUpscale ? scalar : Math.min(1, scalar);\n\t\tconst size = sizeCreate(rect.width * scalar, rect.height * scalar);\n\n\t\tconst tx = ($imageSelectionRect.width - size.width) * 0.5;\n\t\tconst ty = ($imageSelectionRect.height - size.height) * 0.5;\n\t\tconst selectionRect = rectCreate($imageSelectionRect.x + tx, $imageSelectionRect.y + ty, size.width, size.height);\n\t\timageSelectionRect.set(selectionRect);\n\t});\n\n\tconst imageScalar = derived([stageScalar, imageCropRect, imageSelectionRect], ([$stageScalar, $imageCropRect, $imageSelectionRect], set) => {\n\t\t// update the image scalar, the image zoom calculated by the image selection and the actual crop coordinates\n\t\tif (!$stageScalar || !$imageCropRect || !$imageSelectionRect) return;\n\n\t\tconst selectionScaledWidth = $imageSelectionRect.width / $imageCropRect.width;\n\t\tconst selectionScaledHeight = $imageSelectionRect.height / $imageCropRect.height;\n\n\t\t// need to correct for scale of stage\n\t\tconst scalar = Math.max(selectionScaledWidth, selectionScaledHeight) / $stageScalar;\n\n\t\tset(scalar);\n\t});\n\n\tconst presentationScalar = derived([stageScalar, imageScalar], ([$stageScalar, $imageScalar], set) => {\n\t\t// can't scale presentation if no image scalar defined\n\t\tif (!$imageScalar) return;\n\n\t\tconst scalar = $stageScalar * $imageScalar;\n\t\tset(scalar);\n\t});\n\n\tcomponent_subscribe($$self, presentationScalar, value => $$invalidate(175, $presentationScalar = value));\n\n\t//\n\t// UI Elements\n\t//\n\t// guides and edges rendered on top of image\n\tconst imageSelectionGuides = derived(\n\t\t[\n\t\t\trootBackgroundColor,\n\t\t\tisInteracting,\n\t\t\timageSelectionRectPresentation,\n\t\t\tisInteractingFraction\n\t\t],\n\t\t([$rootBackgroundColor, $isInteracting, $rect, $opacity], set) => {\n\t\t\tif (!$rect) return set([]);\n\t\t\tconst { x, y, width, height } = $rect;\n\t\t\tconst showGrid = $opacity > 0;\n\t\t\tconst rows = showGrid ? 3 : 1;\n\t\t\tconst cols = showGrid ? 3 : 1;\n\t\t\tconst w = width / cols;\n\t\t\tconst h = height / rows;\n\t\t\tconst guides = [];\n\n\t\t\tconst strokeColor = isDarkColor($rootBackgroundColor)\n\t\t\t? [1, 1, 1]\n\t\t\t: [0, 0, 0];\n\n\t\t\t// rows\n\t\t\tfor (let r = 0; r <= rows; r++) {\n\t\t\t\tlet isEdge = r === 0 || r === rows;\n\t\t\t\tif (isOverlayModeEnabled && isEdge) continue;\n\t\t\t\tlet o = isEdge ? 1 : $opacity * 0.25;\n\t\t\t\tlet yo = y + h * r;\n\n\t\t\t\tguides.push({\n\t\t\t\t\tid: `image-selection-guide-row-${r}`,\n\t\t\t\t\tpoints: [vectorCreate(x, yo), vectorCreate(x + width, yo)],\n\t\t\t\t\topacity: o,\n\t\t\t\t\tstrokeWidth: 1,\n\t\t\t\t\tstrokeColor\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// cols\n\t\t\tfor (let c = 0; c <= cols; c++) {\n\t\t\t\tlet isEdge = c === 0 || c === cols;\n\t\t\t\tif (isOverlayModeEnabled && isEdge) continue;\n\t\t\t\tlet o = isEdge ? 1 : $opacity * 0.25;\n\t\t\t\tlet xo = x + w * c;\n\n\t\t\t\tguides.push({\n\t\t\t\t\tid: `image-selection-guide-col-${c}`,\n\t\t\t\t\tpoints: [vectorCreate(xo, y), vectorCreate(xo, y + height)],\n\t\t\t\t\topacity: o,\n\t\t\t\t\tstrokeWidth: 1,\n\t\t\t\t\tstrokeColor\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tset(guides);\n\t\t}\n\t);\n\n\t// custom markup rendered on top of image\n\tconst imageOverlayMarkup = writable([]);\n\n\t// the resulting overlay markup\n\tconst imageOverlay = derived([imageSelectionGuides, imageOverlayMarkup], ([$imageSelectionGuides, $imageOverlayMarkup], set) => {\n\t\tset($imageSelectionGuides.concat($imageOverlayMarkup));\n\t});\n\n\tcomponent_subscribe($$self, imageOverlay, value => $$invalidate(60, $imageOverlay = value));\n\n\t//\n\t// Loading the preview\n\t//\n\tconst imageVisualLoadComplete = writable(false);\n\n\tcomponent_subscribe($$self, imageVisualLoadComplete, value => $$invalidate(209, $imageVisualLoadComplete = value));\n\tlet imagePreviewLoaderCancelToken;\n\n\tconst createImagePreviewLoader = (file, token) => new Promise((resolve, reject) => {\n\t\t\tlet cancelled = false;\n\t\t\tlet timer;\n\t\t\ttoken.cancel = () => cancelled = true;\n\t\t\tconst now = Date.now();\n\n\t\t\timageSourceToImageData(file).then(imageData => {\n\t\t\t\tconst dist = Date.now() - now;\n\t\t\t\tclearTimeout(timer);\n\n\t\t\t\ttimer = setTimeout(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tif (cancelled) return;\n\t\t\t\t\t\tresolve(imageData);\n\t\t\t\t\t},\n\t\t\t\t\tMath.max(0, 1000 - dist)\n\t\t\t\t);\n\t\t\t}).catch(reject);\n\t\t});\n\n\tconst imagePreview = derived([imageVisualLoadComplete, imageFile], ([$imageVisualLoadComplete, $imageFile], set) => {\n\t\t// cancel existing loader\n\t\tif (imagePreviewLoaderCancelToken) imagePreviewLoaderCancelToken.cancel();\n\n\t\t// no data, reset preview data\n\t\tif (!$imageVisualLoadComplete || !$imageFile) return set(undefined);\n\n\t\timagePreviewLoaderCancelToken = { cancel: noop };\n\t\tcreateImagePreviewLoader($imageFile, imagePreviewLoaderCancelToken).then(set).catch(err => set_store_value(imageLoadState, $imageLoadState.error = err, $imageLoadState));\n\t});\n\n\tcomponent_subscribe($$self, imagePreview, value => $$invalidate(38, $imagePreview = value));\n\n\t//\n\t// Calculates the image transforms and effects necessary for the preview\n\t//\n\tconst imagePreviewModifiers = writable({});\n\n\tcomponent_subscribe($$self, imagePreviewModifiers, value => $$invalidate(205, $imagePreviewModifiers = value));\n\tconst imagePreviews = writable([]);\n\tcomponent_subscribe($$self, imagePreviews, value => $$invalidate(57, $imagePreviews = value));\n\n\tconst imageTransforms = derived(\n\t\t[\n\t\t\tstageRect,\n\t\t\trootRect,\n\t\t\timageSize,\n\t\t\timageCropRectPresentation,\n\t\t\timageSelectionRect,\n\t\t\tpresentationScalar,\n\t\t\timageRotation,\n\t\t\timageFlipX,\n\t\t\timageFlipY\n\t\t],\n\t\t([\n\t\t\t\t$stageRect,\n\t\t\t\t$rootRect,\n\t\t\t\t$imageSize,\n\t\t\t\t$imageCropRectPresentation,\n\t\t\t\t$imageSelectionRect,\n\t\t\t\t$presentationScalar,\n\t\t\t\t$imageRotation,\n\t\t\t\t$imageFlipX,\n\t\t\t\t$imageFlipY\n\t\t\t], set) => {\n\t\t\tset(calculateImageTransforms($stageRect, $rootRect, $imageSize, $imageCropRectPresentation, $imageSelectionRect, $presentationScalar, 0, 0, $imageRotation, $imageFlipX, $imageFlipY));\n\t\t}\n\t);\n\n\tcomponent_subscribe($$self, imageTransforms, value => $$invalidate(204, $imageTransforms = value));\n\n\tconst imageEffects = derived(\n\t\t[\n\t\t\timageColorMatrix,\n\t\t\timageConvolutionMatrix,\n\t\t\timageGamma,\n\t\t\timageVignette,\n\t\t\timageNoise\n\t\t],\n\t\t([$colorMatrix, $convolutionMatrix, $gamma, $vignette, $noise], set) => {\n\t\t\tconst colorMatrices = $colorMatrix && Object.keys($colorMatrix).map(name => $colorMatrix[name]).filter(Boolean);\n\n\t\t\tconst effects = {\n\t\t\t\tgamma: $gamma || undefined,\n\t\t\t\tvignette: $vignette || undefined,\n\t\t\t\tnoise: $noise || undefined,\n\t\t\t\tconvolutionMatrix: $convolutionMatrix || undefined,\n\t\t\t\tcolorMatrix: colorMatrices && colorMatrices.length && getColorMatrixFromColorMatrices(colorMatrices)\n\t\t\t};\n\n\t\t\tset(effects);\n\t\t}\n\t);\n\n\tcomponent_subscribe($$self, imageEffects, value => $$invalidate(206, $imageEffects = value));\n\n\t//\n\t// current environment variables\n\t//\n\tlet windowWidth;\n\n\tlet windowHeight;\n\tconst shouldPreventSwipe = canPreventNavSwipe();\n\tconst env = writable({});\n\tcomponent_subscribe($$self, env, value => $$invalidate(201, $env = value));\n\tconst initialPixelRatio = getDevicePixelRatio();\n\n\tconst pixelRatio = readable(initialPixelRatio, set => {\n\t\tconst handleResolutionChange = () => set(getDevicePixelRatio());\n\t\tconst resolutionObserver = matchMedia(`(resolution: ${initialPixelRatio}dppx)`);\n\t\tresolutionObserver.addListener(handleResolutionChange);\n\t\treturn () => resolutionObserver.removeListener(handleResolutionChange);\n\t});\n\n\tcomponent_subscribe($$self, pixelRatio, value => $$invalidate(56, $pixelRatio = value));\n\n\tconst history = historyCreate(() => $imageState, state => {\n\t\t// set new state from history, $imageState will store a clone of the received state\n\t\tset_store_value(imageState, $imageState = state, $imageState); // image state will return a clone of the current state\n\n\t\t// trigger recenter of image selection rect\n\t\ttabRect.set($tabRect);\n\t});\n\n\t$$subscribe_history();\n\n\timageLoadState.subscribe(({ complete } = {}) => {\n\t\tif (!complete) return;\n\t\thistory.set($imageState);\n\t});\n\n\tconst revert = () => willRevert().then(shouldReset => shouldReset && history.revert());\n\n\t//\n\t// Visual processing of the image\n\t//\n\tconst imageProcessingPreparing = writable(false);\n\n\tcomponent_subscribe($$self, imageProcessingPreparing, value => $$invalidate(183, $imageProcessingPreparing = value));\n\n\tconst handleExport = () => {\n\t\t// this will trigger status overlay fade in\n\t\tset_store_value(imageProcessingPreparing, $imageProcessingPreparing = true, $imageProcessingPreparing);\n\n\t\t// wait for status to be done fading in, then requests image writing\n\t\tconst unsub = statusOpacity.subscribe(value => {\n\t\t\tif (value !== 1) return;\n\n\t\t\t// stop listening for\n\t\t\tunsub();\n\n\t\t\t// request write image\n\t\t\tdispatch(\"processImage\");\n\t\t});\n\t};\n\n\timageProcessState.subscribe(state => {\n\t\tif (!state) return;\n\t\tset_store_value(imageProcessingPreparing, $imageProcessingPreparing = true, $imageProcessingPreparing);\n\t\tconst { task, error, complete } = state;\n\t\tif (complete) set_store_value(imageProcessingPreparing, $imageProcessingPreparing = false, $imageProcessingPreparing);\n\t});\n\n\t//\n\t// Configure the available views\n\t//\n\tconst utilStores = {\n\t\t// model stores\n\t\t...stores,\n\t\t// image\n\t\timageFile,\n\t\timageSize,\n\t\timageCropAspectRatio,\n\t\timageCropMinSize,\n\t\timageCropMaxSize,\n\t\timageCropLimitToImage,\n\t\timageCropRect,\n\t\timageCropRectOrigin,\n\t\timageCropRectSnapshot,\n\t\timageCropRectAspectRatio,\n\t\timageCropRange,\n\t\timageRotation,\n\t\timageRotationRange,\n\t\timageFlipX,\n\t\timageFlipY,\n\t\timageOutputSize,\n\t\t// effects\n\t\timageColorMatrix,\n\t\timageConvolutionMatrix,\n\t\timageGamma,\n\t\timageVignette,\n\t\timageNoise,\n\t\t// markup\n\t\timageDecoration,\n\t\timageAnnotation,\n\t\t// image preview for utils that need access to pixel data\n\t\timagePreview,\n\t\t// top left position of image preview\n\t\timageTransforms,\n\t\t// allows utils to control how the preview is presented (for example more opacity for mask)\n\t\timagePreviewModifiers,\n\t\t// history state and update\n\t\thistory,\n\t\t// static env info\n\t\tpixelRatio,\n\t\telasticityMultiplier,\n\t\tscrollElasticity,\n\t\trangeInputElasticity,\n\t\t// dynamic env info\n\t\tpointerAccuracy,\n\t\tpointerHoverable,\n\t\tenv,\n\t\trootRect,\n\t\tstageRect,\n\t\tstageScalar,\n\t\tutilRect,\n\t\tpresentationScalar,\n\t\trootBackgroundColor,\n\t\t// (write) add guides to ui (for example is used by markup util to add lines for shape manipulator)\n\t\timageOverlayMarkup,\n\t\t// (write) previews to render\n\t\timagePreviews,\n\t\t// (write) set to true to disable animations\n\t\tisInteracting,\n\t\t// (write) the current intended crop rect\n\t\timageCropRectIntent,\n\t\t// (read) the current presented crop rect\n\t\timageCropRectPresentation,\n\t\t// (write) the current limited size of the image selection rect\n\t\timageSelectionRect,\n\t\t// (write) the inteded rectangle by the user\n\t\timageSelectionRectIntent,\n\t\t// (read) the current presentation of the image selection rect, includes elasticity etc.\n\t\timageSelectionRectPresentation,\n\t\t// (read) a snapshot of the image selection rectangle, use to store the rectangle before modification so alterations to the rectangle can be applied to the snapshot\n\t\timageSelectionRectSnapshot,\n\t\t// scalar of image in view\n\t\timageScalar\n\t};\n\n\t// don't expose image store\n\tdelete utilStores.image;\n\n\tconst utilsUniqueId = `util-${getUniqueId()}`;\n\tlet utilsVisible = [];\n\n\t// env\n\tlet iOS = isIOS();\n\n\t// canvas background color\n\tconst syncBackgroundColor = () => {\n\t\tconst colorString = rootElementComputedStyle.getPropertyValue(\"background-color\");\n\t\tconst colorArray = colorStringToColorArray(colorString);\n\n\t\t// hide transparent color\n\t\tif (colorArray[3] === 0) return;\n\n\t\t// limit to opaque colors\n\t\tcolorArray.length = 3;\n\n\t\t// update background\n\t\tset_store_value(rootBackgroundColor, $rootBackgroundColor = colorArray, $rootBackgroundColor);\n\t};\n\n\tconst handleTransitionEnd = ({ target, propertyName }) => {\n\t\tif (target !== root || propertyName !== \"background-color\") return;\n\t\tsyncBackgroundColor();\n\t};\n\n\t// test if some shapes have left/top/bottom/right offsets, if so, convert to crop space\n\t// updates original shape (which at this point is a flattened shape (clone))\n\tconst positionDecorationShape = (shape, canvasState) => shapeComputeDisplay(shape, {\n\t\tx: $imageSelectionRectPresentation.x / canvasState.scale,\n\t\ty: $imageSelectionRectPresentation.y / canvasState.scale,\n\t\twidth: $imageSelectionRectPresentation.width / canvasState.scale,\n\t\theight: $imageSelectionRectPresentation.height / canvasState.scale\n\t});\n\n\t// decoration is drawn relative to view space, so we need to translate relative to crop presentation rect\n\tconst transformDecorationShape = (shape, canvasState) => {\n\t\tshapeComputeTransform(shape, $imageSelectionRectPresentation, canvasState.scale, canvasState.size);\n\t\treturn shape;\n\t};\n\n\tconst flattenShapes = shapes => {\n\t\tconst flattenedShapes = [];\n\t\tshapes.forEach(shape => flattenedShapes.push(...flattenShape(shape)));\n\t\treturn flattenedShapes.filter(Boolean);\n\t};\n\n\tconst flattenShape = shape => {\n\t\t// at this point shape is a copy of the original shape\n\t\t// the shapes to draw, can be multiple shapes\n\t\tconst drawableShapes = [shape];\n\n\t\tif (shapeIsLine(shape)) {\n\t\t\tlet start = vectorCreate(shape.x1, shape.y1);\n\t\t\tlet end = vectorCreate(shape.x2, shape.y2);\n\n\t\t\tif (shape.lineStart) {\n\t\t\t\tconst style = shapeComputeLineEnd(start, shape.strokeWidth, shape.strokeColor, shape.lineStart, vectorCreate(end.x - start.x, end.y - start.y));\n\t\t\t\tstart = style.position || start;\n\t\t\t\tdrawableShapes.push(style.shape);\n\t\t\t}\n\n\t\t\tif (shape.lineEnd) {\n\t\t\t\tconst style = shapeComputeLineEnd(end, shape.strokeWidth, shape.strokeColor, shape.lineEnd, vectorCreate(start.x - end.x, start.y - end.y));\n\t\t\t\tend = style.position || start;\n\t\t\t\tdrawableShapes.push(style.shape);\n\t\t\t}\n\n\t\t\t// transform into line\n\t\t\tshape.points = [start, end];\n\t\t} else if (shapeIsTriangle(shape)) {\n\t\t\tshape.points = [\n\t\t\t\tvectorCreate(shape.x1, shape.y1),\n\t\t\t\tvectorCreate(shape.x2, shape.y2),\n\t\t\t\tvectorCreate(shape.x3, shape.y3)\n\t\t\t];\n\t\t} else // is empty text\n\t\tif (shapeIsTextEmpty(shape)) {\n\t\t\t// make sure shape is still visible\n\t\t\tif (shapeIsTextLine(shape)) {\n\t\t\t\tshape.width = 5;\n\n\t\t\t\tshape.height = isFunction(shape.lineHeight)\n\t\t\t\t? shape.lineHeight(shape.fontSize)\n\t\t\t\t: shape.lineHeight;\n\t\t\t}\n\n\t\t\t// set to empty text style\n\t\t\tshape.strokeWidth = 1;\n\n\t\t\tshape.strokeColor = [1, 1, 1, 0.5];\n\t\t\tshape.backgroundColor = [0, 0, 0, 0.1];\n\t\t}\n\n\t\treturn drawableShapes;\n\t};\n\n\tconst statusOpacity = tweened(undefined, { duration: 500 });\n\tcomponent_subscribe($$self, statusOpacity, value => $$invalidate(46, $statusOpacity = value));\n\tlet loadTimer;\n\n\tconst statusOffsetX = spring(undefined, {\n\t\tstiffness: 0.02,\n\t\tdamping: 0.5,\n\t\tprecision: 0.25\n\t});\n\n\tcomponent_subscribe($$self, statusOffsetX, value => $$invalidate(48, $statusOffsetX = value));\n\n\tconst progressOffsetX = spring(undefined, {\n\t\tstiffness: 0.03,\n\t\tdamping: 0.4,\n\t\tprecision: 0.25\n\t});\n\n\tcomponent_subscribe($$self, progressOffsetX, value => $$invalidate(49, $progressOffsetX = value));\n\n\tconst hideStatus = () => {\n\t\tstatusOffsetX.set(undefined, { hard: true });\n\t\tprogressOffsetX.set(undefined, { hard: true });\n\t};\n\n\tconst offsetProgress = e => {\n\t\tset_store_value(statusOffsetX, $statusOffsetX = Math.round(-e.detail.width * 0.5) - 16, $statusOffsetX); // -16 offsets text so it's better centered to the viewport\n\t\tset_store_value(progressOffsetX, $progressOffsetX = e.detail.width, $progressOffsetX);\n\t};\n\n\tconst handleCloseImageLoadError = () => {\n\t\tdispatch(\"abortLoadImage\");\n\t};\n\n\tconst handleCloseImageProcessError = () => {\n\t\tdispatch(\"abortProcessImage\");\n\t\tset_store_value(imageProcessingPreparing, $imageProcessingPreparing = false, $imageProcessingPreparing);\n\t};\n\n\t// context for children to know if a key is down\n\tconst pressedKeysStore = writable([]);\n\n\tcomponent_subscribe($$self, pressedKeysStore, value => $$invalidate(213, $pressedKeysStore = value));\n\tsetContext(\"keysPressed\", pressedKeysStore);\n\n\tconst handleKeydown = e => {\n\t\tconst { keyCode } = e;\n\t\tconst keySet = new Set([...$pressedKeysStore, keyCode]);\n\t\tpressedKeysStore.set(Array.from(keySet));\n\t};\n\n\tconst handleKeyup = ({ keyCode }) => {\n\t\tpressedKeysStore.set($pressedKeysStore.filter(pressedKey => pressedKey !== keyCode));\n\t};\n\n\t// so no keys get stuck when user cmd-tabs out of the window, or when dev-tools open by key-press\n\tconst handleWindowBlur = () => {\n\t\tpressedKeysStore.set([]);\n\t};\n\n\t// block context menu on everything but text input fields\n\tconst handleContextMenu = e => {\n\t\tif (isTextField(e.target)) return;\n\t\te.preventDefault();\n\t};\n\n\t// handle files being dropped on the editor\n\tconst handleDropFiles = e => {\n\t\t// if no files dropped, exit!\n\t\tif (!enableDropImage || !e.detail.files.length) return;\n\n\t\t// request load image\n\t\tdispatch(\"loadImage\", e.detail.files[0]);\n\t};\n\n\t// canvas drawing\n\tconst getStageState = () => ({\n\t\t// add information on which util is active\n\t\tutilVisibility: { ...utilsVisibleFraction },\n\t\t// used to fade in elements when interacting\n\t\tisInteracting: $isInteracting,\n\t\tisInteractingFraction: $isInteractingFraction,\n\t\t// add the root rectangle so will render can use width/height of root element\n\t\trootRect: rectClone($rootRect),\n\t\t// add the stage rectangle so will render knows where stage starts and ends\n\t\tstageRect: rectClone($stageRect),\n\t\t// preview selection rect\n\t\tselectionRect: rectClone($imageSelectionRectPresentation)\n\t});\n\n\tconst createCanvasState = (canvasState, annotationShapes, decorationShapes, interfaceShapes) => ({\n\t\tannotationShapes: flattenShapes(annotationShapes.filter(shapeIsVisible).map(shapeDeepCopy).map(shape => shapeComputeDisplay(shape, $imageSize))),\n\t\tdecorationShapes: flattenShapes(decorationShapes.filter(shapeIsVisible).map(shapeDeepCopy).map(shape => positionDecorationShape(shape, canvasState)).map(shape => transformDecorationShape(shape, canvasState))),\n\t\tinterfaceShapes: flattenShapes(interfaceShapes.filter(shapeIsVisible))\n\t});\n\n\t// setup root portal for detail panel dropdown\n\tlet rootPortal;\n\n\tconst rootPortalStore = writable();\n\tsetContext(\"rootPortal\", rootPortalStore);\n\n\t// setup root rect store for global access\n\tsetContext(\"rootRect\", rootRect);\n\n\tfunction onwindowresize() {\n\t\t$$invalidate(10, windowWidth = window.innerWidth);\n\t\t$$invalidate(11, windowHeight = window.innerHeight);\n\t}\n\n\tconst measure_handler = e => set_store_value(toolRect, $toolRect = e.detail, $toolRect);\n\tconst select_handler = ({ detail }) => $$invalidate(21, utilSelected = detail);\n\tconst func = (panel, util) => util.id === panel;\n\n\tfunction panel_component_binding(value, panel) {\n\t\tpluginInterface[panel] = value;\n\t\t(($$invalidate(0, pluginInterface), $$invalidate(7, pluginOptions)), $$invalidate(134, pluginComponents));\n\t}\n\n\tconst measure_handler_1 = e => set_store_value(utilRect, $utilRect = e.detail, $utilRect);\n\tconst show_handler = panel => $$invalidate(12, utilsVisible = utilsVisible.concat(panel));\n\tconst hide_handler = panel => $$invalidate(12, utilsVisible = utilsVisible.filter(util => util !== panel));\n\tconst fade_handler = (panel, { detail }) => $$invalidate(22, utilsVisibleFraction[panel] = detail, utilsVisibleFraction);\n\tconst measure_handler_2 = e => set_store_value(tabRect, $tabRect = e.detail, $tabRect);\n\tconst func_1 = util => util.id === utilSelected;\n\n\tfunction panel_component_binding_1(value) {\n\t\tpluginInterface[utilSelected] = value;\n\t\t(($$invalidate(0, pluginInterface), $$invalidate(7, pluginOptions)), $$invalidate(134, pluginComponents));\n\t}\n\n\tconst measure_handler_3 = e => set_store_value(utilRect, $utilRect = e.detail, $utilRect);\n\tconst show_handler_1 = () => $$invalidate(12, utilsVisible = utilsVisible.concat(utilSelected));\n\tconst hide_handler_1 = () => $$invalidate(12, utilsVisible = utilsVisible.filter(util => util !== utilSelected));\n\tconst fade_handler_1 = ({ detail }) => $$invalidate(22, utilsVisibleFraction[utilSelected] = detail, utilsVisibleFraction);\n\n\tconst func_2 = canvasState => {\n\t\t// current draw state\n\t\tconst drawState = { ...canvasState, ...getStageState() };\n\n\t\t// allow dev to add custom overlay to `imageOverlay`\n\t\tconst { annotationShapes, decorationShapes, interfaceShapes } = willRenderCanvas(\n\t\t\t{\n\t\t\t\tdecorationShapes: $imageDecoration,\n\t\t\t\tannotationShapes: $imageAnnotation,\n\t\t\t\tinterfaceShapes: $imageOverlay\n\t\t\t},\n\t\t\tdrawState\n\t\t);\n\n\t\t// need to map shapes\n\t\treturn createCanvasState(drawState, annotationShapes, decorationShapes, interfaceShapes);\n\t};\n\n\tfunction div_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\trootPortal = $$value;\n\t\t\t$$invalidate(13, rootPortal);\n\t\t});\n\t}\n\n\tfunction div_binding_1($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\troot = $$value;\n\t\t\t$$invalidate(1, root);\n\t\t});\n\t}\n\n\tconst measure_handler_4 = e => set_store_value(clientRect, $clientRect = e.detail, $clientRect);\n\n\t$$self.$$set = $$props => {\n\t\tif (\"class\" in $$props) $$invalidate(117, klass = $$props.class);\n\t\tif (\"layout\" in $$props) $$invalidate(118, layoutMode = $$props.layout);\n\t\tif (\"stores\" in $$props) $$invalidate(119, stores = $$props.stores);\n\t\tif (\"locale\" in $$props) $$invalidate(2, locale = $$props.locale);\n\t\tif (\"id\" in $$props) $$invalidate(3, id = $$props.id);\n\t\tif (\"util\" in $$props) $$invalidate(120, util = $$props.util);\n\t\tif (\"utils\" in $$props) $$invalidate(121, utils = $$props.utils);\n\t\tif (\"animations\" in $$props) $$invalidate(122, animations = $$props.animations);\n\t\tif (\"previewUpscale\" in $$props) $$invalidate(123, previewUpscale = $$props.previewUpscale);\n\t\tif (\"elasticityMultiplier\" in $$props) $$invalidate(4, elasticityMultiplier = $$props.elasticityMultiplier);\n\t\tif (\"willRevert\" in $$props) $$invalidate(124, willRevert = $$props.willRevert);\n\t\tif (\"willRenderCanvas\" in $$props) $$invalidate(5, willRenderCanvas = $$props.willRenderCanvas);\n\t\tif (\"willRenderToolbar\" in $$props) $$invalidate(125, willRenderToolbar = $$props.willRenderToolbar);\n\t\tif (\"enableButtonExport\" in $$props) $$invalidate(126, enableButtonExport = $$props.enableButtonExport);\n\t\tif (\"enableButtonRevert\" in $$props) $$invalidate(127, enableButtonRevert = $$props.enableButtonRevert);\n\t\tif (\"enableNavigateHistory\" in $$props) $$invalidate(128, enableNavigateHistory = $$props.enableNavigateHistory);\n\t\tif (\"enableToolbar\" in $$props) $$invalidate(6, enableToolbar = $$props.enableToolbar);\n\t\tif (\"enableUtils\" in $$props) $$invalidate(129, enableUtils = $$props.enableUtils);\n\t\tif (\"enableButtonClose\" in $$props) $$invalidate(130, enableButtonClose = $$props.enableButtonClose);\n\t\tif (\"previewImageDataMaxSize\" in $$props) $$invalidate(131, previewImageDataMaxSize = $$props.previewImageDataMaxSize);\n\t\tif (\"enableDropImage\" in $$props) $$invalidate(132, enableDropImage = $$props.enableDropImage);\n\t\tif (\"imageOrienter\" in $$props) $$invalidate(133, imageOrienter = $$props.imageOrienter);\n\t\tif (\"pluginComponents\" in $$props) $$invalidate(134, pluginComponents = $$props.pluginComponents);\n\t\tif (\"pluginOptions\" in $$props) $$invalidate(7, pluginOptions = $$props.pluginOptions);\n\t\tif (\"root\" in $$props) $$invalidate(1, root = $$props.root);\n\t\tif (\"imageSourceToImageData\" in $$props) $$invalidate(8, imageSourceToImageData = $$props.imageSourceToImageData);\n\t};\n\n\tlet isOverlayModeEnabled;\n\tlet showUtils;\n\tlet maxImageDataSize;\n\tlet canAnimate;\n\tlet acceptsAnimations;\n\tlet shouldAnimate;\n\tlet canUndo;\n\tlet canRedo;\n\tlet utilsFiltered;\n\tlet utilsAvailable;\n\tlet utilsDefined;\n\tlet utilsMerged;\n\tlet utilSelected;\n\tlet utilTools;\n\tlet utilsVisibleFraction;\n\tlet tabsConfig;\n\tlet tabs;\n\tlet panels;\n\tlet shouldRenderTabs;\n\tlet className;\n\tlet orientation;\n\tlet isLandscape;\n\tlet horizontalSpace;\n\tlet hasLimitedSpace;\n\tlet verticalSpace;\n\tlet isModal;\n\tlet isCenteredHorizontally;\n\tlet isCenteredVertically;\n\tlet isCentered;\n\tlet isNarrow;\n\tlet isCompact;\n\tlet hasSwipeNavigation;\n\tlet shouldRenderUtilTools;\n\tlet rootElementComputedStyle;\n\tlet envStr;\n\tlet imageProps;\n\tlet missingFeatures;\n\tlet isSupportsError;\n\tlet isImageLoadError;\n\tlet isWaitingForImage;\n\tlet imageLoadProgress;\n\tlet isLoadingImageData;\n\tlet isCreatingImagePreview;\n\tlet isProcessingImage;\n\tlet imageLoadShowProgressIndicator;\n\tlet imageLoadStatusLabel;\n\tlet imageProcessStatusLabel;\n\tlet imageProcessProgress;\n\tlet imageProcessShowProgressIndicator;\n\tlet isImageProcessingError;\n\tlet isStatusVisible;\n\tlet handleTouchStart;\n\tlet toolbarItems;\n\tlet hasClientRect;\n\tlet canRender;\n\tlet routePing;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[3] & /*layoutMode*/ 33554432) {\n\t\t\t $$invalidate(160, isOverlayModeEnabled = layoutMode === \"overlay\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*enableUtils*/ 32 | $$self.$$.dirty[5] & /*isOverlayModeEnabled*/ 32) {\n\t\t\t $$invalidate(14, showUtils = enableUtils && !isOverlayModeEnabled);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*pluginOptions, pluginInterface*/ 129) {\n\t\t\t// map plugin options to plugin interface\n\t\t\t if (pluginOptions) {\n\t\t\t\t// for every plugin in plugin options\n\t\t\t\tObject.keys(pluginOptions).forEach(plugin => {\n\t\t\t\t\t// for every prop defined for this plugin\n\t\t\t\t\tObject.keys(pluginOptions[plugin]).forEach(prop => {\n\t\t\t\t\t\t// set value to interface\n\t\t\t\t\t\tif (!pluginInterface[plugin]) return;\n\n\t\t\t\t\t\t// set prop value\n\t\t\t\t\t\t$$invalidate(0, pluginInterface[plugin][prop] = pluginOptions[plugin][prop], pluginInterface);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*pluginInterface*/ 1 | $$self.$$.dirty[4] & /*pluginComponents*/ 1024) {\n\t\t\t {\n\t\t\t\tlet changed = false;\n\n\t\t\t\tpluginComponents.forEach(([key]) => {\n\t\t\t\t\tif (pluginInterface[key]) return;\n\t\t\t\t\t$$invalidate(0, pluginInterface[key] = {}, pluginInterface);\n\t\t\t\t\tchanged = true;\n\t\t\t\t});\n\n\t\t\t\tif (changed) {\n\t\t\t\t\t$$invalidate(156, registeredPluginsComponents = [...pluginComponents]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*previewImageDataMaxSize*/ 128) {\n\t\t\t maxImageDataSize = previewImageDataMaxSize\n\t\t\t? sizeMin(previewImageDataMaxSize, maxTextureSize)\n\t\t\t: maxTextureSize;\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$images*/ 128) {\n\t\t\t imageProxy.update($images[0]);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$clientRect*/ 32768) {\n\t\t\t $clientRect && rootRect.set(rectCreate($clientRect.x, $clientRect.y, $clientRect.width, $clientRect.height));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$rootRect, isOverlayModeEnabled, $imageLoadState*/ 1312) {\n\t\t\t $rootRect && isOverlayModeEnabled && ($imageLoadState && $imageLoadState.complete) && syncRootAspectRatio();\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*previewUpscale*/ 1073741824 | $$self.$$.dirty[5] & /*isOverlayModeEnabled*/ 32) {\n\t\t\t previewShouldUpscale.set(previewUpscale || isOverlayModeEnabled);\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$isInteracting*/ 32768) {\n\t\t\t//\n\t\t\t// Animations based on prefers-reduced-motion, automatically checks if user prefers reduced animations\n\t\t\t//\n\t\t\t $$invalidate(177, canAnimate = !$isInteracting);\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$prefersReducedMotion*/ 16777216) {\n\t\t\t $$invalidate(178, acceptsAnimations = !$prefersReducedMotion);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*animations*/ 536870912 | $$self.$$.dirty[5] & /*canAnimate, acceptsAnimations*/ 12582912) {\n\t\t\t $$invalidate(18, shouldAnimate = animations === \"always\"\n\t\t\t? canAnimate\n\t\t\t: animations === \"never\"\n\t\t\t\t? false\n\t\t\t\t: canAnimate && acceptsAnimations);\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$history*/ 67108864) {\n\t\t\t $$invalidate(180, canUndo = $history.index > -1);\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$history*/ 67108864) {\n\t\t\t $$invalidate(182, canRedo = $history.index < $history.length - 1);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale*/ 4 | $$self.$$.dirty[3] & /*utils*/ 268435456 | $$self.$$.dirty[5] & /*registeredPluginsComponents*/ 2) {\n\t\t\t $$invalidate(184, utilsFiltered = locale && registeredPluginsComponents.length\n\t\t\t? utils || registeredPluginsComponents.map(([id]) => id)\n\t\t\t: []);\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*registeredPluginsComponents, utilsFiltered*/ 536870914) {\n\t\t\t $$invalidate(185, utilsAvailable = registeredPluginsComponents.filter(([id]) => utilsFiltered.includes(id)));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*utilsAvailable*/ 1073741824) {\n\t\t\t $$invalidate(186, utilsDefined = utilsAvailable.length);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale*/ 4 | $$self.$$.dirty[5] & /*utilsFiltered, utilsAvailable*/ 1610612736) {\n\t\t\t $$invalidate(20, utilsMerged = utilsFiltered.map(utilId => {\n\t\t\t\tconst util = utilsAvailable.find(([id]) => utilId === id); // [id, view]\n\t\t\t\tif (!util) return;\n\n\t\t\t\treturn {\n\t\t\t\t\tid: utilId,\n\t\t\t\t\tview: util[1],\n\t\t\t\t\ttabIcon: locale[`${utilId}Icon`],\n\t\t\t\t\ttabLabel: locale[`${utilId}Label`]\n\t\t\t\t};\n\t\t\t}).filter(Boolean) || []);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*util*/ 134217728 | $$self.$$.dirty[5] & /*utilsFiltered*/ 536870912 | $$self.$$.dirty[6] & /*utilsDefined*/ 1) {\n\t\t\t $$invalidate(21, utilSelected = util && typeof util === \"string\" && utilsFiltered.includes(util)\n\t\t\t? util\n\t\t\t: utilsDefined && utilsFiltered[0]);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*utilSelected, pluginInterface*/ 2097153) {\n\t\t\t $$invalidate(187, utilTools = utilSelected && pluginInterface[utilSelected].tools || []);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*utilsMerged, utilsVisibleFraction*/ 5242880) {\n\t\t\t $$invalidate(22, utilsVisibleFraction = utilsMerged.reduce(\n\t\t\t\t(prev, curr) => {\n\t\t\t\t\tprev[curr.id] = utilsVisibleFraction && utilsVisibleFraction[curr.id] || 0;\n\t\t\t\t\treturn prev;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*utilSelected*/ 2097152) {\n\t\t\t $$invalidate(23, tabsConfig = {\n\t\t\t\tname: utilsUniqueId,\n\t\t\t\tselected: utilSelected\n\t\t\t});\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*utilsMerged*/ 1048576) {\n\t\t\t $$invalidate(24, tabs = utilsMerged.map(util => ({\n\t\t\t\tid: util.id,\n\t\t\t\ticon: util.tabIcon,\n\t\t\t\tlabel: util.tabLabel\n\t\t\t})));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*utilsMerged*/ 1048576) {\n\t\t\t $$invalidate(25, panels = utilsMerged.map(util => util.id));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*utilsFiltered*/ 536870912) {\n\t\t\t $$invalidate(16, shouldRenderTabs = utilsFiltered.length > 1);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*klass*/ 16777216) {\n\t\t\t $$invalidate(26, className = arrayJoin([\"DokaRoot\", \"DokaRootComponent\", klass]));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$rootRect*/ 256) {\n\t\t\t $$invalidate(188, orientation = $rootRect && ($rootRect.width > $rootRect.height\n\t\t\t? \"landscape\"\n\t\t\t: \"portrait\"));\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*orientation*/ 4) {\n\t\t\t $$invalidate(27, isLandscape = orientation === \"landscape\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$rootRect*/ 256) {\n\t\t\t $$invalidate(189, horizontalSpace = $rootRect && ($rootRect.width > 1000\n\t\t\t? \"wide\"\n\t\t\t: $rootRect.width < 600 ? \"narrow\" : undefined));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$rootRect*/ 256) {\n\t\t\t $$invalidate(190, hasLimitedSpace = $rootRect && ($rootRect.width <= 320 || $rootRect.height <= 460));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$rootRect*/ 256) {\n\t\t\t $$invalidate(191, verticalSpace = $rootRect && ($rootRect.height > 1000\n\t\t\t? \"tall\"\n\t\t\t: $rootRect.height < 600 ? \"short\" : undefined));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*root*/ 2) {\n\t\t\t $$invalidate(192, isModal = root && root.parentNode && root.parentNode.classList.contains(\"DokaModal\"));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*windowWidth*/ 1024 | $$self.$$.dirty[5] & /*$rootRect*/ 256 | $$self.$$.dirty[6] & /*isModal*/ 64) {\n\t\t\t $$invalidate(193, isCenteredHorizontally = isModal && $rootRect && windowWidth > $rootRect.width);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*windowHeight*/ 2048 | $$self.$$.dirty[5] & /*$rootRect*/ 256 | $$self.$$.dirty[6] & /*isModal*/ 64) {\n\t\t\t $$invalidate(194, isCenteredVertically = isModal && $rootRect && windowHeight > $rootRect.height);\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*isCenteredHorizontally, isCenteredVertically*/ 384) {\n\t\t\t $$invalidate(195, isCentered = isCenteredHorizontally && isCenteredVertically);\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*horizontalSpace*/ 8) {\n\t\t\t $$invalidate(196, isNarrow = horizontalSpace === \"narrow\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*isNarrow, verticalSpace*/ 1056) {\n\t\t\t $$invalidate(197, isCompact = isNarrow || verticalSpace === \"short\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*windowWidth*/ 1024 | $$self.$$.dirty[5] & /*$rootRect*/ 256) {\n\t\t\t $$invalidate(198, hasSwipeNavigation = iOS && ($rootRect && windowWidth === $rootRect.width) && !shouldPreventSwipe);\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*utilTools, verticalSpace*/ 34) {\n\t\t\t $$invalidate(199, shouldRenderUtilTools = utilTools.length && verticalSpace === \"short\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*root*/ 2) {\n\t\t\t// will update when root element is available\n\t\t\t $$invalidate(200, rootElementComputedStyle = root && getComputedStyle(root));\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*rootElementComputedStyle*/ 16384) {\n\t\t\t// sync for first time\n\t\t\t if (rootElementComputedStyle) syncBackgroundColor();\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*enableToolbar, shouldRenderTabs, showUtils*/ 81984 | $$self.$$.dirty[3] & /*layoutMode*/ 33554432 | $$self.$$.dirty[6] & /*$env, orientation, horizontalSpace, verticalSpace, isModal, isCentered, isCenteredHorizontally, isCenteredVertically, $pointerAccuracy, $pointerHoverable, isCompact, hasSwipeNavigation, hasLimitedSpace*/ 236540) {\n\t\t\t env.set({\n\t\t\t\t...$env,\n\t\t\t\tlayoutMode,\n\t\t\t\torientation,\n\t\t\t\thorizontalSpace,\n\t\t\t\tverticalSpace,\n\t\t\t\tisModal,\n\t\t\t\tisCentered,\n\t\t\t\tisCenteredHorizontally,\n\t\t\t\tisCenteredVertically,\n\t\t\t\tpointerAccuracy: $pointerAccuracy,\n\t\t\t\tpointerHoverable: $pointerHoverable,\n\t\t\t\tisCompact,\n\t\t\t\thasSwipeNavigation,\n\t\t\t\thasLimitedSpace,\n\t\t\t\thasToolbar: enableToolbar,\n\t\t\t\thasNavigation: shouldRenderTabs && showUtils,\n\t\t\t\tisIOS: iOS\n\t\t\t});\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*$env*/ 32768) {\n\t\t\t $$invalidate(29, envStr = Object.keys($env).map(key => {\n\t\t\t\t// is true boolean prop, use key\n\t\t\t\tif ((/^is|has/).test(key)) {\n\t\t\t\t\treturn $env[key] ? toKebabCase(key) : undefined;\n\t\t\t\t}\n\n\t\t\t\t// use value\n\t\t\t\treturn $env[key];\n\t\t\t}).filter(Boolean).join(\" \"));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$imageCropRect*/ 16384 | $$self.$$.dirty[6] & /*$imageTransforms, $imagePreviewModifiers, $imageEffects, $imageBackgroundColor*/ 3932160) {\n\t\t\t $$invalidate(30, imageProps = $imageTransforms\n\t\t\t? {\n\t\t\t\t\t// modifiers\n\t\t\t\t\t...Object.keys($imagePreviewModifiers).filter(key => $imagePreviewModifiers[key] != null).reduce(\n\t\t\t\t\t\t(prev, curr) => {\n\t\t\t\t\t\t\tprev = { ...prev, ...$imagePreviewModifiers[curr] };\n\t\t\t\t\t\t\treturn prev;\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{}\n\t\t\t\t\t),\n\t\t\t\t\t// default props\n\t\t\t\t\t...$imageTransforms,\n\t\t\t\t\t...$imageEffects,\n\t\t\t\t\tbackgroundColor: $imageBackgroundColor,\n\t\t\t\t\tsize: sizeCreateFromRect($imageCropRect)\n\t\t\t\t}\n\t\t\t: undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale*/ 4 | $$self.$$.dirty[6] & /*missingFeatures*/ 4194304) {\n\t\t\t $$invalidate(32, isSupportsError = locale && missingFeatures.length && locale.labelSupportError(missingFeatures));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$imageLoadState*/ 1024) {\n\t\t\t//\n\t\t\t// loading status\n\t\t\t//\n\t\t\t $$invalidate(33, isImageLoadError = $imageLoadState && !!$imageLoadState.error);\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$imageLoadState*/ 1024) {\n\t\t\t $$invalidate(34, isWaitingForImage = !$imageLoadState || !$imageLoadState.complete && $imageLoadState.task === undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$imageLoadState*/ 1024) {\n\t\t\t $$invalidate(35, imageLoadProgress = $imageLoadState && ($imageLoadState.taskLengthComputable\n\t\t\t? $imageLoadState.taskProgress\n\t\t\t: Infinity));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$imageLoadState, loadTimer*/ 1040) {\n\t\t\t if ($imageLoadState && $imageLoadState.complete) {\n\t\t\t\t// TODO: derive visual load complete from interface rest state instead of arbitrary timer\n\t\t\t\tclearTimeout(loadTimer);\n\n\t\t\t\t$$invalidate(159, loadTimer = setTimeout(\n\t\t\t\t\t() => {\n\t\t\t\t\t\tset_store_value(imageVisualLoadComplete, $imageVisualLoadComplete = true, $imageVisualLoadComplete);\n\t\t\t\t\t},\n\t\t\t\t\t500\n\t\t\t\t));\n\t\t\t} else if (!$imageLoadState) {\n\t\t\t\tset_store_value(imageVisualLoadComplete, $imageVisualLoadComplete = false, $imageVisualLoadComplete);\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*isImageLoadError, isWaitingForImage*/ 12 | $$self.$$.dirty[5] & /*$imageLoadState*/ 1024 | $$self.$$.dirty[6] & /*$imageVisualLoadComplete*/ 8388608) {\n\t\t\t $$invalidate(36, isLoadingImageData = $imageLoadState && !isImageLoadError && !isWaitingForImage && !$imageVisualLoadComplete);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$imagePreview*/ 128 | $$self.$$.dirty[6] & /*$imageFile*/ 16777216) {\n\t\t\t $$invalidate(37, isCreatingImagePreview = !!($imageFile && !$imagePreview));\n\t\t}\n\n\t\tif ($$self.$$.dirty[5] & /*$imageProcessingPreparing*/ 268435456 | $$self.$$.dirty[6] & /*$imageProcessState*/ 33554432) {\n\t\t\t//\n\t\t\t// processing status\n\t\t\t//\n\t\t\t $$invalidate(39, isProcessingImage = $imageProcessingPreparing || $imageProcessState && $imageProcessState.progress !== undefined && !$imageProcessState.complete);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*isWaitingForImage*/ 8 | $$self.$$.dirty[5] & /*$imageLoadState*/ 1024) {\n\t\t\t $$invalidate(40, imageLoadShowProgressIndicator = $imageLoadState && !($imageLoadState.error || isWaitingForImage));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale*/ 4 | $$self.$$.dirty[5] & /*$imageLoadState*/ 1024) {\n\t\t\t $$invalidate(41, imageLoadStatusLabel = locale && (!$imageLoadState\n\t\t\t? locale.statusLabelLoadImage($imageLoadState)\n\t\t\t: !$imageLoadState.complete\n\t\t\t\t? stringReplace(locale.statusLabelLoadImage($imageLoadState), $imageLoadState.error && $imageLoadState.error.metadata, \"{\", \"}\")\n\t\t\t\t: locale.statusLabelLoadImage({\n\t\t\t\t\t\tprogress: Infinity,\n\t\t\t\t\t\ttask: \"blob-to-bitmap\"\n\t\t\t\t\t})));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale*/ 4 | $$self.$$.dirty[6] & /*$imageProcessState*/ 33554432) {\n\t\t\t $$invalidate(42, imageProcessStatusLabel = $imageProcessState && locale && locale.statusLabelProcessImage($imageProcessState));\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*$imageProcessState*/ 33554432) {\n\t\t\t $$invalidate(43, imageProcessProgress = $imageProcessState && ($imageProcessState.taskLengthComputable\n\t\t\t? $imageProcessState.taskProgress\n\t\t\t: Infinity));\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*$imageProcessState*/ 33554432) {\n\t\t\t $$invalidate(44, imageProcessShowProgressIndicator = $imageProcessState && !$imageProcessState.error);\n\t\t}\n\n\t\tif ($$self.$$.dirty[6] & /*$imageProcessState*/ 33554432) {\n\t\t\t $$invalidate(45, isImageProcessingError = $imageProcessState && $imageProcessState.error);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*isSupportsError, isWaitingForImage, isImageLoadError, isLoadingImageData, isCreatingImagePreview, isProcessingImage*/ 366) {\n\t\t\t set_store_value(\n\t\t\t\tstatusOpacity,\n\t\t\t\t$statusOpacity = isSupportsError || isWaitingForImage || isImageLoadError || isLoadingImageData || isCreatingImagePreview || isProcessingImage\n\t\t\t\t? 1\n\t\t\t\t: 0,\n\t\t\t\t$statusOpacity\n\t\t\t);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$statusOpacity*/ 32768) {\n\t\t\t $$invalidate(47, isStatusVisible = $statusOpacity > 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$statusOpacity*/ 32768) {\n\t\t\t if ($statusOpacity <= 0) hideStatus();\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*windowWidth*/ 1024) {\n\t\t\t $$invalidate(50, handleTouchStart = shouldPreventSwipe && (e => {\n\t\t\t\t// get touch or event itself (fixes issue with chrome dev tools)\n\t\t\t\tconst event = e.touches ? e.touches[0] : e;\n\n\t\t\t\t// if is not an attempt to swipe back or forward\n\t\t\t\tif (event.pageX > 10 && event.pageX < windowWidth - 10) return;\n\n\t\t\t\t// stop the navigation attempt\n\t\t\t\te.preventDefault();\n\t\t\t}));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale*/ 4 | $$self.$$.dirty[4] & /*willRenderToolbar, enableButtonClose, enableButtonRevert, enableNavigateHistory, enableButtonExport*/ 94 | $$self.$$.dirty[5] & /*canUndo, canRedo*/ 167772160 | $$self.$$.dirty[6] & /*shouldRenderUtilTools, utilTools, isNarrow, $env*/ 41986) {\n\t\t\t// dynamic IO menu\n\t\t\t $$invalidate(51, toolbarItems = locale && willRenderToolbar(\n\t\t\t\t[\n\t\t\t\t\t[\n\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\"alpha\",\n\t\t\t\t\t\t{ class: \"DokaNavGroup\" },\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t\"alpha-set\",\n\t\t\t\t\t\t\t\t{ class: \"DokaNavSet\" },\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t// button close\n\t\t\t\t\t\t\t\t\tenableButtonClose && [\n\t\t\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\t\t\"close\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tlabel: locale.labelClose,\n\t\t\t\t\t\t\t\t\t\t\ticon: locale.iconButtonClose,\n\t\t\t\t\t\t\t\t\t\t\tonclick: () => dispatch(\"close\"),\n\t\t\t\t\t\t\t\t\t\t\thideLabel: true\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t// button revert\n\t\t\t\t\t\t\t\t\tenableButtonRevert && [\n\t\t\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\t\t\"revert\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tlabel: locale.labelButtonRevert,\n\t\t\t\t\t\t\t\t\t\t\ticon: locale.iconButtonRevert,\n\t\t\t\t\t\t\t\t\t\t\tdisabled: !canUndo,\n\t\t\t\t\t\t\t\t\t\t\tonclick: revert,\n\t\t\t\t\t\t\t\t\t\t\thideLabel: true\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t]\n\t\t\t\t\t],\n\t\t\t\t\t[\n\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\"beta\",\n\t\t\t\t\t\t{ class: \"DokaNavGroup DokaNavGroupFloat\" },\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tenableNavigateHistory && [\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t\"history\",\n\t\t\t\t\t\t\t\t{ class: \"DokaNavSet\" },\n\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\t\t\"undo\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tlabel: locale.labelButtonUndo,\n\t\t\t\t\t\t\t\t\t\t\ticon: locale.iconButtonUndo,\n\t\t\t\t\t\t\t\t\t\t\tdisabled: !canUndo,\n\t\t\t\t\t\t\t\t\t\t\tonclick: history.undo,\n\t\t\t\t\t\t\t\t\t\t\thideLabel: true\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\t\t\"redo\",\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tlabel: locale.labelButtonRedo,\n\t\t\t\t\t\t\t\t\t\t\ticon: locale.iconButtonRedo,\n\t\t\t\t\t\t\t\t\t\t\tdisabled: !canRedo,\n\t\t\t\t\t\t\t\t\t\t\tonclick: history.redo,\n\t\t\t\t\t\t\t\t\t\t\thideLabel: true\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tshouldRenderUtilTools && [\n\t\t\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\t\t\"plugin-tools\",\n\t\t\t\t\t\t\t\t{ class: \"DokaNavSet\" },\n\t\t\t\t\t\t\t\tutilTools.filter(Boolean).map(// in\n\t\t\t\t\t\t\t\t([component, key, props]) => // out\n\t\t\t\t\t\t\t\t[component, key, { ...props, hideLabel: true }])\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t]\n\t\t\t\t\t],\n\t\t\t\t\t[\n\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\"gamma\",\n\t\t\t\t\t\t{ class: \"DokaNavGroup\" },\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tenableButtonExport && [\n\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\"export\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: locale.labelButtonExport,\n\t\t\t\t\t\t\t\t\ticon: isNarrow && locale.iconButtonExport,\n\t\t\t\t\t\t\t\t\tclass: \"DokaButtonExport\",\n\t\t\t\t\t\t\t\t\tonclick: handleExport,\n\t\t\t\t\t\t\t\t\thideLabel: isNarrow\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t]\n\t\t\t\t\t]\n\t\t\t\t],\n\t\t\t\t{ ...$env }\n\t\t\t));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$clientRect*/ 32768) {\n\t\t\t $$invalidate(212, hasClientRect = $clientRect && $clientRect.width > 0 && $clientRect.height > 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale*/ 4 | $$self.$$.dirty[6] & /*hasClientRect, utilsDefined*/ 67108865) {\n\t\t\t $$invalidate(52, canRender = hasClientRect && locale && utilsDefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*rootPortal*/ 8192) {\n\t\t\t rootPortal && rootPortalStore.set(rootPortal);\n\t\t}\n\t};\n\n\t $$invalidate(208, missingFeatures = [!supportsWebGL() && \"WebGL\"].filter(Boolean));\n\n\t// used to route ping events\n\t $$invalidate(53, routePing = createPingRouter(eventProxy.pub));\n\n\treturn [\n\t\tpluginInterface,\n\t\troot,\n\t\tlocale,\n\t\tid,\n\t\telasticityMultiplier,\n\t\twillRenderCanvas,\n\t\tenableToolbar,\n\t\tpluginOptions,\n\t\timageSourceToImageData,\n\t\thistory,\n\t\twindowWidth,\n\t\twindowHeight,\n\t\tutilsVisible,\n\t\trootPortal,\n\t\tshowUtils,\n\t\t$clientRect,\n\t\tshouldRenderTabs,\n\t\t$imageSize,\n\t\tshouldAnimate,\n\t\t$tabRect,\n\t\tutilsMerged,\n\t\tutilSelected,\n\t\tutilsVisibleFraction,\n\t\ttabsConfig,\n\t\ttabs,\n\t\tpanels,\n\t\tclassName,\n\t\tisLandscape,\n\t\t$rootBackgroundColor,\n\t\tenvStr,\n\t\timageProps,\n\t\t$imageSelectionRectPresentation,\n\t\tisSupportsError,\n\t\tisImageLoadError,\n\t\tisWaitingForImage,\n\t\timageLoadProgress,\n\t\tisLoadingImageData,\n\t\tisCreatingImagePreview,\n\t\t$imagePreview,\n\t\tisProcessingImage,\n\t\timageLoadShowProgressIndicator,\n\t\timageLoadStatusLabel,\n\t\timageProcessStatusLabel,\n\t\timageProcessProgress,\n\t\timageProcessShowProgressIndicator,\n\t\tisImageProcessingError,\n\t\t$statusOpacity,\n\t\tisStatusVisible,\n\t\t$statusOffsetX,\n\t\t$progressOffsetX,\n\t\thandleTouchStart,\n\t\ttoolbarItems,\n\t\tcanRender,\n\t\troutePing,\n\t\t$toolRect,\n\t\t$utilRect,\n\t\t$pixelRatio,\n\t\t$imagePreviews,\n\t\t$imageDecoration,\n\t\t$imageAnnotation,\n\t\t$imageOverlay,\n\t\timageFile,\n\t\timageSize,\n\t\timageLoadState,\n\t\timageProcessState,\n\t\timageCropRect,\n\t\timageBackgroundColor,\n\t\timageDecoration,\n\t\timageAnnotation,\n\t\timageState,\n\t\timages,\n\t\trootBackgroundColor,\n\t\tclientRect,\n\t\trootRect,\n\t\ttabRect,\n\t\ttoolRect,\n\t\tutilRect,\n\t\tstageRect,\n\t\tpointerAccuracy,\n\t\tpointerHoverable,\n\t\tisInteracting,\n\t\tisInteractingFraction,\n\t\tpreviewShouldUpscale,\n\t\tstageScalar,\n\t\timageCropRectSnapshot,\n\t\timageCropRectIntent,\n\t\timageSelectionRect,\n\t\timageSelectionRectSnapshot,\n\t\timageSelectionRectIntent,\n\t\timageSelectionRectPresentation,\n\t\tpresentationScalar,\n\t\timageOverlay,\n\t\timageVisualLoadComplete,\n\t\timagePreview,\n\t\timagePreviewModifiers,\n\t\timagePreviews,\n\t\timageTransforms,\n\t\timageEffects,\n\t\tenv,\n\t\tpixelRatio,\n\t\timageProcessingPreparing,\n\t\tutilStores,\n\t\thandleTransitionEnd,\n\t\tstatusOpacity,\n\t\tstatusOffsetX,\n\t\tprogressOffsetX,\n\t\toffsetProgress,\n\t\thandleCloseImageLoadError,\n\t\thandleCloseImageProcessError,\n\t\tpressedKeysStore,\n\t\thandleKeydown,\n\t\thandleKeyup,\n\t\thandleWindowBlur,\n\t\thandleContextMenu,\n\t\thandleDropFiles,\n\t\tgetStageState,\n\t\tcreateCanvasState,\n\t\tklass,\n\t\tlayoutMode,\n\t\tstores,\n\t\tutil,\n\t\tutils,\n\t\tanimations,\n\t\tpreviewUpscale,\n\t\twillRevert,\n\t\twillRenderToolbar,\n\t\tenableButtonExport,\n\t\tenableButtonRevert,\n\t\tenableNavigateHistory,\n\t\tenableUtils,\n\t\tenableButtonClose,\n\t\tpreviewImageDataMaxSize,\n\t\tenableDropImage,\n\t\timageOrienter,\n\t\tpluginComponents,\n\t\tsub,\n\t\tonwindowresize,\n\t\tmeasure_handler,\n\t\tselect_handler,\n\t\tfunc,\n\t\tpanel_component_binding,\n\t\tmeasure_handler_1,\n\t\tshow_handler,\n\t\thide_handler,\n\t\tfade_handler,\n\t\tmeasure_handler_2,\n\t\tfunc_1,\n\t\tpanel_component_binding_1,\n\t\tmeasure_handler_3,\n\t\tshow_handler_1,\n\t\thide_handler_1,\n\t\tfade_handler_1,\n\t\tfunc_2,\n\t\tdiv_binding,\n\t\tdiv_binding_1,\n\t\tmeasure_handler_4\n\t];\n}\n\nclass Ui extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$b,\n\t\t\tcreate_fragment$b,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tclass: 117,\n\t\t\t\tlayout: 118,\n\t\t\t\tstores: 119,\n\t\t\t\tlocale: 2,\n\t\t\t\tid: 3,\n\t\t\t\tutil: 120,\n\t\t\t\tutils: 121,\n\t\t\t\tanimations: 122,\n\t\t\t\tpreviewUpscale: 123,\n\t\t\t\telasticityMultiplier: 4,\n\t\t\t\twillRevert: 124,\n\t\t\t\twillRenderCanvas: 5,\n\t\t\t\twillRenderToolbar: 125,\n\t\t\t\tenableButtonExport: 126,\n\t\t\t\tenableButtonRevert: 127,\n\t\t\t\tenableNavigateHistory: 128,\n\t\t\t\tenableToolbar: 6,\n\t\t\t\tenableUtils: 129,\n\t\t\t\tenableButtonClose: 130,\n\t\t\t\tpreviewImageDataMaxSize: 131,\n\t\t\t\tenableDropImage: 132,\n\t\t\t\timageOrienter: 133,\n\t\t\t\tpluginComponents: 134,\n\t\t\t\tpluginOptions: 7,\n\t\t\t\tsub: 135,\n\t\t\t\tpluginInterface: 0,\n\t\t\t\troot: 1,\n\t\t\t\timageSourceToImageData: 8,\n\t\t\t\thistory: 9\n\t\t\t},\n\t\t\t[-1, -1, -1, -1, -1, -1, -1, -1, -1]\n\t\t);\n\t}\n\n\tget class() {\n\t\treturn this.$$.ctx[117];\n\t}\n\n\tset class(klass) {\n\t\tthis.$set({ class: klass });\n\t\tflush();\n\t}\n\n\tget layout() {\n\t\treturn this.$$.ctx[118];\n\t}\n\n\tset layout(layoutMode) {\n\t\tthis.$set({ layout: layoutMode });\n\t\tflush();\n\t}\n\n\tget stores() {\n\t\treturn this.$$.ctx[119];\n\t}\n\n\tset stores(stores) {\n\t\tthis.$set({ stores });\n\t\tflush();\n\t}\n\n\tget locale() {\n\t\treturn this.$$.ctx[2];\n\t}\n\n\tset locale(locale) {\n\t\tthis.$set({ locale });\n\t\tflush();\n\t}\n\n\tget id() {\n\t\treturn this.$$.ctx[3];\n\t}\n\n\tset id(id) {\n\t\tthis.$set({ id });\n\t\tflush();\n\t}\n\n\tget util() {\n\t\treturn this.$$.ctx[120];\n\t}\n\n\tset util(util) {\n\t\tthis.$set({ util });\n\t\tflush();\n\t}\n\n\tget utils() {\n\t\treturn this.$$.ctx[121];\n\t}\n\n\tset utils(utils) {\n\t\tthis.$set({ utils });\n\t\tflush();\n\t}\n\n\tget animations() {\n\t\treturn this.$$.ctx[122];\n\t}\n\n\tset animations(animations) {\n\t\tthis.$set({ animations });\n\t\tflush();\n\t}\n\n\tget previewUpscale() {\n\t\treturn this.$$.ctx[123];\n\t}\n\n\tset previewUpscale(previewUpscale) {\n\t\tthis.$set({ previewUpscale });\n\t\tflush();\n\t}\n\n\tget elasticityMultiplier() {\n\t\treturn this.$$.ctx[4];\n\t}\n\n\tset elasticityMultiplier(elasticityMultiplier) {\n\t\tthis.$set({ elasticityMultiplier });\n\t\tflush();\n\t}\n\n\tget willRevert() {\n\t\treturn this.$$.ctx[124];\n\t}\n\n\tset willRevert(willRevert) {\n\t\tthis.$set({ willRevert });\n\t\tflush();\n\t}\n\n\tget willRenderCanvas() {\n\t\treturn this.$$.ctx[5];\n\t}\n\n\tset willRenderCanvas(willRenderCanvas) {\n\t\tthis.$set({ willRenderCanvas });\n\t\tflush();\n\t}\n\n\tget willRenderToolbar() {\n\t\treturn this.$$.ctx[125];\n\t}\n\n\tset willRenderToolbar(willRenderToolbar) {\n\t\tthis.$set({ willRenderToolbar });\n\t\tflush();\n\t}\n\n\tget enableButtonExport() {\n\t\treturn this.$$.ctx[126];\n\t}\n\n\tset enableButtonExport(enableButtonExport) {\n\t\tthis.$set({ enableButtonExport });\n\t\tflush();\n\t}\n\n\tget enableButtonRevert() {\n\t\treturn this.$$.ctx[127];\n\t}\n\n\tset enableButtonRevert(enableButtonRevert) {\n\t\tthis.$set({ enableButtonRevert });\n\t\tflush();\n\t}\n\n\tget enableNavigateHistory() {\n\t\treturn this.$$.ctx[128];\n\t}\n\n\tset enableNavigateHistory(enableNavigateHistory) {\n\t\tthis.$set({ enableNavigateHistory });\n\t\tflush();\n\t}\n\n\tget enableToolbar() {\n\t\treturn this.$$.ctx[6];\n\t}\n\n\tset enableToolbar(enableToolbar) {\n\t\tthis.$set({ enableToolbar });\n\t\tflush();\n\t}\n\n\tget enableUtils() {\n\t\treturn this.$$.ctx[129];\n\t}\n\n\tset enableUtils(enableUtils) {\n\t\tthis.$set({ enableUtils });\n\t\tflush();\n\t}\n\n\tget enableButtonClose() {\n\t\treturn this.$$.ctx[130];\n\t}\n\n\tset enableButtonClose(enableButtonClose) {\n\t\tthis.$set({ enableButtonClose });\n\t\tflush();\n\t}\n\n\tget previewImageDataMaxSize() {\n\t\treturn this.$$.ctx[131];\n\t}\n\n\tset previewImageDataMaxSize(previewImageDataMaxSize) {\n\t\tthis.$set({ previewImageDataMaxSize });\n\t\tflush();\n\t}\n\n\tget enableDropImage() {\n\t\treturn this.$$.ctx[132];\n\t}\n\n\tset enableDropImage(enableDropImage) {\n\t\tthis.$set({ enableDropImage });\n\t\tflush();\n\t}\n\n\tget imageOrienter() {\n\t\treturn this.$$.ctx[133];\n\t}\n\n\tset imageOrienter(imageOrienter) {\n\t\tthis.$set({ imageOrienter });\n\t\tflush();\n\t}\n\n\tget pluginComponents() {\n\t\treturn this.$$.ctx[134];\n\t}\n\n\tset pluginComponents(pluginComponents) {\n\t\tthis.$set({ pluginComponents });\n\t\tflush();\n\t}\n\n\tget pluginOptions() {\n\t\treturn this.$$.ctx[7];\n\t}\n\n\tset pluginOptions(pluginOptions) {\n\t\tthis.$set({ pluginOptions });\n\t\tflush();\n\t}\n\n\tget sub() {\n\t\treturn this.$$.ctx[135];\n\t}\n\n\tget pluginInterface() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tget root() {\n\t\treturn this.$$.ctx[1];\n\t}\n\n\tset root(root) {\n\t\tthis.$set({ root });\n\t\tflush();\n\t}\n\n\tget imageSourceToImageData() {\n\t\treturn this.$$.ctx[8];\n\t}\n\n\tset imageSourceToImageData(imageSourceToImageData) {\n\t\tthis.$set({ imageSourceToImageData });\n\t\tflush();\n\t}\n\n\tget history() {\n\t\treturn this.$$.ctx[9];\n\t}\n}\n\n// which props to filter out of exported props\nconst utilPrivateProps = ['klass', 'stores', 'isVisible', 'isActive', 'isActiveFraction', 'locale'];\nconst viewPrivateProps = [\n    // methods\n    'history',\n    // props\n    'klass',\n    'stores',\n    'navButtons',\n    'pluginComponents',\n    'pluginInterface',\n    'pluginOptions',\n    'sub',\n];\n// view options array\nlet editorProps;\nconst pluginProps = new Set([]);\nconst propPluginRef = {};\n// loops over plugins and registers all available options so we can define getters/setters\nconst pluginComponents = new Map();\nconst setEditorViewPlugins = (...args) => {\n    args.forEach((plugin) => {\n        const [id, Component] = plugin.util;\n        pluginComponents.set(id, Component);\n        getComponentExportedProps(Component)\n            .filter((prop) => !utilPrivateProps.includes(prop))\n            .forEach((prop) => {\n            pluginProps.add(prop);\n            if (propPluginRef[prop]) {\n                propPluginRef[prop].push(id);\n                return;\n            }\n            propPluginRef[prop] = [id];\n        });\n    });\n};\nconst getEditorViewProps = () => {\n    editorProps = new Set(getComponentExportedProps(Ui).filter((prop) => !viewPrivateProps.includes(prop)));\n    return [...editorProps, ...pluginProps];\n};\nconst attachEditorView = (target, stores) => {\n    const accessors = {};\n    const editor = new Ui({\n        target,\n        props: {\n            stores,\n            pluginComponents: Array.from(pluginComponents),\n        },\n    });\n    // set up accessors for editor props\n    if (!editorProps)\n        editorProps = new Set(getComponentExportedProps(Ui).filter((prop) => !viewPrivateProps.includes(prop)));\n    editorProps.forEach((prop) => {\n        Object.defineProperty(accessors, prop, {\n            get: () => editor.prop,\n            set: (value) => (editor[prop] = value),\n        });\n    });\n    // set up accessors for plugin props\n    pluginProps.forEach((prop) => {\n        const plugins = propPluginRef[prop];\n        const plugin = plugins[0]; // will always get value from first plugin, when plugins share a property the value will be in sync when set\n        Object.defineProperty(accessors, prop, {\n            get: () => editor.pluginInterface[plugin][prop],\n            set: (value) => {\n                const opts = plugins.reduce((prev, plugin) => {\n                    prev[plugin] = {\n                        ...editor.pluginOptions[plugin],\n                        [prop]: value,\n                    };\n                    return prev;\n                }, {});\n                editor.pluginOptions = {\n                    ...editor.pluginOptions,\n                    ...opts,\n                };\n            },\n        });\n    });\n    // add element root query\n    Object.defineProperty(accessors, 'element', {\n        get: () => editor.root,\n        set: () => undefined,\n    });\n    defineMethods(accessors, {\n        on: (event, cb) => {\n            if (/undo|redo|revert/.test(event))\n                return editor.history.on(event, cb);\n            const unsubs = [\n                editor.sub(event, cb),\n                editor.$on(event, (e) => cb(e instanceof CustomEvent && !e.detail ? undefined : e)),\n            ].filter(Boolean);\n            return () => unsubs.forEach((unsub) => unsub());\n        },\n        undo: () => editor.history.undo(),\n        redo: () => editor.history.redo(),\n        revert: () => editor.history.clear(),\n        close: () => editor.pub('close'),\n        destroy: () => editor.$destroy(),\n    });\n    // clean up on window unload\n    if (isBrowser())\n        window.addEventListener('pagehide', () => editor && editor.$destroy());\n    return accessors;\n};\n\nvar linkAccessors = (destination, origin) => {\n    const descriptors = Object.getOwnPropertyDescriptors(destination);\n    Object.keys(descriptors).forEach((key) => {\n        // props, set new setter and getter\n        if (!!descriptors[key]['get']) {\n            Object.defineProperty(origin, key, {\n                get: () => destination[key],\n                set: (value) => (destination[key] = value),\n            });\n        }\n        // method, copy reference\n        else {\n            origin[key] = destination[key];\n        }\n    });\n};\n\nvar editorEvents = [\n    ...editorEventsToBubble,\n    'undo',\n    'redo',\n    'revert',\n    'destroy',\n    'show',\n    'hide',\n    'close',\n    'selectshape',\n    'updateshape',\n    'addshape',\n    'removeshape',\n];\n\nvar hasDoctype = () => isBrowser() && document.doctype !== null;\n\nvar initEditorView = (target) => {\n    const accessors = {};\n    const { sub, pub } = pubsub();\n    // catch missing doctype\n    if (!hasDoctype())\n        console.warn('Missing Document Type Declaration');\n    // create editor core\n    const core = createImageEditor();\n    linkAccessors(core, accessors);\n    // create editor view\n    const view = attachEditorView(target, core.stores);\n    linkAccessors(view, accessors);\n    // listen for UI interaction and link to editor API (internals)\n    const unsubs = [\n        'loadImage',\n        'processImage',\n        'abortProcessImage',\n        'abortLoadImage',\n    ].map((event) => view.on(event, (e) => core[event](e && e.detail)));\n    // auto subscribes on each possible publisher\n    const subscribe = (event, cb) => {\n        const unsubInit = sub(event, cb);\n        const unsubCore = core.on(event, cb);\n        const unsubView = view.on(event, cb);\n        return () => {\n            unsubInit();\n            unsubCore();\n            unsubView();\n        };\n    };\n    // handles every event, useful for routing events from the options object\n    accessors.handleEvent = noop;\n    const handleEventUnsubs = editorEvents.map((type) => subscribe(type, (res) => accessors.handleEvent(type, res)));\n    // set up new api\n    defineMethods(accessors, {\n        on: subscribe,\n        close: () => {\n            pub('close');\n        },\n        destroy: () => {\n            // unsub\n            [...unsubs, ...handleEventUnsubs].forEach((unsub) => unsub());\n            // destroy\n            view.destroy();\n            core.destroy();\n            // destroyed\n            pub('destroy');\n        },\n    });\n    return accessors;\n};\n\nvar appendEditor = (target, options = {}) => {\n    const element = isString(target)\n        ? document.querySelector(target)\n        : target;\n    if (!element)\n        return undefined;\n    options.class = options.class ? `doka-image-editor ${options.class}` : 'doka-image-editor';\n    const accessors = initEditorView(element);\n    return Object.assign(accessors, options);\n};\n\nvar appendEditors = (targets, options = {}) => {\n    const elements = isString(targets)\n        ? Array.from(document.querySelectorAll(targets))\n        : targets;\n    return elements.filter(Boolean).map((element) => appendEditor(element, deepCopy(options)));\n};\n\n/* src/core/ui/modal/index.svelte generated by Svelte v3.29.4 */\n\nconst { document: document_1 } = globals;\n\nfunction create_fragment$c(ctx) {\n\tlet t;\n\tlet div;\n\tlet mounted;\n\tlet dispose;\n\tadd_render_callback(/*onwindowresize*/ ctx[14]);\n\n\treturn {\n\t\tc() {\n\t\t\tt = space();\n\t\t\tdiv = element(\"div\");\n\t\t\tattr(div, \"class\", \"doka-image-editor DokaModal\");\n\t\t\tattr(div, \"style\", /*style*/ ctx[4]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, t, anchor);\n\t\t\tinsert(target, div, anchor);\n\t\t\t/*div_binding*/ ctx[15](div);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(window, \"keydown\", /*handleKey*/ ctx[9]),\n\t\t\t\t\tlisten(window, \"orientationchange\", /*spawnMeasureElement*/ ctx[10]),\n\t\t\t\t\tlisten(window, \"resize\", /*onwindowresize*/ ctx[14]),\n\t\t\t\t\tlisten(document_1.body, \"focusin\", function () {\n\t\t\t\t\t\tif (is_function(!/*hidden*/ ctx[1] && /*handleFocusIn*/ ctx[6])) (!/*hidden*/ ctx[1] && /*handleFocusIn*/ ctx[6]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(document_1.body, \"focusout\", function () {\n\t\t\t\t\t\tif (is_function(/*hasFocussedTextField*/ ctx[2] && /*handleFocusOut*/ ctx[7])) (/*hasFocussedTextField*/ ctx[2] && /*handleFocusOut*/ ctx[7]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(div, \"wheel\", /*handleWheel*/ ctx[8])\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\n\t\t\tif (dirty[0] & /*style*/ 16) {\n\t\t\t\tattr(div, \"style\", /*style*/ ctx[4]);\n\t\t\t}\n\t\t},\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(t);\n\t\t\tif (detaching) detach(div);\n\t\t\t/*div_binding*/ ctx[15](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance$c($$self, $$props, $$invalidate) {\n\tlet $opacity;\n\tconst dispatch = createEventDispatcher();\n\tlet { root } = $$props;\n\tlet { preventZoomViewport = true } = $$props;\n\tlet hidden = true;\n\tlet hiding = false;\n\tlet showing = false;\n\tconst opacity = spring(0, { precision: 0.001, damping: 0.5 });\n\tcomponent_subscribe($$self, opacity, value => $$invalidate(25, $opacity = value));\n\n\t// animate hide and show\n\tconst unsub = opacity.subscribe(o => {\n\t\tif (showing && o >= 1) {\n\t\t\tshowing = false; // now shown\n\t\t\t$$invalidate(1, hidden = false);\n\t\t\tdispatch(\"show\");\n\t\t} else if (hiding && o <= 0) {\n\t\t\thiding = false; // now hidden\n\t\t\t$$invalidate(1, hidden = true);\n\t\t\tdispatch(\"hide\");\n\t\t}\n\t});\n\n\t// clean up when removed\n\tonDestroy(() => unsub());\n\n\tlet hasFocussedTextField = false;\n\tlet viewportDefaults = undefined;\n\tlet showTimeoutId = undefined;\n\tconst getViewPortElement = () => document.querySelector(\"meta[name=viewport]\");\n\n\tconst show = () => {\n\t\t// is visible, or busy becoming visible\n\t\tif (showing || !hidden) return;\n\n\t\t// now in 'showing' transition\n\t\tshowing = true;\n\n\t\t// store default viewport element values\n\t\tconst viewportElement = getViewPortElement() || h(\"meta\", { name: \"viewport\" });\n\n\t\tviewportDefaults = !viewportDefaults && viewportElement.getAttribute(\"content\");\n\n\t\tviewportElement.setAttribute(\"content\", viewportRules + ((/cover/).test(viewportDefaults)\n\t\t? \",viewport-fit=cover\"\n\t\t: \"\"));\n\n\t\tif (!viewportElement.parentNode) document.head.appendChild(viewportElement);\n\t\tclearTimeout(showTimeoutId);\n\t\tshowTimeoutId = setTimeout(() => set_store_value(opacity, $opacity = 1, $opacity), 250);\n\t};\n\n\tconst hide = () => {\n\t\t// is hiding or already hidden\n\t\tif (hiding || hidden) return;\n\n\t\t// if previous command was show, we need to prevent the timeout from kicking off\n\t\tclearTimeout(showTimeoutId);\n\n\t\t// now in 'hiding' transition\n\t\thiding = true;\n\n\t\t// get a reference to the viewport element, it should be there as we created it earlier, \n\t\t// we restore defaults if the viewport metatag was defined, if not, we destroy it\n\t\tconst viewportElement = getViewPortElement();\n\n\t\tif (viewportDefaults) viewportElement.setAttribute(\"content\", viewportDefaults); else document.head.removeChild(viewportElement);\n\n\t\t// let's hide!\n\t\tset_store_value(opacity, $opacity = 0, $opacity);\n\t};\n\n\t// handle soft keyboard impact on window height\n\tlet focusOutTimer;\n\n\tlet focusInWindowHeight;\n\n\tconst handleFocusIn = e => {\n\t\t// test if is text input element\n\t\tif (!(/textarea/i).test(e.target)) return;\n\n\t\t// now focussing a field\n\t\t$$invalidate(2, hasFocussedTextField = true);\n\n\t\tfocusInWindowHeight = windowHeight;\n\t};\n\n\tconst handleFocusOut = e => {\n\t\t// test if is text input element\n\t\tif (!(/textarea/i).test(e.target)) return;\n\n\t\t// prevent accidentally setting two timers\n\t\tclearTimeout(focusOutTimer);\n\n\t\t// test if window height changed, if not, no soft keyboard appeared and we can set false to focus state immidiately\n\t\tif (focusInWindowHeight === windowHeight) {\n\t\t\t$$invalidate(2, hasFocussedTextField = false);\n\t\t} else // soft keyboard might have appeared, test for window height change before setting unfocus state\n\t\t{\n\t\t\tconst windowCurrentHeight = windowHeight;\n\t\t\trunWhen(() => windowHeight !== windowCurrentHeight, () => $$invalidate(2, hasFocussedTextField = false));\n\t\t}\n\t};\n\n\tconst runWhen = (test, cb) => {\n\t\tconst frame = () => {\n\t\t\tif (test()) {\n\t\t\t\tcb();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\trequestAnimationFrame(frame);\n\t\t};\n\n\t\trequestAnimationFrame(frame);\n\t};\n\n\t// end soft keyboard logic\n\t// prevent mousewheel from scrolling content behind modal\n\tconst handleWheel = e => e.preventDefault();\n\n\t// handle escape to close modal\n\tconst handleKey = e => {\n\t\t// get key type\n\t\tconst { key } = e;\n\n\t\t// only deal with escape key\n\t\tif (!(/escape/i).test(key)) return;\n\n\t\t// don't close when in an input or textuarea\n\t\tconst targetElement = e.target;\n\n\t\tif (targetElement && (/input|textarea/i).test(targetElement.nodeName)) return;\n\t\thide();\n\t};\n\n\t// this logic scales modal to fit viewport height\n\tlet windowHeight = 0;\n\n\tlet windowHeightComputed;\n\n\t// iOS measure actual page height so we can make optional use of available space\n\tlet measureElement;\n\n\tlet measureElementHeight = undefined;\n\n\tconst spawnMeasureElement = () => {\n\t\t// can't spawn more than one\n\t\tif (measureElement) return;\n\n\t\tmeasureElement = h(\"div\", {\n\t\t\tstyle: \"position:fixed;height:100vh;top:0\"\n\t\t});\n\n\t\tdocument.body.appendChild(measureElement);\n\t};\n\n\tonMount(() => {\n\t\t// no need to run this logic if is not on iOS\n\t\tif (!isIOS()) return;\n\n\t\t// will be used in first read to determine page height and bottom padding\n\t\tspawnMeasureElement();\n\t});\n\n\tafterUpdate(() => {\n\t\t// will only run on iOS\n\t\tif (!measureElement) return;\n\n\t\t// get height and store\n\t\t$$invalidate(23, measureElementHeight = measureElement.offsetHeight);\n\n\t\t// remove measure element\n\t\tmeasureElement.parentNode.removeChild(measureElement);\n\n\t\tmeasureElement = undefined;\n\t});\n\n\tfunction onwindowresize() {\n\t\t$$invalidate(3, windowHeight = window.innerHeight);\n\t}\n\n\tfunction div_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\troot = $$value;\n\t\t\t$$invalidate(0, root);\n\t\t});\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"root\" in $$props) $$invalidate(0, root = $$props.root);\n\t\tif (\"preventZoomViewport\" in $$props) $$invalidate(11, preventZoomViewport = $$props.preventZoomViewport);\n\t};\n\n\tlet viewportRules;\n\tlet isIOSFooterVisible;\n\tlet style;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*preventZoomViewport*/ 2048) {\n\t\t\t viewportRules = \"width=device-width,height=device-height,initial-scale=1\" + (preventZoomViewport\n\t\t\t? \",maximum-scale=1,user-scalable=0\"\n\t\t\t: \"\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*hasFocussedTextField, windowHeight*/ 12) {\n\t\t\t if (!hasFocussedTextField) $$invalidate(21, windowHeightComputed = windowHeight);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*measureElementHeight, windowHeight*/ 8388616) {\n\t\t\t $$invalidate(26, isIOSFooterVisible = isIOS()\n\t\t\t? `--viewport-pad-footer:${measureElementHeight > windowHeight ? 0 : 1}`\n\t\t\t: \"\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*windowHeightComputed, $opacity, isIOSFooterVisible*/ 102760448) {\n\t\t\t $$invalidate(4, style = `height:${windowHeightComputed}px;opacity:${$opacity};--editor-modal:1;${isIOSFooterVisible}`);\n\t\t}\n\t};\n\n\treturn [\n\t\troot,\n\t\thidden,\n\t\thasFocussedTextField,\n\t\twindowHeight,\n\t\tstyle,\n\t\topacity,\n\t\thandleFocusIn,\n\t\thandleFocusOut,\n\t\thandleWheel,\n\t\thandleKey,\n\t\tspawnMeasureElement,\n\t\tpreventZoomViewport,\n\t\tshow,\n\t\thide,\n\t\tonwindowresize,\n\t\tdiv_binding\n\t];\n}\n\nclass Modal extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$c,\n\t\t\tcreate_fragment$c,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\troot: 0,\n\t\t\t\tpreventZoomViewport: 11,\n\t\t\t\tshow: 12,\n\t\t\t\thide: 13\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n\n\tget root() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tset root(root) {\n\t\tthis.$set({ root });\n\t\tflush();\n\t}\n\n\tget preventZoomViewport() {\n\t\treturn this.$$.ctx[11];\n\t}\n\n\tset preventZoomViewport(preventZoomViewport) {\n\t\tthis.$set({ preventZoomViewport });\n\t\tflush();\n\t}\n\n\tget show() {\n\t\treturn this.$$.ctx[12];\n\t}\n\n\tget hide() {\n\t\treturn this.$$.ctx[13];\n\t}\n}\n\n// @ts-ignore\n// we export a function that renders the view as to not export svelte component related code to outside the ui dir\nvar createModal = (options = {}, parent) => new Modal({\n    target: parent || document.body,\n    props: {\n        preventZoomViewport: options.preventZoomViewport,\n    },\n});\n\nvar openEditor = (options = {}, parent) => {\n    // set up pub/sub for the app layer\n    const { sub, pub } = pubsub();\n    const accessors = {};\n    const modal = createModal(options, parent);\n    const hide = () => {\n        modal.hide();\n    };\n    const show = () => {\n        modal.show();\n    };\n    const view = initEditorView(modal.root);\n    linkAccessors(view, accessors);\n    // link up handle event\n    accessors.handleEvent = noop;\n    view.handleEvent = (type, detail) => accessors.handleEvent(type, detail);\n    // route close request from view to modal\n    view.on('close', hide);\n    const subscribe = (event, cb) => {\n        // capture modal related events\n        if (/show|hide/.test(event))\n            return sub(event, cb);\n        // route rest of events to view\n        return view.on(event, cb);\n    };\n    const modalHandleEventUnsubs = ['show', 'hide'].map((type) => subscribe(type, (detail) => accessors.handleEvent(type, detail)));\n    // cleans up view\n    const destroy = () => {\n        // unsub\n        modalHandleEventUnsubs.forEach((unsub) => unsub());\n        // remove\n        hide();\n        modal.$destroy();\n        view.destroy();\n    };\n    defineMethods(accessors, {\n        on: subscribe,\n        destroy,\n        hide,\n        show,\n    });\n    // add element root query\n    Object.defineProperty(accessors, 'modal', {\n        get: () => modal.root,\n        set: () => undefined,\n    });\n    // destroy when hidden\n    modal.$on('show', () => pub('show'));\n    modal.$on('hide', () => {\n        pub('hide');\n        destroy();\n    });\n    // modal behavior\n    view.on('process', hide);\n    view.on('loadstart', show);\n    // test if should\n    if (options.enableButtonClose !== false)\n        options.enableButtonClose = true;\n    // update props\n    Object.assign(accessors, options);\n    return accessors;\n};\n\nvar overlayEditor = (target, options) => {\n    const editor = appendEditor(target, {\n        ...options,\n        layout: 'overlay',\n    });\n    return editor;\n};\n\nconst dispatchElementEvent = (target, event, detail) => target.dispatchEvent(new CustomEvent(event, { detail, bubbles: true, cancelable: true }));\nvar dispatchEditorEvents = (editor, handler, options = {}) => {\n    const { prefix = 'doka:' } = options;\n    return editorEvents.map((event) => editor.on(event, (value) => isElement(handler)\n        ? dispatchElementEvent(handler, `${prefix}${event}`, value)\n        : handler(event, value)));\n};\n\nconst TAG = 'doka-image-editor';\nvar customElement = () => new Promise((resolve) => {\n    if (!DokaImageEditorElement)\n        return resolve([]);\n    customElements.define(TAG, DokaImageEditorElement);\n    customElements.whenDefined(TAG).then(() => resolve(document.querySelectorAll(TAG)));\n});\nconst DokaImageEditorElement = isBrowser() &&\n    class extends HTMLElement {\n        constructor() {\n            super();\n            this._editor = undefined;\n            this._unsubs = undefined;\n        }\n        static get observedAttributes() {\n            return ['src'];\n        }\n        attributeChangedCallback(attrName, oldValue, newValue) {\n            this[attrName] = newValue;\n        }\n        connectedCallback() {\n            this._editor = initEditorView(this);\n            linkAccessors(this._editor, this);\n            this._editor.src = this.getAttribute('src');\n            this._unsubs = dispatchEditorEvents(this._editor, this);\n        }\n        disconnectedCallback() {\n            this._editor.destroy();\n            this._unsubs.forEach((unsub) => unsub());\n        }\n    };\n\nvar arrayInsert = (array, index, item) => {\n    array.splice(index, 0, item);\n    return array;\n};\n\n// first index is always id, so if is string, it's a node\nconst isNode = (item) => isString(item[0]);\n// if it's not a node, it's a nodelist\nconst isNodeList = (item) => !isNode(item);\nconst getNodeId = (node) => node[1];\nconst getNodeChildren = (node) => node[3] || [];\nconst createNode = (instance, id, props = {}, children = []) => [instance, id, props, children];\nconst insertNode = (node, needle, haystack, getIndex = (index) => index) => {\n    const nodeList = findNodeList(needle, haystack);\n    const targetIndex = nodeList.findIndex((item) => getNodeId(item) === needle);\n    arrayInsert(nodeList, getIndex(targetIndex), node);\n};\nconst insertNodeBefore = (node, needle, haystack) => insertNode(node, needle, haystack);\nconst insertNodeAfter = (node, needle, haystack) => insertNode(node, needle, haystack, (index) => index + 1);\nconst appendNode = (node, needle, haystack) => {\n    const parent = findNode(needle, haystack);\n    getNodeChildren(parent).push(node);\n    return parent;\n};\nconst removeNode = (needle, haystack) => {\n    const nodeList = findNodeList(needle, haystack);\n    arrayRemove(nodeList, (item) => getNodeId(item) === needle);\n    return nodeList;\n};\nconst findNode = (needle, haystack) => {\n    return isNode(haystack)\n        ? // haystack is a node, maybe node is a match or one of children is a match\n            getNodeId(haystack) === needle\n                ? haystack\n                : findNode(needle, getNodeChildren(haystack))\n        : // haystack is a list of nodes\n            haystack.find((item) => findNode(needle, item));\n};\nconst findNodeList = (needle, haystack) => {\n    // haystack is node list\n    if (isNodeList(haystack)) {\n        // lets search nodes in this haystack\n        if (haystack.find((item) => getNodeId(item) === needle))\n            return haystack;\n        // not found, lets move the search to the childnodes\n        return haystack.find((item) => findNodeList(needle, getNodeChildren(item)));\n    }\n    // is node, lets find in children\n    return findNodeList(needle, getNodeChildren(haystack));\n};\n\n//#region markup\nconst propertyMap = {\n    borderColor: 'strokeColor',\n    borderWidth: 'strokeWidth',\n    lineWidth: 'strokeWidth',\n    fontColor: 'color',\n    lineColor: 'strokeColor',\n    src: 'backgroundImage',\n    fit: 'backgroundSize',\n};\nconst convertValue = (value) => {\n    if (value === 0)\n        return 0;\n    if (value === '0%')\n        return 0;\n    if (value === '0px')\n        return 0;\n    if (/px$/.test(value))\n        return parseInt(value, 10);\n    if (/\\%$/.test(value))\n        return value;\n    if (value <= 1)\n        return `${value * 100}%`;\n};\nconst addValues = (a, b) => {\n    let _a, _b;\n    if (/%$/.test(a)) {\n        _a = parseFloat(a);\n        _b = parseFloat(b);\n        return `${_a + _b}%`;\n    }\n    if (/px$/.test(a)) {\n        _a = parseInt(a, 10);\n        _b = parseInt(b, 10);\n        return `${_a + _b}px`;\n    }\n};\nconst shapeFromLegacyMarkup = (crop, type, style) => {\n    const shape = Object.keys(style).reduce((res, prop) => {\n        let value = style[prop];\n        // rename prop\n        prop = propertyMap[prop] || prop;\n        // if is px value\n        if (/px$/.test(value)) {\n            value = convertValue(value);\n        }\n        // if is number convert to percentage\n        else if (/^(?:x|y|left|right|top|bottom|width|height|fontSize|strokeWidth)$/.test(prop) &&\n            typeof value === 'number') {\n            if (/strokeWidth/.test(prop))\n                value *= 2;\n            value = convertValue(value);\n        }\n        // if is color value\n        if (/color/i.test(prop)) {\n            value = colorStringToColorArray(value);\n        }\n        if (value === null)\n            value = undefined;\n        res[prop] = value;\n        return res;\n    }, {});\n    if (type === 'line') {\n        if (shape.lineDecoration.length === 1)\n            shape.lineEnd = 'arrow';\n        if (shape.lineDecoration.length === 2)\n            shape.lineStart = 'arrow';\n        shape.x1 = shape.x;\n        shape.y1 = shape.y;\n        shape.x2 = addValues(shape.x, shape.width);\n        shape.y2 = addValues(shape.y, shape.height);\n        delete shape.x;\n        delete shape.y;\n        delete shape.width;\n        delete shape.height;\n        delete shape.lineDecoration;\n        delete shape.lineStyle;\n    }\n    if (type === 'text') {\n        shape.y = addValues(shape.y, '-' + shape.fontSize);\n        delete shape.width;\n        delete shape.height;\n        delete shape.borderStyle;\n    }\n    if (type === 'ellipse') {\n        let w, h;\n        // calculate `rx` and `ry` based on `width` and `h`eight`\n        if (/%$/.test(shape.width)) {\n            w = parseFloat(shape.width) / 100;\n            h = parseFloat(shape.height) / 100;\n            const widthAbsolute = w * crop.width;\n            const heightAbsolute = h * crop.height;\n            w = (widthAbsolute / crop.width) * 100;\n            h = (heightAbsolute / crop.height) * 100;\n        }\n        else {\n            w = shape.width;\n            h = shape.height;\n        }\n        shape.rx = w * 0.5;\n        shape.ry = h * 0.5;\n        if (/%$/.test(shape.width)) {\n            shape.rx += '%';\n            shape.ry += '%';\n        }\n        shape.x = addValues(shape.x, shape.rx);\n        shape.y = addValues(shape.y, shape.ry);\n        delete shape.width;\n        delete shape.height;\n        delete shape.borderStyle;\n    }\n    if (type === 'rect') {\n        delete shape.borderStyle;\n    }\n    if (type === 'path') {\n        shape.points = shape.points.map((point) => {\n            return {\n                x: convertValue(point.x),\n                y: convertValue(point.y),\n            };\n        });\n    }\n    return shape;\n};\n//#endregion\n//#region crop\nconst getOffsetPointOnEdge = (length, rotation) => {\n    const a = length;\n    const A = 1.5707963267948966;\n    const B = rotation;\n    const C = 1.5707963267948966 - rotation;\n    const sinA = Math.sin(A);\n    const sinB = Math.sin(B);\n    const sinC = Math.sin(C);\n    const cosC = Math.cos(C);\n    const ratio = a / sinA;\n    const b = ratio * sinB;\n    const c = ratio * sinC;\n    return vectorCreate(cosC * b, cosC * c);\n};\nconst getRotatedRectSize = (rect, rotation) => {\n    const w = rect.width;\n    const h = rect.height;\n    const hor = getOffsetPointOnEdge(w, rotation);\n    const ver = getOffsetPointOnEdge(h, rotation);\n    const tl = vectorCreate(rect.x + Math.abs(hor.x), rect.y - Math.abs(hor.y));\n    const tr = vectorCreate(rect.x + rect.width + Math.abs(ver.y), rect.y + Math.abs(ver.x));\n    const bl = vectorCreate(rect.x - Math.abs(ver.y), rect.y + rect.height - Math.abs(ver.x));\n    return {\n        width: vectorDistance(tl, tr),\n        height: vectorDistance(tl, bl),\n    };\n};\nconst getBoundsAroundCenter = (imageSize, center) => {\n    const cx = center.x > 0.5 ? 1 - center.x : center.x;\n    const cy = center.y > 0.5 ? 1 - center.y : center.y;\n    return sizeCreate(cx * 2 * imageSize.width, cy * 2 * imageSize.height);\n};\nconst getCanvasSize = (imageSize, canvasAspectRatio, zoom = 1) => {\n    const imageAspectRatio = imageSize.height / imageSize.width;\n    // determine actual pixels on x and y axis\n    let canvasWidth = 1;\n    let canvasHeight = canvasAspectRatio;\n    let imgWidth = 1;\n    let imgHeight = imageAspectRatio;\n    if (imgHeight > canvasHeight) {\n        imgHeight = canvasHeight;\n        imgWidth = imgHeight / imageAspectRatio;\n    }\n    const scalar = Math.max(canvasWidth / imgWidth, canvasHeight / imgHeight);\n    const width = imageSize.width / (zoom * scalar * imgWidth);\n    const height = width * canvasAspectRatio;\n    return {\n        width: width,\n        height: height,\n    };\n};\nconst getCenteredCropRect = (imageSize, aspectRatio) => {\n    let width = imageSize.width;\n    let height = width * aspectRatio;\n    if (height > imageSize.height) {\n        height = imageSize.height;\n        width = height / aspectRatio;\n    }\n    const x = (imageSize.width - width) * 0.5;\n    const y = (imageSize.height - height) * 0.5;\n    return rectCreate(x, y, width, height);\n};\nconst getCorrectedLegacyAspectRatio = (imageSize, aspectRatio) => aspectRatio != null\n    ? // fox the aspect ratio\n        1 / aspectRatio\n    : // set image aspect ratio\n        imageSize.width / imageSize.height;\nconst imagePropertiesFromLegacyCrop = (imageSize, { flip, aspectRatio, rotation, center, zoom, scaleToFit }) => {\n    const res = {};\n    // is centered crop\n    const isCenteredCrop = !center || (center && center.x === 0.5 && center.y === 0.5);\n    // handle basic props\n    if (flip && flip.horizontal)\n        res.flipHorizontal = flip.horizontal;\n    if (flip && flip.vertical)\n        res.flipVertical = flip.vertical;\n    // fix aspect ratio, in FilePond and Doka classic it's height/width instead of width/height\n    const correctedAspectRatio = getCorrectedLegacyAspectRatio(imageSize, aspectRatio);\n    // image bounds\n    const cropLimit = !(scaleToFit === false);\n    const canvasSize = getCanvasSize(imageSize, aspectRatio, zoom);\n    const cropSize = isCenteredCrop\n        ? imageSize\n        : getBoundsAroundCenter(imageSize, cropLimit ? center : { x: 0.5, y: 0.5 });\n    const cropCentered = getCenteredCropRect(imageSize, aspectRatio);\n    // has different aspect ratio than image\n    if (aspectRatio || !isCenteredCrop || zoom) {\n        res.crop = rectContainRect(rectCreateFromSize(cropSize), correctedAspectRatio);\n    }\n    if (typeof rotation === 'number' && rotation !== null) {\n        if (rotation != null)\n            res.rotation = rotation;\n        const rotatedCropSize = getRotatedRectSize(cropCentered, rotation);\n        const scalar = Math.max(rotatedCropSize.width / cropSize.width, rotatedCropSize.height / cropSize.height);\n        // window.clear();\n        // crop position in non-rotated image\n        const cropCenter = vectorCreate(center.x * imageSize.width, center.y * imageSize.height);\n        // const imageCenter = sizeCenter(imageSize);\n        // const imageCenterToCropCenter = vectorCreate(\n        //     imageCenter.x - cropCenter.x,\n        //     imageCenter.y - cropCenter.y\n        // );\n        // get rotated image center\n        const rotatedImageSize = getImageTransformedRect(imageSize, rotation);\n        const rotatedImageCenter = sizeCenter(rotatedImageSize);\n        const rotatedImageOffset = vectorCreate((rotatedImageSize.width - imageSize.width) * 0.5, (rotatedImageSize.height - imageSize.height) * 0.5);\n        // window.draw(rotatedImageCenter, 'red');\n        // window.draw(rotatedImageSize, 'red');\n        // window.draw(\n        //     {\n        //         x: rotatedImageOffset.x,\n        //         y: rotatedImageOffset.y,\n        //         width: imageSize.width,\n        //         height: imageSize.height,\n        //     },\n        //     'cyan'\n        // );\n        // const imagePoints = rectRotate(\n        //     rectCreate(\n        //         rotatedImageOffset.x,\n        //         rotatedImageOffset.y,\n        //         imageSize.width,\n        //         imageSize.height\n        //     ),\n        //     rotation\n        // );\n        // window.draw(imagePoints, 'orange');\n        const cropPoints = rectRotate({\n            x: rotatedImageOffset.x + cropCenter.x - (canvasSize.width / scalar) * 0.5,\n            y: rotatedImageOffset.y + cropCenter.y - (canvasSize.height / scalar) * 0.5,\n            width: canvasSize.width / scalar,\n            height: canvasSize.height / scalar,\n        }, rotation);\n        // window.draw(cropPoints, 'cyan');\n        const cropBoundsPoints = vectorsRotate(cropPoints.map(vectorClone), rotation, rotatedImageCenter.x, rotatedImageCenter.y);\n        // window.draw(cropBoundsPoints, 'orange');\n        const cropBoundsPointsCenter = rectCenter(rectCreateFromPoints(cropBoundsPoints));\n        // window.draw(cropBoundsPointsCenter, 'green');\n        const deRotatedCropBoundsPoints = vectorsRotate(cropBoundsPoints.map(vectorClone), -(rotation * 2), cropBoundsPointsCenter.x, cropBoundsPointsCenter.y);\n        // window.draw(deRotatedCropBoundsPoints, 'green');\n        res.crop = rectCreateFromPoints(deRotatedCropBoundsPoints);\n    }\n    else if (zoom != null) {\n        rectScale(res.crop, 1 / zoom);\n    }\n    if (!cropLimit) {\n        res.cropLimitToImage = false;\n    }\n    return res;\n};\n//#endregion\nconst isLegacyData = (data = {}) => {\n    if ('markup' in data || 'color' in data || 'filter' in data)\n        return true;\n    const { crop } = data;\n    if (crop && ('flip' in crop || 'center' in crop || 'aspectRatio' in crop || 'rotation' in crop))\n        return true;\n    return false;\n};\nvar legacyDataToImageState = (editor, imageSize, data = {}) => {\n    const res = {};\n    // test if isn't legacy data\n    if (!isLegacyData(data))\n        return data;\n    if (data.crop) {\n        Object.assign(res, imagePropertiesFromLegacyCrop(imageSize, data.crop));\n    }\n    if (data.markup) {\n        res.decoration = data.markup\n            .map((markup) => shapeFromLegacyMarkup(res.crop || imageSize, markup[0], markup[1]))\n            .sort((a, b) => {\n            if (a.zIndex < b.zIndex)\n                return -1;\n            if (a.zIndex > b.zIndex)\n                return 1;\n            return 0;\n        })\n            .map((shape) => {\n            delete shape.zIndex;\n            return shape;\n        });\n    }\n    if (data.color) {\n        res.colorMatrix = {\n            brightness: data.color.brightness.matrix,\n            contrast: data.color.contrast.matrix,\n            exposure: data.color.exposure.matrix,\n            saturation: data.color.saturation.matrix,\n        };\n    }\n    if (data.filter) {\n        if (!res.colorMatrix)\n            res.colorMatrix = {};\n        res.colorMatrix.filter =\n            typeof data.filter === 'string' && editor['filterFunctions'][data.filter]\n                ? editor['filterFunctions'][data.filter]()\n                : data.filter.matrix;\n    }\n    return res;\n};\n\nconst isOperaMini = () => Object.prototype.toString.call(window['operamini']) === '[object OperaMini]';\nconst hasPromises = () => 'Promise' in window;\nconst hasCreateObjectURL = () => 'URL' in window && 'createObjectURL' in window.URL;\nconst hasVisibility = () => 'visibilityState' in document;\nconst hasTiming = () => 'performance' in window; // iOS 8.x\nconst hasFileConstructor = () => 'File' in window; // excludes IE11\nlet result$a = null;\nvar isModernBrowser = () => {\n    if (result$a === null)\n        result$a =\n            isBrowser() &&\n                // Can't run on Opera Mini due to lack of everything\n                !isOperaMini() &&\n                // Require these APIs to feature detect a modern browser\n                hasVisibility() &&\n                hasPromises() &&\n                hasFileConstructor() &&\n                hasCreateObjectURL() &&\n                hasTiming();\n    return result$a;\n};\n\nconst toPercentageNumber = (v) => Math.round(v * 100);\nconst brightness = {\n    base: 0,\n    min: -0.25,\n    max: 0.25,\n    getLabel: (value) => {\n        return toPercentageNumber(value / 0.25);\n    },\n    getStore: ({ imageColorMatrix }) => imageColorMatrix,\n    getValue: (store) => {\n        if (!store.brightness)\n            return;\n        return store.brightness[4];\n    },\n    setValue: (store, v) => store.update((matrices) => ({\n        // clone existing matrices\n        ...matrices,\n        // prettier-ignore\n        brightness: [\n            1, 0, 0, 0, v,\n            0, 1, 0, 0, v,\n            0, 0, 1, 0, v,\n            0, 0, 0, 1, 0\n        ],\n    })),\n};\nconst contrast = {\n    base: 1,\n    min: 0.5,\n    max: 1.5,\n    getLabel: (value) => {\n        return toPercentageNumber(-1 + (value - 0.5) * 2);\n    },\n    getStore: ({ imageColorMatrix }) => imageColorMatrix,\n    getValue: (store) => {\n        if (!store.contrast)\n            return;\n        return store.contrast[0];\n    },\n    setValue: (store, v) => store.update((matrices) => ({\n        // clone existing matrices\n        ...matrices,\n        // prettier-ignore\n        contrast: [\n            v, 0, 0, 0, .5 * (1 - v),\n            0, v, 0, 0, .5 * (1 - v),\n            0, 0, v, 0, .5 * (1 - v),\n            0, 0, 0, 1, 0\n        ],\n    })),\n};\nconst saturation = {\n    base: 1,\n    min: 0,\n    max: 2,\n    getLabel: (value) => {\n        return toPercentageNumber(value - 1);\n    },\n    getStore: ({ imageColorMatrix }) => imageColorMatrix,\n    getValue: (store) => {\n        if (!store.saturation)\n            return;\n        return (store.saturation[0] - 0.213) / 0.787;\n    },\n    setValue: (store, v) => store.update((matrices) => ({\n        ...matrices,\n        // prettier-ignore\n        saturation: [\n            .213 + .787 * v, .715 - .715 * v, .072 - .072 * v, 0, 0,\n            .213 - .213 * v, .715 + .285 * v, .072 - .072 * v, 0, 0,\n            .213 - .213 * v, .715 - .715 * v, .072 + .928 * v, 0, 0,\n            0, 0, 0, 1, 0\n        ],\n    })),\n};\nconst exposure = {\n    base: 1,\n    min: 0.5,\n    max: 1.5,\n    getLabel: (value) => {\n        return toPercentageNumber(-1 + (value - 0.5) * 2);\n    },\n    getStore: ({ imageColorMatrix }) => imageColorMatrix,\n    getValue: (store) => {\n        if (!store.exposure)\n            return;\n        return store.exposure[0];\n    },\n    setValue: (store, v) => store.update((matrices) => ({\n        ...matrices,\n        // prettier-ignore\n        exposure: [\n            v, 0, 0, 0, 0,\n            0, v, 0, 0, 0,\n            0, 0, v, 0, 0,\n            0, 0, 0, 1, 0\n        ],\n    })),\n};\nconst gamma = {\n    base: 1,\n    min: 0.15,\n    max: 4,\n    getLabel: (value) => {\n        if (value < 1) {\n            return toPercentageNumber((value - 0.15) / 0.85 - 1);\n        }\n        return toPercentageNumber((value - 1) / 3);\n    },\n    getStore: ({ imageGamma }) => imageGamma,\n};\nconst vignette = {\n    base: 0,\n    min: -1,\n    max: 1,\n    getStore: ({ imageVignette }) => imageVignette,\n};\nconst clarity = {\n    base: 0,\n    min: -1,\n    max: 1,\n    getStore: ({ imageConvolutionMatrix }) => imageConvolutionMatrix,\n    getValue: (store) => {\n        if (!store.clarity)\n            return;\n        if (store.clarity[0] === 0) {\n            return store.clarity[1] / -1;\n        }\n        else {\n            return store.clarity[1] / -2;\n        }\n    },\n    setValue: (store, v) => {\n        store.update((matrices) => ({\n            ...matrices,\n            // prettier-ignore\n            clarity: v >= 0\n                ? [0, -1 * v, 0,\n                    -1 * v, 1 + 4 * v, -1 * v,\n                    0, -1 * v, 0\n                ]\n                : [-1 * v, -2 * v, -1 * v,\n                    -2 * v, 1 + -3 * v, -2 * v,\n                    -1 * v, -2 * v, -1 * v\n                ],\n        }));\n    },\n};\nconst temperature = {\n    base: 0,\n    min: -1,\n    max: 1,\n    getStore: ({ imageColorMatrix }) => imageColorMatrix,\n    getValue: (store) => {\n        if (!store.temperature)\n            return;\n        const v = store.temperature[0];\n        if (v >= 1) {\n            return (v - 1) / 0.1;\n        }\n        return (1 - v) / -0.15;\n    },\n    setValue: (store, v) => store.update((matrices) => ({\n        ...matrices,\n        // prettier-ignore\n        temperature: v > 0 ? [\n            1 + (v * .1), 0, 0, 0, 0,\n            0, 1, 0, 0, 0,\n            0, 0, 1 + (-v * .1), 0, 0,\n            0, 0, 0, 1, 0\n        ] : [\n            1 + (v * .15), 0, 0, 0, 0,\n            0, 1 + (v * .05), 0, 0, 0,\n            0, 0, 1 + (-v * .15), 0, 0,\n            0, 0, 0, 1, 0\n        ],\n    })),\n};\nconst finetuneControlConfigurationDefault = {\n    gamma,\n    brightness,\n    contrast,\n    saturation,\n    exposure,\n    temperature,\n    clarity,\n    vignette,\n};\nconst finetuneOptionsDefault = [\n    ['brightness', (locale) => locale.finetuneLabelBrightness],\n    ['contrast', (locale) => locale.finetuneLabelContrast],\n    ['saturation', (locale) => locale.finetuneLabelSaturation],\n    ['exposure', (locale) => locale.finetuneLabelExposure],\n    ['temperature', (locale) => locale.finetuneLabelTemperature],\n    ['gamma', (locale) => locale.finetuneLabelGamma],\n    ['clarity', (locale) => locale.finetuneLabelClarity],\n    ['vignette', (locale) => locale.finetuneLabelVignette],\n];\nvar defaults = {\n    finetuneControlConfiguration: finetuneControlConfigurationDefault,\n    finetuneOptions: finetuneOptionsDefault,\n};\n/*\nTODO: fix inverse fn in getValue\nexport const hue = {\n    base: 0,\n    min: 0,\n    max: Math.PI,\n    getStore: ({ imageColorMatrix }) => imageColorMatrix,\n    getValue: (store) => {\n        if (!store.hue) return;\n\n        const v = store.hue[1];\n\n        const o = -(Math.acos((0.715 - v) / Math.sqrt(2) / 0.715) - Math.PI / 4);\n\n        return o;\n    },\n    setValue: (store, v: number) => {\n        store.update((matrices) => {\n            // const value = v * (Math.PI);\n\n            const cos = Math.cos(v);\n            const sin = Math.sin(v);\n\n            const a00 = 0.213 + cos * 0.787 - sin * 0.213;\n            const a01 = 0.715 - cos * 0.715 - sin * 0.715;\n            const a02 = 0.072 - cos * 0.072 + sin * 0.928;\n            const a10 = 0.213 - cos * 0.213 + sin * 0.143;\n            const a11 = 0.715 + cos * 0.285 + sin * 0.14;\n            const a12 = 0.072 - cos * 0.072 - sin * 0.283;\n            const a20 = 0.213 - cos * 0.213 - sin * 0.787;\n            const a21 = 0.715 - cos * 0.715 + sin * 0.715;\n            const a22 = 0.072 + cos * 0.928 + sin * 0.072;\n\n            return {\n                ...matrices,\n\n                // prettier-ignore\n                hue: [\n                    a00, a01, a02, 0, 0,\n                    a10, a11, a12, 0, 0,\n                    a20, a21, a22, 0, 0,\n                      0,   0,   0, 1, 0,\n                ]\n            };\n        });\n    },\n};\n*/\n\nconst pastel = () => \n// prettier-ignore\n[\n    0.75, 0.25, 0.25, 0, 0,\n    0.25, 0.75, 0.25, 0, 0,\n    0.25, 0.25, 0.75, 0, 0,\n    0, 0, 0, 1, 0\n];\nconst chrome = () => \n// prettier-ignore\n[\n    1.398, -0.316, 0.065, -0.273, 0.201,\n    -0.051, 1.278, -0.080, -0.273, 0.201,\n    -0.051, 0.119, 1.151, -0.290, 0.215,\n    0, 0, 0, 1, 0\n];\nconst fade$1 = () => \n// prettier-ignore\n[\n    1.073, -0.015, 0.092, -0.115, -0.017,\n    0.107, 0.859, 0.184, -0.115, -0.017,\n    0.015, 0.077, 1.104, -0.115, -0.017,\n    0, 0, 0, 1, 0\n];\nconst warm = () => \n// prettier-ignore\n[\n    1.06, 0, 0, 0, 0,\n    0, 1.01, 0, 0, 0,\n    0, 0, 0.93, 0, 0,\n    0, 0, 0, 1, 0,\n];\nconst cold = () => \n// prettier-ignore\n[\n    1.1, 0, 0, 0, -.1,\n    0, 1.1, 0, 0, -.1,\n    0, 0, 1.2, 0, -.1,\n    0, 0, 0, 1, 0,\n];\nconst invert = () => \n// prettier-ignore\n[\n    -1, 0, 0, 1, 0,\n    0, -1, 0, 1, 0,\n    0, 0, -1, 1, 0,\n    0, 0, 0, 1, 0,\n];\nconst monoDefault = () => \n// prettier-ignore\n[\n    0.212, 0.715, 0.114, 0, 0,\n    0.212, 0.715, 0.114, 0, 0,\n    0.212, 0.715, 0.114, 0, 0,\n    0, 0, 0, 1, 0\n];\nconst monoNoir = () => \n// prettier-ignore\n[\n    0.15, 1.3, -0.25, 0.1, -0.2,\n    0.15, 1.3, -0.25, 0.1, -0.2,\n    0.15, 1.3, -0.25, 0.1, -0.2,\n    0, 0, 0, 1, 0\n];\nconst monoWash = () => \n// prettier-ignore\n[\n    0.163, 0.518, 0.084, -0.010, 0.208,\n    0.163, 0.529, 0.082, -0.020, 0.210,\n    0.171, 0.529, 0.084, 0.000, 0.214,\n    0.000, 0.000, 0.000, 1.000, 0.000,\n];\nconst monoStark = () => \n// prettier-ignore\n[\n    0.338, 0.991, 0.117, 0.093, -0.196,\n    0.302, 1.049, 0.096, 0.078, -0.196,\n    0.286, 1.016, 0.146, 0.101, -0.196,\n    0.000, 0.000, 0.000, 1.000, 0.000,\n];\nconst sepiaDefault = () => \n// prettier-ignore\n[\n    0.393, 0.768, 0.188, 0, 0,\n    0.349, 0.685, 0.167, 0, 0,\n    0.272, 0.533, 0.130, 0, 0,\n    0, 0, 0, 1, 0,\n];\nconst sepiaBlues = () => \n// prettier-ignore\n[\n    0.289, 0.620, 0.185, 0.000, 0.077,\n    0.257, 0.566, 0.163, 0.000, 0.115,\n    0.200, 0.430, 0.128, 0.000, 0.188,\n    0.000, 0.000, 0.000, 1.000, 0.000,\n];\nconst sepiaRust = () => \n// prettier-ignore\n[\n    0.269, 0.764, 0.172, 0.050, 0.100,\n    0.239, 0.527, 0.152, 0.000, 0.176,\n    0.186, 0.400, 0.119, 0.000, 0.159,\n    0.000, 0.000, 0.000, 1.000, 0.000,\n];\nconst sepiaColor = () => \n// prettier-ignore\n[\n    0.547, 0.764, 0.134, 0.000, -0.147,\n    0.281, 0.925, 0.120, 0.000, -0.135,\n    0.225, 0.558, 0.330, 0.000, -0.113,\n    0.000, 0.000, 0.000, 1.000, 0.000,\n];\n//\n// default filter set\n//\nconst filterFunctionsDefault = {\n    chrome,\n    fade: fade$1,\n    pastel,\n    cold,\n    warm,\n    monoDefault,\n    monoWash,\n    monoNoir,\n    monoStark,\n    sepiaDefault,\n    sepiaRust,\n    sepiaBlues,\n    sepiaColor,\n};\nconst filterOptionsDefault = [\n    ['Default', [[undefined, (locale) => locale.labelDefault]]],\n    [\n        'Classic',\n        [\n            ['chrome', (locale) => locale.filterLabelChrome],\n            ['fade', (locale) => locale.filterLabelFade],\n            ['cold', (locale) => locale.filterLabelCold],\n            ['warm', (locale) => locale.filterLabelWarm],\n            ['pastel', (locale) => locale.filterLabelPastel],\n        ],\n    ],\n    [\n        'Monochrome',\n        [\n            ['monoDefault', (locale) => locale.filterLabelMonoDefault],\n            ['monoNoir', (locale) => locale.filterLabelMonoNoir],\n            ['monoStark', (locale) => locale.filterLabelMonoStark],\n            ['monoWash', (locale) => locale.filterLabelMonoWash],\n        ],\n    ],\n    [\n        'Sepia',\n        [\n            ['sepiaDefault', (locale) => locale.filterLabelSepiaDefault],\n            ['sepiaRust', (locale) => locale.filterLabelSepiaRust],\n            ['sepiaBlues', (locale) => locale.filterLabelSepiaBlues],\n            ['sepiaColor', (locale) => locale.filterLabelSepiaColor],\n        ],\n    ],\n];\nvar defaults$1 = {\n    filterFunctions: filterFunctionsDefault,\n    filterOptions: filterOptionsDefault,\n};\n\n// if this is a non retina display snap to pixel\nlet fn = null;\nvar snapToPixel = (v) => {\n    if (fn === null)\n        fn = getDevicePixelRatio() === 1 ? (v) => Math.round(v) : (v) => v;\n    return fn(v);\n};\n\n/* src/core/ui/components/Details.svelte generated by Svelte v3.29.4 */\nconst get_details_slot_changes = dirty => ({});\nconst get_details_slot_context = ctx => ({});\nconst get_label_slot_changes = dirty => ({});\nconst get_label_slot_context = ctx => ({});\n\n// (167:0) <Button bind:this={buttonComponent}      class={arrayJoin(['DokaDetailsButton', buttonClass])}      onkeydown={handleButtonKeydown}      onclick={handleClick}>\nfunction create_default_slot$2(ctx) {\n\tlet current;\n\tconst label_slot_template = /*#slots*/ ctx[19].label;\n\tconst label_slot = create_slot(label_slot_template, ctx, /*$$scope*/ ctx[23], get_label_slot_context);\n\n\treturn {\n\t\tc() {\n\t\t\tif (label_slot) label_slot.c();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (label_slot) {\n\t\t\t\tlabel_slot.m(target, anchor);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (label_slot) {\n\t\t\t\tif (label_slot.p && dirty[0] & /*$$scope*/ 8388608) {\n\t\t\t\t\tupdate_slot(label_slot, label_slot_template, ctx, /*$$scope*/ ctx[23], dirty, get_label_slot_changes, get_label_slot_context);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(label_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(label_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (label_slot) label_slot.d(detaching);\n\t\t}\n\t};\n}\n\n// (174:0) {#if isVisible}\nfunction create_if_block_1$2(ctx) {\n\tlet div;\n\tlet div_class_value;\n\tlet measure_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tconst details_slot_template = /*#slots*/ ctx[19].details;\n\tconst details_slot = create_slot(details_slot_template, ctx, /*$$scope*/ ctx[23], get_details_slot_context);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (details_slot) details_slot.c();\n\t\t\tattr(div, \"class\", div_class_value = arrayJoin([\"DokaDetailsPanel\", /*panelClass*/ ctx[1]]));\n\t\t\tattr(div, \"tabindex\", \"-1\");\n\t\t\tattr(div, \"style\", /*style*/ ctx[6]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (details_slot) {\n\t\t\t\tdetails_slot.m(div, null);\n\t\t\t}\n\n\t\t\t/*div_binding*/ ctx[21](div);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div, \"keydown\", /*handlePanelKeydown*/ ctx[16]),\n\t\t\t\t\tlisten(div, \"measure\", /*measure_handler*/ ctx[22]),\n\t\t\t\t\taction_destroyer(measure_action = measurable.call(null, div))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (details_slot) {\n\t\t\t\tif (details_slot.p && dirty[0] & /*$$scope*/ 8388608) {\n\t\t\t\t\tupdate_slot(details_slot, details_slot_template, ctx, /*$$scope*/ ctx[23], dirty, get_details_slot_changes, get_details_slot_context);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*panelClass*/ 2 && div_class_value !== (div_class_value = arrayJoin([\"DokaDetailsPanel\", /*panelClass*/ ctx[1]]))) {\n\t\t\t\tattr(div, \"class\", div_class_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*style*/ 64) {\n\t\t\t\tattr(div, \"style\", /*style*/ ctx[6]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(details_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(details_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (details_slot) details_slot.d(detaching);\n\t\t\t/*div_binding*/ ctx[21](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction create_fragment$d(ctx) {\n\tlet t0;\n\tlet button;\n\tlet t1;\n\tlet t2;\n\tlet if_block1_anchor;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\tlet button_props = {\n\t\tclass: arrayJoin([\"DokaDetailsButton\", /*buttonClass*/ ctx[0]]),\n\t\tonkeydown: /*handleButtonKeydown*/ ctx[15],\n\t\tonclick: /*handleClick*/ ctx[14],\n\t\t$$slots: { default: [create_default_slot$2] },\n\t\t$$scope: { ctx }\n\t};\n\n\tbutton = new Button({ props: button_props });\n\t/*button_binding*/ ctx[20](button);\n\tlet if_block0 = /*isVisible*/ ctx[5] && create_if_block_1$2(ctx);\n\tlet if_block1 = false ;\n\n\treturn {\n\t\tc() {\n\t\t\tt0 = space();\n\t\t\tcreate_component(button.$$.fragment);\n\t\t\tt1 = space();\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt2 = space();\n\t\t\tif_block1_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, t0, anchor);\n\t\t\tmount_component(button, target, anchor);\n\t\t\tinsert(target, t1, anchor);\n\t\t\tif (if_block0) if_block0.m(target, anchor);\n\t\t\tinsert(target, t2, anchor);\n\t\t\tinsert(target, if_block1_anchor, anchor);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(document.body, \"pointerdown\", function () {\n\t\t\t\t\t\tif (is_function(/*handleDown*/ ctx[7])) /*handleDown*/ ctx[7].apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(document.body, \"pointerup\", function () {\n\t\t\t\t\t\tif (is_function(/*handleUp*/ ctx[8])) /*handleUp*/ ctx[8].apply(this, arguments);\n\t\t\t\t\t})\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\t\t\tconst button_changes = {};\n\t\t\tif (dirty[0] & /*buttonClass*/ 1) button_changes.class = arrayJoin([\"DokaDetailsButton\", /*buttonClass*/ ctx[0]]);\n\n\t\t\tif (dirty[0] & /*$$scope*/ 8388608) {\n\t\t\t\tbutton_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tbutton.$set(button_changes);\n\n\t\t\tif (/*isVisible*/ ctx[5]) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*isVisible*/ 32) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_1$2(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(t2.parentNode, t2);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(button.$$.fragment, local);\n\t\t\ttransition_in(if_block0);\n\t\t\ttransition_in(if_block1);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(button.$$.fragment, local);\n\t\t\ttransition_out(if_block0);\n\t\t\ttransition_out(if_block1);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(t0);\n\t\t\t/*button_binding*/ ctx[20](null);\n\t\t\tdestroy_component(button, detaching);\n\t\t\tif (detaching) detach(t1);\n\t\t\tif (if_block0) if_block0.d(detaching);\n\t\t\tif (detaching) detach(t2);\n\t\t\tif (detaching) detach(if_block1_anchor);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nlet panelMargin = 12;\n\nfunction instance$d($$self, $$props, $$invalidate) {\n\tlet $portalRootRect;\n\tlet $position;\n\tlet $opacity;\n\tlet $offset;\n\tlet $portal;\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tlet { buttonClass = undefined } = $$props;\n\tlet { panelClass = undefined } = $$props;\n\tlet { isActive = false } = $$props;\n\tlet { onshow = ({ panel }) => panel.focus() } = $$props;\n\tconst portal = getContext(\"rootPortal\");\n\tcomponent_subscribe($$self, portal, value => $$invalidate(35, $portal = value));\n\tconst portalRootRect = getContext(\"rootRect\");\n\tcomponent_subscribe($$self, portalRootRect, value => $$invalidate(29, $portalRootRect = value));\n\tlet panelSize;\n\tlet buttonComponent;\n\tlet buttonRect;\n\tlet dir = vectorCreateEmpty();\n\tlet opacity = spring(0);\n\tcomponent_subscribe($$self, opacity, value => $$invalidate(31, $opacity = value));\n\tconst position = writable({ x: 0, y: 0 });\n\tcomponent_subscribe($$self, position, value => $$invalidate(30, $position = value));\n\tconst offset = spring(-5);\n\tcomponent_subscribe($$self, offset, value => $$invalidate(34, $offset = value));\n\tconst isTargetSelf = e => isEventTarget(e, $portal) || buttonComponent.isEventTarget(e);\n\tlet downOutsidePanel = false;\n\n\t// move detail panel to portal\n\tlet detailPanel;\n\n\tlet trigger;\n\n\t// test keydown press to open\n\tconst handleClick = e => {\n\t\tif (!isActive) $$invalidate(24, buttonRect = buttonElement.getBoundingClientRect());\n\t\t$$invalidate(27, trigger = e);\n\t\t$$invalidate(17, isActive = !isActive);\n\t};\n\n\tconst handleButtonKeydown = e => {\n\t\tif (!(/down/i).test(e.key)) return;\n\t\t$$invalidate(17, isActive = true);\n\t\t$$invalidate(27, trigger = e);\n\t};\n\n\tconst handlePanelKeydown = e => {\n\t\tif (!(/esc/i).test(e.key)) return;\n\t\t$$invalidate(17, isActive = false);\n\t\tbuttonElement.focus();\n\t};\n\n\t// clean up panel if it was appended to a portal\n\tonDestroy(() => {\n\t\tif (!$portal || !detailPanel) return;\n\t\t$portal.removeChild(detailPanel);\n\t});\n\n\tfunction button_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tbuttonComponent = $$value;\n\t\t\t$$invalidate(3, buttonComponent);\n\t\t});\n\t}\n\n\tfunction div_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tdetailPanel = $$value;\n\t\t\t$$invalidate(4, detailPanel);\n\t\t});\n\t}\n\n\tconst measure_handler = e => $$invalidate(2, panelSize = sizeCreateFromAny(e.detail));\n\n\t$$self.$$set = $$props => {\n\t\tif (\"buttonClass\" in $$props) $$invalidate(0, buttonClass = $$props.buttonClass);\n\t\tif (\"panelClass\" in $$props) $$invalidate(1, panelClass = $$props.panelClass);\n\t\tif (\"isActive\" in $$props) $$invalidate(17, isActive = $$props.isActive);\n\t\tif (\"onshow\" in $$props) $$invalidate(18, onshow = $$props.onshow);\n\t\tif (\"$$scope\" in $$props) $$invalidate(23, $$scope = $$props.$$scope);\n\t};\n\n\tlet buttonElement;\n\tlet isVisible;\n\tlet isAnimating;\n\tlet transform;\n\tlet style;\n\tlet handleDown;\n\tlet handleUp;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*buttonComponent*/ 8) {\n\t\t\t buttonElement = buttonComponent && buttonComponent.getElement();\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*isActive, downOutsidePanel*/ 67239936) {\n\t\t\t $$invalidate(8, handleUp = isActive\n\t\t\t? e => {\n\t\t\t\t\tif (!downOutsidePanel) return;\n\t\t\t\t\t$$invalidate(26, downOutsidePanel = false);\n\t\t\t\t\tif (isTargetSelf(e)) return;\n\t\t\t\t\t$$invalidate(17, isActive = false);\n\t\t\t\t}\n\t\t\t: undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*isActive*/ 131072) {\n\t\t\t opacity.set(isActive ? 1 : 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*isActive*/ 131072) {\n\t\t\t offset.set(isActive ? 0 : -5);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$portalRootRect, panelSize, buttonRect*/ 553648132) {\n\t\t\t if ($portalRootRect && panelSize && buttonRect) {\n\t\t\t\t// as a starting point we'll align panel to center of button and position below\n\t\t\t\tlet x = buttonRect.x - $portalRootRect.x + buttonRect.width * 0.5 - panelSize.width * 0.5;\n\n\t\t\t\tlet y = buttonRect.y - $portalRootRect.y + buttonRect.height;\n\t\t\t\tconst parentLeft = panelMargin;\n\t\t\t\tconst parentTop = panelMargin;\n\t\t\t\tconst parentRight = $portalRootRect.width - panelMargin;\n\t\t\t\tconst parentBottom = $portalRootRect.height - panelMargin;\n\t\t\t\tconst panelLeft = x;\n\t\t\t\tconst panelTop = y;\n\t\t\t\tconst panelRight = panelLeft + panelSize.width;\n\t\t\t\tconst panelBottom = panelTop + panelSize.height;\n\n\t\t\t\t// move to right\n\t\t\t\tif (panelLeft < parentLeft) {\n\t\t\t\t\tx = parentLeft;\n\t\t\t\t}\n\n\t\t\t\t// move to left\n\t\t\t\tif (panelRight > parentRight) {\n\t\t\t\t\tx = parentRight - panelSize.width;\n\t\t\t\t}\n\n\t\t\t\tif (panelBottom > parentBottom) {\n\t\t\t\t\t// doesn't fit vertically, push up\n\t\t\t\t\t$$invalidate(25, dir.y = -1, dir);\n\n\t\t\t\t\tconst positionedAboveButtonY = y - panelSize.height - buttonRect.height;\n\t\t\t\t\tconst panelFitsAboveButton = parentTop < positionedAboveButtonY;\n\n\t\t\t\t\tif (panelFitsAboveButton) {\n\t\t\t\t\t\ty -= panelSize.height + buttonRect.height;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// overlap with button\n\t\t\t\t\t\ty -= panelBottom - parentBottom;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// all is fine\n\t\t\t\t\t$$invalidate(25, dir.y = 1, dir);\n\t\t\t\t}\n\n\t\t\t\tset_store_value(position, $position = vectorApply(vectorCreate(x, y), snapToPixel), $position);\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$opacity*/ 1) {\n\t\t\t $$invalidate(5, isVisible = $opacity > 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$opacity*/ 1) {\n\t\t\t $$invalidate(32, isAnimating = $opacity < 1);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$position, dir*/ 1107296256 | $$self.$$.dirty[1] & /*$offset*/ 8) {\n\t\t\t $$invalidate(33, transform = `translateX(${$position.x + dir.x * panelMargin}px) translateY(${$position.y + dir.y * panelMargin + dir.y * $offset}px)`);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*isAnimating, $opacity, transform*/ 7) {\n\t\t\t $$invalidate(6, style = isAnimating\n\t\t\t? `opacity: ${$opacity}; pointer-events: ${$opacity < 1 ? \"none\" : \"all\"}; transform: ${transform};`\n\t\t\t: `transform: ${transform}`);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*isActive*/ 131072) {\n\t\t\t $$invalidate(7, handleDown = isActive\n\t\t\t? e => {\n\t\t\t\t\tif (isTargetSelf(e)) return;\n\t\t\t\t\t$$invalidate(26, downOutsidePanel = true);\n\t\t\t\t}\n\t\t\t: undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*isVisible, detailPanel*/ 48 | $$self.$$.dirty[1] & /*$portal*/ 16) {\n\t\t\t if (isVisible && $portal && detailPanel && detailPanel.parentNode !== $portal) $portal.appendChild(detailPanel);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*isActive*/ 131072) {\n\t\t\t if (!isActive) $$invalidate(27, trigger = undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*isVisible, detailPanel, onshow, trigger*/ 134479920) {\n\t\t\t if (isVisible && detailPanel) onshow({ e: trigger, panel: detailPanel });\n\t\t}\n\t};\n\n\treturn [\n\t\tbuttonClass,\n\t\tpanelClass,\n\t\tpanelSize,\n\t\tbuttonComponent,\n\t\tdetailPanel,\n\t\tisVisible,\n\t\tstyle,\n\t\thandleDown,\n\t\thandleUp,\n\t\tportal,\n\t\tportalRootRect,\n\t\topacity,\n\t\tposition,\n\t\toffset,\n\t\thandleClick,\n\t\thandleButtonKeydown,\n\t\thandlePanelKeydown,\n\t\tisActive,\n\t\tonshow,\n\t\tslots,\n\t\tbutton_binding,\n\t\tdiv_binding,\n\t\tmeasure_handler,\n\t\t$$scope\n\t];\n}\n\nclass Details extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$d,\n\t\t\tcreate_fragment$d,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tbuttonClass: 0,\n\t\t\t\tpanelClass: 1,\n\t\t\t\tisActive: 17,\n\t\t\t\tonshow: 18\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n}\n\n/* src/core/ui/components/RadioItem.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$e(ctx) {\n\tlet li;\n\tlet input;\n\tlet t;\n\tlet label_1;\n\tlet li_class_value;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tconst default_slot_template = /*#slots*/ ctx[14].default;\n\tconst default_slot = create_slot(default_slot_template, ctx, /*$$scope*/ ctx[13], null);\n\n\treturn {\n\t\tc() {\n\t\t\tli = element(\"li\");\n\t\t\tinput = element(\"input\");\n\t\t\tt = space();\n\t\t\tlabel_1 = element(\"label\");\n\t\t\tif (default_slot) default_slot.c();\n\t\t\tattr(input, \"type\", \"radio\");\n\t\t\tattr(input, \"class\", \"implicit\");\n\t\t\tattr(input, \"id\", /*inputId*/ ctx[6]);\n\t\t\tattr(input, \"name\", /*name*/ ctx[0]);\n\t\t\tinput.value = /*value*/ ctx[3];\n\t\t\tinput.disabled = /*disabled*/ ctx[5];\n\t\t\tinput.checked = /*checked*/ ctx[4];\n\t\t\tattr(label_1, \"for\", /*inputId*/ ctx[6]);\n\t\t\tattr(label_1, \"title\", /*label*/ ctx[2]);\n\t\t\tattr(li, \"class\", li_class_value = arrayJoin([\"DokaRadioGroupOption\", /*klass*/ ctx[1]]));\n\t\t\tattr(li, \"data-disabled\", /*disabled*/ ctx[5]);\n\t\t\tattr(li, \"data-selected\", /*checked*/ ctx[4]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, li, anchor);\n\t\t\tappend(li, input);\n\t\t\tappend(li, t);\n\t\t\tappend(li, label_1);\n\n\t\t\tif (default_slot) {\n\t\t\t\tdefault_slot.m(label_1, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(input, \"change\", stop_propagation(/*change_handler*/ ctx[15])),\n\t\t\t\t\tlisten(input, \"keydown\", /*handleKeydown*/ ctx[8]),\n\t\t\t\t\tlisten(input, \"click\", /*handleClick*/ ctx[9])\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (!current || dirty & /*inputId*/ 64) {\n\t\t\t\tattr(input, \"id\", /*inputId*/ ctx[6]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*name*/ 1) {\n\t\t\t\tattr(input, \"name\", /*name*/ ctx[0]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*value*/ 8) {\n\t\t\t\tinput.value = /*value*/ ctx[3];\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*disabled*/ 32) {\n\t\t\t\tinput.disabled = /*disabled*/ ctx[5];\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*checked*/ 16) {\n\t\t\t\tinput.checked = /*checked*/ ctx[4];\n\t\t\t}\n\n\t\t\tif (default_slot) {\n\t\t\t\tif (default_slot.p && dirty & /*$$scope*/ 8192) {\n\t\t\t\t\tupdate_slot(default_slot, default_slot_template, ctx, /*$$scope*/ ctx[13], dirty, null, null);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*inputId*/ 64) {\n\t\t\t\tattr(label_1, \"for\", /*inputId*/ ctx[6]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*label*/ 4) {\n\t\t\t\tattr(label_1, \"title\", /*label*/ ctx[2]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*klass*/ 2 && li_class_value !== (li_class_value = arrayJoin([\"DokaRadioGroupOption\", /*klass*/ ctx[1]]))) {\n\t\t\t\tattr(li, \"class\", li_class_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*disabled*/ 32) {\n\t\t\t\tattr(li, \"data-disabled\", /*disabled*/ ctx[5]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*checked*/ 16) {\n\t\t\t\tattr(li, \"data-selected\", /*checked*/ ctx[4]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(default_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(default_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(li);\n\t\t\tif (default_slot) default_slot.d(detaching);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance$e($$self, $$props, $$invalidate) {\n\tlet $keysPressedStored;\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tlet { name } = $$props;\n\tlet { class: klass = undefined } = $$props;\n\tlet { label } = $$props;\n\tlet { id } = $$props;\n\tlet { value } = $$props;\n\tlet { checked } = $$props;\n\tlet { onkeydown } = $$props;\n\tlet { onclick } = $$props;\n\tlet { disabled = false } = $$props;\n\tconst keysPressedStored = getContext(\"keysPressed\");\n\tcomponent_subscribe($$self, keysPressedStored, value => $$invalidate(16, $keysPressedStored = value));\n\n\tconst handleKeydown = e => {\n\t\tonkeydown(e);\n\t};\n\n\tconst handleClick = e => {\n\t\tif ($keysPressedStored.length) return;\n\t\tonclick(e);\n\t};\n\n\tfunction change_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"name\" in $$props) $$invalidate(0, name = $$props.name);\n\t\tif (\"class\" in $$props) $$invalidate(1, klass = $$props.class);\n\t\tif (\"label\" in $$props) $$invalidate(2, label = $$props.label);\n\t\tif (\"id\" in $$props) $$invalidate(10, id = $$props.id);\n\t\tif (\"value\" in $$props) $$invalidate(3, value = $$props.value);\n\t\tif (\"checked\" in $$props) $$invalidate(4, checked = $$props.checked);\n\t\tif (\"onkeydown\" in $$props) $$invalidate(11, onkeydown = $$props.onkeydown);\n\t\tif (\"onclick\" in $$props) $$invalidate(12, onclick = $$props.onclick);\n\t\tif (\"disabled\" in $$props) $$invalidate(5, disabled = $$props.disabled);\n\t\tif (\"$$scope\" in $$props) $$invalidate(13, $$scope = $$props.$$scope);\n\t};\n\n\tlet inputId;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*name, id*/ 1025) {\n\t\t\t $$invalidate(6, inputId = `${name}-${id}`);\n\t\t}\n\t};\n\n\treturn [\n\t\tname,\n\t\tklass,\n\t\tlabel,\n\t\tvalue,\n\t\tchecked,\n\t\tdisabled,\n\t\tinputId,\n\t\tkeysPressedStored,\n\t\thandleKeydown,\n\t\thandleClick,\n\t\tid,\n\t\tonkeydown,\n\t\tonclick,\n\t\t$$scope,\n\t\tslots,\n\t\tchange_handler\n\t];\n}\n\nclass RadioItem extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$e, create_fragment$e, safe_not_equal, {\n\t\t\tname: 0,\n\t\t\tclass: 1,\n\t\t\tlabel: 2,\n\t\t\tid: 10,\n\t\t\tvalue: 3,\n\t\t\tchecked: 4,\n\t\t\tonkeydown: 11,\n\t\t\tonclick: 12,\n\t\t\tdisabled: 5\n\t\t});\n\t}\n}\n\nvar flattenOptions = (options = []) => options.reduce((prev, current) => {\n    const isGroup = isArray(current) ? isArray(current[1]) : !!current.options;\n    if (isGroup) {\n        return prev.concat(isArray(current) ? current[1] : current.options);\n    }\n    prev.push(current);\n    return prev;\n}, []);\n\nconst mapOption = (option, index, optionMapper) => {\n    let mappedOption;\n    if (isArray(option)) {\n        mappedOption = {\n            id: index,\n            value: option[0],\n            label: option[1],\n            ...(option[2] || {}),\n        };\n    }\n    else {\n        mappedOption = option;\n        mappedOption.id = mappedOption.id != null ? mappedOption.id : index;\n    }\n    return optionMapper ? optionMapper(mappedOption) : mappedOption;\n};\nvar mapOptions = (options = [], optionMapper) => {\n    let index = 0;\n    return options.map((option) => {\n        index++;\n        if (isArray(option)) {\n            // is either [label, options] or [value, label]\n            if (isArray(option[1])) {\n                return {\n                    id: index,\n                    label: option[0],\n                    options: option[1].map((option) => mapOption(option, ++index, optionMapper)),\n                };\n            }\n            return mapOption(option, index, optionMapper);\n        }\n        else {\n            // is either { id?, label, options } or { id?, value, label }\n            if (option.options) {\n                return {\n                    id: option.id || index,\n                    label: option.label,\n                    options: option.options.map((option) => mapOption(option, ++index, optionMapper)),\n                };\n            }\n            return mapOption(option, index, optionMapper);\n        }\n    });\n};\n\nvar opop = (fn, ...args) => fn && fn(...args);\n\nvar localize = (prop, locale, params) => isFunction(prop) ? prop(locale, params) : prop;\n\nconst localizeOptions = (options, locale) => options.map(([value, label, props]) => {\n    if (isArray(label)) {\n        return [localize(value, locale), localizeOptions(label, locale)];\n    }\n    else {\n        const res = [value, localize(label, locale)];\n        if (props) {\n            let obj = { ...props };\n            if (props.icon)\n                obj.icon = localize(props.icon, locale);\n            res.push(obj);\n        }\n        return res;\n    }\n});\nvar localizeOptions$1 = (options, locale) => localizeOptions(options, locale);\n\n/* src/core/ui/components/RadioGroup.svelte generated by Svelte v3.29.4 */\n\nconst get_option_slot_changes_1 = dirty => ({\n\toption: dirty[0] & /*mappedOptions*/ 2048\n});\n\nconst get_option_slot_context_1 = ctx => ({ option: /*option*/ ctx[27] });\n\nconst get_option_slot_changes = dirty => ({\n\toption: dirty[0] & /*mappedOptions*/ 2048\n});\n\nconst get_option_slot_context = ctx => ({ option: /*option*/ ctx[27] });\n\nfunction get_each_context_1(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[27] = list[i];\n\treturn child_ctx;\n}\n\nconst get_group_slot_changes = dirty => ({\n\toption: dirty[0] & /*mappedOptions*/ 2048\n});\n\nconst get_group_slot_context = ctx => ({ option: /*option*/ ctx[27] });\n\nfunction get_each_context$3(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[27] = list[i];\n\treturn child_ctx;\n}\n\n// (83:0) {#if localizedOptions.length}\nfunction create_if_block_1$3(ctx) {\n\tlet fieldset;\n\tlet t;\n\tlet ul;\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet fieldset_class_value;\n\tlet current;\n\tlet if_block = /*label*/ ctx[1] && create_if_block_7$1(ctx);\n\tlet each_value = /*mappedOptions*/ ctx[11];\n\tconst get_key = ctx => /*option*/ ctx[27].id;\n\n\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\tlet child_ctx = get_each_context$3(ctx, each_value, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block$3(key, child_ctx));\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tfieldset = element(\"fieldset\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tt = space();\n\t\t\tul = element(\"ul\");\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\tattr(ul, \"class\", \"DokaRadioGroupOptions\");\n\t\t\tattr(fieldset, \"class\", fieldset_class_value = arrayJoin([\"DokaRadioGroup\", /*klass*/ ctx[3]]));\n\t\t\tattr(fieldset, \"data-layout\", /*layout*/ ctx[5]);\n\t\t\tattr(fieldset, \"title\", /*title*/ ctx[7]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, fieldset, anchor);\n\t\t\tif (if_block) if_block.m(fieldset, null);\n\t\t\tappend(fieldset, t);\n\t\t\tappend(fieldset, ul);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(ul, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*label*/ ctx[1]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_7$1(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\tif_block.m(fieldset, t);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tif_block.d(1);\n\t\t\t\tif_block = null;\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*optionGroupClass, mappedOptions, name, optionClass, getOptionIndex, selectedIndex, handleRadioKeydown, handleRadioClick, optionLabelClass, $$scope*/ 4225873) {\n\t\t\t\tconst each_value = /*mappedOptions*/ ctx[11];\n\t\t\t\tgroup_outros();\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value, each_1_lookup, ul, outro_and_destroy_block, create_each_block$3, null, get_each_context$3);\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*klass*/ 8 && fieldset_class_value !== (fieldset_class_value = arrayJoin([\"DokaRadioGroup\", /*klass*/ ctx[3]]))) {\n\t\t\t\tattr(fieldset, \"class\", fieldset_class_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*layout*/ 32) {\n\t\t\t\tattr(fieldset, \"data-layout\", /*layout*/ ctx[5]);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*title*/ 128) {\n\t\t\t\tattr(fieldset, \"title\", /*title*/ ctx[7]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\n\t\t\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\t\t\ttransition_in(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\ttransition_out(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(fieldset);\n\t\t\tif (if_block) if_block.d();\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d();\n\t\t\t}\n\t\t}\n\t};\n}\n\n// (85:4) {#if label}\nfunction create_if_block_7$1(ctx) {\n\tlet legend;\n\tlet t;\n\tlet legend_class_value;\n\n\treturn {\n\t\tc() {\n\t\t\tlegend = element(\"legend\");\n\t\t\tt = text(/*label*/ ctx[1]);\n\t\t\tattr(legend, \"class\", legend_class_value = /*hideLabel*/ ctx[2] && \"implicit\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, legend, anchor);\n\t\t\tappend(legend, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*label*/ 2) set_data(t, /*label*/ ctx[1]);\n\n\t\t\tif (dirty[0] & /*hideLabel*/ 4 && legend_class_value !== (legend_class_value = /*hideLabel*/ ctx[2] && \"implicit\")) {\n\t\t\t\tattr(legend, \"class\", legend_class_value);\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(legend);\n\t\t}\n\t};\n}\n\n// (115:8) {:else}\nfunction create_else_block$2(ctx) {\n\tlet radioitem;\n\tlet current;\n\n\tradioitem = new RadioItem({\n\t\t\tprops: {\n\t\t\t\tname: /*name*/ ctx[4],\n\t\t\t\tlabel: /*option*/ ctx[27].label,\n\t\t\t\tid: /*option*/ ctx[27].id,\n\t\t\t\tvalue: /*option*/ ctx[27].value,\n\t\t\t\tdisabled: /*option*/ ctx[27].disabled,\n\t\t\t\tclass: /*optionClass*/ ctx[8],\n\t\t\t\tchecked: /*getOptionIndex*/ ctx[12](/*option*/ ctx[27]) === /*selectedIndex*/ ctx[0],\n\t\t\t\tonkeydown: /*handleRadioKeydown*/ ctx[13](/*option*/ ctx[27]),\n\t\t\t\tonclick: /*handleRadioClick*/ ctx[14](/*option*/ ctx[27]),\n\t\t\t\t$$slots: { default: [create_default_slot_2$1] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(radioitem.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(radioitem, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst radioitem_changes = {};\n\t\t\tif (dirty[0] & /*name*/ 16) radioitem_changes.name = /*name*/ ctx[4];\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.label = /*option*/ ctx[27].label;\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.id = /*option*/ ctx[27].id;\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.value = /*option*/ ctx[27].value;\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.disabled = /*option*/ ctx[27].disabled;\n\t\t\tif (dirty[0] & /*optionClass*/ 256) radioitem_changes.class = /*optionClass*/ ctx[8];\n\t\t\tif (dirty[0] & /*mappedOptions, selectedIndex*/ 2049) radioitem_changes.checked = /*getOptionIndex*/ ctx[12](/*option*/ ctx[27]) === /*selectedIndex*/ ctx[0];\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.onkeydown = /*handleRadioKeydown*/ ctx[13](/*option*/ ctx[27]);\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.onclick = /*handleRadioClick*/ ctx[14](/*option*/ ctx[27]);\n\n\t\t\tif (dirty[0] & /*$$scope, optionLabelClass, mappedOptions*/ 4196416) {\n\t\t\t\tradioitem_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tradioitem.$set(radioitem_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(radioitem.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(radioitem.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(radioitem, detaching);\n\t\t}\n\t};\n}\n\n// (90:8) {#if option.options}\nfunction create_if_block_2$1(ctx) {\n\tlet li;\n\tlet t0;\n\tlet ul;\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet t1;\n\tlet li_class_value;\n\tlet current;\n\tconst group_slot_template = /*#slots*/ ctx[21].group;\n\tconst group_slot = create_slot(group_slot_template, ctx, /*$$scope*/ ctx[22], get_group_slot_context);\n\tconst group_slot_or_fallback = group_slot || fallback_block_1(ctx);\n\tlet each_value_1 = /*option*/ ctx[27].options;\n\tconst get_key = ctx => /*option*/ ctx[27].id;\n\n\tfor (let i = 0; i < each_value_1.length; i += 1) {\n\t\tlet child_ctx = get_each_context_1(ctx, each_value_1, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block_1(key, child_ctx));\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tli = element(\"li\");\n\t\t\tif (group_slot_or_fallback) group_slot_or_fallback.c();\n\t\t\tt0 = space();\n\t\t\tul = element(\"ul\");\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\tt1 = space();\n\t\t\tattr(ul, \"class\", \"DokaRadioGroupOptions\");\n\t\t\tattr(li, \"class\", li_class_value = arrayJoin([\"DokaRadioGroupOptionGroup\", /*optionGroupClass*/ ctx[9]]));\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, li, anchor);\n\n\t\t\tif (group_slot_or_fallback) {\n\t\t\t\tgroup_slot_or_fallback.m(li, null);\n\t\t\t}\n\n\t\t\tappend(li, t0);\n\t\t\tappend(li, ul);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(ul, null);\n\t\t\t}\n\n\t\t\tappend(li, t1);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (group_slot) {\n\t\t\t\tif (group_slot.p && dirty[0] & /*$$scope, mappedOptions*/ 4196352) {\n\t\t\t\t\tupdate_slot(group_slot, group_slot_template, ctx, /*$$scope*/ ctx[22], dirty, get_group_slot_changes, get_group_slot_context);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (group_slot_or_fallback && group_slot_or_fallback.p && dirty[0] & /*mappedOptions*/ 2048) {\n\t\t\t\t\tgroup_slot_or_fallback.p(ctx, dirty);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*name, mappedOptions, optionClass, getOptionIndex, selectedIndex, handleRadioKeydown, handleRadioClick, optionLabelClass, $$scope*/ 4225361) {\n\t\t\t\tconst each_value_1 = /*option*/ ctx[27].options;\n\t\t\t\tgroup_outros();\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value_1, each_1_lookup, ul, outro_and_destroy_block, create_each_block_1, null, get_each_context_1);\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*optionGroupClass*/ 512 && li_class_value !== (li_class_value = arrayJoin([\"DokaRadioGroupOptionGroup\", /*optionGroupClass*/ ctx[9]]))) {\n\t\t\t\tattr(li, \"class\", li_class_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(group_slot_or_fallback, local);\n\n\t\t\tfor (let i = 0; i < each_value_1.length; i += 1) {\n\t\t\t\ttransition_in(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(group_slot_or_fallback, local);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\ttransition_out(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(li);\n\t\t\tif (group_slot_or_fallback) group_slot_or_fallback.d(detaching);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d();\n\t\t\t}\n\t\t}\n\t};\n}\n\n// (126:16) {#if option.icon}\nfunction create_if_block_6$1(ctx) {\n\tlet icon;\n\tlet current;\n\n\ticon = new Icon({\n\t\t\tprops: {\n\t\t\t\t$$slots: { default: [create_default_slot_3$1] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(icon.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(icon, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst icon_changes = {};\n\n\t\t\tif (dirty[0] & /*$$scope, mappedOptions*/ 4196352) {\n\t\t\t\ticon_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon.$set(icon_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(icon, detaching);\n\t\t}\n\t};\n}\n\n// (127:16) <Icon>\nfunction create_default_slot_3$1(ctx) {\n\tlet g;\n\tlet raw_value = /*option*/ ctx[27].icon + \"\";\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = raw_value;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048 && raw_value !== (raw_value = /*option*/ ctx[27].icon + \"\")) g.innerHTML = raw_value;\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (129:16) {#if !option.hideLabel}\nfunction create_if_block_5$1(ctx) {\n\tlet span;\n\tlet t_value = /*option*/ ctx[27].label + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t\tattr(span, \"class\", /*optionLabelClass*/ ctx[6]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048 && t_value !== (t_value = /*option*/ ctx[27].label + \"\")) set_data(t, t_value);\n\n\t\t\tif (dirty[0] & /*optionLabelClass*/ 64) {\n\t\t\t\tattr(span, \"class\", /*optionLabelClass*/ ctx[6]);\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (125:76)                  \nfunction fallback_block_2(ctx) {\n\tlet t0;\n\tlet t1;\n\tlet current;\n\tlet if_block0 = /*option*/ ctx[27].icon && create_if_block_6$1(ctx);\n\tlet if_block1 = !/*option*/ ctx[27].hideLabel && create_if_block_5$1(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt0 = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tt1 = space();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (if_block0) if_block0.m(target, anchor);\n\t\t\tinsert(target, t0, anchor);\n\t\t\tif (if_block1) if_block1.m(target, anchor);\n\t\t\tinsert(target, t1, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*option*/ ctx[27].icon) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_6$1(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(t0.parentNode, t0);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!/*option*/ ctx[27].hideLabel) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block_5$1(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\tif_block1.m(t1.parentNode, t1);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tif_block1.d(1);\n\t\t\t\tif_block1 = null;\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (if_block0) if_block0.d(detaching);\n\t\t\tif (detaching) detach(t0);\n\t\t\tif (if_block1) if_block1.d(detaching);\n\t\t\tif (detaching) detach(t1);\n\t\t}\n\t};\n}\n\n// (116:8) <RadioItem              {name}              label={option.label}             id={option.id}             value={option.value}             disabled={option.disabled}             class={optionClass}             checked={getOptionIndex(option) === selectedIndex}             onkeydown={handleRadioKeydown(option)}             onclick={handleRadioClick(option)}>\nfunction create_default_slot_2$1(ctx) {\n\tlet current;\n\tconst option_slot_template = /*#slots*/ ctx[21].option;\n\tconst option_slot = create_slot(option_slot_template, ctx, /*$$scope*/ ctx[22], get_option_slot_context_1);\n\tconst option_slot_or_fallback = option_slot || fallback_block_2(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tif (option_slot_or_fallback) option_slot_or_fallback.c();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (option_slot_or_fallback) {\n\t\t\t\toption_slot_or_fallback.m(target, anchor);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (option_slot) {\n\t\t\t\tif (option_slot.p && dirty[0] & /*$$scope, mappedOptions*/ 4196352) {\n\t\t\t\t\tupdate_slot(option_slot, option_slot_template, ctx, /*$$scope*/ ctx[22], dirty, get_option_slot_changes_1, get_option_slot_context_1);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (option_slot_or_fallback && option_slot_or_fallback.p && dirty[0] & /*optionLabelClass, mappedOptions*/ 2112) {\n\t\t\t\t\toption_slot_or_fallback.p(ctx, dirty);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(option_slot_or_fallback, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(option_slot_or_fallback, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (option_slot_or_fallback) option_slot_or_fallback.d(detaching);\n\t\t}\n\t};\n}\n\n// (92:47) <span class=\"DokaRadioGroupOptionGroupLabel\">\nfunction fallback_block_1(ctx) {\n\tlet span;\n\tlet t_value = /*option*/ ctx[27].label + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t\tattr(span, \"class\", \"DokaRadioGroupOptionGroupLabel\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048 && t_value !== (t_value = /*option*/ ctx[27].label + \"\")) set_data(t, t_value);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (105:24) {#if option.icon}\nfunction create_if_block_4$1(ctx) {\n\tlet icon;\n\tlet current;\n\n\ticon = new Icon({\n\t\t\tprops: {\n\t\t\t\t$$slots: { default: [create_default_slot_1$1] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(icon.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(icon, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst icon_changes = {};\n\n\t\t\tif (dirty[0] & /*$$scope, mappedOptions*/ 4196352) {\n\t\t\t\ticon_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon.$set(icon_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(icon, detaching);\n\t\t}\n\t};\n}\n\n// (106:24) <Icon>\nfunction create_default_slot_1$1(ctx) {\n\tlet g;\n\tlet raw_value = /*option*/ ctx[27].icon + \"\";\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = raw_value;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048 && raw_value !== (raw_value = /*option*/ ctx[27].icon + \"\")) g.innerHTML = raw_value;\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (108:24) {#if !option.hideLabel}\nfunction create_if_block_3$1(ctx) {\n\tlet span;\n\tlet t_value = /*option*/ ctx[27].label + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t\tattr(span, \"class\", /*optionLabelClass*/ ctx[6]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048 && t_value !== (t_value = /*option*/ ctx[27].label + \"\")) set_data(t, t_value);\n\n\t\t\tif (dirty[0] & /*optionLabelClass*/ 64) {\n\t\t\t\tattr(span, \"class\", /*optionLabelClass*/ ctx[6]);\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (104:84)                          \nfunction fallback_block$1(ctx) {\n\tlet t0;\n\tlet t1;\n\tlet current;\n\tlet if_block0 = /*option*/ ctx[27].icon && create_if_block_4$1(ctx);\n\tlet if_block1 = !/*option*/ ctx[27].hideLabel && create_if_block_3$1(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt0 = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tt1 = space();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (if_block0) if_block0.m(target, anchor);\n\t\t\tinsert(target, t0, anchor);\n\t\t\tif (if_block1) if_block1.m(target, anchor);\n\t\t\tinsert(target, t1, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*option*/ ctx[27].icon) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_4$1(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(t0.parentNode, t0);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!/*option*/ ctx[27].hideLabel) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block_3$1(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\tif_block1.m(t1.parentNode, t1);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tif_block1.d(1);\n\t\t\t\tif_block1 = null;\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (if_block0) if_block0.d(detaching);\n\t\t\tif (detaching) detach(t0);\n\t\t\tif (if_block1) if_block1.d(detaching);\n\t\t\tif (detaching) detach(t1);\n\t\t}\n\t};\n}\n\n// (95:16) <RadioItem                      {name}                      label={option.label}                     id={option.id}                     value={option.value}                     disabled={option.disabled}                     class={optionClass}                     checked={getOptionIndex(option) === selectedIndex}                     onkeydown={handleRadioKeydown(option)}                     onclick={handleRadioClick(option)}>\nfunction create_default_slot$3(ctx) {\n\tlet current;\n\tconst option_slot_template = /*#slots*/ ctx[21].option;\n\tconst option_slot = create_slot(option_slot_template, ctx, /*$$scope*/ ctx[22], get_option_slot_context);\n\tconst option_slot_or_fallback = option_slot || fallback_block$1(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tif (option_slot_or_fallback) option_slot_or_fallback.c();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (option_slot_or_fallback) {\n\t\t\t\toption_slot_or_fallback.m(target, anchor);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (option_slot) {\n\t\t\t\tif (option_slot.p && dirty[0] & /*$$scope, mappedOptions*/ 4196352) {\n\t\t\t\t\tupdate_slot(option_slot, option_slot_template, ctx, /*$$scope*/ ctx[22], dirty, get_option_slot_changes, get_option_slot_context);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (option_slot_or_fallback && option_slot_or_fallback.p && dirty[0] & /*optionLabelClass, mappedOptions*/ 2112) {\n\t\t\t\t\toption_slot_or_fallback.p(ctx, dirty);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(option_slot_or_fallback, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(option_slot_or_fallback, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (option_slot_or_fallback) option_slot_or_fallback.d(detaching);\n\t\t}\n\t};\n}\n\n// (94:16) {#each option.options as option (option.id) }\nfunction create_each_block_1(key_1, ctx) {\n\tlet first;\n\tlet radioitem;\n\tlet current;\n\n\tradioitem = new RadioItem({\n\t\t\tprops: {\n\t\t\t\tname: /*name*/ ctx[4],\n\t\t\t\tlabel: /*option*/ ctx[27].label,\n\t\t\t\tid: /*option*/ ctx[27].id,\n\t\t\t\tvalue: /*option*/ ctx[27].value,\n\t\t\t\tdisabled: /*option*/ ctx[27].disabled,\n\t\t\t\tclass: /*optionClass*/ ctx[8],\n\t\t\t\tchecked: /*getOptionIndex*/ ctx[12](/*option*/ ctx[27]) === /*selectedIndex*/ ctx[0],\n\t\t\t\tonkeydown: /*handleRadioKeydown*/ ctx[13](/*option*/ ctx[27]),\n\t\t\t\tonclick: /*handleRadioClick*/ ctx[14](/*option*/ ctx[27]),\n\t\t\t\t$$slots: { default: [create_default_slot$3] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tfirst = empty();\n\t\t\tcreate_component(radioitem.$$.fragment);\n\t\t\tthis.first = first;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, first, anchor);\n\t\t\tmount_component(radioitem, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst radioitem_changes = {};\n\t\t\tif (dirty[0] & /*name*/ 16) radioitem_changes.name = /*name*/ ctx[4];\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.label = /*option*/ ctx[27].label;\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.id = /*option*/ ctx[27].id;\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.value = /*option*/ ctx[27].value;\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.disabled = /*option*/ ctx[27].disabled;\n\t\t\tif (dirty[0] & /*optionClass*/ 256) radioitem_changes.class = /*optionClass*/ ctx[8];\n\t\t\tif (dirty[0] & /*mappedOptions, selectedIndex*/ 2049) radioitem_changes.checked = /*getOptionIndex*/ ctx[12](/*option*/ ctx[27]) === /*selectedIndex*/ ctx[0];\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.onkeydown = /*handleRadioKeydown*/ ctx[13](/*option*/ ctx[27]);\n\t\t\tif (dirty[0] & /*mappedOptions*/ 2048) radioitem_changes.onclick = /*handleRadioClick*/ ctx[14](/*option*/ ctx[27]);\n\n\t\t\tif (dirty[0] & /*$$scope, optionLabelClass, mappedOptions*/ 4196416) {\n\t\t\t\tradioitem_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tradioitem.$set(radioitem_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(radioitem.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(radioitem.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(first);\n\t\t\tdestroy_component(radioitem, detaching);\n\t\t}\n\t};\n}\n\n// (89:8) {#each mappedOptions as option (option.id) }\nfunction create_each_block$3(key_1, ctx) {\n\tlet first;\n\tlet current_block_type_index;\n\tlet if_block;\n\tlet if_block_anchor;\n\tlet current;\n\tconst if_block_creators = [create_if_block_2$1, create_else_block$2];\n\tconst if_blocks = [];\n\n\tfunction select_block_type(ctx, dirty) {\n\t\tif (/*option*/ ctx[27].options) return 0;\n\t\treturn 1;\n\t}\n\n\tcurrent_block_type_index = select_block_type(ctx);\n\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tfirst = empty();\n\t\t\tif_block.c();\n\t\t\tif_block_anchor = empty();\n\t\t\tthis.first = first;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, first, anchor);\n\t\t\tif_blocks[current_block_type_index].m(target, anchor);\n\t\t\tinsert(target, if_block_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tlet previous_block_index = current_block_type_index;\n\t\t\tcurrent_block_type_index = select_block_type(ctx);\n\n\t\t\tif (current_block_type_index === previous_block_index) {\n\t\t\t\tif_blocks[current_block_type_index].p(ctx, dirty);\n\t\t\t} else {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_blocks[previous_block_index], 1, 1, () => {\n\t\t\t\t\tif_blocks[previous_block_index] = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t\tif_block = if_blocks[current_block_type_index];\n\n\t\t\t\tif (!if_block) {\n\t\t\t\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t}\n\n\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\tif_block.m(if_block_anchor.parentNode, if_block_anchor);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(first);\n\t\t\tif_blocks[current_block_type_index].d(detaching);\n\t\t\tif (detaching) detach(if_block_anchor);\n\t\t}\n\t};\n}\n\nfunction create_fragment$f(ctx) {\n\tlet t;\n\tlet if_block1_anchor;\n\tlet current;\n\tlet if_block0 = /*localizedOptions*/ ctx[10].length && create_if_block_1$3(ctx);\n\tlet if_block1 = false ;\n\n\treturn {\n\t\tc() {\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt = space();\n\t\t\tif_block1_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (if_block0) if_block0.m(target, anchor);\n\t\t\tinsert(target, t, anchor);\n\t\t\tinsert(target, if_block1_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*localizedOptions*/ ctx[10].length) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*localizedOptions*/ 1024) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_1$3(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(t.parentNode, t);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\ttransition_in(if_block1);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\ttransition_out(if_block1);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (if_block0) if_block0.d(detaching);\n\t\t\tif (detaching) detach(t);\n\t\t\tif (detaching) detach(if_block1_anchor);\n\t\t}\n\t};\n}\n\nfunction instance$f($$self, $$props, $$invalidate) {\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tconst dispatch = createEventDispatcher();\n\tlet { label = undefined } = $$props;\n\tlet { hideLabel = true } = $$props;\n\tlet { class: klass = undefined } = $$props;\n\tlet { name = `doka-radio-group-${getUniqueId()}` } = $$props;\n\tlet { selectedIndex = -1 } = $$props;\n\tlet { options = [] } = $$props;\n\tlet { onchange = undefined } = $$props;\n\tlet { layout = undefined } = $$props;\n\tlet { optionMapper = undefined } = $$props;\n\tlet { optionFilter = undefined } = $$props;\n\tlet { value = undefined } = $$props;\n\tlet { optionLabelClass = undefined } = $$props;\n\tlet { title = undefined } = $$props;\n\tlet { locale = undefined } = $$props;\n\tlet { optionClass = undefined } = $$props;\n\tlet { optionGroupClass = undefined } = $$props;\n\tconst getOptionIndex = option => flattenedOptions.findIndex(flattenedOption => flattenedOption.id === option.id);\n\tconst isConfirm = key => (/enter| /i).test(key);\n\n\tconst changeSelection = option => {\n\t\t$$invalidate(0, selectedIndex = getOptionIndex(option));\n\t\tconst payload = { index: selectedIndex, ...option };\n\t\topop(onchange, payload);\n\t\tdispatch(\"change\", payload);\n\t};\n\n\tconst handleRadioKeydown = option => e => {\n\t\t// is confirm key ([enter] or [space])\n\t\tif (!isConfirm(e.key)) return;\n\n\t\tchangeSelection(option);\n\t};\n\n\tconst handleRadioClick = option => e => {\n\t\tchangeSelection(option);\n\t};\n\n\t$$self.$$set = $$props => {\n\t\tif (\"label\" in $$props) $$invalidate(1, label = $$props.label);\n\t\tif (\"hideLabel\" in $$props) $$invalidate(2, hideLabel = $$props.hideLabel);\n\t\tif (\"class\" in $$props) $$invalidate(3, klass = $$props.class);\n\t\tif (\"name\" in $$props) $$invalidate(4, name = $$props.name);\n\t\tif (\"selectedIndex\" in $$props) $$invalidate(0, selectedIndex = $$props.selectedIndex);\n\t\tif (\"options\" in $$props) $$invalidate(15, options = $$props.options);\n\t\tif (\"onchange\" in $$props) $$invalidate(16, onchange = $$props.onchange);\n\t\tif (\"layout\" in $$props) $$invalidate(5, layout = $$props.layout);\n\t\tif (\"optionMapper\" in $$props) $$invalidate(17, optionMapper = $$props.optionMapper);\n\t\tif (\"optionFilter\" in $$props) $$invalidate(18, optionFilter = $$props.optionFilter);\n\t\tif (\"value\" in $$props) $$invalidate(19, value = $$props.value);\n\t\tif (\"optionLabelClass\" in $$props) $$invalidate(6, optionLabelClass = $$props.optionLabelClass);\n\t\tif (\"title\" in $$props) $$invalidate(7, title = $$props.title);\n\t\tif (\"locale\" in $$props) $$invalidate(20, locale = $$props.locale);\n\t\tif (\"optionClass\" in $$props) $$invalidate(8, optionClass = $$props.optionClass);\n\t\tif (\"optionGroupClass\" in $$props) $$invalidate(9, optionGroupClass = $$props.optionGroupClass);\n\t\tif (\"$$scope\" in $$props) $$invalidate(22, $$scope = $$props.$$scope);\n\t};\n\n\tlet localizedOptions;\n\tlet mappedOptions;\n\tlet flattenedOptions;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*optionFilter, options, locale*/ 1343488) {\n\t\t\t $$invalidate(10, localizedOptions = localizeOptions$1(optionFilter ? options.filter(optionFilter) : options, locale));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*localizedOptions, optionMapper*/ 132096) {\n\t\t\t $$invalidate(11, mappedOptions = mapOptions(localizedOptions, optionMapper));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*mappedOptions*/ 2048) {\n\t\t\t $$invalidate(23, flattenedOptions = flattenOptions(mappedOptions));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*value, selectedIndex, flattenedOptions*/ 8912897) {\n\t\t\t// can optionally pass value to have radio button group try to auto-select the right option\n\t\t\t if (value && selectedIndex < 0) {\n\t\t\t\t$$invalidate(0, selectedIndex = flattenedOptions.findIndex(option => option.value === value));\n\t\t\t}\n\t\t}\n\t};\n\n\treturn [\n\t\tselectedIndex,\n\t\tlabel,\n\t\thideLabel,\n\t\tklass,\n\t\tname,\n\t\tlayout,\n\t\toptionLabelClass,\n\t\ttitle,\n\t\toptionClass,\n\t\toptionGroupClass,\n\t\tlocalizedOptions,\n\t\tmappedOptions,\n\t\tgetOptionIndex,\n\t\thandleRadioKeydown,\n\t\thandleRadioClick,\n\t\toptions,\n\t\tonchange,\n\t\toptionMapper,\n\t\toptionFilter,\n\t\tvalue,\n\t\tlocale,\n\t\tslots,\n\t\t$$scope\n\t];\n}\n\nclass RadioGroup extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$f,\n\t\t\tcreate_fragment$f,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tlabel: 1,\n\t\t\t\thideLabel: 2,\n\t\t\t\tclass: 3,\n\t\t\t\tname: 4,\n\t\t\t\tselectedIndex: 0,\n\t\t\t\toptions: 15,\n\t\t\t\tonchange: 16,\n\t\t\t\tlayout: 5,\n\t\t\t\toptionMapper: 17,\n\t\t\t\toptionFilter: 18,\n\t\t\t\tvalue: 19,\n\t\t\t\toptionLabelClass: 6,\n\t\t\t\ttitle: 7,\n\t\t\t\tlocale: 20,\n\t\t\t\toptionClass: 8,\n\t\t\t\toptionGroupClass: 9\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n}\n\nvar isDeepEqual = (a, b) => {\n    if (Array.isArray(a) && Array.isArray(b))\n        return arrayEqual(a, b);\n    return a === b;\n};\n\n/* src/core/ui/components/Dropdown.svelte generated by Svelte v3.29.4 */\n\nfunction create_if_block_2$2(ctx) {\n\tlet icon_1;\n\tlet current;\n\n\ticon_1 = new Icon({\n\t\t\tprops: {\n\t\t\t\t$$slots: { default: [create_default_slot_3$2] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(icon_1.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(icon_1, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst icon_1_changes = {};\n\n\t\t\tif (dirty & /*$$scope, icon*/ 134217792) {\n\t\t\t\ticon_1_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon_1.$set(icon_1_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon_1.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon_1.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(icon_1, detaching);\n\t\t}\n\t};\n}\n\n// (145:8) <Icon>\nfunction create_default_slot_3$2(ctx) {\n\tlet g;\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = /*icon*/ ctx[6];\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*icon*/ 64) g.innerHTML = /*icon*/ ctx[6];\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (147:8) {#if !hideLabel}\nfunction create_if_block_1$4(ctx) {\n\tlet span;\n\tlet t_value = (/*label*/ ctx[2] || /*selectedLabel*/ ctx[18]) + \"\";\n\tlet t;\n\tlet span_class_value;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t\tattr(span, \"class\", span_class_value = arrayJoin([\"DokaButtonLabel\", /*labelClass*/ ctx[3]]));\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*label, selectedLabel*/ 262148 && t_value !== (t_value = (/*label*/ ctx[2] || /*selectedLabel*/ ctx[18]) + \"\")) set_data(t, t_value);\n\n\t\t\tif (dirty & /*labelClass*/ 8 && span_class_value !== (span_class_value = arrayJoin([\"DokaButtonLabel\", /*labelClass*/ ctx[3]]))) {\n\t\t\t\tattr(span, \"class\", span_class_value);\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (143:4) <span slot=\"label\" title={localize(title, locale)} class={arrayJoin(['DokaButtonInner', innerClass])} >\nfunction create_label_slot(ctx) {\n\tlet span;\n\tlet t;\n\tlet span_title_value;\n\tlet span_class_value;\n\tlet current;\n\tlet if_block0 = /*icon*/ ctx[6] && create_if_block_2$2(ctx);\n\tlet if_block1 = !/*hideLabel*/ ctx[5] && create_if_block_1$4(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tattr(span, \"slot\", \"label\");\n\t\t\tattr(span, \"title\", span_title_value = localize(/*title*/ ctx[1], /*locale*/ ctx[15]));\n\t\t\tattr(span, \"class\", span_class_value = arrayJoin([\"DokaButtonInner\", /*innerClass*/ ctx[4]]));\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tif (if_block0) if_block0.m(span, null);\n\t\t\tappend(span, t);\n\t\t\tif (if_block1) if_block1.m(span, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*icon*/ ctx[6]) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*icon*/ 64) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_2$2(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(span, t);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!/*hideLabel*/ ctx[5]) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block_1$4(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\tif_block1.m(span, null);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tif_block1.d(1);\n\t\t\t\tif_block1 = null;\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*title, locale*/ 32770 && span_title_value !== (span_title_value = localize(/*title*/ ctx[1], /*locale*/ ctx[15]))) {\n\t\t\t\tattr(span, \"title\", span_title_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*innerClass*/ 16 && span_class_value !== (span_class_value = arrayJoin([\"DokaButtonInner\", /*innerClass*/ ctx[4]]))) {\n\t\t\t\tattr(span, \"class\", span_class_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t\tif (if_block0) if_block0.d();\n\t\t\tif (if_block1) if_block1.d();\n\t\t}\n\t};\n}\n\n// (165:12) <span slot=\"group\">\nfunction create_group_slot(ctx) {\n\tlet span;\n\tlet t_value = /*option*/ ctx[26].label + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t\tattr(span, \"slot\", \"group\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*option*/ 67108864 && t_value !== (t_value = /*option*/ ctx[26].label + \"\")) set_data(t, t_value);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (167:16) {#if option.icon}\nfunction create_if_block$3(ctx) {\n\tlet icon_1;\n\tlet current;\n\n\ticon_1 = new Icon({\n\t\t\tprops: {\n\t\t\t\tstyle: isFunction(/*optionIconStyle*/ ctx[13])\n\t\t\t\t? /*optionIconStyle*/ ctx[13](/*option*/ ctx[26].value)\n\t\t\t\t: /*optionIconStyle*/ ctx[13],\n\t\t\t\t$$slots: { default: [create_default_slot_2$2] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(icon_1.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(icon_1, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst icon_1_changes = {};\n\n\t\t\tif (dirty & /*optionIconStyle, option*/ 67117056) icon_1_changes.style = isFunction(/*optionIconStyle*/ ctx[13])\n\t\t\t? /*optionIconStyle*/ ctx[13](/*option*/ ctx[26].value)\n\t\t\t: /*optionIconStyle*/ ctx[13];\n\n\t\t\tif (dirty & /*$$scope, option*/ 201326592) {\n\t\t\t\ticon_1_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon_1.$set(icon_1_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon_1.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon_1.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(icon_1, detaching);\n\t\t}\n\t};\n}\n\n// (168:16) <Icon style={isFunction(optionIconStyle) ? optionIconStyle(option.value) : optionIconStyle}>\nfunction create_default_slot_2$2(ctx) {\n\tlet g;\n\tlet raw_value = /*option*/ ctx[26].icon + \"\";\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = raw_value;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*option*/ 67108864 && raw_value !== (raw_value = /*option*/ ctx[26].icon + \"\")) g.innerHTML = raw_value;\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (166:12) <span slot=\"option\">\nfunction create_option_slot(ctx) {\n\tlet span0;\n\tlet t0;\n\tlet span1;\n\tlet t1_value = /*option*/ ctx[26].label + \"\";\n\tlet t1;\n\tlet span1_style_value;\n\tlet span1_class_value;\n\tlet current;\n\tlet if_block = /*option*/ ctx[26].icon && create_if_block$3(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tspan0 = element(\"span\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tt0 = space();\n\t\t\tspan1 = element(\"span\");\n\t\t\tt1 = text(t1_value);\n\n\t\t\tattr(span1, \"style\", span1_style_value = isFunction(/*optionLabelStyle*/ ctx[14])\n\t\t\t? /*optionLabelStyle*/ ctx[14](/*option*/ ctx[26].value)\n\t\t\t: /*optionLabelStyle*/ ctx[14]);\n\n\t\t\tattr(span1, \"class\", span1_class_value = arrayJoin([\"DokaDropdownOptionLabel\", /*optionLabelClass*/ ctx[10]]));\n\t\t\tattr(span0, \"slot\", \"option\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span0, anchor);\n\t\t\tif (if_block) if_block.m(span0, null);\n\t\t\tappend(span0, t0);\n\t\t\tappend(span0, span1);\n\t\t\tappend(span1, t1);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*option*/ ctx[26].icon) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*option*/ 67108864) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block$3(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(span0, t0);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif ((!current || dirty & /*option*/ 67108864) && t1_value !== (t1_value = /*option*/ ctx[26].label + \"\")) set_data(t1, t1_value);\n\n\t\t\tif (!current || dirty & /*optionLabelStyle, option*/ 67125248 && span1_style_value !== (span1_style_value = isFunction(/*optionLabelStyle*/ ctx[14])\n\t\t\t? /*optionLabelStyle*/ ctx[14](/*option*/ ctx[26].value)\n\t\t\t: /*optionLabelStyle*/ ctx[14])) {\n\t\t\t\tattr(span1, \"style\", span1_style_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*optionLabelClass*/ 1024 && span1_class_value !== (span1_class_value = arrayJoin([\"DokaDropdownOptionLabel\", /*optionLabelClass*/ ctx[10]]))) {\n\t\t\t\tattr(span1, \"class\", span1_class_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span0);\n\t\t\tif (if_block) if_block.d();\n\t\t}\n\t};\n}\n\n// (153:8) <RadioGroup              {name}             {value}             {selectedIndex}             {optionFilter}             {optionMapper}             optionLabelClass={arrayJoin(['DokaDropdownOptionLabel', optionLabelClass])}             optionGroupClass=\"DokaDropdownOptionGroup\"             optionClass=\"DokaDropdownOption\"             options={localizedOptions}             onchange={handleSelect}             let:option>\nfunction create_default_slot_1$2(ctx) {\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tt = space();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, t, anchor);\n\t\t},\n\t\tp: noop$1,\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(t);\n\t\t}\n\t};\n}\n\n// (152:4) <div class=\"DokaDropdownPanel\" slot=\"details\" on:keydown={handleKeydown}>\nfunction create_details_slot(ctx) {\n\tlet div;\n\tlet radiogroup;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\tradiogroup = new RadioGroup({\n\t\t\tprops: {\n\t\t\t\tname: /*name*/ ctx[7],\n\t\t\t\tvalue: /*value*/ ctx[9],\n\t\t\t\tselectedIndex: /*selectedIndex*/ ctx[8],\n\t\t\t\toptionFilter: /*optionFilter*/ ctx[11],\n\t\t\t\toptionMapper: /*optionMapper*/ ctx[12],\n\t\t\t\toptionLabelClass: arrayJoin([\"DokaDropdownOptionLabel\", /*optionLabelClass*/ ctx[10]]),\n\t\t\t\toptionGroupClass: \"DokaDropdownOptionGroup\",\n\t\t\t\toptionClass: \"DokaDropdownOption\",\n\t\t\t\toptions: /*localizedOptions*/ ctx[17],\n\t\t\t\tonchange: /*handleSelect*/ ctx[19],\n\t\t\t\t$$slots: {\n\t\t\t\t\tdefault: [\n\t\t\t\t\t\tcreate_default_slot_1$2,\n\t\t\t\t\t\t({ option }) => ({ 26: option }),\n\t\t\t\t\t\t({ option }) => option ? 67108864 : 0\n\t\t\t\t\t],\n\t\t\t\t\toption: [\n\t\t\t\t\t\tcreate_option_slot,\n\t\t\t\t\t\t({ option }) => ({ 26: option }),\n\t\t\t\t\t\t({ option }) => option ? 67108864 : 0\n\t\t\t\t\t],\n\t\t\t\t\tgroup: [\n\t\t\t\t\t\tcreate_group_slot,\n\t\t\t\t\t\t({ option }) => ({ 26: option }),\n\t\t\t\t\t\t({ option }) => option ? 67108864 : 0\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(radiogroup.$$.fragment);\n\t\t\tattr(div, \"class\", \"DokaDropdownPanel\");\n\t\t\tattr(div, \"slot\", \"details\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(radiogroup, div, null);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = listen(div, \"keydown\", /*handleKeydown*/ ctx[21]);\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst radiogroup_changes = {};\n\t\t\tif (dirty & /*name*/ 128) radiogroup_changes.name = /*name*/ ctx[7];\n\t\t\tif (dirty & /*value*/ 512) radiogroup_changes.value = /*value*/ ctx[9];\n\t\t\tif (dirty & /*selectedIndex*/ 256) radiogroup_changes.selectedIndex = /*selectedIndex*/ ctx[8];\n\t\t\tif (dirty & /*optionFilter*/ 2048) radiogroup_changes.optionFilter = /*optionFilter*/ ctx[11];\n\t\t\tif (dirty & /*optionMapper*/ 4096) radiogroup_changes.optionMapper = /*optionMapper*/ ctx[12];\n\t\t\tif (dirty & /*optionLabelClass*/ 1024) radiogroup_changes.optionLabelClass = arrayJoin([\"DokaDropdownOptionLabel\", /*optionLabelClass*/ ctx[10]]);\n\t\t\tif (dirty & /*localizedOptions*/ 131072) radiogroup_changes.options = /*localizedOptions*/ ctx[17];\n\n\t\t\tif (dirty & /*$$scope, optionLabelStyle, option, optionLabelClass, optionIconStyle*/ 201352192) {\n\t\t\t\tradiogroup_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tradiogroup.$set(radiogroup_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(radiogroup.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(radiogroup.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(radiogroup);\n\t\t\tmounted = false;\n\t\t\tdispose();\n\t\t}\n\t};\n}\n\n// (139:0) <Details bind:isActive={dropdownVisible}      onshow={handleShowPanel}      buttonClass={arrayJoin(['DokaDropdownButton',klass, hideLabel && 'DokaDropdownIconOnly'])}>\nfunction create_default_slot$4(ctx) {\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tt = space();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, t, anchor);\n\t\t},\n\t\tp: noop$1,\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(t);\n\t\t}\n\t};\n}\n\nfunction create_fragment$g(ctx) {\n\tlet details;\n\tlet updating_isActive;\n\tlet current;\n\n\tfunction details_isActive_binding(value) {\n\t\t/*details_isActive_binding*/ ctx[24].call(null, value);\n\t}\n\n\tlet details_props = {\n\t\tonshow: /*handleShowPanel*/ ctx[20],\n\t\tbuttonClass: arrayJoin([\n\t\t\t\"DokaDropdownButton\",\n\t\t\t/*klass*/ ctx[0],\n\t\t\t/*hideLabel*/ ctx[5] && \"DokaDropdownIconOnly\"\n\t\t]),\n\t\t$$slots: {\n\t\t\tdefault: [create_default_slot$4],\n\t\t\tdetails: [create_details_slot],\n\t\t\tlabel: [create_label_slot]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tif (/*dropdownVisible*/ ctx[16] !== void 0) {\n\t\tdetails_props.isActive = /*dropdownVisible*/ ctx[16];\n\t}\n\n\tdetails = new Details({ props: details_props });\n\tbinding_callbacks.push(() => bind(details, \"isActive\", details_isActive_binding));\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(details.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(details, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tconst details_changes = {};\n\n\t\t\tif (dirty & /*klass, hideLabel*/ 33) details_changes.buttonClass = arrayJoin([\n\t\t\t\t\"DokaDropdownButton\",\n\t\t\t\t/*klass*/ ctx[0],\n\t\t\t\t/*hideLabel*/ ctx[5] && \"DokaDropdownIconOnly\"\n\t\t\t]);\n\n\t\t\tif (dirty & /*$$scope, name, value, selectedIndex, optionFilter, optionMapper, optionLabelClass, localizedOptions, optionLabelStyle, optionIconStyle, title, locale, innerClass, labelClass, label, selectedLabel, hideLabel, icon*/ 134676478) {\n\t\t\t\tdetails_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tif (!updating_isActive && dirty & /*dropdownVisible*/ 65536) {\n\t\t\t\tupdating_isActive = true;\n\t\t\t\tdetails_changes.isActive = /*dropdownVisible*/ ctx[16];\n\t\t\t\tadd_flush_callback(() => updating_isActive = false);\n\t\t\t}\n\n\t\t\tdetails.$set(details_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(details.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(details.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(details, detaching);\n\t\t}\n\t};\n}\n\nfunction instance$g($$self, $$props, $$invalidate) {\n\tlet { class: klass = undefined } = $$props;\n\tlet { title = undefined } = $$props;\n\tlet { label = undefined } = $$props;\n\tlet { labelClass = undefined } = $$props;\n\tlet { innerClass = undefined } = $$props;\n\tlet { hideLabel = false } = $$props;\n\tlet { icon = undefined } = $$props;\n\tlet { name = undefined } = $$props;\n\tlet { options = [] } = $$props;\n\tlet { selectedIndex = -1 } = $$props;\n\tlet { value = undefined } = $$props;\n\tlet { optionLabelClass = undefined } = $$props;\n\tlet { optionFilter = undefined } = $$props;\n\tlet { optionMapper = undefined } = $$props;\n\tlet { optionIconStyle = undefined } = $$props;\n\tlet { optionLabelStyle = undefined } = $$props;\n\tlet { onchange = undefined } = $$props;\n\tlet { locale = undefined } = $$props;\n\n\tconst getUndefinedOptionLabel = options => {\n\t\tconst option = localizedOptions.find(option => option[0] === undefined);\n\t\tif (!option) return undefined;\n\t\treturn option[1];\n\t};\n\n\tlet dropdownVisible;\n\n\tconst handleSelect = detail => {\n\t\t// triggers label update\n\t\t$$invalidate(18, selectedLabel = detail.value);\n\n\t\t// update value\n\t\tonchange(detail);\n\n\t\t// hide details\n\t\t$$invalidate(16, dropdownVisible = false);\n\t};\n\n\tconst handleShowPanel = ({ e, panel }) => {\n\t\tif (e && e.key && (/up|down/i).test(e.key)) return panel.querySelector(\"input:not([disabled])\").focus();\n\t\tpanel.querySelector(\"fieldset\").focus();\n\t};\n\n\tconst handleKeydown = e => {\n\t\t// don't allow tabbing ([tab] is also blocked in normal <select>)\n\t\tif ((/tab/i).test(e.key)) e.preventDefault();\n\t};\n\n\tfunction details_isActive_binding(value) {\n\t\tdropdownVisible = value;\n\t\t$$invalidate(16, dropdownVisible);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"class\" in $$props) $$invalidate(0, klass = $$props.class);\n\t\tif (\"title\" in $$props) $$invalidate(1, title = $$props.title);\n\t\tif (\"label\" in $$props) $$invalidate(2, label = $$props.label);\n\t\tif (\"labelClass\" in $$props) $$invalidate(3, labelClass = $$props.labelClass);\n\t\tif (\"innerClass\" in $$props) $$invalidate(4, innerClass = $$props.innerClass);\n\t\tif (\"hideLabel\" in $$props) $$invalidate(5, hideLabel = $$props.hideLabel);\n\t\tif (\"icon\" in $$props) $$invalidate(6, icon = $$props.icon);\n\t\tif (\"name\" in $$props) $$invalidate(7, name = $$props.name);\n\t\tif (\"options\" in $$props) $$invalidate(22, options = $$props.options);\n\t\tif (\"selectedIndex\" in $$props) $$invalidate(8, selectedIndex = $$props.selectedIndex);\n\t\tif (\"value\" in $$props) $$invalidate(9, value = $$props.value);\n\t\tif (\"optionLabelClass\" in $$props) $$invalidate(10, optionLabelClass = $$props.optionLabelClass);\n\t\tif (\"optionFilter\" in $$props) $$invalidate(11, optionFilter = $$props.optionFilter);\n\t\tif (\"optionMapper\" in $$props) $$invalidate(12, optionMapper = $$props.optionMapper);\n\t\tif (\"optionIconStyle\" in $$props) $$invalidate(13, optionIconStyle = $$props.optionIconStyle);\n\t\tif (\"optionLabelStyle\" in $$props) $$invalidate(14, optionLabelStyle = $$props.optionLabelStyle);\n\t\tif (\"onchange\" in $$props) $$invalidate(23, onchange = $$props.onchange);\n\t\tif (\"locale\" in $$props) $$invalidate(15, locale = $$props.locale);\n\t};\n\n\tlet localizedOptions;\n\tlet selectedLabel;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*options, locale*/ 4227072) {\n\t\t\t $$invalidate(17, localizedOptions = localizeOptions$1(options, locale));\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*localizedOptions, value*/ 131584) {\n\t\t\t $$invalidate(18, selectedLabel = localizedOptions.reduce(\n\t\t\t\t(prev, curr) => {\n\t\t\t\t\tif (prev) return prev;\n\t\t\t\t\tconst [optionValue, optionLabel] = curr;\n\t\t\t\t\tif (isDeepEqual(optionValue, value)) return optionLabel;\n\t\t\t\t},\n\t\t\t\tundefined\n\t\t\t) || getUndefinedOptionLabel());\n\t\t}\n\t};\n\n\treturn [\n\t\tklass,\n\t\ttitle,\n\t\tlabel,\n\t\tlabelClass,\n\t\tinnerClass,\n\t\thideLabel,\n\t\ticon,\n\t\tname,\n\t\tselectedIndex,\n\t\tvalue,\n\t\toptionLabelClass,\n\t\toptionFilter,\n\t\toptionMapper,\n\t\toptionIconStyle,\n\t\toptionLabelStyle,\n\t\tlocale,\n\t\tdropdownVisible,\n\t\tlocalizedOptions,\n\t\tselectedLabel,\n\t\thandleSelect,\n\t\thandleShowPanel,\n\t\thandleKeydown,\n\t\toptions,\n\t\tonchange,\n\t\tdetails_isActive_binding\n\t];\n}\n\nclass Dropdown extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$g, create_fragment$g, safe_not_equal, {\n\t\t\tclass: 0,\n\t\t\ttitle: 1,\n\t\t\tlabel: 2,\n\t\t\tlabelClass: 3,\n\t\t\tinnerClass: 4,\n\t\t\thideLabel: 5,\n\t\t\ticon: 6,\n\t\t\tname: 7,\n\t\t\toptions: 22,\n\t\t\tselectedIndex: 8,\n\t\t\tvalue: 9,\n\t\t\toptionLabelClass: 10,\n\t\t\toptionFilter: 11,\n\t\t\toptionMapper: 12,\n\t\t\toptionIconStyle: 13,\n\t\t\toptionLabelStyle: 14,\n\t\t\tonchange: 23,\n\t\t\tlocale: 15\n\t\t});\n\t}\n}\n\n/* src/core/ui/components/Slider.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$h(ctx) {\n\tlet div3;\n\tlet input_1;\n\tlet nudgeable_action;\n\tlet t0;\n\tlet div0;\n\tlet t1;\n\tlet div2;\n\tlet div1;\n\tlet div2_style_value;\n\tlet div3_class_value;\n\tlet mounted;\n\tlet dispose;\n\n\treturn {\n\t\tc() {\n\t\t\tdiv3 = element(\"div\");\n\t\t\tinput_1 = element(\"input\");\n\t\t\tt0 = space();\n\t\t\tdiv0 = element(\"div\");\n\t\t\tt1 = space();\n\t\t\tdiv2 = element(\"div\");\n\t\t\tdiv1 = element(\"div\");\n\t\t\tattr(input_1, \"type\", \"range\");\n\t\t\tattr(input_1, \"id\", /*id*/ ctx[4]);\n\t\t\tattr(input_1, \"min\", /*min*/ ctx[1]);\n\t\t\tattr(input_1, \"max\", /*max*/ ctx[2]);\n\t\t\tattr(input_1, \"step\", /*step*/ ctx[3]);\n\t\t\tinput_1.value = /*value*/ ctx[0];\n\t\t\tattr(div0, \"class\", \"DokaSliderTrack\");\n\t\t\tattr(div0, \"style\", /*trackStyle*/ ctx[5]);\n\t\t\tattr(div1, \"class\", \"DokaSliderKnob\");\n\t\t\tattr(div1, \"style\", /*knobStyle*/ ctx[6]);\n\t\t\tattr(div2, \"class\", \"DokaSliderKnobController\");\n\t\t\tattr(div2, \"style\", div2_style_value = `transform: translateX(${/*position*/ ctx[9]}%)`);\n\t\t\tattr(div3, \"class\", div3_class_value = arrayJoin([\"DokaSlider\", /*klass*/ ctx[7]]));\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div3, anchor);\n\t\t\tappend(div3, input_1);\n\t\t\t/*input_1_binding*/ ctx[14](input_1);\n\t\t\tappend(div3, t0);\n\t\t\tappend(div3, div0);\n\t\t\tappend(div3, t1);\n\t\t\tappend(div3, div2);\n\t\t\tappend(div2, div1);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(input_1, \"pointerdown\", /*handlePointerDown*/ ctx[12]),\n\t\t\t\t\tlisten(input_1, \"input\", /*handleInput*/ ctx[10]),\n\t\t\t\t\tlisten(input_1, \"nudge\", /*handleNudge*/ ctx[11]),\n\t\t\t\t\taction_destroyer(nudgeable_action = nudgeable.call(null, input_1))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*id*/ 16) {\n\t\t\t\tattr(input_1, \"id\", /*id*/ ctx[4]);\n\t\t\t}\n\n\t\t\tif (dirty & /*min*/ 2) {\n\t\t\t\tattr(input_1, \"min\", /*min*/ ctx[1]);\n\t\t\t}\n\n\t\t\tif (dirty & /*max*/ 4) {\n\t\t\t\tattr(input_1, \"max\", /*max*/ ctx[2]);\n\t\t\t}\n\n\t\t\tif (dirty & /*step*/ 8) {\n\t\t\t\tattr(input_1, \"step\", /*step*/ ctx[3]);\n\t\t\t}\n\n\t\t\tif (dirty & /*value*/ 1) {\n\t\t\t\tinput_1.value = /*value*/ ctx[0];\n\t\t\t}\n\n\t\t\tif (dirty & /*trackStyle*/ 32) {\n\t\t\t\tattr(div0, \"style\", /*trackStyle*/ ctx[5]);\n\t\t\t}\n\n\t\t\tif (dirty & /*knobStyle*/ 64) {\n\t\t\t\tattr(div1, \"style\", /*knobStyle*/ ctx[6]);\n\t\t\t}\n\n\t\t\tif (dirty & /*position*/ 512 && div2_style_value !== (div2_style_value = `transform: translateX(${/*position*/ ctx[9]}%)`)) {\n\t\t\t\tattr(div2, \"style\", div2_style_value);\n\t\t\t}\n\n\t\t\tif (dirty & /*klass*/ 128 && div3_class_value !== (div3_class_value = arrayJoin([\"DokaSlider\", /*klass*/ ctx[7]]))) {\n\t\t\t\tattr(div3, \"class\", div3_class_value);\n\t\t\t}\n\t\t},\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div3);\n\t\t\t/*input_1_binding*/ ctx[14](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance$h($$self, $$props, $$invalidate) {\n\tlet { min = 0 } = $$props;\n\tlet { max = 100 } = $$props;\n\tlet { step = 1 } = $$props;\n\tlet { id = undefined } = $$props;\n\tlet { value = 0 } = $$props;\n\tlet { trackStyle = undefined } = $$props;\n\tlet { knobStyle = undefined } = $$props;\n\tlet { onchange = undefined } = $$props;\n\tlet { class: klass = undefined } = $$props;\n\tlet input;\n\tlet inputWidth;\n\tlet inputOffsetX;\n\tlet pageOffsetX;\n\n\tconst setValueByOffsetX = (offsetX, inputWidth) => {\n\t\t$$invalidate(0, value = clamp(min + offsetX / inputWidth * range, min, max));\n\t\tonchange(value);\n\t};\n\n\tconst handleInput = e => {\n\t\t// already handled by pointer events\n\t\tif (inputWidth) return;\n\n\t\t$$invalidate(0, value = parseFloat(e.target.value));\n\t\tonchange(value);\n\t};\n\n\tconst handleNudge = e => {\n\t\tconst width = input.offsetWidth;\n\t\tconst offset = value / range * width;\n\t\tsetValueByOffsetX(offset + e.detail.x, width);\n\t};\n\n\tconst handlePointerDown = e => {\n\t\te.stopPropagation();\n\t\tinputWidth = input.offsetWidth;\n\t\tinputOffsetX = e.offsetX;\n\t\tpageOffsetX = e.pageX;\n\t\tsetValueByOffsetX(inputOffsetX, inputWidth);\n\t\tdocument.documentElement.addEventListener(\"pointermove\", handlePointerMove);\n\t\tdocument.documentElement.addEventListener(\"pointerup\", handlePointerUp);\n\t};\n\n\tconst handlePointerMove = e => {\n\t\tconst dx = e.pageX - pageOffsetX;\n\t\tsetValueByOffsetX(inputOffsetX + dx, inputWidth);\n\t};\n\n\tconst handlePointerUp = e => {\n\t\tinputWidth = undefined;\n\t\tdocument.documentElement.removeEventListener(\"pointermove\", handlePointerMove);\n\t\tdocument.documentElement.removeEventListener(\"pointerup\", handlePointerUp);\n\t\tonchange(value);\n\t};\n\n\tfunction input_1_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tinput = $$value;\n\t\t\t$$invalidate(8, input);\n\t\t});\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"min\" in $$props) $$invalidate(1, min = $$props.min);\n\t\tif (\"max\" in $$props) $$invalidate(2, max = $$props.max);\n\t\tif (\"step\" in $$props) $$invalidate(3, step = $$props.step);\n\t\tif (\"id\" in $$props) $$invalidate(4, id = $$props.id);\n\t\tif (\"value\" in $$props) $$invalidate(0, value = $$props.value);\n\t\tif (\"trackStyle\" in $$props) $$invalidate(5, trackStyle = $$props.trackStyle);\n\t\tif (\"knobStyle\" in $$props) $$invalidate(6, knobStyle = $$props.knobStyle);\n\t\tif (\"onchange\" in $$props) $$invalidate(13, onchange = $$props.onchange);\n\t\tif (\"class\" in $$props) $$invalidate(7, klass = $$props.class);\n\t};\n\n\tlet range;\n\tlet position;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*max, min*/ 6) {\n\t\t\t $$invalidate(18, range = max - min);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*value, range*/ 262145) {\n\t\t\t $$invalidate(9, position = value / range * 100);\n\t\t}\n\t};\n\n\treturn [\n\t\tvalue,\n\t\tmin,\n\t\tmax,\n\t\tstep,\n\t\tid,\n\t\ttrackStyle,\n\t\tknobStyle,\n\t\tklass,\n\t\tinput,\n\t\tposition,\n\t\thandleInput,\n\t\thandleNudge,\n\t\thandlePointerDown,\n\t\tonchange,\n\t\tinput_1_binding\n\t];\n}\n\nclass Slider extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$h, create_fragment$h, safe_not_equal, {\n\t\t\tmin: 1,\n\t\t\tmax: 2,\n\t\t\tstep: 3,\n\t\t\tid: 4,\n\t\t\tvalue: 0,\n\t\t\ttrackStyle: 5,\n\t\t\tknobStyle: 6,\n\t\t\tonchange: 13,\n\t\t\tclass: 7\n\t\t});\n\t}\n}\n\nvar RGBToHSV = (r, g, b) => {\n    let v = Math.max(r, g, b), n = v - Math.min(r, g, b);\n    let h = n && (v == r ? (g - b) / n : v == g ? 2 + (b - r) / n : 4 + (r - g) / n);\n    return [(60 * (h < 0 ? h + 6 : h)) / 360, v && n / v, v];\n};\n\nvar HSVToRGB = (h, s, v) => {\n    let r, g, b;\n    const i = Math.floor(h * 6);\n    const f = h * 6 - i;\n    const p = v * (1 - s);\n    const q = v * (1 - f * s);\n    const t = v * (1 - (1 - f) * s);\n    switch (i % 6) {\n        case 0:\n            (r = v), (g = t), (b = p);\n            break;\n        case 1:\n            (r = q), (g = v), (b = p);\n            break;\n        case 2:\n            (r = p), (g = v), (b = t);\n            break;\n        case 3:\n            (r = p), (g = q), (b = v);\n            break;\n        case 4:\n            (r = t), (g = p), (b = v);\n            break;\n        case 5:\n            (r = v), (g = p), (b = q);\n            break;\n    }\n    return [r, g, b];\n};\n\n/* src/core/ui/components/ColorPreview.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$i(ctx) {\n\tlet div;\n\tlet span;\n\tlet div_style_value;\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tspan = element(\"span\");\n\t\t\tattr(div, \"class\", \"DokaColorPreview\");\n\t\t\tattr(div, \"title\", /*title*/ ctx[0]);\n\t\t\tattr(div, \"style\", div_style_value = `--color:${/*colorValue*/ ctx[1]}`);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tappend(div, span);\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*title*/ 1) {\n\t\t\t\tattr(div, \"title\", /*title*/ ctx[0]);\n\t\t\t}\n\n\t\t\tif (dirty & /*colorValue*/ 2 && div_style_value !== (div_style_value = `--color:${/*colorValue*/ ctx[1]}`)) {\n\t\t\t\tattr(div, \"style\", div_style_value);\n\t\t\t}\n\t\t},\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t}\n\t};\n}\n\nfunction instance$i($$self, $$props, $$invalidate) {\n\tlet { color = undefined } = $$props;\n\tlet { title = undefined } = $$props;\n\n\t$$self.$$set = $$props => {\n\t\tif (\"color\" in $$props) $$invalidate(2, color = $$props.color);\n\t\tif (\"title\" in $$props) $$invalidate(0, title = $$props.title);\n\t};\n\n\tlet colorValue;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*color*/ 4) {\n\t\t\t $$invalidate(1, colorValue = color ? colorArrayToRGBA(color) : \"transparent\");\n\t\t}\n\t};\n\n\treturn [title, colorValue, color];\n}\n\nclass ColorPreview extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$i, create_fragment$i, safe_not_equal, { color: 2, title: 0 });\n\t}\n}\n\n/* src/core/ui/components/ColorPicker.svelte generated by Svelte v3.29.4 */\n\nfunction create_if_block_4$2(ctx) {\n\tlet span;\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(/*label*/ ctx[0]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*label*/ 1) set_data(t, /*label*/ ctx[0]);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (312:4) <span slot=\"label\" class=\"DokaButtonLabel\">\nfunction create_label_slot$1(ctx) {\n\tlet span;\n\tlet colorpreview;\n\tlet t;\n\tlet current;\n\n\tcolorpreview = new ColorPreview({\n\t\t\tprops: {\n\t\t\t\tcolor: /*value*/ ctx[4],\n\t\t\t\ttitle: localize(/*title*/ ctx[8], /*locale*/ ctx[10])\n\t\t\t}\n\t\t});\n\n\tlet if_block = !/*hidePresetLabel*/ ctx[9] && create_if_block_4$2(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tcreate_component(colorpreview.$$.fragment);\n\t\t\tt = space();\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(span, \"slot\", \"label\");\n\t\t\tattr(span, \"class\", \"DokaButtonLabel\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tmount_component(colorpreview, span, null);\n\t\t\tappend(span, t);\n\t\t\tif (if_block) if_block.m(span, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst colorpreview_changes = {};\n\t\t\tif (dirty[0] & /*value*/ 16) colorpreview_changes.color = /*value*/ ctx[4];\n\t\t\tif (dirty[0] & /*title, locale*/ 1280) colorpreview_changes.title = localize(/*title*/ ctx[8], /*locale*/ ctx[10]);\n\t\t\tcolorpreview.$set(colorpreview_changes);\n\n\t\t\tif (!/*hidePresetLabel*/ ctx[9]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_4$2(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\tif_block.m(span, null);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tif_block.d(1);\n\t\t\t\tif_block = null;\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(colorpreview.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(colorpreview.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t\tdestroy_component(colorpreview);\n\t\t\tif (if_block) if_block.d();\n\t\t}\n\t};\n}\n\n// (324:8) {#if enablePicker}\nfunction create_if_block_2$3(ctx) {\n\tlet div3;\n\tlet div2;\n\tlet div1;\n\tlet div0;\n\tlet div0_style_value;\n\tlet nudgeable_action;\n\tlet div1_style_value;\n\tlet div2_style_value;\n\tlet t0;\n\tlet slider;\n\tlet t1;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\tslider = new Slider({\n\t\t\tprops: {\n\t\t\t\tclass: \"DokaHuePicker\",\n\t\t\t\tknobStyle: `background-color:${/*valueAsRGBAFullySaturated*/ ctx[19]}`,\n\t\t\t\tonchange: /*updateHue*/ ctx[24],\n\t\t\t\tvalue: /*hue*/ ctx[14],\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 1,\n\t\t\t\tstep: 0.001\n\t\t\t}\n\t\t});\n\n\tlet if_block = /*enableOpacity*/ ctx[11] && create_if_block_3$2(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv3 = element(\"div\");\n\t\t\tdiv2 = element(\"div\");\n\t\t\tdiv1 = element(\"div\");\n\t\t\tdiv0 = element(\"div\");\n\t\t\tt0 = space();\n\t\t\tcreate_component(slider.$$.fragment);\n\t\t\tt1 = space();\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(div0, \"role\", \"button\");\n\t\t\tattr(div0, \"class\", \"DokaPickerKnob\");\n\t\t\tattr(div0, \"tabindex\", \"0\");\n\t\t\tattr(div0, \"style\", div0_style_value = `background-color:${/*valueAsRGBAFullyOpaque*/ ctx[18]};`);\n\t\t\tattr(div1, \"class\", \"DokaPickerKnobController\");\n\t\t\tattr(div1, \"style\", div1_style_value = `transform:translate(${/*sx*/ ctx[21]}%,${/*sy*/ ctx[22]}%)`);\n\t\t\tattr(div2, \"class\", \"DokaSaturationPicker\");\n\t\t\tattr(div2, \"style\", div2_style_value = `background-color: ${/*valueAsRGBAFullySaturated*/ ctx[19]}`);\n\t\t\tattr(div3, \"class\", \"DokaPicker\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div3, anchor);\n\t\t\tappend(div3, div2);\n\t\t\tappend(div2, div1);\n\t\t\tappend(div1, div0);\n\t\t\t/*div2_binding*/ ctx[29](div2);\n\t\t\tappend(div3, t0);\n\t\t\tmount_component(slider, div3, null);\n\t\t\tappend(div3, t1);\n\t\t\tif (if_block) if_block.m(div3, null);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div0, \"nudge\", /*handleNudge*/ ctx[27]),\n\t\t\t\t\taction_destroyer(nudgeable_action = nudgeable.call(null, div0)),\n\t\t\t\t\tlisten(div2, \"pointerdown\", /*handlePointerDown*/ ctx[26])\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (!current || dirty[0] & /*valueAsRGBAFullyOpaque*/ 262144 && div0_style_value !== (div0_style_value = `background-color:${/*valueAsRGBAFullyOpaque*/ ctx[18]};`)) {\n\t\t\t\tattr(div0, \"style\", div0_style_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*sx, sy*/ 6291456 && div1_style_value !== (div1_style_value = `transform:translate(${/*sx*/ ctx[21]}%,${/*sy*/ ctx[22]}%)`)) {\n\t\t\t\tattr(div1, \"style\", div1_style_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*valueAsRGBAFullySaturated*/ 524288 && div2_style_value !== (div2_style_value = `background-color: ${/*valueAsRGBAFullySaturated*/ ctx[19]}`)) {\n\t\t\t\tattr(div2, \"style\", div2_style_value);\n\t\t\t}\n\n\t\t\tconst slider_changes = {};\n\t\t\tif (dirty[0] & /*valueAsRGBAFullySaturated*/ 524288) slider_changes.knobStyle = `background-color:${/*valueAsRGBAFullySaturated*/ ctx[19]}`;\n\t\t\tif (dirty[0] & /*hue*/ 16384) slider_changes.value = /*hue*/ ctx[14];\n\t\t\tslider.$set(slider_changes);\n\n\t\t\tif (/*enableOpacity*/ ctx[11]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*enableOpacity*/ 2048) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_3$2(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div3, null);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(slider.$$.fragment, local);\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(slider.$$.fragment, local);\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div3);\n\t\t\t/*div2_binding*/ ctx[29](null);\n\t\t\tdestroy_component(slider);\n\t\t\tif (if_block) if_block.d();\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\n// (344:12) {#if enableOpacity}\nfunction create_if_block_3$2(ctx) {\n\tlet slider;\n\tlet current;\n\n\tslider = new Slider({\n\t\t\tprops: {\n\t\t\t\tclass: \"DokaOpacityPicker\",\n\t\t\t\tknobStyle: `background-color: ${/*valueAsRGBA*/ ctx[16]}`,\n\t\t\t\ttrackStyle: `background-image: linear-gradient(to right, ${/*valueAsRGBAFullyTransparent*/ ctx[17]}, ${/*valueAsRGBAFullyOpaque*/ ctx[18]})`,\n\t\t\t\tonchange: /*updateOpacity*/ ctx[25],\n\t\t\t\tvalue: /*opacity*/ ctx[15],\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 1,\n\t\t\t\tstep: 0.001\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(slider.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(slider, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst slider_changes = {};\n\t\t\tif (dirty[0] & /*valueAsRGBA*/ 65536) slider_changes.knobStyle = `background-color: ${/*valueAsRGBA*/ ctx[16]}`;\n\t\t\tif (dirty[0] & /*valueAsRGBAFullyTransparent, valueAsRGBAFullyOpaque*/ 393216) slider_changes.trackStyle = `background-image: linear-gradient(to right, ${/*valueAsRGBAFullyTransparent*/ ctx[17]}, ${/*valueAsRGBAFullyOpaque*/ ctx[18]})`;\n\t\t\tif (dirty[0] & /*opacity*/ 32768) slider_changes.value = /*opacity*/ ctx[15];\n\t\t\tslider.$set(slider_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(slider.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(slider.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(slider, detaching);\n\t\t}\n\t};\n}\n\n// (357:8) {#if enablePresets}\nfunction create_if_block$4(ctx) {\n\tlet radiogroup;\n\tlet current;\n\n\tradiogroup = new RadioGroup({\n\t\t\tprops: {\n\t\t\t\tlabel: \"Presets\",\n\t\t\t\tclass: arrayJoin([\n\t\t\t\t\t\"DokaColorPresets\",\n\t\t\t\t\t/*hidePresetLabel*/ ctx[9]\n\t\t\t\t\t? \"DokaColorPresetsGrid\"\n\t\t\t\t\t: \"DokaColorPresetsList\"\n\t\t\t\t]),\n\t\t\t\thideLabel: false,\n\t\t\t\tname: /*name*/ ctx[1],\n\t\t\t\tvalue: /*value*/ ctx[4],\n\t\t\t\toptionGroupClass: \"DokaDropdownOptionGroup\",\n\t\t\t\toptionClass: \"DokaDropdownOption\",\n\t\t\t\toptions: /*options*/ ctx[2].map(/*func*/ ctx[30]),\n\t\t\t\tselectedIndex: /*selectedIndex*/ ctx[3],\n\t\t\t\toptionMapper: /*optionMapper*/ ctx[7],\n\t\t\t\toptionLabelClass: /*optionLabelClass*/ ctx[6],\n\t\t\t\tonchange: /*func_1*/ ctx[31],\n\t\t\t\t$$slots: {\n\t\t\t\t\tdefault: [\n\t\t\t\t\t\tcreate_default_slot_1$3,\n\t\t\t\t\t\t({ option }) => ({ 44: option }),\n\t\t\t\t\t\t({ option }) => [0, option ? 8192 : 0]\n\t\t\t\t\t],\n\t\t\t\t\toption: [\n\t\t\t\t\t\tcreate_option_slot$1,\n\t\t\t\t\t\t({ option }) => ({ 44: option }),\n\t\t\t\t\t\t({ option }) => [0, option ? 8192 : 0]\n\t\t\t\t\t],\n\t\t\t\t\tgroup: [\n\t\t\t\t\t\tcreate_group_slot$1,\n\t\t\t\t\t\t({ option }) => ({ 44: option }),\n\t\t\t\t\t\t({ option }) => [0, option ? 8192 : 0]\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(radiogroup.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(radiogroup, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst radiogroup_changes = {};\n\n\t\t\tif (dirty[0] & /*hidePresetLabel*/ 512) radiogroup_changes.class = arrayJoin([\n\t\t\t\t\"DokaColorPresets\",\n\t\t\t\t/*hidePresetLabel*/ ctx[9]\n\t\t\t\t? \"DokaColorPresetsGrid\"\n\t\t\t\t: \"DokaColorPresetsList\"\n\t\t\t]);\n\n\t\t\tif (dirty[0] & /*name*/ 2) radiogroup_changes.name = /*name*/ ctx[1];\n\t\t\tif (dirty[0] & /*value*/ 16) radiogroup_changes.value = /*value*/ ctx[4];\n\t\t\tif (dirty[0] & /*options, locale*/ 1028) radiogroup_changes.options = /*options*/ ctx[2].map(/*func*/ ctx[30]);\n\t\t\tif (dirty[0] & /*selectedIndex*/ 8) radiogroup_changes.selectedIndex = /*selectedIndex*/ ctx[3];\n\t\t\tif (dirty[0] & /*optionMapper*/ 128) radiogroup_changes.optionMapper = /*optionMapper*/ ctx[7];\n\t\t\tif (dirty[0] & /*optionLabelClass*/ 64) radiogroup_changes.optionLabelClass = /*optionLabelClass*/ ctx[6];\n\n\t\t\tif (dirty[0] & /*hidePresetLabel*/ 512 | dirty[1] & /*$$scope, option*/ 24576) {\n\t\t\t\tradiogroup_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tradiogroup.$set(radiogroup_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(radiogroup.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(radiogroup.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(radiogroup, detaching);\n\t\t}\n\t};\n}\n\n// (373:12) <span slot=\"group\">\nfunction create_group_slot$1(ctx) {\n\tlet span;\n\tlet t_value = /*option*/ ctx[44].label + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t\tattr(span, \"slot\", \"group\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[1] & /*option*/ 8192 && t_value !== (t_value = /*option*/ ctx[44].label + \"\")) set_data(t, t_value);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (378:16) {#if !hidePresetLabel}\nfunction create_if_block_1$5(ctx) {\n\tlet span;\n\tlet t_value = /*option*/ ctx[44].label + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t\tattr(span, \"class\", \"DokaButtonLabel\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[1] & /*option*/ 8192 && t_value !== (t_value = /*option*/ ctx[44].label + \"\")) set_data(t, t_value);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (376:12) <span slot=\"option\">\nfunction create_option_slot$1(ctx) {\n\tlet span;\n\tlet colorpreview;\n\tlet t;\n\tlet current;\n\n\tcolorpreview = new ColorPreview({\n\t\t\tprops: {\n\t\t\t\ttitle: /*option*/ ctx[44].label,\n\t\t\t\tcolor: /*option*/ ctx[44].value\n\t\t\t}\n\t\t});\n\n\tlet if_block = !/*hidePresetLabel*/ ctx[9] && create_if_block_1$5(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tcreate_component(colorpreview.$$.fragment);\n\t\t\tt = space();\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(span, \"slot\", \"option\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tmount_component(colorpreview, span, null);\n\t\t\tappend(span, t);\n\t\t\tif (if_block) if_block.m(span, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst colorpreview_changes = {};\n\t\t\tif (dirty[1] & /*option*/ 8192) colorpreview_changes.title = /*option*/ ctx[44].label;\n\t\t\tif (dirty[1] & /*option*/ 8192) colorpreview_changes.color = /*option*/ ctx[44].value;\n\t\t\tcolorpreview.$set(colorpreview_changes);\n\n\t\t\tif (!/*hidePresetLabel*/ ctx[9]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_1$5(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\tif_block.m(span, null);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tif_block.d(1);\n\t\t\t\tif_block = null;\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(colorpreview.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(colorpreview.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t\tdestroy_component(colorpreview);\n\t\t\tif (if_block) if_block.d();\n\t\t}\n\t};\n}\n\n// (359:8) <RadioGroup              label=\"Presets\"             class={arrayJoin(['DokaColorPresets', hidePresetLabel ? 'DokaColorPresetsGrid' : 'DokaColorPresetsList'])}             hideLabel={false}             {name}             {value}             optionGroupClass=\"DokaDropdownOptionGroup\"             optionClass=\"DokaDropdownOption\"             options={options.map(([color, label]) => [color, isFunction(label) ? label(locale) : label])}             {selectedIndex}             {optionMapper}             {optionLabelClass}             onchange={(detail) => updateColorArray(detail.value)}             let:option>\nfunction create_default_slot_1$3(ctx) {\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tt = space();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, t, anchor);\n\t\t},\n\t\tp: noop$1,\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(t);\n\t\t}\n\t};\n}\n\n// (321:4) <div slot=\"details\" class=\"DokaColorPickerPanel\">\nfunction create_details_slot$1(ctx) {\n\tlet div;\n\tlet t;\n\tlet current;\n\tlet if_block0 = /*enablePicker*/ ctx[13] && create_if_block_2$3(ctx);\n\tlet if_block1 = /*enablePresets*/ ctx[12] && create_if_block$4(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tattr(div, \"slot\", \"details\");\n\t\t\tattr(div, \"class\", \"DokaColorPickerPanel\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tif (if_block0) if_block0.m(div, null);\n\t\t\tappend(div, t);\n\t\t\tif (if_block1) if_block1.m(div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*enablePicker*/ ctx[13]) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*enablePicker*/ 8192) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_2$3(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(div, t);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (/*enablePresets*/ ctx[12]) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*enablePresets*/ 4096) {\n\t\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block$4(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\tif_block1.m(div, null);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block1, 1, 1, () => {\n\t\t\t\t\tif_block1 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\ttransition_in(if_block1);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\ttransition_out(if_block1);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (if_block0) if_block0.d();\n\t\t\tif (if_block1) if_block1.d();\n\t\t}\n\t};\n}\n\n// (310:0) <Details buttonClass={arrayJoin(['DokaColorPickerButton', buttonClass])}>\nfunction create_default_slot$5(ctx) {\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tt = space();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, t, anchor);\n\t\t},\n\t\tp: noop$1,\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(t);\n\t\t}\n\t};\n}\n\nfunction create_fragment$j(ctx) {\n\tlet details;\n\tlet current;\n\n\tdetails = new Details({\n\t\t\tprops: {\n\t\t\t\tbuttonClass: arrayJoin([\"DokaColorPickerButton\", /*buttonClass*/ ctx[5]]),\n\t\t\t\t$$slots: {\n\t\t\t\t\tdefault: [create_default_slot$5],\n\t\t\t\t\tdetails: [create_details_slot$1],\n\t\t\t\t\tlabel: [create_label_slot$1]\n\t\t\t\t},\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(details.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(details, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst details_changes = {};\n\t\t\tif (dirty[0] & /*buttonClass*/ 32) details_changes.buttonClass = arrayJoin([\"DokaColorPickerButton\", /*buttonClass*/ ctx[5]]);\n\n\t\t\tif (dirty[0] & /*hidePresetLabel, name, value, options, locale, selectedIndex, optionMapper, optionLabelClass, enablePresets, valueAsRGBA, valueAsRGBAFullyTransparent, valueAsRGBAFullyOpaque, opacity, enableOpacity, valueAsRGBAFullySaturated, hue, input, sx, sy, enablePicker, label, title*/ 8388575 | dirty[1] & /*$$scope*/ 16384) {\n\t\t\t\tdetails_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tdetails.$set(details_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(details.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(details.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(details, detaching);\n\t\t}\n\t};\n}\n\nfunction instance$j($$self, $$props, $$invalidate) {\n\tlet { label = undefined } = $$props;\n\tlet { name = undefined } = $$props;\n\tlet { options = [] } = $$props;\n\tlet { selectedIndex = -1 } = $$props;\n\tlet { value = undefined } = $$props;\n\tlet { buttonClass = undefined } = $$props;\n\tlet { optionLabelClass = undefined } = $$props;\n\tlet { optionMapper = undefined } = $$props;\n\tlet { onchange = undefined } = $$props;\n\tlet { title = undefined } = $$props;\n\tlet { hidePresetLabel = true } = $$props;\n\tlet { locale = undefined } = $$props;\n\tlet { enableOpacity = true } = $$props;\n\tlet { enablePresets = true } = $$props;\n\tlet { enablePicker = true } = $$props;\n\n\t// inputs\n\tlet hue;\n\n\tlet saturation;\n\tlet brightness;\n\tlet opacity;\n\n\t// shortcuts\n\tlet valueAsRGB;\n\n\tlet valueAsRGBA;\n\tlet valueAsRGBAFullyTransparent;\n\tlet valueAsRGBAFullyOpaque;\n\tlet valueAsRGBAFullySaturated;\n\n\tconst updateProps = (color, syncControls) => {\n\t\tvalueAsRGB = [color[0], color[1], color[2]];\n\n\t\tif (syncControls) {\n\t\t\tlet valueAsHSV = RGBToHSV(...valueAsRGB);\n\t\t\t$$invalidate(14, hue = valueAsHSV[0]);\n\t\t\t$$invalidate(32, saturation = valueAsHSV[1]);\n\t\t\t$$invalidate(33, brightness = valueAsHSV[2]);\n\t\t\t$$invalidate(15, opacity = isNumber(color[3]) ? color[3] : 1);\n\t\t}\n\n\t\t$$invalidate(16, valueAsRGBA = colorArrayToRGBA(color));\n\t\t$$invalidate(17, valueAsRGBAFullyTransparent = colorArrayToRGBA([...valueAsRGB, 0]));\n\t\t$$invalidate(18, valueAsRGBAFullyOpaque = colorArrayToRGBA([...valueAsRGB, 1]));\n\t\t$$invalidate(19, valueAsRGBAFullySaturated = colorArrayToRGBA(HSVToRGB(hue, 1, 1)));\n\t};\n\n\tvalue && updateProps(value, true);\n\n\tconst update = () => {\n\t\tconst rgb = HSVToRGB(hue, saturation, brightness);\n\t\tconst rgba = [...rgb, opacity];\n\t\tupdateProps(rgba);\n\t\tonchange(rgba);\n\t};\n\n\tconst updateColorArray = arr => {\n\t\tconst rgba = arr.length === 3 ? [...arr, 1] : arr;\n\t\tupdateProps(rgba, true);\n\t\tonchange(rgba);\n\t};\n\n\tconst updateHue = h => {\n\t\t$$invalidate(14, hue = h);\n\t\tif (opacity === 0) $$invalidate(15, opacity = 1);\n\t\tupdate();\n\t};\n\n\tconst updateSaturationAndBrightness = (s, b) => {\n\t\t$$invalidate(32, saturation = s);\n\t\t$$invalidate(33, brightness = b);\n\t\tif (opacity === 0) $$invalidate(15, opacity = 1);\n\t\tupdate();\n\t};\n\n\tconst updateOpacity = o => {\n\t\t$$invalidate(15, opacity = o);\n\t\tupdate();\n\t};\n\n\tconst setValueByOffset = (offset, inputSize) => {\n\t\tconst x = clamp(offset.x / inputSize.width, 0, 1);\n\t\tconst y = clamp(offset.y / inputSize.height, 0, 1);\n\t\tupdateSaturationAndBrightness(x, 1 - y);\n\t};\n\n\tlet input;\n\tlet inputSize;\n\tlet inputOffset;\n\tlet inputPageOffset;\n\n\tconst handlePointerDown = e => {\n\t\te.stopPropagation();\n\t\tinputSize = sizeCreate(input.offsetWidth, input.offsetHeight);\n\t\tinputOffset = vectorCreateFromPointerEventOffset(e);\n\t\tinputPageOffset = vectorCreateFromPointerEvent(e);\n\t\tsetValueByOffset(inputOffset, inputSize);\n\t\tdocument.documentElement.addEventListener(\"pointermove\", handlePointerMove);\n\t\tdocument.documentElement.addEventListener(\"pointerup\", handlePointerUp);\n\t};\n\n\tconst handlePointerMove = e => {\n\t\tconst d = vectorSubtract(vectorCreateFromPointerEvent(e), inputPageOffset);\n\t\tsetValueByOffset(vectorAdd(vectorClone(inputOffset), d), inputSize);\n\t};\n\n\tconst handlePointerUp = e => {\n\t\tinputSize = undefined;\n\t\tdocument.documentElement.removeEventListener(\"pointermove\", handlePointerMove);\n\t\tdocument.documentElement.removeEventListener(\"pointerup\", handlePointerUp);\n\t};\n\n\tconst handleNudge = e => {\n\t\tinputSize = sizeCreate(input.offsetWidth, input.offsetHeight);\n\t\tconst x = sx / 100 * inputSize.width;\n\t\tconst y = sy / 100 * inputSize.height;\n\t\tsetValueByOffset({ x: x + e.detail.x, y: y + e.detail.y }, inputSize);\n\t};\n\n\tfunction div2_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tinput = $$value;\n\t\t\t$$invalidate(20, input);\n\t\t});\n\t}\n\n\tconst func = ([color, label]) => [color, isFunction(label) ? label(locale) : label];\n\tconst func_1 = detail => updateColorArray(detail.value);\n\n\t$$self.$$set = $$props => {\n\t\tif (\"label\" in $$props) $$invalidate(0, label = $$props.label);\n\t\tif (\"name\" in $$props) $$invalidate(1, name = $$props.name);\n\t\tif (\"options\" in $$props) $$invalidate(2, options = $$props.options);\n\t\tif (\"selectedIndex\" in $$props) $$invalidate(3, selectedIndex = $$props.selectedIndex);\n\t\tif (\"value\" in $$props) $$invalidate(4, value = $$props.value);\n\t\tif (\"buttonClass\" in $$props) $$invalidate(5, buttonClass = $$props.buttonClass);\n\t\tif (\"optionLabelClass\" in $$props) $$invalidate(6, optionLabelClass = $$props.optionLabelClass);\n\t\tif (\"optionMapper\" in $$props) $$invalidate(7, optionMapper = $$props.optionMapper);\n\t\tif (\"onchange\" in $$props) $$invalidate(28, onchange = $$props.onchange);\n\t\tif (\"title\" in $$props) $$invalidate(8, title = $$props.title);\n\t\tif (\"hidePresetLabel\" in $$props) $$invalidate(9, hidePresetLabel = $$props.hidePresetLabel);\n\t\tif (\"locale\" in $$props) $$invalidate(10, locale = $$props.locale);\n\t\tif (\"enableOpacity\" in $$props) $$invalidate(11, enableOpacity = $$props.enableOpacity);\n\t\tif (\"enablePresets\" in $$props) $$invalidate(12, enablePresets = $$props.enablePresets);\n\t\tif (\"enablePicker\" in $$props) $$invalidate(13, enablePicker = $$props.enablePicker);\n\t};\n\n\tlet sx;\n\tlet sy;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[1] & /*saturation*/ 2) {\n\t\t\t $$invalidate(21, sx = saturation * 100);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*brightness*/ 4) {\n\t\t\t $$invalidate(22, sy = 100 - brightness * 100);\n\t\t}\n\t};\n\n\treturn [\n\t\tlabel,\n\t\tname,\n\t\toptions,\n\t\tselectedIndex,\n\t\tvalue,\n\t\tbuttonClass,\n\t\toptionLabelClass,\n\t\toptionMapper,\n\t\ttitle,\n\t\thidePresetLabel,\n\t\tlocale,\n\t\tenableOpacity,\n\t\tenablePresets,\n\t\tenablePicker,\n\t\thue,\n\t\topacity,\n\t\tvalueAsRGBA,\n\t\tvalueAsRGBAFullyTransparent,\n\t\tvalueAsRGBAFullyOpaque,\n\t\tvalueAsRGBAFullySaturated,\n\t\tinput,\n\t\tsx,\n\t\tsy,\n\t\tupdateColorArray,\n\t\tupdateHue,\n\t\tupdateOpacity,\n\t\thandlePointerDown,\n\t\thandleNudge,\n\t\tonchange,\n\t\tdiv2_binding,\n\t\tfunc,\n\t\tfunc_1\n\t];\n}\n\nclass ColorPicker extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$j,\n\t\t\tcreate_fragment$j,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tlabel: 0,\n\t\t\t\tname: 1,\n\t\t\t\toptions: 2,\n\t\t\t\tselectedIndex: 3,\n\t\t\t\tvalue: 4,\n\t\t\t\tbuttonClass: 5,\n\t\t\t\toptionLabelClass: 6,\n\t\t\t\toptionMapper: 7,\n\t\t\t\tonchange: 28,\n\t\t\t\ttitle: 8,\n\t\t\t\thidePresetLabel: 9,\n\t\t\t\tlocale: 10,\n\t\t\t\tenableOpacity: 11,\n\t\t\t\tenablePresets: 12,\n\t\t\t\tenablePicker: 13\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n}\n\nvar upperCaseFirstLetter = (str) => str.charAt(0).toUpperCase() + str.slice(1);\n\n// @ts-ignore\nconst toLocaleFn = (key, localePrefix) => (locale) => locale[localePrefix ? `${localePrefix}${upperCaseFirstLetter(key)}` : key];\nconst mapToSizeOption = (v) => [v, `${v}`];\nconst createLocaleMapper = (options, localePrefix) => (key) => [\n    options[key],\n    toLocaleFn(key, localePrefix),\n];\nconst toolColorDefault = [1, 0.2549, 0.2118];\nconst toolStrokeColorDefault = [1, 1, 1, 0];\n//#region tools\nconst toolShapeDefaults = {\n    path: () => ({\n        points: [],\n        disableErase: false,\n    }),\n    line: () => ({\n        x1: 0,\n        y1: 0,\n        x2: 0,\n        y2: 0,\n        disableErase: false,\n    }),\n    rectangle: () => ({\n        x: 0,\n        y: 0,\n        width: 0,\n        height: 0,\n    }),\n    ellipse: () => ({\n        x: 0,\n        y: 0,\n        rx: 0,\n        ry: 0,\n    }),\n    text: () => ({\n        x: 0,\n        y: 0,\n        text: 'Text',\n    }),\n};\nconst createToolStyle = (type, shape = {}, options = { position: 'relative' }) => {\n    if (!toolShapeDefaults[type])\n        return;\n    const shapeDef = {\n        ...toolShapeDefaults[type](),\n        ...shape,\n    };\n    return [shapeDef, options];\n};\nconst createToolStyles = (tools) => ({\n    sharpie: createToolStyle('path', {\n        strokeWidth: '0.5%',\n        strokeColor: [...toolColorDefault],\n    }),\n    line: createToolStyle('line', {\n        strokeColor: [...toolColorDefault],\n        strokeWidth: '0.5%',\n    }),\n    arrow: createToolStyle('line', {\n        lineEnd: 'arrow-solid',\n        strokeColor: [...toolColorDefault],\n        strokeWidth: '0.5%',\n    }),\n    rectangle: createToolStyle('rectangle', {\n        strokeColor: [...toolStrokeColorDefault],\n        backgroundColor: [...toolColorDefault],\n    }),\n    ellipse: createToolStyle('ellipse', {\n        strokeColor: [...toolStrokeColorDefault],\n        backgroundColor: [...toolColorDefault],\n    }),\n    text: createToolStyle('text', {\n        color: [...toolColorDefault],\n        fontSize: '2%',\n    }),\n    ...tools,\n});\n//#endregion\n//#region toolbar\nconst createToolbarItem = (tool, label, props) => [\n    tool,\n    label || toLocaleFn(tool, 'shapeLabelTool'),\n    {\n        icon: toLocaleFn(tool, 'shapeIconTool'),\n        ...props,\n    },\n];\nconst createToolbar = (tools = ['sharpie', 'eraser', 'line', 'arrow', 'rectangle', 'ellipse', 'text', 'preset']) => tools\n    .map((tool) => {\n    // default tool definition, assume locale in\n    if (isString(tool))\n        return createToolbarItem(tool);\n    // tool def with propery\n    if (Array.isArray(tool)) {\n        // state update of tool with key in locale object\n        if (isObject(tool[1]))\n            return createToolbarItem(tool[0], undefined, tool[1]);\n        // should be string, string\n        return createToolbarItem(tool[0], tool[1], tool[2]);\n    }\n})\n    .filter(Boolean);\n//#endregion\n//#region style option defaults\nconst createDefaultColorOptions = () => ({\n    transparent: [1, 1, 1, 0],\n    white: [1, 1, 1],\n    silver: [0.8667, 0.8667, 0.8667],\n    gray: [0.6667, 0.6667, 0.6667],\n    black: [0, 0, 0],\n    navy: [0, 0.1216, 0.2471],\n    blue: [0, 0.4549, 0.851],\n    aqua: [0.498, 0.8588, 1],\n    teal: [0.2235, 0.8, 0.8],\n    olive: [0.2392, 0.6, 0.4392],\n    green: [0.1804, 0.8, 0.251],\n    yellow: [1, 0.8627, 0],\n    orange: [1, 0.5216, 0.1059],\n    red: [1, 0.2549, 0.2118],\n    maroon: [0.5216, 0.0784, 0.2941],\n    fuchsia: [0.9412, 0.0706, 0.7451],\n    purple: [0.6941, 0.051, 0.7882],\n});\nconst createDefaultFontSizeOptions = () => [16, 18, 20, 24, 30, 36, 48, 64, 72, 96, 144];\nconst createDefaultFontScaleOptions = () => ({\n    extraSmall: '2%',\n    small: '4%',\n    mediumSmall: '8%',\n    medium: '10%',\n    mediumLarge: '15%',\n    large: '20%',\n    extraLarge: '25%',\n});\nconst createDefaultStrokeWidthOptions = () => [1, 2, 3, 4, 6, 8, 12, 16, 20, 24, 32, 48];\nconst createDefaultStrokeScaleOptions = () => ({\n    extraSmall: '0.25%',\n    small: '0.5%',\n    mediumSmall: '1%',\n    medium: '1.75%',\n    mediumLarge: '2.5%',\n    large: '3.5%',\n    extraLarge: '5%',\n});\nconst createDefaultLineEndStyleOptions = () => [\n    'bar',\n    'arrow',\n    'arrowSolid',\n    'circle',\n    'circleSolid',\n    'square',\n    'squareSolid',\n];\nconst createDefaultFontFamilyOptions = () => [\n    [`Helvetica, Arial, Verdana, 'Droid Sans', sans-serif`, 'Sans Serif'],\n    [`'Arial Black', 'Avenir-Black', 'Arial Bold'`, 'Black'],\n    [`'Arial Narrow', 'Futura-CondensedMedium'`, 'Narrow'],\n    [`'Trebuchet MS'`, 'Humanist'],\n    [`Georgia, 'Avenir-Black', 'Times New Roman', 'Droid Serif', serif`, 'Serif'],\n    [`Palatino`, 'Old-Style'],\n    [`'Times New Roman', 'TimesNewRomanPSMT'`, 'Transitional'],\n    [`Menlo, Monaco, 'Lucida Console', monospace`, 'Monospaced'],\n    [`'Courier New', monospace`, 'Slab Serif'],\n];\nconst createDefaultTextAlignOptions = () => ['left', 'center', 'right'];\nconst createDefaultFontStyleOptions = () => [\n    ['normal', 'bold'],\n    ['italic', 'normal'],\n    ['italic', 'bold'],\n];\n//#endregion\n//#region style options\nconst createColorOptions = (colors) => Object.keys(colors).map(createLocaleMapper(colors, 'shapeTitleColor'));\nconst createFontSizeOptions = (sizes) => sizes.map(mapToSizeOption);\nconst createFontScaleOptions = (scales) => Object.keys(scales).map(createLocaleMapper(scales, 'labelSize'));\nconst createStrokeWidthOptions = (sizes) => sizes.map(mapToSizeOption);\nconst createStrokeScaleOptions = (scales) => Object.keys(scales).map(createLocaleMapper(scales, 'labelSize'));\nconst createFontFamilyOptions = (fonts) => [...fonts];\nconst createFontStyleOptions = (styles) => styles.map((style) => [\n    style,\n    (locale) => locale[`shapeLabelFontStyle${style\n        .filter((v) => v !== 'normal')\n        .map(upperCaseFirstLetter)\n        .join('')}`],\n]);\nconst createLineEndStyleOptions = (styles) => styles.map((style) => [\n    toKebabCase(style),\n    (locale) => locale[`shapeTitleLineDecoration${upperCaseFirstLetter(style)}`],\n    { icon: (locale) => locale[`shapeIconLineDecoration${upperCaseFirstLetter(style)}`] },\n]);\nconst createTextAlignOptions = (options) => options.map((align) => [\n    align,\n    (locale) => locale[`shapeTitleTextAlign${upperCaseFirstLetter(align)}`],\n    {\n        hideLabel: true,\n        icon: (locale) => locale[`shapeIconTextAlign${upperCaseFirstLetter(align)}`],\n    },\n]);\nconst createControlOptions = (items, options) => {\n    const { defaultKey, defaultOptions } = options || {};\n    let arr = [];\n    if (defaultKey)\n        arr[0] = [undefined, (locale) => locale[defaultKey], { ...defaultOptions }];\n    return [...arr, ...items];\n};\n//#endregion\n//#region shape style controls\nconst createFontFamilyControl = (fontFamilies) => [\n    Dropdown,\n    {\n        title: (locale) => locale.shapeTitleFontFamily,\n        optionLabelStyle: (value) => `font-family: ${value}`,\n        options: createControlOptions(fontFamilies, { defaultKey: 'labelDefault' }),\n        optionFilter: (fontFamilyOption) => {\n            // don't filter if not in browser context\n            if (!isBrowser())\n                return true;\n            // get font stack\n            const [stack] = fontFamilyOption;\n            // allow if undefined\n            if (!stack)\n                return true;\n            // filter out fonts that aren't available\n            return stack\n                .split(',')\n                .map((name) => name.trim())\n                .some((name) => {\n                // @ts-ignore\n                return document.fonts.check(`16px ${name}`);\n            });\n        },\n    },\n];\nconst createBackgroundColorControl = (items) => [\n    ColorPicker,\n    {\n        title: (locale) => locale.shapeTitleBackgroundColor,\n        options: createControlOptions(items),\n    },\n];\nconst createStrokeColorControl = (items, options = {}) => [\n    ColorPicker,\n    {\n        title: (locale) => locale.shapeTitleStrokeColor,\n        options: createControlOptions(items),\n        buttonClass: 'DokaColorPickerButtonStroke',\n        onchange: (value, shape) => {\n            // get shape strokeWidth as number\n            let strokeWidth = shape.strokeWidth;\n            let strokeWidthParsed = isNumber(strokeWidth) || isString(strokeWidth) ? parseFloat(strokeWidth) : 0;\n            // already has outline\n            if (strokeWidthParsed > 0)\n                return;\n            // set outline to first stroke width\n            shape.strokeWidth = (options && options.defaultStrokeWidth) || '0.5%';\n        },\n    },\n];\nconst createStrokeWidthControl = (items) => [\n    Dropdown,\n    {\n        title: (locale) => locale.shapeTitleStrokeWidth,\n        options: (shape) => {\n            if (hasProp(shape, 'backgroundColor'))\n                return createControlOptions(items, {\n                    defaultKey: 'shapeLabelStrokeNone',\n                });\n            return createControlOptions(items);\n        },\n    },\n];\nconst createLineControl = (items, titleKey, optionIconStyle) => [\n    Dropdown,\n    {\n        title: (locale) => locale[titleKey],\n        options: createControlOptions(items, {\n            defaultKey: 'labelNone',\n            defaultOptions: {\n                icon: `<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H14\"/></g>`,\n            },\n        }),\n        optionIconStyle,\n    },\n];\nconst createLineStartStyleControl = (items) => createLineControl(items, 'shapeTitleLineStart', `transform: scaleX(-1)`);\nconst createLineEndStyleControl = (items) => createLineControl(items, 'shapeTitleLineEnd');\nconst createFontColorControl = (items) => [\n    ColorPicker,\n    {\n        title: (locale) => locale.shapeTitleTextColor,\n        options: createControlOptions(items),\n    },\n];\nconst createFontStyleControl = (items) => [\n    Dropdown,\n    {\n        title: (locale) => locale.shapeTitleFontStyle,\n        optionLabelStyle: (value) => value && `font-style:${value[0]};font-weight:${value[1]}`,\n        options: createControlOptions(items, {\n            defaultKey: 'shapeLabelFontStyleNormal',\n        }),\n    },\n];\nconst createFontSizeControl = (items) => [\n    Dropdown,\n    {\n        title: (locale) => locale.shapeTitleFontSize,\n        options: createControlOptions(items, { defaultKey: 'labelDefault' }),\n    },\n];\nconst createTextAlignControl = (items) => [\n    RadioGroup,\n    {\n        title: (locale) => locale.shapeTitleTextAlign,\n        options: createControlOptions(items),\n    },\n];\nconst createLineHeightControl = (items) => [\n    Dropdown,\n    {\n        title: (locale) => locale.shapeTitleLineHeight,\n        options: createControlOptions(items, { defaultKey: 'labelAuto' }),\n    },\n];\nconst createShapeStyleControls = (options = {}) => {\n    const { colorOptions = createColorOptions(createDefaultColorOptions()), strokeWidthOptions = createStrokeScaleOptions(createDefaultStrokeScaleOptions()), lineEndStyleOptions = createLineEndStyleOptions(createDefaultLineEndStyleOptions()), fontFamilyOptions = createFontFamilyOptions(createDefaultFontFamilyOptions()), fontStyleOptions = createFontStyleOptions(createDefaultFontStyleOptions()), fontSizeOptions = createFontScaleOptions(createDefaultFontScaleOptions()), textAlignOptions = createTextAlignOptions(createDefaultTextAlignOptions()), } = options;\n    return {\n        // shape background\n        backgroundColor: colorOptions && createBackgroundColorControl(colorOptions),\n        // line/outline\n        strokeColor: colorOptions && createStrokeColorControl(colorOptions),\n        strokeWidth: strokeWidthOptions && createStrokeWidthControl(strokeWidthOptions),\n        // line\n        lineStart: lineEndStyleOptions && createLineStartStyleControl(lineEndStyleOptions),\n        lineEnd: lineEndStyleOptions && createLineEndStyleControl(lineEndStyleOptions),\n        // text\n        color: colorOptions && createFontColorControl(colorOptions),\n        fontFamily: fontFamilyOptions && createFontFamilyControl(fontFamilyOptions),\n        fontStyle_fontWeight: fontStyleOptions && createFontStyleControl(fontStyleOptions),\n        fontSize: fontSizeOptions && createFontSizeControl(fontSizeOptions),\n        textAlign: textAlignOptions && createTextAlignControl(textAlignOptions),\n    };\n};\n//#endregion\n\n/* src/core/ui/components/Measure.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$k(ctx) {\n\tlet div;\n\tlet measurable_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tconst default_slot_template = /*#slots*/ ctx[3].default;\n\tconst default_slot = create_slot(default_slot_template, ctx, /*$$scope*/ ctx[2], null);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (default_slot) default_slot.c();\n\t\t\tattr(div, \"class\", /*klass*/ ctx[0]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (default_slot) {\n\t\t\t\tdefault_slot.m(div, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div, \"measure\", /*handleResize*/ ctx[1]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (default_slot) {\n\t\t\t\tif (default_slot.p && dirty & /*$$scope*/ 4) {\n\t\t\t\t\tupdate_slot(default_slot, default_slot_template, ctx, /*$$scope*/ ctx[2], dirty, null, null);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*klass*/ 1) {\n\t\t\t\tattr(div, \"class\", /*klass*/ ctx[0]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(default_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(default_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (default_slot) default_slot.d(detaching);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance$k($$self, $$props, $$invalidate) {\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tconst dispatch = createEventDispatcher();\n\tlet { class: klass = null } = $$props;\n\tconst handleResize = ({ detail }) => dispatch(\"measure\", detail);\n\n\t$$self.$$set = $$props => {\n\t\tif (\"class\" in $$props) $$invalidate(0, klass = $$props.class);\n\t\tif (\"$$scope\" in $$props) $$invalidate(2, $$scope = $$props.$$scope);\n\t};\n\n\treturn [klass, handleResize, $$scope, slots];\n}\n\nclass Measure extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$k, create_fragment$k, safe_not_equal, { class: 0 });\n\t}\n}\n\n/* src/core/ui/components/Util.svelte generated by Svelte v3.29.4 */\nconst get_footer_slot_changes = dirty => ({});\nconst get_footer_slot_context = ctx => ({});\nconst get_main_slot_changes = dirty => ({});\nconst get_main_slot_context = ctx => ({});\nconst get_header_slot_changes = dirty => ({});\nconst get_header_slot_context = ctx => ({});\n\n// (209:0) {#if hasHeader}\nfunction create_if_block_2$4(ctx) {\n\tlet div;\n\tlet current;\n\tconst header_slot_template = /*#slots*/ ctx[4].header;\n\tconst header_slot = create_slot(header_slot_template, ctx, /*$$scope*/ ctx[3], get_header_slot_context);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (header_slot) header_slot.c();\n\t\t\tattr(div, \"class\", \"DokaUtilHeader\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (header_slot) {\n\t\t\t\theader_slot.m(div, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (header_slot) {\n\t\t\t\tif (header_slot.p && dirty & /*$$scope*/ 8) {\n\t\t\t\t\tupdate_slot(header_slot, header_slot_template, ctx, /*$$scope*/ ctx[3], dirty, get_header_slot_changes, get_header_slot_context);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(header_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(header_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (header_slot) header_slot.d(detaching);\n\t\t}\n\t};\n}\n\n// (216:22) <Measure class=\"DokaStage\" on:measure/>\nfunction fallback_block$2(ctx) {\n\tlet measure;\n\tlet current;\n\tmeasure = new Measure({ props: { class: \"DokaStage\" } });\n\tmeasure.$on(\"measure\", /*measure_handler*/ ctx[5]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(measure.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(measure, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp: noop$1,\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(measure.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(measure.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(measure, detaching);\n\t\t}\n\t};\n}\n\n// (219:0) {#if hasFooter}\nfunction create_if_block_1$6(ctx) {\n\tlet div;\n\tlet current;\n\tconst footer_slot_template = /*#slots*/ ctx[4].footer;\n\tconst footer_slot = create_slot(footer_slot_template, ctx, /*$$scope*/ ctx[3], get_footer_slot_context);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (footer_slot) footer_slot.c();\n\t\t\tattr(div, \"class\", \"DokaUtilFooter\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (footer_slot) {\n\t\t\t\tfooter_slot.m(div, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (footer_slot) {\n\t\t\t\tif (footer_slot.p && dirty & /*$$scope*/ 8) {\n\t\t\t\t\tupdate_slot(footer_slot, footer_slot_template, ctx, /*$$scope*/ ctx[3], dirty, get_footer_slot_changes, get_footer_slot_context);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(footer_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(footer_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (footer_slot) footer_slot.d(detaching);\n\t\t}\n\t};\n}\n\nfunction create_fragment$l(ctx) {\n\tlet t0;\n\tlet div;\n\tlet t1;\n\tlet t2;\n\tlet if_block2_anchor;\n\tlet current;\n\tlet if_block0 = /*hasHeader*/ ctx[1] && create_if_block_2$4(ctx);\n\tconst main_slot_template = /*#slots*/ ctx[4].main;\n\tconst main_slot = create_slot(main_slot_template, ctx, /*$$scope*/ ctx[3], get_main_slot_context);\n\tconst main_slot_or_fallback = main_slot || fallback_block$2(ctx);\n\tlet if_block1 = /*hasFooter*/ ctx[2] && create_if_block_1$6(ctx);\n\tlet if_block2 = false ;\n\n\treturn {\n\t\tc() {\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt0 = space();\n\t\t\tdiv = element(\"div\");\n\t\t\tif (main_slot_or_fallback) main_slot_or_fallback.c();\n\t\t\tt1 = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tt2 = space();\n\t\t\tif_block2_anchor = empty();\n\t\t\tattr(div, \"class\", \"DokaUtilMain\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (if_block0) if_block0.m(target, anchor);\n\t\t\tinsert(target, t0, anchor);\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (main_slot_or_fallback) {\n\t\t\t\tmain_slot_or_fallback.m(div, null);\n\t\t\t}\n\n\t\t\t/*div_binding*/ ctx[6](div);\n\t\t\tinsert(target, t1, anchor);\n\t\t\tif (if_block1) if_block1.m(target, anchor);\n\t\t\tinsert(target, t2, anchor);\n\t\t\tinsert(target, if_block2_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (/*hasHeader*/ ctx[1]) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*hasHeader*/ 2) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_2$4(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(t0.parentNode, t0);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (main_slot) {\n\t\t\t\tif (main_slot.p && dirty & /*$$scope*/ 8) {\n\t\t\t\t\tupdate_slot(main_slot, main_slot_template, ctx, /*$$scope*/ ctx[3], dirty, get_main_slot_changes, get_main_slot_context);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (/*hasFooter*/ ctx[2]) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*hasFooter*/ 4) {\n\t\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block_1$6(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\tif_block1.m(t2.parentNode, t2);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block1, 1, 1, () => {\n\t\t\t\t\tif_block1 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\ttransition_in(main_slot_or_fallback, local);\n\t\t\ttransition_in(if_block1);\n\t\t\ttransition_in(if_block2);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\ttransition_out(main_slot_or_fallback, local);\n\t\t\ttransition_out(if_block1);\n\t\t\ttransition_out(if_block2);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (if_block0) if_block0.d(detaching);\n\t\t\tif (detaching) detach(t0);\n\t\t\tif (detaching) detach(div);\n\t\t\tif (main_slot_or_fallback) main_slot_or_fallback.d(detaching);\n\t\t\t/*div_binding*/ ctx[6](null);\n\t\t\tif (detaching) detach(t1);\n\t\t\tif (if_block1) if_block1.d(detaching);\n\t\t\tif (detaching) detach(t2);\n\t\t\tif (detaching) detach(if_block2_anchor);\n\t\t}\n\t};\n}\n\nfunction instance$l($$self, $$props, $$invalidate) {\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tlet { hasHeader = !!$$props.$$slots.header } = $$props;\n\tlet { hasFooter = !!$$props.$$slots.footer } = $$props;\n\tlet { root = undefined } = $$props;\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\tfunction div_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\troot = $$value;\n\t\t\t$$invalidate(0, root);\n\t\t});\n\t}\n\n\t$$self.$$set = $$new_props => {\n\t\t$$invalidate(7, $$props = assign(assign({}, $$props), exclude_internal_props($$new_props)));\n\t\tif (\"hasHeader\" in $$new_props) $$invalidate(1, hasHeader = $$new_props.hasHeader);\n\t\tif (\"hasFooter\" in $$new_props) $$invalidate(2, hasFooter = $$new_props.hasFooter);\n\t\tif (\"root\" in $$new_props) $$invalidate(0, root = $$new_props.root);\n\t\tif (\"$$scope\" in $$new_props) $$invalidate(3, $$scope = $$new_props.$$scope);\n\t};\n\n\t$$props = exclude_internal_props($$props);\n\treturn [root, hasHeader, hasFooter, $$scope, slots, measure_handler, div_binding];\n}\n\nclass Util extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$l, create_fragment$l, safe_not_equal, { hasHeader: 1, hasFooter: 2, root: 0 });\n\t}\n}\n\nvar toFraction = (value, min, max) => (value - min) / (max - min);\n\n/* src/core/ui/components/RangeInput.svelte generated by Svelte v3.29.4 */\n\nfunction create_if_block$5(ctx) {\n\tlet div;\n\tlet div_style_value;\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tattr(div, \"class\", \"DokaRangeInputMeter\");\n\t\t\tattr(div, \"style\", div_style_value = `transform: translateX(${/*$position*/ ctx[9].x - /*svgPadding*/ ctx[10].x}px) translateY(${/*$position*/ ctx[9].y - /*svgPadding*/ ctx[10].y}px)`);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tdiv.innerHTML = /*svg*/ ctx[6];\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*svg*/ 64) div.innerHTML = /*svg*/ ctx[6];\n\t\t\tif (dirty[0] & /*$position*/ 512 && div_style_value !== (div_style_value = `transform: translateX(${/*$position*/ ctx[9].x - /*svgPadding*/ ctx[10].x}px) translateY(${/*$position*/ ctx[9].y - /*svgPadding*/ ctx[10].y}px)`)) {\n\t\t\t\tattr(div, \"style\", div_style_value);\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t}\n\t};\n}\n\nfunction create_fragment$m(ctx) {\n\tlet div1;\n\tlet span;\n\tlet t0;\n\tlet t1;\n\tlet button;\n\tlet t2;\n\tlet button_disabled_value;\n\tlet t3;\n\tlet div0;\n\tlet interactable_action;\n\tlet measurable_action;\n\tlet nudgeable_action;\n\tlet mounted;\n\tlet dispose;\n\tlet if_block = /*$position*/ ctx[9] && create_if_block$5(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv1 = element(\"div\");\n\t\t\tspan = element(\"span\");\n\t\t\tt0 = text(/*valueLabel*/ ctx[4]);\n\t\t\tt1 = space();\n\t\t\tbutton = element(\"button\");\n\t\t\tt2 = text(/*labelReset*/ ctx[1]);\n\t\t\tt3 = space();\n\t\t\tdiv0 = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(span, \"class\", \"DokaRangeInputValue\");\n\t\t\tattr(button, \"class\", \"DokaRangeInputReset\");\n\t\t\tattr(button, \"type\", \"button\");\n\t\t\tbutton.disabled = button_disabled_value = /*value*/ ctx[0] === /*base*/ ctx[3];\n\t\t\tattr(div0, \"class\", \"DokaRangeInputInner\");\n\t\t\tattr(div0, \"style\", /*rangeMask*/ ctx[8]);\n\t\t\tattr(div0, \"data-value-limited\", /*isLimited*/ ctx[7]);\n\t\t\tattr(div1, \"class\", \"DokaRangeInput\");\n\t\t\tattr(div1, \"tabindex\", \"0\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div1, anchor);\n\t\t\tappend(div1, span);\n\t\t\tappend(span, t0);\n\t\t\tappend(div1, t1);\n\t\t\tappend(div1, button);\n\t\t\tappend(button, t2);\n\t\t\tappend(div1, t3);\n\t\t\tappend(div1, div0);\n\t\t\tif (if_block) if_block.m(div0, null);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(button, \"click\", /*handleReset*/ ctx[15]),\n\t\t\t\t\tlisten(div0, \"interactionstart\", /*handleDragStart*/ ctx[11]),\n\t\t\t\t\tlisten(div0, \"interactionupdate\", /*handleDragMove*/ ctx[13]),\n\t\t\t\t\tlisten(div0, \"interactionend\", /*handleDragEnd*/ ctx[14]),\n\t\t\t\t\tlisten(div0, \"interactionrelease\", /*handleDragRelease*/ ctx[12]),\n\t\t\t\t\taction_destroyer(interactable_action = interactable.call(null, div0, { inertia: true })),\n\t\t\t\t\tlisten(div0, \"measure\", /*measure_handler*/ ctx[27]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div0)),\n\t\t\t\t\tlisten(div1, \"wheel\", /*handleWheel*/ ctx[17]),\n\t\t\t\t\tlisten(div1, \"nudge\", /*handleNudge*/ ctx[18]),\n\t\t\t\t\taction_destroyer(nudgeable_action = nudgeable.call(null, div1, /*direction*/ ctx[2] = \"horizontal\"))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*valueLabel*/ 16) set_data(t0, /*valueLabel*/ ctx[4]);\n\t\t\tif (dirty[0] & /*labelReset*/ 2) set_data(t2, /*labelReset*/ ctx[1]);\n\n\t\t\tif (dirty[0] & /*value, base*/ 9 && button_disabled_value !== (button_disabled_value = /*value*/ ctx[0] === /*base*/ ctx[3])) {\n\t\t\t\tbutton.disabled = button_disabled_value;\n\t\t\t}\n\n\t\t\tif (/*$position*/ ctx[9]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block$5(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\tif_block.m(div0, null);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tif_block.d(1);\n\t\t\t\tif_block = null;\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*rangeMask*/ 256) {\n\t\t\t\tattr(div0, \"style\", /*rangeMask*/ ctx[8]);\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*isLimited*/ 128) {\n\t\t\t\tattr(div0, \"data-value-limited\", /*isLimited*/ ctx[7]);\n\t\t\t}\n\n\t\t\tif (nudgeable_action && is_function(nudgeable_action.update) && dirty[0] & /*direction*/ 4) nudgeable_action.update.call(null, /*direction*/ ctx[2] = \"horizontal\");\n\t\t},\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div1);\n\t\t\tif (if_block) if_block.d();\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nconst radiusBig = 2;\nconst radiusSmall = 0.75;\nconst indicatorSpacing = 10;\nconst indicatorInterval = 5;\nconst indicatorCount = 40; // must be even\n\nfunction instance$m($$self, $$props, $$invalidate) {\n\tlet $position;\n\tlet { labelReset = \"Reset\" } = $$props;\n\tlet { direction = \"x\" } = $$props;\n\tlet { min = 0 } = $$props;\n\tlet { max = 1 } = $$props;\n\tlet { base = min } = $$props;\n\tlet { value = 0 } = $$props;\n\tlet { valueLabel = 0 } = $$props;\n\tlet { valueMin = undefined } = $$props;\n\tlet { valueMax = undefined } = $$props;\n\tlet { oninputstart = noop } = $$props;\n\tlet { oninputmove = noop } = $$props;\n\tlet { oninputend = noop } = $$props;\n\tlet { elasticity = 0 } = $$props;\n\tconst round = (number, increment, offset) => Math.ceil((number - offset) / increment) * increment + offset;\n\tlet size;\n\tlet svg;\n\tlet svgSize;\n\tconst svgPadding = { x: 2, y: 0 };\n\n\tfunction getMask(limitedMin, limitedMax) {\n\t\tconst step = 1 / indicatorCount;\n\t\tconst from = toFraction(limitedMin, min, max);\n\t\tconst to = toFraction(limitedMax, min, max);\n\t\tconst fromSnapped = fixPrecision(round(from, step, 0) - step * 0.5);\n\t\tconst toSnapped = fixPrecision(round(to, step, 0) - step * 0.5);\n\t\treturn `--range-mask-from:${fromSnapped * 100}%;--range-mask-to:${toSnapped * 100}%`;\n\t}\n\n\t//\n\t// Dragging related\n\t//\n\tlet interactionOrigin = undefined;\n\n\tlet interactionReleased = false;\n\tlet interactionRange;\n\tlet interactionOptions = { snap: false, elastic: false };\n\n\tconst handleDragStart = () => {\n\t\tinteractionReleased = false;\n\t\tinteractionOrigin = get_store_value(position);\n\n\t\tinteractionRange = [\n\t\t\tvalueToPosition(valueMin != null ? valueMin : min, direction),\n\t\t\tvalueToPosition(valueMax != null ? valueMax : max, direction)\n\t\t];\n\n\t\toninputstart();\n\t};\n\n\tconst handleDragRelease = () => {\n\t\tinteractionReleased = true;\n\t};\n\n\tconst handleDragMove = ({ detail }) => {\n\t\tinteractionOptions.snap = !interactionReleased;\n\t\tinteractionOptions.elastic = !interactionReleased;\n\t\ttranslatePosition(interactionOrigin, detail.translation, interactionOptions);\n\t};\n\n\tconst handleDragEnd = ({ detail }) => {\n\t\tinteractionOptions.snap = false;\n\t\tinteractionOptions.elastic = false;\n\t\tconst valueAtPosition = translatePosition(interactionOrigin, detail.translation, interactionOptions);\n\t\tinteractionOrigin = undefined;\n\t\tinteractionRange = undefined;\n\n\t\t// if is near base position, set to base\n\t\tif (Math.abs(valueAtPosition - base) < 0.01) return oninputend(base);\n\n\t\toninputend(valueAtPosition);\n\t};\n\n\tconst translatePosition = (origin, translation, options) => {\n\t\tconst target = origin[direction] + translation[direction];\n\t\tconst targetLimited = clamp(target, interactionRange[1][direction], interactionRange[0][direction]);\n\n\t\tconst targetElastic = elasticity\n\t\t? targetLimited + elastify(target - targetLimited, elasticity)\n\t\t: targetLimited;\n\n\t\tconst targetVisual = options.elastic ? targetElastic : targetLimited;\n\n\t\t// set position\n\t\tconst targetValid = vectorCreate(0, 0);\n\n\t\ttargetValid[direction] = targetVisual;\n\t\tposition.set(targetValid, { hard: options.snap });\n\t\treturn clamp(positionToValue(targetValid, direction), min, max);\n\t};\n\n\tconst handleReset = () => {\n\t\t$$invalidate(0, value = clamp(base, valueMinLimited, valueMaxLimited));\n\t\toninputstart();\n\t\toninputend(value);\n\t};\n\n\t//\n\t// Meter position and value updates\n\t//\n\tconst position = spring();\n\n\tcomponent_subscribe($$self, position, value => $$invalidate(9, $position = value));\n\n\tconst valueToPosition = (value, axis) => {\n\t\tconst offset = (size[axis] - barSize[axis]) * 0.5;\n\t\tconst fraction = toFraction(value, min, max);\n\t\tconst v = fraction * barSize[axis] - barSize[axis] * 0.5;\n\t\tconst pos = offset - v;\n\n\t\treturn {\n\t\t\tx: axis === \"x\" ? pos : 0,\n\t\t\ty: axis === \"y\" ? pos : 0\n\t\t};\n\t};\n\n\tconst positionToValue = (position, axis) => {\n\t\tconst dist = position[axis] - size[axis] * 0.5;\n\t\tconst fraction = -(dist / barSize[axis]);\n\t\treturn min + fraction * range;\n\t};\n\n\tposition.subscribe(currentPosition => {\n\t\t// if not positioned yet or is not interacting we're not interested in this event\n\t\tif (!currentPosition || !interactionOrigin) return;\n\n\t\toninputmove(clamp(positionToValue(currentPosition, direction), min, max));\n\t});\n\n\tconst updatePosition = value => {\n\t\tconst interactionRange = [\n\t\t\tvalueToPosition(valueMin != null ? valueMin : min, direction),\n\t\t\tvalueToPosition(valueMax != null ? valueMax : max, direction)\n\t\t];\n\n\t\tconst target = {\n\t\t\tx: direction === \"x\" ? $position.x + value : 0,\n\t\t\ty: direction === \"y\" ? $position.y + value : 0\n\t\t};\n\n\t\tconst targetLimited = clamp(target[direction], interactionRange[1][direction], interactionRange[0][direction]);\n\t\tconst positionTarget = { ...$position, [direction]: targetLimited };\n\t\tset_store_value(position, $position = positionTarget, $position);\n\t\tconst result = clamp(positionToValue(positionTarget, direction), min, max);\n\t\toninputstart();\n\t\toninputmove(result);\n\t\toninputend(result);\n\t};\n\n\tconst handleWheel = e => {\n\t\t// don't run default actions, prevent other actions from running\n\t\te.preventDefault();\n\n\t\te.stopPropagation();\n\n\t\t// apply wheel delta to offset\n\t\tconst step = 8;\n\n\t\tconst delta = getWheelDelta(e) * step;\n\t\tupdatePosition(delta);\n\t};\n\n\tconst handleNudge = ({ detail }) => {\n\t\tupdatePosition(detail[direction] * 8);\n\t};\n\n\tconst measure_handler = e => $$invalidate(5, size = vectorCreateFromSize(e.detail));\n\n\t$$self.$$set = $$props => {\n\t\tif (\"labelReset\" in $$props) $$invalidate(1, labelReset = $$props.labelReset);\n\t\tif (\"direction\" in $$props) $$invalidate(2, direction = $$props.direction);\n\t\tif (\"min\" in $$props) $$invalidate(19, min = $$props.min);\n\t\tif (\"max\" in $$props) $$invalidate(20, max = $$props.max);\n\t\tif (\"base\" in $$props) $$invalidate(3, base = $$props.base);\n\t\tif (\"value\" in $$props) $$invalidate(0, value = $$props.value);\n\t\tif (\"valueLabel\" in $$props) $$invalidate(4, valueLabel = $$props.valueLabel);\n\t\tif (\"valueMin\" in $$props) $$invalidate(21, valueMin = $$props.valueMin);\n\t\tif (\"valueMax\" in $$props) $$invalidate(22, valueMax = $$props.valueMax);\n\t\tif (\"oninputstart\" in $$props) $$invalidate(23, oninputstart = $$props.oninputstart);\n\t\tif (\"oninputmove\" in $$props) $$invalidate(24, oninputmove = $$props.oninputmove);\n\t\tif (\"oninputend\" in $$props) $$invalidate(25, oninputend = $$props.oninputend);\n\t\tif (\"elasticity\" in $$props) $$invalidate(26, elasticity = $$props.elasticity);\n\t};\n\n\tlet range;\n\tlet valueMinLimited;\n\tlet valueMaxLimited;\n\tlet barSize;\n\tlet baseFraction;\n\tlet isLimited;\n\tlet rangeMask;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*max, min*/ 1572864) {\n\t\t\t//\n\t\t\t// derived\n\t\t\t//\n\t\t\t $$invalidate(33, range = max - min);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*valueMin, min*/ 2621440) {\n\t\t\t $$invalidate(34, valueMinLimited = valueMin != null ? Math.max(valueMin, min) : min);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*valueMax, max*/ 5242880) {\n\t\t\t $$invalidate(35, valueMaxLimited = valueMax != null ? Math.min(valueMax, max) : max);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*base, min, max*/ 1572872) {\n\t\t\t $$invalidate(37, baseFraction = toFraction(base, min, max));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*size*/ 32 | $$self.$$.dirty[1] & /*baseFraction*/ 64) {\n\t\t\t if (size) {\n\t\t\t\tconst centerY = size.y * 0.5;\n\t\t\t\tlet indicatorCenter = indicatorCount * baseFraction;\n\t\t\t\tlet indicators = \"\";\n\t\t\t\tlet svgWidth;\n\t\t\t\tlet svgHeight = size.y;\n\n\t\t\t\tfor (let i = 0; i <= indicatorCount; i++) {\n\t\t\t\t\tconst x = svgPadding.x + i * indicatorSpacing;\n\t\t\t\t\tconst y = centerY;\n\t\t\t\t\tconst r = i % indicatorInterval === 0 ? radiusBig : radiusSmall;\n\t\t\t\t\tindicators += `<circle cx=\"${x}\" cy=\"${y}\" r=\"${r}\"/>`;\n\t\t\t\t\tsvgWidth = x + svgPadding.x;\n\n\t\t\t\t\tif (i === indicatorCenter) {\n\t\t\t\t\t\tindicators += `<path stroke=\"none\" fill=\"currentColor\" d=\"M${x} ${y - 4} l2 3 l-2 -1 l-2 1 z\"/>`;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$$invalidate(6, svg = `<svg width=\"${svgWidth}\" height=\"${svgHeight}\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 ${svgWidth} ${svgHeight}\" aria-hidden=\"true\" focusable=\"false\">${indicators}<rect rx=\"4\" ry=\"4\" y=\"${centerY - 4}\"\" height=\"8\"></rect></svg>`);\n\n\t\t\t\t$$invalidate(28, svgSize = {\n\t\t\t\t\tx: svgWidth - svgPadding.x * 2,\n\t\t\t\t\ty: svgHeight\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*size, svgSize*/ 268435488) {\n\t\t\t barSize = size && svgSize;\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*min, max*/ 1572864 | $$self.$$.dirty[1] & /*valueMinLimited, valueMaxLimited*/ 24) {\n\t\t\t $$invalidate(7, isLimited = valueMinLimited !== min || valueMaxLimited !== max);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*isLimited*/ 128 | $$self.$$.dirty[1] & /*valueMinLimited, valueMaxLimited*/ 24) {\n\t\t\t $$invalidate(8, rangeMask = isLimited\n\t\t\t? getMask(valueMinLimited, valueMaxLimited)\n\t\t\t: \"\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*size, value, direction*/ 37 | $$self.$$.dirty[1] & /*range*/ 4) {\n\t\t\t// if has size (range is in here so the position is updated if the range is changed)\n\t\t\t if (range && size && size.x && size.y) {\n\t\t\t\tposition.set(valueToPosition(value, direction));\n\t\t\t}\n\t\t}\n\t};\n\n\treturn [\n\t\tvalue,\n\t\tlabelReset,\n\t\tdirection,\n\t\tbase,\n\t\tvalueLabel,\n\t\tsize,\n\t\tsvg,\n\t\tisLimited,\n\t\trangeMask,\n\t\t$position,\n\t\tsvgPadding,\n\t\thandleDragStart,\n\t\thandleDragRelease,\n\t\thandleDragMove,\n\t\thandleDragEnd,\n\t\thandleReset,\n\t\tposition,\n\t\thandleWheel,\n\t\thandleNudge,\n\t\tmin,\n\t\tmax,\n\t\tvalueMin,\n\t\tvalueMax,\n\t\toninputstart,\n\t\toninputmove,\n\t\toninputend,\n\t\telasticity,\n\t\tmeasure_handler\n\t];\n}\n\nclass RangeInput extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$m,\n\t\t\tcreate_fragment$m,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tlabelReset: 1,\n\t\t\t\tdirection: 2,\n\t\t\t\tmin: 19,\n\t\t\t\tmax: 20,\n\t\t\t\tbase: 3,\n\t\t\t\tvalue: 0,\n\t\t\t\tvalueLabel: 4,\n\t\t\t\tvalueMin: 21,\n\t\t\t\tvalueMax: 22,\n\t\t\t\toninputstart: 23,\n\t\t\t\toninputmove: 24,\n\t\t\t\toninputend: 25,\n\t\t\t\telasticity: 26\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n}\n\n/* src/core/ui/components/Toolbar.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$n(ctx) {\n\tlet div1;\n\tlet div0;\n\tlet measurable_action;\n\tlet measurable_action_1;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tconst default_slot_template = /*#slots*/ ctx[5].default;\n\tconst default_slot = create_slot(default_slot_template, ctx, /*$$scope*/ ctx[4], null);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv1 = element(\"div\");\n\t\t\tdiv0 = element(\"div\");\n\t\t\tif (default_slot) default_slot.c();\n\t\t\tattr(div0, \"class\", \"DokaToolbarInner\");\n\t\t\tattr(div1, \"class\", \"DokaToolbar\");\n\t\t\tattr(div1, \"data-layout\", /*layout*/ ctx[1]);\n\t\t\tattr(div1, \"data-overflow\", /*overflow*/ ctx[0]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div1, anchor);\n\t\t\tappend(div1, div0);\n\n\t\t\tif (default_slot) {\n\t\t\t\tdefault_slot.m(div0, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div0, \"measure\", /*handleChildResizeEvent*/ ctx[3]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div0)),\n\t\t\t\t\tlisten(div1, \"measure\", /*handleParentResizeEvent*/ ctx[2]),\n\t\t\t\t\taction_destroyer(measurable_action_1 = measurable.call(null, div1))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (default_slot) {\n\t\t\t\tif (default_slot.p && dirty & /*$$scope*/ 16) {\n\t\t\t\t\tupdate_slot(default_slot, default_slot_template, ctx, /*$$scope*/ ctx[4], dirty, null, null);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*layout*/ 2) {\n\t\t\t\tattr(div1, \"data-layout\", /*layout*/ ctx[1]);\n\t\t\t}\n\n\t\t\tif (!current || dirty & /*overflow*/ 1) {\n\t\t\t\tattr(div1, \"data-overflow\", /*overflow*/ ctx[0]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(default_slot, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(default_slot, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div1);\n\t\t\tif (default_slot) default_slot.d(detaching);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction instance$n($$self, $$props, $$invalidate) {\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tlet childWidth = 0;\n\tlet childMaxWidth = 0;\n\tlet parentWidth = 0;\n\tlet overflow;\n\n\tconst testOverflow = () => {\n\t\t$$invalidate(0, overflow = layout === \"compact\" && childWidth > parentWidth\n\t\t? \"overflow\"\n\t\t: undefined);\n\t};\n\n\tconst handleParentResizeEvent = ({ detail }) => {\n\t\tconst { width, height } = detail;\n\t\t$$invalidate(8, parentWidth = width);\n\t\ttestOverflow();\n\t};\n\n\tconst handleChildResizeEvent = ({ detail }) => {\n\t\tconst { width, height } = detail;\n\n\t\tif (width > childMaxWidth) {\n\t\t\t$$invalidate(7, childMaxWidth = width);\n\t\t}\n\n\t\tchildWidth = width;\n\t\tif (!overflow) testOverflow();\n\t};\n\n\t$$self.$$set = $$props => {\n\t\tif (\"$$scope\" in $$props) $$invalidate(4, $$scope = $$props.$$scope);\n\t};\n\n\tlet layout;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*childMaxWidth, parentWidth*/ 384) {\n\t\t\t $$invalidate(1, layout = childMaxWidth > parentWidth ? \"compact\" : \"default\");\n\t\t}\n\t};\n\n\treturn [\n\t\toverflow,\n\t\tlayout,\n\t\thandleParentResizeEvent,\n\t\thandleChildResizeEvent,\n\t\t$$scope,\n\t\tslots\n\t];\n}\n\nclass Toolbar extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$n, create_fragment$n, safe_not_equal, {});\n\t}\n}\n\n// enum Direction {\n//     Top = 't',\n//     Right = 'r',\n//     Bottom = 'b',\n//     Left = 'l',\n//     TopLeft = 'tl',\n//     TopRight = 'tr',\n//     BottomRight = 'br',\n//     BottomLeft = 'bl',\n// }\n// export const { Top, Right, Bottom, Left, TopLeft, TopRight, BottomRight, BottomLeft } = Direction;\n// export default Direction;\nconst Direction = {\n    Top: 't',\n    Right: 'r',\n    Bottom: 'b',\n    Left: 'l',\n    TopLeft: 'tl',\n    TopRight: 'tr',\n    BottomRight: 'br',\n    BottomLeft: 'bl',\n};\nconst { Top, Right, Bottom, Left, TopLeft, TopRight, BottomRight, BottomLeft } = Direction;\n\nvar DirectionRectMap = {\n    [Top]: (rect) => ({ x: rect.x, y: rect.y }),\n    [TopRight]: (rect) => ({ x: rect.x + rect.width, y: rect.y }),\n    [Right]: (rect) => ({ x: rect.x + rect.width, y: rect.y }),\n    [BottomRight]: (rect) => ({ x: rect.x + rect.width, y: rect.y + rect.height }),\n    [Bottom]: (rect) => ({ x: rect.x, y: rect.y + rect.height }),\n    [BottomLeft]: (rect) => ({ x: rect.x, y: rect.y + rect.height }),\n    [Left]: (rect) => ({ x: rect.x, y: rect.y }),\n    [TopLeft]: (rect) => ({ x: rect.x, y: rect.y }),\n};\n\n/* src/core/ui/components/RectManipulator.svelte generated by Svelte v3.29.4 */\n\nfunction get_each_context$4(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[11] = list[i].key;\n\tchild_ctx[12] = list[i].translate;\n\tchild_ctx[13] = list[i].scale;\n\tchild_ctx[14] = list[i].type;\n\tchild_ctx[15] = list[i].opacity;\n\treturn child_ctx;\n}\n\n// (210:0) {#each mappedDirections as { key, translate, scale, type, opacity }\nfunction create_each_block$4(key_1, ctx) {\n\tlet div;\n\tlet div_tabindex_value;\n\tlet div_data_direction_value;\n\tlet div_data_shape_value;\n\tlet div_style_value;\n\tlet nudgeable_action;\n\tlet interactable_action;\n\tlet mounted;\n\tlet dispose;\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tattr(div, \"role\", \"button\");\n\t\t\tattr(div, \"tabindex\", div_tabindex_value = /*type*/ ctx[14] === \"edge\" ? -1 : 0);\n\t\t\tattr(div, \"class\", \"DokaRectManipulator\");\n\t\t\tattr(div, \"data-direction\", div_data_direction_value = /*key*/ ctx[11]);\n\n\t\t\tattr(div, \"data-shape\", div_data_shape_value = `${/*type*/ ctx[14] === \"edge\"\n\t\t\t? \"edge\"\n\t\t\t: `${/*style*/ ctx[0]}`}`);\n\n\t\t\tattr(div, \"style\", div_style_value = `transform: translate3d(${/*translate*/ ctx[12].x}px, ${/*translate*/ ctx[12].y}px, 0) scale(${/*scale*/ ctx[13].x}, ${/*scale*/ ctx[13].y}); opacity: ${/*opacity*/ ctx[15]}`);\n\t\t\tthis.first = div;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div, \"nudge\", function () {\n\t\t\t\t\t\tif (is_function(/*nudge*/ ctx[5](/*key*/ ctx[11]))) /*nudge*/ ctx[5](/*key*/ ctx[11]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\taction_destroyer(nudgeable_action = nudgeable.call(null, div)),\n\t\t\t\t\tlisten(div, \"interactionstart\", function () {\n\t\t\t\t\t\tif (is_function(/*route*/ ctx[4](\"resizestart\", /*key*/ ctx[11]))) /*route*/ ctx[4](\"resizestart\", /*key*/ ctx[11]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(div, \"interactionupdate\", function () {\n\t\t\t\t\t\tif (is_function(/*route*/ ctx[4](\"resizemove\", /*key*/ ctx[11]))) /*route*/ ctx[4](\"resizemove\", /*key*/ ctx[11]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(div, \"interactionend\", function () {\n\t\t\t\t\t\tif (is_function(/*route*/ ctx[4](\"resizeend\", /*key*/ ctx[11]))) /*route*/ ctx[4](\"resizeend\", /*key*/ ctx[11]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\taction_destroyer(interactable_action = interactable.call(null, div))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\n\t\t\tif (dirty & /*mappedDirections*/ 2 && div_tabindex_value !== (div_tabindex_value = /*type*/ ctx[14] === \"edge\" ? -1 : 0)) {\n\t\t\t\tattr(div, \"tabindex\", div_tabindex_value);\n\t\t\t}\n\n\t\t\tif (dirty & /*mappedDirections*/ 2 && div_data_direction_value !== (div_data_direction_value = /*key*/ ctx[11])) {\n\t\t\t\tattr(div, \"data-direction\", div_data_direction_value);\n\t\t\t}\n\n\t\t\tif (dirty & /*mappedDirections, style*/ 3 && div_data_shape_value !== (div_data_shape_value = `${/*type*/ ctx[14] === \"edge\"\n\t\t\t? \"edge\"\n\t\t\t: `${/*style*/ ctx[0]}`}`)) {\n\t\t\t\tattr(div, \"data-shape\", div_data_shape_value);\n\t\t\t}\n\n\t\t\tif (dirty & /*mappedDirections*/ 2 && div_style_value !== (div_style_value = `transform: translate3d(${/*translate*/ ctx[12].x}px, ${/*translate*/ ctx[12].y}px, 0) scale(${/*scale*/ ctx[13].x}, ${/*scale*/ ctx[13].y}); opacity: ${/*opacity*/ ctx[15]}`)) {\n\t\t\t\tattr(div, \"style\", div_style_value);\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction create_fragment$o(ctx) {\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet each_1_anchor;\n\tlet each_value = /*mappedDirections*/ ctx[1];\n\tconst get_key = ctx => /*key*/ ctx[11];\n\n\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\tlet child_ctx = get_each_context$4(ctx, each_value, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block$4(key, child_ctx));\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\teach_1_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(target, anchor);\n\t\t\t}\n\n\t\t\tinsert(target, each_1_anchor, anchor);\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*mappedDirections, style, nudge, route*/ 51) {\n\t\t\t\tconst each_value = /*mappedDirections*/ ctx[1];\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value, each_1_lookup, each_1_anchor.parentNode, destroy_block, create_each_block$4, each_1_anchor, get_each_context$4);\n\t\t\t}\n\t\t},\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d(detaching);\n\t\t\t}\n\n\t\t\tif (detaching) detach(each_1_anchor);\n\t\t}\n\t};\n}\n\nfunction instance$o($$self, $$props, $$invalidate) {\n\tlet $selectionScale;\n\tlet $selectionOpacity;\n\tlet { rect = null } = $$props;\n\tlet { visible = false } = $$props;\n\tlet { style = undefined } = $$props;\n\n\t// is `undefined` to prevent bounce when first rendering view\n\tconst selectionScale = spring(undefined, {\n\t\tprecision: 0.0001,\n\t\tstiffness: 0.2,\n\t\tdamping: 0.4\n\t});\n\n\tcomponent_subscribe($$self, selectionScale, value => $$invalidate(8, $selectionScale = value));\n\tconst selectionOpacity = spring(0, { precision: 0.001 });\n\tcomponent_subscribe($$self, selectionOpacity, value => $$invalidate(9, $selectionOpacity = value));\n\n\t//\n\t// dragging\n\t//\n\tconst dispatch = createEventDispatcher();\n\n\tconst route = (type, direction) => ({ detail }) => dispatch(type, {\n\t\tdirection,\n\t\ttranslation: detail && detail.translation\n\t});\n\n\tconst nudge = direction => ({ detail }) => {\n\t\tdispatch(`resizestart`, { direction, translation: { x: 0, y: 0 } });\n\t\tdispatch(`resizemove`, { direction, translation: detail });\n\t\tdispatch(`resizeend`, { direction, translation: { x: 0, y: 0 } });\n\t};\n\n\t$$self.$$set = $$props => {\n\t\tif (\"rect\" in $$props) $$invalidate(6, rect = $$props.rect);\n\t\tif (\"visible\" in $$props) $$invalidate(7, visible = $$props.visible);\n\t\tif (\"style\" in $$props) $$invalidate(0, style = $$props.style);\n\t};\n\n\tlet mappedDirections;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*visible*/ 128) {\n\t\t\t selectionScale.set(visible ? 1 : 0.5);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*visible*/ 128) {\n\t\t\t selectionOpacity.set(visible ? 1 : 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*rect, $selectionScale, $selectionOpacity*/ 832) {\n\t\t\t//\n\t\t\t// rendering\n\t\t\t//\n\t\t\t $$invalidate(1, mappedDirections = Object.keys(Direction).map((key, i) => {\n\t\t\t\t// get direction enum\n\t\t\t\tconst direction = Direction[key];\n\n\t\t\t\t// get position from direction\n\t\t\t\tconst position = DirectionRectMap[direction](rect);\n\n\t\t\t\t// corner or edge\n\t\t\t\tconst type = direction.length === 1 ? \"edge\" : \"corner\";\n\n\t\t\t\tconst isCorner = type === \"corner\";\n\n\t\t\t\treturn {\n\t\t\t\t\tkey: direction,\n\t\t\t\t\ttype,\n\t\t\t\t\tscale: {\n\t\t\t\t\t\tx: (/^(t|b)$/).test(direction)\n\t\t\t\t\t\t? rect.width\n\t\t\t\t\t\t: isCorner ? clamp($selectionScale, 0.5, 1.25) : 1,\n\t\t\t\t\t\ty: (/^(r|l)$/).test(direction)\n\t\t\t\t\t\t? rect.height\n\t\t\t\t\t\t: isCorner ? clamp($selectionScale, 0.5, 1.25) : 1\n\t\t\t\t\t},\n\t\t\t\t\ttranslate: { x: position.x, y: position.y },\n\t\t\t\t\topacity: $selectionOpacity\n\t\t\t\t};\n\t\t\t}));\n\t\t}\n\t};\n\n\treturn [\n\t\tstyle,\n\t\tmappedDirections,\n\t\tselectionScale,\n\t\tselectionOpacity,\n\t\troute,\n\t\tnudge,\n\t\trect,\n\t\tvisible\n\t];\n}\n\nclass RectManipulator extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$o, create_fragment$o, safe_not_equal, { rect: 6, visible: 7, style: 0 });\n\t}\n}\n\nvar getEventPositionInViewport = (e) => vectorCreate(e.clientX, e.clientY);\n\nvar getEventPositionInStage = (e, viewOffset, stageOffset) => {\n    const positionInViewport = getEventPositionInViewport(e);\n    return vectorSubtract(vectorSubtract(positionInViewport, viewOffset), stageOffset);\n};\n\nvar DirectionInversionTable = {\n    [Top]: Bottom,\n    [Right]: Left,\n    [Bottom]: Top,\n    [Left]: Right,\n    [TopLeft]: BottomRight,\n    [TopRight]: BottomLeft,\n    [BottomRight]: TopLeft,\n    [BottomLeft]: TopRight,\n};\n\nvar DirectionCoordinateTable = {\n    [Top]: [0.5, 0],\n    [Right]: [1, 0.5],\n    [Bottom]: [0.5, 1],\n    [Left]: [0, 0.5],\n    [TopLeft]: [0, 0],\n    [TopRight]: [1, 0],\n    [BottomRight]: [1, 1],\n    [BottomLeft]: [0, 1],\n};\n\nvar getTranslationInfo = (target) => {\n    const translateToRight = target === Right || target === TopRight || target === BottomRight;\n    const translateToLeft = target === Left || target === BottomLeft || target === TopLeft;\n    const translateToTop = target === Top || target === TopRight || target === TopLeft;\n    const translateToBottom = target === Bottom || target === BottomRight || target === BottomLeft;\n    const translateHorizontally = target === Left || target === Right;\n    const translateVertically = target === Top || target === Bottom;\n    const translateAxis = translateHorizontally || translateVertically;\n    return [\n        translateToRight,\n        translateToLeft,\n        translateToTop,\n        translateToBottom,\n        translateHorizontally,\n        translateVertically,\n        translateAxis,\n    ];\n};\n\nvar limitRectDirectionTranslation = (rect, transform, bounds, options = {}) => {\n    // the transforms to apply\n    const { target, translate } = transform;\n    // the transform requirements\n    const { aspectRatio, minSize, maxSize } = options;\n    // get anchor coordinates and x,y position we need this for relative scaling of the view rectangle\n    const anchor = DirectionInversionTable[target];\n    const anchorDirectionCoordinates = DirectionCoordinateTable[anchor];\n    const anchorPosition = vectorAdd(vectorCreate(rect.x, rect.y), vectorCreate(anchorDirectionCoordinates[0] * rect.width, anchorDirectionCoordinates[1] * rect.height));\n    // get coordinate of direction\n    const targetDirectionCoordinates = DirectionCoordinateTable[target];\n    const targetPosition = vectorAdd(rectClone(rect), vectorCreate(targetDirectionCoordinates[0] * rect.width, targetDirectionCoordinates[1] * rect.height));\n    // bools to determine which direction the interaction is moving in\n    const [translateToRight, translateToLeft, translateToTop, translateToBottom, translateHorizontally, translateVertically, translateAxis,] = getTranslationInfo(target);\n    let tx = translate.x;\n    let ty = translate.y;\n    if (translateHorizontally)\n        ty = 0;\n    else if (translateVertically)\n        tx = 0;\n    const interactionBounds = getInteractionBounds(anchorPosition, target, bounds, {\n        aspectRatio,\n        minSize,\n        maxSize,\n    });\n    // current bounds\n    let [t, r, b, l] = rectToBounds(rect);\n    // update view bounds with anchor based on translation direction (one side is always locked)\n    if (translateToRight)\n        l = anchorPosition.x;\n    else if (translateToLeft)\n        r = anchorPosition.x;\n    if (translateToBottom)\n        t = anchorPosition.y;\n    else if (translateToTop)\n        b = anchorPosition.y;\n    // update view bounds with interaction limits\n    if (translateToRight) {\n        const innerR = interactionBounds.inner.x + interactionBounds.inner.width;\n        const outerR = interactionBounds.outer.x + interactionBounds.outer.width;\n        r = clamp(targetPosition.x + tx, innerR, outerR);\n    }\n    else if (translateToLeft) {\n        const innerL = interactionBounds.outer.x;\n        const outerL = interactionBounds.inner.x;\n        l = clamp(targetPosition.x + tx, innerL, outerL);\n    }\n    if (translateToBottom) {\n        const innerB = interactionBounds.inner.y + interactionBounds.inner.height;\n        const outerB = interactionBounds.outer.y + interactionBounds.outer.height;\n        b = clamp(targetPosition.y + ty, innerB, outerB);\n    }\n    else if (translateToTop) {\n        const innerT = interactionBounds.outer.y;\n        const outerT = interactionBounds.inner.y;\n        t = clamp(targetPosition.y + ty, innerT, outerT);\n    }\n    // if aspect ratio is set we need to scale both axis\n    if (aspectRatio) {\n        // if translating over horizontal or vertical axis we need to update the other axis based on the aspect ratio as well\n        if (translateAxis) {\n            let dx = r - l;\n            let dy = b - t;\n            if (translateHorizontally) {\n                dy = dx / aspectRatio;\n                t = anchorPosition.y - dy * 0.5;\n                b = anchorPosition.y + dy * 0.5;\n            }\n            else if (translateVertically) {\n                dx = dy * aspectRatio;\n                l = anchorPosition.x - dx * 0.5;\n                r = anchorPosition.x + dx * 0.5;\n            }\n        }\n        // we're translating one of the corners in both the x and y direction, need to make sure it conforms to aspect ratio\n        else {\n            const pointer = vectorCreate(targetPosition.x + tx - anchorPosition.x, targetPosition.y + ty - anchorPosition.y);\n            // translations cannot be inverted, limited by anchor position\n            if (target === TopRight) {\n                pointer.x = Math.max(0, pointer.x);\n                pointer.y = Math.min(0, pointer.y);\n            }\n            else if (target === BottomRight) {\n                pointer.x = Math.max(0, pointer.x);\n                pointer.y = Math.max(0, pointer.y);\n            }\n            else if (target === BottomLeft) {\n                pointer.x = Math.min(0, pointer.x);\n                pointer.y = Math.max(0, pointer.y);\n            }\n            else if (target === TopLeft) {\n                pointer.x = Math.min(0, pointer.x);\n                pointer.y = Math.min(0, pointer.y);\n            }\n            // calculate the translation pointer, then get its length, now create a new pointer based on the aspect ratio, and scale it based on the original (limited) length\n            const pointerLength = vectorLength(pointer);\n            const pointerLengthMin = vectorLength(vectorCreate(interactionBounds.inner.width, interactionBounds.inner.height));\n            const pointerLengthMax = vectorLength(vectorCreate(interactionBounds.outer.width, interactionBounds.outer.height));\n            const pointerLengthLimited = clamp(pointerLength, pointerLengthMin, pointerLengthMax);\n            const pointerAspectRatio = vectorCreate(aspectRatio, 1);\n            const pointerScaled = vectorMultiply(vectorNormalize(pointerAspectRatio), pointerLengthLimited);\n            if (target === TopRight) {\n                r = anchorPosition.x + pointerScaled.x;\n                t = anchorPosition.y - pointerScaled.y;\n            }\n            else if (target === BottomRight) {\n                r = anchorPosition.x + pointerScaled.x;\n                b = anchorPosition.y + pointerScaled.y;\n            }\n            else if (target === BottomLeft) {\n                l = anchorPosition.x - pointerScaled.x;\n                b = anchorPosition.y + pointerScaled.y;\n            }\n            else if (target === TopLeft) {\n                l = anchorPosition.x - pointerScaled.x;\n                t = anchorPosition.y - pointerScaled.y;\n            }\n        }\n    }\n    return rectCreate(l, t, r - l, b - t);\n};\nconst getInteractionBounds = (anchor, dir, bounds, options) => {\n    const { aspectRatio, minSize, maxSize } = options;\n    const translateToRight = dir === Right || dir === TopRight || dir === BottomRight;\n    const translateToLeft = dir === Left || dir === BottomLeft || dir === TopLeft;\n    const translateToTop = dir === Top || dir === TopRight || dir === TopLeft;\n    const translateToBottom = dir === Bottom || dir === BottomRight || dir === BottomLeft;\n    const translateHorizontally = dir === Left || dir === Right;\n    const translateVertically = dir === Top || dir === Bottom;\n    // limit bounds based on anchor and direction\n    const limitedBounds = rectClone(bounds);\n    if (translateToRight) {\n        limitedBounds.x = anchor.x;\n        limitedBounds.width -= anchor.x;\n    }\n    else if (translateToLeft) {\n        limitedBounds.width = anchor.x;\n    }\n    if (translateToBottom) {\n        limitedBounds.y = anchor.y;\n        limitedBounds.height -= anchor.y;\n    }\n    else if (translateToTop) {\n        limitedBounds.height = anchor.y;\n    }\n    // limit max size based on bounds\n    const maxSizeLimitedToBounds = rectCreateFromDimensions(Math.min(limitedBounds.width, maxSize.width), Math.min(limitedBounds.height, maxSize.height));\n    if (aspectRatio) {\n        // limit height\n        if (translateHorizontally) {\n            const verticalSpace = Math.min(anchor.y, bounds.height - anchor.y);\n            maxSizeLimitedToBounds.height = Math.min(verticalSpace * 2, maxSizeLimitedToBounds.height);\n        }\n        // limit width\n        else if (translateVertically) {\n            const horizontalSpace = Math.min(anchor.x, bounds.width - anchor.x);\n            maxSizeLimitedToBounds.width = Math.min(horizontalSpace * 2, maxSizeLimitedToBounds.width);\n        }\n    }\n    const maxSizeLimited = aspectRatio\n        ? sizeCreateFromRect(rectContainRect(maxSizeLimitedToBounds, aspectRatio))\n        : maxSizeLimitedToBounds;\n    // limit min size\n    const minSizeLimited = aspectRatio\n        ? sizeCreateFromRect(rectCoverRect(rectCreateFromSize(minSize), aspectRatio))\n        : minSize;\n    let l, r, t, b;\n    // set bounds\n    if (translateToRight)\n        l = anchor.x;\n    else if (translateToLeft)\n        r = anchor.x;\n    if (translateToBottom)\n        t = anchor.y;\n    else if (translateToTop)\n        b = anchor.y;\n    // inner\n    if (translateToRight) {\n        r = l + minSizeLimited.width;\n    }\n    else if (translateToLeft) {\n        l = r - minSizeLimited.width;\n    }\n    if (translateToBottom) {\n        b = t + minSizeLimited.height;\n    }\n    else if (translateToTop) {\n        t = b - minSizeLimited.height;\n    }\n    if (translateHorizontally) {\n        t = anchor.y - minSizeLimited.height * 0.5;\n        b = anchor.y + minSizeLimited.height * 0.5;\n    }\n    else if (translateVertically) {\n        l = anchor.x - minSizeLimited.width * 0.5;\n        r = anchor.x + minSizeLimited.width * 0.5;\n    }\n    const inner = rectCreateFromPoints(vectorCreate(l, t), vectorCreate(r, b));\n    // outer\n    if (translateToRight) {\n        r = l + maxSizeLimited.width;\n    }\n    else if (translateToLeft) {\n        l = r - maxSizeLimited.width;\n    }\n    if (translateToBottom) {\n        b = t + maxSizeLimited.height;\n    }\n    else if (translateToTop) {\n        t = b - maxSizeLimited.height;\n    }\n    if (translateHorizontally) {\n        t = anchor.y - maxSizeLimited.height * 0.5;\n        b = anchor.y + maxSizeLimited.height * 0.5;\n    }\n    else if (translateVertically) {\n        l = anchor.x - maxSizeLimited.width * 0.5;\n        r = anchor.x + maxSizeLimited.width * 0.5;\n    }\n    const outer = rectCreateFromPoints(vectorCreate(l, t), vectorCreate(r, b));\n    return {\n        inner,\n        outer,\n    };\n};\n\nvar applyRectDirectionTranslation = (rect, transform, options = {}) => {\n    // the transforms to apply\n    const { target, translate } = transform;\n    // the transform requirements\n    const { aspectRatio } = options;\n    // get anchor coordinates and x,y position we need this for relative scaling of the view rectangle\n    const anchor = DirectionInversionTable[target];\n    const anchorDirectionCoordinates = DirectionCoordinateTable[anchor];\n    const anchorPosition = vectorAdd(rectClone(rect), vectorCreate(anchorDirectionCoordinates[0] * rect.width, anchorDirectionCoordinates[1] * rect.height));\n    // get coordinate of direction\n    const targetDirectionCoordinates = DirectionCoordinateTable[target];\n    const targetPosition = vectorAdd(rectClone(rect), vectorCreate(targetDirectionCoordinates[0] * rect.width, targetDirectionCoordinates[1] * rect.height));\n    // bools to determine which direction the interaction is moving in\n    const [translateToRight, translateToLeft, translateToTop, translateToBottom, translateHorizontally, translateVertically, translateAxis,] = getTranslationInfo(target);\n    let tx = translate.x;\n    let ty = translate.y;\n    if (translateHorizontally)\n        ty = 0;\n    else if (translateVertically)\n        tx = 0;\n    // current bounds\n    let [t, r, b, l] = rectToBounds(rect);\n    // update view bounds with anchor based on translation direction (one side is always locked)\n    if (translateToRight)\n        l = anchorPosition.x;\n    else if (translateToLeft)\n        r = anchorPosition.x;\n    if (translateToBottom)\n        t = anchorPosition.y;\n    else if (translateToTop)\n        b = anchorPosition.y;\n    // update view bounds with interaction limits\n    if (translateToRight) {\n        r = targetPosition.x + tx;\n    }\n    else if (translateToLeft) {\n        l = targetPosition.x + tx;\n    }\n    if (translateToBottom) {\n        b = targetPosition.y + ty;\n    }\n    else if (translateToTop) {\n        t = targetPosition.y + ty;\n    }\n    // if aspect ratio is set we need to scale both axis\n    if (aspectRatio) {\n        // if translating over horizontal or vertical axis we need to update the other axis based on the aspect ratio as well\n        if (translateAxis) {\n            let dx = r - l;\n            let dy = b - t;\n            if (translateHorizontally) {\n                dy = dx / aspectRatio;\n                t = anchorPosition.y - dy * 0.5;\n                b = anchorPosition.y + dy * 0.5;\n            }\n            else if (translateVertically) {\n                dx = dy * aspectRatio;\n                l = anchorPosition.x - dx * 0.5;\n                r = anchorPosition.x + dx * 0.5;\n            }\n        }\n        // we're translating one of the corners in both the x and y direction, need to make sure it conforms to aspect ratio\n        else {\n            const pointer = vectorCreate(targetPosition.x + tx - anchorPosition.x, targetPosition.y + ty - anchorPosition.y);\n            // translations cannot be inverted, limited by anchor position\n            if (target === TopRight) {\n                pointer.x = Math.max(0, pointer.x);\n                pointer.y = Math.min(0, pointer.y);\n            }\n            else if (target === BottomRight) {\n                pointer.x = Math.max(0, pointer.x);\n                pointer.y = Math.max(0, pointer.y);\n            }\n            else if (target === BottomLeft) {\n                pointer.x = Math.min(0, pointer.x);\n                pointer.y = Math.max(0, pointer.y);\n            }\n            else if (target === TopLeft) {\n                pointer.x = Math.min(0, pointer.x);\n                pointer.y = Math.min(0, pointer.y);\n            }\n            // calculate the translation pointer, then get its length, now create a new pointer based on the aspect ratio, and scale it based on the original (limited) length\n            const pointerLength = vectorLength(pointer);\n            const pointerAspectRatio = vectorCreate(aspectRatio, 1);\n            const pointerScaled = vectorMultiply(vectorNormalize(pointerAspectRatio), pointerLength);\n            if (target === TopRight) {\n                r = anchorPosition.x + pointerScaled.x;\n                t = anchorPosition.y - pointerScaled.y;\n            }\n            else if (target === BottomRight) {\n                r = anchorPosition.x + pointerScaled.x;\n                b = anchorPosition.y + pointerScaled.y;\n            }\n            else if (target === BottomLeft) {\n                l = anchorPosition.x - pointerScaled.x;\n                b = anchorPosition.y + pointerScaled.y;\n            }\n            else if (target === TopLeft) {\n                l = anchorPosition.x - pointerScaled.x;\n                t = anchorPosition.y - pointerScaled.y;\n            }\n        }\n    }\n    return rectCreate(l, t, r - l, b - t);\n};\n\nvar radToDeg = (rad) => rad * 180 / Math.PI;\n\n/* src/core/ui/plugins/crop/components/ImageRotator.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$p(ctx) {\n\tlet div;\n\tlet rangeinput;\n\tlet current;\n\n\trangeinput = new RangeInput({\n\t\t\tprops: {\n\t\t\t\telasticity: /*elasticity*/ ctx[5],\n\t\t\t\tmin: /*min*/ ctx[7],\n\t\t\t\tmax: /*max*/ ctx[8],\n\t\t\t\tvalue: /*value*/ ctx[12],\n\t\t\t\tvalueMin: /*valueMin*/ ctx[0],\n\t\t\t\tvalueMax: /*valueMax*/ ctx[1],\n\t\t\t\tlabelReset: /*labelReset*/ ctx[6],\n\t\t\t\tbase: /*center*/ ctx[9],\n\t\t\t\tvalueLabel: `${Math.round(radToDeg(/*value*/ ctx[12]))}`,\n\t\t\t\toninputstart: /*oninputstart*/ ctx[2],\n\t\t\t\toninputmove: /*func*/ ctx[14],\n\t\t\t\toninputend: /*func_1*/ ctx[15]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(rangeinput.$$.fragment);\n\t\t\tattr(div, \"class\", \"DokaImageRotator\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(rangeinput, div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tconst rangeinput_changes = {};\n\t\t\tif (dirty & /*elasticity*/ 32) rangeinput_changes.elasticity = /*elasticity*/ ctx[5];\n\t\t\tif (dirty & /*min*/ 128) rangeinput_changes.min = /*min*/ ctx[7];\n\t\t\tif (dirty & /*max*/ 256) rangeinput_changes.max = /*max*/ ctx[8];\n\t\t\tif (dirty & /*value*/ 4096) rangeinput_changes.value = /*value*/ ctx[12];\n\t\t\tif (dirty & /*valueMin*/ 1) rangeinput_changes.valueMin = /*valueMin*/ ctx[0];\n\t\t\tif (dirty & /*valueMax*/ 2) rangeinput_changes.valueMax = /*valueMax*/ ctx[1];\n\t\t\tif (dirty & /*labelReset*/ 64) rangeinput_changes.labelReset = /*labelReset*/ ctx[6];\n\t\t\tif (dirty & /*center*/ 512) rangeinput_changes.base = /*center*/ ctx[9];\n\t\t\tif (dirty & /*value*/ 4096) rangeinput_changes.valueLabel = `${Math.round(radToDeg(/*value*/ ctx[12]))}`;\n\t\t\tif (dirty & /*oninputstart*/ 4) rangeinput_changes.oninputstart = /*oninputstart*/ ctx[2];\n\t\t\tif (dirty & /*oninputmove, sign, turns*/ 3080) rangeinput_changes.oninputmove = /*func*/ ctx[14];\n\t\t\tif (dirty & /*oninputend, sign, turns*/ 3088) rangeinput_changes.oninputend = /*func_1*/ ctx[15];\n\t\t\trangeinput.$set(rangeinput_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(rangeinput.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(rangeinput.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(rangeinput);\n\t\t}\n\t};\n}\n\nconst MARGIN = 1e-9;\n\nfunction instance$p($$self, $$props, $$invalidate) {\n\tconst HALF_PI = Math.PI / 2;\n\tconst QUARTER_PI = Math.PI / 4;\n\tlet { rotation } = $$props;\n\tlet { valueMin } = $$props;\n\tlet { valueMax } = $$props;\n\tlet { oninputstart = noop } = $$props;\n\tlet { oninputmove = noop } = $$props;\n\tlet { oninputend = noop } = $$props;\n\tlet { elasticity = 0 } = $$props;\n\tlet { labelReset = undefined } = $$props;\n\tconst func = value => oninputmove(sign * turns + value);\n\tconst func_1 = value => oninputend(sign * turns + value);\n\n\t$$self.$$set = $$props => {\n\t\tif (\"rotation\" in $$props) $$invalidate(13, rotation = $$props.rotation);\n\t\tif (\"valueMin\" in $$props) $$invalidate(0, valueMin = $$props.valueMin);\n\t\tif (\"valueMax\" in $$props) $$invalidate(1, valueMax = $$props.valueMax);\n\t\tif (\"oninputstart\" in $$props) $$invalidate(2, oninputstart = $$props.oninputstart);\n\t\tif (\"oninputmove\" in $$props) $$invalidate(3, oninputmove = $$props.oninputmove);\n\t\tif (\"oninputend\" in $$props) $$invalidate(4, oninputend = $$props.oninputend);\n\t\tif (\"elasticity\" in $$props) $$invalidate(5, elasticity = $$props.elasticity);\n\t\tif (\"labelReset\" in $$props) $$invalidate(6, labelReset = $$props.labelReset);\n\t};\n\n\tlet min;\n\tlet max;\n\tlet center;\n\tlet sign;\n\tlet turns;\n\tlet value;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*min, max*/ 384) {\n\t\t\t $$invalidate(9, center = min + (max - min) * 0.5);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*rotation*/ 8192) {\n\t\t\t $$invalidate(10, sign = Math.sign(rotation));\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*rotation*/ 8192) {\n\t\t\t $$invalidate(11, turns = Math.round(Math.abs(rotation) / HALF_PI) * HALF_PI);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*rotation, sign, turns*/ 11264) {\n\t\t\t $$invalidate(12, value = rotation - sign * turns);\n\t\t}\n\t};\n\n\t $$invalidate(7, min = -QUARTER_PI + MARGIN);\n\t $$invalidate(8, max = QUARTER_PI - MARGIN);\n\n\treturn [\n\t\tvalueMin,\n\t\tvalueMax,\n\t\toninputstart,\n\t\toninputmove,\n\t\toninputend,\n\t\telasticity,\n\t\tlabelReset,\n\t\tmin,\n\t\tmax,\n\t\tcenter,\n\t\tsign,\n\t\tturns,\n\t\tvalue,\n\t\trotation,\n\t\tfunc,\n\t\tfunc_1\n\t];\n}\n\nclass ImageRotator extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$p, create_fragment$p, safe_not_equal, {\n\t\t\trotation: 13,\n\t\t\tvalueMin: 0,\n\t\t\tvalueMax: 1,\n\t\t\toninputstart: 2,\n\t\t\toninputmove: 3,\n\t\t\toninputend: 4,\n\t\t\telasticity: 5,\n\t\t\tlabelReset: 6\n\t\t});\n\t}\n}\n\n/* src/core/ui/plugins/crop/components/ImageInfo.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$q(ctx) {\n\tlet div;\n\tlet p;\n\tlet t0;\n\tlet t1;\n\tlet t2;\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tp = element(\"p\");\n\t\t\tt0 = text(/*width*/ ctx[0]);\n\t\t\tt1 = text(\"  \");\n\t\t\tt2 = text(/*height*/ ctx[1]);\n\t\t\tattr(div, \"class\", \"DokaImageInfo\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tappend(div, p);\n\t\t\tappend(p, t0);\n\t\t\tappend(p, t1);\n\t\t\tappend(p, t2);\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*width*/ 1) set_data(t0, /*width*/ ctx[0]);\n\t\t\tif (dirty & /*height*/ 2) set_data(t2, /*height*/ ctx[1]);\n\t\t},\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t}\n\t};\n}\n\nfunction instance$q($$self, $$props, $$invalidate) {\n\tlet { width } = $$props;\n\tlet { height } = $$props;\n\n\t$$self.$$set = $$props => {\n\t\tif (\"width\" in $$props) $$invalidate(0, width = $$props.width);\n\t\tif (\"height\" in $$props) $$invalidate(1, height = $$props.height);\n\t};\n\n\treturn [width, height];\n}\n\nclass ImageInfo extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$q, create_fragment$q, safe_not_equal, { width: 0, height: 1 });\n\t}\n}\n\nvar getSelectionPresetOptionIcon = (value, options = {}) => {\n    const { width = 24, height = 24, bounds = 16, radius = 3 } = options;\n    let aspectRatio = isArray(value) ? getAspectRatio(value[0], value[1]) : value;\n    let aspectRatioDefined = !!aspectRatio;\n    aspectRatio = aspectRatioDefined ? aspectRatio : 1;\n    let x;\n    let y;\n    let w;\n    let h;\n    w = aspectRatio > 1 ? bounds : aspectRatio * bounds;\n    h = w / aspectRatio;\n    x = Math.round((width - w) * 0.5);\n    y = Math.round((height - h) * 0.5);\n    const fill = aspectRatioDefined ? 'currentColor' : 'none';\n    const stroke = aspectRatioDefined ? 'none' : 'currentColor';\n    const strokeWidth = width / 16;\n    const strokeDashArray = [width / 12, width / 6].join(' ');\n    return `<rect fill=\"${fill}\" stroke=\"${stroke}\" stroke-width=\"${strokeWidth}\" stroke-dasharray=\"${strokeDashArray}\" x=\"${x}\" y=\"${y}\" width=\"${w}\" height=\"${h}\" rx=\"${radius}\"/>`;\n};\n\n/* src/core/ui/plugins/crop/index.svelte generated by Svelte v3.29.4 */\n\nfunction create_default_slot_3$3(ctx) {\n\tlet dynamiccomponenttree;\n\tlet current;\n\tdynamiccomponenttree = new DynamicComponentTree_1({ props: { items: /*tools*/ ctx[0] } });\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(dynamiccomponenttree.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(dynamiccomponenttree, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst dynamiccomponenttree_changes = {};\n\t\t\tif (dirty[0] & /*tools*/ 1) dynamiccomponenttree_changes.items = /*tools*/ ctx[0];\n\t\t\tdynamiccomponenttree.$set(dynamiccomponenttree_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(dynamiccomponenttree.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(dynamiccomponenttree.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(dynamiccomponenttree, detaching);\n\t\t}\n\t};\n}\n\n// (1208:4) <div slot=\"header\">\nfunction create_header_slot(ctx) {\n\tlet div;\n\tlet toolbar;\n\tlet current;\n\n\ttoolbar = new Toolbar({\n\t\t\tprops: {\n\t\t\t\t$$slots: { default: [create_default_slot_3$3] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(toolbar.$$.fragment);\n\t\t\tattr(div, \"slot\", \"header\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(toolbar, div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst toolbar_changes = {};\n\n\t\t\tif (dirty[0] & /*tools*/ 1 | dirty[5] & /*$$scope*/ 16384) {\n\t\t\t\ttoolbar_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ttoolbar.$set(toolbar_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(toolbar.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(toolbar.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(toolbar);\n\t\t}\n\t};\n}\n\n// (1232:12) {#if shouldRenderImageSelection && shouldRenderImageSelectionRecenterButton}\nfunction create_if_block_6$2(ctx) {\n\tlet button;\n\tlet current;\n\n\tbutton = new Button({\n\t\t\tprops: {\n\t\t\t\tonclick: /*handleRecenterAction*/ ctx[74],\n\t\t\t\tlabel: /*locale*/ ctx[4].cropLabelButtonRecenter,\n\t\t\t\ticon: /*locale*/ ctx[4].cropIconButtonRecenter,\n\t\t\t\tclass: \"DokaButtonCenter\",\n\t\t\t\tdisabled: !/*canCenter*/ ctx[11],\n\t\t\t\thideLabel: true,\n\t\t\t\tstyle: `opacity: ${/*$recenterOpacity*/ ctx[24]}; transform: translate3d(${/*$recenterOffset*/ ctx[25].x}px, ${/*$recenterOffset*/ ctx[25].y}px, 0)`\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(button.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(button, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst button_changes = {};\n\t\t\tif (dirty[0] & /*locale*/ 16) button_changes.label = /*locale*/ ctx[4].cropLabelButtonRecenter;\n\t\t\tif (dirty[0] & /*locale*/ 16) button_changes.icon = /*locale*/ ctx[4].cropIconButtonRecenter;\n\t\t\tif (dirty[0] & /*canCenter*/ 2048) button_changes.disabled = !/*canCenter*/ ctx[11];\n\t\t\tif (dirty[0] & /*$recenterOpacity, $recenterOffset*/ 50331648) button_changes.style = `opacity: ${/*$recenterOpacity*/ ctx[24]}; transform: translate3d(${/*$recenterOffset*/ ctx[25].x}px, ${/*$recenterOffset*/ ctx[25].y}px, 0)`;\n\t\t\tbutton.$set(button_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(button.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(button.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(button, detaching);\n\t\t}\n\t};\n}\n\n// (1244:12) {#if shouldRenderImageSelection}\nfunction create_if_block_5$2(ctx) {\n\tlet rectmanipulator;\n\tlet current;\n\n\trectmanipulator = new RectManipulator({\n\t\t\tprops: {\n\t\t\t\trect: /*imageSelectionRectOffset*/ ctx[14],\n\t\t\t\tvisible: /*$isActive*/ ctx[16],\n\t\t\t\tstyle: /*cropImageSelectionCornerStyle*/ ctx[2]\n\t\t\t}\n\t\t});\n\n\trectmanipulator.$on(\"resizestart\", /*handleSelectionGrab*/ ctx[57]);\n\trectmanipulator.$on(\"resizemove\", /*handleSelectionDrag*/ ctx[58]);\n\trectmanipulator.$on(\"resizeend\", /*handleSelectionRelease*/ ctx[59]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(rectmanipulator.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(rectmanipulator, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst rectmanipulator_changes = {};\n\t\t\tif (dirty[0] & /*imageSelectionRectOffset*/ 16384) rectmanipulator_changes.rect = /*imageSelectionRectOffset*/ ctx[14];\n\t\t\tif (dirty[0] & /*$isActive*/ 65536) rectmanipulator_changes.visible = /*$isActive*/ ctx[16];\n\t\t\tif (dirty[0] & /*cropImageSelectionCornerStyle*/ 4) rectmanipulator_changes.style = /*cropImageSelectionCornerStyle*/ ctx[2];\n\t\t\trectmanipulator.$set(rectmanipulator_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(rectmanipulator.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(rectmanipulator.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(rectmanipulator, detaching);\n\t\t}\n\t};\n}\n\n// (1256:8) {#if shouldRenderInfoIndicator}\nfunction create_if_block_4$3(ctx) {\n\tlet imageinfo;\n\tlet current;\n\n\timageinfo = new ImageInfo({\n\t\t\tprops: {\n\t\t\t\twidth: Math.round(/*$imageCropRect*/ ctx[7].width),\n\t\t\t\theight: Math.round(/*$imageCropRect*/ ctx[7].height)\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(imageinfo.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(imageinfo, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst imageinfo_changes = {};\n\t\t\tif (dirty[0] & /*$imageCropRect*/ 128) imageinfo_changes.width = Math.round(/*$imageCropRect*/ ctx[7].width);\n\t\t\tif (dirty[0] & /*$imageCropRect*/ 128) imageinfo_changes.height = Math.round(/*$imageCropRect*/ ctx[7].height);\n\t\t\timageinfo.$set(imageinfo_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(imageinfo.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(imageinfo.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(imageinfo, detaching);\n\t\t}\n\t};\n}\n\n// (1214:4) <div slot=\"main\">\nfunction create_main_slot(ctx) {\n\tlet div0;\n\tlet div1;\n\tlet t0;\n\tlet measurable_action;\n\tlet interactable_action;\n\tlet t1;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tlet if_block0 = /*shouldRenderImageSelection*/ ctx[13] && /*shouldRenderImageSelectionRecenterButton*/ ctx[15] && create_if_block_6$2(ctx);\n\tlet if_block1 = /*shouldRenderImageSelection*/ ctx[13] && create_if_block_5$2(ctx);\n\tlet if_block2 = /*shouldRenderInfoIndicator*/ ctx[12] && create_if_block_4$3(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv0 = element(\"div\");\n\t\t\tdiv1 = element(\"div\");\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt0 = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tt1 = space();\n\t\t\tif (if_block2) if_block2.c();\n\t\t\tattr(div1, \"class\", \"DokaStage\");\n\t\t\tattr(div0, \"slot\", \"main\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div0, anchor);\n\t\t\tappend(div0, div1);\n\t\t\tif (if_block0) if_block0.m(div1, null);\n\t\t\tappend(div1, t0);\n\t\t\tif (if_block1) if_block1.m(div1, null);\n\t\t\tappend(div0, t1);\n\t\t\tif (if_block2) if_block2.m(div0, null);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div1, \"measure\", /*measure_handler_1*/ ctx[98]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div1)),\n\t\t\t\t\tlisten(div1, \"wheel\", function () {\n\t\t\t\t\t\tif (is_function(/*cropEnableZoom*/ ctx[3] && /*handleWheel*/ ctx[73])) (/*cropEnableZoom*/ ctx[3] && /*handleWheel*/ ctx[73]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(div1, \"interactionstart\", /*handleImageDragStart*/ ctx[63]),\n\t\t\t\t\tlisten(div1, \"interactionupdate\", /*handleImageDrag*/ ctx[64]),\n\t\t\t\t\tlisten(div1, \"interactionrelease\", /*handleImageDragRelease*/ ctx[66]),\n\t\t\t\t\tlisten(div1, \"interactionend\", /*handleImageDragEnd*/ ctx[65]),\n\t\t\t\t\taction_destroyer(interactable_action = interactable.call(null, div1, {\n\t\t\t\t\t\tdrag: true,\n\t\t\t\t\t\tpinch: /*cropEnableZoom*/ ctx[3],\n\t\t\t\t\t\tinertia: true,\n\t\t\t\t\t\tmatchTarget: true,\n\t\t\t\t\t\tgetEventPosition: /*interactable_function*/ ctx[99]\n\t\t\t\t\t}))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\n\t\t\tif (/*shouldRenderImageSelection*/ ctx[13] && /*shouldRenderImageSelectionRecenterButton*/ ctx[15]) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*shouldRenderImageSelection, shouldRenderImageSelectionRecenterButton*/ 40960) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_6$2(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(div1, t0);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (/*shouldRenderImageSelection*/ ctx[13]) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*shouldRenderImageSelection*/ 8192) {\n\t\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block_5$2(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\tif_block1.m(div1, null);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block1, 1, 1, () => {\n\t\t\t\t\tif_block1 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (interactable_action && is_function(interactable_action.update) && dirty[0] & /*cropEnableZoom, $rootRect*/ 1032) interactable_action.update.call(null, {\n\t\t\t\tdrag: true,\n\t\t\t\tpinch: /*cropEnableZoom*/ ctx[3],\n\t\t\t\tinertia: true,\n\t\t\t\tmatchTarget: true,\n\t\t\t\tgetEventPosition: /*interactable_function*/ ctx[99]\n\t\t\t});\n\n\t\t\tif (/*shouldRenderInfoIndicator*/ ctx[12]) {\n\t\t\t\tif (if_block2) {\n\t\t\t\t\tif_block2.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*shouldRenderInfoIndicator*/ 4096) {\n\t\t\t\t\t\ttransition_in(if_block2, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block2 = create_if_block_4$3(ctx);\n\t\t\t\t\tif_block2.c();\n\t\t\t\t\ttransition_in(if_block2, 1);\n\t\t\t\t\tif_block2.m(div0, null);\n\t\t\t\t}\n\t\t\t} else if (if_block2) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block2, 1, 1, () => {\n\t\t\t\t\tif_block2 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\ttransition_in(if_block1);\n\t\t\ttransition_in(if_block2);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\ttransition_out(if_block1);\n\t\t\ttransition_out(if_block2);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div0);\n\t\t\tif (if_block0) if_block0.d();\n\t\t\tif (if_block1) if_block1.d();\n\t\t\tif (if_block2) if_block2.d();\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\n// (1264:4) {#if shouldRenderFooter}\nfunction create_if_block$6(ctx) {\n\tlet t;\n\tlet tabpanels;\n\tlet current;\n\tlet if_block = /*shouldRenderTabs*/ ctx[19] && create_if_block_3$3(ctx);\n\n\tconst tabpanels_spread_levels = [\n\t\t{ class: \"DokaControlPanels\" },\n\t\t{ panelClass: \"DokaControlPanel\" },\n\t\t{ panels: /*panels*/ ctx[22] },\n\t\t/*tabsConfig*/ ctx[20]\n\t];\n\n\tlet tabpanels_props = {\n\t\t$$slots: {\n\t\t\tdefault: [\n\t\t\t\tcreate_default_slot_1$4,\n\t\t\t\t({ panel }) => ({ 167: panel }),\n\t\t\t\t({ panel }) => [0, 0, 0, 0, 0, panel ? 4096 : 0]\n\t\t\t]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tfor (let i = 0; i < tabpanels_spread_levels.length; i += 1) {\n\t\ttabpanels_props = assign(tabpanels_props, tabpanels_spread_levels[i]);\n\t}\n\n\ttabpanels = new TabPanels({ props: tabpanels_props });\n\n\treturn {\n\t\tc() {\n\t\t\tif (if_block) if_block.c();\n\t\t\tt = space();\n\t\t\tcreate_component(tabpanels.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (if_block) if_block.m(target, anchor);\n\t\t\tinsert(target, t, anchor);\n\t\t\tmount_component(tabpanels, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*shouldRenderTabs*/ ctx[19]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*shouldRenderTabs*/ 524288) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_3$3(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(t.parentNode, t);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tconst tabpanels_changes = (dirty[0] & /*panels, tabsConfig*/ 5242880)\n\t\t\t? get_spread_update(tabpanels_spread_levels, [\n\t\t\t\t\ttabpanels_spread_levels[0],\n\t\t\t\t\ttabpanels_spread_levels[1],\n\t\t\t\t\tdirty[0] & /*panels*/ 4194304 && { panels: /*panels*/ ctx[22] },\n\t\t\t\t\tdirty[0] & /*tabsConfig*/ 1048576 && get_spread_object(/*tabsConfig*/ ctx[20])\n\t\t\t\t])\n\t\t\t: {};\n\n\t\t\tif (dirty[0] & /*$imageRotation, locale, $imageRotationRange, tabs, imageZoomLevelMin, $imageZoomLevelRange, $imageZoomLevel*/ 471859984 | dirty[5] & /*$$scope, panel*/ 20480) {\n\t\t\t\ttabpanels_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ttabpanels.$set(tabpanels_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\ttransition_in(tabpanels.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\ttransition_out(tabpanels.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (if_block) if_block.d(detaching);\n\t\t\tif (detaching) detach(t);\n\t\t\tdestroy_component(tabpanels, detaching);\n\t\t}\n\t};\n}\n\n// (1266:8) {#if shouldRenderTabs}\nfunction create_if_block_3$3(ctx) {\n\tlet tablist;\n\tlet current;\n\n\tconst tablist_spread_levels = [\n\t\t{ class: \"DokaControlList\" },\n\t\t{ tabs: /*tabs*/ ctx[21] },\n\t\t/*tabsConfig*/ ctx[20]\n\t];\n\n\tlet tablist_props = {\n\t\t$$slots: {\n\t\t\tdefault: [\n\t\t\t\tcreate_default_slot_2$3,\n\t\t\t\t({ tab }) => ({ 168: tab }),\n\t\t\t\t({ tab }) => [0, 0, 0, 0, 0, tab ? 8192 : 0]\n\t\t\t]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tfor (let i = 0; i < tablist_spread_levels.length; i += 1) {\n\t\ttablist_props = assign(tablist_props, tablist_spread_levels[i]);\n\t}\n\n\ttablist = new TabList({ props: tablist_props });\n\ttablist.$on(\"select\", /*select_handler*/ ctx[100]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(tablist.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(tablist, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst tablist_changes = (dirty[0] & /*tabs, tabsConfig*/ 3145728)\n\t\t\t? get_spread_update(tablist_spread_levels, [\n\t\t\t\t\ttablist_spread_levels[0],\n\t\t\t\t\tdirty[0] & /*tabs*/ 2097152 && { tabs: /*tabs*/ ctx[21] },\n\t\t\t\t\tdirty[0] & /*tabsConfig*/ 1048576 && get_spread_object(/*tabsConfig*/ ctx[20])\n\t\t\t\t])\n\t\t\t: {};\n\n\t\t\tif (dirty[5] & /*$$scope, tab*/ 24576) {\n\t\t\t\ttablist_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ttablist.$set(tablist_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(tablist.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(tablist.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(tablist, detaching);\n\t\t}\n\t};\n}\n\n// (1267:8) <TabList class=\"DokaControlList\" {tabs} {...tabsConfig} on:select={({ detail }) => transformSelected = detail} let:tab={tab}>\nfunction create_default_slot_2$3(ctx) {\n\tlet span;\n\tlet t_value = /*tab*/ ctx[168].label + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[5] & /*tab*/ 8192 && t_value !== (t_value = /*tab*/ ctx[168].label + \"\")) set_data(t, t_value);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (1283:43) \nfunction create_if_block_2$5(ctx) {\n\tlet rangeinput;\n\tlet current;\n\n\trangeinput = new RangeInput({\n\t\t\tprops: {\n\t\t\t\telasticity: /*elasticityMultiplier*/ ctx[34] * /*rangeInputElasticity*/ ctx[35],\n\t\t\t\tbase: imageZoomLevelBase,\n\t\t\t\tmin: /*imageZoomLevelMin*/ ctx[9],\n\t\t\t\tmax: imageZoomLevelMax,\n\t\t\t\tvalueMin: /*$imageZoomLevelRange*/ ctx[27][0],\n\t\t\t\tvalueMax: /*$imageZoomLevelRange*/ ctx[27][1],\n\t\t\t\tvalue: /*$imageZoomLevel*/ ctx[28],\n\t\t\t\tlabelReset: /*locale*/ ctx[4].labelReset,\n\t\t\t\tvalueLabel: `${Math.round(/*$imageZoomLevel*/ ctx[28] * 100)}%`,\n\t\t\t\toninputstart: /*handleResizeStart*/ ctx[70],\n\t\t\t\toninputmove: /*handleResizeMove*/ ctx[71],\n\t\t\t\toninputend: /*handleResizeEnd*/ ctx[72]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(rangeinput.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(rangeinput, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst rangeinput_changes = {};\n\t\t\tif (dirty[0] & /*imageZoomLevelMin*/ 512) rangeinput_changes.min = /*imageZoomLevelMin*/ ctx[9];\n\t\t\tif (dirty[0] & /*$imageZoomLevelRange*/ 134217728) rangeinput_changes.valueMin = /*$imageZoomLevelRange*/ ctx[27][0];\n\t\t\tif (dirty[0] & /*$imageZoomLevelRange*/ 134217728) rangeinput_changes.valueMax = /*$imageZoomLevelRange*/ ctx[27][1];\n\t\t\tif (dirty[0] & /*$imageZoomLevel*/ 268435456) rangeinput_changes.value = /*$imageZoomLevel*/ ctx[28];\n\t\t\tif (dirty[0] & /*locale*/ 16) rangeinput_changes.labelReset = /*locale*/ ctx[4].labelReset;\n\t\t\tif (dirty[0] & /*$imageZoomLevel*/ 268435456) rangeinput_changes.valueLabel = `${Math.round(/*$imageZoomLevel*/ ctx[28] * 100)}%`;\n\t\t\trangeinput.$set(rangeinput_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(rangeinput.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(rangeinput.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(rangeinput, detaching);\n\t\t}\n\t};\n}\n\n// (1273:12) {#if panel === tabs[0].id }\nfunction create_if_block_1$7(ctx) {\n\tlet imagerotator;\n\tlet current;\n\n\timagerotator = new ImageRotator({\n\t\t\tprops: {\n\t\t\t\telasticity: /*elasticityMultiplier*/ ctx[34] * /*rangeInputElasticity*/ ctx[35],\n\t\t\t\trotation: /*$imageRotation*/ ctx[8],\n\t\t\t\tlabelReset: /*locale*/ ctx[4].labelReset,\n\t\t\t\tvalueMin: /*$imageRotationRange*/ ctx[26][0],\n\t\t\t\tvalueMax: /*$imageRotationRange*/ ctx[26][1],\n\t\t\t\toninputstart: /*handleRotateStart*/ ctx[60],\n\t\t\t\toninputmove: /*handleRotateMove*/ ctx[61],\n\t\t\t\toninputend: /*handleRotateEnd*/ ctx[62]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(imagerotator.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(imagerotator, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst imagerotator_changes = {};\n\t\t\tif (dirty[0] & /*$imageRotation*/ 256) imagerotator_changes.rotation = /*$imageRotation*/ ctx[8];\n\t\t\tif (dirty[0] & /*locale*/ 16) imagerotator_changes.labelReset = /*locale*/ ctx[4].labelReset;\n\t\t\tif (dirty[0] & /*$imageRotationRange*/ 67108864) imagerotator_changes.valueMin = /*$imageRotationRange*/ ctx[26][0];\n\t\t\tif (dirty[0] & /*$imageRotationRange*/ 67108864) imagerotator_changes.valueMax = /*$imageRotationRange*/ ctx[26][1];\n\t\t\timagerotator.$set(imagerotator_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(imagerotator.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(imagerotator.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(imagerotator, detaching);\n\t\t}\n\t};\n}\n\n// (1272:8) <TabPanels class=\"DokaControlPanels\" panelClass=\"DokaControlPanel\" {panels} {...tabsConfig} let:panel>\nfunction create_default_slot_1$4(ctx) {\n\tlet current_block_type_index;\n\tlet if_block;\n\tlet if_block_anchor;\n\tlet current;\n\tconst if_block_creators = [create_if_block_1$7, create_if_block_2$5];\n\tconst if_blocks = [];\n\n\tfunction select_block_type(ctx, dirty) {\n\t\tif (/*panel*/ ctx[167] === /*tabs*/ ctx[21][0].id) return 0;\n\t\tif (/*panel*/ ctx[167] === /*tabs*/ ctx[21][1].id) return 1;\n\t\treturn -1;\n\t}\n\n\tif (~(current_block_type_index = select_block_type(ctx))) {\n\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tif (if_block) if_block.c();\n\t\t\tif_block_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (~current_block_type_index) {\n\t\t\t\tif_blocks[current_block_type_index].m(target, anchor);\n\t\t\t}\n\n\t\t\tinsert(target, if_block_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tlet previous_block_index = current_block_type_index;\n\t\t\tcurrent_block_type_index = select_block_type(ctx);\n\n\t\t\tif (current_block_type_index === previous_block_index) {\n\t\t\t\tif (~current_block_type_index) {\n\t\t\t\t\tif_blocks[current_block_type_index].p(ctx, dirty);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tgroup_outros();\n\n\t\t\t\t\ttransition_out(if_blocks[previous_block_index], 1, 1, () => {\n\t\t\t\t\t\tif_blocks[previous_block_index] = null;\n\t\t\t\t\t});\n\n\t\t\t\t\tcheck_outros();\n\t\t\t\t}\n\n\t\t\t\tif (~current_block_type_index) {\n\t\t\t\t\tif_block = if_blocks[current_block_type_index];\n\n\t\t\t\t\tif (!if_block) {\n\t\t\t\t\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t\t\t\t\t\tif_block.c();\n\t\t\t\t\t}\n\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(if_block_anchor.parentNode, if_block_anchor);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (~current_block_type_index) {\n\t\t\t\tif_blocks[current_block_type_index].d(detaching);\n\t\t\t}\n\n\t\t\tif (detaching) detach(if_block_anchor);\n\t\t}\n\t};\n}\n\n// (1263:4) <div slot=\"footer\" style={footerStyle}>\nfunction create_footer_slot(ctx) {\n\tlet div;\n\tlet current;\n\tlet if_block = /*shouldRenderFooter*/ ctx[18] && create_if_block$6(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(div, \"slot\", \"footer\");\n\t\t\tattr(div, \"style\", /*footerStyle*/ ctx[23]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tif (if_block) if_block.m(div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*shouldRenderFooter*/ ctx[18]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*shouldRenderFooter*/ 262144) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block$6(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div, null);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*footerStyle*/ 8388608) {\n\t\t\t\tattr(div, \"style\", /*footerStyle*/ ctx[23]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (if_block) if_block.d();\n\t\t}\n\t};\n}\n\n// (1206:0) <Util hasHeader={shouldRenderToolbar} on:measure bind:root>\nfunction create_default_slot$6(ctx) {\n\tlet t0;\n\tlet t1;\n\n\treturn {\n\t\tc() {\n\t\t\tt0 = space();\n\t\t\tt1 = space();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, t0, anchor);\n\t\t\tinsert(target, t1, anchor);\n\t\t},\n\t\tp: noop$1,\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(t0);\n\t\t\tif (detaching) detach(t1);\n\t\t}\n\t};\n}\n\nfunction create_fragment$r(ctx) {\n\tlet util;\n\tlet updating_root;\n\tlet current;\n\n\tfunction util_root_binding(value) {\n\t\t/*util_root_binding*/ ctx[101].call(null, value);\n\t}\n\n\tlet util_props = {\n\t\thasHeader: /*shouldRenderToolbar*/ ctx[17],\n\t\t$$slots: {\n\t\t\tdefault: [create_default_slot$6],\n\t\t\tfooter: [create_footer_slot],\n\t\t\tmain: [create_main_slot],\n\t\t\theader: [create_header_slot]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tif (/*root*/ ctx[6] !== void 0) {\n\t\tutil_props.root = /*root*/ ctx[6];\n\t}\n\n\tutil = new Util({ props: util_props });\n\tbinding_callbacks.push(() => bind(util, \"root\", util_root_binding));\n\tutil.$on(\"measure\", /*measure_handler*/ ctx[102]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(util.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(util, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst util_changes = {};\n\t\t\tif (dirty[0] & /*shouldRenderToolbar*/ 131072) util_changes.hasHeader = /*shouldRenderToolbar*/ ctx[17];\n\n\t\t\tif (dirty[0] & /*footerStyle, panels, tabsConfig, $imageRotation, locale, $imageRotationRange, tabs, imageZoomLevelMin, $imageZoomLevelRange, $imageZoomLevel, transformSelected, shouldRenderTabs, shouldRenderFooter, $imageCropRect, shouldRenderInfoIndicator, cropEnableZoom, $rootRect, imageSelectionRectOffset, $isActive, cropImageSelectionCornerStyle, shouldRenderImageSelection, canCenter, $recenterOpacity, $recenterOffset, shouldRenderImageSelectionRecenterButton, tools*/ 536739773 | dirty[5] & /*$$scope*/ 16384) {\n\t\t\t\tutil_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tif (!updating_root && dirty[0] & /*root*/ 64) {\n\t\t\t\tupdating_root = true;\n\t\t\t\tutil_changes.root = /*root*/ ctx[6];\n\t\t\t\tadd_flush_callback(() => updating_root = false);\n\t\t\t}\n\n\t\t\tutil.$set(util_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(util.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(util.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(util, detaching);\n\t\t}\n\t};\n}\n\nconst imageZoomLevelMax = 1;\nconst imageZoomLevelBase = 0;\n\nfunction instance$r($$self, $$props, $$invalidate) {\n\tlet $imageCropAspectRatio;\n\tlet $imageCropRect;\n\tlet $imageSize;\n\tlet $imageRotation;\n\tlet $imageFlipY;\n\tlet $imageFlipX;\n\tlet $selectedPresetIndex;\n\tlet $imageOutputSize;\n\tlet $imageCropMinSize;\n\tlet $imageCropLimitToImage;\n\tlet $isInteracting;\n\tlet $imageSelectionRectSnapshot;\n\tlet $imageSelectionRect;\n\tlet $presentationScalar;\n\tlet $imageCropMaxSize;\n\tlet $imageSelectionRectIntent;\n\tlet $utilRect;\n\tlet $imageCropRectOrigin;\n\tlet $imageCropRectIntent;\n\tlet $imageCropRange;\n\tlet $rootRect;\n\tlet $stageRect;\n\tlet $imageCropRangeAspectRatio;\n\tlet $imageSelectionRectPresentation;\n\tlet $env;\n\tlet $imageScalar;\n\n\tlet $isActive,\n\t\t$$unsubscribe_isActive = noop$1,\n\t\t$$subscribe_isActive = () => ($$unsubscribe_isActive(), $$unsubscribe_isActive = subscribe(isActive, $$value => $$invalidate(16, $isActive = $$value)), isActive);\n\n\tlet $imagePreviewModifiers;\n\tlet $footerOffset;\n\tlet $recenterOpacity;\n\tlet $recenterOffset;\n\tlet $imageRotationRange;\n\tlet $imageZoomLevelRange;\n\tlet $imageZoomLevel;\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_isActive());\n\tconst name = \"crop\";\n\tlet { isActive } = $$props;\n\t$$subscribe_isActive();\n\tlet { stores } = $$props;\n\tlet { cropImageSelectionCornerStyle = \"circle\" } = $$props; // 'circle', 'hook'\n\tlet { cropAutoCenterImageSelectionTimeout = undefined } = $$props;\n\tlet { cropEnableZoomMatchImageAspectRatio = true } = $$props;\n\tlet { cropEnableRotateMatchImageAspectRatio = \"never\" } = $$props; // 'always' | 'custom' | 'never'\n\tlet { cropEnableRotationInput = true } = $$props;\n\tlet { cropEnableZoom = true } = $$props;\n\tlet { cropEnableZoomInput = true } = $$props;\n\tlet { cropEnableImageSelection = true } = $$props;\n\tlet { cropEnableInfoIndicator = false } = $$props;\n\tlet { cropEnableZoomTowardsWheelPosition = true } = $$props;\n\tlet { cropEnableLimitWheelInputToCropSelection = true } = $$props;\n\tlet { cropEnableCenterImageSelection = true } = $$props;\n\tlet { cropEnableButtonRotateLeft = true } = $$props;\n\tlet { cropEnableButtonRotateRight = false } = $$props;\n\tlet { cropEnableButtonFlipHorizontal = true } = $$props;\n\tlet { cropEnableButtonFlipVertical = false } = $$props;\n\tlet { cropSelectPresetOptions = undefined } = $$props;\n\tlet { cropEnableSelectPreset = true } = $$props;\n\tlet { cropEnableButtonToggleCropLimit = false } = $$props;\n\tlet { locale = {} } = $$props;\n\tlet { tools = [] } = $$props;\n\tconst isCustomCrop = () => $imageCropAspectRatio === undefined;\n\tconst turnAspectRatio = aspectRatio => 1 / aspectRatio;\n\n\tconst hasValidRotatedCropAspectRatio = () => {\n\t\tif ($imageCropAspectRatio === 1) return false;\n\t\tconst rotatedImageCropAspectRatio = turnAspectRatio($imageCropAspectRatio);\n\n\t\t// no options available, forced crop aspect ratio\n\t\tif (!cropSelectPresetOptions) return false;\n\n\t\t// options available but no valid option in list\n\t\tif (!flattenOptions(cropSelectPresetOptions).find(([aspectRatio]) => aspectRatio === rotatedImageCropAspectRatio)) return false;\n\n\t\treturn true;\n\t};\n\n\tconst isCropMaxSize = (imageCropRect, imageSize, imageRotation) => isRotatedSideways(imageRotation)\n\t? imageSize.width === Math.round(imageCropRect.height) || imageSize.height === Math.round(imageCropRect.width)\n\t: imageSize.width === Math.round(imageCropRect.width) || imageSize.height === Math.round(imageCropRect.height);\n\n\tconst isCropCentered = (imageCropRect, imageSize, imageRotation) => {\n\t\tconst imageSizeRotated = sizeApply(sizeRotate(sizeClone(imageSize), imageRotation), v => Math.abs(Math.round(v)));\n\t\tconst imageCenter = sizeCenter(imageSizeRotated);\n\t\tconst cropCenter = rectCenter(imageCropRect);\n\t\treturn vectorEqual(imageCenter, cropCenter);\n\t};\n\n\tconst canMatchCropAspectRatioToRotation = () => (// is custom crop mode\n\tisCustomCrop() || // can match preset crop and preset is available\n\tcropEnableRotateMatchImageAspectRatio === \"always\" && hasValidRotatedCropAspectRatio()) && isCropCentered($imageCropRect, $imageSize, $imageRotation) && isCropMaxSize($imageCropRect, $imageSize, $imageRotation);\n\n\tconst applyRotation = value => {\n\t\tif (cropEnableRotateMatchImageAspectRatio !== \"never\" && canMatchCropAspectRatioToRotation()) {\n\t\t\tset_store_value(imageRotation, $imageRotation += value, $imageRotation);\n\t\t\tconst isRotated = isRotatedSideways($imageRotation);\n\t\t\tconst w = isRotated ? $imageSize.height : $imageSize.width;\n\t\t\tconst h = isRotated ? $imageSize.width : $imageSize.height;\n\t\t\tset_store_value(imageCropRect, $imageCropRect = rectCreate(0, 0, w, h), $imageCropRect);\n\t\t\tif (!isCustomCrop()) set_store_value(imageCropAspectRatio, $imageCropAspectRatio = getAspectRatio(w, h), $imageCropAspectRatio);\n\t\t} else {\n\t\t\tset_store_value(imageRotation, $imageRotation += value, $imageRotation);\n\t\t}\n\t};\n\n\tconst { history, env, isInteracting, rootRect, stageRect, utilRect, elasticityMultiplier, rangeInputElasticity, presentationScalar, // effect filtering\n\timagePreviewModifiers, // crop selection\n\timageFlipX, imageFlipY, imageRotation, imageRotationRange, imageOutputSize, imageSelectionRect, imageSelectionRectSnapshot, imageSelectionRectIntent, imageSelectionRectPresentation, imageCropRectIntent, imageCropRectOrigin, imageCropRect, imageCropMinSize, imageCropMaxSize, imageCropRange, imageCropAspectRatio, imageCropRectAspectRatio, imageCropLimitToImage, imageSize, imageScalar } = stores; // the actual limited rectangle\n\t// used to calculate rectangle while dragging\n\t// can be used to set set intended rectangle\n\t// readonly\n\n\tcomponent_subscribe($$self, env, value => $$invalidate(140, $env = value));\n\tcomponent_subscribe($$self, isInteracting, value => $$invalidate(120, $isInteracting = value));\n\tcomponent_subscribe($$self, rootRect, value => $$invalidate(10, $rootRect = value));\n\tcomponent_subscribe($$self, stageRect, value => $$invalidate(130, $stageRect = value));\n\tcomponent_subscribe($$self, utilRect, value => $$invalidate(126, $utilRect = value));\n\tcomponent_subscribe($$self, presentationScalar, value => $$invalidate(123, $presentationScalar = value));\n\tcomponent_subscribe($$self, imagePreviewModifiers, value => $$invalidate(143, $imagePreviewModifiers = value));\n\tcomponent_subscribe($$self, imageFlipX, value => $$invalidate(113, $imageFlipX = value));\n\tcomponent_subscribe($$self, imageFlipY, value => $$invalidate(112, $imageFlipY = value));\n\tcomponent_subscribe($$self, imageRotation, value => $$invalidate(8, $imageRotation = value));\n\tcomponent_subscribe($$self, imageRotationRange, value => $$invalidate(26, $imageRotationRange = value));\n\tcomponent_subscribe($$self, imageOutputSize, value => $$invalidate(116, $imageOutputSize = value));\n\tcomponent_subscribe($$self, imageSelectionRect, value => $$invalidate(122, $imageSelectionRect = value));\n\tcomponent_subscribe($$self, imageSelectionRectSnapshot, value => $$invalidate(121, $imageSelectionRectSnapshot = value));\n\tcomponent_subscribe($$self, imageSelectionRectIntent, value => $$invalidate(125, $imageSelectionRectIntent = value));\n\tcomponent_subscribe($$self, imageSelectionRectPresentation, value => $$invalidate(134, $imageSelectionRectPresentation = value));\n\tcomponent_subscribe($$self, imageCropRectIntent, value => $$invalidate(128, $imageCropRectIntent = value));\n\tcomponent_subscribe($$self, imageCropRectOrigin, value => $$invalidate(127, $imageCropRectOrigin = value));\n\tcomponent_subscribe($$self, imageCropRect, value => $$invalidate(7, $imageCropRect = value));\n\tcomponent_subscribe($$self, imageCropMinSize, value => $$invalidate(118, $imageCropMinSize = value));\n\tcomponent_subscribe($$self, imageCropMaxSize, value => $$invalidate(124, $imageCropMaxSize = value));\n\tcomponent_subscribe($$self, imageCropRange, value => $$invalidate(129, $imageCropRange = value));\n\tcomponent_subscribe($$self, imageCropAspectRatio, value => $$invalidate(110, $imageCropAspectRatio = value));\n\tcomponent_subscribe($$self, imageCropLimitToImage, value => $$invalidate(119, $imageCropLimitToImage = value));\n\tcomponent_subscribe($$self, imageSize, value => $$invalidate(111, $imageSize = value));\n\tcomponent_subscribe($$self, imageScalar, value => $$invalidate(142, $imageScalar = value));\n\n\t//\n\t// resizing crop\n\t//\n\tlet presentationScalarSnapshot;\n\n\tlet imageSelectionRectMinSize;\n\tlet imageSelectionRectMaxSize;\n\n\tconst handleSelectionGrab = () => {\n\t\t// now interacting\n\t\tset_store_value(isInteracting, $isInteracting = true, $isInteracting);\n\n\t\t// we remember the current view rect and crop rect, because that is the crop rect we use as a starting point to transform while dragging\n\t\tset_store_value(imageSelectionRectSnapshot, $imageSelectionRectSnapshot = rectClone($imageSelectionRect), $imageSelectionRectSnapshot);\n\n\t\t// remember current scalar so we can update min and max size correctly\n\t\tpresentationScalarSnapshot = $presentationScalar;\n\n\t\timageSelectionRectMinSize = sizeScale(sizeClone($imageCropMinSize), presentationScalarSnapshot);\n\t\timageSelectionRectMaxSize = sizeScale(sizeClone($imageCropMaxSize), presentationScalarSnapshot);\n\t};\n\n\tconst handleSelectionDrag = ({ detail }) => {\n\t\tconst { boundsLimited, boundsIntent } = translateSelection(detail.direction, detail.translation);\n\n\t\t// update actual image selection rectangle\n\t\tset_store_value(imageSelectionRectIntent, $imageSelectionRectIntent = boundsIntent, $imageSelectionRectIntent); // intent needs to be updated first because has no listeners attached\n\n\t\tset_store_value(imageSelectionRect, $imageSelectionRect = boundsLimited, $imageSelectionRect);\n\t};\n\n\tconst handleSelectionRelease = ({ detail }) => {\n\t\tconst { boundsLimited } = translateSelection(detail.direction, detail.translation);\n\n\t\t// we're no longer interacting with the image selection, we need to set this here so the image selection presentation is animated when applying the new bounds below\n\t\tset_store_value(isInteracting, $isInteracting = false, $isInteracting);\n\n\t\t// no more intent as we're finalizing the selection, so before setting the final selection, we set this to undefined | intent needs to be updated first because has no listeners attached\n\t\tset_store_value(imageSelectionRectIntent, $imageSelectionRectIntent = undefined, $imageSelectionRectIntent);\n\n\t\t// confirm the limited rect if actually made a change\n\t\tif (vectorLength(detail.translation)) {\n\t\t\tset_store_value(imageSelectionRect, $imageSelectionRect = boundsLimited, $imageSelectionRect);\n\t\t\thistory.write();\n\t\t}\n\n\t\t// need to set this to undefined after setting the final rect, the snapshot is used to calculate the crop rect transform\n\t\tset_store_value(imageSelectionRectSnapshot, $imageSelectionRectSnapshot = undefined, $imageSelectionRectSnapshot);\n\t};\n\n\tconst translateSelection = (target, translate) => {\n\t\t// - selection may grow to max bounds (util bounds)\n\t\t// - the image preview(!) is scaled to fit the selection, actual image size is not affected\n\t\t// - we need to make sure the selection adheres to the aspect ratio of the min size\n\t\tconst directionTranslation = { target, translate };\n\n\t\tlet rectIntended = applyRectDirectionTranslation($imageSelectionRectSnapshot, directionTranslation, { aspectRatio: $imageCropAspectRatio });\n\t\tlet cropAspectRatioLimited;\n\n\t\t// size in crop rect\n\t\tconst cropSize = sizeCreateFromRect(rectDivide(rectClone(rectIntended), $presentationScalar));\n\n\t\tconst imagePolygon = getImagePolygon($imageSize, $imageRotation);\n\t\tconst imageCenter = quadCentroid(imagePolygon);\n\n\t\t// if one of the edges is small and not both are smaller we need to correct\n\t\tif (cropSize.width < $imageCropMinSize.width || cropSize.height < $imageCropMinSize.height) {\n\t\t\t// if moving towards the center of the crop, it can't exceed bounds\n\t\t\tconst translateUp = translate.y < 0;\n\n\t\t\tconst translateRight = translate.x > 0;\n\t\t\tconst translateLeft = translate.x < 0;\n\t\t\tconst translateDown = translate.y > 0;\n\t\t\tconst couldExceedBounds = target === \"t\" && translateUp || target === \"r\" && translateRight || target === \"b\" && translateDown || target === \"l\" && translateLeft || target === \"tr\" && (translateRight || translateUp) || target === \"tl\" && (translateLeft || translateUp) || target === \"br\" && (translateRight || translateDown) || target === \"bl\" && (translateLeft || translateDown);\n\n\t\t\t// need the aspect ratio of the crop to determine if it violates min size\n\t\t\tconst cropAspectRatio = rectAspectRatio(cropSize);\n\n\t\t\t// find the maximum size for the current aspect ratio\n\t\t\tconst cropSizeMax = getMaxSizeInRect($imageSize, $imageRotation, cropAspectRatio);\n\n\t\t\tif (couldExceedBounds && (cropSizeMax.width < $imageCropMinSize.width || cropSizeMax.height < $imageCropMinSize.height)) {\n\t\t\t\tif ($imageRotation !== 0) {\n\t\t\t\t\tconst sign = Math.sign($imageRotation);\n\t\t\t\t\tconst turns = Math.round(Math.abs($imageRotation) / HALF_PI) * HALF_PI;\n\t\t\t\t\tconst value = $imageRotation - sign * turns;\n\t\t\t\t\tconst imageIsRotated = turns / HALF_PI % 2 === 1;\n\t\t\t\t\tconst imageWidth = imageIsRotated ? $imageSize.height : $imageSize.width;\n\t\t\t\t\tconst imageHeight = imageIsRotated ? $imageSize.width : $imageSize.height;\n\t\t\t\t\tconst r = Math.abs(value);\n\t\t\t\t\tconst sin = Math.sin(r);\n\t\t\t\t\tconst cos = Math.cos(r);\n\n\t\t\t\t\tif (cropSize.width < $imageCropMinSize.width) {\n\t\t\t\t\t\t// width doesn't fit, let's limit the width to the min size\n\t\t\t\t\t\tcropSize.width = $imageCropMinSize.width;\n\n\t\t\t\t\t\t// And now calculate the height\n\t\t\t\t\t\t//  - rotation = .15\n\t\t\t\t\t\t//  - image size = 384 x 288\n\t\t\t\t\t\t//  - crop size width = 200\n\t\t\t\t\t\t// height = 288 - (Math.sin(.15) * 200) / Math.cos(.15)\n\t\t\t\t\t\tconst w = cos * cropSize.width + sin * cropSize.height;\n\n\t\t\t\t\t\tconst h = sin * cropSize.width + cos * cropSize.height;\n\t\t\t\t\t\tconst dx = imageWidth - w;\n\t\t\t\t\t\tconst dy = imageHeight - h;\n\n\t\t\t\t\t\tif (dx < dy) {\n\t\t\t\t\t\t\tcropSize.height = (imageWidth - cos * cropSize.width) / sin;\n\t\t\t\t\t\t} else if (dy < dx) {\n\t\t\t\t\t\t\tcropSize.height = (imageHeight - sin * cropSize.width) / cos;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (cropSize.height < $imageCropMinSize.height) {\n\t\t\t\t\t\t// height doesn't fit, let's limit the height to the min size\n\t\t\t\t\t\tcropSize.height = $imageCropMinSize.height;\n\n\t\t\t\t\t\t// And now calculate the width\n\t\t\t\t\t\t//  - rotation = .15\n\t\t\t\t\t\t//  - image size = 384 x 288\n\t\t\t\t\t\t//  - crop size height = 200\n\t\t\t\t\t\tconst w = cos * cropSize.width + sin * cropSize.height;\n\n\t\t\t\t\t\tconst h = sin * cropSize.width + cos * cropSize.height;\n\t\t\t\t\t\tconst dx = imageWidth - w;\n\t\t\t\t\t\tconst dy = imageHeight - h;\n\n\t\t\t\t\t\tif (dx < dy) {\n\t\t\t\t\t\t\t// (384 - (Math.sin(.15) * 250)) / Math.cos(.15)\n\t\t\t\t\t\t\tcropSize.width = (imageWidth - sin * cropSize.height) / cos;\n\t\t\t\t\t\t} else if (dy < dx) {\n\t\t\t\t\t\t\t// (288 - (Math.cos(.15) * 250)) / Math.sin(.15)\n\t\t\t\t\t\t\tcropSize.width = (imageHeight - cos * cropSize.height) / sin;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif (cropSize.width < $imageCropMinSize.width) {\n\t\t\t\t\t\tcropSize.width = $imageCropMinSize.width;\n\t\t\t\t\t\tcropSize.height = $imageSize.height;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (cropSize.height < $imageCropMinSize.height) {\n\t\t\t\t\t\tcropSize.height = $imageCropMinSize.height;\n\t\t\t\t\t\tcropSize.width = $imageSize.width;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// we now have a corrected size, let's calculate the new aspect ratio and use that to limit the translation\n\t\t\t\tcropAspectRatioLimited = rectAspectRatio(cropSize);\n\t\t\t}\n\t\t}\n\n\t\tif (cropAspectRatioLimited) {\n\t\t\trectIntended = applyRectDirectionTranslation($imageSelectionRectSnapshot, directionTranslation, {\n\t\t\t\taspectRatio: cropAspectRatioLimited || $imageCropAspectRatio\n\t\t\t});\n\t\t}\n\n\t\tlet rectLimited = limitRectDirectionTranslation($imageSelectionRectSnapshot, directionTranslation, $utilRect, {\n\t\t\taspectRatio: $imageCropAspectRatio || cropAspectRatioLimited,\n\t\t\tminSize: imageSelectionRectMinSize,\n\t\t\tmaxSize: imageSelectionRectMaxSize\n\t\t});\n\n\t\treturn {\n\t\t\tboundsLimited: rectLimited,\n\t\t\tboundsIntent: rectIntended\n\t\t};\n\t};\n\n\t//\n\t// rotating\n\t//\n\tconst handleRotateStart = () => {\n\t\t// now interacting with view\n\t\tset_store_value(isInteracting, $isInteracting = true, $isInteracting);\n\n\t\t// we need to know the origin of the crop so we can \"shrink\" the image to fit the crop rect while rotating\n\t\tset_store_value(imageCropRectOrigin, $imageCropRectOrigin = rectClone($imageCropRect), $imageCropRectOrigin);\n\t};\n\n\tconst handleRotateMove = value => {\n\t\tset_store_value(imageRotation, $imageRotation = value, $imageRotation); // will auto validate\n\t};\n\n\tconst handleRotateEnd = value => {\n\t\t// we're done interacting\n\t\tset_store_value(isInteracting, $isInteracting = false, $isInteracting);\n\n\t\t// apply our final rotation value\n\t\tset_store_value(imageRotation, $imageRotation = value, $imageRotation);\n\n\t\thistory.write();\n\n\t\t// done, so we no longer need to \"shrink\" the image\n\t\tset_store_value(imageCropRectOrigin, $imageCropRectOrigin = undefined, $imageCropRectOrigin);\n\t};\n\n\t//\n\t// moving\n\t//\n\tlet interactionCropRect = undefined;\n\n\tlet interactionCropRectForce = undefined;\n\n\tconst handleImageDragStart = () => {\n\t\tinteractionCropRectForce = undefined;\n\t\tset_store_value(isInteracting, $isInteracting = true, $isInteracting);\n\t\tinteractionCropRect = rectClone($imageCropRect);\n\t};\n\n\tconst handleImageDrag = ({ detail }) => manipulateImage(detail);\n\n\tconst handleImageDragEnd = ({ detail }) => {\n\t\t// done interacting\n\t\tset_store_value(isInteracting, $isInteracting = false, $isInteracting);\n\n\t\t// apply translation to the crop rect only if did make changes\n\t\tif (vectorLength(detail.translation) > 0 || detail.scalar !== 0) {\n\t\t\tmanipulateImage(detail);\n\t\t\thistory.write();\n\t\t}\n\n\t\t// no intent (needs to be set before crop rect is updated)\n\t\tset_store_value(imageCropRectIntent, $imageCropRectIntent = undefined, $imageCropRectIntent);\n\n\t\t// now done\n\t\tinteractionCropRect = undefined;\n\t};\n\n\tconst handleImageDragRelease = ({ detail }) => {\n\t\tinteractionCropRectForce = detail.translation;\n\t\tset_store_value(isInteracting, $isInteracting = false, $isInteracting);\n\t};\n\n\tconst manipulateImage = ({ translation, scalar }) => {\n\t\tconst imageSelectionRectZoomFactor = Math.min($imageSelectionRect.width / $imageCropRect.width, $imageSelectionRect.height / $imageCropRect.height);\n\t\tconst scaledTranslation = vectorMultiply(vectorClone(translation), 1 / imageSelectionRectZoomFactor);\n\n\t\t// while we're interacting we apply changes to the original crop rectangle, after we apply a force\n\t\tlet cropIntent;\n\n\t\tif (!interactionCropRectForce) {\n\t\t\tcropIntent = rectTranslate(rectClone(interactionCropRect), vectorInvert(vectorClone(scaledTranslation)));\n\n\t\t\tif (scalar !== undefined) {\n\t\t\t\trectScale(cropIntent, 1 - scalar);\n\t\t\t}\n\t\t} else {\n\t\t\t// we apply the force to the existing crop rect so animation is not borked\n\t\t\tconst forceTranslation = vectorSubtract(vectorClone(interactionCropRectForce), translation);\n\n\t\t\tinteractionCropRectForce = translation;\n\t\t\tcropIntent = rectTranslate(rectClone($imageCropRect), forceTranslation);\n\t\t}\n\n\t\t// update crop rect\n\t\tset_store_value(imageCropRectIntent, $imageCropRectIntent = cropIntent, $imageCropRectIntent); // auto calculates an elastic effect if bounds exceeded (needs to be set before crop rect is updated)\n\n\t\tset_store_value(imageCropRect, $imageCropRect = cropIntent, $imageCropRect); // auto limits to bounds if needed\n\t};\n\n\t//\n\t// resizing with range input\n\t//\n\tconst calculateZoomLevel = (imageSize, size, imageRotation) => {\n\t\tif (isRotatedSideways(imageRotation)) {\n\t\t\treturn 1 - 1 / Math.min(imageSize.height / size.width, imageSize.width / size.height);\n\t\t}\n\n\t\treturn 1 - 1 / Math.min(imageSize.width / size.width, imageSize.height / size.height);\n\t};\n\n\tconst imageCropRangeAspectRatio = derived([imageCropRange, imageCropRect], ([$imageCropRange, $imageCropRect], set) => {\n\t\tif (!$imageCropRect) return;\n\t\tconst [minSize, maxSize] = $imageCropRange;\n\t\tconst aspectRatio = rectAspectRatio($imageCropRect);\n\n\t\tset([\n\t\t\tsizeCreateFromRect(rectApply(rectCoverRect(minSize, aspectRatio), fixPrecision)),\n\t\t\tsizeCreateFromRect(rectApply(rectContainRect(maxSize, aspectRatio), fixPrecision))\n\t\t]);\n\t});\n\n\tcomponent_subscribe($$self, imageCropRangeAspectRatio, value => $$invalidate(131, $imageCropRangeAspectRatio = value));\n\n\t// this is the max value range that can be set (triggers white range indicator bar)\n\tconst imageZoomLevelRange = derived(\n\t\t[\n\t\t\timageSize,\n\t\t\timageCropLimitToImage,\n\t\t\timageCropMinSize,\n\t\t\timageCropMaxSize,\n\t\t\timageCropRange,\n\t\t\timageRotation\n\t\t],\n\t\t([\n\t\t\t\t$imageSize,\n\t\t\t\t$imageCropLimitToImage,\n\t\t\t\t$imageCropMinSize,\n\t\t\t\t$imageCropMaxSize,\n\t\t\t\t$imageCropRange,\n\t\t\t\t$imageRotation\n\t\t\t], set) => {\n\t\t\tif (!$imageSize) return;\n\t\t\tconst rangeMinSize = $imageCropRange[0];\n\t\t\tconst rangeMaxSize = $imageCropRange[1];\n\t\t\tlet minZoom;\n\t\t\tlet maxZoom;\n\n\t\t\t// can't zoom out\n\t\t\tif ($imageCropLimitToImage) {\n\t\t\t\tminZoom = calculateZoomLevel($imageSize, rangeMaxSize, $imageRotation);\n\t\t\t\tmaxZoom = Math.min(rangeMinSize.width / $imageCropMinSize.width, rangeMinSize.height / $imageCropMinSize.height);\n\t\t\t} else {\n\t\t\t\tmaxZoom = 1;\n\t\t\t\tminZoom = -1;\n\t\t\t}\n\n\t\t\tconst range = [fixPrecision(minZoom), fixPrecision(maxZoom)];\n\t\t\tset(range);\n\t\t}\n\t);\n\n\tcomponent_subscribe($$self, imageZoomLevelRange, value => $$invalidate(27, $imageZoomLevelRange = value));\n\n\tconst imageZoomLevel = derived([imageSize, imageCropRect, imageCropRange, imageRotation], ([$imageSize, $imageCropRect, $imageCropRange, $imageRotation], set) => {\n\t\t// need to check if this value is set, could be that it's empty while loading a new image\n\t\tif (!$imageSize || !$imageCropRect) return set(0);\n\n\t\tlet z;\n\t\tconst rangeMinSize = $imageCropRange[0];\n\t\tconst rangeMaxSize = $imageCropRange[1];\n\t\tconst currentCropWidth = $imageCropRect.width;\n\t\tconst currentCropHeight = $imageCropRect.height;\n\t\tconst currentCropAspectRatio = rectAspectRatio($imageCropRect);\n\n\t\tconst imageRect = isRotatedSideways($imageRotation)\n\t\t? sizeCreate($imageSize.height, $imageSize.width)\n\t\t: $imageSize;\n\n\t\tconst imageCropMaxRect = rectContainRect(imageRect, currentCropAspectRatio);\n\n\t\tif (currentCropWidth <= imageCropMaxRect.width || currentCropHeight <= imageCropMaxRect.height) {\n\t\t\t// zoomed in\n\t\t\tconst w = imageCropMaxRect.width - rangeMinSize.width;\n\n\t\t\tconst h = imageCropMaxRect.height - rangeMinSize.height;\n\n\t\t\t// cannot zoom in\n\t\t\tif (w === 0 || h === 0) {\n\t\t\t\tz = 1;\n\t\t\t} else {\n\t\t\t\tz = 1 - Math.min((currentCropWidth - rangeMinSize.width) / w, (currentCropHeight - rangeMinSize.height) / h);\n\t\t\t}\n\t\t} else {\n\t\t\t// zoomed out\n\t\t\tconst w = rangeMaxSize.width - imageCropMaxRect.width;\n\n\t\t\tconst h = rangeMaxSize.height - imageCropMaxRect.height;\n\t\t\tconst r = rectContainRect({ width: w, height: h }, currentCropAspectRatio);\n\t\t\tz = -Math.min((currentCropWidth - imageCropMaxRect.width) / r.width, (currentCropHeight - imageCropMaxRect.height) / r.height);\n\t\t}\n\n\t\tset(z);\n\t});\n\n\tcomponent_subscribe($$self, imageZoomLevel, value => $$invalidate(28, $imageZoomLevel = value));\n\n\tconst snapshotCropRect = () => {\n\t\tinteractionCropRect = rectClone($imageCropRect);\n\t};\n\n\tconst resizeImage = zoom => {\n\t\tconst aspectRatio = rectAspectRatio(interactionCropRect);\n\t\tlet targetWidth;\n\t\tlet targetHeight;\n\t\tlet r;\n\n\t\tconst imageRect = isRotatedSideways($imageRotation)\n\t\t? sizeCreate($imageSize.height, $imageSize.width)\n\t\t: $imageSize;\n\n\t\tconst imageCropMaxRect = rectContainRect(imageRect, aspectRatio);\n\n\t\tif (zoom >= 0) {\n\t\t\t// zoom in\n\t\t\tconst rangeWidth = imageCropMaxRect.width - $imageCropRange[0].width;\n\n\t\t\tconst rangeHeight = imageCropMaxRect.height - $imageCropRange[0].height;\n\t\t\ttargetWidth = imageCropMaxRect.width - rangeWidth * zoom;\n\t\t\ttargetHeight = imageCropMaxRect.height - rangeHeight * zoom;\n\t\t\tr = rectCoverRect({ width: targetWidth, height: targetHeight }, aspectRatio);\n\t\t} else {\n\t\t\t// zoom out\n\t\t\tconst rangeWidth = $imageCropRange[1].width - imageCropMaxRect.width;\n\n\t\t\tconst rangeHeight = $imageCropRange[1].height - imageCropMaxRect.height;\n\t\t\ttargetWidth = imageCropMaxRect.width + rangeWidth * -zoom;\n\t\t\ttargetHeight = imageCropMaxRect.height + rangeHeight * -zoom;\n\t\t\tr = rectContainRect({ width: targetWidth, height: targetHeight }, aspectRatio);\n\t\t}\n\n\t\ttargetWidth = r.width;\n\t\ttargetHeight = r.height;\n\t\tconst targetX = interactionCropRect.x + interactionCropRect.width * 0.5 - targetWidth * 0.5;\n\t\tconst targetY = interactionCropRect.y + interactionCropRect.height * 0.5 - targetHeight * 0.5;\n\n\t\tset_store_value(\n\t\t\timageCropRect,\n\t\t\t$imageCropRect = {\n\t\t\t\tx: targetX,\n\t\t\t\ty: targetY,\n\t\t\t\twidth: targetWidth,\n\t\t\t\theight: targetHeight\n\t\t\t},\n\t\t\t$imageCropRect\n\t\t);\n\t};\n\n\tconst handleResizeStart = () => {\n\t\t// now interacting with view\n\t\tset_store_value(isInteracting, $isInteracting = true, $isInteracting);\n\n\t\tsnapshotCropRect();\n\t};\n\n\tconst handleResizeMove = value => {\n\t\t// value range from 0 (no zoom) to 1 (100% zoom, 1x1 pixel)\n\t\tresizeImage(value);\n\t};\n\n\tconst handleResizeEnd = value => {\n\t\tresizeImage(value);\n\t\thistory.write();\n\n\t\t// we're done interacting\n\t\tset_store_value(isInteracting, $isInteracting = false, $isInteracting);\n\n\t\t// now done\n\t\tinteractionCropRect = undefined;\n\t};\n\n\t//\n\t// resizing with wheel\n\t//\n\tlet zoomHistoryTimeoutId;\n\n\tconst handleWheel = e => {\n\t\tconst stageWheelPosition = getEventPositionInStage(e, $rootRect, $stageRect);\n\n\t\t// only block input if wheel is used within image rectangle\n\t\tif (cropEnableLimitWheelInputToCropSelection && !rectContainsPoint($imageSelectionRect, stageWheelPosition)) return;\n\n\t\t// now interacting\n\t\tset_store_value(isInteracting, $isInteracting = true, $isInteracting);\n\n\t\t// don't run default actions, prevent other actions from running\n\t\te.preventDefault();\n\n\t\te.stopPropagation();\n\n\t\t// get current crop rect\n\t\tconst currentCropRect = rectClone($imageCropRect);\n\n\t\t// convert wheel delta to scalar\n\t\tconst delta = getWheelDelta(e);\n\n\t\tconst scalar = 1 + delta / 100;\n\n\t\t// if already zoomed in, block further zoom in instructions\n\t\tconst isMinSize = Math.min($imageCropRect.width / $imageCropMinSize.width, $imageCropRect.height / $imageCropMinSize.height) === 1;\n\n\t\t// if is fully zoomed out and trying to zoom out more and crop shape is free, fit image aspect ratio\n\t\tif (cropEnableZoomMatchImageAspectRatio && $imageCropLimitToImage) {\n\t\t\tconst isAtMaxCropSize = isCropMaxSize($imageCropRect, $imageSize, $imageRotation);\n\n\t\t\tif (isCustomCrop() && isAtMaxCropSize && delta > 0 && isImageSelectionCentered) {\n\t\t\t\tset_store_value(isInteracting, $isInteracting = false, $isInteracting);\n\n\t\t\t\tconst newCropRect = isRotatedSideways($imageRotation)\n\t\t\t\t? rectCreateFromSize({\n\t\t\t\t\t\theight: $imageSize.width,\n\t\t\t\t\t\twidth: $imageSize.height\n\t\t\t\t\t})\n\t\t\t\t: rectCreateFromSize($imageSize);\n\n\t\t\t\t// no change, exit\n\t\t\t\tif (rectEqual(currentCropRect, newCropRect)) return;\n\n\t\t\t\t// if we were previously zooming in we need to clear the timeout to prevent two history entries\n\t\t\t\tclearTimeout(zoomHistoryTimeoutId);\n\n\t\t\t\t// test if crop rect in history is same as new crop rect, this is possible when zooming in and out real quick\n\t\t\t\tif (rectEqual(history.state.crop, newCropRect)) return;\n\n\t\t\t\t// store new crop rect\n\t\t\t\tset_store_value(imageCropRect, $imageCropRect = newCropRect, $imageCropRect);\n\n\t\t\t\thistory.write();\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// by default when zooming, zoom from center of crop rectangle\n\t\tlet origin = rectCenter($imageCropRect);\n\n\t\t// when zooming in, zoom in on the part of the image below the mouse cursor\n\t\tif (cropEnableZoomTowardsWheelPosition && delta < 0 && !isMinSize) {\n\t\t\tconst selectionOffset = vectorSubtract(vectorClone(stageWheelPosition), $imageSelectionRect);\n\t\t\tconst imageSelectionScale = Math.min($imageSelectionRect.width / $imageCropRect.width, $imageSelectionRect.height / $imageCropRect.height);\n\n\t\t\t// if wheel is inside image selection rectangle (slightly expanded version), we zoom based on position in the rectangle, if not, we use the selection center\n\t\t\tconst expandedImageSelection = rectScale(rectClone($imageSelectionRect), 1.1);\n\n\t\t\torigin = rectContainsPoint(expandedImageSelection, stageWheelPosition)\n\t\t\t? vectorAdd(rectClone($imageCropRect), vectorMultiply(selectionOffset, 1 / imageSelectionScale))\n\t\t\t: origin;\n\t\t}\n\n\t\tlet newCropRect = rectScale(rectClone($imageCropRect), scalar, origin);\n\n\t\t// determin if is new crop rect exceeds min or max size, if so, limit\n\t\tif (!sizeContains($imageCropRangeAspectRatio[1], newCropRect)) {\n\t\t\t// exceeds max size, limit to max size and position at new crop rect center\n\t\t\tnewCropRect = rectCreateWithCenter(rectCenter(newCropRect), $imageCropRangeAspectRatio[1]);\n\t\t}\n\n\t\tif (!sizeContains(newCropRect, $imageCropRangeAspectRatio[0])) {\n\t\t\t// exceeds min size, limit to min size and position at new crop rect center\n\t\t\tnewCropRect = rectCreateWithCenter(rectCenter(newCropRect), $imageCropRangeAspectRatio[0]);\n\t\t}\n\n\t\t// no change, exit\n\t\tif (rectEqual(currentCropRect, newCropRect, fixPrecision)) {\n\t\t\tset_store_value(isInteracting, $isInteracting = false, $isInteracting);\n\t\t\treturn;\n\t\t}\n\n\t\t// attempt to update the rectangle, we use fixPrecision so the width and height are nice integers when at max zoom (this makes sure the `isMinSize` variable is set to true at this point)\n\t\tset_store_value(imageCropRect, $imageCropRect = rectApply(newCropRect, v => fixPrecision(v, 5)), $imageCropRect);\n\n\t\t// done!\n\t\tset_store_value(isInteracting, $isInteracting = false, $isInteracting);\n\n\t\t// write history timer\n\t\tclearTimeout(zoomHistoryTimeoutId);\n\n\t\tzoomHistoryTimeoutId = setTimeout(\n\t\t\t() => {\n\t\t\t\thistory.write();\n\t\t\t},\n\t\t\t500\n\t\t);\n\t};\n\n\t//\n\t// recenter\n\t//\n\t// the 'measure' event triggers the editor to center and scale up the crop\n\tconst dispatch = createEventDispatcher();\n\n\tconst handleRecenterAction = () => {\n\t\tdispatch(\"measure\", rectClone($utilRect));\n\t};\n\n\t// auto recenter after timeout\n\tlet cropAutoCenterImageSelectionTimeoutId;\n\n\t// animations\n\tconst recenterOpacity = spring(0, { precision: 0.0001 });\n\n\tcomponent_subscribe($$self, recenterOpacity, value => $$invalidate(24, $recenterOpacity = value));\n\tconst recenterOffset = spring();\n\tcomponent_subscribe($$self, recenterOffset, value => $$invalidate(25, $recenterOffset = value));\n\tconst footerOffset = spring(0);\n\tcomponent_subscribe($$self, footerOffset, value => $$invalidate(146, $footerOffset = value));\n\n\t//\n\t// crop selection presets\n\t//\n\tconst selectedPresetIndex = derived([imageCropAspectRatio, imageOutputSize], ([$cropAspectRatio, $imageOutputSize], set) => {\n\t\tif (!cropSelectPresetOptions) return;\n\t\tconst options = flattenOptions(cropSelectPresetOptions);\n\n\t\tconst matchedOptionValue = [...options].// to value\n\t\tmap(option => option[0]).// sort sizes first\n\t\tsort((a, b) => {\n\t\t\tif (isArray(a[0]) && !isArray(b[0])) return 1;\n\t\t\treturn -1;\n\t\t}).// match value\n\t\tfind(value => {\n\t\t\tif (isArray(value) && $imageOutputSize) {\n\t\t\t\t// size + aspect ratio\n\t\t\t\tconst [width, height] = value;\n\n\t\t\t\tconst outputSizeMatches = $imageOutputSize.width === width && $imageOutputSize.height === height;\n\t\t\t\tconst aspectRatioMatches = $cropAspectRatio === getAspectRatio(width, height);\n\t\t\t\treturn outputSizeMatches && aspectRatioMatches;\n\t\t\t}\n\n\t\t\t// aspect ratio\n\t\t\treturn value === $cropAspectRatio;\n\t\t});\n\n\t\tconst index = options.// to value\n\t\tmap(option => option[0]).// find index of matching value\n\t\tfindIndex(value => isArray(value)\n\t\t? arrayEqual(value, matchedOptionValue)\n\t\t: value === matchedOptionValue);\n\n\t\tset(index);\n\t});\n\n\tcomponent_subscribe($$self, selectedPresetIndex, value => $$invalidate(115, $selectedPresetIndex = value));\n\n\tconst getSelectionPresetLabelIcon = selectedIndex => {\n\t\tif (!cropSelectPresetOptions) return;\n\t\tconst selectedValue = flattenOptions(cropSelectPresetOptions)[selectedIndex][0];\n\n\t\tconst aspectRatio = !selectedValue\n\t\t? undefined\n\t\t: isArray(selectedValue)\n\t\t\t? getAspectRatio(selectedValue[0], selectedValue[1])\n\t\t\t: selectedValue;\n\n\t\tconst [a, b, c] = !aspectRatio\n\t\t? [0.2, 0.3, 0.4]\n\t\t: [\n\t\t\t\taspectRatio < 1 ? 1 : 0.3,\n\t\t\t\taspectRatio === 1 ? 0.85 : 0.5,\n\t\t\t\taspectRatio > 1 ? 1 : 0.3\n\t\t\t];\n\n\t\treturn `<g fill=\"currentColor\">\n        <rect opacity=\"${a}\" x=\"2\" y=\"4\" width=\"10\" height=\"18\" rx=\"1\"/>\n        <rect opacity=\"${b}\" x=\"4\" y=\"8\" width=\"14\" height=\"14\" rx=\"1\"/>\n        <rect opacity=\"${c}\" x=\"6\" y=\"12\" width=\"17\" height=\"10\" rx=\"1\"/>\n    </g>`;\n\t};\n\n\t//\n\t// crop boundary\n\t//\n\tconst getCropBoundaryLabelIcon = isBoundToImage => {\n\t\tconst [a, b, c, d] = isBoundToImage ? [0.3, 1, 0, 0] : [0, 0, 0.3, 1];\n\n\t\treturn `<g fill=\"currentColor\">\n        <rect opacity=\"${a}\" x=\"2\" y=\"3\" width=\"20\" height=\"20\" rx=\"1\"/>\n        <rect opacity=\"${b}\" x=\"7\" y=\"8\" width=\"10\" height=\"10\" rx=\"1\"/>\n        <rect opacity=\"${c}\" x=\"4\" y=\"8\" width=\"14\" height=\"14\" rx=\"1\"/>\n        <rect opacity=\"${d}\" x=\"12\" y=\"4\" width=\"10\" height=\"10\" rx=\"1\"/>\n    </g>`;\n\t};\n\n\tconst cropUniqueId = `crop-${getUniqueId()}`;\n\tlet transformInitial = cropEnableRotationInput ? \"rotation\" : \"zoom\";\n\tlet transformToolInitial = cropUniqueId + \"-\" + transformInitial;\n\tlet transformSelected = transformToolInitial;\n\tlet root = undefined;\n\n\tfunction measure_handler_1(event) {\n\t\tbubble($$self, event);\n\t}\n\n\tconst interactable_function = e => getEventPositionInViewport(e);\n\tconst select_handler = ({ detail }) => $$invalidate(5, transformSelected = detail);\n\n\tfunction util_root_binding(value) {\n\t\troot = value;\n\t\t$$invalidate(6, root);\n\t}\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"isActive\" in $$props) $$subscribe_isActive($$invalidate(1, isActive = $$props.isActive));\n\t\tif (\"stores\" in $$props) $$invalidate(80, stores = $$props.stores);\n\t\tif (\"cropImageSelectionCornerStyle\" in $$props) $$invalidate(2, cropImageSelectionCornerStyle = $$props.cropImageSelectionCornerStyle);\n\t\tif (\"cropAutoCenterImageSelectionTimeout\" in $$props) $$invalidate(81, cropAutoCenterImageSelectionTimeout = $$props.cropAutoCenterImageSelectionTimeout);\n\t\tif (\"cropEnableZoomMatchImageAspectRatio\" in $$props) $$invalidate(82, cropEnableZoomMatchImageAspectRatio = $$props.cropEnableZoomMatchImageAspectRatio);\n\t\tif (\"cropEnableRotateMatchImageAspectRatio\" in $$props) $$invalidate(83, cropEnableRotateMatchImageAspectRatio = $$props.cropEnableRotateMatchImageAspectRatio);\n\t\tif (\"cropEnableRotationInput\" in $$props) $$invalidate(84, cropEnableRotationInput = $$props.cropEnableRotationInput);\n\t\tif (\"cropEnableZoom\" in $$props) $$invalidate(3, cropEnableZoom = $$props.cropEnableZoom);\n\t\tif (\"cropEnableZoomInput\" in $$props) $$invalidate(85, cropEnableZoomInput = $$props.cropEnableZoomInput);\n\t\tif (\"cropEnableImageSelection\" in $$props) $$invalidate(86, cropEnableImageSelection = $$props.cropEnableImageSelection);\n\t\tif (\"cropEnableInfoIndicator\" in $$props) $$invalidate(87, cropEnableInfoIndicator = $$props.cropEnableInfoIndicator);\n\t\tif (\"cropEnableZoomTowardsWheelPosition\" in $$props) $$invalidate(88, cropEnableZoomTowardsWheelPosition = $$props.cropEnableZoomTowardsWheelPosition);\n\t\tif (\"cropEnableLimitWheelInputToCropSelection\" in $$props) $$invalidate(89, cropEnableLimitWheelInputToCropSelection = $$props.cropEnableLimitWheelInputToCropSelection);\n\t\tif (\"cropEnableCenterImageSelection\" in $$props) $$invalidate(90, cropEnableCenterImageSelection = $$props.cropEnableCenterImageSelection);\n\t\tif (\"cropEnableButtonRotateLeft\" in $$props) $$invalidate(91, cropEnableButtonRotateLeft = $$props.cropEnableButtonRotateLeft);\n\t\tif (\"cropEnableButtonRotateRight\" in $$props) $$invalidate(92, cropEnableButtonRotateRight = $$props.cropEnableButtonRotateRight);\n\t\tif (\"cropEnableButtonFlipHorizontal\" in $$props) $$invalidate(93, cropEnableButtonFlipHorizontal = $$props.cropEnableButtonFlipHorizontal);\n\t\tif (\"cropEnableButtonFlipVertical\" in $$props) $$invalidate(94, cropEnableButtonFlipVertical = $$props.cropEnableButtonFlipVertical);\n\t\tif (\"cropSelectPresetOptions\" in $$props) $$invalidate(95, cropSelectPresetOptions = $$props.cropSelectPresetOptions);\n\t\tif (\"cropEnableSelectPreset\" in $$props) $$invalidate(96, cropEnableSelectPreset = $$props.cropEnableSelectPreset);\n\t\tif (\"cropEnableButtonToggleCropLimit\" in $$props) $$invalidate(97, cropEnableButtonToggleCropLimit = $$props.cropEnableButtonToggleCropLimit);\n\t\tif (\"locale\" in $$props) $$invalidate(4, locale = $$props.locale);\n\t\tif (\"tools\" in $$props) $$invalidate(0, tools = $$props.tools);\n\t};\n\n\tlet imageZoomLevelMin;\n\tlet imageSelectionOffset;\n\tlet imageSelectionCenter;\n\tlet imageSelectionCenteredRect;\n\tlet isImageSelectionDisplayed;\n\tlet isImageSelectionCentered;\n\tlet isResizingSelection;\n\tlet isMaxSelectionRect;\n\tlet isOverlayMode;\n\tlet canZoomToCenter;\n\tlet canCenter;\n\tlet shouldRenderInfoIndicator;\n\tlet shouldRenderImageSelection;\n\tlet shouldRenderImageSelectionRecenterButton;\n\tlet imageSelectionRectOffset;\n\tlet shouldRenderPresetSelect;\n\tlet hasPlentyVerticalSpace;\n\tlet shouldRenderToolbar;\n\tlet shouldRenderZoomInput;\n\tlet shouldRenderFooter;\n\tlet shouldRenderTabs;\n\tlet tabsConfig;\n\tlet tabs;\n\tlet panels;\n\tlet footerStyle;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[4] & /*$env*/ 65536) {\n\t\t\t $$invalidate(139, isOverlayMode = $env.layoutMode === \"overlay\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*cropEnableSelectPreset*/ 8 | $$self.$$.dirty[4] & /*isOverlayMode*/ 32768) {\n\t\t\t//\n\t\t\t// Transform tabs\n\t\t\t//\n\t\t\t $$invalidate(114, shouldRenderPresetSelect = cropEnableSelectPreset && !isOverlayMode);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*$imageSelectionRect*/ 536870912 | $$self.$$.dirty[4] & /*$utilRect*/ 4) {\n\t\t\t// determine if we can center the crop, if we can, show the crop center button\n\t\t\t $$invalidate(135, imageSelectionCenteredRect = $utilRect && $imageSelectionRect && rectCenterRect($utilRect, $imageSelectionRect));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*$imageSelectionRect*/ 536870912 | $$self.$$.dirty[4] & /*imageSelectionCenteredRect*/ 2048) {\n\t\t\t $$invalidate(136, isImageSelectionDisplayed = !!($imageSelectionRect && imageSelectionCenteredRect));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*$imageSelectionRect*/ 536870912 | $$self.$$.dirty[4] & /*isImageSelectionDisplayed, imageSelectionCenteredRect*/ 6144) {\n\t\t\t $$invalidate(117, isImageSelectionCentered = isImageSelectionDisplayed && rectEqual($imageSelectionRect, imageSelectionCenteredRect, value => fixPrecision(value, 5)));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale, $imageRotation*/ 272 | $$self.$$.dirty[2] & /*cropEnableButtonRotateLeft, cropEnableButtonRotateRight*/ 1610612736 | $$self.$$.dirty[3] & /*cropEnableButtonFlipHorizontal, $imageFlipY, $imageFlipX, cropEnableButtonFlipVertical, shouldRenderPresetSelect, cropSelectPresetOptions, $selectedPresetIndex, isImageSelectionCentered, $imageSize, $imageCropMinSize, cropEnableButtonToggleCropLimit, $imageCropLimitToImage*/ 125566999) {\n\t\t\t $$invalidate(0, tools = [\n\t\t\t\tcropEnableButtonRotateLeft && [\n\t\t\t\t\tButton,\n\t\t\t\t\t\"rotate-left\",\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: locale.cropLabelButtonRotateLeft,\n\t\t\t\t\t\tlabelClass: \"DokaToolbarContentWide\",\n\t\t\t\t\t\ticon: locale.cropIconButtonRotateLeft,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tapplyRotation(-Math.PI / 2);\n\t\t\t\t\t\t\thistory.write();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tcropEnableButtonRotateRight && [\n\t\t\t\t\tButton,\n\t\t\t\t\t\"rotate-right\",\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: locale.cropLabelButtonRotateRight,\n\t\t\t\t\t\tlabelClass: \"DokaToolbarContentWide\",\n\t\t\t\t\t\ticon: locale.cropIconButtonRotateRight,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tapplyRotation(Math.PI / 2);\n\t\t\t\t\t\t\thistory.write();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tcropEnableButtonFlipHorizontal && [\n\t\t\t\t\tButton,\n\t\t\t\t\t\"flip-horizontal\",\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: locale.cropLabelButtonFlipHorizontal,\n\t\t\t\t\t\tlabelClass: \"DokaToolbarContentWide\",\n\t\t\t\t\t\ticon: locale.cropIconButtonFlipHorizontal,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tif (isRotatedSideways($imageRotation)) {\n\t\t\t\t\t\t\t\tset_store_value(imageFlipY, $imageFlipY = !$imageFlipY, $imageFlipY);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tset_store_value(imageFlipX, $imageFlipX = !$imageFlipX, $imageFlipX);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\thistory.write();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tcropEnableButtonFlipVertical && [\n\t\t\t\t\tButton,\n\t\t\t\t\t\"flip-vertical\",\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: locale.cropLabelButtonFlipVertical,\n\t\t\t\t\t\tlabelClass: \"DokaToolbarContentWide\",\n\t\t\t\t\t\ticon: locale.cropIconButtonFlipVertical,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tif (isRotatedSideways($imageRotation)) {\n\t\t\t\t\t\t\t\tset_store_value(imageFlipX, $imageFlipX = !$imageFlipX, $imageFlipX);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tset_store_value(imageFlipY, $imageFlipY = !$imageFlipY, $imageFlipY);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\thistory.write();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tshouldRenderPresetSelect && cropSelectPresetOptions && [\n\t\t\t\t\tDropdown,\n\t\t\t\t\t\"select-preset\",\n\t\t\t\t\t{\n\t\t\t\t\t\ticon: getSelectionPresetLabelIcon($selectedPresetIndex),\n\t\t\t\t\t\tlabel: locale.cropLabelSelectPreset,\n\t\t\t\t\t\tlabelClass: \"DokaToolbarContentWide\",\n\t\t\t\t\t\toptions: cropSelectPresetOptions,\n\t\t\t\t\t\tselectedIndex: $selectedPresetIndex,\n\t\t\t\t\t\tonchange: ({ value }) => {\n\t\t\t\t\t\t\tif (isArray(value)) {\n\t\t\t\t\t\t\t\tset_store_value(imageCropAspectRatio, $imageCropAspectRatio = getAspectRatio(value[0], value[1]), $imageCropAspectRatio);\n\t\t\t\t\t\t\t\tset_store_value(imageOutputSize, $imageOutputSize = sizeCreateFromArray(value), $imageOutputSize);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tset_store_value(imageCropAspectRatio, $imageCropAspectRatio = value, $imageCropAspectRatio);\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (isImageSelectionCentered) {\n\t\t\t\t\t\t\t\thandleRecenterAction();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\thistory.write();\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptionMapper: option => {\n\t\t\t\t\t\t\t// if no aspect ratio found we enable the option by default\n\t\t\t\t\t\t\tlet disabled = false;\n\n\t\t\t\t\t\t\t// get aspect ratio for this option\n\t\t\t\t\t\t\tconst optionAspectRatio = isArray(option.value)\n\t\t\t\t\t\t\t? option.value[0] / option.value[1]\n\t\t\t\t\t\t\t: option.value;\n\n\t\t\t\t\t\t\t// can be undefined in which case we don't need to check anything\n\t\t\t\t\t\t\tif (optionAspectRatio) {\n\t\t\t\t\t\t\t\tconst maxCropSize = getMaxSizeInRect($imageSize, $imageRotation, optionAspectRatio);\n\t\t\t\t\t\t\t\tdisabled = maxCropSize.width < $imageCropMinSize.width || maxCropSize.height < $imageCropMinSize.height;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// add icon for this option\n\t\t\t\t\t\t\toption.icon = getSelectionPresetOptionIcon(option.value, { bounds: 14 });\n\n\t\t\t\t\t\t\treturn { ...option, disabled };\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tcropEnableButtonToggleCropLimit && [\n\t\t\t\t\tDropdown,\n\t\t\t\t\t\"select-crop-limit\",\n\t\t\t\t\t{\n\t\t\t\t\t\ticon: getCropBoundaryLabelIcon($imageCropLimitToImage),\n\t\t\t\t\t\tlabel: locale.cropLabelCropBoundary,\n\t\t\t\t\t\tlabelClass: \"DokaToolbarContentWide\",\n\t\t\t\t\t\tonchange: ({ value }) => {\n\t\t\t\t\t\t\tset_store_value(imageCropLimitToImage, $imageCropLimitToImage = value, $imageCropLimitToImage);\n\t\t\t\t\t\t\thistory.write();\n\t\t\t\t\t\t},\n\t\t\t\t\t\toptions: [\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\tlocale.cropLabelCropBoundaryEdge,\n\t\t\t\t\t\t\t\t{ icon: getCropBoundaryLabelIcon(true) }\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t\tlocale.cropLabelCropBoundaryNone,\n\t\t\t\t\t\t\t\t{ icon: getCropBoundaryLabelIcon(false) }\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t]);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*$imageCropLimitToImage*/ 67108864) {\n\t\t\t $$invalidate(9, imageZoomLevelMin = $imageCropLimitToImage ? 0 : -1);\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*$utilRect, $stageRect*/ 68) {\n\t\t\t $$invalidate(132, imageSelectionOffset = $utilRect && vectorCreate(-($stageRect.x - $utilRect.x), -($stageRect.y - $utilRect.y)));\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*$imageSelectionRectPresentation, imageSelectionOffset*/ 1280) {\n\t\t\t// normalized crop bounds, we use these to limit the crop interactions to the view\n\t\t\t $$invalidate(133, imageSelectionCenter = $imageSelectionRectPresentation && vectorCreate(snapToPixel($imageSelectionRectPresentation.x + $imageSelectionRectPresentation.width * 0.5 + imageSelectionOffset.x), snapToPixel($imageSelectionRectPresentation.y + $imageSelectionRectPresentation.height * 0.5 + imageSelectionOffset.y)));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*$imageSelectionRectSnapshot*/ 268435456) {\n\t\t\t $$invalidate(137, isResizingSelection = $imageSelectionRectSnapshot != null);\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*$utilRect, imageSelectionCenteredRect*/ 2052) {\n\t\t\t $$invalidate(138, isMaxSelectionRect = $utilRect && imageSelectionCenteredRect && (imageSelectionCenteredRect.height === $utilRect.height || imageSelectionCenteredRect.width === $utilRect.width));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*$presentationScalar*/ 1073741824 | $$self.$$.dirty[4] & /*isMaxSelectionRect, $imageScalar*/ 278528) {\n\t\t\t $$invalidate(141, canZoomToCenter = !isMaxSelectionRect && ($presentationScalar < 1 && $imageScalar < 1));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*isImageSelectionCentered*/ 16777216 | $$self.$$.dirty[4] & /*isImageSelectionDisplayed, isResizingSelection, canZoomToCenter*/ 143360) {\n\t\t\t $$invalidate(11, canCenter = isImageSelectionDisplayed && !isResizingSelection && (!isImageSelectionCentered || canZoomToCenter));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$imageCropRect*/ 128 | $$self.$$.dirty[2] & /*cropEnableInfoIndicator*/ 33554432 | $$self.$$.dirty[4] & /*isOverlayMode*/ 32768) {\n\t\t\t $$invalidate(12, shouldRenderInfoIndicator = cropEnableInfoIndicator && !!$imageCropRect && !isOverlayMode);\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*$imageSelectionRectPresentation, imageSelectionOffset*/ 1280) {\n\t\t\t $$invalidate(14, imageSelectionRectOffset = $imageSelectionRectPresentation && imageSelectionOffset && {\n\t\t\t\tx: $imageSelectionRectPresentation.x + imageSelectionOffset.x,\n\t\t\t\ty: $imageSelectionRectPresentation.y + imageSelectionOffset.y,\n\t\t\t\twidth: $imageSelectionRectPresentation.width,\n\t\t\t\theight: $imageSelectionRectPresentation.height\n\t\t\t});\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*imageSelectionRectOffset*/ 16384 | $$self.$$.dirty[2] & /*cropEnableImageSelection*/ 16777216 | $$self.$$.dirty[4] & /*isOverlayMode*/ 32768) {\n\t\t\t $$invalidate(13, shouldRenderImageSelection = cropEnableImageSelection && !!imageSelectionRectOffset && !isOverlayMode);\n\t\t}\n\n\t\tif ($$self.$$.dirty[2] & /*cropEnableCenterImageSelection, cropAutoCenterImageSelectionTimeout*/ 268959744 | $$self.$$.dirty[4] & /*imageSelectionCenter*/ 512) {\n\t\t\t $$invalidate(15, shouldRenderImageSelectionRecenterButton = cropEnableCenterImageSelection && !!imageSelectionCenter && !cropAutoCenterImageSelectionTimeout);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*canCenter*/ 2048 | $$self.$$.dirty[2] & /*cropAutoCenterImageSelectionTimeout*/ 524288 | $$self.$$.dirty[3] & /*$isInteracting, cropAutoCenterImageSelectionTimeoutId*/ 134283264) {\n\t\t\t if (canCenter && cropAutoCenterImageSelectionTimeout && !$isInteracting) {\n\t\t\t\tclearTimeout(cropAutoCenterImageSelectionTimeoutId);\n\t\t\t\t$$invalidate(109, cropAutoCenterImageSelectionTimeoutId = setTimeout(handleRecenterAction, cropAutoCenterImageSelectionTimeout));\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*$isInteracting, cropAutoCenterImageSelectionTimeoutId*/ 134283264) {\n\t\t\t if ($isInteracting) clearTimeout(cropAutoCenterImageSelectionTimeoutId);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*canCenter*/ 2048) {\n\t\t\t recenterOpacity.set(canCenter ? 1 : 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*imageSelectionCenter*/ 512) {\n\t\t\t recenterOffset.set(imageSelectionCenter);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$isActive*/ 65536) {\n\t\t\t footerOffset.set($isActive ? 0 : 20);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$isActive*/ 65536 | $$self.$$.dirty[4] & /*$imagePreviewModifiers*/ 524288) {\n\t\t\t//\n\t\t\t// enable seeing the image outside of the crop area, and disable the vignette effect\n\t\t\t// \n\t\t\t if ($isActive) {\n\t\t\t\tset_store_value(\n\t\t\t\t\timagePreviewModifiers,\n\t\t\t\t\t$imagePreviewModifiers[\"crop\"] = {\n\t\t\t\t\t\tmaskOpacity: 0.85,\n\t\t\t\t\t\tmaskMarkupOpacity: 0.85\n\t\t\t\t\t},\n\t\t\t\t\t$imagePreviewModifiers\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tdelete $imagePreviewModifiers[\"crop\"];\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*isOverlayMode, $env*/ 98304) {\n\t\t\t $$invalidate(144, hasPlentyVerticalSpace = isOverlayMode ? false : $env.verticalSpace !== \"short\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*hasPlentyVerticalSpace*/ 1048576) {\n\t\t\t $$invalidate(17, shouldRenderToolbar = hasPlentyVerticalSpace);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*cropEnableZoom*/ 8 | $$self.$$.dirty[2] & /*cropEnableZoomInput*/ 8388608 | $$self.$$.dirty[4] & /*hasPlentyVerticalSpace*/ 1048576) {\n\t\t\t $$invalidate(145, shouldRenderZoomInput = cropEnableZoom && cropEnableZoomInput && hasPlentyVerticalSpace);\n\t\t}\n\n\t\tif ($$self.$$.dirty[2] & /*cropEnableRotationInput*/ 4194304 | $$self.$$.dirty[4] & /*shouldRenderZoomInput*/ 2097152) {\n\t\t\t $$invalidate(18, shouldRenderFooter = cropEnableRotationInput || shouldRenderZoomInput);\n\t\t}\n\n\t\tif ($$self.$$.dirty[2] & /*cropEnableRotationInput*/ 4194304 | $$self.$$.dirty[4] & /*shouldRenderZoomInput*/ 2097152) {\n\t\t\t $$invalidate(19, shouldRenderTabs = cropEnableRotationInput && shouldRenderZoomInput);\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*shouldRenderZoomInput*/ 2097152) {\n\t\t\t if (!shouldRenderZoomInput) {\n\t\t\t\t$$invalidate(5, transformSelected = transformToolInitial);\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*transformSelected*/ 32) {\n\t\t\t $$invalidate(20, tabsConfig = {\n\t\t\t\tname: cropUniqueId,\n\t\t\t\tselected: transformSelected\n\t\t\t});\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale*/ 16) {\n\t\t\t $$invalidate(21, tabs = [\n\t\t\t\t{\n\t\t\t\t\tid: cropUniqueId + \"-rotation\",\n\t\t\t\t\tlabel: locale.cropLabelTabRotation\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: cropUniqueId + \"-zoom\",\n\t\t\t\t\tlabel: locale.cropLabelTabZoom\n\t\t\t\t}\n\t\t\t]);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*tabs*/ 2097152) {\n\t\t\t $$invalidate(22, panels = tabs.map(tab => tab.id));\n\t\t}\n\n\t\tif ($$self.$$.dirty[4] & /*$footerOffset*/ 4194304) {\n\t\t\t $$invalidate(23, footerStyle = $footerOffset\n\t\t\t? `transform: translateY(${$footerOffset}px)`\n\t\t\t: undefined);\n\t\t}\n\t};\n\n\treturn [\n\t\ttools,\n\t\tisActive,\n\t\tcropImageSelectionCornerStyle,\n\t\tcropEnableZoom,\n\t\tlocale,\n\t\ttransformSelected,\n\t\troot,\n\t\t$imageCropRect,\n\t\t$imageRotation,\n\t\timageZoomLevelMin,\n\t\t$rootRect,\n\t\tcanCenter,\n\t\tshouldRenderInfoIndicator,\n\t\tshouldRenderImageSelection,\n\t\timageSelectionRectOffset,\n\t\tshouldRenderImageSelectionRecenterButton,\n\t\t$isActive,\n\t\tshouldRenderToolbar,\n\t\tshouldRenderFooter,\n\t\tshouldRenderTabs,\n\t\ttabsConfig,\n\t\ttabs,\n\t\tpanels,\n\t\tfooterStyle,\n\t\t$recenterOpacity,\n\t\t$recenterOffset,\n\t\t$imageRotationRange,\n\t\t$imageZoomLevelRange,\n\t\t$imageZoomLevel,\n\t\tenv,\n\t\tisInteracting,\n\t\trootRect,\n\t\tstageRect,\n\t\tutilRect,\n\t\telasticityMultiplier,\n\t\trangeInputElasticity,\n\t\tpresentationScalar,\n\t\timagePreviewModifiers,\n\t\timageFlipX,\n\t\timageFlipY,\n\t\timageRotation,\n\t\timageRotationRange,\n\t\timageOutputSize,\n\t\timageSelectionRect,\n\t\timageSelectionRectSnapshot,\n\t\timageSelectionRectIntent,\n\t\timageSelectionRectPresentation,\n\t\timageCropRectIntent,\n\t\timageCropRectOrigin,\n\t\timageCropRect,\n\t\timageCropMinSize,\n\t\timageCropMaxSize,\n\t\timageCropRange,\n\t\timageCropAspectRatio,\n\t\timageCropLimitToImage,\n\t\timageSize,\n\t\timageScalar,\n\t\thandleSelectionGrab,\n\t\thandleSelectionDrag,\n\t\thandleSelectionRelease,\n\t\thandleRotateStart,\n\t\thandleRotateMove,\n\t\thandleRotateEnd,\n\t\thandleImageDragStart,\n\t\thandleImageDrag,\n\t\thandleImageDragEnd,\n\t\thandleImageDragRelease,\n\t\timageCropRangeAspectRatio,\n\t\timageZoomLevelRange,\n\t\timageZoomLevel,\n\t\thandleResizeStart,\n\t\thandleResizeMove,\n\t\thandleResizeEnd,\n\t\thandleWheel,\n\t\thandleRecenterAction,\n\t\trecenterOpacity,\n\t\trecenterOffset,\n\t\tfooterOffset,\n\t\tselectedPresetIndex,\n\t\tname,\n\t\tstores,\n\t\tcropAutoCenterImageSelectionTimeout,\n\t\tcropEnableZoomMatchImageAspectRatio,\n\t\tcropEnableRotateMatchImageAspectRatio,\n\t\tcropEnableRotationInput,\n\t\tcropEnableZoomInput,\n\t\tcropEnableImageSelection,\n\t\tcropEnableInfoIndicator,\n\t\tcropEnableZoomTowardsWheelPosition,\n\t\tcropEnableLimitWheelInputToCropSelection,\n\t\tcropEnableCenterImageSelection,\n\t\tcropEnableButtonRotateLeft,\n\t\tcropEnableButtonRotateRight,\n\t\tcropEnableButtonFlipHorizontal,\n\t\tcropEnableButtonFlipVertical,\n\t\tcropSelectPresetOptions,\n\t\tcropEnableSelectPreset,\n\t\tcropEnableButtonToggleCropLimit,\n\t\tmeasure_handler_1,\n\t\tinteractable_function,\n\t\tselect_handler,\n\t\tutil_root_binding,\n\t\tmeasure_handler\n\t];\n}\n\nclass Crop extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$r,\n\t\t\tcreate_fragment$r,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tname: 79,\n\t\t\t\tisActive: 1,\n\t\t\t\tstores: 80,\n\t\t\t\tcropImageSelectionCornerStyle: 2,\n\t\t\t\tcropAutoCenterImageSelectionTimeout: 81,\n\t\t\t\tcropEnableZoomMatchImageAspectRatio: 82,\n\t\t\t\tcropEnableRotateMatchImageAspectRatio: 83,\n\t\t\t\tcropEnableRotationInput: 84,\n\t\t\t\tcropEnableZoom: 3,\n\t\t\t\tcropEnableZoomInput: 85,\n\t\t\t\tcropEnableImageSelection: 86,\n\t\t\t\tcropEnableInfoIndicator: 87,\n\t\t\t\tcropEnableZoomTowardsWheelPosition: 88,\n\t\t\t\tcropEnableLimitWheelInputToCropSelection: 89,\n\t\t\t\tcropEnableCenterImageSelection: 90,\n\t\t\t\tcropEnableButtonRotateLeft: 91,\n\t\t\t\tcropEnableButtonRotateRight: 92,\n\t\t\t\tcropEnableButtonFlipHorizontal: 93,\n\t\t\t\tcropEnableButtonFlipVertical: 94,\n\t\t\t\tcropSelectPresetOptions: 95,\n\t\t\t\tcropEnableSelectPreset: 96,\n\t\t\t\tcropEnableButtonToggleCropLimit: 97,\n\t\t\t\tlocale: 4,\n\t\t\t\ttools: 0\n\t\t\t},\n\t\t\t[-1, -1, -1, -1, -1, -1]\n\t\t);\n\t}\n\n\tget name() {\n\t\treturn this.$$.ctx[79];\n\t}\n\n\tget isActive() {\n\t\treturn this.$$.ctx[1];\n\t}\n\n\tset isActive(isActive) {\n\t\tthis.$set({ isActive });\n\t\tflush();\n\t}\n\n\tget stores() {\n\t\treturn this.$$.ctx[80];\n\t}\n\n\tset stores(stores) {\n\t\tthis.$set({ stores });\n\t\tflush();\n\t}\n\n\tget cropImageSelectionCornerStyle() {\n\t\treturn this.$$.ctx[2];\n\t}\n\n\tset cropImageSelectionCornerStyle(cropImageSelectionCornerStyle) {\n\t\tthis.$set({ cropImageSelectionCornerStyle });\n\t\tflush();\n\t}\n\n\tget cropAutoCenterImageSelectionTimeout() {\n\t\treturn this.$$.ctx[81];\n\t}\n\n\tset cropAutoCenterImageSelectionTimeout(cropAutoCenterImageSelectionTimeout) {\n\t\tthis.$set({ cropAutoCenterImageSelectionTimeout });\n\t\tflush();\n\t}\n\n\tget cropEnableZoomMatchImageAspectRatio() {\n\t\treturn this.$$.ctx[82];\n\t}\n\n\tset cropEnableZoomMatchImageAspectRatio(cropEnableZoomMatchImageAspectRatio) {\n\t\tthis.$set({ cropEnableZoomMatchImageAspectRatio });\n\t\tflush();\n\t}\n\n\tget cropEnableRotateMatchImageAspectRatio() {\n\t\treturn this.$$.ctx[83];\n\t}\n\n\tset cropEnableRotateMatchImageAspectRatio(cropEnableRotateMatchImageAspectRatio) {\n\t\tthis.$set({ cropEnableRotateMatchImageAspectRatio });\n\t\tflush();\n\t}\n\n\tget cropEnableRotationInput() {\n\t\treturn this.$$.ctx[84];\n\t}\n\n\tset cropEnableRotationInput(cropEnableRotationInput) {\n\t\tthis.$set({ cropEnableRotationInput });\n\t\tflush();\n\t}\n\n\tget cropEnableZoom() {\n\t\treturn this.$$.ctx[3];\n\t}\n\n\tset cropEnableZoom(cropEnableZoom) {\n\t\tthis.$set({ cropEnableZoom });\n\t\tflush();\n\t}\n\n\tget cropEnableZoomInput() {\n\t\treturn this.$$.ctx[85];\n\t}\n\n\tset cropEnableZoomInput(cropEnableZoomInput) {\n\t\tthis.$set({ cropEnableZoomInput });\n\t\tflush();\n\t}\n\n\tget cropEnableImageSelection() {\n\t\treturn this.$$.ctx[86];\n\t}\n\n\tset cropEnableImageSelection(cropEnableImageSelection) {\n\t\tthis.$set({ cropEnableImageSelection });\n\t\tflush();\n\t}\n\n\tget cropEnableInfoIndicator() {\n\t\treturn this.$$.ctx[87];\n\t}\n\n\tset cropEnableInfoIndicator(cropEnableInfoIndicator) {\n\t\tthis.$set({ cropEnableInfoIndicator });\n\t\tflush();\n\t}\n\n\tget cropEnableZoomTowardsWheelPosition() {\n\t\treturn this.$$.ctx[88];\n\t}\n\n\tset cropEnableZoomTowardsWheelPosition(cropEnableZoomTowardsWheelPosition) {\n\t\tthis.$set({ cropEnableZoomTowardsWheelPosition });\n\t\tflush();\n\t}\n\n\tget cropEnableLimitWheelInputToCropSelection() {\n\t\treturn this.$$.ctx[89];\n\t}\n\n\tset cropEnableLimitWheelInputToCropSelection(cropEnableLimitWheelInputToCropSelection) {\n\t\tthis.$set({ cropEnableLimitWheelInputToCropSelection });\n\t\tflush();\n\t}\n\n\tget cropEnableCenterImageSelection() {\n\t\treturn this.$$.ctx[90];\n\t}\n\n\tset cropEnableCenterImageSelection(cropEnableCenterImageSelection) {\n\t\tthis.$set({ cropEnableCenterImageSelection });\n\t\tflush();\n\t}\n\n\tget cropEnableButtonRotateLeft() {\n\t\treturn this.$$.ctx[91];\n\t}\n\n\tset cropEnableButtonRotateLeft(cropEnableButtonRotateLeft) {\n\t\tthis.$set({ cropEnableButtonRotateLeft });\n\t\tflush();\n\t}\n\n\tget cropEnableButtonRotateRight() {\n\t\treturn this.$$.ctx[92];\n\t}\n\n\tset cropEnableButtonRotateRight(cropEnableButtonRotateRight) {\n\t\tthis.$set({ cropEnableButtonRotateRight });\n\t\tflush();\n\t}\n\n\tget cropEnableButtonFlipHorizontal() {\n\t\treturn this.$$.ctx[93];\n\t}\n\n\tset cropEnableButtonFlipHorizontal(cropEnableButtonFlipHorizontal) {\n\t\tthis.$set({ cropEnableButtonFlipHorizontal });\n\t\tflush();\n\t}\n\n\tget cropEnableButtonFlipVertical() {\n\t\treturn this.$$.ctx[94];\n\t}\n\n\tset cropEnableButtonFlipVertical(cropEnableButtonFlipVertical) {\n\t\tthis.$set({ cropEnableButtonFlipVertical });\n\t\tflush();\n\t}\n\n\tget cropSelectPresetOptions() {\n\t\treturn this.$$.ctx[95];\n\t}\n\n\tset cropSelectPresetOptions(cropSelectPresetOptions) {\n\t\tthis.$set({ cropSelectPresetOptions });\n\t\tflush();\n\t}\n\n\tget cropEnableSelectPreset() {\n\t\treturn this.$$.ctx[96];\n\t}\n\n\tset cropEnableSelectPreset(cropEnableSelectPreset) {\n\t\tthis.$set({ cropEnableSelectPreset });\n\t\tflush();\n\t}\n\n\tget cropEnableButtonToggleCropLimit() {\n\t\treturn this.$$.ctx[97];\n\t}\n\n\tset cropEnableButtonToggleCropLimit(cropEnableButtonToggleCropLimit) {\n\t\tthis.$set({ cropEnableButtonToggleCropLimit });\n\t\tflush();\n\t}\n\n\tget locale() {\n\t\treturn this.$$.ctx[4];\n\t}\n\n\tset locale(locale) {\n\t\tthis.$set({ locale });\n\t\tflush();\n\t}\n\n\tget tools() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tset tools(tools) {\n\t\tthis.$set({ tools });\n\t\tflush();\n\t}\n}\n\n// @ts-ignore\nvar index = { util: ['crop', Crop] };\n\n/* src/core/ui/plugins/filter/index.svelte generated by Svelte v3.29.4 */\n\nfunction create_option_slot$2(ctx) {\n\tlet div0;\n\tlet div1;\n\tlet measurable_action;\n\tlet option = /*option*/ ctx[61];\n\tlet t0;\n\tlet span;\n\n\tlet t1_value = (isFunction(/*option*/ ctx[61].label)\n\t? /*option*/ ctx[61].label(/*locale*/ ctx[2])\n\t: /*option*/ ctx[61].label) + \"\";\n\n\tlet t1;\n\tlet mounted;\n\tlet dispose;\n\n\tfunction measure_handler_1(...args) {\n\t\treturn /*measure_handler_1*/ ctx[29](/*option*/ ctx[61], ...args);\n\t}\n\n\tconst assign_div1 = () => /*div1_binding*/ ctx[30](div1, option);\n\tconst unassign_div1 = () => /*div1_binding*/ ctx[30](null, option);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv0 = element(\"div\");\n\t\t\tdiv1 = element(\"div\");\n\t\t\tt0 = space();\n\t\t\tspan = element(\"span\");\n\t\t\tt1 = text(t1_value);\n\t\t\tattr(div1, \"class\", FILTER_PREVIEW_CLASS_NAME);\n\t\t\tattr(div0, \"slot\", \"option\");\n\t\t\tattr(div0, \"class\", \"DokaFilterOption\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div0, anchor);\n\t\t\tappend(div0, div1);\n\t\t\tassign_div1();\n\t\t\tappend(div0, t0);\n\t\t\tappend(div0, span);\n\t\t\tappend(span, t1);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div1, \"measure\", measure_handler_1),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div1))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\n\t\t\tif (option !== /*option*/ ctx[61]) {\n\t\t\t\tunassign_div1();\n\t\t\t\toption = /*option*/ ctx[61];\n\t\t\t\tassign_div1();\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*locale*/ 4 | dirty[1] & /*option*/ 1073741824 && t1_value !== (t1_value = (isFunction(/*option*/ ctx[61].label)\n\t\t\t? /*option*/ ctx[61].label(/*locale*/ ctx[2])\n\t\t\t: /*option*/ ctx[61].label) + \"\")) set_data(t1, t1_value);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div0);\n\t\t\tunassign_div1();\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\n// (459:8) <Scrollable              elasticity={elasticityMultiplier * scrollElasticity}              onscroll={offset => tileScrollOffset = offset}              bind:maskFeatherStartOpacity={tileLeftOpacity}             bind:maskFeatherEndOpacity={tileRightOpacity}             bind:maskFeatherSize={tileMargin}             on:measure={e => tileScrollContainerRect = e.detail}>\nfunction create_default_slot_1$5(ctx) {\n\tlet radiogroup;\n\tlet current;\n\n\tradiogroup = new RadioGroup({\n\t\t\tprops: {\n\t\t\t\tlocale: /*locale*/ ctx[2],\n\t\t\t\tlayout: \"row\",\n\t\t\t\toptions: /*filterOptions*/ ctx[3],\n\t\t\t\tselectedIndex: /*selectedFilterIndex*/ ctx[10],\n\t\t\t\tonchange: /*handleChangeFilter*/ ctx[25],\n\t\t\t\t$$slots: {\n\t\t\t\t\toption: [\n\t\t\t\t\t\tcreate_option_slot$2,\n\t\t\t\t\t\t({ option }) => ({ 61: option }),\n\t\t\t\t\t\t({ option }) => [0, option ? 1073741824 : 0]\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(radiogroup.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(radiogroup, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst radiogroup_changes = {};\n\t\t\tif (dirty[0] & /*locale*/ 4) radiogroup_changes.locale = /*locale*/ ctx[2];\n\t\t\tif (dirty[0] & /*filterOptions*/ 8) radiogroup_changes.options = /*filterOptions*/ ctx[3];\n\t\t\tif (dirty[0] & /*selectedFilterIndex*/ 1024) radiogroup_changes.selectedIndex = /*selectedFilterIndex*/ ctx[10];\n\n\t\t\tif (dirty[0] & /*locale, tileElements*/ 20 | dirty[1] & /*option*/ 1073741824 | dirty[2] & /*$$scope*/ 1) {\n\t\t\t\tradiogroup_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tradiogroup.$set(radiogroup_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(radiogroup.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(radiogroup.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(radiogroup, detaching);\n\t\t}\n\t};\n}\n\n// (458:4) <div slot=\"footer\" style={footerStyle} on:transitionend={handleTransitionEnd}>\nfunction create_footer_slot$1(ctx) {\n\tlet div;\n\tlet scrollable;\n\tlet updating_maskFeatherStartOpacity;\n\tlet updating_maskFeatherEndOpacity;\n\tlet updating_maskFeatherSize;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\tfunction scrollable_maskFeatherStartOpacity_binding(value) {\n\t\t/*scrollable_maskFeatherStartOpacity_binding*/ ctx[32].call(null, value);\n\t}\n\n\tfunction scrollable_maskFeatherEndOpacity_binding(value) {\n\t\t/*scrollable_maskFeatherEndOpacity_binding*/ ctx[33].call(null, value);\n\t}\n\n\tfunction scrollable_maskFeatherSize_binding(value) {\n\t\t/*scrollable_maskFeatherSize_binding*/ ctx[34].call(null, value);\n\t}\n\n\tlet scrollable_props = {\n\t\telasticity: /*elasticityMultiplier*/ ctx[14] * /*scrollElasticity*/ ctx[15],\n\t\tonscroll: /*func*/ ctx[31],\n\t\t$$slots: { default: [create_default_slot_1$5] },\n\t\t$$scope: { ctx }\n\t};\n\n\tif (/*tileLeftOpacity*/ ctx[5] !== void 0) {\n\t\tscrollable_props.maskFeatherStartOpacity = /*tileLeftOpacity*/ ctx[5];\n\t}\n\n\tif (/*tileRightOpacity*/ ctx[6] !== void 0) {\n\t\tscrollable_props.maskFeatherEndOpacity = /*tileRightOpacity*/ ctx[6];\n\t}\n\n\tif (/*tileMargin*/ ctx[7] !== void 0) {\n\t\tscrollable_props.maskFeatherSize = /*tileMargin*/ ctx[7];\n\t}\n\n\tscrollable = new Scrollable({ props: scrollable_props });\n\tbinding_callbacks.push(() => bind(scrollable, \"maskFeatherStartOpacity\", scrollable_maskFeatherStartOpacity_binding));\n\tbinding_callbacks.push(() => bind(scrollable, \"maskFeatherEndOpacity\", scrollable_maskFeatherEndOpacity_binding));\n\tbinding_callbacks.push(() => bind(scrollable, \"maskFeatherSize\", scrollable_maskFeatherSize_binding));\n\tscrollable.$on(\"measure\", /*measure_handler_2*/ ctx[35]);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(scrollable.$$.fragment);\n\t\t\tattr(div, \"slot\", \"footer\");\n\t\t\tattr(div, \"style\", /*footerStyle*/ ctx[11]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(scrollable, div, null);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = listen(div, \"transitionend\", /*handleTransitionEnd*/ ctx[23]);\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst scrollable_changes = {};\n\t\t\tif (dirty[0] & /*tileScrollOffset*/ 256) scrollable_changes.onscroll = /*func*/ ctx[31];\n\n\t\t\tif (dirty[0] & /*locale, filterOptions, selectedFilterIndex, tileElements*/ 1052 | dirty[2] & /*$$scope*/ 1) {\n\t\t\t\tscrollable_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tif (!updating_maskFeatherStartOpacity && dirty[0] & /*tileLeftOpacity*/ 32) {\n\t\t\t\tupdating_maskFeatherStartOpacity = true;\n\t\t\t\tscrollable_changes.maskFeatherStartOpacity = /*tileLeftOpacity*/ ctx[5];\n\t\t\t\tadd_flush_callback(() => updating_maskFeatherStartOpacity = false);\n\t\t\t}\n\n\t\t\tif (!updating_maskFeatherEndOpacity && dirty[0] & /*tileRightOpacity*/ 64) {\n\t\t\t\tupdating_maskFeatherEndOpacity = true;\n\t\t\t\tscrollable_changes.maskFeatherEndOpacity = /*tileRightOpacity*/ ctx[6];\n\t\t\t\tadd_flush_callback(() => updating_maskFeatherEndOpacity = false);\n\t\t\t}\n\n\t\t\tif (!updating_maskFeatherSize && dirty[0] & /*tileMargin*/ 128) {\n\t\t\t\tupdating_maskFeatherSize = true;\n\t\t\t\tscrollable_changes.maskFeatherSize = /*tileMargin*/ ctx[7];\n\t\t\t\tadd_flush_callback(() => updating_maskFeatherSize = false);\n\t\t\t}\n\n\t\t\tscrollable.$set(scrollable_changes);\n\n\t\t\tif (!current || dirty[0] & /*footerStyle*/ 2048) {\n\t\t\t\tattr(div, \"style\", /*footerStyle*/ ctx[11]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(scrollable.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(scrollable.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(scrollable);\n\t\t\tmounted = false;\n\t\t\tdispose();\n\t\t}\n\t};\n}\n\nfunction create_fragment$s(ctx) {\n\tlet util;\n\tlet current;\n\n\tutil = new Util({\n\t\t\tprops: {\n\t\t\t\t$$slots: { footer: [create_footer_slot$1] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\tutil.$on(\"measure\", /*measure_handler*/ ctx[36]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(util.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(util, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst util_changes = {};\n\n\t\t\tif (dirty[0] & /*footerStyle, tileScrollOffset, tileLeftOpacity, tileRightOpacity, tileMargin, tileScrollContainerRect, locale, filterOptions, selectedFilterIndex, tileElements*/ 4092 | dirty[2] & /*$$scope*/ 1) {\n\t\t\t\tutil_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tutil.$set(util_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(util.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(util.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(util, detaching);\n\t\t}\n\t};\n}\n\nlet FILTER_PREVIEW_CLASS_NAME = \"DokaFilterPreview\";\n\nfunction instance$s($$self, $$props, $$invalidate) {\n\tlet $imageColorMatrix;\n\tlet $tileRects;\n\tlet $canvasSize;\n\tlet $imageTransforms;\n\n\tlet $isActive,\n\t\t$$unsubscribe_isActive = noop$1,\n\t\t$$subscribe_isActive = () => ($$unsubscribe_isActive(), $$unsubscribe_isActive = subscribe(isActive, $$value => $$invalidate(44, $isActive = $$value)), isActive);\n\n\tlet $utilRect;\n\tlet $stageRect;\n\tlet $imageGamma;\n\n\tlet $isActiveFraction,\n\t\t$$unsubscribe_isActiveFraction = noop$1,\n\t\t$$subscribe_isActiveFraction = () => ($$unsubscribe_isActiveFraction(), $$unsubscribe_isActiveFraction = subscribe(isActiveFraction, $$value => $$invalidate(48, $isActiveFraction = $$value)), isActiveFraction);\n\n\tlet $footerOffset;\n\tlet $imageTiles;\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_isActive());\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_isActiveFraction());\n\tconst name = \"filter\";\n\tlet { isActive } = $$props;\n\t$$subscribe_isActive();\n\tlet { isActiveFraction } = $$props;\n\t$$subscribe_isActiveFraction();\n\tlet { stores } = $$props;\n\tlet { locale } = $$props;\n\tlet { filterFunctions } = $$props;\n\tlet { filterOptions } = $$props;\n\n\t// connect filter choice to stores\n\tconst { history, imagePreviews, stageRect, utilRect, elasticityMultiplier, scrollElasticity, imageCropRect, imageSize, imageRotation, imageFlipX, imageFlipY, imageGamma, imageColorMatrix } = stores;\n\n\tcomponent_subscribe($$self, stageRect, value => $$invalidate(46, $stageRect = value));\n\tcomponent_subscribe($$self, utilRect, value => $$invalidate(45, $utilRect = value));\n\tcomponent_subscribe($$self, imageGamma, value => $$invalidate(47, $imageGamma = value));\n\tcomponent_subscribe($$self, imageColorMatrix, value => $$invalidate(40, $imageColorMatrix = value));\n\n\tconst getFilterIndex = (imageColorMatrix, filterOptionsFlattened) => {\n\t\tif (!imageColorMatrix || !imageColorMatrix[\"filter\"] || !filterOptionsFlattened) return 0;\n\t\tconst filterColorMatrix = imageColorMatrix[\"filter\"];\n\n\t\treturn filterOptionsFlattened.// get id and compare matrices\n\t\tfindIndex(([id]) => {\n\t\t\tif (!filterFunctions[id]) return false;\n\t\t\tconst matrix = filterFunctions[id]();\n\t\t\treturn arrayEqual(matrix, filterColorMatrix);\n\t\t});\n\t};\n\n\tconst tileRects = writable({});\n\tcomponent_subscribe($$self, tileRects, value => $$invalidate(41, $tileRects = value));\n\tconst handleTileResize = (item, rect) => set_store_value(tileRects, $tileRects[item.value] = rect, $tileRects);\n\n\tconst canvasSize = derived(tileRects, $tileRects => {\n\t\tif (!$tileRects[undefined]) return;\n\t\tconst tileRectFirst = $tileRects[undefined];\n\t\tif ($canvasSize && sizeEqual($canvasSize, tileRectFirst)) return $canvasSize;\n\t\treturn sizeClone(tileRectFirst);\n\t});\n\n\tcomponent_subscribe($$self, canvasSize, value => $$invalidate(42, $canvasSize = value));\n\n\tconst imageTransforms = derived(\n\t\t[\n\t\t\tisActive,\n\t\t\tcanvasSize,\n\t\t\timageCropRect,\n\t\t\timageSize,\n\t\t\timageRotation,\n\t\t\timageFlipX,\n\t\t\timageFlipY\n\t\t],\n\t\t([\n\t\t\t\t$isActive,\n\t\t\t\t$canvasSize,\n\t\t\t\t$imageCropRect,\n\t\t\t\t$imageSize,\n\t\t\t\t$imageRotation,\n\t\t\t\t$imageFlipX,\n\t\t\t\t$imageFlipY\n\t\t\t], set) => {\n\t\t\tif (!$isActive || !$canvasSize || !$imageSize) return $imageTransforms;\n\t\t\tconst imageRect = rectCreateFromSize($imageSize);\n\t\t\tconst imageCenter = rectCenter(imageRect);\n\n\t\t\t// get base crop rect so we can correctly apply transforms\n\t\t\tconst cropRectBase = getBaseCropRect($imageSize, $imageCropRect, $imageRotation);\n\n\t\t\tconst cropRectBaseCenter = rectCenter(cropRectBase);\n\t\t\tconst imageTranslation = vectorSubtract(vectorClone(imageCenter), cropRectBaseCenter);\n\t\t\tconst imageOrigin = vectorInvert(vectorClone(imageTranslation));\n\n\t\t\t// scalar\n\t\t\tconst imageScalar = Math.max($canvasSize.width / $imageCropRect.width, $canvasSize.height / $imageCropRect.height);\n\n\t\t\t// update preview transforms\n\t\t\tset({\n\t\t\t\torigin: imageOrigin,\n\t\t\t\ttranslation: imageTranslation,\n\t\t\t\trotation: {\n\t\t\t\t\tx: $imageFlipY ? Math.PI : 0,\n\t\t\t\t\ty: $imageFlipX ? Math.PI : 0,\n\t\t\t\t\tz: $imageRotation\n\t\t\t\t},\n\t\t\t\tperspective: vectorCreateEmpty(),\n\t\t\t\tscale: imageScalar\n\t\t\t});\n\t\t}\n\t);\n\n\tcomponent_subscribe($$self, imageTransforms, value => $$invalidate(43, $imageTransforms = value));\n\n\tconst cloneImageTransforms = imageTransforms => ({\n\t\torigin: vectorClone(imageTransforms.origin),\n\t\ttranslation: vectorClone(imageTransforms.translation),\n\t\trotation: { ...imageTransforms.rotation },\n\t\tperspective: vectorClone(imageTransforms.perspective),\n\t\tscale: imageTransforms.scale\n\t});\n\n\t//\n\t// Footer\n\t//\n\tconst footerOffset = spring(0);\n\n\tcomponent_subscribe($$self, footerOffset, value => $$invalidate(49, $footerOffset = value));\n\tlet tileCornerRadius;\n\tconst tileElements = {};\n\n\tconst handleTransitionEnd = e => {\n\t\tif (e.target.className !== FILTER_PREVIEW_CLASS_NAME) return;\n\n\t\t$$invalidate(37, tileCornerRadius = Object.keys(tileElements).reduce(\n\t\t\t(prev, curr) => {\n\t\t\t\tconst element = tileElements[curr];\n\t\t\t\tconst style = getComputedStyle(element);\n\n\t\t\t\tconst corners = [\"top-left\", \"top-right\", \"bottom-left\", \"bottom-right\"].map(corner => style.getPropertyValue(`border-${corner}-radius`)).map(unitToPixels).// this better aligns WebGL rounded corner with css rounded corner\n\t\t\t\tmap(v => v * 1.25);\n\n\t\t\t\tprev[curr] = corners;\n\t\t\t\treturn prev;\n\t\t\t},\n\t\t\t{}\n\t\t));\n\t};\n\n\tlet tileLeftOpacity; // set by Scrollable\n\tlet tileRightOpacity; // set by Scrollable\n\tlet tileMargin; // set by Scrollable\n\tlet tileScrollOffset = { x: 0, y: 0 };\n\tlet tileScrollContainerRect;\n\tlet tileWrapperOffset;\n\tconst imageTiles = writable([]);\n\tcomponent_subscribe($$self, imageTiles, value => $$invalidate(50, $imageTiles = value));\n\n\t// clones an image tile for use in canvas\n\tconst cloneImageTile = tile => {\n\t\tconst clone = {\n\t\t\t// doesn't clone everything but should be enough\n\t\t\t...tile,\n\t\t\toffset: { ...tile.offset },\n\t\t\tmask: { ...tile.mask }\n\t\t};\n\n\t\tclone.opacity = $isActiveFraction;\n\t\tclone.offset.y += $footerOffset;\n\t\tclone.mask.y += $footerOffset;\n\t\treturn clone;\n\t};\n\n\tconst handleChangeFilter = ({ value }) => {\n\t\tset_store_value(\n\t\t\timageColorMatrix,\n\t\t\t$imageColorMatrix = {\n\t\t\t\t...$imageColorMatrix,\n\t\t\t\t\"filter\": isFunction(filterFunctions[value])\n\t\t\t\t? filterFunctions[value]()\n\t\t\t\t: undefined\n\t\t\t},\n\t\t\t$imageColorMatrix\n\t\t);\n\n\t\thistory.write();\n\t};\n\n\tconst measure_handler_1 = (option, e) => handleTileResize(option, e.detail);\n\n\tfunction div1_binding($$value, option) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\ttileElements[option.value] = $$value;\n\t\t\t$$invalidate(4, tileElements);\n\t\t});\n\t}\n\n\tconst func = offset => $$invalidate(8, tileScrollOffset = offset);\n\n\tfunction scrollable_maskFeatherStartOpacity_binding(value) {\n\t\ttileLeftOpacity = value;\n\t\t$$invalidate(5, tileLeftOpacity);\n\t}\n\n\tfunction scrollable_maskFeatherEndOpacity_binding(value) {\n\t\ttileRightOpacity = value;\n\t\t$$invalidate(6, tileRightOpacity);\n\t}\n\n\tfunction scrollable_maskFeatherSize_binding(value) {\n\t\ttileMargin = value;\n\t\t$$invalidate(7, tileMargin);\n\t}\n\n\tconst measure_handler_2 = e => $$invalidate(9, tileScrollContainerRect = e.detail);\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"isActive\" in $$props) $$subscribe_isActive($$invalidate(0, isActive = $$props.isActive));\n\t\tif (\"isActiveFraction\" in $$props) $$subscribe_isActiveFraction($$invalidate(1, isActiveFraction = $$props.isActiveFraction));\n\t\tif (\"stores\" in $$props) $$invalidate(27, stores = $$props.stores);\n\t\tif (\"locale\" in $$props) $$invalidate(2, locale = $$props.locale);\n\t\tif (\"filterFunctions\" in $$props) $$invalidate(28, filterFunctions = $$props.filterFunctions);\n\t\tif (\"filterOptions\" in $$props) $$invalidate(3, filterOptions = $$props.filterOptions);\n\t};\n\n\tlet filterOptionsFlattened;\n\tlet selectedFilterIndex;\n\tlet footerStyle;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*filterOptions*/ 8) {\n\t\t\t $$invalidate(39, filterOptionsFlattened = flattenOptions(filterOptions));\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$imageColorMatrix, filterOptionsFlattened*/ 768) {\n\t\t\t $$invalidate(10, selectedFilterIndex = getFilterIndex($imageColorMatrix, filterOptionsFlattened));\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$isActive*/ 8192) {\n\t\t\t footerOffset.set($isActive ? 0 : 20);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$isActive, $utilRect, $stageRect*/ 57344) {\n\t\t\t if ($isActive && $utilRect && $stageRect) {\n\t\t\t\tconst tileTopOffset = $stageRect.y + $stageRect.height + $utilRect.y;\n\n\t\t\t\t$$invalidate(38, tileWrapperOffset = {\n\t\t\t\t\tx: $stageRect.x - $utilRect.x,\n\t\t\t\t\ty: tileTopOffset\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*tileScrollOffset, tileScrollContainerRect, tileMargin, tileLeftOpacity, tileRightOpacity, filterFunctions*/ 268436448 | $$self.$$.dirty[1] & /*$imageTransforms, tileWrapperOffset, tileCornerRadius, filterOptionsFlattened, $tileRects, $imageColorMatrix, $imageGamma*/ 71616) {\n\t\t\t if ($imageTransforms && tileWrapperOffset && tileScrollOffset && tileScrollContainerRect && tileCornerRadius) {\n\t\t\t\tconst boundsX = tileWrapperOffset.x + tileScrollContainerRect.x;\n\t\t\t\tconst offsetX = boundsX + tileScrollOffset.x;\n\t\t\t\tconst offsetY = tileWrapperOffset.y;\n\t\t\t\tconst containerLeft = tileScrollContainerRect.x + tileWrapperOffset.x;\n\t\t\t\tconst containerRight = containerLeft + tileScrollContainerRect.width;\n\n\t\t\t\timageTiles.set(filterOptionsFlattened.map(([id], i) => {\n\t\t\t\t\tconst tileRect = $tileRects[id];\n\n\t\t\t\t\t// test if is outside of view\n\t\t\t\t\tconst tileLeft = tileScrollOffset.x + tileRect.x;\n\n\t\t\t\t\tconst tileRight = tileLeft + tileRect.width;\n\t\t\t\t\tif (tileRight < 0 || tileLeft > tileScrollContainerRect.width) return false;\n\t\t\t\t\tconst x = offsetX + tileRect.x;\n\t\t\t\t\tconst y = offsetY + tileRect.y;\n\t\t\t\t\tconst preview = cloneImageTransforms($imageTransforms);\n\t\t\t\t\tpreview.offset = vectorCreate(tileRect.width * 0.5 + x, tileRect.height * 0.5 + y);\n\t\t\t\t\tlet clipX = 0;\n\t\t\t\t\tlet clipWidth = 0;\n\t\t\t\t\tpreview.maskOpacity = 1;\n\t\t\t\t\tpreview.mask = rectCreate(x + clipX, y, tileRect.width + clipWidth, tileRect.height);\n\t\t\t\t\tpreview.maskFeather = [1, 0, 1, 0, 1, containerRight, 1, containerRight];\n\n\t\t\t\t\tif (tileLeft < tileMargin && tileLeftOpacity < 1) {\n\t\t\t\t\t\tpreview.maskFeather[0] = tileLeftOpacity;\n\t\t\t\t\t\tpreview.maskFeather[1] = containerLeft;\n\t\t\t\t\t\tpreview.maskFeather[2] = 1;\n\t\t\t\t\t\tpreview.maskFeather[3] = containerLeft + tileMargin;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (tileRight > tileScrollContainerRect.width - tileMargin && tileRightOpacity < 1) {\n\t\t\t\t\t\tpreview.maskFeather[4] = tileRightOpacity;\n\t\t\t\t\t\tpreview.maskFeather[5] = containerRight - tileMargin;\n\t\t\t\t\t\tpreview.maskFeather[6] = 1;\n\t\t\t\t\t\tpreview.maskFeather[7] = containerRight;\n\t\t\t\t\t}\n\n\t\t\t\t\tpreview.maskCornerRadius = tileCornerRadius[id];\n\t\t\t\t\tlet colorMatrices = $imageColorMatrix && Object.keys($imageColorMatrix).filter(name => name != \"filter\").map(name => $imageColorMatrix[name]) || [];\n\n\t\t\t\t\tif (isFunction(filterFunctions[id])) {\n\t\t\t\t\t\tcolorMatrices.push(filterFunctions[id]());\n\t\t\t\t\t}\n\n\t\t\t\t\tpreview.colorMatrix = colorMatrices.length\n\t\t\t\t\t? getColorMatrixFromColorMatrices(colorMatrices)\n\t\t\t\t\t: undefined;\n\n\t\t\t\t\tpreview.gamma = $imageGamma;\n\t\t\t\t\treturn preview;\n\t\t\t\t}).filter(Boolean));\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$isActive, $imageTiles, $footerOffset, $isActiveFraction*/ 925696) {\n\t\t\t// Will update `imagePreviews` store when\n\t\t\t// - $isActiveFraction is updated\n\t\t\t// - $imageTiles is updated\n\t\t\t// - $footerOffset is updated\n\t\t\t if ($isActive && $imageTiles) {\n\n\t\t\t\t// clone tiles\n\t\t\t\timagePreviews.set($imageTiles.map(cloneImageTile));\n\t\t\t} else {\n\t\t\t\timagePreviews.set([]);\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$footerOffset*/ 262144) {\n\t\t\t $$invalidate(11, footerStyle = $footerOffset\n\t\t\t? `transform: translateY(${$footerOffset}px)`\n\t\t\t: undefined);\n\t\t}\n\t};\n\n\treturn [\n\t\tisActive,\n\t\tisActiveFraction,\n\t\tlocale,\n\t\tfilterOptions,\n\t\ttileElements,\n\t\ttileLeftOpacity,\n\t\ttileRightOpacity,\n\t\ttileMargin,\n\t\ttileScrollOffset,\n\t\ttileScrollContainerRect,\n\t\tselectedFilterIndex,\n\t\tfooterStyle,\n\t\tstageRect,\n\t\tutilRect,\n\t\telasticityMultiplier,\n\t\tscrollElasticity,\n\t\timageGamma,\n\t\timageColorMatrix,\n\t\ttileRects,\n\t\thandleTileResize,\n\t\tcanvasSize,\n\t\timageTransforms,\n\t\tfooterOffset,\n\t\thandleTransitionEnd,\n\t\timageTiles,\n\t\thandleChangeFilter,\n\t\tname,\n\t\tstores,\n\t\tfilterFunctions,\n\t\tmeasure_handler_1,\n\t\tdiv1_binding,\n\t\tfunc,\n\t\tscrollable_maskFeatherStartOpacity_binding,\n\t\tscrollable_maskFeatherEndOpacity_binding,\n\t\tscrollable_maskFeatherSize_binding,\n\t\tmeasure_handler_2,\n\t\tmeasure_handler\n\t];\n}\n\nclass Filter extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$s,\n\t\t\tcreate_fragment$s,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tname: 26,\n\t\t\t\tisActive: 0,\n\t\t\t\tisActiveFraction: 1,\n\t\t\t\tstores: 27,\n\t\t\t\tlocale: 2,\n\t\t\t\tfilterFunctions: 28,\n\t\t\t\tfilterOptions: 3\n\t\t\t},\n\t\t\t[-1, -1, -1]\n\t\t);\n\t}\n\n\tget name() {\n\t\treturn this.$$.ctx[26];\n\t}\n\n\tget isActive() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tset isActive(isActive) {\n\t\tthis.$set({ isActive });\n\t\tflush();\n\t}\n\n\tget isActiveFraction() {\n\t\treturn this.$$.ctx[1];\n\t}\n\n\tset isActiveFraction(isActiveFraction) {\n\t\tthis.$set({ isActiveFraction });\n\t\tflush();\n\t}\n\n\tget stores() {\n\t\treturn this.$$.ctx[27];\n\t}\n\n\tset stores(stores) {\n\t\tthis.$set({ stores });\n\t\tflush();\n\t}\n\n\tget locale() {\n\t\treturn this.$$.ctx[2];\n\t}\n\n\tset locale(locale) {\n\t\tthis.$set({ locale });\n\t\tflush();\n\t}\n\n\tget filterFunctions() {\n\t\treturn this.$$.ctx[28];\n\t}\n\n\tset filterFunctions(filterFunctions) {\n\t\tthis.$set({ filterFunctions });\n\t\tflush();\n\t}\n\n\tget filterOptions() {\n\t\treturn this.$$.ctx[3];\n\t}\n\n\tset filterOptions(filterOptions) {\n\t\tthis.$set({ filterOptions });\n\t\tflush();\n\t}\n}\n\n// @ts-ignore\nvar index$1 = { util: ['filter', Filter] };\n\n/* src/core/ui/plugins/finetune/index.svelte generated by Svelte v3.29.4 */\n\nfunction create_default_slot_3$4(ctx) {\n\tlet span;\n\tlet t_value = /*tab*/ ctx[35].label + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[1] & /*tab*/ 16 && t_value !== (t_value = /*tab*/ ctx[35].label + \"\")) set_data(t, t_value);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (152:8) <Scrollable elasticity={elasticityMultiplier * scrollElasticity} class=\"DokaControlListScroller\">\nfunction create_default_slot_2$4(ctx) {\n\tlet tablist;\n\tlet current;\n\tconst tablist_spread_levels = [{ class: \"DokaControlList\" }, { tabs: /*tabs*/ ctx[1] }, /*tabsConfig*/ ctx[3]];\n\n\tlet tablist_props = {\n\t\t$$slots: {\n\t\t\tdefault: [\n\t\t\t\tcreate_default_slot_3$4,\n\t\t\t\t({ tab }) => ({ 35: tab }),\n\t\t\t\t({ tab }) => [0, tab ? 16 : 0]\n\t\t\t]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tfor (let i = 0; i < tablist_spread_levels.length; i += 1) {\n\t\ttablist_props = assign(tablist_props, tablist_spread_levels[i]);\n\t}\n\n\ttablist = new TabList({ props: tablist_props });\n\ttablist.$on(\"select\", /*select_handler*/ ctx[17]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(tablist.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(tablist, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst tablist_changes = (dirty[0] & /*tabs, tabsConfig*/ 10)\n\t\t\t? get_spread_update(tablist_spread_levels, [\n\t\t\t\t\ttablist_spread_levels[0],\n\t\t\t\t\tdirty[0] & /*tabs*/ 2 && { tabs: /*tabs*/ ctx[1] },\n\t\t\t\t\tdirty[0] & /*tabsConfig*/ 8 && get_spread_object(/*tabsConfig*/ ctx[3])\n\t\t\t\t])\n\t\t\t: {};\n\n\t\t\tif (dirty[1] & /*$$scope, tab*/ 48) {\n\t\t\t\ttablist_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ttablist.$set(tablist_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(tablist.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(tablist.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(tablist, detaching);\n\t\t}\n\t};\n}\n\n// (158:8) <TabPanels class=\"DokaControlPanels\" panelClass=\"DokaControlPanel\" {panels} {...tabsConfig} let:panel>\nfunction create_default_slot_1$6(ctx) {\n\tlet rangeinput;\n\tlet current;\n\tconst rangeinput_spread_levels = [/*$rangeInputConfig*/ ctx[5][/*panel*/ ctx[34]]];\n\tlet rangeinput_props = {};\n\n\tfor (let i = 0; i < rangeinput_spread_levels.length; i += 1) {\n\t\trangeinput_props = assign(rangeinput_props, rangeinput_spread_levels[i]);\n\t}\n\n\trangeinput = new RangeInput({ props: rangeinput_props });\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(rangeinput.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(rangeinput, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst rangeinput_changes = (dirty[0] & /*$rangeInputConfig*/ 32 | dirty[1] & /*panel*/ 8)\n\t\t\t? get_spread_update(rangeinput_spread_levels, [get_spread_object(/*$rangeInputConfig*/ ctx[5][/*panel*/ ctx[34]])])\n\t\t\t: {};\n\n\t\t\trangeinput.$set(rangeinput_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(rangeinput.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(rangeinput.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(rangeinput, detaching);\n\t\t}\n\t};\n}\n\n// (150:4) <div slot=\"footer\" style={footerStyle}>\nfunction create_footer_slot$2(ctx) {\n\tlet div;\n\tlet scrollable;\n\tlet t;\n\tlet tabpanels;\n\tlet current;\n\n\tscrollable = new Scrollable({\n\t\t\tprops: {\n\t\t\t\telasticity: /*elasticityMultiplier*/ ctx[8] * /*scrollElasticity*/ ctx[7],\n\t\t\t\tclass: \"DokaControlListScroller\",\n\t\t\t\t$$slots: { default: [create_default_slot_2$4] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\tconst tabpanels_spread_levels = [\n\t\t{ class: \"DokaControlPanels\" },\n\t\t{ panelClass: \"DokaControlPanel\" },\n\t\t{ panels: /*panels*/ ctx[4] },\n\t\t/*tabsConfig*/ ctx[3]\n\t];\n\n\tlet tabpanels_props = {\n\t\t$$slots: {\n\t\t\tdefault: [\n\t\t\t\tcreate_default_slot_1$6,\n\t\t\t\t({ panel }) => ({ 34: panel }),\n\t\t\t\t({ panel }) => [0, panel ? 8 : 0]\n\t\t\t]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tfor (let i = 0; i < tabpanels_spread_levels.length; i += 1) {\n\t\ttabpanels_props = assign(tabpanels_props, tabpanels_spread_levels[i]);\n\t}\n\n\ttabpanels = new TabPanels({ props: tabpanels_props });\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(scrollable.$$.fragment);\n\t\t\tt = space();\n\t\t\tcreate_component(tabpanels.$$.fragment);\n\t\t\tattr(div, \"slot\", \"footer\");\n\t\t\tattr(div, \"style\", /*footerStyle*/ ctx[6]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(scrollable, div, null);\n\t\t\tappend(div, t);\n\t\t\tmount_component(tabpanels, div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst scrollable_changes = {};\n\n\t\t\tif (dirty[0] & /*tabs, tabsConfig, tabSelected*/ 14 | dirty[1] & /*$$scope*/ 32) {\n\t\t\t\tscrollable_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tscrollable.$set(scrollable_changes);\n\n\t\t\tconst tabpanels_changes = (dirty[0] & /*panels, tabsConfig*/ 24)\n\t\t\t? get_spread_update(tabpanels_spread_levels, [\n\t\t\t\t\ttabpanels_spread_levels[0],\n\t\t\t\t\ttabpanels_spread_levels[1],\n\t\t\t\t\tdirty[0] & /*panels*/ 16 && { panels: /*panels*/ ctx[4] },\n\t\t\t\t\tdirty[0] & /*tabsConfig*/ 8 && get_spread_object(/*tabsConfig*/ ctx[3])\n\t\t\t\t])\n\t\t\t: {};\n\n\t\t\tif (dirty[0] & /*$rangeInputConfig*/ 32 | dirty[1] & /*$$scope, panel*/ 40) {\n\t\t\t\ttabpanels_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ttabpanels.$set(tabpanels_changes);\n\n\t\t\tif (!current || dirty[0] & /*footerStyle*/ 64) {\n\t\t\t\tattr(div, \"style\", /*footerStyle*/ ctx[6]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(scrollable.$$.fragment, local);\n\t\t\ttransition_in(tabpanels.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(scrollable.$$.fragment, local);\n\t\t\ttransition_out(tabpanels.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(scrollable);\n\t\t\tdestroy_component(tabpanels);\n\t\t}\n\t};\n}\n\nfunction create_fragment$t(ctx) {\n\tlet util;\n\tlet current;\n\n\tutil = new Util({\n\t\t\tprops: {\n\t\t\t\t$$slots: { footer: [create_footer_slot$2] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\tutil.$on(\"measure\", /*measure_handler*/ ctx[18]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(util.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(util, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst util_changes = {};\n\n\t\t\tif (dirty[0] & /*footerStyle, panels, tabsConfig, $rangeInputConfig, tabs, tabSelected*/ 126 | dirty[1] & /*$$scope*/ 32) {\n\t\t\t\tutil_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tutil.$set(util_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(util.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(util.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(util, detaching);\n\t\t}\n\t};\n}\n\nfunction instance$t($$self, $$props, $$invalidate) {\n\tlet $rangeInputConfig;\n\tlet $panelValues;\n\n\tlet $isActive,\n\t\t$$unsubscribe_isActive = noop$1,\n\t\t$$subscribe_isActive = () => ($$unsubscribe_isActive(), $$unsubscribe_isActive = subscribe(isActive, $$value => $$invalidate(21, $isActive = $$value)), isActive);\n\n\tlet $footerOffset;\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_isActive());\n\tconst name = \"finetune\";\n\tlet { stores } = $$props;\n\tlet { isActive } = $$props;\n\t$$subscribe_isActive();\n\tlet { locale = {} } = $$props;\n\tlet { finetuneControlConfiguration } = $$props;\n\tlet { finetuneOptions } = $$props;\n\tconst { history, scrollElasticity, elasticityMultiplier, rangeInputElasticity, imageColorMatrix, imageConvolutionMatrix, imageGamma, imageVignette, imageNoise } = stores;\n\n\tconst imageEffectStores = {\n\t\timageColorMatrix,\n\t\timageConvolutionMatrix,\n\t\timageGamma,\n\t\timageVignette,\n\t\timageNoise\n\t};\n\n\t//\n\t// Tabs\n\t//\n\tconst uid = `doka-finetune-${getUniqueId()}`;\n\n\t//\n\t// Range inputs\n\t//\n\tconst panelValues = writable({});\n\n\tcomponent_subscribe($$self, panelValues, value => $$invalidate(20, $panelValues = value));\n\tconst rangeInputConfig = writable({});\n\tcomponent_subscribe($$self, rangeInputConfig, value => $$invalidate(5, $rangeInputConfig = value));\n\n\tconst updateRangeInputState = () => {\n\t\tset_store_value(\n\t\t\trangeInputConfig,\n\t\t\t$rangeInputConfig = Object.keys($panelValues).reduce(\n\t\t\t\t(config, id) => {\n\t\t\t\t\tconst { base, min, max, getLabel, getStore, setValue = (store, v) => store.set(v) } = finetuneControlConfiguration[id];\n\t\t\t\t\tconst store = getStore(imageEffectStores);\n\t\t\t\t\tconst value = $panelValues[id] != null ? $panelValues[id] : base;\n\n\t\t\t\t\tconfig[id] = {\n\t\t\t\t\t\tbase,\n\t\t\t\t\t\tmin,\n\t\t\t\t\t\tmax,\n\t\t\t\t\t\tvalue,\n\t\t\t\t\t\tvalueLabel: getLabel\n\t\t\t\t\t\t? getLabel(value, min, max, max - min)\n\t\t\t\t\t\t: Math.round(100 * value),\n\t\t\t\t\t\toninputmove: v => {\n\t\t\t\t\t\t\tsetValue(store, v);\n\t\t\t\t\t\t},\n\t\t\t\t\t\toninputend: v => {\n\t\t\t\t\t\t\tsetValue(store, v);\n\t\t\t\t\t\t\thistory.write();\n\t\t\t\t\t\t},\n\t\t\t\t\t\telasticity: elasticityMultiplier * rangeInputElasticity,\n\t\t\t\t\t\tlabelReset: locale.labelReset\n\t\t\t\t\t};\n\n\t\t\t\t\treturn config;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t),\n\t\t\t$rangeInputConfig\n\t\t);\n\t};\n\n\t// need to unsubscribe when redrawing vie\n\tlet unsubs = [];\n\n\tconst subscribePanelStores = config => {\n\t\tif (unsubs) unsubs.forEach(unsub => unsub());\n\n\t\tunsubs = panels.map(id => {\n\t\t\tconst { getStore, getValue = passthrough } = config[id];\n\t\t\tconst store = getStore(imageEffectStores);\n\n\t\t\treturn store.subscribe(value => {\n\t\t\t\tconst currentValue = value != null ? getValue(value) : value;\n\t\t\t\tset_store_value(panelValues, $panelValues = { ...$panelValues, [id]: currentValue }, $panelValues);\n\t\t\t});\n\t\t});\n\t};\n\n\t//\n\t// Footer\n\t//\n\tconst footerOffset = spring(0);\n\n\tcomponent_subscribe($$self, footerOffset, value => $$invalidate(22, $footerOffset = value));\n\tconst select_handler = ({ detail }) => $$invalidate(2, tabSelected = detail);\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"stores\" in $$props) $$invalidate(13, stores = $$props.stores);\n\t\tif (\"isActive\" in $$props) $$subscribe_isActive($$invalidate(0, isActive = $$props.isActive));\n\t\tif (\"locale\" in $$props) $$invalidate(14, locale = $$props.locale);\n\t\tif (\"finetuneControlConfiguration\" in $$props) $$invalidate(15, finetuneControlConfiguration = $$props.finetuneControlConfiguration);\n\t\tif (\"finetuneOptions\" in $$props) $$invalidate(16, finetuneOptions = $$props.finetuneOptions);\n\t};\n\n\tlet tabs;\n\tlet tabSelected;\n\tlet tabsConfig;\n\tlet panels;\n\tlet footerStyle;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*finetuneOptions, locale*/ 81920) {\n\t\t\t $$invalidate(1, tabs = finetuneOptions\n\t\t\t? finetuneOptions.map(([id, label]) => ({\n\t\t\t\t\tid,\n\t\t\t\t\tlabel: isFunction(label) ? label(locale) : label\n\t\t\t\t}))\n\t\t\t: []);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*tabs*/ 2) {\n\t\t\t $$invalidate(2, tabSelected = tabs.length && tabs[0].id);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*tabSelected*/ 4) {\n\t\t\t $$invalidate(3, tabsConfig = { name: uid, selected: tabSelected });\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*tabs*/ 2) {\n\t\t\t $$invalidate(4, panels = tabs.map(tab => tab.id));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*finetuneControlConfiguration*/ 32768) {\n\t\t\t finetuneControlConfiguration && subscribePanelStores(finetuneControlConfiguration);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*finetuneControlConfiguration, $panelValues*/ 1081344) {\n\t\t\t finetuneControlConfiguration && $panelValues && updateRangeInputState();\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$isActive*/ 2097152) {\n\t\t\t footerOffset.set($isActive ? 0 : 20);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$footerOffset*/ 4194304) {\n\t\t\t $$invalidate(6, footerStyle = $footerOffset\n\t\t\t? `transform: translateY(${$footerOffset}px)`\n\t\t\t: undefined);\n\t\t}\n\t};\n\n\treturn [\n\t\tisActive,\n\t\ttabs,\n\t\ttabSelected,\n\t\ttabsConfig,\n\t\tpanels,\n\t\t$rangeInputConfig,\n\t\tfooterStyle,\n\t\tscrollElasticity,\n\t\telasticityMultiplier,\n\t\tpanelValues,\n\t\trangeInputConfig,\n\t\tfooterOffset,\n\t\tname,\n\t\tstores,\n\t\tlocale,\n\t\tfinetuneControlConfiguration,\n\t\tfinetuneOptions,\n\t\tselect_handler,\n\t\tmeasure_handler\n\t];\n}\n\nclass Finetune extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$t,\n\t\t\tcreate_fragment$t,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tname: 12,\n\t\t\t\tstores: 13,\n\t\t\t\tisActive: 0,\n\t\t\t\tlocale: 14,\n\t\t\t\tfinetuneControlConfiguration: 15,\n\t\t\t\tfinetuneOptions: 16\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n\n\tget name() {\n\t\treturn this.$$.ctx[12];\n\t}\n\n\tget stores() {\n\t\treturn this.$$.ctx[13];\n\t}\n\n\tset stores(stores) {\n\t\tthis.$set({ stores });\n\t\tflush();\n\t}\n\n\tget isActive() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tset isActive(isActive) {\n\t\tthis.$set({ isActive });\n\t\tflush();\n\t}\n\n\tget locale() {\n\t\treturn this.$$.ctx[14];\n\t}\n\n\tset locale(locale) {\n\t\tthis.$set({ locale });\n\t\tflush();\n\t}\n\n\tget finetuneControlConfiguration() {\n\t\treturn this.$$.ctx[15];\n\t}\n\n\tset finetuneControlConfiguration(finetuneControlConfiguration) {\n\t\tthis.$set({ finetuneControlConfiguration });\n\t\tflush();\n\t}\n\n\tget finetuneOptions() {\n\t\treturn this.$$.ctx[16];\n\t}\n\n\tset finetuneOptions(finetuneOptions) {\n\t\tthis.$set({ finetuneOptions });\n\t\tflush();\n\t}\n}\n\n// @ts-ignore\nvar index$2 = { util: ['finetune', Finetune] };\n\n/* src/core/ui/components/ShapeManipulator.svelte generated by Svelte v3.29.4 */\n\nfunction get_each_context$5(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[47] = list[i].key;\n\tchild_ctx[48] = list[i].index;\n\tchild_ctx[49] = list[i].translate;\n\tchild_ctx[50] = list[i].scale;\n\tchild_ctx[14] = list[i].rotate;\n\tchild_ctx[51] = list[i].dir;\n\tchild_ctx[52] = list[i].center;\n\tchild_ctx[53] = list[i].type;\n\treturn child_ctx;\n}\n\n// (304:0) {#if type ==='edge' && resizeAxis !== 'both'}\nfunction create_if_block_1$8(ctx) {\n\tlet div;\n\tlet div_style_value;\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tattr(div, \"class\", \"DokaShapeManipulator\");\n\t\t\tattr(div, \"data-control\", \"point\");\n\t\t\tattr(div, \"style\", div_style_value = `pointer-events:none;transform: translate3d(${/*center*/ ctx[52].x}px, ${/*center*/ ctx[52].y}px, 0) scale(${/*$selectionScale*/ ctx[5]}, ${/*$selectionScale*/ ctx[5]}); opacity: ${/*$selectionOpacity*/ ctx[6]}`);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*resizeControls, $selectionScale, $selectionOpacity*/ 104 && div_style_value !== (div_style_value = `pointer-events:none;transform: translate3d(${/*center*/ ctx[52].x}px, ${/*center*/ ctx[52].y}px, 0) scale(${/*$selectionScale*/ ctx[5]}, ${/*$selectionScale*/ ctx[5]}); opacity: ${/*$selectionOpacity*/ ctx[6]}`)) {\n\t\t\t\tattr(div, \"style\", div_style_value);\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t}\n\t};\n}\n\n// (289:0) {#each resizeControls as { key, index, translate, scale, rotate, dir, center, type }\nfunction create_each_block$5(key_1, ctx) {\n\tlet div;\n\tlet div_tabindex_value;\n\tlet div_data_control_value;\n\tlet div_style_value;\n\tlet nudgeable_action;\n\tlet interactable_action;\n\tlet t;\n\tlet if_block_anchor;\n\tlet mounted;\n\tlet dispose;\n\n\tfunction nudge_handler(...args) {\n\t\treturn /*nudge_handler*/ ctx[18](/*index*/ ctx[48], ...args);\n\t}\n\n\tlet if_block = /*type*/ ctx[53] === \"edge\" && /*resizeAxis*/ ctx[2] !== \"both\" && create_if_block_1$8(ctx);\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tt = space();\n\t\t\tif (if_block) if_block.c();\n\t\t\tif_block_anchor = empty();\n\t\t\tattr(div, \"role\", \"button\");\n\t\t\tattr(div, \"tabindex\", div_tabindex_value = /*type*/ ctx[53] === \"edge\" ? -1 : 0);\n\t\t\tattr(div, \"class\", \"DokaShapeManipulator\");\n\t\t\tattr(div, \"data-control\", div_data_control_value = /*type*/ ctx[53]);\n\n\t\t\tattr(div, \"style\", div_style_value = `cursor: ${/*dir*/ ctx[51] ? /*dir*/ ctx[51] + \"-resize\" : \"move\"}; transform: translate3d(${/*translate*/ ctx[49].x}px, ${/*translate*/ ctx[49].y}px, 0) rotate(${/*rotate*/ ctx[14]}rad) scale(${/*type*/ ctx[53] === \"point\"\n\t\t\t? /*$selectionScale*/ ctx[5]\n\t\t\t: /*scale*/ ctx[50].x}, ${/*type*/ ctx[53] === \"point\"\n\t\t\t? /*$selectionScale*/ ctx[5]\n\t\t\t: /*scale*/ ctx[50].y}); opacity: ${/*$selectionOpacity*/ ctx[6]}`);\n\n\t\t\tthis.first = div;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tinsert(target, t, anchor);\n\t\t\tif (if_block) if_block.m(target, anchor);\n\t\t\tinsert(target, if_block_anchor, anchor);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div, \"keydown\", /*handleKeyDown*/ ctx[7]),\n\t\t\t\t\tlisten(div, \"keyup\", /*handleKeyUp*/ ctx[8]),\n\t\t\t\t\tlisten(div, \"nudge\", nudge_handler),\n\t\t\t\t\taction_destroyer(nudgeable_action = nudgeable.call(null, div)),\n\t\t\t\t\tlisten(div, \"interactionstart\", function () {\n\t\t\t\t\t\tif (is_function(/*resize*/ ctx[11](\"start\", /*index*/ ctx[48]))) /*resize*/ ctx[11](\"start\", /*index*/ ctx[48]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(div, \"interactionupdate\", function () {\n\t\t\t\t\t\tif (is_function(/*resize*/ ctx[11](\"move\", /*index*/ ctx[48]))) /*resize*/ ctx[11](\"move\", /*index*/ ctx[48]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\tlisten(div, \"interactionend\", function () {\n\t\t\t\t\t\tif (is_function(/*resize*/ ctx[11](\"end\", /*index*/ ctx[48]))) /*resize*/ ctx[11](\"end\", /*index*/ ctx[48]).apply(this, arguments);\n\t\t\t\t\t}),\n\t\t\t\t\taction_destroyer(interactable_action = interactable.call(null, div))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\n\t\t\tif (dirty[0] & /*resizeControls*/ 8 && div_tabindex_value !== (div_tabindex_value = /*type*/ ctx[53] === \"edge\" ? -1 : 0)) {\n\t\t\t\tattr(div, \"tabindex\", div_tabindex_value);\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*resizeControls*/ 8 && div_data_control_value !== (div_data_control_value = /*type*/ ctx[53])) {\n\t\t\t\tattr(div, \"data-control\", div_data_control_value);\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*resizeControls, $selectionScale, $selectionOpacity*/ 104 && div_style_value !== (div_style_value = `cursor: ${/*dir*/ ctx[51] ? /*dir*/ ctx[51] + \"-resize\" : \"move\"}; transform: translate3d(${/*translate*/ ctx[49].x}px, ${/*translate*/ ctx[49].y}px, 0) rotate(${/*rotate*/ ctx[14]}rad) scale(${/*type*/ ctx[53] === \"point\"\n\t\t\t? /*$selectionScale*/ ctx[5]\n\t\t\t: /*scale*/ ctx[50].x}, ${/*type*/ ctx[53] === \"point\"\n\t\t\t? /*$selectionScale*/ ctx[5]\n\t\t\t: /*scale*/ ctx[50].y}); opacity: ${/*$selectionOpacity*/ ctx[6]}`)) {\n\t\t\t\tattr(div, \"style\", div_style_value);\n\t\t\t}\n\n\t\t\tif (/*type*/ ctx[53] === \"edge\" && /*resizeAxis*/ ctx[2] !== \"both\") {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_1$8(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\tif_block.m(if_block_anchor.parentNode, if_block_anchor);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tif_block.d(1);\n\t\t\t\tif_block = null;\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (detaching) detach(t);\n\t\t\tif (if_block) if_block.d(detaching);\n\t\t\tif (detaching) detach(if_block_anchor);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\n// (308:0) {#if enableRotating && rotationControlActive}\nfunction create_if_block$7(ctx) {\n\tlet div;\n\tlet div_style_value;\n\tlet nudgeable_action;\n\tlet interactable_action;\n\tlet mounted;\n\tlet dispose;\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tattr(div, \"role\", \"button\");\n\t\t\tattr(div, \"tabindex\", \"0\");\n\t\t\tattr(div, \"class\", \"DokaShapeManipulator\");\n\t\t\tattr(div, \"data-control\", \"rotate\");\n\t\t\tattr(div, \"style\", div_style_value = `transform: translate3d(${/*rotatorPoint*/ ctx[0].x}px, ${/*rotatorPoint*/ ctx[0].y}px, 0) scale(${/*$selectionScale*/ ctx[5]}, ${/*$selectionScale*/ ctx[5]}); opacity: ${/*$selectionOpacity*/ ctx[6]}`);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div, \"keydown\", /*handleKeyDown*/ ctx[7]),\n\t\t\t\t\tlisten(div, \"keyup\", /*handleKeyUp*/ ctx[8]),\n\t\t\t\t\tlisten(div, \"nudge\", /*handleRotateNudge*/ ctx[13]),\n\t\t\t\t\taction_destroyer(nudgeable_action = nudgeable.call(null, div)),\n\t\t\t\t\tlisten(div, \"interactionstart\", /*rotate*/ ctx[14](\"start\")),\n\t\t\t\t\tlisten(div, \"interactionupdate\", /*rotate*/ ctx[14](\"move\")),\n\t\t\t\t\tlisten(div, \"interactionend\", /*rotate*/ ctx[14](\"end\")),\n\t\t\t\t\taction_destroyer(interactable_action = interactable.call(null, div))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*rotatorPoint, $selectionScale, $selectionOpacity*/ 97 && div_style_value !== (div_style_value = `transform: translate3d(${/*rotatorPoint*/ ctx[0].x}px, ${/*rotatorPoint*/ ctx[0].y}px, 0) scale(${/*$selectionScale*/ ctx[5]}, ${/*$selectionScale*/ ctx[5]}); opacity: ${/*$selectionOpacity*/ ctx[6]}`)) {\n\t\t\t\tattr(div, \"style\", div_style_value);\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction create_fragment$u(ctx) {\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet t;\n\tlet if_block_anchor;\n\tlet each_value = /*resizeControls*/ ctx[3];\n\tconst get_key = ctx => /*key*/ ctx[47];\n\n\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\tlet child_ctx = get_each_context$5(ctx, each_value, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block$5(key, child_ctx));\n\t}\n\n\tlet if_block = /*enableRotating*/ ctx[1] && /*rotationControlActive*/ ctx[4] && create_if_block$7(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\tt = space();\n\t\t\tif (if_block) if_block.c();\n\t\t\tif_block_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(target, anchor);\n\t\t\t}\n\n\t\t\tinsert(target, t, anchor);\n\t\t\tif (if_block) if_block.m(target, anchor);\n\t\t\tinsert(target, if_block_anchor, anchor);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*resizeControls, $selectionScale, $selectionOpacity, resizeAxis, handleKeyDown, handleKeyUp, handleResizeNudge, resize*/ 6636) {\n\t\t\t\tconst each_value = /*resizeControls*/ ctx[3];\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value, each_1_lookup, t.parentNode, destroy_block, create_each_block$5, t, get_each_context$5);\n\t\t\t}\n\n\t\t\tif (/*enableRotating*/ ctx[1] && /*rotationControlActive*/ ctx[4]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block$7(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\tif_block.m(if_block_anchor.parentNode, if_block_anchor);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tif_block.d(1);\n\t\t\t\tif_block = null;\n\t\t\t}\n\t\t},\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d(detaching);\n\t\t\t}\n\n\t\t\tif (detaching) detach(t);\n\t\t\tif (if_block) if_block.d(detaching);\n\t\t\tif (detaching) detach(if_block_anchor);\n\t\t}\n\t};\n}\n\nfunction instance$u($$self, $$props, $$invalidate) {\n\tlet $selectionScale;\n\tlet $selectionOpacity;\n\tconst dispatch = createEventDispatcher();\n\n\t// which cursor to render\n\tconst EIGTH_PI = QUART_PI * 0.5;\n\n\tconst N = HALF_PI;\n\tconst N0 = N - EIGTH_PI;\n\tconst N1 = N + EIGTH_PI;\n\tconst S = -HALF_PI;\n\tconst S0 = S - EIGTH_PI;\n\tconst S1 = S + EIGTH_PI;\n\tconst E = PI;\n\tconst E0 = E - EIGTH_PI;\n\tconst E1 = -PI + EIGTH_PI;\n\tconst W0 = EIGTH_PI;\n\tconst W1 = -EIGTH_PI;\n\tconst NW = N - QUART_PI;\n\tconst NW0 = NW - EIGTH_PI;\n\tconst NW1 = NW + EIGTH_PI;\n\tconst NE = PI - QUART_PI;\n\tconst NE0 = NE - EIGTH_PI;\n\tconst NE1 = NE + EIGTH_PI;\n\tconst SE = S - QUART_PI;\n\tconst SE0 = SE + EIGTH_PI;\n\tconst SE1 = SE - EIGTH_PI;\n\tconst SW = S + QUART_PI;\n\tconst SW0 = SW + EIGTH_PI;\n\tconst SW1 = SW - EIGTH_PI;\n\tlet { points = [] } = $$props;\n\tlet { rotatorPoint = undefined } = $$props;\n\tlet { visible = false } = $$props;\n\tlet { enableResizing = true } = $$props;\n\tlet { enableRotating = true } = $$props;\n\n\t// // internal\n\tlet shiftKey = false;\n\n\tconst handleKeyDown = e => shiftKey = e.shiftKey;\n\tconst handleKeyUp = e => shiftKey = false;\n\n\t// state\n\tconst selectionScale = spring(0.5, {\n\t\tprecision: 0.0001,\n\t\tstiffness: 0.3,\n\t\tdamping: 0.7\n\t});\n\n\tcomponent_subscribe($$self, selectionScale, value => $$invalidate(5, $selectionScale = value));\n\tconst selectionOpacity = spring(0, { precision: 0.001 });\n\tcomponent_subscribe($$self, selectionOpacity, value => $$invalidate(6, $selectionOpacity = value));\n\n\tconst rotate = type => ({ detail }) => {\n\t\t// always make sure we have a translation to work with\n\t\tconst translation = detail && detail.translation\n\t\t? detail.translation\n\t\t: vectorCreate(0, 0);\n\n\t\tdispatch(`rotate${type}`, { translation, shiftKey });\n\t};\n\n\tconst resize = (type, indexes) => ({ detail }) => {\n\t\t// always make sure we have a translation to work with\n\t\tconst translation = detail && detail.translation\n\t\t? detail.translation\n\t\t: vectorCreate(0, 0);\n\n\t\t// done transforming the points\n\t\tdispatch(`resize${type}`, { indexes, translation, shiftKey });\n\t};\n\n\t// https://en.wikipedia.org/wiki/Radian#/media/File:Degree-Radian_Conversion.svg\n\tconst getDirectionByAngle = angle => {\n\t\tlet dir = \"\";\n\t\tconst isNorth = angle <= N1 && angle >= N0;\n\t\tconst isSouth = angle >= S0 && angle <= S1;\n\t\tconst isEast = angle <= E1 || angle >= E0;\n\t\tconst isWest = angle >= W1 && angle <= W0;\n\t\tconst isNorthEast = angle >= NE0 && angle <= NE1;\n\t\tconst isNorthWest = angle >= NW0 && angle <= NW1;\n\t\tconst isSouthEast = angle <= SE0 && angle >= SE1;\n\t\tconst isSouthWest = angle <= SW0 && angle >= SW1;\n\t\tif (isNorth || isSouth) dir = \"ns\";\n\t\tif (isEast || isWest) dir = \"ew\";\n\t\tif (isNorthEast || isSouthWest) dir = \"nesw\";\n\t\tif (isNorthWest || isSouthEast) dir = \"nwse\";\n\t\treturn dir;\n\t};\n\n\t// 2 points -> [corner, corner]\n\t// 3 points => [corner, edge, corner, edge, corner, edge],\n\t// 4 points => [corner, edge, corner, edge, corner, edge, corner, edge]\n\tconst mapPointsToControls = (points, axis) => {\n\t\tlet i = 0;\n\t\tconst center = vectorCenter(points);\n\t\tconst out = [];\n\t\tconst l = points.length;\n\t\tconst isLine = l === 2;\n\t\tconst isAxisLimited = axis !== \"both\";\n\n\t\tfor (; i < l; i++) {\n\t\t\tconst p0 = points[i - 1] || points[points.length - 1];\n\t\t\tconst p1 = points[i];\n\t\t\tconst p2 = points[i + 1] || points[0];\n\t\t\tconst dir = Math.atan2(p2.y - p1.y, p2.x - p1.x);\n\n\t\t\t// create corner, only allowed if axis equal 'both'\n\t\t\tif (!isAxisLimited) {\n\t\t\t\tconst a = vectorNormalize(vectorCreate(p0.x - p1.x, p0.y - p1.y));\n\t\t\t\tconst b = vectorNormalize(vectorCreate(p2.x - p1.x, p2.y - p1.y));\n\t\t\t\tconst cornerVector = vectorCreate(a.x + b.x, a.y + b.y);\n\n\t\t\t\tout.push({\n\t\t\t\t\tindex: [i],\n\t\t\t\t\tkey: `point-${i}`,\n\t\t\t\t\ttype: \"point\",\n\t\t\t\t\tscale: { x: 1, y: 1 },\n\t\t\t\t\ttranslate: { x: p1.x, y: p1.y },\n\t\t\t\t\tangle: undefined,\n\t\t\t\t\trotate: isLine ? 0 : dir,\n\t\t\t\t\tcenter: p1,\n\t\t\t\t\tdir: isLine\n\t\t\t\t\t? undefined\n\t\t\t\t\t: getDirectionByAngle(Math.atan2(cornerVector.y, cornerVector.x))\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// if only two points, skip edge\n\t\t\tif (isLine) continue;\n\n\t\t\tconst mid = vectorCreate(p1.x + (p2.x - p1.x) * 0.5, p1.y + (p2.y - p1.y) * 0.5);\n\n\t\t\t// only allow horizontal controls\n\t\t\tif (axis === \"horizontal\" && i % 2 === 0) continue;\n\n\t\t\t// only allow vertical controls\n\t\t\tif (axis === \"vertical\" && i % 2 !== 0) continue;\n\n\t\t\t// create edge\n\t\t\tout.push({\n\t\t\t\tindex: [i, i + 1 === l ? 0 : i + 1],\n\t\t\t\tkey: `edge-${i}`,\n\t\t\t\ttype: \"edge\",\n\t\t\t\tscale: { x: vectorDistance(p1, p2), y: 1 },\n\t\t\t\ttranslate: { x: p1.x, y: p1.y },\n\t\t\t\tangle: dir,\n\t\t\t\trotate: dir,\n\t\t\t\tcenter: mid,\n\t\t\t\tdir: getDirectionByAngle(Math.atan2(center.y - mid.y, center.x - mid.x))\n\t\t\t});\n\t\t}\n\n\t\treturn out;\n\t};\n\n\tconst handleResizeNudge = (indexes, translation) => {\n\t\tdispatch(`resizestart`, {\n\t\t\tindexes,\n\t\t\ttranslation: vectorCreateEmpty()\n\t\t});\n\n\t\tdispatch(`resizemove`, { indexes, translation });\n\n\t\tdispatch(`resizeend`, {\n\t\t\tindexes,\n\t\t\ttranslation: vectorCreateEmpty()\n\t\t});\n\t};\n\n\tconst handleRotateNudge = ({ detail }) => {\n\t\tdispatch(`rotatestart`, { translation: vectorCreateEmpty() });\n\t\tdispatch(`rotatemove`, { translation: detail });\n\t\tdispatch(`rotateend`, { translation: vectorCreateEmpty() });\n\t};\n\n\tconst nudge_handler = (index, { detail }) => handleResizeNudge(index, detail);\n\n\t$$self.$$set = $$props => {\n\t\tif (\"points\" in $$props) $$invalidate(15, points = $$props.points);\n\t\tif (\"rotatorPoint\" in $$props) $$invalidate(0, rotatorPoint = $$props.rotatorPoint);\n\t\tif (\"visible\" in $$props) $$invalidate(16, visible = $$props.visible);\n\t\tif (\"enableResizing\" in $$props) $$invalidate(17, enableResizing = $$props.enableResizing);\n\t\tif (\"enableRotating\" in $$props) $$invalidate(1, enableRotating = $$props.enableRotating);\n\t};\n\n\tlet resizeAxis;\n\tlet resizeControls;\n\tlet rotationControlActive;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*visible*/ 65536) {\n\t\t\t selectionScale.set(visible ? 1 : 0.5);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*visible*/ 65536) {\n\t\t\t selectionOpacity.set(visible ? 1 : 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*enableResizing*/ 131072) {\n\t\t\t $$invalidate(2, resizeAxis = !enableResizing\n\t\t\t? false\n\t\t\t: isString(enableResizing) ? enableResizing : \"both\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*resizeAxis, points*/ 32772) {\n\t\t\t $$invalidate(3, resizeControls = resizeAxis && mapPointsToControls(points, resizeAxis) || []);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*points*/ 32768) {\n\t\t\t $$invalidate(4, rotationControlActive = points.length > 2);\n\t\t}\n\t};\n\n\treturn [\n\t\trotatorPoint,\n\t\tenableRotating,\n\t\tresizeAxis,\n\t\tresizeControls,\n\t\trotationControlActive,\n\t\t$selectionScale,\n\t\t$selectionOpacity,\n\t\thandleKeyDown,\n\t\thandleKeyUp,\n\t\tselectionScale,\n\t\tselectionOpacity,\n\t\tresize,\n\t\thandleResizeNudge,\n\t\thandleRotateNudge,\n\t\trotate,\n\t\tpoints,\n\t\tvisible,\n\t\tenableResizing,\n\t\tnudge_handler\n\t];\n}\n\nclass ShapeManipulator extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$u,\n\t\t\tcreate_fragment$u,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tpoints: 15,\n\t\t\t\trotatorPoint: 0,\n\t\t\t\tvisible: 16,\n\t\t\t\tenableResizing: 17,\n\t\t\t\tenableRotating: 1\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n}\n\nvar getEventPositionInEditor = (e, viewOffset) => {\n    const positionInViewport = getEventPositionInViewport(e);\n    return vectorSubtract(positionInViewport, viewOffset);\n};\n\nvar cursorMoveToEnd = (field) => (field.selectionStart = field.selectionEnd = field.value.length);\n\nlet result$b = null;\nvar supportsVisualViewport = () => {\n    if (result$b === null) {\n        result$b = isBrowser() && 'visualViewport' in window;\n    }\n    return result$b;\n};\n\nvar createSoftKeyboardObserver = (cb) => {\n    if (!supportsVisualViewport())\n        return false;\n    const heightNormal = visualViewport.height;\n    const testState = () => {\n        cb(visualViewport.height < heightNormal ? 'visible' : 'hidden');\n    };\n    visualViewport.addEventListener('resize', testState);\n    return () => visualViewport.removeEventListener('resize', testState);\n};\n\n/* src/core/ui/components/InputForm.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$v(ctx) {\n\tlet div2;\n\tlet div1;\n\tlet button0;\n\tlet t0;\n\tlet div0;\n\tlet t1;\n\tlet button1;\n\tlet measurable_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\tbutton0 = new Button({\n\t\t\tprops: {\n\t\t\t\tonclick: /*oncancel*/ ctx[1],\n\t\t\t\tlabel: /*labelCancel*/ ctx[5],\n\t\t\t\ticon: /*iconCancel*/ ctx[7],\n\t\t\t\thideLabel: !/*labelCancelShow*/ ctx[6]\n\t\t\t}\n\t\t});\n\n\tconst default_slot_template = /*#slots*/ ctx[17].default;\n\tconst default_slot = create_slot(default_slot_template, ctx, /*$$scope*/ ctx[16], null);\n\n\tbutton1 = new Button({\n\t\t\tprops: {\n\t\t\t\tonclick: /*onconfirm*/ ctx[0],\n\t\t\t\tlabel: /*labelConfirm*/ ctx[2],\n\t\t\t\ticon: /*iconConfirm*/ ctx[4],\n\t\t\t\thideLabel: !/*labelConfirmShow*/ ctx[3],\n\t\t\t\tclass: \"DokaInputFormButtonConfirm\"\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv2 = element(\"div\");\n\t\t\tdiv1 = element(\"div\");\n\t\t\tcreate_component(button0.$$.fragment);\n\t\t\tt0 = space();\n\t\t\tdiv0 = element(\"div\");\n\t\t\tif (default_slot) default_slot.c();\n\t\t\tt1 = space();\n\t\t\tcreate_component(button1.$$.fragment);\n\t\t\tattr(div0, \"class\", \"DokaInputFormFields\");\n\t\t\tattr(div1, \"class\", \"DokaInputFormInner\");\n\t\t\tattr(div2, \"class\", \"DokaInputForm\");\n\t\t\tattr(div2, \"style\", /*style*/ ctx[9]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div2, anchor);\n\t\t\tappend(div2, div1);\n\t\t\tmount_component(button0, div1, null);\n\t\t\tappend(div1, t0);\n\t\t\tappend(div1, div0);\n\n\t\t\tif (default_slot) {\n\t\t\t\tdefault_slot.m(div0, null);\n\t\t\t}\n\n\t\t\tappend(div1, t1);\n\t\t\tmount_component(button1, div1, null);\n\t\t\t/*div2_binding*/ ctx[18](div2);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div2, \"focusin\", /*handleFocusIn*/ ctx[10]),\n\t\t\t\t\tlisten(div2, \"focusout\", /*handleFocusOut*/ ctx[11]),\n\t\t\t\t\tlisten(div2, \"measure\", /*handleMeasure*/ ctx[12]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div2))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst button0_changes = {};\n\t\t\tif (dirty[0] & /*oncancel*/ 2) button0_changes.onclick = /*oncancel*/ ctx[1];\n\t\t\tif (dirty[0] & /*labelCancel*/ 32) button0_changes.label = /*labelCancel*/ ctx[5];\n\t\t\tif (dirty[0] & /*iconCancel*/ 128) button0_changes.icon = /*iconCancel*/ ctx[7];\n\t\t\tif (dirty[0] & /*labelCancelShow*/ 64) button0_changes.hideLabel = !/*labelCancelShow*/ ctx[6];\n\t\t\tbutton0.$set(button0_changes);\n\n\t\t\tif (default_slot) {\n\t\t\t\tif (default_slot.p && dirty[0] & /*$$scope*/ 65536) {\n\t\t\t\t\tupdate_slot(default_slot, default_slot_template, ctx, /*$$scope*/ ctx[16], dirty, null, null);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst button1_changes = {};\n\t\t\tif (dirty[0] & /*onconfirm*/ 1) button1_changes.onclick = /*onconfirm*/ ctx[0];\n\t\t\tif (dirty[0] & /*labelConfirm*/ 4) button1_changes.label = /*labelConfirm*/ ctx[2];\n\t\t\tif (dirty[0] & /*iconConfirm*/ 16) button1_changes.icon = /*iconConfirm*/ ctx[4];\n\t\t\tif (dirty[0] & /*labelConfirmShow*/ 8) button1_changes.hideLabel = !/*labelConfirmShow*/ ctx[3];\n\t\t\tbutton1.$set(button1_changes);\n\n\t\t\tif (!current || dirty[0] & /*style*/ 512) {\n\t\t\t\tattr(div2, \"style\", /*style*/ ctx[9]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(button0.$$.fragment, local);\n\t\t\ttransition_in(default_slot, local);\n\t\t\ttransition_in(button1.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(button0.$$.fragment, local);\n\t\t\ttransition_out(default_slot, local);\n\t\t\ttransition_out(button1.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div2);\n\t\t\tdestroy_component(button0);\n\t\t\tif (default_slot) default_slot.d(detaching);\n\t\t\tdestroy_component(button1);\n\t\t\t/*div2_binding*/ ctx[18](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nconst panelDelay = 200;\n\nfunction instance$v($$self, $$props, $$invalidate) {\n\tlet { $$slots: slots = {}, $$scope } = $$props;\n\tlet { onconfirm } = $$props;\n\tlet { oncancel } = $$props;\n\tlet { autoFocus = true } = $$props;\n\tlet { autoPositionCursor = true } = $$props;\n\tlet { labelConfirm } = $$props;\n\tlet { labelConfirmShow = true } = $$props;\n\tlet { iconConfirm } = $$props;\n\tlet { labelCancel } = $$props;\n\tlet { labelCancelShow = false } = $$props;\n\tlet { iconCancel } = $$props;\n\tlet { panelOffset = vectorCreateEmpty() } = $$props;\n\tlet panelVisible = false;\n\tlet panelHeight = undefined;\n\tlet panelRevealTimeout = undefined;\n\tlet panelPosition = \"\";\n\tlet panelOpacity = 0;\n\tlet root;\n\n\tconst preventTextAreaScrollingOnIOS = element => {\n\t\t// preventsDefault on textarea events when can no longer scroll up or down in textarea\n\t\tlet lastScreenY;\n\n\t\tconst handleTouchStart = e => lastScreenY = e.touches[0].screenY;\n\n\t\tconst handleTouchMove = e => {\n\t\t\tconst currentScreenY = e.touches[0].screenY;\n\t\t\tconst target = e.target;\n\n\t\t\tif ((/textarea/i).test(target.nodeName)) {\n\t\t\t\t// moving down\n\t\t\t\tif (currentScreenY > lastScreenY) {\n\t\t\t\t\tif (target.scrollTop == 0) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t} else // moving up\n\t\t\t\tif (currentScreenY < lastScreenY) {\n\t\t\t\t\tif (target.scrollTop + target.offsetHeight == target.scrollHeight) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t}\n\n\t\t\t\tlastScreenY = currentScreenY;\n\t\t\t} else {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\n\t\telement.addEventListener(\"touchstart\", handleTouchStart);\n\t\telement.addEventListener(\"touchmove\", handleTouchMove);\n\n\t\treturn () => {\n\t\t\telement.removeEventListener(\"touchstart\", handleTouchStart);\n\t\t\telement.removeEventListener(\"touchmove\", handleTouchMove);\n\t\t};\n\t};\n\n\tconst focus = () => {\n\t\tconst field = root.querySelector(\"input, textarea\");\n\t\tfield.focus();\n\t};\n\n\tconst show = () => {\n\t\tpanelVisible = true;\n\n\t\t// browser does not support keyboard listener, place modal at top of view\n\t\tif (!unsubSoftKeyboardListener && (isIOS() || isAndroid())) {\n\t\t\t$$invalidate(22, panelPosition = \"top:1em;bottom:auto;\");\n\t\t}\n\n\t\t// prevent interacting with the root element\n\t\tif (isIOS()) preventTextAreaScrollingOnIOS(root);\n\n\t\t// reveal\n\t\t$$invalidate(23, panelOpacity = 1);\n\t};\n\n\tconst hide = () => {\n\t\tpanelVisible = false;\n\t\t$$invalidate(23, panelOpacity = 0);\n\t};\n\n\tconst handleSoftKeyboard = keyboardState => {\n\t\tif (!shouldStickToKeyboard) return;\n\n\t\t// no need to continue, already hidden\n\t\tif (keyboardState === \"hidden\" && !panelVisible) {\n\t\t\tfocus();\n\t\t\treturn;\n\t\t}\n\n\t\t// gonna update position here\n\t\tclearTimeout(panelRevealTimeout);\n\n\t\tpanelRevealTimeout = undefined;\n\n\t\t// position\n\t\t$$invalidate(22, panelPosition = `top:${visualViewport.height - panelHeight - panelOffset.y}px`);\n\n\t\t// if a soft keyboard is detected, turn into modal mode\n\t\tif (keyboardState === \"visible\") {\n\t\t\t// stick to keyboard\n\t\t\t$$invalidate(8, root.dataset.layout = \"stick\", root);\n\n\t\t\t// need to refocus\n\t\t\tfocus();\n\n\t\t\t// place above keyboard\n\t\t\tshow();\n\t\t} else // keyboard is hidden\n\t\t{\n\t\t\thide();\n\t\t}\n\t};\n\n\tlet focusDateTime;\n\n\tconst handleFocusIn = e => {\n\t\t// we need to remember focus time so we can detect unrealistic blur event caused by soft keyboard shenanigans\n\t\tfocusDateTime = Date.now();\n\n\t\t// move cursor\n\t\tif (autoPositionCursor) cursorMoveToEnd(e.target);\n\n\t\t// wait a couple milliseconds\n\t\tpanelRevealTimeout = setTimeout(show, panelDelay);\n\t};\n\n\tconst handleFocusOut = e => {\n\t\tconst focusDuration = Date.now() - focusDateTime;\n\t\tif (focusDuration > 50) return;\n\n\t\t// unrealistic blur, refocus\n\t\te.stopPropagation();\n\n\t\tfocus();\n\t};\n\n\tconst unsubSoftKeyboardListener = createSoftKeyboardObserver(handleSoftKeyboard);\n\n\tconst handleMeasure = ({ detail }) => {\n\t\tpanelHeight = detail.height;\n\t};\n\n\tonMount(() => {\n\t\tif (!autoFocus) return;\n\t\tfocus();\n\t});\n\n\tonDestroy(() => {\n\t\tunsubSoftKeyboardListener && unsubSoftKeyboardListener();\n\t});\n\n\tfunction div2_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\troot = $$value;\n\t\t\t$$invalidate(8, root);\n\t\t});\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"onconfirm\" in $$props) $$invalidate(0, onconfirm = $$props.onconfirm);\n\t\tif (\"oncancel\" in $$props) $$invalidate(1, oncancel = $$props.oncancel);\n\t\tif (\"autoFocus\" in $$props) $$invalidate(13, autoFocus = $$props.autoFocus);\n\t\tif (\"autoPositionCursor\" in $$props) $$invalidate(14, autoPositionCursor = $$props.autoPositionCursor);\n\t\tif (\"labelConfirm\" in $$props) $$invalidate(2, labelConfirm = $$props.labelConfirm);\n\t\tif (\"labelConfirmShow\" in $$props) $$invalidate(3, labelConfirmShow = $$props.labelConfirmShow);\n\t\tif (\"iconConfirm\" in $$props) $$invalidate(4, iconConfirm = $$props.iconConfirm);\n\t\tif (\"labelCancel\" in $$props) $$invalidate(5, labelCancel = $$props.labelCancel);\n\t\tif (\"labelCancelShow\" in $$props) $$invalidate(6, labelCancelShow = $$props.labelCancelShow);\n\t\tif (\"iconCancel\" in $$props) $$invalidate(7, iconCancel = $$props.iconCancel);\n\t\tif (\"panelOffset\" in $$props) $$invalidate(15, panelOffset = $$props.panelOffset);\n\t\tif (\"$$scope\" in $$props) $$invalidate(16, $$scope = $$props.$$scope);\n\t};\n\n\tlet computedStyle;\n\tlet shouldStickToKeyboard;\n\tlet style;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*root*/ 256) {\n\t\t\t $$invalidate(25, computedStyle = root && getComputedStyle(root));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*computedStyle*/ 33554432) {\n\t\t\t shouldStickToKeyboard = computedStyle && computedStyle.getPropertyValue(\"--editor-modal\") === \"1\";\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*panelOpacity, panelPosition*/ 12582912) {\n\t\t\t $$invalidate(9, style = `opacity:${panelOpacity};${panelPosition}`);\n\t\t}\n\t};\n\n\treturn [\n\t\tonconfirm,\n\t\toncancel,\n\t\tlabelConfirm,\n\t\tlabelConfirmShow,\n\t\ticonConfirm,\n\t\tlabelCancel,\n\t\tlabelCancelShow,\n\t\ticonCancel,\n\t\troot,\n\t\tstyle,\n\t\thandleFocusIn,\n\t\thandleFocusOut,\n\t\thandleMeasure,\n\t\tautoFocus,\n\t\tautoPositionCursor,\n\t\tpanelOffset,\n\t\t$$scope,\n\t\tslots,\n\t\tdiv2_binding\n\t];\n}\n\nclass InputForm extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$v,\n\t\t\tcreate_fragment$v,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tonconfirm: 0,\n\t\t\t\toncancel: 1,\n\t\t\t\tautoFocus: 13,\n\t\t\t\tautoPositionCursor: 14,\n\t\t\t\tlabelConfirm: 2,\n\t\t\t\tlabelConfirmShow: 3,\n\t\t\t\ticonConfirm: 4,\n\t\t\t\tlabelCancel: 5,\n\t\t\t\tlabelCancelShow: 6,\n\t\t\t\ticonCancel: 7,\n\t\t\t\tpanelOffset: 15\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n}\n\n/* src/core/ui/components/ShapeLayoutEditor.svelte generated by Svelte v3.29.4 */\n\nfunction get_each_context$6(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[153] = list[i];\n\tchild_ctx[155] = i;\n\treturn child_ctx;\n}\n\n// (1887:8) {#each shapeNavList as item, index (item.id) }\nfunction create_each_block$6(key_1, ctx) {\n\tlet li;\n\tlet button;\n\tlet colorpreview;\n\tlet t0;\n\tlet span;\n\tlet t1_value = /*item*/ ctx[153].name + \"\";\n\tlet t1;\n\tlet button_aria_label_value;\n\tlet t2;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\tcolorpreview = new ColorPreview({\n\t\t\tprops: { color: /*item*/ ctx[153].color }\n\t\t});\n\n\tfunction click_handler(...args) {\n\t\treturn /*click_handler*/ ctx[94](/*index*/ ctx[155], ...args);\n\t}\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tli = element(\"li\");\n\t\t\tbutton = element(\"button\");\n\t\t\tcreate_component(colorpreview.$$.fragment);\n\t\t\tt0 = space();\n\t\t\tspan = element(\"span\");\n\t\t\tt1 = text(t1_value);\n\t\t\tt2 = space();\n\t\t\tattr(button, \"class\", \"DokaShapeListItem\");\n\t\t\tattr(button, \"type\", \"button\");\n\t\t\tattr(button, \"aria-label\", button_aria_label_value = \"Select shape \" + /*item*/ ctx[153].name);\n\t\t\tthis.first = li;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, li, anchor);\n\t\t\tappend(li, button);\n\t\t\tmount_component(colorpreview, button, null);\n\t\t\tappend(button, t0);\n\t\t\tappend(button, span);\n\t\t\tappend(span, t1);\n\t\t\tappend(li, t2);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = listen(button, \"click\", click_handler);\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\t\t\tconst colorpreview_changes = {};\n\t\t\tif (dirty[0] & /*shapeNavList*/ 524288) colorpreview_changes.color = /*item*/ ctx[153].color;\n\t\t\tcolorpreview.$set(colorpreview_changes);\n\t\t\tif ((!current || dirty[0] & /*shapeNavList*/ 524288) && t1_value !== (t1_value = /*item*/ ctx[153].name + \"\")) set_data(t1, t1_value);\n\n\t\t\tif (!current || dirty[0] & /*shapeNavList*/ 524288 && button_aria_label_value !== (button_aria_label_value = \"Select shape \" + /*item*/ ctx[153].name)) {\n\t\t\t\tattr(button, \"aria-label\", button_aria_label_value);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(colorpreview.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(colorpreview.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(li);\n\t\t\tdestroy_component(colorpreview);\n\t\t\tmounted = false;\n\t\t\tdispose();\n\t\t}\n\t};\n}\n\n// (1898:4) {#if shouldRenderShapeManipulator}\nfunction create_if_block_2$6(ctx) {\n\tlet shapemanipulator;\n\tlet current;\n\n\tshapemanipulator = new ShapeManipulator({\n\t\t\tprops: {\n\t\t\t\tvisible: true,\n\t\t\t\tpoints: /*shapeManipulatorPoints*/ ctx[11],\n\t\t\t\trotatorPoint: /*shapeManipulatorRotationPointPosition*/ ctx[12],\n\t\t\t\tenableResizing: /*allowedResizeControls*/ ctx[9],\n\t\t\t\tenableRotating: /*allowRotateControls*/ ctx[8]\n\t\t\t}\n\t\t});\n\n\tshapemanipulator.$on(\"resizestart\", /*handleManipulatorResizeGrab*/ ctx[26]);\n\tshapemanipulator.$on(\"resizemove\", /*handleManipulatorResizeDrag*/ ctx[27]);\n\tshapemanipulator.$on(\"resizeend\", /*handleManipulatorResizeEnd*/ ctx[28]);\n\tshapemanipulator.$on(\"rotatestart\", /*handleManipulatorRotateGrab*/ ctx[29]);\n\tshapemanipulator.$on(\"rotatemove\", /*handleManipulatorRotateDrag*/ ctx[30]);\n\tshapemanipulator.$on(\"rotateend\", /*handleManipulatorRotateEnd*/ ctx[31]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapemanipulator.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapemanipulator, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapemanipulator_changes = {};\n\t\t\tif (dirty[0] & /*shapeManipulatorPoints*/ 2048) shapemanipulator_changes.points = /*shapeManipulatorPoints*/ ctx[11];\n\t\t\tif (dirty[0] & /*shapeManipulatorRotationPointPosition*/ 4096) shapemanipulator_changes.rotatorPoint = /*shapeManipulatorRotationPointPosition*/ ctx[12];\n\t\t\tif (dirty[0] & /*allowedResizeControls*/ 512) shapemanipulator_changes.enableResizing = /*allowedResizeControls*/ ctx[9];\n\t\t\tif (dirty[0] & /*allowRotateControls*/ 256) shapemanipulator_changes.enableRotating = /*allowRotateControls*/ ctx[8];\n\t\t\tshapemanipulator.$set(shapemanipulator_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapemanipulator.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapemanipulator.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapemanipulator, detaching);\n\t\t}\n\t};\n}\n\n// (1913:4) {#if shouldRenderTextInput}\nfunction create_if_block_1$9(ctx) {\n\tlet inputform;\n\tlet current;\n\n\tinputform = new InputForm({\n\t\t\tprops: {\n\t\t\t\tpanelOffset: /*offset*/ ctx[1],\n\t\t\t\tonconfirm: /*handleTextConfirm*/ ctx[37],\n\t\t\t\toncancel: /*handleTextCancel*/ ctx[38],\n\t\t\t\tlabelCancel: /*locale*/ ctx[3].shapeLabelInputCancel,\n\t\t\t\ticonCancel: /*locale*/ ctx[3].shapeIconInputCancel,\n\t\t\t\tlabelConfirm: /*locale*/ ctx[3].shapeLabelInputConfirm,\n\t\t\t\ticonConfirm: /*locale*/ ctx[3].shapeIconInputConfirm,\n\t\t\t\t$$slots: { default: [create_default_slot$7] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(inputform.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(inputform, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst inputform_changes = {};\n\t\t\tif (dirty[0] & /*offset*/ 2) inputform_changes.panelOffset = /*offset*/ ctx[1];\n\t\t\tif (dirty[0] & /*locale*/ 8) inputform_changes.labelCancel = /*locale*/ ctx[3].shapeLabelInputCancel;\n\t\t\tif (dirty[0] & /*locale*/ 8) inputform_changes.iconCancel = /*locale*/ ctx[3].shapeIconInputCancel;\n\t\t\tif (dirty[0] & /*locale*/ 8) inputform_changes.labelConfirm = /*locale*/ ctx[3].shapeLabelInputConfirm;\n\t\t\tif (dirty[0] & /*locale*/ 8) inputform_changes.iconConfirm = /*locale*/ ctx[3].shapeIconInputConfirm;\n\n\t\t\tif (dirty[0] & /*markupTextInputStyle, textInputText, textInput*/ 49184 | dirty[5] & /*$$scope*/ 2) {\n\t\t\t\tinputform_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tinputform.$set(inputform_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(inputform.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(inputform.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(inputform, detaching);\n\t\t}\n\t};\n}\n\n// (1914:4) <InputForm          panelOffset={offset}         onconfirm={handleTextConfirm}          oncancel={handleTextCancel}         labelCancel={locale.shapeLabelInputCancel}         iconCancel={locale.shapeIconInputCancel}         labelConfirm={locale.shapeLabelInputConfirm}         iconConfirm={locale.shapeIconInputConfirm}>\nfunction create_default_slot$7(ctx) {\n\tlet textarea;\n\tlet mounted;\n\tlet dispose;\n\n\treturn {\n\t\tc() {\n\t\t\ttextarea = element(\"textarea\");\n\t\t\tattr(textarea, \"style\", /*markupTextInputStyle*/ ctx[15]);\n\t\t\tattr(textarea, \"spellcheck\", \"false\");\n\t\t\tattr(textarea, \"autocorrect\", \"off\");\n\t\t\tattr(textarea, \"autocapitalize\", \"off\");\n\t\t\ttextarea.value = /*textInputText*/ ctx[14];\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, textarea, anchor);\n\t\t\t/*textarea_binding*/ ctx[95](textarea);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(textarea, \"keydown\", /*handleTextInputKeyDown*/ ctx[35]),\n\t\t\t\t\tlisten(textarea, \"keypress\", /*handleTextInputAttempt*/ ctx[34]),\n\t\t\t\t\tlisten(textarea, \"keyup\", /*handleTextInputKeyUp*/ ctx[36]),\n\t\t\t\t\tlisten(textarea, \"input\", /*handleTextInput*/ ctx[33])\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*markupTextInputStyle*/ 32768) {\n\t\t\t\tattr(textarea, \"style\", /*markupTextInputStyle*/ ctx[15]);\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*textInputText*/ 16384) {\n\t\t\t\ttextarea.value = /*textInputText*/ ctx[14];\n\t\t\t}\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(textarea);\n\t\t\t/*textarea_binding*/ ctx[95](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\n// (1932:4) {#if $markupControlsOpacity > 0}\nfunction create_if_block$8(ctx) {\n\tlet div;\n\tlet dynamiccomponenttree;\n\tlet measurable_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\tdynamiccomponenttree = new DynamicComponentTree_1({\n\t\t\tprops: { items: /*shapeControls*/ ctx[18] }\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(dynamiccomponenttree.$$.fragment);\n\t\t\tattr(div, \"class\", \"DokaShapeControls\");\n\t\t\tattr(div, \"style\", /*markupControlsStyle*/ ctx[16]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(dynamiccomponenttree, div, null);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(div, \"measure\", /*measure_handler_1*/ ctx[96]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst dynamiccomponenttree_changes = {};\n\t\t\tif (dirty[0] & /*shapeControls*/ 262144) dynamiccomponenttree_changes.items = /*shapeControls*/ ctx[18];\n\t\t\tdynamiccomponenttree.$set(dynamiccomponenttree_changes);\n\n\t\t\tif (!current || dirty[0] & /*markupControlsStyle*/ 65536) {\n\t\t\t\tattr(div, \"style\", /*markupControlsStyle*/ ctx[16]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(dynamiccomponenttree.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(dynamiccomponenttree.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(dynamiccomponenttree);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction create_fragment$w(ctx) {\n\tlet div;\n\tlet nav;\n\tlet ul;\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet t0;\n\tlet t1;\n\tlet t2;\n\tlet measurable_action;\n\tlet nudgeable_action;\n\tlet interactable_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tlet each_value = /*shapeNavList*/ ctx[19];\n\tconst get_key = ctx => /*item*/ ctx[153].id;\n\n\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\tlet child_ctx = get_each_context$6(ctx, each_value, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block$6(key, child_ctx));\n\t}\n\n\tlet if_block0 = /*shouldRenderShapeManipulator*/ ctx[10] && create_if_block_2$6(ctx);\n\tlet if_block1 = /*shouldRenderTextInput*/ ctx[13] && create_if_block_1$9(ctx);\n\tlet if_block2 = /*$markupControlsOpacity*/ ctx[17] > 0 && create_if_block$8(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tnav = element(\"nav\");\n\t\t\tul = element(\"ul\");\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\tt0 = space();\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt1 = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tt2 = space();\n\t\t\tif (if_block2) if_block2.c();\n\t\t\tattr(nav, \"class\", \"DokaShapeList\");\n\t\t\tattr(nav, \"data-visible\", /*showShapeList*/ ctx[7]);\n\t\t\tattr(div, \"class\", \"DokaShapeEditor\");\n\t\t\tattr(div, \"tabindex\", \"0\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tappend(div, nav);\n\t\t\tappend(nav, ul);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(ul, null);\n\t\t\t}\n\n\t\t\tappend(div, t0);\n\t\t\tif (if_block0) if_block0.m(div, null);\n\t\t\tappend(div, t1);\n\t\t\tif (if_block1) if_block1.m(div, null);\n\t\t\tappend(div, t2);\n\t\t\tif (if_block2) if_block2.m(div, null);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(nav, \"focusin\", /*handleFocusIn*/ ctx[41]),\n\t\t\t\t\tlisten(nav, \"focusout\", /*handleFocusOut*/ ctx[42]),\n\t\t\t\t\tlisten(div, \"keydown\", /*handleKey*/ ctx[32]),\n\t\t\t\t\tlisten(div, \"nudge\", /*handleNudge*/ ctx[40]),\n\t\t\t\t\tlisten(div, \"measure\", /*measure_handler*/ ctx[93]),\n\t\t\t\t\taction_destroyer(measurable_action = measurable.call(null, div)),\n\t\t\t\t\taction_destroyer(nudgeable_action = nudgeable.call(null, div)),\n\t\t\t\t\tlisten(div, \"wheel\", /*handleWheel*/ ctx[21]),\n\t\t\t\t\tlisten(div, \"interactionstart\", /*handleInteractionStart*/ ctx[22]),\n\t\t\t\t\tlisten(div, \"interactionupdate\", /*handleInteractionUpdate*/ ctx[23]),\n\t\t\t\t\tlisten(div, \"interactionrelease\", /*handleInteractionRelease*/ ctx[24]),\n\t\t\t\t\tlisten(div, \"interactionend\", /*handleInteractionEnd*/ ctx[25]),\n\t\t\t\t\taction_destroyer(interactable_action = interactable.call(null, div, {\n\t\t\t\t\t\tdrag: true,\n\t\t\t\t\t\tpinch: true,\n\t\t\t\t\t\tinertia: true,\n\t\t\t\t\t\tmatchTarget: true,\n\t\t\t\t\t\tgetEventPosition: /*interactable_function*/ ctx[97]\n\t\t\t\t\t}))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*shapeNavList, selectShape, markup*/ 524305) {\n\t\t\t\tconst each_value = /*shapeNavList*/ ctx[19];\n\t\t\t\tgroup_outros();\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value, each_1_lookup, ul, outro_and_destroy_block, create_each_block$6, null, get_each_context$6);\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*showShapeList*/ 128) {\n\t\t\t\tattr(nav, \"data-visible\", /*showShapeList*/ ctx[7]);\n\t\t\t}\n\n\t\t\tif (/*shouldRenderShapeManipulator*/ ctx[10]) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*shouldRenderShapeManipulator*/ 1024) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_2$6(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(div, t1);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (/*shouldRenderTextInput*/ ctx[13]) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*shouldRenderTextInput*/ 8192) {\n\t\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block_1$9(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\ttransition_in(if_block1, 1);\n\t\t\t\t\tif_block1.m(div, t2);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block1, 1, 1, () => {\n\t\t\t\t\tif_block1 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (/*$markupControlsOpacity*/ ctx[17] > 0) {\n\t\t\t\tif (if_block2) {\n\t\t\t\t\tif_block2.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*$markupControlsOpacity*/ 131072) {\n\t\t\t\t\t\ttransition_in(if_block2, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block2 = create_if_block$8(ctx);\n\t\t\t\t\tif_block2.c();\n\t\t\t\t\ttransition_in(if_block2, 1);\n\t\t\t\t\tif_block2.m(div, null);\n\t\t\t\t}\n\t\t\t} else if (if_block2) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block2, 1, 1, () => {\n\t\t\t\t\tif_block2 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (interactable_action && is_function(interactable_action.update) && dirty[0] & /*rootRect*/ 4) interactable_action.update.call(null, {\n\t\t\t\tdrag: true,\n\t\t\t\tpinch: true,\n\t\t\t\tinertia: true,\n\t\t\t\tmatchTarget: true,\n\t\t\t\tgetEventPosition: /*interactable_function*/ ctx[97]\n\t\t\t});\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\n\t\t\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\t\t\ttransition_in(each_blocks[i]);\n\t\t\t}\n\n\t\t\ttransition_in(if_block0);\n\t\t\ttransition_in(if_block1);\n\t\t\ttransition_in(if_block2);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\ttransition_out(each_blocks[i]);\n\t\t\t}\n\n\t\t\ttransition_out(if_block0);\n\t\t\ttransition_out(if_block1);\n\t\t\ttransition_out(if_block2);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d();\n\t\t\t}\n\n\t\t\tif (if_block0) if_block0.d();\n\t\t\tif (if_block1) if_block1.d();\n\t\t\tif (if_block2) if_block2.d();\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nconst ROTATION_CONTROL_OFFSET = 20;\nconst MIN_TEXT_MARKUP_WIDTH = 10;\nconst shapeControlDist = 16;\n\nfunction instance$w($$self, $$props, $$invalidate) {\n\tlet $keysPressedStored;\n\tlet $markupControlsOpacity;\n\tlet { markup } = $$props;\n\tlet { offset } = $$props;\n\tlet { rotation = 0 } = $$props;\n\tlet { scale } = $$props;\n\tlet { ui } = $$props;\n\tlet { opacity = 1 } = $$props;\n\tlet { parentRect } = $$props;\n\tlet { rootRect } = $$props;\n\tlet { stageRect } = $$props;\n\tlet { utilRect } = $$props;\n\tlet { oninteractionstart = noop } = $$props;\n\tlet { oninteractionupdate = noop } = $$props;\n\tlet { oninteractionrelease = noop } = $$props;\n\tlet { oninteractionend = noop } = $$props;\n\tlet { onaddshape = noop } = $$props;\n\tlet { onupdateshape = noop } = $$props;\n\tlet { onselectshape = noop } = $$props;\n\tlet { onremoveshape = noop } = $$props;\n\tlet { beforeSelectShape = () => true } = $$props;\n\tlet { beforeDeselectShape = () => true } = $$props;\n\tlet { beforeAddShape = () => true } = $$props; // unused for now\n\tlet { beforeRemoveShape = () => true } = $$props;\n\tlet { beforeUpdateShape = (shape, props) => props } = $$props;\n\tlet { willRenderShapeControls = passthrough } = $$props;\n\tlet { mapEditorPointToImagePoint } = $$props;\n\tlet { mapImagePointToEditorPoint } = $$props;\n\tlet { enableButtonFlipVertical = false } = $$props;\n\tlet { locale } = $$props;\n\n\t//\n\t// Cache\n\t//\n\tconst updateShape = (shape, props, parentRect) => {\n\t\tlet propsToUpdate = beforeUpdateShape({ ...shape }, props, { ...parentRect });\n\t\tshapeUpdateProps(shape, propsToUpdate, parentRect);\n\t};\n\n\t//\n\t// Helpers\n\t//\n\tconst isPositionInRect = (position, rect, rotation, pivot) => {\n\t\tif (rotation) return !!polyPointIntersectionConvex(position, rectRotate(rect, rotation, pivot || rectCenter(rect)));\n\t\tconst [t, r, b, l] = rectToBounds(rect);\n\t\treturn position.x >= l && position.x <= r && (position.y >= t && position.y <= b);\n\t};\n\n\tconst isPositionInEllipse = (position, ellipse, rotation) => {\n\t\tconst rx = ellipse.rx;\n\t\tconst ry = ellipse.ry;\n\t\tconst x = ellipse.x;\n\t\tconst y = ellipse.y;\n\t\tconst angle = rotation || 0;\n\t\tconst c = Math.cos(angle);\n\t\tconst s = Math.sin(angle);\n\t\tconst rx2 = rx * rx;\n\t\tconst ry2 = ry * ry;\n\t\tconst a = c * (position.x - x) + s * (position.y - y);\n\t\tconst b = s * (position.x - x) - c * (position.y - y);\n\t\tconst aa = a * a;\n\t\tconst bb = b * b;\n\t\treturn aa / rx2 + bb / ry2 <= 1;\n\t};\n\n\tconst isPositionNearLine = (position, begin, end, treshold) => {\n\t\tconst ba = Math.atan2(position.y - begin.y, position.x - begin.x);\n\t\tconst ea = Math.atan2(position.y - end.y, position.x - end.x);\n\t\tif (ba > 0 && ea > 0 || ba < 0 && ea < 0) return false;\n\t\tconst r = treshold * treshold;\n\t\tconst d = vectorCreate(end.x - begin.x, end.y - begin.y);\n\t\tconst f = vectorCreate(begin.x - position.x, begin.y - position.y);\n\t\tconst a = vectorDot(d, d);\n\t\tconst b = 2 * vectorDot(f, d);\n\t\tconst c = vectorDot(f, f) - r;\n\t\tconst discriminant = b * b - 4 * a * c;\n\t\treturn discriminant >= 0;\n\t};\n\n\t//\n\t// Shape creator\n\t//\n\tconst keysPressedStored = getContext(\"keysPressed\");\n\n\tcomponent_subscribe($$self, keysPressedStored, value => $$invalidate(105, $keysPressedStored = value));\n\n\tconst createShape = (shapeDefault, options = {}) => {\n\t\t// state\n\t\tlet interactionOrigin;\n\n\t\tlet interactionRadius;\n\t\tlet interactionPosition;\n\t\tlet isEllipse = shapeIsEllipse(shapeDefault);\n\t\tlet isText = shapeIsText(shapeDefault);\n\t\tlet isRelative = options.position === \"relative\";\n\n\t\tif (shapeIsPath(shapeDefault)) {\n\t\t\treturn {\n\t\t\t\tstart: e => {\n\t\t\t\t\tconst { origin } = e.detail;\n\t\t\t\t\tinteractionRadius = 4;\n\t\t\t\t\tinteractionOrigin = vectorClone(origin);\n\t\t\t\t\tinteractionPosition = vectorClone(origin);\n\t\t\t\t\tconst originPoint = mapEditorPointToImagePoint(origin);\n\n\t\t\t\t\tif (isRelative) {\n\t\t\t\t\t\toriginPoint.x = isRelative\n\t\t\t\t\t\t? toPercentage(originPoint.x, parentRect.width)\n\t\t\t\t\t\t: originPoint.x;\n\n\t\t\t\t\t\toriginPoint.y = isRelative\n\t\t\t\t\t\t? toPercentage(originPoint.y, parentRect.height)\n\t\t\t\t\t\t: originPoint.y;\n\t\t\t\t\t}\n\n\t\t\t\t\t// add to markup so it's drawn\n\t\t\t\t\taddMarkupItemDraft({ ...shapeDefault, points: [originPoint] });\n\t\t\t\t},\n\t\t\t\tupdate: e => {\n\t\t\t\t\tconst draft = getMarkupItemDraft();\n\t\t\t\t\tconst { translation } = e.detail;\n\n\t\t\t\t\t// position\n\t\t\t\t\tconst pointerPosition = vectorCreate(interactionOrigin.x + translation.x, interactionOrigin.y + translation.y);\n\n\t\t\t\t\t// distance between interaction and pointer if it's too close, we don't draw this point\n\t\t\t\t\tconst dist = vectorDistance(interactionPosition, pointerPosition);\n\n\t\t\t\t\tif (fixPrecision(dist, 5) <= interactionRadius) return;\n\n\t\t\t\t\t// get angle between interaction and pointer\n\t\t\t\t\tconst angle = vectorAngleBetween(pointerPosition, interactionPosition);\n\n\t\t\t\t\t// move brush towards pointer at angle\n\t\t\t\t\tconst moveDist = interactionRadius - dist;\n\n\t\t\t\t\tinteractionPosition.x += moveDist * Math.cos(angle);\n\t\t\t\t\tinteractionPosition.y += moveDist * Math.sin(angle);\n\n\t\t\t\t\t// create point\n\t\t\t\t\tconst point = mapEditorPointToImagePoint(interactionPosition);\n\n\t\t\t\t\tif (point) {\n\t\t\t\t\t\tpoint.x = isRelative\n\t\t\t\t\t\t? toPercentage(point.x, parentRect.width)\n\t\t\t\t\t\t: point.x;\n\n\t\t\t\t\t\tpoint.y = isRelative\n\t\t\t\t\t\t? toPercentage(point.y, parentRect.height)\n\t\t\t\t\t\t: point.y;\n\t\t\t\t\t}\n\n\t\t\t\t\tdraft.points = draft.points.concat(point);\n\t\t\t\t\tsyncShapes();\n\t\t\t\t},\n\t\t\t\trelease: e => e.detail.preventInertia(),\n\t\t\t\tend: e => {\n\t\t\t\t\tconst draft = getMarkupItemDraft();\n\t\t\t\t\tif (e.detail.isTap) return discardMarkupItemDraft();\n\t\t\t\t\tconst shape = confirmMarkupItemDraft();\n\t\t\t\t\tonaddshape(shape);\n\t\t\t\t}\n\t\t\t};\n\t\t} else if (isEllipse || isText || shapeIsRect(shapeDefault)) {\n\t\t\treturn {\n\t\t\t\tstart: e => {\n\t\t\t\t\tconst { origin } = e.detail;\n\n\t\t\t\t\t// need to remember origin so we can correctly apply interaction translation\n\t\t\t\t\tinteractionOrigin = vectorClone(origin);\n\n\t\t\t\t\tconst mappedOriginPosition = mapEditorPointToImagePoint(interactionOrigin);\n\n\t\t\t\t\t// add to markup so it's drawn\n\t\t\t\t\tconst draft = {\n\t\t\t\t\t\t...shapeDefault,\n\t\t\t\t\t\trotation: -rotation,\n\t\t\t\t\t\tx: isRelative\n\t\t\t\t\t\t? toPercentage(mappedOriginPosition.x, parentRect.width)\n\t\t\t\t\t\t: mappedOriginPosition.x,\n\t\t\t\t\t\ty: isRelative\n\t\t\t\t\t\t? toPercentage(mappedOriginPosition.y, parentRect.height)\n\t\t\t\t\t\t: mappedOriginPosition.y\n\t\t\t\t\t};\n\n\t\t\t\t\t// remove position\n\t\t\t\t\tdelete draft.position;\n\n\t\t\t\t\t// hide initially\n\t\t\t\t\tdraft.opacity = 0;\n\n\t\t\t\t\t// \n\t\t\t\t\tif (isEllipse) {\n\t\t\t\t\t\tdraft.rx = isRelative ? toPercentage(0) : 0;\n\t\t\t\t\t\tdraft.ry = isRelative ? toPercentage(0) : 0;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdraft.width = isRelative ? toPercentage(0) : 0;\n\t\t\t\t\t\tdraft.height = isRelative ? toPercentage(0) : 0;\n\t\t\t\t\t}\n\n\t\t\t\t\taddMarkupItemDraft(draft);\n\t\t\t\t},\n\t\t\t\tupdate: e => {\n\t\t\t\t\tconst draft = getMarkupItemDraft();\n\t\t\t\t\tdraft.opacity = 1;\n\t\t\t\t\tconst { aspectRatio } = draft;\n\t\t\t\t\tlet { translation } = e.detail;\n\n\t\t\t\t\t// limit to aspect ratio\n\t\t\t\t\tif (aspectRatio) {\n\t\t\t\t\t\tconst t = Math.abs(translation.x) * aspectRatio;\n\t\t\t\t\t\ttranslation.x = translation.x;\n\t\t\t\t\t\ttranslation.y = t * Math.sign(translation.y);\n\t\t\t\t\t}\n\n\t\t\t\t\t// position\n\t\t\t\t\tconst pointerPosition = vectorCreate(interactionOrigin.x + translation.x, interactionOrigin.y + translation.y);\n\n\t\t\t\t\tconst mappedOriginPosition = mapEditorPointToImagePoint(interactionOrigin);\n\t\t\t\t\tconst mappedPointerPosition = mapEditorPointToImagePoint(pointerPosition);\n\n\t\t\t\t\tconst pivot = {\n\t\t\t\t\t\tx: mappedOriginPosition.x + (mappedPointerPosition.x - mappedOriginPosition.x) * 0.5,\n\t\t\t\t\t\ty: mappedOriginPosition.y + (mappedPointerPosition.y - mappedOriginPosition.y) * 0.5\n\t\t\t\t\t};\n\n\t\t\t\t\tvectorRotate(mappedOriginPosition, rotation, pivot);\n\t\t\t\t\tvectorRotate(mappedPointerPosition, rotation, pivot);\n\t\t\t\t\tconst l = Math.min(mappedOriginPosition.x, mappedPointerPosition.x);\n\t\t\t\t\tconst t = Math.min(mappedOriginPosition.y, mappedPointerPosition.y);\n\t\t\t\t\tconst r = Math.max(mappedOriginPosition.x, mappedPointerPosition.x);\n\t\t\t\t\tconst b = Math.max(mappedOriginPosition.y, mappedPointerPosition.y);\n\t\t\t\t\tlet width = r - l;\n\t\t\t\t\tlet height = b - t;\n\t\t\t\t\tlet props = {};\n\n\t\t\t\t\tif (isEllipse) {\n\t\t\t\t\t\tprops.x = l + width * 0.5;\n\t\t\t\t\t\tprops.y = t + height * 0.5;\n\t\t\t\t\t\tprops.rx = width * 0.5;\n\t\t\t\t\t\tprops.ry = height * 0.5;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tprops.x = l;\n\t\t\t\t\t\tprops.y = t;\n\t\t\t\t\t\tprops.width = width;\n\t\t\t\t\t\tprops.height = height;\n\t\t\t\t\t}\n\n\t\t\t\t\tupdateShape(draft, props, parentRect);\n\n\t\t\t\t\t// shapeUpdateProps(draft, props, parentRect);\n\t\t\t\t\tsyncShapes();\n\t\t\t\t},\n\t\t\t\trelease: e => {\n\t\t\t\t\te.detail.preventInertia();\n\t\t\t\t},\n\t\t\t\tend: e => {\n\t\t\t\t\tconst draft = getMarkupItemDraft();\n\t\t\t\t\tif (e.detail.isTap) return discardMarkupItemDraft();\n\t\t\t\t\tdraft.opacity = 1;\n\n\t\t\t\t\t// finish markup\n\t\t\t\t\tif (!shapeIsText(draft)) {\n\t\t\t\t\t\tconst shape = confirmMarkupItemDraft();\n\t\t\t\t\t\tonaddshape(shape);\n\t\t\t\t\t}\n\n\t\t\t\t\t// select the draft\n\t\t\t\t\tselectShape(draft);\n\n\t\t\t\t\t// also enable editing the text\n\t\t\t\t\tif (shapeIsText(draft)) editMarkupItem(draft);\n\t\t\t\t}\n\t\t\t};\n\t\t} else if (shapeIsLine(shapeDefault)) {\n\t\t\treturn {\n\t\t\t\tstart: e => {\n\t\t\t\t\tconst { origin } = e.detail;\n\t\t\t\t\tconst originMapped = mapEditorPointToImagePoint(origin);\n\t\t\t\t\tconst originSnapped = vectorApply(originMapped, snapToPixel);\n\t\t\t\t\tinteractionOrigin = vectorClone(origin);\n\n\t\t\t\t\t// add to markup so it's drawn\n\t\t\t\t\taddMarkupItemDraft({\n\t\t\t\t\t\t...shapeDefault,\n\t\t\t\t\t\tx1: isRelative\n\t\t\t\t\t\t? toPercentage(originSnapped.x, parentRect.width)\n\t\t\t\t\t\t: originSnapped.x,\n\t\t\t\t\t\ty1: isRelative\n\t\t\t\t\t\t? toPercentage(originSnapped.y, parentRect.height)\n\t\t\t\t\t\t: originSnapped.y,\n\t\t\t\t\t\tx2: isRelative\n\t\t\t\t\t\t? toPercentage(originSnapped.x, parentRect.width)\n\t\t\t\t\t\t: originSnapped.x,\n\t\t\t\t\t\ty2: isRelative\n\t\t\t\t\t\t? toPercentage(originSnapped.y, parentRect.height)\n\t\t\t\t\t\t: originSnapped.y,\n\t\t\t\t\t\topacity: 0\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tupdate: e => {\n\t\t\t\t\tconst draft = getMarkupItemDraft();\n\t\t\t\t\tconst { translation } = e.detail;\n\t\t\t\t\tconst interactionTarget = vectorAdd(vectorClone(interactionOrigin), translation);\n\n\t\t\t\t\t// shift pressed\n\t\t\t\t\tif ($keysPressedStored.includes(16)) {\n\t\t\t\t\t\tconst length = vectorDistance(interactionOrigin, interactionTarget);\n\t\t\t\t\t\tconst angle = vectorAngleBetween(interactionOrigin, interactionTarget);\n\t\t\t\t\t\tconst angleSnapInterval = Math.PI / 4;\n\t\t\t\t\t\tconst angleSnapped = angleSnapInterval * Math.round(angle / angleSnapInterval);\n\t\t\t\t\t\tinteractionTarget.x = interactionOrigin.x + length * Math.cos(angleSnapped);\n\t\t\t\t\t\tinteractionTarget.y = interactionOrigin.y + length * Math.sin(angleSnapped);\n\t\t\t\t\t}\n\n\t\t\t\t\t// update line end position\n\t\t\t\t\tconst point = mapEditorPointToImagePoint(interactionTarget);\n\n\t\t\t\t\tupdateMarkupShape(draft, {\n\t\t\t\t\t\tx2: isRelative\n\t\t\t\t\t\t? toPercentage(point.x, parentRect.width)\n\t\t\t\t\t\t: point.x,\n\t\t\t\t\t\ty2: isRelative\n\t\t\t\t\t\t? toPercentage(point.y, parentRect.height)\n\t\t\t\t\t\t: point.y,\n\t\t\t\t\t\topacity: 1\n\t\t\t\t\t});\n\n\t\t\t\t\tsyncShapes();\n\t\t\t\t},\n\t\t\t\trelease: e => e.detail.preventInertia(),\n\t\t\t\tend: e => {\n\t\t\t\t\tconst draft = getMarkupItemDraft();\n\t\t\t\t\tif (e.detail.isTap) return discardMarkupItemDraft();\n\n\t\t\t\t\t// get draft\n\t\t\t\t\tdraft.opacity = 1;\n\n\t\t\t\t\t// finish markup\n\t\t\t\t\tconfirmMarkupItemDraft();\n\n\t\t\t\t\t// select the draft\n\t\t\t\t\tselectShape(draft);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t};\n\n\tconst eraseShape = () => {\n\t\tlet origin;\n\t\tlet positionPrevious;\n\n\t\treturn {\n\t\t\tstart: e => {\n\t\t\t\torigin = e.detail.origin;\n\t\t\t\tpositionPrevious = origin;\n\t\t\t},\n\t\t\tupdate: e => {\n\t\t\t\tconst { translation } = e.detail;\n\t\t\t\tconst positionCurrent = vectorCreate(origin.x + translation.x, origin.y + translation.y);\n\t\t\t\tconst shapesFound = getMarkupBetweenPoints(mapEditorPointToImagePoint(positionPrevious), mapEditorPointToImagePoint(positionCurrent));\n\t\t\t\tconst shapesRemoved = removeMarkupItems(shapesFound);\n\t\t\t\tshapesRemoved.forEach(onremoveshape);\n\t\t\t\tpositionPrevious = vectorClone(positionCurrent);\n\t\t\t},\n\t\t\trelease: e => e.detail.preventInertia(),\n\t\t\tend: () => {\n\t\t\t\t\n\t\t\t}\n\t\t};\n\t};\n\n\t//\n\t// Mapping coordinates\n\t//\n\tconst getImagePointWithScreenTranslation = (point, translation) => {\n\t\tconst pointInScreenSpace = mapImagePointToEditorPoint(point);\n\t\treturn mapEditorPointToImagePoint(vectorAdd(pointInScreenSpace, translation));\n\t};\n\n\t//\n\t// Interaction\n\t//\n\t// image zoom\n\tconst handleWheel = e => {\n\t\t\n\t}; // TODO: ZOOM image\n\n\t// markup manipulate\n\tconst translateShape = (shapeCurrent, shapeOriginComputed, translation) => {\n\t\tif (shapeIsLine(shapeCurrent)) {\n\t\t\tconst beginImageOffset = getImagePointWithScreenTranslation(shapeLineGetStartPoint(shapeOriginComputed), translation);\n\t\t\tconst endImageOffset = getImagePointWithScreenTranslation(shapeLineGetEndPoint(shapeOriginComputed), translation);\n\n\t\t\tupdateShape(\n\t\t\t\tshapeCurrent,\n\t\t\t\t{\n\t\t\t\t\tx1: beginImageOffset.x,\n\t\t\t\t\ty1: beginImageOffset.y,\n\t\t\t\t\tx2: endImageOffset.x,\n\t\t\t\t\ty2: endImageOffset.y\n\t\t\t\t},\n\t\t\t\tparentRect\n\t\t\t);\n\t\t} else if (shapeIsRect(shapeCurrent) || shapeIsText(shapeCurrent) || shapeIsEllipse(shapeCurrent)) {\n\t\t\tconst imagePoint = getImagePointWithScreenTranslation(shapeOriginComputed, translation);\n\t\t\tupdateShape(shapeCurrent, imagePoint, parentRect);\n\t\t}\n\n\t\tsyncShapes();\n\t};\n\n\tconst resizeMarkup = (shapeCurrent, shapeOriginComputed, indexes, translation, options) => {\n\t\tif (shapeIsLine(shapeCurrent)) {\n\t\t\tconst [targetIndex] = indexes;\n\n\t\t\tconst snap = $keysPressedStored.includes(16)\n\t\t\t? (origin, target) => {\n\t\t\t\t\tconst length = vectorDistance(origin, target);\n\t\t\t\t\tconst angle = vectorAngleBetween(origin, target);\n\t\t\t\t\tconst angleSnapInterval = Math.PI / 4;\n\t\t\t\t\tconst angleSnapped = angleSnapInterval * Math.round(angle / angleSnapInterval) - rotation % angleSnapInterval;\n\t\t\t\t\ttarget.x = origin.x + length * Math.cos(angleSnapped);\n\t\t\t\t\ttarget.y = origin.y + length * Math.sin(angleSnapped);\n\t\t\t\t}\n\t\t\t: (origin, target) => target;\n\n\t\t\tif (targetIndex === 0) {\n\t\t\t\tconst point = getImagePointWithScreenTranslation(shapeLineGetStartPoint(shapeOriginComputed), translation);\n\t\t\t\tsnap(vectorCreate(shapeOriginComputed.x2, shapeOriginComputed.y2), point);\n\t\t\t\tupdateShape(shapeCurrent, { x1: point.x, y1: point.y }, parentRect);\n\t\t\t} else if (targetIndex === 1) {\n\t\t\t\tconst point = getImagePointWithScreenTranslation(shapeLineGetEndPoint(shapeOriginComputed), translation);\n\t\t\t\tsnap(vectorCreate(shapeOriginComputed.x1, shapeOriginComputed.y1), point);\n\t\t\t\tupdateShape(shapeCurrent, { x2: point.x, y2: point.y }, parentRect);\n\t\t\t}\n\t\t} else if (shapeHasSize(shapeCurrent) || shapeIsEllipse(shapeCurrent) || shapeIsTextBox(shapeCurrent)) {\n\t\t\tlet hasAutoHeight = false;\n\t\t\tlet shapeOriginRect;\n\n\t\t\tif (shapeIsEllipse(shapeCurrent)) {\n\t\t\t\tshapeOriginRect = rectCreateFromEllipse(shapeOriginComputed);\n\t\t\t} else if (shapeHasSize(shapeCurrent)) {\n\t\t\t\tshapeOriginRect = rectCreateFromAny(shapeOriginComputed);\n\t\t\t} else {\n\t\t\t\t// is text with 'width' only\n\t\t\t\thasAutoHeight = true;\n\n\t\t\t\tshapeOriginRect = rectCreateFromAny(shapeOriginComputed);\n\t\t\t\tconst size = textSize(shapeOriginComputed.text, shapeOriginComputed);\n\t\t\t\tshapeOriginRect.height = size.height;\n\t\t\t}\n\n\t\t\tlet shapeAspectRatio;\n\n\t\t\tif (shapeCurrent.aspectRatio) {\n\t\t\t\tshapeAspectRatio = shapeCurrent.aspectRatio;\n\t\t\t} else if (options.shiftKey && !hasAutoHeight) {\n\t\t\t\tshapeAspectRatio = shapeOriginRect.width / shapeOriginRect.height;\n\t\t\t}\n\n\t\t\t// current shape\n\t\t\tconst rectAligned = rectCreateFromAny(shapeOriginRect);\n\n\t\t\tconst rectAlignedCenterPosition = rectCenter(rectAligned);\n\t\t\tconst rectRotation = shapeCurrent.rotation;\n\t\t\tconst rectAlignedCorners = rectGetCorners(rectAligned);\n\t\t\tconst rectCorners = rectRotate(rectAligned, rectRotation);\n\n\t\t\t// is translating one corner\n\t\t\tif (indexes.length === 1) {\n\t\t\t\t// corner\n\t\t\t\tlet cornerIndex = indexes[0];\n\n\t\t\t\tconst [tl, tr, br, bl] = rectAlignedCorners;\n\t\t\t\tconst screenTargetPosition = mapImagePointToEditorPoint(rectCorners[cornerIndex]);\n\t\t\t\tvectorAdd(screenTargetPosition, translation);\n\t\t\t\tconst imageTargetPosition = mapEditorPointToImagePoint(screenTargetPosition);\n\t\t\t\tconst imageTargetTranslation = vectorCreate(imageTargetPosition.x - rectCorners[cornerIndex].x, imageTargetPosition.y - rectCorners[cornerIndex].y);\n\t\t\t\tif (shapeCurrent.flipX) imageTargetTranslation.x = -imageTargetTranslation.x;\n\t\t\t\tif (shapeCurrent.flipY) imageTargetTranslation.y = -imageTargetTranslation.y;\n\t\t\t\tconst imageTargetTranslationAligned = vectorRotate(vectorClone(imageTargetTranslation), -rectRotation);\n\t\t\t\tconst imageTargetPositionAligned = vectorCreate(rectAlignedCorners[cornerIndex].x + imageTargetTranslationAligned.x, rectAlignedCorners[cornerIndex].y + imageTargetTranslationAligned.y);\n\t\t\t\tlet anchor;\n\t\t\t\tif (cornerIndex === 0) anchor = br;\n\t\t\t\tif (cornerIndex === 1) anchor = bl;\n\t\t\t\tif (cornerIndex === 2) anchor = tl;\n\t\t\t\tif (cornerIndex === 3) anchor = tr;\n\n\t\t\t\t// create an aligned and updated rectangle\n\t\t\t\tconst rectAlignedResized = rectCreateFromPoints(anchor, imageTargetPositionAligned);\n\n\t\t\t\t// limit rect\n\t\t\t\tif (shapeAspectRatio) {\n\t\t\t\t\t// get size that adheres to aspect ratio but still fits current rectangle\n\t\t\t\t\tconst { width, height } = rectContainRect(rectAlignedResized, shapeAspectRatio);\n\n\t\t\t\t\tconst [t, r, b, l] = rectToBounds(rectAlignedResized);\n\n\t\t\t\t\t// update size\n\t\t\t\t\trectAlignedResized.width = width;\n\n\t\t\t\t\trectAlignedResized.height = height;\n\n\t\t\t\t\t// align to anchor\n\t\t\t\t\tif (imageTargetPositionAligned.y < anchor.y) {\n\t\t\t\t\t\trectAlignedResized.y = b - height;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (imageTargetPositionAligned.x < anchor.x) {\n\t\t\t\t\t\trectAlignedResized.x = r - width;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// rotate the aligned rectangle around it's original pivot point\n\t\t\t\tconst rr = rectRotate(rectAlignedResized, rectRotation, rectAlignedCenterPosition);\n\n\t\t\t\t// now calculate the new center and then rotate the tl and br corners around that center to find their new positions\n\t\t\t\tconst rrc = vectorCenter(rr);\n\n\t\t\t\tconst p1 = vectorRotate(rr[0], -rectRotation, rrc);\n\t\t\t\tconst p2 = vectorRotate(rr[2], -rectRotation, rrc);\n\n\t\t\t\tif (shapeCurrent.flipX || shapeCurrent.flipY) {\n\t\t\t\t\tvectorsFlip([p1, p2], shapeCurrent.flipX, shapeCurrent.flipY, rectAlignedCenterPosition.x, rectAlignedCenterPosition.y);\n\t\t\t\t}\n\n\t\t\t\tconst rectUpdated = rectCreateFromPoints(p1, p2);\n\n\t\t\t\tupdateShape(\n\t\t\t\t\tshapeCurrent,\n\t\t\t\t\tshapeIsEllipse(shapeCurrent)\n\t\t\t\t\t? ellipseCreateFromRect(rectUpdated)\n\t\t\t\t\t: rectUpdated,\n\t\t\t\t\tparentRect\n\t\t\t\t);\n\t\t\t} else // is translating two corner points\n\t\t\t{\n\t\t\t\t// 0-1 -> 2-3\n\t\t\t\t// 1-2 -> 3-0\n\t\t\t\t// 2-3 -> 0-1\n\t\t\t\t// 3-0 -> 1-2\n\t\t\t\tconst [cornerA, cornerB] = indexes.map(index => rectCorners[index]);\n\n\t\t\t\tconst mid = {\n\t\t\t\t\tx: cornerA.x + (cornerB.x - cornerA.x) * 0.5,\n\t\t\t\t\ty: cornerA.y + (cornerB.y - cornerA.y) * 0.5\n\t\t\t\t};\n\n\t\t\t\tconst [cornerAlignedA, cornerAlignedB] = indexes.map(index => rectAlignedCorners[index]);\n\n\t\t\t\tconst [cornerAlignedC, cornerAlignedD] = indexes.map(index => {\n\t\t\t\t\tconst mappedIndex = index + 2;\n\t\t\t\t\tif (mappedIndex < 4) return rectAlignedCorners[mappedIndex];\n\t\t\t\t\treturn rectAlignedCorners[mappedIndex - 4];\n\t\t\t\t});\n\n\t\t\t\tconst midAligned = {\n\t\t\t\t\tx: cornerAlignedA.x + (cornerAlignedB.x - cornerAlignedA.x) * 0.5,\n\t\t\t\t\ty: cornerAlignedA.y + (cornerAlignedB.y - cornerAlignedA.y) * 0.5\n\t\t\t\t};\n\n\t\t\t\tconst midAnchorAligned = {\n\t\t\t\t\tx: cornerAlignedC.x + (cornerAlignedD.x - cornerAlignedC.x) * 0.5,\n\t\t\t\t\ty: cornerAlignedC.y + (cornerAlignedD.y - cornerAlignedC.y) * 0.5\n\t\t\t\t};\n\n\t\t\t\tconst screenTargetPosition = mapImagePointToEditorPoint(mid);\n\t\t\t\tvectorAdd(screenTargetPosition, translation);\n\t\t\t\tconst imageTargetPosition = mapEditorPointToImagePoint(screenTargetPosition);\n\t\t\t\tconst imageTargetTranslation = vectorCreate(imageTargetPosition.x - mid.x, imageTargetPosition.y - mid.y);\n\t\t\t\tif (shapeCurrent.flipX) imageTargetTranslation.x = -imageTargetTranslation.x;\n\t\t\t\tif (shapeCurrent.flipY) imageTargetTranslation.y = -imageTargetTranslation.y;\n\t\t\t\tconst imageTargetTranslationAligned = vectorRotate(vectorClone(imageTargetTranslation), -rectRotation);\n\n\t\t\t\t// const imageTargetPositionAligned = vectorCreate(\n\t\t\t\t//     midAligned.x + imageTargetTranslationAligned.x,\n\t\t\t\t//     midAligned.y + imageTargetTranslationAligned.y,\n\t\t\t\t// );\n\t\t\t\tconst d = vectorSubtract(vectorClone(cornerAlignedA), cornerAlignedB);\n\n\t\t\t\tconst f = vectorApply(d, v => 1 - Math.abs(Math.sign(v)));\n\t\t\t\tconst t = vectorCreate(imageTargetTranslationAligned.x * f.x, imageTargetTranslationAligned.y * f.y);\n\t\t\t\tvectorAdd(cornerAlignedA, t);\n\t\t\t\tvectorAdd(cornerAlignedB, t);\n\t\t\t\tconst rectAlignedResized = rectCreateFromPoints(rectAlignedCorners);\n\n\t\t\t\t// limit rect\n\t\t\t\tif (shapeAspectRatio) {\n\t\t\t\t\tlet width = rectAlignedResized.width;\n\t\t\t\t\tlet height = rectAlignedResized.height;\n\n\t\t\t\t\tif (f.y === 0) {\n\t\t\t\t\t\theight = width / shapeAspectRatio;\n\t\t\t\t\t} else {\n\t\t\t\t\t\twidth = height * shapeAspectRatio;\n\t\t\t\t\t}\n\n\t\t\t\t\t// update size\n\t\t\t\t\trectAlignedResized.width = width;\n\n\t\t\t\t\trectAlignedResized.height = height;\n\n\t\t\t\t\t// align to anchor\n\t\t\t\t\tif (f.y === 0) {\n\t\t\t\t\t\trectAlignedResized.y = midAnchorAligned.y - height * 0.5;\n\t\t\t\t\t} else {\n\t\t\t\t\t\trectAlignedResized.x = midAnchorAligned.x - width * 0.5;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// rotate the aligned rectangle around it's original pivot point\n\t\t\t\tconst rr = rectRotate(rectAlignedResized, rectRotation, rectAlignedCenterPosition);\n\n\t\t\t\t// now calculate the new center and then rotate the tl and br corners around that center to find their new positions\n\t\t\t\tconst rrc = vectorCenter(rr);\n\n\t\t\t\tconst p1 = vectorRotate(rr[0], -rectRotation, rrc);\n\t\t\t\tconst p2 = vectorRotate(rr[2], -rectRotation, rrc);\n\n\t\t\t\tif (shapeCurrent.flipX || shapeCurrent.flipY) {\n\t\t\t\t\tvectorsFlip([p1, p2], shapeCurrent.flipX, shapeCurrent.flipY, rectAlignedCenterPosition.x, rectAlignedCenterPosition.y);\n\t\t\t\t}\n\n\t\t\t\tconst rectUpdated = rectCreateFromPoints(p1, p2);\n\t\t\t\tlet props;\n\n\t\t\t\tif (shapeIsEllipse(shapeCurrent)) {\n\t\t\t\t\tprops = ellipseCreateFromRect(rectUpdated);\n\t\t\t\t} else if (shapeHasSize(shapeCurrent)) {\n\t\t\t\t\tprops = rectUpdated;\n\t\t\t\t} else if (hasAutoHeight) {\n\t\t\t\t\tprops = {\n\t\t\t\t\t\tx: rectUpdated.x,\n\t\t\t\t\t\ty: rectUpdated.y,\n\t\t\t\t\t\twidth: rectUpdated.width\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tupdateShape(shapeCurrent, props, parentRect);\n\t\t\t}\n\t\t}\n\n\t\tsyncShapes();\n\t};\n\n\tlet rotatorInitialPosition;\n\n\tconst rotateMarkup = (shapeCurrent, shapeOriginComputed, translation, options) => {\n\t\t// calculate angle between translated rotation control and origin\n\t\tconst shapeRect = getMarkupShapeRect(shapeComputeDisplay(shapeDeepCopy(shapeCurrent), parentRect));\n\n\t\tconst shapeCenter = rectCenter(shapeRect);\n\t\tconst p = getImagePointWithScreenTranslation(rotatorInitialPosition, translation);\n\t\tlet shapeRotation = vectorAngleBetween(p, shapeCenter) + Math.PI / 2;\n\n\t\tif (options.shiftKey) {\n\t\t\tconst rotatorSnapInterval = Math.PI / 16;\n\t\t\tshapeRotation = rotatorSnapInterval * Math.round(shapeRotation / rotatorSnapInterval) - rotation % rotatorSnapInterval;\n\t\t}\n\n\t\tupdateShape(shapeCurrent, { rotation: shapeRotation }, parentRect);\n\t\tsyncShapes();\n\t};\n\n\tconst getMarkupItemDraft = () => {\n\t\tif (!markup.length) return;\n\t\tconst lastMarkupItem = markup[markup.length - 1];\n\t\treturn lastMarkupItem.isDraft ? lastMarkupItem : undefined;\n\t};\n\n\tconst addMarkupItemDraft = (shape, sync = true) => {\n\t\tif (getMarkupItemDraft()) return;\n\t\tshape = Object.assign(shape, { isDraft: true });\n\t\treturn addShape(shape, sync);\n\t};\n\n\tconst confirmMarkupItemDraft = () => {\n\t\tconst markupItem = getMarkupItemDraft();\n\t\tif (!markupItem) return;\n\t\tupdateMarkupShapeProperty(markupItem, \"isDraft\", false);\n\t\treturn markupItem;\n\t};\n\n\tconst discardMarkupItemDraft = () => {\n\t\tif (!getMarkupItemDraft()) return;\n\t\t$$invalidate(0, markup = markup.slice(0, -1));\n\t};\n\n\tconst createMarkupItem = (props = {}) => ({ id: getUniqueId(), ...props });\n\tconst syncShapes = () => $$invalidate(0, markup);\n\n\tconst addShape = (shape, sync = true) => {\n\t\tmarkup.push(shape);\n\n\t\t// sync markup array\n\t\tif (sync) syncShapes();\n\n\t\treturn shape;\n\t};\n\n\tconst updateMarkupShape = (shape, props, sync = true) => {\n\t\t// update markup\n\t\tshape = Object.assign(shape, props);\n\n\t\t// sync markup array\n\t\tif (!sync) return;\n\n\t\tsyncShapes();\n\t};\n\n\tconst updateMarkupShapeProperty = (shape, name, value, sync = true) => {\n\t\tshape[name] = value;\n\n\t\t// sync markup array\n\t\tif (!sync) return;\n\n\t\tsyncShapes();\n\t};\n\n\tconst updateMarkupItemsShapeProperty = (name, value, sync = true) => {\n\t\tmarkup.forEach(shape => updateMarkupShapeProperty(shape, name, value, false));\n\n\t\t// sync markup array\n\t\tif (!sync) return;\n\n\t\tsyncShapes();\n\t};\n\n\tconst updateMarkupShapeItems = (props, sync = true) => {\n\t\tmarkup.forEach(markupItem => updateMarkupShape(markupItem, props, false));\n\n\t\t// sync markup array\n\t\tif (!sync) return;\n\n\t\tsyncShapes();\n\t};\n\n\tconst getActiveMarkupItem = () => [...markup].reverse().find(shapeIsSelected);\n\tconst hasActiveMarkupItem = () => !!getActiveMarkupItem();\n\n\tconst removeShape = (shapeToRemove, sync = true) => {\n\t\tif (!beforeRemoveShape(shapeToRemove)) return false;\n\t\tconst markupWithoutShape = markup.filter(shape => shape !== shapeToRemove);\n\t\tonremoveshape(shapeToRemove);\n\t\tif (!sync) return;\n\t\t$$invalidate(0, markup = markupWithoutShape);\n\t};\n\n\tconst removeActiveMarkupItem = () => {\n\t\tconst activeShape = getActiveMarkupItem();\n\t\tif (!activeShape) return;\n\n\t\t// get removable markup items, \n\t\tconst removableShapes = markup.filter(shape => shapeCanRemove(shape) && shapeCanSelect(shape));\n\n\t\t// find index of active shape so we can select the next active shape on removal\n\t\tconst index = removableShapes.findIndex(shape => shape === activeShape);\n\n\t\t// remove the active ship from the shape array\n\t\tconst didRemove = removeShape(activeShape);\n\n\t\tif (didRemove === false) return;\n\n\t\t// remember selection\n\t\tpreviousSelectedShape = activeShape;\n\n\t\t// if no more markup items, release active shape\n\t\tif (removableShapes.length - 1 === 0) return blurShapes();\n\n\t\t// select next active markup item\n\t\tconst indexNext = index - 1 < 0 ? removableShapes.length - 1 : index - 1;\n\n\t\tselectShape(removableShapes[indexNext]);\n\t};\n\n\tlet previousSelectedShape = undefined;\n\n\tconst blurShapes = () => {\n\t\tpreviousSelectedShape = getSelectedShape();\n\t\tupdateMarkupShapeItems({ isSelected: false, isEditing: false });\n\t};\n\n\tconst getSelectedShape = () => markup.find(shapeIsSelected);\n\n\tconst selectShape = (shape, sync = true) => {\n\t\t// can't select draft\n\t\tif (shape.isDraft) return;\n\n\t\t// get currently selected shape\n\t\tconst selectedShape = getSelectedShape() || previousSelectedShape;\n\n\t\t// reset previous selected shape\n\t\tpreviousSelectedShape = undefined;\n\n\t\t// if is returned false will cancel select operation\n\t\tif (!beforeSelectShape(selectedShape, shape)) return;\n\n\t\t// remove selected state from other markup\n\t\tblurShapes();\n\n\t\t// select\n\t\tshapeSelect(shape);\n\n\t\t// selected this shape\n\t\tonselectshape(shape);\n\n\t\t// sync\n\t\tif (!sync) return;\n\n\t\tsyncShapes();\n\t};\n\n\tconst deselectMarkupItem = markupItem => {\n\t\tupdateMarkupShape(markupItem, { isSelected: false, isEditing: false });\n\t};\n\n\tconst editMarkupItem = markupItem => {\n\t\tupdateMarkupShape(markupItem, { isSelected: true, isEditing: true });\n\t};\n\n\tconst finishEditMarkupItem = markupItem => {\n\t\tupdateMarkupShape(markupItem, { isSelected: true, isEditing: false });\n\t};\n\n\tconst removeMarkupItems = shapesToRemove => {\n\t\tconst shapesToRemoveFiltered = shapesToRemove.filter(beforeRemoveShape);\n\t\t$$invalidate(0, markup = markup.filter(shape => !shapesToRemoveFiltered.includes(shape)));\n\t\treturn shapesToRemoveFiltered;\n\t};\n\n\tconst getTextShapeRect = shape => {\n\t\tconst size = textSize(shape.text, shape);\n\n\t\treturn rectCreate(\n\t\t\tshape.x,\n\t\t\tshape.y,\n\t\t\tshape.width\n\t\t\t? Math.min(shape.width, size.width)\n\t\t\t: size.width,\n\t\t\tshape.height\n\t\t\t? Math.min(shape.height, size.height)\n\t\t\t: size.height\n\t\t);\n\t};\n\n\tconst getMarkupShapeRect = shape => {\n\t\t// has own rect\n\t\tif (shapeHasSize(shape)) return rectCreateFromAny(shape);\n\n\t\tif (shapeIsEllipse(shape)) return rectCreateFromEllipse(shape);\n\n\t\t// calculate the size on canvas\n\t\tconst rect = getTextShapeRect(shape);\n\n\t\trect.width = Math.max(MIN_TEXT_MARKUP_WIDTH, shape.width || rect.width);\n\t\treturn rect;\n\t};\n\n\tconst getShapesAtPosition = position => [...markup].// reverse the array, want to select from top to bottom\n\treverse().map(shape => ({ shape, priority: 1 })).// can't select paths\n\tfilter(result => shapeCanSelect(result.shape)).// find markup near pointer\n\tfilter(result => {\n\t\t// get shape\n\t\tconst { shape } = result;\n\n\t\t// we need to know where the shape will end up\n\t\tconst computedShape = shapeComputeDisplay(shapeDeepCopy(shape), parentRect);\n\n\t\t// test if clicked in rect\n\t\tif (shapeIsRect(computedShape)) {\n\t\t\treturn isPositionInRect(position, computedShape, shape.rotation);\n\t\t} else if (shapeIsText(computedShape)) {\n\t\t\tconst shapeRect = getMarkupShapeRect(computedShape);\n\t\t\tconst isPositionInBounds = isPositionInRect(position, shapeRect, shape.rotation);\n\t\t\tlet isPositionInVisual = false;\n\n\t\t\tif (isPositionInBounds && !shapeIsSelected(shape)) {\n\t\t\t\tconst visualRect = getTextShapeRect(computedShape);\n\n\t\t\t\tif (shape.textAlign === \"right\" && !shape.flipX) {\n\t\t\t\t\tvisualRect.x = shapeRect.x + shapeRect.width - visualRect.width;\n\t\t\t\t}\n\n\t\t\t\tif (shape.textAlign === \"center\") {\n\t\t\t\t\tvisualRect.x = shapeRect.x + shapeRect.width * 0.5 - visualRect.width * 0.5;\n\t\t\t\t}\n\n\t\t\t\tisPositionInVisual = isPositionInRect(position, visualRect, shape.rotation, rectCenter(shapeRect));\n\t\t\t\tif (!isPositionInVisual) result.priority = -1;\n\t\t\t}\n\n\t\t\treturn isPositionInBounds;\n\t\t} else // test if is ellipse\n\t\tif (shapeIsEllipse(computedShape)) {\n\t\t\treturn isPositionInEllipse(position, computedShape, shape.rotation);\n\t\t} else // test if clicked on line\n\t\tif (shapeIsLine(computedShape)) {\n\t\t\t// radius around click position, test if line intersects\n\t\t\treturn isPositionNearLine(position, shapeLineGetStartPoint(computedShape), shapeLineGetEndPoint(computedShape), 16);\n\t\t}\n\n\t\treturn false;\n\t}).sort((a, b) => {\n\t\tif (a.priority < b.priority) {\n\t\t\treturn 1;\n\t\t}\n\n\t\tif (a.priority > b.priority) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn 0;\n\t});\n\n\tconst getMarkupBetweenPoints = (a, b) => {\n\t\t// eraseLine should be in image space\n\t\tconst eraseLine = lineCreate(a, b);\n\n\t\t// loop over shapes and find intersecting shapes\n\t\treturn markup.filter(shapeCanErase).filter(shape => !!linePointsIntersection(eraseLine, getMarkupShapePoints(shapeComputeDisplay(shapeDeepCopy(shape), parentRect))));\n\t};\n\n\t//\n\t// Generic interaction\n\t//\n\tlet interactionTimer = undefined;\n\n\tlet interactionTarget = undefined;\n\tlet interactionShape = undefined;\n\tlet interactionShapeOriginComputed = undefined;\n\tlet isInteracting = false;\n\n\tconst handleInteractionStart = e => {\n\t\tconst { origin } = e.detail;\n\t\tinteractionShape = undefined;\n\t\tinteractionShapeOriginComputed = undefined;\n\t\tinteractionTarget = undefined;\n\t\tclearTimeout(interactionTimer);\n\t\tinteractionTimer = setTimeout(() => $$invalidate(104, isInteracting = true), 250);\n\n\t\t// test if target is a shape, if not, run interaction handler\n\t\tconst point = mapEditorPointToImagePoint(vectorClone(origin));\n\n\t\tconst foundShapes = getShapesAtPosition(point);\n\t\tconst targettedMarkupItem = foundShapes.length && foundShapes.shift().shape;\n\n\t\t// check if markup was targetted\n\t\tif (targettedMarkupItem && shapeIsSelected(targettedMarkupItem)) {\n\t\t\t// clone shape we're interacting with so we can update it properly\n\t\t\tinteractionShape = targettedMarkupItem;\n\n\t\t\tinteractionShapeOriginComputed = shapeComputeDisplay(shapeDeepCopy(interactionShape), parentRect);\n\t\t\treturn;\n\t\t}\n\n\t\t// set target\n\t\tinteractionTarget = targettedMarkupItem;\n\n\t\t// started interacting\n\t\toninteractionstart(e);\n\t};\n\n\tconst handleInteractionUpdate = e => {\n\t\t// is interacting with shape\n\t\tif (interactionShape) {\n\t\t\t// prevent moving if not allowed\n\t\t\tif (!shapeCanMove(interactionShape)) return;\n\n\t\t\t// prevent moving if is editing text\n\t\t\tif (shapeIsTextEditing(interactionShape)) return;\n\n\t\t\treturn translateShape(interactionShape, interactionShapeOriginComputed, e.detail.translation);\n\t\t}\n\n\t\toninteractionupdate(e);\n\t};\n\n\tconst handleInteractionRelease = e => {\n\t\tclearTimeout(interactionTimer);\n\t\t$$invalidate(104, isInteracting = false);\n\n\t\t// test if is text and if we double tapped, if so, switch to text edit mode\n\t\tif (interactionShape) {\n\t\t\tif (interactionShape.isEditing) {\n\t\t\t\thandleTextCancel();\n\t\t\t} else if (e.detail.isDoubleTap && shapeIsText(interactionShape) && shapeCanInput(interactionShape) !== false) {\n\t\t\t\teditMarkupItem(interactionShape);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\toninteractionrelease(e);\n\t};\n\n\tconst handleInteractionEnd = e => {\n\t\t// shape remains active so user can resize, rotate\n\t\tif (interactionShape) {\n\t\t\tonupdateshape(interactionShape);\n\t\t\tinteractionShape = undefined;\n\t\t\treturn;\n\t\t}\n\n\t\t// can we deselect the current shape?\n\t\tconst currentSelectedShape = getSelectedShape();\n\n\t\tconst isSelectInteraction = interactionTarget && e.detail.isTap;\n\n\t\tconst allowDeselectShape = currentSelectedShape\n\t\t? beforeDeselectShape(currentSelectedShape, interactionTarget)\n\t\t: true;\n\n\t\tif (allowDeselectShape) {\n\t\t\tblurShapes();\n\t\t}\n\n\t\toninteractionend(e);\n\n\t\tif (allowDeselectShape && isSelectInteraction) {\n\t\t\tselectShape(interactionTarget);\n\t\t}\n\t};\n\n\t//\n\t// Shape manipulation\n\t//\n\tconst getMarkupShapePoints = shape => {\n\t\tlet center;\n\t\tlet points;\n\n\t\tif (shapeIsRect(shape)) {\n\t\t\tcenter = rectCenter(shape);\n\t\t\tpoints = rectGetCorners(shape);\n\t\t\tif (shape.flipX || shape.flipY) vectorsFlip(points, shape.flipX, shape.flipY, center.x, center.y);\n\t\t\tpoints = vectorsRotate(points, shape.rotation, center.x, center.y);\n\t\t} else if (shapeIsEllipse(shape)) {\n\t\t\tcenter = shape;\n\t\t\tpoints = rectGetCorners(rectCreateFromEllipse(shape));\n\t\t\tif (shape.flipX || shape.flipY) vectorsFlip(points, shape.flipX, shape.flipY, center.x, center.y);\n\t\t\tpoints = vectorsRotate(points, shape.rotation, center.x, center.y);\n\t\t} else if (shapeIsLine(shape)) {\n\t\t\tpoints = [shapeLineGetStartPoint(shape), shapeLineGetEndPoint(shape)];\n\t\t\tcenter = vectorCenter(points);\n\t\t} else if (shapeIsPath(shape)) {\n\t\t\tpoints = [...shape.points];\n\t\t\tcenter = vectorCenter(points);\n\t\t} else if (shapeIsText(shape)) {\n\t\t\tconst rect = getMarkupShapeRect(shape);\n\t\t\trect.width = Math.max(MIN_TEXT_MARKUP_WIDTH, rect.width);\n\t\t\tcenter = rectCenter(rect);\n\t\t\tpoints = rectGetCorners(rect);\n\t\t\tif (shape.flipX || shape.flipY) vectorsFlip(points, shape.flipX, shape.flipY, center.x, center.y);\n\t\t\tpoints = vectorsRotate(points, shape.rotation, center.x, center.y);\n\t\t}\n\n\t\treturn points;\n\t};\n\n\tconst getShapeRotationPoint = shape => {\n\t\tconst points = getMarkupShapePoints(shape);\n\t\tlet origin;\n\t\tlet dir;\n\n\t\tif (shape.flipY) {\n\t\t\torigin = vectorCenter([points[0], points[1]]);\n\t\t\tdir = vectorNormalize(vectorCreate(points[1].x - points[2].x, points[1].y - points[2].y));\n\t\t} else {\n\t\t\torigin = vectorCenter([points[2], points[3]]);\n\t\t\tdir = vectorNormalize(vectorCreate(points[2].x - points[1].x, points[2].y - points[1].y));\n\t\t}\n\n\t\tvectorMultiply(dir, ROTATION_CONTROL_OFFSET / scale);\n\t\treturn { origin, dir };\n\t};\n\n\tconst getShapeRotationPointOnScreen = shape => {\n\t\tconst markupPoint = getShapeRotationPoint(shape);\n\n\t\tconst screenPosition = mapImagePointToEditorPoint({\n\t\t\tx: markupPoint.origin.x + markupPoint.dir.x,\n\t\t\ty: markupPoint.origin.y + markupPoint.dir.y\n\t\t});\n\n\t\tconst screenOrigin = mapImagePointToEditorPoint(markupPoint.origin);\n\n\t\treturn {\n\t\t\torigin: screenOrigin,\n\t\t\tposition: screenPosition\n\t\t};\n\t};\n\n\t// draw shape manipulator edges\n\tlet shapeManipulatorUid = `markup-manipulator-segment`;\n\n\tonDestroy(() => {\n\t\t// clean up UI elements created by editor\n\t\t$$invalidate(43, ui = ui.filter(guide => guide.id !== shapeManipulatorUid));\n\t});\n\n\tconst handleManipulatorResizeGrab = e => {\n\t\t$$invalidate(104, isInteracting = true);\n\t\tinteractionShape = activeMarkup;\n\t\tinteractionShapeOriginComputed = activeMarkupComputed;\n\t};\n\n\tconst handleManipulatorResizeDrag = e => {\n\t\tconst { translation, indexes, shiftKey } = e.detail;\n\t\tresizeMarkup(interactionShape, interactionShapeOriginComputed, indexes, translation, { shiftKey });\n\t};\n\n\tconst handleManipulatorResizeEnd = e => {\n\t\tselectShape(interactionShape);\n\t\tinteractionShape = undefined;\n\t\t$$invalidate(104, isInteracting = false);\n\t\tonupdateshape(activeMarkup);\n\t};\n\n\tconst handleManipulatorRotateGrab = e => {\n\t\trotatorInitialPosition = getShapeRotationPoint(activeMarkupComputed).origin;\n\t\t$$invalidate(104, isInteracting = true);\n\t\tinteractionShape = activeMarkup;\n\t\tinteractionShapeOriginComputed = activeMarkupComputed;\n\t};\n\n\tconst handleManipulatorRotateDrag = e => {\n\t\tconst { translation, shiftKey } = e.detail;\n\t\trotateMarkup(interactionShape, interactionShapeOriginComputed, translation, { shiftKey });\n\t};\n\n\tconst handleManipulatorRotateEnd = () => {\n\t\tselectShape(interactionShape);\n\t\tinteractionShape = undefined;\n\t\t$$invalidate(104, isInteracting = false);\n\t\tonupdateshape(activeMarkup);\n\t};\n\n\t//\n\t// Keyboard\n\t//\n\tconst handleKey = e => {\n\t\t// only handle key input if a shape has been selected\n\t\tif (!hasActiveMarkupItem()) return;\n\n\t\t// get key type\n\t\tconst { key } = e;\n\n\t\t// if is escape deselect active item\n\t\tif ((/escape/i).test(key)) {\n\t\t\treturn deselectMarkupItem(activeMarkup);\n\t\t}\n\n\t\t// if is tab, select next markup item\n\t\t/*\nif (/arrow/i.test(key)) {\n    const success = e.shiftKey \n        ? selectPreviousMarkupItem(activeMarkup)\n        : selectNextMarkupItem(activeMarkup);\n    \n    if (success) {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n}\n*/\n\t\t// if is remove active\n\t\tif ((/backspace/i).test(key) && !(/input|textarea/i).test(e.target.nodeName)) {\n\t\t\t// prevent back navigation on Firefox\n\t\t\te.preventDefault();\n\n\t\t\t// remove the item\n\t\t\tremoveActiveMarkupItem();\n\t\t}\n\t};\n\n\t//\n\t// Text input\n\t//\n\tlet textInput;\n\n\tconst getTextShapeOriginSnapshot = () => ({ ...activeMarkup });\n\n\tconst handleTextInput = () => {\n\t\tconst value = shapeIsTextLine(activeMarkup)\n\t\t? filterNewlines(textInput.value)\n\t\t: textInput.value;\n\n\t\tconst canInput = shapeCanInput(activeMarkup, value);\n\t\tconst text = canInput === true ? value : canInput;\n\t\tlet x = textShapeOrigin.x;\n\t\tlet y = textShapeOrigin.y;\n\n\t\t// if does not have height we need to adjust offset if is rotated\n\t\tif (!activeMarkup.height && activeMarkup.rotation !== 0) {\n\t\t\tconst textSizeCurrent = textSize(text, activeMarkup);\n\t\t\tconst textRectCurrent = rectCreate(textShapeOrigin.x, textShapeOrigin.y, textSizeCurrent.width, textSizeCurrent.height);\n\t\t\tconst [currentTopLeft] = rectRotate(textRectCurrent, textShapeOrigin.rotation);\n\t\t\tconst [originTopLeft] = rectRotate(textRectOrigin, textShapeOrigin.rotation);\n\t\t\tx += originTopLeft.x - currentTopLeft.x;\n\t\t\ty += originTopLeft.y - currentTopLeft.y;\n\t\t}\n\n\t\tupdateMarkupShape(activeMarkup, { x, y, text });\n\t};\n\n\tconst handleEditTextActiveMarkup = () => editMarkupItem(activeMarkup);\n\n\tconst handleTextInputAttempt = e => {\n\t\tconst currentValue = e.target.value;\n\t\tconst selectionStart = e.target.selectionStart;\n\t\tconst selectionEnd = e.target.selectionEnd;\n\t\tconst currentValueStart = currentValue.substring(0, selectionStart);\n\t\tconst currentValueEnd = currentValue.substring(selectionEnd);\n\t\tconst intendedValue = currentValueStart + e.key + currentValueEnd;\n\t\tconst filteredValue = shapeCanInput(activeMarkup, intendedValue);\n\t\tif (filteredValue !== intendedValue) return e.preventDefault();\n\t};\n\n\tconst filterNewlines = value => value.// split on lines so we can create compressed normal line of text\n\tsplit(/[\\n\\r]/g).// rempve spaces around lines\n\tmap(str => str.trim()).// remove empty strings\n\tfilter(str => str.length).// create new line\n\tjoin(\" \");\n\n\t// prevent moving shape when focusing text field, and close field if escape pressed\n\tconst handleTextInputKeyDown = e => {\n\t\tif (shapeIsTextLine(activeMarkup) && (/enter/i).test(e.code)) return e.preventDefault();\n\t\tif ((/arrow/i).test(e.code)) return e.stopPropagation();\n\t\tif ((/escape/i).test(e.key)) return handleTextCancel();\n\t};\n\n\t// handle alt/ctrl/cmd + return\n\tconst handleTextInputKeyUp = e => {\n\t\t// get key type\n\t\tconst { key, ctrlKey, altKey } = e;\n\n\t\t// confirm multi line text elements\n\t\tif ((/enter/i).test(key) && ctrlKey | altKey) return handleTextConfirm();\n\t};\n\n\tconst handleTextConfirm = () => {\n\t\t// if was draft, now need to confirm\n\t\tlet wasDraft = activeMarkup.isDraft;\n\n\t\tif (activeMarkup.isDraft) confirmMarkupItemDraft();\n\n\t\t// final text input check\n\t\thandleTextInput();\n\n\t\t// done\n\t\tfinishEditMarkupItem(activeMarkup);\n\n\t\tif (wasDraft) onaddshape(activeMarkup); else onupdateshape(activeMarkup);\n\t};\n\n\tconst handleTextCancel = () => {\n\t\t// revert text\n\t\tupdateMarkupShape(activeMarkup, {\n\t\t\ttext: textShapeOrigin.text,\n\t\t\tx: textShapeOrigin.x,\n\t\t\ty: textShapeOrigin.y\n\t\t});\n\n\t\tif (activeMarkup.isDraft) discardMarkupItemDraft();\n\t\tfinishEditMarkupItem(activeMarkup);\n\t};\n\n\t//\n\t// Controls\n\t//\n\tconst handleFlipX = e => {\n\t\te.stopPropagation();\n\t\tconst flipX = activeMarkup.flipX || false;\n\t\tupdateMarkupShapeProperty(activeMarkup, \"flipX\", !flipX);\n\t\tonupdateshape(activeMarkup);\n\t};\n\n\tconst handleFlipY = e => {\n\t\te.stopPropagation();\n\t\tconst flipY = activeMarkup.flipY || false;\n\t\tupdateMarkupShapeProperty(activeMarkup, \"flipY\", !flipY);\n\t\tonupdateshape(activeMarkup);\n\t};\n\n\tconst handleRemoveActiveMarkup = e => {\n\t\te.stopPropagation();\n\t\te.target.blur(); // cancels focus of remove button\n\t\tremoveActiveMarkupItem();\n\t};\n\n\tconst handleMoveToFrontActiveMarkup = e => {\n\t\te.stopPropagation();\n\n\t\t// test if is not already at top of stack, if so, exit\n\t\tconst index = markup.findIndex(shape => shape === activeMarkup);\n\n\t\tif (index === markup.length - 1) return;\n\n\t\t// add to last index\n\t\t$$invalidate(0, markup = markup.filter(markupItem => markupItem !== activeMarkup).concat([activeMarkup]));\n\n\t\tonupdateshape(activeMarkup);\n\t};\n\n\tconst handleDuplicateActiveMarkup = e => {\n\t\te.stopPropagation();\n\n\t\t// create clone\n\t\tconst clone = shapeDeepCopy(activeMarkup);\n\n\t\tclone.id = getUniqueId();\n\t\tconst duplicationOffset = vectorCreate(50, -50);\n\n\t\t// offset\n\t\tif (shapeIsLine(clone)) {\n\t\t\tconst linePosition = shapeGetPropsPixelValues(clone, [\"x1\", \"y1\", \"x2\", \"y2\"], parentRect);\n\t\t\tlinePosition.x1 += duplicationOffset.x;\n\t\t\tlinePosition.y1 += duplicationOffset.y;\n\t\t\tlinePosition.x2 += duplicationOffset.x;\n\t\t\tlinePosition.y2 += duplicationOffset.y;\n\t\t\tshapeUpdateProps(clone, linePosition, parentRect);\n\t\t} else {\n\t\t\tconst currentPosition = shapeGetPropsPixelValues(clone, [\"x\", \"y\"], parentRect);\n\t\t\tcurrentPosition.x += 50;\n\t\t\tcurrentPosition.y -= 50;\n\t\t\tshapeUpdateProps(clone, currentPosition, parentRect);\n\t\t}\n\n\t\t// add clone\n\t\tmarkup.push(clone);\n\n\t\t// added\n\t\tonaddshape(clone);\n\n\t\t// select clone\n\t\tselectShape(clone);\n\t};\n\n\tconst getMarkupControlsAnchorPosition = rect => vectorApply(vectorCreate(rect.x + rect.width * 0.5, rect.y), snapToPixel);\n\n\t//\n\t// show & position markup controls panel\n\t//\n\tconst markupControlsOpacity = spring(0, { stiffness: 0.2, damping: 0.7 });\n\n\tcomponent_subscribe($$self, markupControlsOpacity, value => $$invalidate(17, $markupControlsOpacity = value));\n\tlet shapeControlsSize;\n\n\tconst getShapeControlPositionOnCanvas = position => {\n\t\tconst left = utilRect.x;\n\t\tconst top = utilRect.y;\n\t\tconst right = left + utilRect.width;\n\t\tlet x = Math.max(position.x - shapeControlsSize.width * 0.5, left);\n\t\tlet y = Math.max(position.y - shapeControlsSize.height - shapeControlDist, top);\n\t\tif (x + shapeControlsSize.width > right) x = right - shapeControlsSize.width;\n\t\treturn vectorCreate(x, y);\n\t};\n\n\tconst handleNudge = e => {\n\t\tconst shape = getActiveMarkupItem();\n\t\tif (!shape) return;\n\t\tif (!shapeCanMove(shape)) return;\n\t\tinteractionShape = shape;\n\t\tinteractionShapeOriginComputed = shapeComputeDisplay(shapeDeepCopy(interactionShape), parentRect);\n\t\ttranslateShape(interactionShape, interactionShapeOriginComputed, e.detail);\n\t};\n\n\tconst handleViewResize = () => {\n\t\tif (isTextMarkupSelected) return;\n\t\tblurShapes();\n\t};\n\n\t// shape navigator\n\tlet showShapeList = false;\n\n\tconst handleFocusIn = e => {\n\t\t$$invalidate(7, showShapeList = true);\n\t};\n\n\tconst handleFocusOut = ({ relatedTarget }) => {\n\t\t// still in list\n\t\tif (relatedTarget.classList.contains(\"shape-selector__button\")) return;\n\n\t\t$$invalidate(7, showShapeList = false);\n\t};\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\tconst click_handler = (index, e) => selectShape(markup[index]);\n\n\tfunction textarea_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\ttextInput = $$value;\n\t\t\t$$invalidate(5, textInput);\n\t\t});\n\t}\n\n\tconst measure_handler_1 = e => $$invalidate(6, shapeControlsSize = e.detail);\n\tconst interactable_function = e => getEventPositionInEditor(e, rootRect);\n\n\t$$self.$$set = $$props => {\n\t\tif (\"markup\" in $$props) $$invalidate(0, markup = $$props.markup);\n\t\tif (\"offset\" in $$props) $$invalidate(1, offset = $$props.offset);\n\t\tif (\"rotation\" in $$props) $$invalidate(44, rotation = $$props.rotation);\n\t\tif (\"scale\" in $$props) $$invalidate(45, scale = $$props.scale);\n\t\tif (\"ui\" in $$props) $$invalidate(43, ui = $$props.ui);\n\t\tif (\"opacity\" in $$props) $$invalidate(46, opacity = $$props.opacity);\n\t\tif (\"parentRect\" in $$props) $$invalidate(47, parentRect = $$props.parentRect);\n\t\tif (\"rootRect\" in $$props) $$invalidate(2, rootRect = $$props.rootRect);\n\t\tif (\"stageRect\" in $$props) $$invalidate(48, stageRect = $$props.stageRect);\n\t\tif (\"utilRect\" in $$props) $$invalidate(49, utilRect = $$props.utilRect);\n\t\tif (\"oninteractionstart\" in $$props) $$invalidate(50, oninteractionstart = $$props.oninteractionstart);\n\t\tif (\"oninteractionupdate\" in $$props) $$invalidate(51, oninteractionupdate = $$props.oninteractionupdate);\n\t\tif (\"oninteractionrelease\" in $$props) $$invalidate(52, oninteractionrelease = $$props.oninteractionrelease);\n\t\tif (\"oninteractionend\" in $$props) $$invalidate(53, oninteractionend = $$props.oninteractionend);\n\t\tif (\"onaddshape\" in $$props) $$invalidate(54, onaddshape = $$props.onaddshape);\n\t\tif (\"onupdateshape\" in $$props) $$invalidate(55, onupdateshape = $$props.onupdateshape);\n\t\tif (\"onselectshape\" in $$props) $$invalidate(56, onselectshape = $$props.onselectshape);\n\t\tif (\"onremoveshape\" in $$props) $$invalidate(57, onremoveshape = $$props.onremoveshape);\n\t\tif (\"beforeSelectShape\" in $$props) $$invalidate(58, beforeSelectShape = $$props.beforeSelectShape);\n\t\tif (\"beforeDeselectShape\" in $$props) $$invalidate(59, beforeDeselectShape = $$props.beforeDeselectShape);\n\t\tif (\"beforeAddShape\" in $$props) $$invalidate(60, beforeAddShape = $$props.beforeAddShape);\n\t\tif (\"beforeRemoveShape\" in $$props) $$invalidate(61, beforeRemoveShape = $$props.beforeRemoveShape);\n\t\tif (\"beforeUpdateShape\" in $$props) $$invalidate(62, beforeUpdateShape = $$props.beforeUpdateShape);\n\t\tif (\"willRenderShapeControls\" in $$props) $$invalidate(63, willRenderShapeControls = $$props.willRenderShapeControls);\n\t\tif (\"mapEditorPointToImagePoint\" in $$props) $$invalidate(64, mapEditorPointToImagePoint = $$props.mapEditorPointToImagePoint);\n\t\tif (\"mapImagePointToEditorPoint\" in $$props) $$invalidate(65, mapImagePointToEditorPoint = $$props.mapImagePointToEditorPoint);\n\t\tif (\"enableButtonFlipVertical\" in $$props) $$invalidate(66, enableButtonFlipVertical = $$props.enableButtonFlipVertical);\n\t\tif (\"locale\" in $$props) $$invalidate(3, locale = $$props.locale);\n\t};\n\n\tlet activeMarkup;\n\tlet activeShapeId;\n\tlet activeMarkupComputed;\n\tlet activeMarkupItemIsDraft;\n\tlet shapeProps;\n\tlet shapeActivePoints;\n\tlet allowResizeControls;\n\tlet allowRotateControls;\n\tlet allowedResizeControls;\n\tlet shouldRenderShapeManipulator;\n\tlet shapeActiveScreenPoints;\n\tlet shapeManipulatorPoints;\n\tlet shapeManipulatorRotationPoint;\n\tlet shapeManipulatorRotationPointPosition;\n\tlet shapeOpacity;\n\tlet isTextMarkupSelected;\n\tlet shouldRenderTextInput;\n\tlet textShapeOrigin;\n\tlet textSizeOrigin;\n\tlet textRectOrigin;\n\tlet textInputText;\n\tlet markupTextInputStyle;\n\tlet controlledMarkupItem;\n\tlet allowShapeFlip;\n\tlet allowShapeDuplicate;\n\tlet allowShapeRemove;\n\tlet allowShapeReorder;\n\tlet allowShapeInput;\n\tlet markupControlsAnchorPosition;\n\tlet shapeControlsPosition;\n\tlet markupControlsStyle;\n\tlet shapeControls;\n\tlet shapeNavList;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*markup*/ 1) {\n\t\t\t $$invalidate(106, activeMarkup = markup && (getMarkupItemDraft() || getActiveMarkupItem()));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*activeMarkup*/ 8192) {\n\t\t\t $$invalidate(107, activeShapeId = activeMarkup && !shapeIsDraft(activeMarkup)\n\t\t\t? activeMarkup.id\n\t\t\t: undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*parentRect*/ 65536 | $$self.$$.dirty[3] & /*activeMarkup*/ 8192) {\n\t\t\t $$invalidate(108, activeMarkupComputed = activeMarkup && shapeComputeDisplay(shapeDeepCopy(activeMarkup), parentRect));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*activeMarkup*/ 8192) {\n\t\t\t $$invalidate(109, activeMarkupItemIsDraft = !!(activeMarkup && shapeIsDraft(activeMarkup)));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*activeMarkup*/ 8192) {\n\t\t\t $$invalidate(110, shapeProps = activeMarkup || undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*activeMarkup, activeMarkupComputed*/ 40960) {\n\t\t\t $$invalidate(111, shapeActivePoints = activeMarkup && !shapeIsPath(activeMarkupComputed) && getMarkupShapePoints(activeMarkupComputed) || []);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*activeMarkup*/ 8192) {\n\t\t\t $$invalidate(112, allowResizeControls = activeMarkup && shapeCanResize(activeMarkup) && !shapeIsTextEditing(activeMarkup));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*activeMarkup*/ 8192) {\n\t\t\t $$invalidate(8, allowRotateControls = activeMarkup && shapeCanRotate(activeMarkup) && !shapeIsTextEditing(activeMarkup));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*allowResizeControls, activeMarkup*/ 532480) {\n\t\t\t $$invalidate(9, allowedResizeControls = allowResizeControls && (hasProp(activeMarkup, \"text\") && !activeMarkup.height)\n\t\t\t? \"horizontal\"\n\t\t\t: allowResizeControls);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*activeMarkup, shapeActivePoints*/ 270336) {\n\t\t\t $$invalidate(10, shouldRenderShapeManipulator = activeMarkup && shapeActivePoints.length > 1);\n\t\t}\n\n\t\tif ($$self.$$.dirty[2] & /*mapImagePointToEditorPoint*/ 8 | $$self.$$.dirty[3] & /*shapeActivePoints*/ 262144) {\n\t\t\t $$invalidate(113, shapeActiveScreenPoints = shapeActivePoints.map(mapImagePointToEditorPoint));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*offset*/ 2 | $$self.$$.dirty[3] & /*shapeActiveScreenPoints*/ 1048576) {\n\t\t\t $$invalidate(11, shapeManipulatorPoints = shapeActiveScreenPoints.map(point => vectorCreate(point.x - offset.x, point.y - offset.y)));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*shouldRenderShapeManipulator, allowRotateControls*/ 1280 | $$self.$$.dirty[3] & /*activeMarkupComputed*/ 32768) {\n\t\t\t $$invalidate(114, shapeManipulatorRotationPoint = shouldRenderShapeManipulator && allowRotateControls && getShapeRotationPointOnScreen(activeMarkupComputed));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*offset*/ 2 | $$self.$$.dirty[3] & /*shapeManipulatorRotationPoint*/ 2097152) {\n\t\t\t $$invalidate(12, shapeManipulatorRotationPointPosition = shapeManipulatorRotationPoint && vectorCreate(shapeManipulatorRotationPoint.position.x - offset.x, shapeManipulatorRotationPoint.position.y - offset.y));\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*opacity*/ 32768) {\n\t\t\t $$invalidate(115, shapeOpacity = opacity); // 1.0; // shapeManipulatorOpacity * opacity;\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*shapeManipulatorPoints*/ 2048 | $$self.$$.dirty[1] & /*opacity, ui*/ 36864 | $$self.$$.dirty[3] & /*shapeActiveScreenPoints, shapeOpacity, shapeManipulatorRotationPoint*/ 7340032) {\n\t\t\t if (opacity > 0 && shapeManipulatorPoints.length > 2) {\n\t\t\t\t// create manipulator outline segments\n\t\t\t\tconst points = [...shapeActiveScreenPoints, shapeActiveScreenPoints[0]];\n\n\t\t\t\tconst l = points.length;\n\t\t\t\tconst segments = [];\n\t\t\t\tconst strokeColor = [1, 1, 1, shapeOpacity];\n\t\t\t\tconst strokeWidth = 1;\n\n\t\t\t\tfor (let i = 0; i < l - 1; i++) {\n\t\t\t\t\tsegments[i] = {\n\t\t\t\t\t\tid: shapeManipulatorUid,\n\t\t\t\t\t\tpoints: [points[i], points[i + 1]],\n\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\tstrokeColor,\n\t\t\t\t\t\tstrokeWidth\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (shapeManipulatorRotationPoint) {\n\t\t\t\t\t// add rotator line\n\t\t\t\t\tsegments[segments.length] = {\n\t\t\t\t\t\tid: shapeManipulatorUid,\n\t\t\t\t\t\topacity: 1,\n\t\t\t\t\t\tpoints: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tx: shapeManipulatorRotationPoint.origin.x,\n\t\t\t\t\t\t\t\ty: shapeManipulatorRotationPoint.origin.y\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tx: shapeManipulatorRotationPoint.position.x,\n\t\t\t\t\t\t\t\ty: shapeManipulatorRotationPoint.position.y\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t],\n\t\t\t\t\t\tstrokeColor,\n\t\t\t\t\t\tstrokeWidth\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\t// remove existing segments, and set new ones\n\t\t\t\t$$invalidate(43, ui = [...ui.filter(guide => guide.id !== shapeManipulatorUid), ...segments]);\n\t\t\t} else {\n\t\t\t\t// remove the guides when shape manipulator is no longer visible\n\t\t\t\t$$invalidate(43, ui = ui.filter(guide => guide.id !== shapeManipulatorUid));\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*activeMarkup*/ 8192) {\n\t\t\t $$invalidate(116, isTextMarkupSelected = activeMarkup && shapeIsText(activeMarkup));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*isTextMarkupSelected, activeMarkup*/ 8396800) {\n\t\t\t $$invalidate(13, shouldRenderTextInput = isTextMarkupSelected && shapeCanInput(activeMarkup) !== false && activeMarkup.isEditing);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*shouldRenderTextInput*/ 8192) {\n\t\t\t $$invalidate(117, textShapeOrigin = shouldRenderTextInput\n\t\t\t? getTextShapeOriginSnapshot()\n\t\t\t: undefined);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*textShapeOrigin*/ 16777216) {\n\t\t\t $$invalidate(118, textSizeOrigin = textShapeOrigin && textSize(textShapeOrigin.text, textShapeOrigin));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*textShapeOrigin, textSizeOrigin*/ 50331648) {\n\t\t\t textRectOrigin = textShapeOrigin && rectCreate(textShapeOrigin.x, textShapeOrigin.y, textSizeOrigin.width, textSizeOrigin.height);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*shouldRenderTextInput*/ 8192 | $$self.$$.dirty[3] & /*activeMarkup*/ 8192) {\n\t\t\t $$invalidate(14, textInputText = shouldRenderTextInput ? activeMarkup.text : \"\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*shouldRenderTextInput*/ 8192 | $$self.$$.dirty[3] & /*shapeProps*/ 131072) {\n\t\t\t $$invalidate(15, markupTextInputStyle = shouldRenderTextInput && `\n    text-align: ${shapeProps.textAlign || \"left\"};\n    font-family: ${shapeProps.fontFamily || \"sans-serif\"};\n`);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*activeMarkup, activeMarkupItemIsDraft, controlledMarkupItem*/ 134291456) {\n\t\t\t $$invalidate(120, controlledMarkupItem = activeMarkup && !activeMarkupItemIsDraft\n\t\t\t? activeMarkup\n\t\t\t: controlledMarkupItem);\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*controlledMarkupItem*/ 134217728) {\n\t\t\t $$invalidate(121, allowShapeFlip = controlledMarkupItem && shapeCanFlip(controlledMarkupItem));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*controlledMarkupItem*/ 134217728) {\n\t\t\t $$invalidate(122, allowShapeDuplicate = controlledMarkupItem && shapeCanDuplicate(controlledMarkupItem));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*controlledMarkupItem*/ 134217728) {\n\t\t\t $$invalidate(123, allowShapeRemove = controlledMarkupItem && shapeCanRemove(controlledMarkupItem));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*controlledMarkupItem*/ 134217728) {\n\t\t\t $$invalidate(124, allowShapeReorder = controlledMarkupItem && shapeCanReorder(controlledMarkupItem));\n\t\t}\n\n\t\tif ($$self.$$.dirty[3] & /*controlledMarkupItem*/ 134217728) {\n\t\t\t $$invalidate(125, allowShapeInput = controlledMarkupItem && shapeCanInput(controlledMarkupItem) !== false);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*shouldRenderTextInput*/ 8192 | $$self.$$.dirty[3] & /*activeMarkup, activeMarkupItemIsDraft, isInteracting*/ 75776) {\n\t\t\t markupControlsOpacity.set(activeMarkup && !activeMarkupItemIsDraft && !isInteracting && !shouldRenderTextInput\n\t\t\t? 1\n\t\t\t: 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*shapeManipulatorPoints*/ 2048 | $$self.$$.dirty[3] & /*activeMarkup, activeMarkupItemIsDraft*/ 73728 | $$self.$$.dirty[4] & /*markupControlsAnchorPosition*/ 4) {\n\t\t\t $$invalidate(126, markupControlsAnchorPosition = activeMarkup && !activeMarkupItemIsDraft\n\t\t\t? getMarkupControlsAnchorPosition(rectCreateFromPoints(shapeManipulatorPoints))\n\t\t\t: markupControlsAnchorPosition);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*shapeControlsSize*/ 64 | $$self.$$.dirty[1] & /*utilRect*/ 262144 | $$self.$$.dirty[4] & /*markupControlsAnchorPosition*/ 4) {\n\t\t\t $$invalidate(127, shapeControlsPosition = markupControlsAnchorPosition && shapeControlsSize && utilRect && getShapeControlPositionOnCanvas(markupControlsAnchorPosition));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$markupControlsOpacity*/ 131072 | $$self.$$.dirty[4] & /*shapeControlsPosition*/ 8) {\n\t\t\t $$invalidate(16, markupControlsStyle = shapeControlsPosition && `transform: translate(${shapeControlsPosition.x}px, ${shapeControlsPosition.y}px);opacity:${$markupControlsOpacity}`);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*locale*/ 8 | $$self.$$.dirty[2] & /*willRenderShapeControls, enableButtonFlipVertical*/ 18 | $$self.$$.dirty[3] & /*activeShapeId, allowShapeFlip, allowShapeDuplicate, allowShapeRemove*/ 1879064576 | $$self.$$.dirty[4] & /*allowShapeReorder, allowShapeInput*/ 3) {\n\t\t\t $$invalidate(18, shapeControls = activeShapeId && willRenderShapeControls(\n\t\t\t\t[\n\t\t\t\t\t[\n\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\"alpha\",\n\t\t\t\t\t\t{ class: \"DokaShapeControlsGroup\" },\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tallowShapeFlip && [\n\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\"flip-horizontal\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick: handleFlipX,\n\t\t\t\t\t\t\t\t\tlabel: locale.shapeTitleButtonFlipHorizontal,\n\t\t\t\t\t\t\t\t\ticon: locale.shapeIconButtonFlipHorizontal,\n\t\t\t\t\t\t\t\t\thideLabel: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tallowShapeFlip && enableButtonFlipVertical && [\n\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\"flip-vertical\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick: handleFlipY,\n\t\t\t\t\t\t\t\t\tlabel: locale.shapeTitleButtonFlipVertical,\n\t\t\t\t\t\t\t\t\ticon: locale.shapeIconButtonFlipVertical,\n\t\t\t\t\t\t\t\t\thideLabel: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tallowShapeReorder && [\n\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\"to-front\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick: handleMoveToFrontActiveMarkup,\n\t\t\t\t\t\t\t\t\tlabel: locale.shapeTitleButtonMoveToFront,\n\t\t\t\t\t\t\t\t\ticon: locale.shapeIconButtonMoveToFront,\n\t\t\t\t\t\t\t\t\thideLabel: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tallowShapeDuplicate && [\n\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\"duplicate\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick: handleDuplicateActiveMarkup,\n\t\t\t\t\t\t\t\t\tlabel: locale.shapeTitleButtonDuplicate,\n\t\t\t\t\t\t\t\t\ticon: locale.shapeIconButtonDuplicate,\n\t\t\t\t\t\t\t\t\thideLabel: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tallowShapeRemove && [\n\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\"remove\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tonclick: handleRemoveActiveMarkup,\n\t\t\t\t\t\t\t\t\tlabel: locale.shapeTitleButtonRemove,\n\t\t\t\t\t\t\t\t\ticon: locale.shapeIconButtonRemove,\n\t\t\t\t\t\t\t\t\thideLabel: true\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t]\n\t\t\t\t\t],\n\t\t\t\t\tallowShapeInput && [\n\t\t\t\t\t\t\"div\",\n\t\t\t\t\t\t\"beta\",\n\t\t\t\t\t\t{ class: \"DokaShapeControlsGroup\" },\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\tButton,\n\t\t\t\t\t\t\t\t\"edit-text\",\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: locale.shapeLabelInputText,\n\t\t\t\t\t\t\t\t\tonclick: handleEditTextActiveMarkup\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t]\n\t\t\t\t\t]\n\t\t\t\t],\n\t\t\t\tactiveShapeId\n\t\t\t));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*rootRect*/ 4) {\n\t\t\t// if view is resized\n\t\t\t if (rootRect) {\n\t\t\t\thandleViewResize();\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*markup, locale*/ 9) {\n\t\t\t $$invalidate(19, shapeNavList = markup.filter(shapeCanSelect).filter(shape => !shapeIsDraft(shape)).map(shape => ({\n\t\t\t\tid: shape.id,\n\t\t\t\tcolor: shapeIsText(shape)\n\t\t\t\t? shape.color\n\t\t\t\t: shapeIsLine(shape)\n\t\t\t\t\t? shape.strokeColor\n\t\t\t\t\t: shape.backgroundColor,\n\t\t\t\tname: shape.name || locale[`shapeLabelTool${capitalizeFirstLetter(shapeGetDescription(shape))}`]\n\t\t\t})));\n\t\t}\n\t};\n\n\treturn [\n\t\tmarkup,\n\t\toffset,\n\t\trootRect,\n\t\tlocale,\n\t\tselectShape,\n\t\ttextInput,\n\t\tshapeControlsSize,\n\t\tshowShapeList,\n\t\tallowRotateControls,\n\t\tallowedResizeControls,\n\t\tshouldRenderShapeManipulator,\n\t\tshapeManipulatorPoints,\n\t\tshapeManipulatorRotationPointPosition,\n\t\tshouldRenderTextInput,\n\t\ttextInputText,\n\t\tmarkupTextInputStyle,\n\t\tmarkupControlsStyle,\n\t\t$markupControlsOpacity,\n\t\tshapeControls,\n\t\tshapeNavList,\n\t\tkeysPressedStored,\n\t\thandleWheel,\n\t\thandleInteractionStart,\n\t\thandleInteractionUpdate,\n\t\thandleInteractionRelease,\n\t\thandleInteractionEnd,\n\t\thandleManipulatorResizeGrab,\n\t\thandleManipulatorResizeDrag,\n\t\thandleManipulatorResizeEnd,\n\t\thandleManipulatorRotateGrab,\n\t\thandleManipulatorRotateDrag,\n\t\thandleManipulatorRotateEnd,\n\t\thandleKey,\n\t\thandleTextInput,\n\t\thandleTextInputAttempt,\n\t\thandleTextInputKeyDown,\n\t\thandleTextInputKeyUp,\n\t\thandleTextConfirm,\n\t\thandleTextCancel,\n\t\tmarkupControlsOpacity,\n\t\thandleNudge,\n\t\thandleFocusIn,\n\t\thandleFocusOut,\n\t\tui,\n\t\trotation,\n\t\tscale,\n\t\topacity,\n\t\tparentRect,\n\t\tstageRect,\n\t\tutilRect,\n\t\toninteractionstart,\n\t\toninteractionupdate,\n\t\toninteractionrelease,\n\t\toninteractionend,\n\t\tonaddshape,\n\t\tonupdateshape,\n\t\tonselectshape,\n\t\tonremoveshape,\n\t\tbeforeSelectShape,\n\t\tbeforeDeselectShape,\n\t\tbeforeAddShape,\n\t\tbeforeRemoveShape,\n\t\tbeforeUpdateShape,\n\t\twillRenderShapeControls,\n\t\tmapEditorPointToImagePoint,\n\t\tmapImagePointToEditorPoint,\n\t\tenableButtonFlipVertical,\n\t\tcreateShape,\n\t\teraseShape,\n\t\tgetMarkupItemDraft,\n\t\taddMarkupItemDraft,\n\t\tconfirmMarkupItemDraft,\n\t\tdiscardMarkupItemDraft,\n\t\tcreateMarkupItem,\n\t\tsyncShapes,\n\t\taddShape,\n\t\tupdateMarkupShape,\n\t\tupdateMarkupShapeProperty,\n\t\tupdateMarkupItemsShapeProperty,\n\t\tupdateMarkupShapeItems,\n\t\tgetActiveMarkupItem,\n\t\thasActiveMarkupItem,\n\t\tremoveShape,\n\t\tremoveActiveMarkupItem,\n\t\tblurShapes,\n\t\tdeselectMarkupItem,\n\t\teditMarkupItem,\n\t\tfinishEditMarkupItem,\n\t\tremoveMarkupItems,\n\t\tgetTextShapeRect,\n\t\tgetMarkupShapeRect,\n\t\tgetShapesAtPosition,\n\t\tgetMarkupBetweenPoints,\n\t\tmeasure_handler,\n\t\tclick_handler,\n\t\ttextarea_binding,\n\t\tmeasure_handler_1,\n\t\tinteractable_function\n\t];\n}\n\nclass ShapeLayoutEditor extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$w,\n\t\t\tcreate_fragment$w,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tmarkup: 0,\n\t\t\t\toffset: 1,\n\t\t\t\trotation: 44,\n\t\t\t\tscale: 45,\n\t\t\t\tui: 43,\n\t\t\t\topacity: 46,\n\t\t\t\tparentRect: 47,\n\t\t\t\trootRect: 2,\n\t\t\t\tstageRect: 48,\n\t\t\t\tutilRect: 49,\n\t\t\t\toninteractionstart: 50,\n\t\t\t\toninteractionupdate: 51,\n\t\t\t\toninteractionrelease: 52,\n\t\t\t\toninteractionend: 53,\n\t\t\t\tonaddshape: 54,\n\t\t\t\tonupdateshape: 55,\n\t\t\t\tonselectshape: 56,\n\t\t\t\tonremoveshape: 57,\n\t\t\t\tbeforeSelectShape: 58,\n\t\t\t\tbeforeDeselectShape: 59,\n\t\t\t\tbeforeAddShape: 60,\n\t\t\t\tbeforeRemoveShape: 61,\n\t\t\t\tbeforeUpdateShape: 62,\n\t\t\t\twillRenderShapeControls: 63,\n\t\t\t\tmapEditorPointToImagePoint: 64,\n\t\t\t\tmapImagePointToEditorPoint: 65,\n\t\t\t\tenableButtonFlipVertical: 66,\n\t\t\t\tlocale: 3,\n\t\t\t\tcreateShape: 67,\n\t\t\t\teraseShape: 68,\n\t\t\t\tgetMarkupItemDraft: 69,\n\t\t\t\taddMarkupItemDraft: 70,\n\t\t\t\tconfirmMarkupItemDraft: 71,\n\t\t\t\tdiscardMarkupItemDraft: 72,\n\t\t\t\tcreateMarkupItem: 73,\n\t\t\t\tsyncShapes: 74,\n\t\t\t\taddShape: 75,\n\t\t\t\tupdateMarkupShape: 76,\n\t\t\t\tupdateMarkupShapeProperty: 77,\n\t\t\t\tupdateMarkupItemsShapeProperty: 78,\n\t\t\t\tupdateMarkupShapeItems: 79,\n\t\t\t\tgetActiveMarkupItem: 80,\n\t\t\t\thasActiveMarkupItem: 81,\n\t\t\t\tremoveShape: 82,\n\t\t\t\tremoveActiveMarkupItem: 83,\n\t\t\t\tblurShapes: 84,\n\t\t\t\tselectShape: 4,\n\t\t\t\tdeselectMarkupItem: 85,\n\t\t\t\teditMarkupItem: 86,\n\t\t\t\tfinishEditMarkupItem: 87,\n\t\t\t\tremoveMarkupItems: 88,\n\t\t\t\tgetTextShapeRect: 89,\n\t\t\t\tgetMarkupShapeRect: 90,\n\t\t\t\tgetShapesAtPosition: 91,\n\t\t\t\tgetMarkupBetweenPoints: 92\n\t\t\t},\n\t\t\t[-1, -1, -1, -1, -1, -1]\n\t\t);\n\t}\n\n\tget createShape() {\n\t\treturn this.$$.ctx[67];\n\t}\n\n\tget eraseShape() {\n\t\treturn this.$$.ctx[68];\n\t}\n\n\tget getMarkupItemDraft() {\n\t\treturn this.$$.ctx[69];\n\t}\n\n\tget addMarkupItemDraft() {\n\t\treturn this.$$.ctx[70];\n\t}\n\n\tget confirmMarkupItemDraft() {\n\t\treturn this.$$.ctx[71];\n\t}\n\n\tget discardMarkupItemDraft() {\n\t\treturn this.$$.ctx[72];\n\t}\n\n\tget createMarkupItem() {\n\t\treturn this.$$.ctx[73];\n\t}\n\n\tget syncShapes() {\n\t\treturn this.$$.ctx[74];\n\t}\n\n\tget addShape() {\n\t\treturn this.$$.ctx[75];\n\t}\n\n\tget updateMarkupShape() {\n\t\treturn this.$$.ctx[76];\n\t}\n\n\tget updateMarkupShapeProperty() {\n\t\treturn this.$$.ctx[77];\n\t}\n\n\tget updateMarkupItemsShapeProperty() {\n\t\treturn this.$$.ctx[78];\n\t}\n\n\tget updateMarkupShapeItems() {\n\t\treturn this.$$.ctx[79];\n\t}\n\n\tget getActiveMarkupItem() {\n\t\treturn this.$$.ctx[80];\n\t}\n\n\tget hasActiveMarkupItem() {\n\t\treturn this.$$.ctx[81];\n\t}\n\n\tget removeShape() {\n\t\treturn this.$$.ctx[82];\n\t}\n\n\tget removeActiveMarkupItem() {\n\t\treturn this.$$.ctx[83];\n\t}\n\n\tget blurShapes() {\n\t\treturn this.$$.ctx[84];\n\t}\n\n\tget selectShape() {\n\t\treturn this.$$.ctx[4];\n\t}\n\n\tget deselectMarkupItem() {\n\t\treturn this.$$.ctx[85];\n\t}\n\n\tget editMarkupItem() {\n\t\treturn this.$$.ctx[86];\n\t}\n\n\tget finishEditMarkupItem() {\n\t\treturn this.$$.ctx[87];\n\t}\n\n\tget removeMarkupItems() {\n\t\treturn this.$$.ctx[88];\n\t}\n\n\tget getTextShapeRect() {\n\t\treturn this.$$.ctx[89];\n\t}\n\n\tget getMarkupShapeRect() {\n\t\treturn this.$$.ctx[90];\n\t}\n\n\tget getShapesAtPosition() {\n\t\treturn this.$$.ctx[91];\n\t}\n\n\tget getMarkupBetweenPoints() {\n\t\treturn this.$$.ctx[92];\n\t}\n}\n\n/* src/core/ui/components/ShapeStyleEditor.svelte generated by Svelte v3.29.4 */\n\nfunction get_each_context$7(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[10] = list[i];\n\treturn child_ctx;\n}\n\n// (300:4) {#if activeShapeHash}\nfunction create_if_block$9(ctx) {\n\tlet previous_key = /*activeShapeHash*/ ctx[2];\n\tlet key_block_anchor;\n\tlet current;\n\tlet key_block = create_key_block(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tkey_block.c();\n\t\t\tkey_block_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tkey_block.m(target, anchor);\n\t\t\tinsert(target, key_block_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*activeShapeHash*/ 4 && safe_not_equal(previous_key, previous_key = /*activeShapeHash*/ ctx[2])) {\n\t\t\t\tgroup_outros();\n\t\t\t\ttransition_out(key_block, 1, 1, noop$1);\n\t\t\t\tcheck_outros();\n\t\t\t\tkey_block = create_key_block(ctx);\n\t\t\t\tkey_block.c();\n\t\t\t\ttransition_in(key_block);\n\t\t\t\tkey_block.m(key_block_anchor.parentNode, key_block_anchor);\n\t\t\t} else {\n\t\t\t\tkey_block.p(ctx, dirty);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(key_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(key_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(key_block_anchor);\n\t\t\tkey_block.d(detaching);\n\t\t}\n\t};\n}\n\n// (304:16) {#each activeControls as styleControl (styleControl.id) }\nfunction create_each_block$7(key_1, ctx) {\n\tlet li;\n\tlet span;\n\tlet t0_value = localize(/*styleControl*/ ctx[10].componentProps.title, /*locale*/ ctx[0]) + \"\";\n\tlet t0;\n\tlet t1;\n\tlet switch_instance;\n\tlet t2;\n\tlet current;\n\tconst switch_instance_spread_levels = [/*styleControl*/ ctx[10].componentProps];\n\tvar switch_value = /*styleControl*/ ctx[10].component;\n\n\tfunction switch_props(ctx) {\n\t\tlet switch_instance_props = {};\n\n\t\tfor (let i = 0; i < switch_instance_spread_levels.length; i += 1) {\n\t\t\tswitch_instance_props = assign(switch_instance_props, switch_instance_spread_levels[i]);\n\t\t}\n\n\t\treturn { props: switch_instance_props };\n\t}\n\n\tif (switch_value) {\n\t\tswitch_instance = new switch_value(switch_props());\n\t}\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tli = element(\"li\");\n\t\t\tspan = element(\"span\");\n\t\t\tt0 = text(t0_value);\n\t\t\tt1 = space();\n\t\t\tif (switch_instance) create_component(switch_instance.$$.fragment);\n\t\t\tt2 = space();\n\t\t\tattr(span, \"class\", \"DokaShapeStyleLabel\");\n\t\t\tattr(li, \"class\", \"DokaShapeStyle\");\n\t\t\tthis.first = li;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, li, anchor);\n\t\t\tappend(li, span);\n\t\t\tappend(span, t0);\n\t\t\tappend(li, t1);\n\n\t\t\tif (switch_instance) {\n\t\t\t\tmount_component(switch_instance, li, null);\n\t\t\t}\n\n\t\t\tappend(li, t2);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif ((!current || dirty & /*activeControls, locale*/ 9) && t0_value !== (t0_value = localize(/*styleControl*/ ctx[10].componentProps.title, /*locale*/ ctx[0]) + \"\")) set_data(t0, t0_value);\n\n\t\t\tconst switch_instance_changes = (dirty & /*activeControls*/ 8)\n\t\t\t? get_spread_update(switch_instance_spread_levels, [get_spread_object(/*styleControl*/ ctx[10].componentProps)])\n\t\t\t: {};\n\n\t\t\tif (switch_value !== (switch_value = /*styleControl*/ ctx[10].component)) {\n\t\t\t\tif (switch_instance) {\n\t\t\t\t\tgroup_outros();\n\t\t\t\t\tconst old_component = switch_instance;\n\n\t\t\t\t\ttransition_out(old_component.$$.fragment, 1, 0, () => {\n\t\t\t\t\t\tdestroy_component(old_component, 1);\n\t\t\t\t\t});\n\n\t\t\t\t\tcheck_outros();\n\t\t\t\t}\n\n\t\t\t\tif (switch_value) {\n\t\t\t\t\tswitch_instance = new switch_value(switch_props());\n\t\t\t\t\tcreate_component(switch_instance.$$.fragment);\n\t\t\t\t\ttransition_in(switch_instance.$$.fragment, 1);\n\t\t\t\t\tmount_component(switch_instance, li, t2);\n\t\t\t\t} else {\n\t\t\t\t\tswitch_instance = null;\n\t\t\t\t}\n\t\t\t} else if (switch_value) {\n\t\t\t\tswitch_instance.$set(switch_instance_changes);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\tif (switch_instance) transition_in(switch_instance.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tif (switch_instance) transition_out(switch_instance.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(li);\n\t\t\tif (switch_instance) destroy_component(switch_instance);\n\t\t}\n\t};\n}\n\n// (302:8) <Scrollable class=\"DokaShapeStyles\" elasticity={scrollElasticity}>\nfunction create_default_slot$8(ctx) {\n\tlet ul;\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet ul_transition;\n\tlet current;\n\tlet each_value = /*activeControls*/ ctx[3];\n\tconst get_key = ctx => /*styleControl*/ ctx[10].id;\n\n\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\tlet child_ctx = get_each_context$7(ctx, each_value, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block$7(key, child_ctx));\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tul = element(\"ul\");\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\tattr(ul, \"class\", \"DokaShapeStyleList\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, ul, anchor);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(ul, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*activeControls, localize, locale*/ 9) {\n\t\t\t\tconst each_value = /*activeControls*/ ctx[3];\n\t\t\t\tgroup_outros();\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value, each_1_lookup, ul, outro_and_destroy_block, create_each_block$7, null, get_each_context$7);\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\n\t\t\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\t\t\ttransition_in(each_blocks[i]);\n\t\t\t}\n\n\t\t\tadd_render_callback(() => {\n\t\t\t\tif (!ul_transition) ul_transition = create_bidirectional_transition(ul, fade, { duration: 250 }, true);\n\t\t\t\tul_transition.run(1);\n\t\t\t});\n\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\ttransition_out(each_blocks[i]);\n\t\t\t}\n\n\t\t\tif (!ul_transition) ul_transition = create_bidirectional_transition(ul, fade, { duration: 250 }, false);\n\t\t\tul_transition.run(0);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(ul);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d();\n\t\t\t}\n\n\t\t\tif (detaching && ul_transition) ul_transition.end();\n\t\t}\n\t};\n}\n\n// (301:8) {#key activeShapeHash}\nfunction create_key_block(ctx) {\n\tlet scrollable;\n\tlet current;\n\n\tscrollable = new Scrollable({\n\t\t\tprops: {\n\t\t\t\tclass: \"DokaShapeStyles\",\n\t\t\t\telasticity: /*scrollElasticity*/ ctx[1],\n\t\t\t\t$$slots: { default: [create_default_slot$8] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(scrollable.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(scrollable, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst scrollable_changes = {};\n\t\t\tif (dirty & /*scrollElasticity*/ 2) scrollable_changes.elasticity = /*scrollElasticity*/ ctx[1];\n\n\t\t\tif (dirty & /*$$scope, activeControls, locale*/ 8201) {\n\t\t\t\tscrollable_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tscrollable.$set(scrollable_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(scrollable.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(scrollable.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(scrollable, detaching);\n\t\t}\n\t};\n}\n\nfunction create_fragment$x(ctx) {\n\tlet div;\n\tlet current;\n\tlet if_block = /*activeShapeHash*/ ctx[2] && create_if_block$9(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(div, \"class\", \"DokaShapeStyleEditor\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tif (if_block) if_block.m(div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (/*activeShapeHash*/ ctx[2]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*activeShapeHash*/ 4) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block$9(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div, null);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (if_block) if_block.d();\n\t\t}\n\t};\n}\n\nfunction instance$x($$self, $$props, $$invalidate) {\n\tlet { controls = {} } = $$props;\n\tlet { shape = undefined } = $$props;\n\tlet { onchange } = $$props;\n\tlet { locale } = $$props;\n\tlet { scrollElasticity } = $$props;\n\n\tconst getShapeControls = shape => {\n\t\tconst shapeId = shape.id || \"tool\";\n\n\t\tconst activeControls = controlKeys.filter(styleKey => styleKey.split(\"_\").every(styleKey => shape.hasOwnProperty(styleKey) && shapeCanStyle(shape, styleKey))).map(styleKey => {\n\t\t\tconst styleKeys = styleKey.split(\"_\");\n\n\t\t\tconst currentValue = styleKeys.length > 1\n\t\t\t? styleKeys.map(key => shape[key])\n\t\t\t: shape[styleKey];\n\n\t\t\tconst [component, componentProps] = controls[styleKey];\n\n\t\t\tconst options = isFunction(componentProps.options)\n\t\t\t? componentProps.options(shape)\n\t\t\t: componentProps.options;\n\n\t\t\treturn {\n\t\t\t\tid: `${shapeId}_${styleKey}`,\n\t\t\t\tcomponent,\n\t\t\t\tcomponentProps: {\n\t\t\t\t\t...componentProps,\n\t\t\t\t\t// set the options prop\n\t\t\t\t\toptions,\n\t\t\t\t\t// defaults\n\t\t\t\t\tlocale,\n\t\t\t\t\tvalue: currentValue,\n\t\t\t\t\toptionLabelClass: \"DokaButtonLabel\",\n\t\t\t\t\tonchange: detail => {\n\t\t\t\t\t\tconst value = isObject(detail) && !isArray(detail)\n\t\t\t\t\t\t? detail.value\n\t\t\t\t\t\t: detail;\n\n\t\t\t\t\t\t// allow custom changes\n\t\t\t\t\t\tif (componentProps.onchange) componentProps.onchange(value, shape);\n\n\t\t\t\t\t\t// internal change                        \n\t\t\t\t\t\tconst props = styleKeys.length > 1\n\t\t\t\t\t\t? styleKeys.reduce(\n\t\t\t\t\t\t\t\t(prev, key, index) => {\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\t\t[key]: Array.isArray(value) ? value[index] : value\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{}\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: { [styleKey]: value };\n\n\t\t\t\t\t\tonchange(props);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\n\t\treturn activeControls;\n\t};\n\n\t// animate\n\tlet activeShapeHash;\n\n\tlet activeShapeHashPrev;\n\n\t$$self.$$set = $$props => {\n\t\tif (\"controls\" in $$props) $$invalidate(4, controls = $$props.controls);\n\t\tif (\"shape\" in $$props) $$invalidate(5, shape = $$props.shape);\n\t\tif (\"onchange\" in $$props) $$invalidate(6, onchange = $$props.onchange);\n\t\tif (\"locale\" in $$props) $$invalidate(0, locale = $$props.locale);\n\t\tif (\"scrollElasticity\" in $$props) $$invalidate(1, scrollElasticity = $$props.scrollElasticity);\n\t};\n\n\tlet controlKeys;\n\tlet activeControls;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*controls*/ 16) {\n\t\t\t// finds the controls needed to style the selected shape\n\t\t\t $$invalidate(8, controlKeys = Object.keys(controls).filter(key => controls[key]));\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*shape, controlKeys*/ 288) {\n\t\t\t $$invalidate(3, activeControls = shape && controlKeys && shapeCanStyle(shape)\n\t\t\t? getShapeControls(shape)\n\t\t\t: []);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*shape, activeShapeHashPrev*/ 160) {\n\t\t\t if (shape) {\n\t\t\t\tconst hash = Object.keys(shape).join(\"_\");\n\n\t\t\t\tif (hash != activeShapeHashPrev) {\n\t\t\t\t\t$$invalidate(7, activeShapeHashPrev = hash);\n\t\t\t\t\t$$invalidate(2, activeShapeHash = hash);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\treturn [\n\t\tlocale,\n\t\tscrollElasticity,\n\t\tactiveShapeHash,\n\t\tactiveControls,\n\t\tcontrols,\n\t\tshape,\n\t\tonchange\n\t];\n}\n\nclass ShapeStyleEditor extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$x, create_fragment$x, safe_not_equal, {\n\t\t\tcontrols: 4,\n\t\t\tshape: 5,\n\t\t\tonchange: 6,\n\t\t\tlocale: 0,\n\t\t\tscrollElasticity: 1\n\t\t});\n\t}\n}\n\n/* src/core/ui/components/ShapePresetSelect.svelte generated by Svelte v3.29.4 */\n\nfunction create_if_block_1$a(ctx) {\n\tlet icon;\n\tlet current;\n\n\ticon = new Icon({\n\t\t\tprops: {\n\t\t\t\twidth: 16,\n\t\t\t\theight: 16,\n\t\t\t\t$$slots: { default: [create_default_slot$9] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(icon.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(icon, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst icon_changes = {};\n\n\t\t\tif (dirty & /*$$scope, locale*/ 65) {\n\t\t\t\ticon_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon.$set(icon_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(icon, detaching);\n\t\t}\n\t};\n}\n\n// (77:8) <Icon width={16} height={16}>\nfunction create_default_slot$9(ctx) {\n\tlet g;\n\tlet raw_value = /*locale*/ ctx[0].shapeIconButtonSelectSticker + \"\";\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = raw_value;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*locale*/ 1 && raw_value !== (raw_value = /*locale*/ ctx[0].shapeIconButtonSelectSticker + \"\")) g.innerHTML = raw_value;\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (79:8) {#if locale.shapeLabelButtonSelectSticker}\nfunction create_if_block$a(ctx) {\n\tlet span;\n\tlet t_value = /*locale*/ ctx[0].shapeLabelButtonSelectSticker + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*locale*/ 1 && t_value !== (t_value = /*locale*/ ctx[0].shapeLabelButtonSelectSticker + \"\")) set_data(t, t_value);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\nfunction create_fragment$y(ctx) {\n\tlet form;\n\tlet input;\n\tlet t0;\n\tlet label;\n\tlet t1;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tlet if_block0 = /*locale*/ ctx[0].shapeIconButtonSelectSticker && create_if_block_1$a(ctx);\n\tlet if_block1 = /*locale*/ ctx[0].shapeLabelButtonSelectSticker && create_if_block$a(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tform = element(\"form\");\n\t\t\tinput = element(\"input\");\n\t\t\tt0 = space();\n\t\t\tlabel = element(\"label\");\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt1 = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tattr(input, \"id\", /*name*/ ctx[2]);\n\t\t\tattr(input, \"type\", \"file\");\n\t\t\tattr(input, \"accept\", \"image/*\");\n\t\t\tattr(label, \"for\", /*name*/ ctx[2]);\n\t\t\tattr(form, \"class\", \"DokaShapePresetSelect\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, form, anchor);\n\t\t\tappend(form, input);\n\t\t\tappend(form, t0);\n\t\t\tappend(form, label);\n\t\t\tif (if_block0) if_block0.m(label, null);\n\t\t\tappend(label, t1);\n\t\t\tif (if_block1) if_block1.m(label, null);\n\t\t\t/*form_binding*/ ctx[5](form);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = listen(input, \"input\", /*handleFileInput*/ ctx[3]);\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (/*locale*/ ctx[0].shapeIconButtonSelectSticker) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*locale*/ 1) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_1$a(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(label, t1);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (/*locale*/ ctx[0].shapeLabelButtonSelectSticker) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block$a(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\tif_block1.m(label, null);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tif_block1.d(1);\n\t\t\t\tif_block1 = null;\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(form);\n\t\t\tif (if_block0) if_block0.d();\n\t\t\tif (if_block1) if_block1.d();\n\t\t\t/*form_binding*/ ctx[5](null);\n\t\t\tmounted = false;\n\t\t\tdispose();\n\t\t}\n\t};\n}\n\nfunction instance$y($$self, $$props, $$invalidate) {\n\tlet { locale } = $$props;\n\tlet { oninput } = $$props;\n\tconst name = `doka-preset-select-${getUniqueId()}`;\n\tlet formFileInput;\n\n\tconst handleFileInput = e => {\n\t\t// only deal with image files\n\t\tArray.from(e.target.files).filter(isImage).forEach(oninput);\n\n\t\t// reset input when done\n\t\tformFileInput.reset();\n\t};\n\n\tfunction form_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tformFileInput = $$value;\n\t\t\t$$invalidate(1, formFileInput);\n\t\t});\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"locale\" in $$props) $$invalidate(0, locale = $$props.locale);\n\t\tif (\"oninput\" in $$props) $$invalidate(4, oninput = $$props.oninput);\n\t};\n\n\treturn [locale, formFileInput, name, handleFileInput, oninput, form_binding];\n}\n\nclass ShapePresetSelect extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\t\tinit(this, options, instance$y, create_fragment$y, safe_not_equal, { locale: 0, oninput: 4 });\n\t}\n}\n\n/* src/core/ui/components/DragButton.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$z(ctx) {\n\tlet button;\n\tlet mounted;\n\tlet dispose;\n\n\treturn {\n\t\tc() {\n\t\t\tbutton = element(\"button\");\n\t\t\tattr(button, \"class\", \"DokaDragButton\");\n\t\t\tattr(button, \"title\", /*title*/ ctx[1]);\n\t\t\tbutton.disabled = /*disabled*/ ctx[2];\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, button, anchor);\n\t\t\tbutton.innerHTML = /*html*/ ctx[0];\n\t\t\t/*button_binding*/ ctx[9](button);\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = listen(button, \"pointerdown\", /*handleDown*/ ctx[4]);\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*html*/ 1) button.innerHTML = /*html*/ ctx[0];\n\t\t\tif (dirty & /*title*/ 2) {\n\t\t\t\tattr(button, \"title\", /*title*/ ctx[1]);\n\t\t\t}\n\n\t\t\tif (dirty & /*disabled*/ 4) {\n\t\t\t\tbutton.disabled = /*disabled*/ ctx[2];\n\t\t\t}\n\t\t},\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(button);\n\t\t\t/*button_binding*/ ctx[9](null);\n\t\t\tmounted = false;\n\t\t\tdispose();\n\t\t}\n\t};\n}\n\nfunction instance$z($$self, $$props, $$invalidate) {\n\tlet { html } = $$props;\n\tlet { title } = $$props;\n\tlet { onclick } = $$props;\n\tlet { disabled = false } = $$props;\n\tlet { ongrab = noop } = $$props;\n\tlet { ondrag = noop } = $$props;\n\tlet { ondrop = noop } = $$props;\n\tlet element;\n\tconst isOverButton = e => vectorDistanceSquared(downPosition, vectorCreate(e.pageX, e.pageY)) < 256;\n\tlet downPosition;\n\n\tconst handleDown = e => {\n\t\tdownPosition = vectorCreate(e.pageX, e.pageY);\n\t\tongrab(e);\n\t\tdocument.documentElement.addEventListener(\"pointermove\", handleMove);\n\t\tdocument.documentElement.addEventListener(\"pointerup\", handleUp);\n\t};\n\n\tconst handleUp = e => {\n\t\tdocument.documentElement.removeEventListener(\"pointermove\", handleMove);\n\t\tdocument.documentElement.removeEventListener(\"pointerup\", handleUp);\n\t\tconst upPosition = vectorCreate(e.pageX, e.pageY);\n\n\t\t// must have moved enough distance to drop\n\t\tif (vectorDistanceSquared(downPosition, upPosition) < 32) return onclick(e);\n\n\t\t// cant drop in button\n\t\tif (isOverButton(e)) return;\n\n\t\t// was dragging\n\t\tondrop(e);\n\t};\n\n\tconst handleMove = e => {\n\t\t// must have moved enough distance from button\n\t\tif (isOverButton(e)) return;\n\n\t\t// dragging out of button\n\t\tondrag(e);\n\t};\n\n\tfunction button_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\telement = $$value;\n\t\t\t$$invalidate(3, element);\n\t\t});\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"html\" in $$props) $$invalidate(0, html = $$props.html);\n\t\tif (\"title\" in $$props) $$invalidate(1, title = $$props.title);\n\t\tif (\"onclick\" in $$props) $$invalidate(5, onclick = $$props.onclick);\n\t\tif (\"disabled\" in $$props) $$invalidate(2, disabled = $$props.disabled);\n\t\tif (\"ongrab\" in $$props) $$invalidate(6, ongrab = $$props.ongrab);\n\t\tif (\"ondrag\" in $$props) $$invalidate(7, ondrag = $$props.ondrag);\n\t\tif (\"ondrop\" in $$props) $$invalidate(8, ondrop = $$props.ondrop);\n\t};\n\n\treturn [\n\t\thtml,\n\t\ttitle,\n\t\tdisabled,\n\t\telement,\n\t\thandleDown,\n\t\tonclick,\n\t\tongrab,\n\t\tondrag,\n\t\tondrop,\n\t\tbutton_binding\n\t];\n}\n\nclass DragButton extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$z, create_fragment$z, safe_not_equal, {\n\t\t\thtml: 0,\n\t\t\ttitle: 1,\n\t\t\tonclick: 5,\n\t\t\tdisabled: 2,\n\t\t\tongrab: 6,\n\t\t\tondrag: 7,\n\t\t\tondrop: 8\n\t\t});\n\t}\n}\n\n/* src/core/ui/components/ShapePresetsList.svelte generated by Svelte v3.29.4 */\n\nfunction get_each_context$8(ctx, list, i) {\n\tconst child_ctx = ctx.slice();\n\tchild_ctx[14] = list[i];\n\treturn child_ctx;\n}\n\n// (56:4) {#each presets as preset (preset.id)}\nfunction create_each_block$8(key_1, ctx) {\n\tlet li;\n\tlet dragbutton;\n\tlet t;\n\tlet didMountPresetThumb_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\tfunction func(...args) {\n\t\treturn /*func*/ ctx[9](/*preset*/ ctx[14], ...args);\n\t}\n\n\tfunction func_1(...args) {\n\t\treturn /*func_1*/ ctx[10](/*preset*/ ctx[14], ...args);\n\t}\n\n\tfunction func_2(...args) {\n\t\treturn /*func_2*/ ctx[11](/*preset*/ ctx[14], ...args);\n\t}\n\n\tfunction func_3(...args) {\n\t\treturn /*func_3*/ ctx[12](/*preset*/ ctx[14], ...args);\n\t}\n\n\tdragbutton = new DragButton({\n\t\t\tprops: {\n\t\t\t\tonclick: func,\n\t\t\t\tongrab: func_1,\n\t\t\t\tondrag: func_2,\n\t\t\t\tondrop: func_3,\n\t\t\t\tdisabled: /*disabled*/ ctx[1] || /*preset*/ ctx[14].disabled,\n\t\t\t\ttitle: /*preset*/ ctx[14].title,\n\t\t\t\thtml: /*preset*/ ctx[14].thumb\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tkey: key_1,\n\t\tfirst: null,\n\t\tc() {\n\t\t\tli = element(\"li\");\n\t\t\tcreate_component(dragbutton.$$.fragment);\n\t\t\tt = space();\n\t\t\tattr(li, \"class\", \"DokaShapePreset\");\n\t\t\tattr(li, \"style\", /*style*/ ctx[6]);\n\t\t\tthis.first = li;\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, li, anchor);\n\t\t\tmount_component(dragbutton, li, null);\n\t\t\tappend(li, t);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = action_destroyer(didMountPresetThumb_action = /*didMountPresetThumb*/ ctx[8].call(null, li, /*preset*/ ctx[14]));\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(new_ctx, dirty) {\n\t\t\tctx = new_ctx;\n\t\t\tconst dragbutton_changes = {};\n\t\t\tif (dirty & /*onclickpreset, presets*/ 5) dragbutton_changes.onclick = func;\n\t\t\tif (dirty & /*ongrabpreset, presets*/ 9) dragbutton_changes.ongrab = func_1;\n\t\t\tif (dirty & /*ondragpreset, presets*/ 17) dragbutton_changes.ondrag = func_2;\n\t\t\tif (dirty & /*ondroppreset, presets*/ 33) dragbutton_changes.ondrop = func_3;\n\t\t\tif (dirty & /*disabled, presets*/ 3) dragbutton_changes.disabled = /*disabled*/ ctx[1] || /*preset*/ ctx[14].disabled;\n\t\t\tif (dirty & /*presets*/ 1) dragbutton_changes.title = /*preset*/ ctx[14].title;\n\t\t\tif (dirty & /*presets*/ 1) dragbutton_changes.html = /*preset*/ ctx[14].thumb;\n\t\t\tdragbutton.$set(dragbutton_changes);\n\n\t\t\tif (!current || dirty & /*style*/ 64) {\n\t\t\t\tattr(li, \"style\", /*style*/ ctx[6]);\n\t\t\t}\n\n\t\t\tif (didMountPresetThumb_action && is_function(didMountPresetThumb_action.update) && dirty & /*presets*/ 1) didMountPresetThumb_action.update.call(null, /*preset*/ ctx[14]);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(dragbutton.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(dragbutton.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(li);\n\t\t\tdestroy_component(dragbutton);\n\t\t\tmounted = false;\n\t\t\tdispose();\n\t\t}\n\t};\n}\n\nfunction create_fragment$A(ctx) {\n\tlet ul;\n\tlet each_blocks = [];\n\tlet each_1_lookup = new Map();\n\tlet current;\n\tlet each_value = /*presets*/ ctx[0];\n\tconst get_key = ctx => /*preset*/ ctx[14].id;\n\n\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\tlet child_ctx = get_each_context$8(ctx, each_value, i);\n\t\tlet key = get_key(child_ctx);\n\t\teach_1_lookup.set(key, each_blocks[i] = create_each_block$8(key, child_ctx));\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tul = element(\"ul\");\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].c();\n\t\t\t}\n\n\t\t\tattr(ul, \"class\", \"DokaShapePresetsList\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, ul, anchor);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].m(ul, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tif (dirty & /*style, presets, onclickpreset, ongrabpreset, ondragpreset, ondroppreset, disabled*/ 127) {\n\t\t\t\tconst each_value = /*presets*/ ctx[0];\n\t\t\t\tgroup_outros();\n\t\t\t\teach_blocks = update_keyed_each(each_blocks, dirty, get_key, 1, ctx, each_value, each_1_lookup, ul, outro_and_destroy_block, create_each_block$8, null, get_each_context$8);\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\n\t\t\tfor (let i = 0; i < each_value.length; i += 1) {\n\t\t\t\ttransition_in(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\ttransition_out(each_blocks[i]);\n\t\t\t}\n\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(ul);\n\n\t\t\tfor (let i = 0; i < each_blocks.length; i += 1) {\n\t\t\t\teach_blocks[i].d();\n\t\t\t}\n\t\t}\n\t};\n}\n\nfunction instance$A($$self, $$props, $$invalidate) {\n\tlet $anim;\n\tlet { presets } = $$props;\n\tlet { disabled = undefined } = $$props;\n\tlet { onclickpreset } = $$props;\n\tlet { ongrabpreset } = $$props;\n\tlet { ondragpreset } = $$props;\n\tlet { ondroppreset } = $$props;\n\tconst anim = tweened(0, { duration: 300 });\n\tcomponent_subscribe($$self, anim, value => $$invalidate(13, $anim = value));\n\tconst didMountPresetThumb = (element, item) => item.mount && item.mount(element.firstChild, item);\n\tonMount(() => anim.set(1));\n\tconst func = preset => onclickpreset(preset.id);\n\tconst func_1 = (preset, e) => ongrabpreset(preset.id, e);\n\tconst func_2 = (preset, e) => ondragpreset(preset.id, e);\n\tconst func_3 = (preset, e) => ondroppreset(preset.id, e);\n\n\t$$self.$$set = $$props => {\n\t\tif (\"presets\" in $$props) $$invalidate(0, presets = $$props.presets);\n\t\tif (\"disabled\" in $$props) $$invalidate(1, disabled = $$props.disabled);\n\t\tif (\"onclickpreset\" in $$props) $$invalidate(2, onclickpreset = $$props.onclickpreset);\n\t\tif (\"ongrabpreset\" in $$props) $$invalidate(3, ongrabpreset = $$props.ongrabpreset);\n\t\tif (\"ondragpreset\" in $$props) $$invalidate(4, ondragpreset = $$props.ondragpreset);\n\t\tif (\"ondroppreset\" in $$props) $$invalidate(5, ondroppreset = $$props.ondroppreset);\n\t};\n\n\tlet style;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*$anim*/ 8192) {\n\t\t\t $$invalidate(6, style = `opacity:${$anim}`);\n\t\t}\n\t};\n\n\treturn [\n\t\tpresets,\n\t\tdisabled,\n\t\tonclickpreset,\n\t\tongrabpreset,\n\t\tondragpreset,\n\t\tondroppreset,\n\t\tstyle,\n\t\tanim,\n\t\tdidMountPresetThumb,\n\t\tfunc,\n\t\tfunc_1,\n\t\tfunc_2,\n\t\tfunc_3\n\t];\n}\n\nclass ShapePresetsList extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$A, create_fragment$A, safe_not_equal, {\n\t\t\tpresets: 0,\n\t\t\tdisabled: 1,\n\t\t\tonclickpreset: 2,\n\t\t\tongrabpreset: 3,\n\t\t\tondragpreset: 4,\n\t\t\tondroppreset: 5\n\t\t});\n\t}\n}\n\nvar isSVGMarkup = (str) => /<svg /.test(str);\n\n/* src/core/ui/components/ShapePresetsPalette.svelte generated by Svelte v3.29.4 */\n\nfunction create_if_block_6$3(ctx) {\n\tlet shapepresetselect;\n\tlet current;\n\n\tshapepresetselect = new ShapePresetSelect({\n\t\t\tprops: {\n\t\t\t\tlocale: /*locale*/ ctx[0],\n\t\t\t\toninput: /*onaddpreset*/ ctx[3]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapepresetselect.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapepresetselect, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapepresetselect_changes = {};\n\t\t\tif (dirty & /*locale*/ 1) shapepresetselect_changes.locale = /*locale*/ ctx[0];\n\t\t\tif (dirty & /*onaddpreset*/ 8) shapepresetselect_changes.oninput = /*onaddpreset*/ ctx[3];\n\t\t\tshapepresetselect.$set(shapepresetselect_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapepresetselect.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapepresetselect.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapepresetselect, detaching);\n\t\t}\n\t};\n}\n\n// (180:4) {#if shouldRenderPresets}\nfunction create_if_block$b(ctx) {\n\tlet current_block_type_index;\n\tlet if_block;\n\tlet if_block_anchor;\n\tlet current;\n\tconst if_block_creators = [create_if_block_1$b, create_else_block$3];\n\tconst if_blocks = [];\n\n\tfunction select_block_type_1(ctx, dirty) {\n\t\tif (/*shouldGroupPresets*/ ctx[9]) return 0;\n\t\treturn 1;\n\t}\n\n\tcurrent_block_type_index = select_block_type_1(ctx);\n\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tif_block.c();\n\t\t\tif_block_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif_blocks[current_block_type_index].m(target, anchor);\n\t\t\tinsert(target, if_block_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tlet previous_block_index = current_block_type_index;\n\t\t\tcurrent_block_type_index = select_block_type_1(ctx);\n\n\t\t\tif (current_block_type_index === previous_block_index) {\n\t\t\t\tif_blocks[current_block_type_index].p(ctx, dirty);\n\t\t\t} else {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_blocks[previous_block_index], 1, 1, () => {\n\t\t\t\t\tif_blocks[previous_block_index] = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t\tif_block = if_blocks[current_block_type_index];\n\n\t\t\t\tif (!if_block) {\n\t\t\t\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t}\n\n\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\tif_block.m(if_block_anchor.parentNode, if_block_anchor);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif_blocks[current_block_type_index].d(detaching);\n\t\t\tif (detaching) detach(if_block_anchor);\n\t\t}\n\t};\n}\n\n// (234:8) {:else}\nfunction create_else_block$3(ctx) {\n\tlet div;\n\tlet t;\n\tlet scrollable;\n\tlet current;\n\tlet if_block = /*enableSelectImage*/ ctx[2] && create_if_block_5$3(ctx);\n\n\tscrollable = new Scrollable({\n\t\t\tprops: {\n\t\t\t\tscrollAutoCancel: /*shouldRenderPresets*/ ctx[8],\n\t\t\t\telasticity: /*scrollElasticity*/ ctx[1],\n\t\t\t\t$$slots: { default: [create_default_slot_4$1] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tt = space();\n\t\t\tcreate_component(scrollable.$$.fragment);\n\t\t\tattr(div, \"class\", \"DokaShapePresetsFlat\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tif (if_block) if_block.m(div, null);\n\t\t\tappend(div, t);\n\t\t\tmount_component(scrollable, div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*enableSelectImage*/ ctx[2]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*enableSelectImage*/ 4) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_5$3(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div, t);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tconst scrollable_changes = {};\n\t\t\tif (dirty & /*shouldRenderPresets*/ 256) scrollable_changes.scrollAutoCancel = /*shouldRenderPresets*/ ctx[8];\n\t\t\tif (dirty & /*scrollElasticity*/ 2) scrollable_changes.elasticity = /*scrollElasticity*/ ctx[1];\n\n\t\t\tif (dirty & /*$$scope, presetsMapped, onaddpreset, ongrabpreset, ondragpreset, ondroppreset*/ 268435704) {\n\t\t\t\tscrollable_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tscrollable.$set(scrollable_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\ttransition_in(scrollable.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\ttransition_out(scrollable.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (if_block) if_block.d();\n\t\t\tdestroy_component(scrollable);\n\t\t}\n\t};\n}\n\n// (183:8) {#if shouldGroupPresets}\nfunction create_if_block_1$b(ctx) {\n\tlet div1;\n\tlet div0;\n\tlet t0;\n\tlet tablist;\n\tlet t1;\n\tlet tabpanels;\n\tlet current;\n\tlet if_block = /*enableSelectImage*/ ctx[2] && create_if_block_4$4(ctx);\n\n\tconst tablist_spread_levels = [\n\t\t{ class: \"DokaControlList\" },\n\t\t{ tabs: /*tabs*/ ctx[10] },\n\t\t/*tabsConfig*/ ctx[13],\n\t\t{ layout: \"compact\" }\n\t];\n\n\tlet tablist_props = {\n\t\t$$slots: {\n\t\t\tdefault: [\n\t\t\t\tcreate_default_slot_2$5,\n\t\t\t\t({ tab }) => ({ 27: tab }),\n\t\t\t\t({ tab }) => tab ? 134217728 : 0\n\t\t\t]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tfor (let i = 0; i < tablist_spread_levels.length; i += 1) {\n\t\ttablist_props = assign(tablist_props, tablist_spread_levels[i]);\n\t}\n\n\ttablist = new TabList({ props: tablist_props });\n\ttablist.$on(\"select\", /*select_handler*/ ctx[16]);\n\n\tconst tabpanels_spread_levels = [\n\t\t{ class: \"DokaControlPanels\" },\n\t\t{ panelClass: \"DokaControlPanel\" },\n\t\t{ panels: /*panels*/ ctx[14] },\n\t\t/*tabsConfig*/ ctx[13]\n\t];\n\n\tlet tabpanels_props = {\n\t\t$$slots: {\n\t\t\tdefault: [\n\t\t\t\tcreate_default_slot$a,\n\t\t\t\t({ panel, panelIsActive }) => ({ 25: panel, 26: panelIsActive }),\n\t\t\t\t({ panel, panelIsActive }) => (panel ? 33554432 : 0) | (panelIsActive ? 67108864 : 0)\n\t\t\t]\n\t\t},\n\t\t$$scope: { ctx }\n\t};\n\n\tfor (let i = 0; i < tabpanels_spread_levels.length; i += 1) {\n\t\ttabpanels_props = assign(tabpanels_props, tabpanels_spread_levels[i]);\n\t}\n\n\ttabpanels = new TabPanels({ props: tabpanels_props });\n\n\treturn {\n\t\tc() {\n\t\t\tdiv1 = element(\"div\");\n\t\t\tdiv0 = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tt0 = space();\n\t\t\tcreate_component(tablist.$$.fragment);\n\t\t\tt1 = space();\n\t\t\tcreate_component(tabpanels.$$.fragment);\n\t\t\tattr(div0, \"class\", \"DokaShapePresetsGroups\");\n\t\t\tattr(div1, \"class\", \"DokaShapePresetsGrouped\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div1, anchor);\n\t\t\tappend(div1, div0);\n\t\t\tif (if_block) if_block.m(div0, null);\n\t\t\tappend(div0, t0);\n\t\t\tmount_component(tablist, div0, null);\n\t\t\tappend(div1, t1);\n\t\t\tmount_component(tabpanels, div1, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*enableSelectImage*/ ctx[2]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*enableSelectImage*/ 4) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_4$4(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div0, t0);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tconst tablist_changes = (dirty & /*tabs, tabsConfig*/ 9216)\n\t\t\t? get_spread_update(tablist_spread_levels, [\n\t\t\t\t\ttablist_spread_levels[0],\n\t\t\t\t\tdirty & /*tabs*/ 1024 && { tabs: /*tabs*/ ctx[10] },\n\t\t\t\t\tdirty & /*tabsConfig*/ 8192 && get_spread_object(/*tabsConfig*/ ctx[13]),\n\t\t\t\t\ttablist_spread_levels[3]\n\t\t\t\t])\n\t\t\t: {};\n\n\t\t\tif (dirty & /*$$scope, tab*/ 402653184) {\n\t\t\t\ttablist_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ttablist.$set(tablist_changes);\n\n\t\t\tconst tabpanels_changes = (dirty & /*panels, tabsConfig*/ 24576)\n\t\t\t? get_spread_update(tabpanels_spread_levels, [\n\t\t\t\t\ttabpanels_spread_levels[0],\n\t\t\t\t\ttabpanels_spread_levels[1],\n\t\t\t\t\tdirty & /*panels*/ 16384 && { panels: /*panels*/ ctx[14] },\n\t\t\t\t\tdirty & /*tabsConfig*/ 8192 && get_spread_object(/*tabsConfig*/ ctx[13])\n\t\t\t\t])\n\t\t\t: {};\n\n\t\t\tif (dirty & /*$$scope, panelIsActive, shouldRenderPresets, scrollElasticity, presetTabs, panel, onaddpreset, ongrabpreset, ondragpreset, ondroppreset*/ 369101178) {\n\t\t\t\ttabpanels_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ttabpanels.$set(tabpanels_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\ttransition_in(tablist.$$.fragment, local);\n\t\t\ttransition_in(tabpanels.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\ttransition_out(tablist.$$.fragment, local);\n\t\t\ttransition_out(tabpanels.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div1);\n\t\t\tif (if_block) if_block.d();\n\t\t\tdestroy_component(tablist);\n\t\t\tdestroy_component(tabpanels);\n\t\t}\n\t};\n}\n\n// (238:12) {#if enableSelectImage}\nfunction create_if_block_5$3(ctx) {\n\tlet shapepresetselect;\n\tlet current;\n\n\tshapepresetselect = new ShapePresetSelect({\n\t\t\tprops: {\n\t\t\t\tlocale: /*locale*/ ctx[0],\n\t\t\t\toninput: /*onaddpreset*/ ctx[3]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapepresetselect.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapepresetselect, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapepresetselect_changes = {};\n\t\t\tif (dirty & /*locale*/ 1) shapepresetselect_changes.locale = /*locale*/ ctx[0];\n\t\t\tif (dirty & /*onaddpreset*/ 8) shapepresetselect_changes.oninput = /*onaddpreset*/ ctx[3];\n\t\t\tshapepresetselect.$set(shapepresetselect_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapepresetselect.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapepresetselect.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapepresetselect, detaching);\n\t\t}\n\t};\n}\n\n// (241:12) <Scrollable scrollAutoCancel={shouldRenderPresets} elasticity={scrollElasticity}>\nfunction create_default_slot_4$1(ctx) {\n\tlet shapepresetslist;\n\tlet current;\n\n\tshapepresetslist = new ShapePresetsList({\n\t\t\tprops: {\n\t\t\t\tpresets: /*presetsMapped*/ ctx[7],\n\t\t\t\tonclickpreset: /*onaddpreset*/ ctx[3],\n\t\t\t\tongrabpreset: /*ongrabpreset*/ ctx[4],\n\t\t\t\tondragpreset: /*ondragpreset*/ ctx[5],\n\t\t\t\tondroppreset: /*ondroppreset*/ ctx[6]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapepresetslist.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapepresetslist, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapepresetslist_changes = {};\n\t\t\tif (dirty & /*presetsMapped*/ 128) shapepresetslist_changes.presets = /*presetsMapped*/ ctx[7];\n\t\t\tif (dirty & /*onaddpreset*/ 8) shapepresetslist_changes.onclickpreset = /*onaddpreset*/ ctx[3];\n\t\t\tif (dirty & /*ongrabpreset*/ 16) shapepresetslist_changes.ongrabpreset = /*ongrabpreset*/ ctx[4];\n\t\t\tif (dirty & /*ondragpreset*/ 32) shapepresetslist_changes.ondragpreset = /*ondragpreset*/ ctx[5];\n\t\t\tif (dirty & /*ondroppreset*/ 64) shapepresetslist_changes.ondroppreset = /*ondroppreset*/ ctx[6];\n\t\t\tshapepresetslist.$set(shapepresetslist_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapepresetslist.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapepresetslist.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapepresetslist, detaching);\n\t\t}\n\t};\n}\n\n// (188:20) {#if enableSelectImage}\nfunction create_if_block_4$4(ctx) {\n\tlet shapepresetselect;\n\tlet current;\n\n\tshapepresetselect = new ShapePresetSelect({\n\t\t\tprops: {\n\t\t\t\tlocale: /*locale*/ ctx[0],\n\t\t\t\toninput: /*onaddpreset*/ ctx[3]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapepresetselect.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapepresetselect, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapepresetselect_changes = {};\n\t\t\tif (dirty & /*locale*/ 1) shapepresetselect_changes.locale = /*locale*/ ctx[0];\n\t\t\tif (dirty & /*onaddpreset*/ 8) shapepresetselect_changes.oninput = /*onaddpreset*/ ctx[3];\n\t\t\tshapepresetselect.$set(shapepresetselect_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapepresetselect.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapepresetselect.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapepresetselect, detaching);\n\t\t}\n\t};\n}\n\n// (196:24) {#if tab.icon }\nfunction create_if_block_3$4(ctx) {\n\tlet icon;\n\tlet current;\n\n\ticon = new Icon({\n\t\t\tprops: {\n\t\t\t\t$$slots: { default: [create_default_slot_3$5] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(icon.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(icon, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst icon_changes = {};\n\n\t\t\tif (dirty & /*$$scope, tab*/ 402653184) {\n\t\t\t\ticon_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon.$set(icon_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(icon, detaching);\n\t\t}\n\t};\n}\n\n// (197:24) <Icon>\nfunction create_default_slot_3$5(ctx) {\n\tlet g;\n\tlet raw_value = /*tab*/ ctx[27].icon + \"\";\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = raw_value;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*tab*/ 134217728 && raw_value !== (raw_value = /*tab*/ ctx[27].icon + \"\")) g.innerHTML = raw_value;\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (199:24) {#if !tab.hideLabel}\nfunction create_if_block_2$7(ctx) {\n\tlet span;\n\tlet t_value = /*tab*/ ctx[27].label + \"\";\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tspan = element(\"span\");\n\t\t\tt = text(t_value);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, span, anchor);\n\t\t\tappend(span, t);\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty & /*tab*/ 134217728 && t_value !== (t_value = /*tab*/ ctx[27].label + \"\")) set_data(t, t_value);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(span);\n\t\t}\n\t};\n}\n\n// (192:20) <TabList class=\"DokaControlList\"                          {tabs} {...tabsConfig}                          layout=\"compact\"                         on:select={({ detail }) => tabSelected = detail} let:tab={tab}>\nfunction create_default_slot_2$5(ctx) {\n\tlet t;\n\tlet if_block1_anchor;\n\tlet current;\n\tlet if_block0 = /*tab*/ ctx[27].icon && create_if_block_3$4(ctx);\n\tlet if_block1 = !/*tab*/ ctx[27].hideLabel && create_if_block_2$7(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tif (if_block0) if_block0.c();\n\t\t\tt = space();\n\t\t\tif (if_block1) if_block1.c();\n\t\t\tif_block1_anchor = empty();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tif (if_block0) if_block0.m(target, anchor);\n\t\t\tinsert(target, t, anchor);\n\t\t\tif (if_block1) if_block1.m(target, anchor);\n\t\t\tinsert(target, if_block1_anchor, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*tab*/ ctx[27].icon) {\n\t\t\t\tif (if_block0) {\n\t\t\t\t\tif_block0.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty & /*tab*/ 134217728) {\n\t\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block0 = create_if_block_3$4(ctx);\n\t\t\t\t\tif_block0.c();\n\t\t\t\t\ttransition_in(if_block0, 1);\n\t\t\t\t\tif_block0.m(t.parentNode, t);\n\t\t\t\t}\n\t\t\t} else if (if_block0) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block0, 1, 1, () => {\n\t\t\t\t\tif_block0 = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif (!/*tab*/ ctx[27].hideLabel) {\n\t\t\t\tif (if_block1) {\n\t\t\t\t\tif_block1.p(ctx, dirty);\n\t\t\t\t} else {\n\t\t\t\t\tif_block1 = create_if_block_2$7(ctx);\n\t\t\t\t\tif_block1.c();\n\t\t\t\t\tif_block1.m(if_block1_anchor.parentNode, if_block1_anchor);\n\t\t\t\t}\n\t\t\t} else if (if_block1) {\n\t\t\t\tif_block1.d(1);\n\t\t\t\tif_block1 = null;\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block0);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block0);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (if_block0) if_block0.d(detaching);\n\t\t\tif (detaching) detach(t);\n\t\t\tif (if_block1) if_block1.d(detaching);\n\t\t\tif (detaching) detach(if_block1_anchor);\n\t\t}\n\t};\n}\n\n// (214:16) <Scrollable                      scroll={panelIsActive ? { scrollOffset: 0, animate: false } : undefined}                     scrollAutoCancel={shouldRenderPresets}                      elasticity={scrollElasticity}>\nfunction create_default_slot_1$7(ctx) {\n\tlet shapepresetslist;\n\tlet current;\n\n\tshapepresetslist = new ShapePresetsList({\n\t\t\tprops: {\n\t\t\t\tpresets: /*presetTabs*/ ctx[11][/*panel*/ ctx[25]].items,\n\t\t\t\tdisabled: /*presetTabs*/ ctx[11][/*panel*/ ctx[25]].disabled,\n\t\t\t\tonclickpreset: /*onaddpreset*/ ctx[3],\n\t\t\t\tongrabpreset: /*ongrabpreset*/ ctx[4],\n\t\t\t\tondragpreset: /*ondragpreset*/ ctx[5],\n\t\t\t\tondroppreset: /*ondroppreset*/ ctx[6]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapepresetslist.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapepresetslist, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapepresetslist_changes = {};\n\t\t\tif (dirty & /*presetTabs, panel*/ 33556480) shapepresetslist_changes.presets = /*presetTabs*/ ctx[11][/*panel*/ ctx[25]].items;\n\t\t\tif (dirty & /*presetTabs, panel*/ 33556480) shapepresetslist_changes.disabled = /*presetTabs*/ ctx[11][/*panel*/ ctx[25]].disabled;\n\t\t\tif (dirty & /*onaddpreset*/ 8) shapepresetslist_changes.onclickpreset = /*onaddpreset*/ ctx[3];\n\t\t\tif (dirty & /*ongrabpreset*/ 16) shapepresetslist_changes.ongrabpreset = /*ongrabpreset*/ ctx[4];\n\t\t\tif (dirty & /*ondragpreset*/ 32) shapepresetslist_changes.ondragpreset = /*ondragpreset*/ ctx[5];\n\t\t\tif (dirty & /*ondroppreset*/ 64) shapepresetslist_changes.ondroppreset = /*ondroppreset*/ ctx[6];\n\t\t\tshapepresetslist.$set(shapepresetslist_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapepresetslist.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapepresetslist.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapepresetslist, detaching);\n\t\t}\n\t};\n}\n\n// (206:12) <TabPanels                  class=\"DokaControlPanels\"                  panelClass=\"DokaControlPanel\"                  {panels}                  {...tabsConfig}                  let:panel                  let:panelIsActive>\nfunction create_default_slot$a(ctx) {\n\tlet scrollable;\n\tlet current;\n\n\tscrollable = new Scrollable({\n\t\t\tprops: {\n\t\t\t\tscroll: /*panelIsActive*/ ctx[26]\n\t\t\t\t? { scrollOffset: 0, animate: false }\n\t\t\t\t: undefined,\n\t\t\t\tscrollAutoCancel: /*shouldRenderPresets*/ ctx[8],\n\t\t\t\telasticity: /*scrollElasticity*/ ctx[1],\n\t\t\t\t$$slots: { default: [create_default_slot_1$7] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(scrollable.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(scrollable, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst scrollable_changes = {};\n\n\t\t\tif (dirty & /*panelIsActive*/ 67108864) scrollable_changes.scroll = /*panelIsActive*/ ctx[26]\n\t\t\t? { scrollOffset: 0, animate: false }\n\t\t\t: undefined;\n\n\t\t\tif (dirty & /*shouldRenderPresets*/ 256) scrollable_changes.scrollAutoCancel = /*shouldRenderPresets*/ ctx[8];\n\t\t\tif (dirty & /*scrollElasticity*/ 2) scrollable_changes.elasticity = /*scrollElasticity*/ ctx[1];\n\n\t\t\tif (dirty & /*$$scope, presetTabs, panel, onaddpreset, ongrabpreset, ondragpreset, ondroppreset*/ 301992056) {\n\t\t\t\tscrollable_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tscrollable.$set(scrollable_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(scrollable.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(scrollable.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(scrollable, detaching);\n\t\t}\n\t};\n}\n\nfunction create_fragment$B(ctx) {\n\tlet div;\n\tlet current_block_type_index;\n\tlet if_block;\n\tlet current;\n\tconst if_block_creators = [create_if_block$b, create_if_block_6$3];\n\tconst if_blocks = [];\n\n\tfunction select_block_type(ctx, dirty) {\n\t\tif (/*shouldRenderPresets*/ ctx[8]) return 0;\n\t\tif (/*enableSelectImage*/ ctx[2]) return 1;\n\t\treturn -1;\n\t}\n\n\tif (~(current_block_type_index = select_block_type(ctx))) {\n\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(div, \"class\", \"DokaShapePresetsPalette\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (~current_block_type_index) {\n\t\t\t\tif_blocks[current_block_type_index].m(div, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tlet previous_block_index = current_block_type_index;\n\t\t\tcurrent_block_type_index = select_block_type(ctx);\n\n\t\t\tif (current_block_type_index === previous_block_index) {\n\t\t\t\tif (~current_block_type_index) {\n\t\t\t\t\tif_blocks[current_block_type_index].p(ctx, dirty);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tgroup_outros();\n\n\t\t\t\t\ttransition_out(if_blocks[previous_block_index], 1, 1, () => {\n\t\t\t\t\t\tif_blocks[previous_block_index] = null;\n\t\t\t\t\t});\n\n\t\t\t\t\tcheck_outros();\n\t\t\t\t}\n\n\t\t\t\tif (~current_block_type_index) {\n\t\t\t\t\tif_block = if_blocks[current_block_type_index];\n\n\t\t\t\t\tif (!if_block) {\n\t\t\t\t\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t\t\t\t\t\tif_block.c();\n\t\t\t\t\t}\n\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div, null);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = null;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\n\t\t\tif (~current_block_type_index) {\n\t\t\t\tif_blocks[current_block_type_index].d();\n\t\t\t}\n\t\t}\n\t};\n}\n\nfunction instance$B($$self, $$props, $$invalidate) {\n\tlet { locale } = $$props;\n\tlet { presets } = $$props;\n\tlet { scrollElasticity } = $$props;\n\tlet { enableSelectImage = true } = $$props;\n\tlet { onaddpreset = noop } = $$props;\n\tlet { ongrabpreset = noop } = $$props;\n\tlet { ondragpreset = noop } = $$props;\n\tlet { ondroppreset = noop } = $$props;\n\tconst uid = `doka-presets-${getUniqueId()}`;\n\tconst isPresetGroup = item => isArray(item) && isString(item[0]) && isArray(item[1]);\n\n\tconst getPresetThumb = (value, alt = \"\") => {\n\t\t// could be svg\n\t\tif (isSVGMarkup(value)) return value;\n\n\t\t// test if is emoji\n\t\tif (isEmoji(value)) return getEmojiSVG(value, alt);\n\n\t\t// must be URL\n\t\treturn `<img src=\"${value}\" alt=\"${alt}\"/>`;\n\t};\n\n\tconst getAltFromSrc = src => getFilenameWithoutExtension(getFilenameFromURL(src));\n\tconst excludedStickerItemProps = [\"src\", \"alt\", \"thumb\", \"shape\", \"id\", \"mount\", \"disabled\"];\n\n\tconst mapPreset = item => {\n\t\tlet id = item;\n\t\tlet src;\n\t\tlet shape;\n\t\tlet shapeProps;\n\t\tlet thumb;\n\t\tlet alt;\n\t\tlet mount;\n\t\tlet disabled;\n\n\t\t// if item is a string, it's either an emoji or a URL\n\t\tif (isString(item)) {\n\t\t\t// is emoji\n\t\t\tif (isEmoji(item)) {\n\t\t\t\tsrc = item;\n\t\t\t\talt = item;\n\t\t\t\tthumb = getPresetThumb(src, alt);\n\t\t\t} else // must be URL\n\t\t\t{\n\t\t\t\tsrc = item;\n\t\t\t\talt = getAltFromSrc(src);\n\t\t\t\tthumb = getPresetThumb(src, alt);\n\t\t\t}\n\t\t} else {\n\t\t\t// set custom thumbnail if defined\n\t\t\tsrc = item.src;\n\n\t\t\talt = item.alt || (isString(src)\n\t\t\t? getAltFromSrc(src)\n\t\t\t: isString(item.thumb)\n\t\t\t\t? getAltFromSrc(item.thumb)\n\t\t\t\t: undefined);\n\n\t\t\tthumb = getPresetThumb(item.thumb || src, alt);\n\t\t\tshape = item.shape;\n\t\t\tmount = item.mount;\n\t\t\tdisabled = item.disabled;\n\n\t\t\tshapeProps = Object.keys(item).reduce(\n\t\t\t\t(prev, curr) => {\n\t\t\t\t\tif (excludedStickerItemProps.includes(curr)) return prev;\n\t\t\t\t\tprev[curr] = item[curr];\n\t\t\t\t\treturn prev;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t);\n\t\t}\n\n\t\treturn {\n\t\t\tid,\n\t\t\tsrc,\n\t\t\tthumb,\n\t\t\tshape,\n\t\t\tshapeProps,\n\t\t\talt,\n\t\t\ttitle: alt,\n\t\t\tmount,\n\t\t\tdisabled\n\t\t};\n\t};\n\n\tconst mapPresets = items => items.map(item => {\n\t\tif (isPresetGroup(item)) {\n\t\t\treturn {\n\t\t\t\t...item[2],\n\t\t\t\tid: `${uid}-${item[0].toLowerCase()}`,\n\t\t\t\tlabel: item[0],\n\t\t\t\titems: mapPresets(item[1])\n\t\t\t};\n\t\t}\n\n\t\treturn mapPreset(item);\n\t});\n\n\tconst select_handler = ({ detail }) => $$invalidate(12, tabSelected = detail);\n\n\t$$self.$$set = $$props => {\n\t\tif (\"locale\" in $$props) $$invalidate(0, locale = $$props.locale);\n\t\tif (\"presets\" in $$props) $$invalidate(15, presets = $$props.presets);\n\t\tif (\"scrollElasticity\" in $$props) $$invalidate(1, scrollElasticity = $$props.scrollElasticity);\n\t\tif (\"enableSelectImage\" in $$props) $$invalidate(2, enableSelectImage = $$props.enableSelectImage);\n\t\tif (\"onaddpreset\" in $$props) $$invalidate(3, onaddpreset = $$props.onaddpreset);\n\t\tif (\"ongrabpreset\" in $$props) $$invalidate(4, ongrabpreset = $$props.ongrabpreset);\n\t\tif (\"ondragpreset\" in $$props) $$invalidate(5, ondragpreset = $$props.ondragpreset);\n\t\tif (\"ondroppreset\" in $$props) $$invalidate(6, ondroppreset = $$props.ondroppreset);\n\t};\n\n\tlet presetsMapped;\n\tlet shouldRenderPresets;\n\tlet shouldGroupPresets;\n\tlet tabs;\n\tlet presetTabs;\n\tlet tabSelected;\n\tlet tabsConfig;\n\tlet panels;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty & /*presets*/ 32768) {\n\t\t\t $$invalidate(7, presetsMapped = mapPresets(presets));\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*presetsMapped*/ 128) {\n\t\t\t// const handlePresetClick = (preset, e) => onaddpreset(preset);\n\t\t\t// const handlePresetGrab = (preset, e) => ongrabpreset(preset, e);\n\t\t\t// const handlePresetDrag = (preset, e) => ondragpreset(preset, e);\n\t\t\t// const handlePresetDrop = (preset, e) => ondroppreset(preset, e);\n\t\t\t//\n\t\t\t// handle file input\n\t\t\t//\n\t\t\t $$invalidate(8, shouldRenderPresets = presetsMapped.length);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*shouldRenderPresets, presetsMapped*/ 384) {\n\t\t\t $$invalidate(9, shouldGroupPresets = shouldRenderPresets && presetsMapped.some(preset => !!preset.items));\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*shouldGroupPresets, presetsMapped*/ 640) {\n\t\t\t $$invalidate(10, tabs = shouldGroupPresets && presetsMapped);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*shouldGroupPresets, presetsMapped*/ 640) {\n\t\t\t $$invalidate(11, presetTabs = shouldGroupPresets && presetsMapped.reduce(\n\t\t\t\t(prev, curr) => {\n\t\t\t\t\tprev[curr.id] = curr;\n\t\t\t\t\treturn prev;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t));\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*tabSelected, tabs*/ 5120) {\n\t\t\t $$invalidate(12, tabSelected = tabSelected || tabs && (tabs.find(tab => !tab.disabled) || {}).id);\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*tabSelected*/ 4096) {\n\t\t\t $$invalidate(13, tabsConfig = { name: uid, selected: tabSelected });\n\t\t}\n\n\t\tif ($$self.$$.dirty & /*tabs*/ 1024) {\n\t\t\t $$invalidate(14, panels = tabs && tabs.map(tab => tab.id));\n\t\t}\n\t};\n\n\treturn [\n\t\tlocale,\n\t\tscrollElasticity,\n\t\tenableSelectImage,\n\t\tonaddpreset,\n\t\tongrabpreset,\n\t\tondragpreset,\n\t\tondroppreset,\n\t\tpresetsMapped,\n\t\tshouldRenderPresets,\n\t\tshouldGroupPresets,\n\t\ttabs,\n\t\tpresetTabs,\n\t\ttabSelected,\n\t\ttabsConfig,\n\t\tpanels,\n\t\tpresets,\n\t\tselect_handler\n\t];\n}\n\nclass ShapePresetsPalette extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$B, create_fragment$B, safe_not_equal, {\n\t\t\tlocale: 0,\n\t\t\tpresets: 15,\n\t\t\tscrollElasticity: 1,\n\t\t\tenableSelectImage: 2,\n\t\t\tonaddpreset: 3,\n\t\t\tongrabpreset: 4,\n\t\t\tondragpreset: 5,\n\t\t\tondroppreset: 6\n\t\t});\n\t}\n}\n\nvar createPingDispatcher = (node) => (type, data) => {\n    node.dispatchEvent(new CustomEvent('ping', {\n        detail: {\n            type,\n            data,\n        },\n        cancelable: true,\n        bubbles: true,\n    }));\n};\n\n/* src/core/ui/components/ShapeUtil.svelte generated by Svelte v3.29.4 */\n\nfunction create_if_block_4$5(ctx) {\n\tlet shapelayouteditor;\n\tlet updating_markup;\n\tlet updating_ui;\n\tlet current;\n\n\tconst shapelayouteditor_spread_levels = [\n\t\t{ locale: /*locale*/ ctx[4] },\n\t\t{ parentRect: /*$parentRect*/ ctx[27] },\n\t\t{ rootRect: /*$rootRect*/ ctx[18] },\n\t\t{ stageRect: /*$stageRect*/ ctx[22] },\n\t\t{ utilRect: /*$utilRect*/ ctx[21] },\n\t\t{ offset: /*markupOffset*/ ctx[20] },\n\t\t{ scale: /*$presentationScalar*/ ctx[32] },\n\t\t{ rotation: /*imageRotation*/ ctx[12] },\n\t\t{ opacity: /*$isActiveFraction*/ ctx[26] },\n\t\t{\n\t\t\tenableButtonFlipVertical: /*enableButtonFlipVertical*/ ctx[7]\n\t\t},\n\t\t{\n\t\t\tmapEditorPointToImagePoint: /*mapScreenPointToImagePoint*/ ctx[10]\n\t\t},\n\t\t{\n\t\t\tmapImagePointToEditorPoint: /*mapImagePointToScreenPoint*/ ctx[11]\n\t\t},\n\t\t{\n\t\t\toninteractionstart: /*handleInteractionStart*/ ctx[41]\n\t\t},\n\t\t{\n\t\t\toninteractionupdate: /*handleInteractionUpdate*/ ctx[42]\n\t\t},\n\t\t{\n\t\t\toninteractionrelease: /*handleInteractionRelease*/ ctx[43]\n\t\t},\n\t\t{\n\t\t\toninteractionend: /*handleInteractionEnd*/ ctx[44]\n\t\t},\n\t\t{ onaddshape: /*func*/ ctx[59] },\n\t\t{ onselectshape: /*func_1*/ ctx[60] },\n\t\t{ onupdateshape: /*func_2*/ ctx[61] },\n\t\t{ onremoveshape: /*func_3*/ ctx[62] },\n\t\t/*hooks*/ ctx[14]\n\t];\n\n\tfunction shapelayouteditor_markup_binding(value) {\n\t\t/*shapelayouteditor_markup_binding*/ ctx[64].call(null, value);\n\t}\n\n\tfunction shapelayouteditor_ui_binding(value) {\n\t\t/*shapelayouteditor_ui_binding*/ ctx[65].call(null, value);\n\t}\n\n\tlet shapelayouteditor_props = {};\n\n\tfor (let i = 0; i < shapelayouteditor_spread_levels.length; i += 1) {\n\t\tshapelayouteditor_props = assign(shapelayouteditor_props, shapelayouteditor_spread_levels[i]);\n\t}\n\n\tif (/*$shapes*/ ctx[23] !== void 0) {\n\t\tshapelayouteditor_props.markup = /*$shapes*/ ctx[23];\n\t}\n\n\tif (/*$imageOverlayMarkup*/ ctx[31] !== void 0) {\n\t\tshapelayouteditor_props.ui = /*$imageOverlayMarkup*/ ctx[31];\n\t}\n\n\tshapelayouteditor = new ShapeLayoutEditor({ props: shapelayouteditor_props });\n\t/*shapelayouteditor_binding*/ ctx[63](shapelayouteditor);\n\tbinding_callbacks.push(() => bind(shapelayouteditor, \"markup\", shapelayouteditor_markup_binding));\n\tbinding_callbacks.push(() => bind(shapelayouteditor, \"ui\", shapelayouteditor_ui_binding));\n\tshapelayouteditor.$on(\"measure\", /*measure_handler_1*/ ctx[66]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapelayouteditor.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapelayouteditor, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapelayouteditor_changes = (dirty[0] & /*locale, $parentRect, $rootRect, $stageRect, $utilRect, markupOffset, imageRotation, $isActiveFraction, enableButtonFlipVertical, mapScreenPointToImagePoint, mapImagePointToScreenPoint, ping, hooks*/ 477387920 | dirty[1] & /*$presentationScalar, handleInteractionStart, handleInteractionUpdate, handleInteractionRelease, handleInteractionEnd, handleMarkupUpdate*/ 1063938)\n\t\t\t? get_spread_update(shapelayouteditor_spread_levels, [\n\t\t\t\t\tdirty[0] & /*locale*/ 16 && { locale: /*locale*/ ctx[4] },\n\t\t\t\t\tdirty[0] & /*$parentRect*/ 134217728 && { parentRect: /*$parentRect*/ ctx[27] },\n\t\t\t\t\tdirty[0] & /*$rootRect*/ 262144 && { rootRect: /*$rootRect*/ ctx[18] },\n\t\t\t\t\tdirty[0] & /*$stageRect*/ 4194304 && { stageRect: /*$stageRect*/ ctx[22] },\n\t\t\t\t\tdirty[0] & /*$utilRect*/ 2097152 && { utilRect: /*$utilRect*/ ctx[21] },\n\t\t\t\t\tdirty[0] & /*markupOffset*/ 1048576 && { offset: /*markupOffset*/ ctx[20] },\n\t\t\t\t\tdirty[1] & /*$presentationScalar*/ 2 && { scale: /*$presentationScalar*/ ctx[32] },\n\t\t\t\t\tdirty[0] & /*imageRotation*/ 4096 && { rotation: /*imageRotation*/ ctx[12] },\n\t\t\t\t\tdirty[0] & /*$isActiveFraction*/ 67108864 && { opacity: /*$isActiveFraction*/ ctx[26] },\n\t\t\t\t\tdirty[0] & /*enableButtonFlipVertical*/ 128 && {\n\t\t\t\t\t\tenableButtonFlipVertical: /*enableButtonFlipVertical*/ ctx[7]\n\t\t\t\t\t},\n\t\t\t\t\tdirty[0] & /*mapScreenPointToImagePoint*/ 1024 && {\n\t\t\t\t\t\tmapEditorPointToImagePoint: /*mapScreenPointToImagePoint*/ ctx[10]\n\t\t\t\t\t},\n\t\t\t\t\tdirty[0] & /*mapImagePointToScreenPoint*/ 2048 && {\n\t\t\t\t\t\tmapImagePointToEditorPoint: /*mapImagePointToScreenPoint*/ ctx[11]\n\t\t\t\t\t},\n\t\t\t\t\tdirty[1] & /*handleInteractionStart*/ 1024 && {\n\t\t\t\t\t\toninteractionstart: /*handleInteractionStart*/ ctx[41]\n\t\t\t\t\t},\n\t\t\t\t\tdirty[1] & /*handleInteractionUpdate*/ 2048 && {\n\t\t\t\t\t\toninteractionupdate: /*handleInteractionUpdate*/ ctx[42]\n\t\t\t\t\t},\n\t\t\t\t\tdirty[1] & /*handleInteractionRelease*/ 4096 && {\n\t\t\t\t\t\toninteractionrelease: /*handleInteractionRelease*/ ctx[43]\n\t\t\t\t\t},\n\t\t\t\t\tdirty[1] & /*handleInteractionEnd*/ 8192 && {\n\t\t\t\t\t\toninteractionend: /*handleInteractionEnd*/ ctx[44]\n\t\t\t\t\t},\n\t\t\t\t\tdirty[0] & /*ping*/ 268435456 | dirty[1] & /*handleMarkupUpdate*/ 1048576 && { onaddshape: /*func*/ ctx[59] },\n\t\t\t\t\tdirty[0] & /*ping*/ 268435456 && { onselectshape: /*func_1*/ ctx[60] },\n\t\t\t\t\tdirty[0] & /*ping*/ 268435456 | dirty[1] & /*handleMarkupUpdate*/ 1048576 && { onupdateshape: /*func_2*/ ctx[61] },\n\t\t\t\t\tdirty[0] & /*ping*/ 268435456 | dirty[1] & /*handleMarkupUpdate*/ 1048576 && { onremoveshape: /*func_3*/ ctx[62] },\n\t\t\t\t\tdirty[0] & /*hooks*/ 16384 && get_spread_object(/*hooks*/ ctx[14])\n\t\t\t\t])\n\t\t\t: {};\n\n\t\t\tif (!updating_markup && dirty[0] & /*$shapes*/ 8388608) {\n\t\t\t\tupdating_markup = true;\n\t\t\t\tshapelayouteditor_changes.markup = /*$shapes*/ ctx[23];\n\t\t\t\tadd_flush_callback(() => updating_markup = false);\n\t\t\t}\n\n\t\t\tif (!updating_ui && dirty[1] & /*$imageOverlayMarkup*/ 1) {\n\t\t\t\tupdating_ui = true;\n\t\t\t\tshapelayouteditor_changes.ui = /*$imageOverlayMarkup*/ ctx[31];\n\t\t\t\tadd_flush_callback(() => updating_ui = false);\n\t\t\t}\n\n\t\t\tshapelayouteditor.$set(shapelayouteditor_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapelayouteditor.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapelayouteditor.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\t/*shapelayouteditor_binding*/ ctx[63](null);\n\t\t\tdestroy_component(shapelayouteditor, detaching);\n\t\t}\n\t};\n}\n\n// (376:4) <div bind:this={pingHub} slot=\"main\" style=\"cursor: crosshair\" use:dropable on:dropfiles={handleDropFiles}>\nfunction create_main_slot$1(ctx) {\n\tlet div;\n\tlet dropable_action;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\tlet if_block = /*shouldRenderShapeEditor*/ ctx[19] && create_if_block_4$5(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(div, \"slot\", \"main\");\n\t\t\tset_style(div, \"cursor\", \"crosshair\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tif (if_block) if_block.m(div, null);\n\t\t\t/*div_binding*/ ctx[67](div);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\taction_destroyer(dropable_action = dropable.call(null, div)),\n\t\t\t\t\tlisten(div, \"dropfiles\", /*handleDropFiles*/ ctx[50])\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*shouldRenderShapeEditor*/ ctx[19]) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[0] & /*shouldRenderShapeEditor*/ 524288) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_4$5(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div, null);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (if_block) if_block.d();\n\t\t\t/*div_binding*/ ctx[67](null);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\n// (463:38) \nfunction create_if_block_3$5(ctx) {\n\tlet shapepresetspalette;\n\tlet current;\n\n\tshapepresetspalette = new ShapePresetsPalette({\n\t\t\tprops: {\n\t\t\t\tlocale: /*locale*/ ctx[4],\n\t\t\t\tpresets: /*shapePresets*/ ctx[9],\n\t\t\t\tenableSelectImage: /*enablePresetSelectImage*/ ctx[8],\n\t\t\t\tonaddpreset: /*handleAddPreset*/ ctx[49],\n\t\t\t\tongrabpreset: /*handleGrabPreset*/ ctx[46],\n\t\t\t\tondragpreset: /*handleDragPreset*/ ctx[47],\n\t\t\t\tondroppreset: /*handleDropPreset*/ ctx[48],\n\t\t\t\tscrollElasticity: /*computedScrollElasticity*/ ctx[29]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapepresetspalette.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapepresetspalette, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapepresetspalette_changes = {};\n\t\t\tif (dirty[0] & /*locale*/ 16) shapepresetspalette_changes.locale = /*locale*/ ctx[4];\n\t\t\tif (dirty[0] & /*shapePresets*/ 512) shapepresetspalette_changes.presets = /*shapePresets*/ ctx[9];\n\t\t\tif (dirty[0] & /*enablePresetSelectImage*/ 256) shapepresetspalette_changes.enableSelectImage = /*enablePresetSelectImage*/ ctx[8];\n\t\t\tif (dirty[0] & /*computedScrollElasticity*/ 536870912) shapepresetspalette_changes.scrollElasticity = /*computedScrollElasticity*/ ctx[29];\n\t\t\tshapepresetspalette.$set(shapepresetspalette_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapepresetspalette.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapepresetspalette.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapepresetspalette, detaching);\n\t\t}\n\t};\n}\n\n// (419:8) {#if toolsFiltered.length}\nfunction create_if_block$c(ctx) {\n\tlet div;\n\tlet current_block_type_index;\n\tlet if_block;\n\tlet t;\n\tlet scrollable;\n\tlet current;\n\tconst if_block_creators = [create_if_block_2$8, create_else_block$4];\n\tconst if_blocks = [];\n\n\tfunction select_block_type_1(ctx, dirty) {\n\t\tif (/*shouldRenderPresets*/ ctx[25]) return 0;\n\t\treturn 1;\n\t}\n\n\tcurrent_block_type_index = select_block_type_1(ctx);\n\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\n\tscrollable = new Scrollable({\n\t\t\tprops: {\n\t\t\t\tclass: \"DokaControlListScroller\",\n\t\t\t\telasticity: /*computedScrollElasticity*/ ctx[29],\n\t\t\t\t$$slots: { default: [create_default_slot_1$8] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif_block.c();\n\t\t\tt = space();\n\t\t\tcreate_component(scrollable.$$.fragment);\n\t\t\tattr(div, \"class\", \"DokaControlPanels\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tif_blocks[current_block_type_index].m(div, null);\n\t\t\tinsert(target, t, anchor);\n\t\t\tmount_component(scrollable, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tlet previous_block_index = current_block_type_index;\n\t\t\tcurrent_block_type_index = select_block_type_1(ctx);\n\n\t\t\tif (current_block_type_index === previous_block_index) {\n\t\t\t\tif_blocks[current_block_type_index].p(ctx, dirty);\n\t\t\t} else {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_blocks[previous_block_index], 1, 1, () => {\n\t\t\t\t\tif_blocks[previous_block_index] = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t\tif_block = if_blocks[current_block_type_index];\n\n\t\t\t\tif (!if_block) {\n\t\t\t\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t}\n\n\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\tif_block.m(div, null);\n\t\t\t}\n\n\t\t\tconst scrollable_changes = {};\n\t\t\tif (dirty[0] & /*computedScrollElasticity*/ 536870912) scrollable_changes.elasticity = /*computedScrollElasticity*/ ctx[29];\n\n\t\t\tif (dirty[0] & /*locale, toolsFiltered, toolActive*/ 131089 | dirty[2] & /*$$scope*/ 268435456) {\n\t\t\t\tscrollable_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tscrollable.$set(scrollable_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\ttransition_in(scrollable.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\ttransition_out(scrollable.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif_blocks[current_block_type_index].d();\n\t\t\tif (detaching) detach(t);\n\t\t\tdestroy_component(scrollable, detaching);\n\t\t}\n\t};\n}\n\n// (433:16) {:else}\nfunction create_else_block$4(ctx) {\n\tlet div;\n\tlet shapestyleeditor;\n\tlet current;\n\n\tshapestyleeditor = new ShapeStyleEditor({\n\t\t\tprops: {\n\t\t\t\tlocale: /*locale*/ ctx[4],\n\t\t\t\tshape: /*markupShapeSelected*/ ctx[24],\n\t\t\t\tonchange: /*handleUpdateSelectedMarkupShape*/ ctx[45],\n\t\t\t\tcontrols: /*shapeControls*/ ctx[6],\n\t\t\t\tscrollElasticity: /*computedScrollElasticity*/ ctx[29]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(shapestyleeditor.$$.fragment);\n\t\t\tattr(div, \"class\", \"DokaControlPanel\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(shapestyleeditor, div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapestyleeditor_changes = {};\n\t\t\tif (dirty[0] & /*locale*/ 16) shapestyleeditor_changes.locale = /*locale*/ ctx[4];\n\t\t\tif (dirty[0] & /*markupShapeSelected*/ 16777216) shapestyleeditor_changes.shape = /*markupShapeSelected*/ ctx[24];\n\t\t\tif (dirty[0] & /*shapeControls*/ 64) shapestyleeditor_changes.controls = /*shapeControls*/ ctx[6];\n\t\t\tif (dirty[0] & /*computedScrollElasticity*/ 536870912) shapestyleeditor_changes.scrollElasticity = /*computedScrollElasticity*/ ctx[29];\n\t\t\tshapestyleeditor.$set(shapestyleeditor_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapestyleeditor.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapestyleeditor.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(shapestyleeditor);\n\t\t}\n\t};\n}\n\n// (422:16) {#if shouldRenderPresets}\nfunction create_if_block_2$8(ctx) {\n\tlet div;\n\tlet shapepresetspalette;\n\tlet current;\n\n\tshapepresetspalette = new ShapePresetsPalette({\n\t\t\tprops: {\n\t\t\t\tlocale: /*locale*/ ctx[4],\n\t\t\t\tpresets: /*shapePresets*/ ctx[9],\n\t\t\t\tenableSelectImage: /*enablePresetSelectImage*/ ctx[8],\n\t\t\t\tonaddpreset: /*handleAddPreset*/ ctx[49],\n\t\t\t\tongrabpreset: /*handleGrabPreset*/ ctx[46],\n\t\t\t\tondragpreset: /*handleDragPreset*/ ctx[47],\n\t\t\t\tondroppreset: /*handleDropPreset*/ ctx[48],\n\t\t\t\tscrollElasticity: /*computedScrollElasticity*/ ctx[29]\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tcreate_component(shapepresetspalette.$$.fragment);\n\t\t\tattr(div, \"class\", \"DokaControlPanel\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tmount_component(shapepresetspalette, div, null);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapepresetspalette_changes = {};\n\t\t\tif (dirty[0] & /*locale*/ 16) shapepresetspalette_changes.locale = /*locale*/ ctx[4];\n\t\t\tif (dirty[0] & /*shapePresets*/ 512) shapepresetspalette_changes.presets = /*shapePresets*/ ctx[9];\n\t\t\tif (dirty[0] & /*enablePresetSelectImage*/ 256) shapepresetspalette_changes.enableSelectImage = /*enablePresetSelectImage*/ ctx[8];\n\t\t\tif (dirty[0] & /*computedScrollElasticity*/ 536870912) shapepresetspalette_changes.scrollElasticity = /*computedScrollElasticity*/ ctx[29];\n\t\t\tshapepresetspalette.$set(shapepresetspalette_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapepresetspalette.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapepresetspalette.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tdestroy_component(shapepresetspalette);\n\t\t}\n\t};\n}\n\n// (455:24) {#if option.icon}\nfunction create_if_block_1$c(ctx) {\n\tlet icon;\n\tlet current;\n\n\ticon = new Icon({\n\t\t\tprops: {\n\t\t\t\t$$slots: { default: [create_default_slot_3$6] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(icon.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(icon, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst icon_changes = {};\n\n\t\t\tif (dirty[0] & /*locale*/ 16 | dirty[2] & /*$$scope, option*/ 402653184) {\n\t\t\t\ticon_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon.$set(icon_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(icon, detaching);\n\t\t}\n\t};\n}\n\n// (456:24) <Icon>\nfunction create_default_slot_3$6(ctx) {\n\tlet g;\n\n\tlet raw_value = (isFunction(/*option*/ ctx[89].icon)\n\t? /*option*/ ctx[89].icon(/*locale*/ ctx[4])\n\t: /*option*/ ctx[89].icon) + \"\";\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = raw_value;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*locale*/ 16 | dirty[2] & /*option*/ 134217728 && raw_value !== (raw_value = (isFunction(/*option*/ ctx[89].icon)\n\t\t\t? /*option*/ ctx[89].icon(/*locale*/ ctx[4])\n\t\t\t: /*option*/ ctx[89].icon) + \"\")) g.innerHTML = raw_value;\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (454:20) <div slot=\"option\">\nfunction create_option_slot$3(ctx) {\n\tlet div;\n\tlet t0;\n\tlet span;\n\n\tlet t1_value = (isFunction(/*option*/ ctx[89].label)\n\t? /*option*/ ctx[89].label(/*locale*/ ctx[4])\n\t: /*option*/ ctx[89].label) + \"\";\n\n\tlet t1;\n\tlet current;\n\tlet if_block = /*option*/ ctx[89].icon && create_if_block_1$c(ctx);\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tt0 = space();\n\t\t\tspan = element(\"span\");\n\t\t\tt1 = text(t1_value);\n\t\t\tattr(div, \"slot\", \"option\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\t\t\tif (if_block) if_block.m(div, null);\n\t\t\tappend(div, t0);\n\t\t\tappend(div, span);\n\t\t\tappend(span, t1);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (/*option*/ ctx[89].icon) {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tif_block.p(ctx, dirty);\n\n\t\t\t\t\tif (dirty[2] & /*option*/ 134217728) {\n\t\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif_block = create_if_block_1$c(ctx);\n\t\t\t\t\tif_block.c();\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div, t0);\n\t\t\t\t}\n\t\t\t} else if (if_block) {\n\t\t\t\tgroup_outros();\n\n\t\t\t\ttransition_out(if_block, 1, 1, () => {\n\t\t\t\t\tif_block = null;\n\t\t\t\t});\n\n\t\t\t\tcheck_outros();\n\t\t\t}\n\n\t\t\tif ((!current || dirty[0] & /*locale*/ 16 | dirty[2] & /*option*/ 134217728) && t1_value !== (t1_value = (isFunction(/*option*/ ctx[89].label)\n\t\t\t? /*option*/ ctx[89].label(/*locale*/ ctx[4])\n\t\t\t: /*option*/ ctx[89].label) + \"\")) set_data(t1, t1_value);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\t\t\tif (if_block) if_block.d();\n\t\t}\n\t};\n}\n\n// (444:12) <Scrollable class=\"DokaControlListScroller\" elasticity={computedScrollElasticity}>\nfunction create_default_slot_1$8(ctx) {\n\tlet radiogroup;\n\tlet current;\n\n\tradiogroup = new RadioGroup({\n\t\t\tprops: {\n\t\t\t\tlocale: /*locale*/ ctx[4],\n\t\t\t\tclass: \"DokaControlList\",\n\t\t\t\toptionClass: \"DokaControlListOption\",\n\t\t\t\tlayout: \"row\",\n\t\t\t\toptions: /*toolsFiltered*/ ctx[17],\n\t\t\t\tselectedIndex: /*toolsFiltered*/ ctx[17].findIndex(/*func_4*/ ctx[68]),\n\t\t\t\tonchange: /*updateActiveTool*/ ctx[40],\n\t\t\t\t$$slots: {\n\t\t\t\t\toption: [\n\t\t\t\t\t\tcreate_option_slot$3,\n\t\t\t\t\t\t({ option }) => ({ 89: option }),\n\t\t\t\t\t\t({ option }) => [0, 0, option ? 134217728 : 0]\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(radiogroup.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(radiogroup, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst radiogroup_changes = {};\n\t\t\tif (dirty[0] & /*locale*/ 16) radiogroup_changes.locale = /*locale*/ ctx[4];\n\t\t\tif (dirty[0] & /*toolsFiltered*/ 131072) radiogroup_changes.options = /*toolsFiltered*/ ctx[17];\n\t\t\tif (dirty[0] & /*toolsFiltered, toolActive*/ 131073) radiogroup_changes.selectedIndex = /*toolsFiltered*/ ctx[17].findIndex(/*func_4*/ ctx[68]);\n\n\t\t\tif (dirty[0] & /*locale*/ 16 | dirty[2] & /*$$scope, option*/ 402653184) {\n\t\t\t\tradiogroup_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tradiogroup.$set(radiogroup_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(radiogroup.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(radiogroup.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(radiogroup, detaching);\n\t\t}\n\t};\n}\n\n// (417:4) <div slot=\"footer\" style={footerStyle}>\nfunction create_footer_slot$3(ctx) {\n\tlet div;\n\tlet current_block_type_index;\n\tlet if_block;\n\tlet current;\n\tconst if_block_creators = [create_if_block$c, create_if_block_3$5];\n\tconst if_blocks = [];\n\n\tfunction select_block_type(ctx, dirty) {\n\t\tif (/*toolsFiltered*/ ctx[17].length) return 0;\n\t\tif (/*shouldRenderPresets*/ ctx[25]) return 1;\n\t\treturn -1;\n\t}\n\n\tif (~(current_block_type_index = select_block_type(ctx))) {\n\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t}\n\n\treturn {\n\t\tc() {\n\t\t\tdiv = element(\"div\");\n\t\t\tif (if_block) if_block.c();\n\t\t\tattr(div, \"slot\", \"footer\");\n\t\t\tattr(div, \"style\", /*footerStyle*/ ctx[30]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, div, anchor);\n\n\t\t\tif (~current_block_type_index) {\n\t\t\t\tif_blocks[current_block_type_index].m(div, null);\n\t\t\t}\n\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tlet previous_block_index = current_block_type_index;\n\t\t\tcurrent_block_type_index = select_block_type(ctx);\n\n\t\t\tif (current_block_type_index === previous_block_index) {\n\t\t\t\tif (~current_block_type_index) {\n\t\t\t\t\tif_blocks[current_block_type_index].p(ctx, dirty);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (if_block) {\n\t\t\t\t\tgroup_outros();\n\n\t\t\t\t\ttransition_out(if_blocks[previous_block_index], 1, 1, () => {\n\t\t\t\t\t\tif_blocks[previous_block_index] = null;\n\t\t\t\t\t});\n\n\t\t\t\t\tcheck_outros();\n\t\t\t\t}\n\n\t\t\t\tif (~current_block_type_index) {\n\t\t\t\t\tif_block = if_blocks[current_block_type_index];\n\n\t\t\t\t\tif (!if_block) {\n\t\t\t\t\t\tif_block = if_blocks[current_block_type_index] = if_block_creators[current_block_type_index](ctx);\n\t\t\t\t\t\tif_block.c();\n\t\t\t\t\t}\n\n\t\t\t\t\ttransition_in(if_block, 1);\n\t\t\t\t\tif_block.m(div, null);\n\t\t\t\t} else {\n\t\t\t\t\tif_block = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*footerStyle*/ 1073741824) {\n\t\t\t\tattr(div, \"style\", /*footerStyle*/ ctx[30]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(if_block);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(if_block);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(div);\n\n\t\t\tif (~current_block_type_index) {\n\t\t\t\tif_blocks[current_block_type_index].d();\n\t\t\t}\n\t\t}\n\t};\n}\n\n// (374:0) <Util on:measure>\nfunction create_default_slot$b(ctx) {\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tt = space();\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, t, anchor);\n\t\t},\n\t\tp: noop$1,\n\t\ti: noop$1,\n\t\to: noop$1,\n\t\td(detaching) {\n\t\t\tif (detaching) detach(t);\n\t\t}\n\t};\n}\n\nfunction create_fragment$C(ctx) {\n\tlet util;\n\tlet current;\n\n\tutil = new Util({\n\t\t\tprops: {\n\t\t\t\t$$slots: {\n\t\t\t\t\tdefault: [create_default_slot$b],\n\t\t\t\t\tfooter: [create_footer_slot$3],\n\t\t\t\t\tmain: [create_main_slot$1]\n\t\t\t\t},\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\tutil.$on(\"measure\", /*measure_handler*/ ctx[69]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(util.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(util, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst util_changes = {};\n\n\t\t\tif (dirty[0] & /*footerStyle, computedScrollElasticity, locale, toolsFiltered, toolActive, shapePresets, enablePresetSelectImage, shouldRenderPresets, markupShapeSelected, shapeControls, pingHub, $parentRect, $rootRect, $stageRect, $utilRect, markupOffset, imageRotation, $isActiveFraction, enableButtonFlipVertical, mapScreenPointToImagePoint, mapImagePointToScreenPoint, ping, hooks, markupEditor, $shapes, shouldRenderShapeEditor*/ 2147475409 | dirty[1] & /*$presentationScalar, $imageOverlayMarkup*/ 3 | dirty[2] & /*$$scope*/ 268435456) {\n\t\t\t\tutil_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tutil.$set(util_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(util.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(util.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(util, detaching);\n\t\t}\n\t};\n}\n\nfunction instance$C($$self, $$props, $$invalidate) {\n\tlet $rootRect;\n\n\tlet $isActive,\n\t\t$$unsubscribe_isActive = noop$1,\n\t\t$$subscribe_isActive = () => ($$unsubscribe_isActive(), $$unsubscribe_isActive = subscribe(isActive, $$value => $$invalidate(73, $isActive = $$value)), isActive);\n\n\tlet $imagePreviewModifiers;\n\n\tlet $isVisible,\n\t\t$$unsubscribe_isVisible = noop$1,\n\t\t$$subscribe_isVisible = () => ($$unsubscribe_isVisible(), $$unsubscribe_isVisible = subscribe(isVisible, $$value => $$invalidate(76, $isVisible = $$value)), isVisible);\n\n\tlet $utilRect;\n\tlet $stageRect;\n\n\tlet $shapes,\n\t\t$$unsubscribe_shapes = noop$1,\n\t\t$$subscribe_shapes = () => ($$unsubscribe_shapes(), $$unsubscribe_shapes = subscribe(shapes, $$value => $$invalidate(23, $shapes = $$value)), shapes);\n\n\tlet $isActiveFraction,\n\t\t$$unsubscribe_isActiveFraction = noop$1,\n\t\t$$subscribe_isActiveFraction = () => ($$unsubscribe_isActiveFraction(), $$unsubscribe_isActiveFraction = subscribe(isActiveFraction, $$value => $$invalidate(26, $isActiveFraction = $$value)), isActiveFraction);\n\n\tlet $imageCropRect;\n\n\tlet $parentRect,\n\t\t$$unsubscribe_parentRect = noop$1,\n\t\t$$subscribe_parentRect = () => ($$unsubscribe_parentRect(), $$unsubscribe_parentRect = subscribe(parentRect, $$value => $$invalidate(27, $parentRect = $$value)), parentRect);\n\n\tlet $footerOffset;\n\tlet $imageOverlayMarkup;\n\tlet $presentationScalar;\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_isActive());\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_isVisible());\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_shapes());\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_isActiveFraction());\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_parentRect());\n\tlet { isActive } = $$props;\n\t$$subscribe_isActive();\n\tlet { isActiveFraction } = $$props;\n\t$$subscribe_isActiveFraction();\n\tlet { isVisible } = $$props;\n\t$$subscribe_isVisible();\n\tlet { stores } = $$props;\n\tlet { locale = {} } = $$props;\n\tlet { shapes = [] } = $$props;\n\t$$subscribe_shapes();\n\tlet { tools = [] } = $$props;\n\tlet { toolShapes = [] } = $$props;\n\tlet { toolActive = \"sharpie\" } = $$props;\n\tlet { shapeControls = [] } = $$props;\n\tlet { enableButtonFlipVertical = false } = $$props;\n\tlet { enablePresetSelectImage = true } = $$props;\n\tlet { shapePresets = [] } = $$props;\n\tlet { utilKey } = $$props;\n\tlet { mapScreenPointToImagePoint } = $$props;\n\tlet { mapImagePointToScreenPoint } = $$props;\n\tlet { imageRotation = 0 } = $$props;\n\tlet { imageFlipX = false } = $$props;\n\tlet { imageFlipY = false } = $$props;\n\tlet { parentRect } = $$props;\n\t$$subscribe_parentRect();\n\tlet { hooks = {} } = $$props;\n\tconst { history, rootRect, stageRect, utilRect, elasticityMultiplier, scrollElasticity, imageOverlayMarkup, imagePreviewModifiers, imageCropRect, presentationScalar } = stores;\n\tcomponent_subscribe($$self, rootRect, value => $$invalidate(18, $rootRect = value));\n\tcomponent_subscribe($$self, stageRect, value => $$invalidate(22, $stageRect = value));\n\tcomponent_subscribe($$self, utilRect, value => $$invalidate(21, $utilRect = value));\n\tcomponent_subscribe($$self, imageOverlayMarkup, value => $$invalidate(31, $imageOverlayMarkup = value));\n\tcomponent_subscribe($$self, imagePreviewModifiers, value => $$invalidate(74, $imagePreviewModifiers = value));\n\tcomponent_subscribe($$self, imageCropRect, value => $$invalidate(80, $imageCropRect = value));\n\tcomponent_subscribe($$self, presentationScalar, value => $$invalidate(32, $presentationScalar = value));\n\tconst updateActiveTool = ({ value }) => $$invalidate(0, toolActive = value);\n\tconst mapScreenEventToImagePoint = e => mapScreenPointToImagePoint(getEventPositionInEditor(e, $rootRect));\n\n\t// A reference to the markup editor, we need this so we can call exported functions\n\tlet markupEditor;\n\n\t// the current tool styles\n\tlet markupToolStyles = {};\n\n\t//\n\t// Create new shape\n\t//\n\tlet interactionHandler;\n\n\tconst handleInteractionStart = e => {\n\t\tif (toolShapes[toolActive]) {\n\t\t\tconst [shape, options] = toolShapes[toolActive];\n\t\t\tinteractionHandler = markupEditor.createShape({ ...shape, ...markupToolStylesComputed }, options);\n\t\t} else if (toolActive === \"eraser\") {\n\t\t\tinteractionHandler = markupEditor.eraseShape();\n\t\t} else {\n\t\t\tinteractionHandler = undefined;\n\t\t}\n\n\t\tif (!interactionHandler) return;\n\t\tinteractionHandler.start(e);\n\t};\n\n\tconst handleInteractionUpdate = e => {\n\t\tif (!interactionHandler) return;\n\t\tinteractionHandler.update(e);\n\t};\n\n\tconst handleInteractionRelease = e => {\n\t\tif (!interactionHandler) return;\n\t\tinteractionHandler.release(e);\n\t};\n\n\tconst handleInteractionEnd = e => {\n\t\tif (!interactionHandler) return;\n\t\tinteractionHandler.end(e);\n\t\tinteractionHandler = undefined;\n\t};\n\n\tfunction handleUpdateSelectedMarkupShape(props) {\n\t\t// remember style for when creating or styling other element\n\t\tObject.keys(props).forEach(key => $$invalidate(70, markupToolStyles[key] = props[key], markupToolStyles));\n\n\t\t// it's possible we're only updating default styles\n\t\tif (!markupSelected) return;\n\n\t\t// update element\n\t\tmarkupEditor.updateMarkupShape(markupSelected, props);\n\n\t\t// update markup style\n\t\thandleMarkupUpdate();\n\t}\n\n\tconst createPreset = (preset, position) => {\n\t\t// position defaults to crop center\n\t\tlet positionIsCenter = false;\n\n\t\tif (!position) {\n\t\t\tpositionIsCenter = true;\n\t\t\tposition = rectCenter($imageCropRect);\n\t\t}\n\n\t\t// adjust offset if parent rect is image crop rect\n\t\tposition.x -= $parentRect.x || 0;\n\n\t\tposition.y -= $parentRect.y || 0;\n\n\t\t// calculate new center if image is rotated\n\t\tif (imageRotation !== 0) {\n\t\t\tconst size = {\n\t\t\t\twidth: $parentRect.width,\n\t\t\t\theight: $parentRect.height\n\t\t\t};\n\n\t\t\tsizeRotate(size, imageRotation);\n\t\t\tconst dx = ($parentRect.width - Math.abs(size.width)) * 0.5;\n\t\t\tconst dy = ($parentRect.height - Math.abs(size.height)) * 0.5;\n\t\t\tposition.x += dx;\n\t\t\tposition.y += dy;\n\t\t}\n\n\t\t// create shape\n\t\tconst shape = shapeCreateFromPreset(preset, $imageCropRect, (error, shape) => {\n\t\t\t// has shape not been added?\n\t\t\tif (!$shapes.find(s => s.id === shape.id)) return;\n\n\t\t\t// something went wrong, exit!\n\t\t\tif (error) {\n\t\t\t\tmarkupEditor.removeShape(shape);\n\t\t\t\treturn console.error(error);\n\t\t\t}\n\n\t\t\t// reposition shape\n\t\t\tshapeContain(shape, $imageCropRect);\n\n\t\t\tshapeCenter(shape, position);\n\n\t\t\t// select if is last shape\n\t\t\tif ($shapes[$shapes.length - 1] === shape) {\n\t\t\t\tmarkupEditor.selectShape(shape);\n\t\t\t}\n\t\t});\n\n\t\t// de-flip shape\n\t\tshape.flipX = imageFlipX;\n\n\t\tshape.flipY = imageFlipY;\n\n\t\t// de-rotate shape\n\t\tshape.rotation = imageRotation !== 0 ? -imageRotation : 0;\n\n\t\t// reposition if there's already shapes at position and shape isn't full screen\n\t\tconst shapesAlreadyAtPosition = markupEditor.getShapesAtPosition(position);\n\n\t\tconst cropWidth = $imageCropRect.width;\n\t\tconst cropHeight = $imageCropRect.height;\n\n\t\tif (positionIsCenter && shapesAlreadyAtPosition.length && shape.width < cropWidth && shape.height < cropHeight) {\n\t\t\tconst size = Math.min(cropWidth, cropHeight) * 0.1;\n\t\t\tposition.x += Math.round(-size + Math.random() * size * 2);\n\t\t\tposition.y += Math.round(-size + Math.random() * size * 2);\n\t\t}\n\n\t\t// shape update position\n\t\tif (shape.width && shape.height) {\n\t\t\tshapeContain(shape, $imageCropRect);\n\t\t\tshapeCenter(shape, position);\n\t\t}\n\n\t\treturn shape;\n\t};\n\n\tconst addPreset = (preset, position) => {\n\t\tconst { beforeAddShape = () => true } = hooks;\n\t\tconst shape = createPreset(preset, position);\n\t\tif (!beforeAddShape(shape)) return;\n\t\tmarkupEditor.addShape(shape);\n\t\thistory.write();\n\t\treturn shape;\n\t};\n\n\tlet dragCancelled = false;\n\n\tconst handleGrabPreset = (preset, e) => {\n\t\tdragCancelled = false;\n\t};\n\n\tconst handleDragPreset = (preset, e) => {\n\t\tif (dragCancelled) return;\n\t\tconst { beforeAddShape = () => true } = hooks;\n\t\tconst position = mapScreenEventToImagePoint(e);\n\n\t\t// create or update if is inside image\n\t\tconst draft = markupEditor.getMarkupItemDraft();\n\n\t\tconst inCropRect = rectContainsPoint($imageCropRect, {\n\t\t\t// adjust offset if parent rect is image crop rect\n\t\t\tx: position.x + ($parentRect.x || 0),\n\t\t\ty: position.y + ($parentRect.y || 0)\n\t\t});\n\n\t\t// remove draft if not dragging inside image\n\t\tif (draft && !inCropRect) markupEditor.discardMarkupItemDraft();\n\n\t\t// stop here if we're not in the crop rect\n\t\tif (!inCropRect) return;\n\n\t\t// create draft shape\n\t\tif (!draft) {\n\t\t\tconst shape = createPreset(preset, position);\n\n\t\t\tif (!beforeAddShape(shape)) {\n\t\t\t\tdragCancelled = true;\n\t\t\t\te.preventDefault();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tshapeMakeDraft(shape);\n\t\t\tmarkupEditor.addShape(shape);\n\t\t\treturn;\n\t\t}\n\n\t\t// update existing draft\n\t\tmarkupEditor.updateMarkupShape(draft, {\n\t\t\tx: position.x - draft.width * 0.5,\n\t\t\ty: position.y - draft.height * 0.5\n\t\t});\n\t};\n\n\tconst handleDropPreset = (preset, e) => {\n\t\tif (dragCancelled) return;\n\t\tconst position = mapScreenEventToImagePoint(e);\n\n\t\t// adjust offset if parent rect is image crop rect\n\t\tif (!rectContainsPoint($imageCropRect, {\n\t\t\tx: position.x + ($parentRect.x || 0),\n\t\t\ty: position.y + ($parentRect.y || 0)\n\t\t})) {\n\t\t\tmarkupEditor.discardMarkupItemDraft();\n\t\t} else {\n\t\t\tconst shape = markupEditor.confirmMarkupItemDraft();\n\t\t\tmarkupEditor.selectShape(shape);\n\n\t\t\t// update history\n\t\t\thistory.write();\n\t\t}\n\t};\n\n\tconst handleAddPreset = preset => addPreset(preset);\n\tconst handleAddFiles = (files, position) => files.forEach(file => addPreset(file, position));\n\tconst handleDropFiles = e => handleAddFiles(e.detail.files, mapScreenEventToImagePoint(e.detail.event));\n\n\t//\n\t// History\n\t//\n\tconst handleMarkupUpdate = () => history.write();\n\n\t// used to fire ping events from\n\tlet pingHub;\n\n\t//\n\t// Footer style\n\t//\n\tconst footerOffset = spring(0);\n\n\tcomponent_subscribe($$self, footerOffset, value => $$invalidate(81, $footerOffset = value));\n\n\tconst func = shape => {\n\t\tping(\"addshape\", shape);\n\t\thandleMarkupUpdate();\n\t};\n\n\tconst func_1 = shape => {\n\t\tping(\"selectshape\", shape);\n\t};\n\n\tconst func_2 = shape => {\n\t\tping(\"updateshape\", shape);\n\t\thandleMarkupUpdate();\n\t};\n\n\tconst func_3 = shape => {\n\t\tping(\"removeshape\", shape);\n\t\thandleMarkupUpdate();\n\t};\n\n\tfunction shapelayouteditor_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tmarkupEditor = $$value;\n\t\t\t$$invalidate(15, markupEditor);\n\t\t});\n\t}\n\n\tfunction shapelayouteditor_markup_binding(value) {\n\t\t$shapes = value;\n\t\tshapes.set($shapes);\n\t}\n\n\tfunction shapelayouteditor_ui_binding(value) {\n\t\t$imageOverlayMarkup = value;\n\t\timageOverlayMarkup.set($imageOverlayMarkup);\n\t}\n\n\tfunction measure_handler_1(event) {\n\t\tbubble($$self, event);\n\t}\n\n\tfunction div_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tpingHub = $$value;\n\t\t\t$$invalidate(16, pingHub);\n\t\t});\n\t}\n\n\tconst func_4 = option => option[0] === toolActive;\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"isActive\" in $$props) $$subscribe_isActive($$invalidate(1, isActive = $$props.isActive));\n\t\tif (\"isActiveFraction\" in $$props) $$subscribe_isActiveFraction($$invalidate(2, isActiveFraction = $$props.isActiveFraction));\n\t\tif (\"isVisible\" in $$props) $$subscribe_isVisible($$invalidate(3, isVisible = $$props.isVisible));\n\t\tif (\"stores\" in $$props) $$invalidate(53, stores = $$props.stores);\n\t\tif (\"locale\" in $$props) $$invalidate(4, locale = $$props.locale);\n\t\tif (\"shapes\" in $$props) $$subscribe_shapes($$invalidate(5, shapes = $$props.shapes));\n\t\tif (\"tools\" in $$props) $$invalidate(54, tools = $$props.tools);\n\t\tif (\"toolShapes\" in $$props) $$invalidate(55, toolShapes = $$props.toolShapes);\n\t\tif (\"toolActive\" in $$props) $$invalidate(0, toolActive = $$props.toolActive);\n\t\tif (\"shapeControls\" in $$props) $$invalidate(6, shapeControls = $$props.shapeControls);\n\t\tif (\"enableButtonFlipVertical\" in $$props) $$invalidate(7, enableButtonFlipVertical = $$props.enableButtonFlipVertical);\n\t\tif (\"enablePresetSelectImage\" in $$props) $$invalidate(8, enablePresetSelectImage = $$props.enablePresetSelectImage);\n\t\tif (\"shapePresets\" in $$props) $$invalidate(9, shapePresets = $$props.shapePresets);\n\t\tif (\"utilKey\" in $$props) $$invalidate(56, utilKey = $$props.utilKey);\n\t\tif (\"mapScreenPointToImagePoint\" in $$props) $$invalidate(10, mapScreenPointToImagePoint = $$props.mapScreenPointToImagePoint);\n\t\tif (\"mapImagePointToScreenPoint\" in $$props) $$invalidate(11, mapImagePointToScreenPoint = $$props.mapImagePointToScreenPoint);\n\t\tif (\"imageRotation\" in $$props) $$invalidate(12, imageRotation = $$props.imageRotation);\n\t\tif (\"imageFlipX\" in $$props) $$invalidate(57, imageFlipX = $$props.imageFlipX);\n\t\tif (\"imageFlipY\" in $$props) $$invalidate(58, imageFlipY = $$props.imageFlipY);\n\t\tif (\"parentRect\" in $$props) $$subscribe_parentRect($$invalidate(13, parentRect = $$props.parentRect));\n\t\tif (\"hooks\" in $$props) $$invalidate(14, hooks = $$props.hooks);\n\t};\n\n\tlet toolsFiltered;\n\tlet shouldRenderShapeEditor;\n\tlet markupOffset;\n\tlet markupShapeKeys;\n\tlet markupSelected;\n\tlet markupToolShape;\n\tlet markupToolStylesComputed;\n\tlet markupShapeSelected;\n\tlet shouldRenderPresets;\n\tlet ping;\n\tlet computedScrollElasticity;\n\tlet footerStyle;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*shapePresets*/ 512 | $$self.$$.dirty[1] & /*tools*/ 8388608) {\n\t\t\t// remove presets tool if no shape presets defined\n\t\t\t $$invalidate(17, toolsFiltered = shapePresets.length === 0\n\t\t\t? tools.filter(tool => tool[0] !== \"preset\")\n\t\t\t: tools);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*utilKey*/ 33554432 | $$self.$$.dirty[2] & /*$isActive, $imagePreviewModifiers*/ 6144) {\n\t\t\t//\n\t\t\t// enable seeing the markup outlines outside of the crop area\n\t\t\t// \n\t\t\t if ($isActive) {\n\t\t\t\tset_store_value(imagePreviewModifiers, $imagePreviewModifiers[utilKey] = { maskMarkupOpacity: 0.85 }, $imagePreviewModifiers);\n\t\t\t} else {\n\t\t\t\tdelete $imagePreviewModifiers[utilKey];\n\t\t\t}\n\t\t}\n\n\t\tif ($$self.$$.dirty[2] & /*$isVisible*/ 16384) {\n\t\t\t $$invalidate(19, shouldRenderShapeEditor = $isVisible);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$utilRect, $stageRect*/ 6291456) {\n\t\t\t $$invalidate(20, markupOffset = $utilRect && vectorCreate($stageRect.x - $utilRect.x, $stageRect.y - $utilRect.y));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*toolActive, markupEditor*/ 32769) {\n\t\t\t// if tool is changed, deselect markup items\n\t\t\t if (toolActive && markupEditor) markupEditor.blurShapes();\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*shapeControls*/ 64) {\n\t\t\t $$invalidate(77, markupShapeKeys = Object.keys(shapeControls));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$shapes*/ 8388608) {\n\t\t\t $$invalidate(78, markupSelected = ($shapes.filter(shapeIsSelected) || [])[0]);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*toolActive*/ 1 | $$self.$$.dirty[1] & /*toolShapes*/ 16777216 | $$self.$$.dirty[2] & /*$isActive*/ 2048) {\n\t\t\t $$invalidate(79, markupToolShape = $isActive && (toolShapes[toolActive]\n\t\t\t? shapeFormat(shapeDeepCopy(toolShapes[toolActive][0]))\n\t\t\t: {}));\n\t\t}\n\n\t\tif ($$self.$$.dirty[2] & /*markupToolShape, markupShapeKeys, markupToolStyles*/ 164096) {\n\t\t\t $$invalidate(75, markupToolStylesComputed = markupToolShape && Object.keys(markupToolShape).reduce(\n\t\t\t\t(prev, key) => {\n\t\t\t\t\tconst isDisableStyleProp = key === \"disableStyle\";\n\t\t\t\t\tconst isStylableProp = markupShapeKeys.find(shapeKey => shapeKey.split(\"_\").includes(key));\n\n\t\t\t\t\t// skip props that can't be styled, but keep all `disable` props\n\t\t\t\t\tif (!isDisableStyleProp && !isStylableProp) return prev;\n\n\t\t\t\t\t// apply this style\n\t\t\t\t\tprev[key] = markupToolStyles[key] || markupToolShape[key];\n\n\t\t\t\t\treturn prev;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t));\n\t\t}\n\n\t\tif ($$self.$$.dirty[2] & /*markupSelected, markupToolStylesComputed*/ 73728) {\n\t\t\t $$invalidate(24, markupShapeSelected = markupSelected || markupToolStylesComputed);\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*$isActiveFraction, toolActive, shapePresets, enablePresetSelectImage*/ 67109633) {\n\t\t\t//\n\t\t\t// presets\n\t\t\t//\n\t\t\t $$invalidate(25, shouldRenderPresets = $isActiveFraction > 0 && toolActive === \"preset\" && (shapePresets.length > 0 || enablePresetSelectImage));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*pingHub*/ 65536) {\n\t\t\t $$invalidate(28, ping = pingHub && createPingDispatcher(pingHub));\n\t\t}\n\n\t\tif ($$self.$$.dirty[2] & /*$isActive*/ 2048) {\n\t\t\t footerOffset.set($isActive ? 0 : 20);\n\t\t}\n\n\t\tif ($$self.$$.dirty[2] & /*$footerOffset*/ 524288) {\n\t\t\t $$invalidate(30, footerStyle = $footerOffset\n\t\t\t? `transform: translateY(${$footerOffset}px)`\n\t\t\t: undefined);\n\t\t}\n\t};\n\n\t $$invalidate(29, computedScrollElasticity = elasticityMultiplier * scrollElasticity);\n\n\treturn [\n\t\ttoolActive,\n\t\tisActive,\n\t\tisActiveFraction,\n\t\tisVisible,\n\t\tlocale,\n\t\tshapes,\n\t\tshapeControls,\n\t\tenableButtonFlipVertical,\n\t\tenablePresetSelectImage,\n\t\tshapePresets,\n\t\tmapScreenPointToImagePoint,\n\t\tmapImagePointToScreenPoint,\n\t\timageRotation,\n\t\tparentRect,\n\t\thooks,\n\t\tmarkupEditor,\n\t\tpingHub,\n\t\ttoolsFiltered,\n\t\t$rootRect,\n\t\tshouldRenderShapeEditor,\n\t\tmarkupOffset,\n\t\t$utilRect,\n\t\t$stageRect,\n\t\t$shapes,\n\t\tmarkupShapeSelected,\n\t\tshouldRenderPresets,\n\t\t$isActiveFraction,\n\t\t$parentRect,\n\t\tping,\n\t\tcomputedScrollElasticity,\n\t\tfooterStyle,\n\t\t$imageOverlayMarkup,\n\t\t$presentationScalar,\n\t\trootRect,\n\t\tstageRect,\n\t\tutilRect,\n\t\timageOverlayMarkup,\n\t\timagePreviewModifiers,\n\t\timageCropRect,\n\t\tpresentationScalar,\n\t\tupdateActiveTool,\n\t\thandleInteractionStart,\n\t\thandleInteractionUpdate,\n\t\thandleInteractionRelease,\n\t\thandleInteractionEnd,\n\t\thandleUpdateSelectedMarkupShape,\n\t\thandleGrabPreset,\n\t\thandleDragPreset,\n\t\thandleDropPreset,\n\t\thandleAddPreset,\n\t\thandleDropFiles,\n\t\thandleMarkupUpdate,\n\t\tfooterOffset,\n\t\tstores,\n\t\ttools,\n\t\ttoolShapes,\n\t\tutilKey,\n\t\timageFlipX,\n\t\timageFlipY,\n\t\tfunc,\n\t\tfunc_1,\n\t\tfunc_2,\n\t\tfunc_3,\n\t\tshapelayouteditor_binding,\n\t\tshapelayouteditor_markup_binding,\n\t\tshapelayouteditor_ui_binding,\n\t\tmeasure_handler_1,\n\t\tdiv_binding,\n\t\tfunc_4,\n\t\tmeasure_handler\n\t];\n}\n\nclass ShapeUtil extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$C,\n\t\t\tcreate_fragment$C,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tisActive: 1,\n\t\t\t\tisActiveFraction: 2,\n\t\t\t\tisVisible: 3,\n\t\t\t\tstores: 53,\n\t\t\t\tlocale: 4,\n\t\t\t\tshapes: 5,\n\t\t\t\ttools: 54,\n\t\t\t\ttoolShapes: 55,\n\t\t\t\ttoolActive: 0,\n\t\t\t\tshapeControls: 6,\n\t\t\t\tenableButtonFlipVertical: 7,\n\t\t\t\tenablePresetSelectImage: 8,\n\t\t\t\tshapePresets: 9,\n\t\t\t\tutilKey: 56,\n\t\t\t\tmapScreenPointToImagePoint: 10,\n\t\t\t\tmapImagePointToScreenPoint: 11,\n\t\t\t\timageRotation: 12,\n\t\t\t\timageFlipX: 57,\n\t\t\t\timageFlipY: 58,\n\t\t\t\tparentRect: 13,\n\t\t\t\thooks: 14\n\t\t\t},\n\t\t\t[-1, -1, -1]\n\t\t);\n\t}\n\n\tget isActive() {\n\t\treturn this.$$.ctx[1];\n\t}\n\n\tset isActive(isActive) {\n\t\tthis.$set({ isActive });\n\t\tflush();\n\t}\n\n\tget isActiveFraction() {\n\t\treturn this.$$.ctx[2];\n\t}\n\n\tset isActiveFraction(isActiveFraction) {\n\t\tthis.$set({ isActiveFraction });\n\t\tflush();\n\t}\n\n\tget isVisible() {\n\t\treturn this.$$.ctx[3];\n\t}\n\n\tset isVisible(isVisible) {\n\t\tthis.$set({ isVisible });\n\t\tflush();\n\t}\n\n\tget stores() {\n\t\treturn this.$$.ctx[53];\n\t}\n\n\tset stores(stores) {\n\t\tthis.$set({ stores });\n\t\tflush();\n\t}\n\n\tget locale() {\n\t\treturn this.$$.ctx[4];\n\t}\n\n\tset locale(locale) {\n\t\tthis.$set({ locale });\n\t\tflush();\n\t}\n\n\tget shapes() {\n\t\treturn this.$$.ctx[5];\n\t}\n\n\tset shapes(shapes) {\n\t\tthis.$set({ shapes });\n\t\tflush();\n\t}\n\n\tget tools() {\n\t\treturn this.$$.ctx[54];\n\t}\n\n\tset tools(tools) {\n\t\tthis.$set({ tools });\n\t\tflush();\n\t}\n\n\tget toolShapes() {\n\t\treturn this.$$.ctx[55];\n\t}\n\n\tset toolShapes(toolShapes) {\n\t\tthis.$set({ toolShapes });\n\t\tflush();\n\t}\n\n\tget toolActive() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tset toolActive(toolActive) {\n\t\tthis.$set({ toolActive });\n\t\tflush();\n\t}\n\n\tget shapeControls() {\n\t\treturn this.$$.ctx[6];\n\t}\n\n\tset shapeControls(shapeControls) {\n\t\tthis.$set({ shapeControls });\n\t\tflush();\n\t}\n\n\tget enableButtonFlipVertical() {\n\t\treturn this.$$.ctx[7];\n\t}\n\n\tset enableButtonFlipVertical(enableButtonFlipVertical) {\n\t\tthis.$set({ enableButtonFlipVertical });\n\t\tflush();\n\t}\n\n\tget enablePresetSelectImage() {\n\t\treturn this.$$.ctx[8];\n\t}\n\n\tset enablePresetSelectImage(enablePresetSelectImage) {\n\t\tthis.$set({ enablePresetSelectImage });\n\t\tflush();\n\t}\n\n\tget shapePresets() {\n\t\treturn this.$$.ctx[9];\n\t}\n\n\tset shapePresets(shapePresets) {\n\t\tthis.$set({ shapePresets });\n\t\tflush();\n\t}\n\n\tget utilKey() {\n\t\treturn this.$$.ctx[56];\n\t}\n\n\tset utilKey(utilKey) {\n\t\tthis.$set({ utilKey });\n\t\tflush();\n\t}\n\n\tget mapScreenPointToImagePoint() {\n\t\treturn this.$$.ctx[10];\n\t}\n\n\tset mapScreenPointToImagePoint(mapScreenPointToImagePoint) {\n\t\tthis.$set({ mapScreenPointToImagePoint });\n\t\tflush();\n\t}\n\n\tget mapImagePointToScreenPoint() {\n\t\treturn this.$$.ctx[11];\n\t}\n\n\tset mapImagePointToScreenPoint(mapImagePointToScreenPoint) {\n\t\tthis.$set({ mapImagePointToScreenPoint });\n\t\tflush();\n\t}\n\n\tget imageRotation() {\n\t\treturn this.$$.ctx[12];\n\t}\n\n\tset imageRotation(imageRotation) {\n\t\tthis.$set({ imageRotation });\n\t\tflush();\n\t}\n\n\tget imageFlipX() {\n\t\treturn this.$$.ctx[57];\n\t}\n\n\tset imageFlipX(imageFlipX) {\n\t\tthis.$set({ imageFlipX });\n\t\tflush();\n\t}\n\n\tget imageFlipY() {\n\t\treturn this.$$.ctx[58];\n\t}\n\n\tset imageFlipY(imageFlipY) {\n\t\tthis.$set({ imageFlipY });\n\t\tflush();\n\t}\n\n\tget parentRect() {\n\t\treturn this.$$.ctx[13];\n\t}\n\n\tset parentRect(parentRect) {\n\t\tthis.$set({ parentRect });\n\t\tflush();\n\t}\n\n\tget hooks() {\n\t\treturn this.$$.ctx[14];\n\t}\n\n\tset hooks(hooks) {\n\t\tthis.$set({ hooks });\n\t\tflush();\n\t}\n}\n\nvar _mapImagePointToScreenPoint = (imagePoint, canvasSize, imageSize, imageOrigin, imageTranslation, imageRotation, imageScalar, imageFlipX, imageFlipY) => {\n    const mappedPoint = vectorClone(imagePoint);\n    const imageCenterX = imageSize.width * 0.5;\n    const imageCenterY = imageSize.height * 0.5;\n    const canvasCenterX = canvasSize.width * 0.5;\n    const canvasCenterY = canvasSize.height * 0.5;\n    const imageOffsetX = imageTranslation.x + imageOrigin.x;\n    const imageOffsetY = imageTranslation.y + imageOrigin.y;\n    if (imageFlipX)\n        mappedPoint.x = imageSize.width - mappedPoint.x;\n    if (imageFlipY)\n        mappedPoint.y = imageSize.height - mappedPoint.y;\n    // rotate around image center based on if image is rotated\n    const c = Math.cos(imageRotation);\n    const s = Math.sin(imageRotation);\n    mappedPoint.x -= imageCenterX;\n    mappedPoint.y -= imageCenterY;\n    const rx = mappedPoint.x * c - mappedPoint.y * s;\n    const ry = mappedPoint.x * s + mappedPoint.y * c;\n    mappedPoint.x = imageCenterX + rx;\n    mappedPoint.y = imageCenterY + ry;\n    // position based on screen transforms\n    mappedPoint.x *= imageScalar;\n    mappedPoint.y *= imageScalar;\n    mappedPoint.x += canvasCenterX;\n    mappedPoint.y += canvasCenterY;\n    mappedPoint.x += imageOffsetX;\n    mappedPoint.y += imageOffsetY;\n    mappedPoint.x -= imageCenterX * imageScalar;\n    mappedPoint.y -= imageCenterY * imageScalar;\n    const tx = (imageTranslation.x - imageOffsetX) * imageScalar;\n    const ty = (imageTranslation.y - imageOffsetY) * imageScalar;\n    const rtx = tx * c - ty * s;\n    const rty = tx * s + ty * c;\n    mappedPoint.x += rtx;\n    mappedPoint.y += rty;\n    return mappedPoint;\n};\n\nvar _mapScreenPointToImagePoint = (screenPoint, canvasSize, imageSize, imageOrigin, imageTranslation, imageRotation, imageScalar, imageFlipX, imageFlipY) => {\n    const mappedPoint = vectorClone(screenPoint);\n    const imageCenter = sizeCenter(imageSize);\n    const canvasCenter = sizeCenter(canvasSize);\n    const imageOffset = vectorCreate(imageTranslation.x + imageOrigin.x, imageTranslation.y + imageOrigin.y);\n    const c = Math.cos(imageRotation);\n    const s = Math.sin(imageRotation);\n    mappedPoint.x -= canvasCenter.x;\n    mappedPoint.y -= canvasCenter.y;\n    const tx = (imageTranslation.x - imageOffset.x) * imageScalar;\n    const ty = (imageTranslation.y - imageOffset.y) * imageScalar;\n    const rtx = tx * c - ty * s;\n    const rty = tx * s + ty * c;\n    mappedPoint.x -= rtx;\n    mappedPoint.y -= rty;\n    mappedPoint.x -= imageOffset.x;\n    mappedPoint.y -= imageOffset.y;\n    mappedPoint.x /= imageScalar;\n    mappedPoint.y /= imageScalar;\n    const rx = mappedPoint.x * c + mappedPoint.y * s;\n    const ry = mappedPoint.x * s - mappedPoint.y * c;\n    mappedPoint.x = rx;\n    mappedPoint.y = -ry;\n    mappedPoint.x += imageCenter.x;\n    mappedPoint.y += imageCenter.y;\n    if (imageFlipX)\n        mappedPoint.x = imageSize.width - mappedPoint.x;\n    if (imageFlipY)\n        mappedPoint.y = imageSize.height - mappedPoint.y;\n    return mappedPoint;\n};\n\n/* src/core/ui/plugins/annotate/index.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$D(ctx) {\n\tlet shapeutil;\n\tlet current;\n\n\tshapeutil = new ShapeUtil({\n\t\t\tprops: {\n\t\t\t\tstores: /*stores*/ ctx[3],\n\t\t\t\tlocale: /*locale*/ ctx[4],\n\t\t\t\tisActive: /*isActive*/ ctx[0],\n\t\t\t\tisActiveFraction: /*isActiveFraction*/ ctx[1],\n\t\t\t\tisVisible: /*isVisible*/ ctx[2],\n\t\t\t\tmapScreenPointToImagePoint: /*mapScreenPointToImagePoint*/ ctx[31],\n\t\t\t\tmapImagePointToScreenPoint: /*mapImagePointToScreenPoint*/ ctx[32],\n\t\t\t\tutilKey: \"annotate\",\n\t\t\t\timageRotation: /*$imageRotation*/ ctx[23],\n\t\t\t\timageFlipX: /*$imageFlipX*/ ctx[21],\n\t\t\t\timageFlipY: /*$imageFlipY*/ ctx[22],\n\t\t\t\tshapes: /*imageAnnotation*/ ctx[25],\n\t\t\t\ttools: /*annotateTools*/ ctx[8] || /*markupEditorToolbar*/ ctx[5],\n\t\t\t\ttoolShapes: /*annotateToolShapes*/ ctx[9] || /*markupEditorToolStyles*/ ctx[6],\n\t\t\t\ttoolActive: /*annotateActiveTool*/ ctx[11],\n\t\t\t\tshapeControls: /*annotateShapeControls*/ ctx[10] || /*markupEditorShapeStyleControls*/ ctx[7],\n\t\t\t\tshapePresets: /*annotatePresets*/ ctx[14],\n\t\t\t\tenableButtonFlipVertical: /*annotateEnableButtonFlipVertical*/ ctx[12],\n\t\t\t\tparentRect: /*imageSize*/ ctx[26],\n\t\t\t\tenablePresetSelectImage: /*annotateEnableSelectImagePreset*/ ctx[13],\n\t\t\t\thooks: {\n\t\t\t\t\twillRenderShapeControls: /*willRenderShapeControls*/ ctx[15],\n\t\t\t\t\tbeforeAddShape: /*beforeAddShape*/ ctx[16],\n\t\t\t\t\tbeforeRemoveShape: /*beforeRemoveShape*/ ctx[17],\n\t\t\t\t\tbeforeDeselectShape: /*beforeDeselectShape*/ ctx[18],\n\t\t\t\t\tbeforeSelectShape: /*beforeSelectShape*/ ctx[19],\n\t\t\t\t\tbeforeUpdateShape: /*beforeUpdateShape*/ ctx[20]\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\tshapeutil.$on(\"measure\", /*measure_handler*/ ctx[34]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapeutil.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapeutil, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapeutil_changes = {};\n\t\t\tif (dirty[0] & /*stores*/ 8) shapeutil_changes.stores = /*stores*/ ctx[3];\n\t\t\tif (dirty[0] & /*locale*/ 16) shapeutil_changes.locale = /*locale*/ ctx[4];\n\t\t\tif (dirty[0] & /*isActive*/ 1) shapeutil_changes.isActive = /*isActive*/ ctx[0];\n\t\t\tif (dirty[0] & /*isActiveFraction*/ 2) shapeutil_changes.isActiveFraction = /*isActiveFraction*/ ctx[1];\n\t\t\tif (dirty[0] & /*isVisible*/ 4) shapeutil_changes.isVisible = /*isVisible*/ ctx[2];\n\t\t\tif (dirty[0] & /*$imageRotation*/ 8388608) shapeutil_changes.imageRotation = /*$imageRotation*/ ctx[23];\n\t\t\tif (dirty[0] & /*$imageFlipX*/ 2097152) shapeutil_changes.imageFlipX = /*$imageFlipX*/ ctx[21];\n\t\t\tif (dirty[0] & /*$imageFlipY*/ 4194304) shapeutil_changes.imageFlipY = /*$imageFlipY*/ ctx[22];\n\t\t\tif (dirty[0] & /*annotateTools, markupEditorToolbar*/ 288) shapeutil_changes.tools = /*annotateTools*/ ctx[8] || /*markupEditorToolbar*/ ctx[5];\n\t\t\tif (dirty[0] & /*annotateToolShapes, markupEditorToolStyles*/ 576) shapeutil_changes.toolShapes = /*annotateToolShapes*/ ctx[9] || /*markupEditorToolStyles*/ ctx[6];\n\t\t\tif (dirty[0] & /*annotateActiveTool*/ 2048) shapeutil_changes.toolActive = /*annotateActiveTool*/ ctx[11];\n\t\t\tif (dirty[0] & /*annotateShapeControls, markupEditorShapeStyleControls*/ 1152) shapeutil_changes.shapeControls = /*annotateShapeControls*/ ctx[10] || /*markupEditorShapeStyleControls*/ ctx[7];\n\t\t\tif (dirty[0] & /*annotatePresets*/ 16384) shapeutil_changes.shapePresets = /*annotatePresets*/ ctx[14];\n\t\t\tif (dirty[0] & /*annotateEnableButtonFlipVertical*/ 4096) shapeutil_changes.enableButtonFlipVertical = /*annotateEnableButtonFlipVertical*/ ctx[12];\n\t\t\tif (dirty[0] & /*annotateEnableSelectImagePreset*/ 8192) shapeutil_changes.enablePresetSelectImage = /*annotateEnableSelectImagePreset*/ ctx[13];\n\n\t\t\tif (dirty[0] & /*willRenderShapeControls, beforeAddShape, beforeRemoveShape, beforeDeselectShape, beforeSelectShape, beforeUpdateShape*/ 2064384) shapeutil_changes.hooks = {\n\t\t\t\twillRenderShapeControls: /*willRenderShapeControls*/ ctx[15],\n\t\t\t\tbeforeAddShape: /*beforeAddShape*/ ctx[16],\n\t\t\t\tbeforeRemoveShape: /*beforeRemoveShape*/ ctx[17],\n\t\t\t\tbeforeDeselectShape: /*beforeDeselectShape*/ ctx[18],\n\t\t\t\tbeforeSelectShape: /*beforeSelectShape*/ ctx[19],\n\t\t\t\tbeforeUpdateShape: /*beforeUpdateShape*/ ctx[20]\n\t\t\t};\n\n\t\t\tshapeutil.$set(shapeutil_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapeutil.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapeutil.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapeutil, detaching);\n\t\t}\n\t};\n}\n\nfunction instance$D($$self, $$props, $$invalidate) {\n\tlet $rootRect;\n\tlet $imageSize;\n\tlet $imageTransforms;\n\tlet $imageFlipX;\n\tlet $imageFlipY;\n\tlet $imageRotation;\n\tconst name = \"annotate\";\n\tlet { isActive } = $$props;\n\tlet { isActiveFraction } = $$props;\n\tlet { isVisible } = $$props;\n\tlet { stores } = $$props;\n\tlet { locale = {} } = $$props;\n\tlet { markupEditorToolbar = undefined } = $$props;\n\tlet { markupEditorToolStyles = undefined } = $$props;\n\tlet { markupEditorShapeStyleControls = undefined } = $$props;\n\tlet { annotateTools = undefined } = $$props;\n\tlet { annotateToolShapes = undefined } = $$props;\n\tlet { annotateShapeControls = undefined } = $$props;\n\tlet { annotateActiveTool = \"sharpie\" } = $$props;\n\tlet { annotateEnableButtonFlipVertical = false } = $$props;\n\tlet { annotateEnableSelectImagePreset = false } = $$props;\n\tlet { annotatePresets = [] } = $$props;\n\tlet { willRenderShapeControls = undefined } = $$props;\n\tlet { beforeAddShape = undefined } = $$props;\n\tlet { beforeRemoveShape = undefined } = $$props;\n\tlet { beforeDeselectShape = undefined } = $$props;\n\tlet { beforeSelectShape = undefined } = $$props;\n\tlet { beforeUpdateShape = undefined } = $$props;\n\n\t// connect filter choice to stores\n\tconst { rootRect, imageAnnotation, imageSize, imageTransforms, imageRotation, imageFlipX, imageFlipY } = stores;\n\n\tcomponent_subscribe($$self, rootRect, value => $$invalidate(35, $rootRect = value));\n\tcomponent_subscribe($$self, imageSize, value => $$invalidate(36, $imageSize = value));\n\tcomponent_subscribe($$self, imageTransforms, value => $$invalidate(37, $imageTransforms = value));\n\tcomponent_subscribe($$self, imageRotation, value => $$invalidate(23, $imageRotation = value));\n\tcomponent_subscribe($$self, imageFlipX, value => $$invalidate(21, $imageFlipX = value));\n\tcomponent_subscribe($$self, imageFlipY, value => $$invalidate(22, $imageFlipY = value));\n\n\t//\n\t// Mapping coordinates\n\t//\n\tconst mapScreenPointToImagePoint = point => _mapScreenPointToImagePoint(point, $rootRect, $imageSize, $imageTransforms.origin, $imageTransforms.translation, $imageTransforms.rotation.z, $imageTransforms.scale, $imageFlipX, $imageFlipY);\n\n\tconst mapImagePointToScreenPoint = point => _mapImagePointToScreenPoint(point, $rootRect, $imageSize, $imageTransforms.origin, $imageTransforms.translation, $imageTransforms.rotation.z, $imageTransforms.scale, $imageFlipX, $imageFlipY);\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"isActive\" in $$props) $$invalidate(0, isActive = $$props.isActive);\n\t\tif (\"isActiveFraction\" in $$props) $$invalidate(1, isActiveFraction = $$props.isActiveFraction);\n\t\tif (\"isVisible\" in $$props) $$invalidate(2, isVisible = $$props.isVisible);\n\t\tif (\"stores\" in $$props) $$invalidate(3, stores = $$props.stores);\n\t\tif (\"locale\" in $$props) $$invalidate(4, locale = $$props.locale);\n\t\tif (\"markupEditorToolbar\" in $$props) $$invalidate(5, markupEditorToolbar = $$props.markupEditorToolbar);\n\t\tif (\"markupEditorToolStyles\" in $$props) $$invalidate(6, markupEditorToolStyles = $$props.markupEditorToolStyles);\n\t\tif (\"markupEditorShapeStyleControls\" in $$props) $$invalidate(7, markupEditorShapeStyleControls = $$props.markupEditorShapeStyleControls);\n\t\tif (\"annotateTools\" in $$props) $$invalidate(8, annotateTools = $$props.annotateTools);\n\t\tif (\"annotateToolShapes\" in $$props) $$invalidate(9, annotateToolShapes = $$props.annotateToolShapes);\n\t\tif (\"annotateShapeControls\" in $$props) $$invalidate(10, annotateShapeControls = $$props.annotateShapeControls);\n\t\tif (\"annotateActiveTool\" in $$props) $$invalidate(11, annotateActiveTool = $$props.annotateActiveTool);\n\t\tif (\"annotateEnableButtonFlipVertical\" in $$props) $$invalidate(12, annotateEnableButtonFlipVertical = $$props.annotateEnableButtonFlipVertical);\n\t\tif (\"annotateEnableSelectImagePreset\" in $$props) $$invalidate(13, annotateEnableSelectImagePreset = $$props.annotateEnableSelectImagePreset);\n\t\tif (\"annotatePresets\" in $$props) $$invalidate(14, annotatePresets = $$props.annotatePresets);\n\t\tif (\"willRenderShapeControls\" in $$props) $$invalidate(15, willRenderShapeControls = $$props.willRenderShapeControls);\n\t\tif (\"beforeAddShape\" in $$props) $$invalidate(16, beforeAddShape = $$props.beforeAddShape);\n\t\tif (\"beforeRemoveShape\" in $$props) $$invalidate(17, beforeRemoveShape = $$props.beforeRemoveShape);\n\t\tif (\"beforeDeselectShape\" in $$props) $$invalidate(18, beforeDeselectShape = $$props.beforeDeselectShape);\n\t\tif (\"beforeSelectShape\" in $$props) $$invalidate(19, beforeSelectShape = $$props.beforeSelectShape);\n\t\tif (\"beforeUpdateShape\" in $$props) $$invalidate(20, beforeUpdateShape = $$props.beforeUpdateShape);\n\t};\n\n\treturn [\n\t\tisActive,\n\t\tisActiveFraction,\n\t\tisVisible,\n\t\tstores,\n\t\tlocale,\n\t\tmarkupEditorToolbar,\n\t\tmarkupEditorToolStyles,\n\t\tmarkupEditorShapeStyleControls,\n\t\tannotateTools,\n\t\tannotateToolShapes,\n\t\tannotateShapeControls,\n\t\tannotateActiveTool,\n\t\tannotateEnableButtonFlipVertical,\n\t\tannotateEnableSelectImagePreset,\n\t\tannotatePresets,\n\t\twillRenderShapeControls,\n\t\tbeforeAddShape,\n\t\tbeforeRemoveShape,\n\t\tbeforeDeselectShape,\n\t\tbeforeSelectShape,\n\t\tbeforeUpdateShape,\n\t\t$imageFlipX,\n\t\t$imageFlipY,\n\t\t$imageRotation,\n\t\trootRect,\n\t\timageAnnotation,\n\t\timageSize,\n\t\timageTransforms,\n\t\timageRotation,\n\t\timageFlipX,\n\t\timageFlipY,\n\t\tmapScreenPointToImagePoint,\n\t\tmapImagePointToScreenPoint,\n\t\tname,\n\t\tmeasure_handler\n\t];\n}\n\nclass Annotate extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$D,\n\t\t\tcreate_fragment$D,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tname: 33,\n\t\t\t\tisActive: 0,\n\t\t\t\tisActiveFraction: 1,\n\t\t\t\tisVisible: 2,\n\t\t\t\tstores: 3,\n\t\t\t\tlocale: 4,\n\t\t\t\tmarkupEditorToolbar: 5,\n\t\t\t\tmarkupEditorToolStyles: 6,\n\t\t\t\tmarkupEditorShapeStyleControls: 7,\n\t\t\t\tannotateTools: 8,\n\t\t\t\tannotateToolShapes: 9,\n\t\t\t\tannotateShapeControls: 10,\n\t\t\t\tannotateActiveTool: 11,\n\t\t\t\tannotateEnableButtonFlipVertical: 12,\n\t\t\t\tannotateEnableSelectImagePreset: 13,\n\t\t\t\tannotatePresets: 14,\n\t\t\t\twillRenderShapeControls: 15,\n\t\t\t\tbeforeAddShape: 16,\n\t\t\t\tbeforeRemoveShape: 17,\n\t\t\t\tbeforeDeselectShape: 18,\n\t\t\t\tbeforeSelectShape: 19,\n\t\t\t\tbeforeUpdateShape: 20\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n\n\tget name() {\n\t\treturn this.$$.ctx[33];\n\t}\n\n\tget isActive() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tset isActive(isActive) {\n\t\tthis.$set({ isActive });\n\t\tflush();\n\t}\n\n\tget isActiveFraction() {\n\t\treturn this.$$.ctx[1];\n\t}\n\n\tset isActiveFraction(isActiveFraction) {\n\t\tthis.$set({ isActiveFraction });\n\t\tflush();\n\t}\n\n\tget isVisible() {\n\t\treturn this.$$.ctx[2];\n\t}\n\n\tset isVisible(isVisible) {\n\t\tthis.$set({ isVisible });\n\t\tflush();\n\t}\n\n\tget stores() {\n\t\treturn this.$$.ctx[3];\n\t}\n\n\tset stores(stores) {\n\t\tthis.$set({ stores });\n\t\tflush();\n\t}\n\n\tget locale() {\n\t\treturn this.$$.ctx[4];\n\t}\n\n\tset locale(locale) {\n\t\tthis.$set({ locale });\n\t\tflush();\n\t}\n\n\tget markupEditorToolbar() {\n\t\treturn this.$$.ctx[5];\n\t}\n\n\tset markupEditorToolbar(markupEditorToolbar) {\n\t\tthis.$set({ markupEditorToolbar });\n\t\tflush();\n\t}\n\n\tget markupEditorToolStyles() {\n\t\treturn this.$$.ctx[6];\n\t}\n\n\tset markupEditorToolStyles(markupEditorToolStyles) {\n\t\tthis.$set({ markupEditorToolStyles });\n\t\tflush();\n\t}\n\n\tget markupEditorShapeStyleControls() {\n\t\treturn this.$$.ctx[7];\n\t}\n\n\tset markupEditorShapeStyleControls(markupEditorShapeStyleControls) {\n\t\tthis.$set({ markupEditorShapeStyleControls });\n\t\tflush();\n\t}\n\n\tget annotateTools() {\n\t\treturn this.$$.ctx[8];\n\t}\n\n\tset annotateTools(annotateTools) {\n\t\tthis.$set({ annotateTools });\n\t\tflush();\n\t}\n\n\tget annotateToolShapes() {\n\t\treturn this.$$.ctx[9];\n\t}\n\n\tset annotateToolShapes(annotateToolShapes) {\n\t\tthis.$set({ annotateToolShapes });\n\t\tflush();\n\t}\n\n\tget annotateShapeControls() {\n\t\treturn this.$$.ctx[10];\n\t}\n\n\tset annotateShapeControls(annotateShapeControls) {\n\t\tthis.$set({ annotateShapeControls });\n\t\tflush();\n\t}\n\n\tget annotateActiveTool() {\n\t\treturn this.$$.ctx[11];\n\t}\n\n\tset annotateActiveTool(annotateActiveTool) {\n\t\tthis.$set({ annotateActiveTool });\n\t\tflush();\n\t}\n\n\tget annotateEnableButtonFlipVertical() {\n\t\treturn this.$$.ctx[12];\n\t}\n\n\tset annotateEnableButtonFlipVertical(annotateEnableButtonFlipVertical) {\n\t\tthis.$set({ annotateEnableButtonFlipVertical });\n\t\tflush();\n\t}\n\n\tget annotateEnableSelectImagePreset() {\n\t\treturn this.$$.ctx[13];\n\t}\n\n\tset annotateEnableSelectImagePreset(annotateEnableSelectImagePreset) {\n\t\tthis.$set({ annotateEnableSelectImagePreset });\n\t\tflush();\n\t}\n\n\tget annotatePresets() {\n\t\treturn this.$$.ctx[14];\n\t}\n\n\tset annotatePresets(annotatePresets) {\n\t\tthis.$set({ annotatePresets });\n\t\tflush();\n\t}\n\n\tget willRenderShapeControls() {\n\t\treturn this.$$.ctx[15];\n\t}\n\n\tset willRenderShapeControls(willRenderShapeControls) {\n\t\tthis.$set({ willRenderShapeControls });\n\t\tflush();\n\t}\n\n\tget beforeAddShape() {\n\t\treturn this.$$.ctx[16];\n\t}\n\n\tset beforeAddShape(beforeAddShape) {\n\t\tthis.$set({ beforeAddShape });\n\t\tflush();\n\t}\n\n\tget beforeRemoveShape() {\n\t\treturn this.$$.ctx[17];\n\t}\n\n\tset beforeRemoveShape(beforeRemoveShape) {\n\t\tthis.$set({ beforeRemoveShape });\n\t\tflush();\n\t}\n\n\tget beforeDeselectShape() {\n\t\treturn this.$$.ctx[18];\n\t}\n\n\tset beforeDeselectShape(beforeDeselectShape) {\n\t\tthis.$set({ beforeDeselectShape });\n\t\tflush();\n\t}\n\n\tget beforeSelectShape() {\n\t\treturn this.$$.ctx[19];\n\t}\n\n\tset beforeSelectShape(beforeSelectShape) {\n\t\tthis.$set({ beforeSelectShape });\n\t\tflush();\n\t}\n\n\tget beforeUpdateShape() {\n\t\treturn this.$$.ctx[20];\n\t}\n\n\tset beforeUpdateShape(beforeUpdateShape) {\n\t\tthis.$set({ beforeUpdateShape });\n\t\tflush();\n\t}\n}\n\n// @ts-ignore\nvar index$3 = { util: ['annotate', Annotate] };\n\n/* src/core/ui/plugins/decorate/index.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$E(ctx) {\n\tlet shapeutil;\n\tlet current;\n\n\tshapeutil = new ShapeUtil({\n\t\t\tprops: {\n\t\t\t\tstores: /*stores*/ ctx[3],\n\t\t\t\tlocale: /*locale*/ ctx[4],\n\t\t\t\tisActive: /*isActive*/ ctx[0],\n\t\t\t\tisActiveFraction: /*isActiveFraction*/ ctx[1],\n\t\t\t\tisVisible: /*isVisible*/ ctx[2],\n\t\t\t\tmapScreenPointToImagePoint: /*mapScreenPointToImagePoint*/ ctx[24],\n\t\t\t\tmapImagePointToScreenPoint: /*mapImagePointToScreenPoint*/ ctx[25],\n\t\t\t\tutilKey: \"decorate\",\n\t\t\t\tshapes: /*imageDecoration*/ ctx[21],\n\t\t\t\ttools: /*decorateTools*/ ctx[8] || /*markupEditorToolbar*/ ctx[5],\n\t\t\t\ttoolShapes: /*decorateToolShapes*/ ctx[9] || /*markupEditorToolStyles*/ ctx[6],\n\t\t\t\ttoolActive: /*decorateActiveTool*/ ctx[11],\n\t\t\t\tshapeControls: /*decorateShapeControls*/ ctx[10] || /*markupEditorShapeStyleControls*/ ctx[7],\n\t\t\t\tshapePresets: /*decoratePresets*/ ctx[13],\n\t\t\t\tenableButtonFlipVertical: /*decorateEnableButtonFlipVertical*/ ctx[12],\n\t\t\t\tparentRect: /*imageCropRect*/ ctx[20],\n\t\t\t\thooks: {\n\t\t\t\t\twillRenderShapeControls: /*willRenderShapeControls*/ ctx[14],\n\t\t\t\t\tbeforeAddShape: /*beforeAddShape*/ ctx[15],\n\t\t\t\t\tbeforeRemoveShape: /*beforeRemoveShape*/ ctx[16],\n\t\t\t\t\tbeforeDeselectShape: /*beforeDeselectShape*/ ctx[17],\n\t\t\t\t\tbeforeSelectShape: /*beforeSelectShape*/ ctx[18],\n\t\t\t\t\tbeforeUpdateShape: /*beforeUpdateShape*/ ctx[19]\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\tshapeutil.$on(\"measure\", /*measure_handler*/ ctx[28]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapeutil.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapeutil, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, [dirty]) {\n\t\t\tconst shapeutil_changes = {};\n\t\t\tif (dirty & /*stores*/ 8) shapeutil_changes.stores = /*stores*/ ctx[3];\n\t\t\tif (dirty & /*locale*/ 16) shapeutil_changes.locale = /*locale*/ ctx[4];\n\t\t\tif (dirty & /*isActive*/ 1) shapeutil_changes.isActive = /*isActive*/ ctx[0];\n\t\t\tif (dirty & /*isActiveFraction*/ 2) shapeutil_changes.isActiveFraction = /*isActiveFraction*/ ctx[1];\n\t\t\tif (dirty & /*isVisible*/ 4) shapeutil_changes.isVisible = /*isVisible*/ ctx[2];\n\t\t\tif (dirty & /*decorateTools, markupEditorToolbar*/ 288) shapeutil_changes.tools = /*decorateTools*/ ctx[8] || /*markupEditorToolbar*/ ctx[5];\n\t\t\tif (dirty & /*decorateToolShapes, markupEditorToolStyles*/ 576) shapeutil_changes.toolShapes = /*decorateToolShapes*/ ctx[9] || /*markupEditorToolStyles*/ ctx[6];\n\t\t\tif (dirty & /*decorateActiveTool*/ 2048) shapeutil_changes.toolActive = /*decorateActiveTool*/ ctx[11];\n\t\t\tif (dirty & /*decorateShapeControls, markupEditorShapeStyleControls*/ 1152) shapeutil_changes.shapeControls = /*decorateShapeControls*/ ctx[10] || /*markupEditorShapeStyleControls*/ ctx[7];\n\t\t\tif (dirty & /*decoratePresets*/ 8192) shapeutil_changes.shapePresets = /*decoratePresets*/ ctx[13];\n\t\t\tif (dirty & /*decorateEnableButtonFlipVertical*/ 4096) shapeutil_changes.enableButtonFlipVertical = /*decorateEnableButtonFlipVertical*/ ctx[12];\n\n\t\t\tif (dirty & /*willRenderShapeControls, beforeAddShape, beforeRemoveShape, beforeDeselectShape, beforeSelectShape, beforeUpdateShape*/ 1032192) shapeutil_changes.hooks = {\n\t\t\t\twillRenderShapeControls: /*willRenderShapeControls*/ ctx[14],\n\t\t\t\tbeforeAddShape: /*beforeAddShape*/ ctx[15],\n\t\t\t\tbeforeRemoveShape: /*beforeRemoveShape*/ ctx[16],\n\t\t\t\tbeforeDeselectShape: /*beforeDeselectShape*/ ctx[17],\n\t\t\t\tbeforeSelectShape: /*beforeSelectShape*/ ctx[18],\n\t\t\t\tbeforeUpdateShape: /*beforeUpdateShape*/ ctx[19]\n\t\t\t};\n\n\t\t\tshapeutil.$set(shapeutil_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapeutil.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapeutil.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapeutil, detaching);\n\t\t}\n\t};\n}\n\nfunction instance$E($$self, $$props, $$invalidate) {\n\tlet $imageSelectionRectPresentation;\n\tlet $presentationScalar;\n\tconst name = \"decorate\";\n\tlet { isActive } = $$props;\n\tlet { isActiveFraction } = $$props;\n\tlet { isVisible } = $$props;\n\tlet { stores } = $$props;\n\tlet { locale = {} } = $$props;\n\tlet { markupEditorToolbar = undefined } = $$props;\n\tlet { markupEditorToolStyles = undefined } = $$props;\n\tlet { markupEditorShapeStyleControls = undefined } = $$props;\n\tlet { decorateTools = undefined } = $$props;\n\tlet { decorateToolShapes = undefined } = $$props;\n\tlet { decorateShapeControls = undefined } = $$props;\n\tlet { decorateActiveTool = \"sharpie\" } = $$props;\n\tlet { decorateEnableButtonFlipVertical = false } = $$props;\n\tlet { decorateEnableSelectImagePreset = false } = $$props;\n\tlet { decoratePresets = [] } = $$props;\n\tlet { willRenderShapeControls = undefined } = $$props;\n\tlet { beforeAddShape = undefined } = $$props;\n\tlet { beforeRemoveShape = undefined } = $$props;\n\tlet { beforeDeselectShape = undefined } = $$props;\n\tlet { beforeSelectShape = undefined } = $$props;\n\tlet { beforeUpdateShape = undefined } = $$props;\n\tconst { imageCropRect, imageDecoration, imageSelectionRectPresentation, presentationScalar } = stores;\n\tcomponent_subscribe($$self, imageSelectionRectPresentation, value => $$invalidate(29, $imageSelectionRectPresentation = value));\n\tcomponent_subscribe($$self, presentationScalar, value => $$invalidate(30, $presentationScalar = value));\n\n\tconst mapScreenPointToImagePoint = screenPoint => {\n\t\tconst mappedPoint = vectorClone(screenPoint);\n\t\tmappedPoint.x -= $imageSelectionRectPresentation.x;\n\t\tmappedPoint.y -= $imageSelectionRectPresentation.y;\n\t\tmappedPoint.x /= $presentationScalar;\n\t\tmappedPoint.y /= $presentationScalar;\n\t\treturn mappedPoint;\n\t};\n\n\tconst mapImagePointToScreenPoint = imagePoint => {\n\t\tconst mappedPoint = vectorClone(imagePoint);\n\t\tmappedPoint.x *= $presentationScalar;\n\t\tmappedPoint.y *= $presentationScalar;\n\t\tmappedPoint.x += $imageSelectionRectPresentation.x;\n\t\tmappedPoint.y += $imageSelectionRectPresentation.y;\n\t\treturn mappedPoint;\n\t};\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"isActive\" in $$props) $$invalidate(0, isActive = $$props.isActive);\n\t\tif (\"isActiveFraction\" in $$props) $$invalidate(1, isActiveFraction = $$props.isActiveFraction);\n\t\tif (\"isVisible\" in $$props) $$invalidate(2, isVisible = $$props.isVisible);\n\t\tif (\"stores\" in $$props) $$invalidate(3, stores = $$props.stores);\n\t\tif (\"locale\" in $$props) $$invalidate(4, locale = $$props.locale);\n\t\tif (\"markupEditorToolbar\" in $$props) $$invalidate(5, markupEditorToolbar = $$props.markupEditorToolbar);\n\t\tif (\"markupEditorToolStyles\" in $$props) $$invalidate(6, markupEditorToolStyles = $$props.markupEditorToolStyles);\n\t\tif (\"markupEditorShapeStyleControls\" in $$props) $$invalidate(7, markupEditorShapeStyleControls = $$props.markupEditorShapeStyleControls);\n\t\tif (\"decorateTools\" in $$props) $$invalidate(8, decorateTools = $$props.decorateTools);\n\t\tif (\"decorateToolShapes\" in $$props) $$invalidate(9, decorateToolShapes = $$props.decorateToolShapes);\n\t\tif (\"decorateShapeControls\" in $$props) $$invalidate(10, decorateShapeControls = $$props.decorateShapeControls);\n\t\tif (\"decorateActiveTool\" in $$props) $$invalidate(11, decorateActiveTool = $$props.decorateActiveTool);\n\t\tif (\"decorateEnableButtonFlipVertical\" in $$props) $$invalidate(12, decorateEnableButtonFlipVertical = $$props.decorateEnableButtonFlipVertical);\n\t\tif (\"decorateEnableSelectImagePreset\" in $$props) $$invalidate(27, decorateEnableSelectImagePreset = $$props.decorateEnableSelectImagePreset);\n\t\tif (\"decoratePresets\" in $$props) $$invalidate(13, decoratePresets = $$props.decoratePresets);\n\t\tif (\"willRenderShapeControls\" in $$props) $$invalidate(14, willRenderShapeControls = $$props.willRenderShapeControls);\n\t\tif (\"beforeAddShape\" in $$props) $$invalidate(15, beforeAddShape = $$props.beforeAddShape);\n\t\tif (\"beforeRemoveShape\" in $$props) $$invalidate(16, beforeRemoveShape = $$props.beforeRemoveShape);\n\t\tif (\"beforeDeselectShape\" in $$props) $$invalidate(17, beforeDeselectShape = $$props.beforeDeselectShape);\n\t\tif (\"beforeSelectShape\" in $$props) $$invalidate(18, beforeSelectShape = $$props.beforeSelectShape);\n\t\tif (\"beforeUpdateShape\" in $$props) $$invalidate(19, beforeUpdateShape = $$props.beforeUpdateShape);\n\t};\n\n\treturn [\n\t\tisActive,\n\t\tisActiveFraction,\n\t\tisVisible,\n\t\tstores,\n\t\tlocale,\n\t\tmarkupEditorToolbar,\n\t\tmarkupEditorToolStyles,\n\t\tmarkupEditorShapeStyleControls,\n\t\tdecorateTools,\n\t\tdecorateToolShapes,\n\t\tdecorateShapeControls,\n\t\tdecorateActiveTool,\n\t\tdecorateEnableButtonFlipVertical,\n\t\tdecoratePresets,\n\t\twillRenderShapeControls,\n\t\tbeforeAddShape,\n\t\tbeforeRemoveShape,\n\t\tbeforeDeselectShape,\n\t\tbeforeSelectShape,\n\t\tbeforeUpdateShape,\n\t\timageCropRect,\n\t\timageDecoration,\n\t\timageSelectionRectPresentation,\n\t\tpresentationScalar,\n\t\tmapScreenPointToImagePoint,\n\t\tmapImagePointToScreenPoint,\n\t\tname,\n\t\tdecorateEnableSelectImagePreset,\n\t\tmeasure_handler\n\t];\n}\n\nclass Decorate extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(this, options, instance$E, create_fragment$E, safe_not_equal, {\n\t\t\tname: 26,\n\t\t\tisActive: 0,\n\t\t\tisActiveFraction: 1,\n\t\t\tisVisible: 2,\n\t\t\tstores: 3,\n\t\t\tlocale: 4,\n\t\t\tmarkupEditorToolbar: 5,\n\t\t\tmarkupEditorToolStyles: 6,\n\t\t\tmarkupEditorShapeStyleControls: 7,\n\t\t\tdecorateTools: 8,\n\t\t\tdecorateToolShapes: 9,\n\t\t\tdecorateShapeControls: 10,\n\t\t\tdecorateActiveTool: 11,\n\t\t\tdecorateEnableButtonFlipVertical: 12,\n\t\t\tdecorateEnableSelectImagePreset: 27,\n\t\t\tdecoratePresets: 13,\n\t\t\twillRenderShapeControls: 14,\n\t\t\tbeforeAddShape: 15,\n\t\t\tbeforeRemoveShape: 16,\n\t\t\tbeforeDeselectShape: 17,\n\t\t\tbeforeSelectShape: 18,\n\t\t\tbeforeUpdateShape: 19\n\t\t});\n\t}\n\n\tget name() {\n\t\treturn this.$$.ctx[26];\n\t}\n\n\tget isActive() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tset isActive(isActive) {\n\t\tthis.$set({ isActive });\n\t\tflush();\n\t}\n\n\tget isActiveFraction() {\n\t\treturn this.$$.ctx[1];\n\t}\n\n\tset isActiveFraction(isActiveFraction) {\n\t\tthis.$set({ isActiveFraction });\n\t\tflush();\n\t}\n\n\tget isVisible() {\n\t\treturn this.$$.ctx[2];\n\t}\n\n\tset isVisible(isVisible) {\n\t\tthis.$set({ isVisible });\n\t\tflush();\n\t}\n\n\tget stores() {\n\t\treturn this.$$.ctx[3];\n\t}\n\n\tset stores(stores) {\n\t\tthis.$set({ stores });\n\t\tflush();\n\t}\n\n\tget locale() {\n\t\treturn this.$$.ctx[4];\n\t}\n\n\tset locale(locale) {\n\t\tthis.$set({ locale });\n\t\tflush();\n\t}\n\n\tget markupEditorToolbar() {\n\t\treturn this.$$.ctx[5];\n\t}\n\n\tset markupEditorToolbar(markupEditorToolbar) {\n\t\tthis.$set({ markupEditorToolbar });\n\t\tflush();\n\t}\n\n\tget markupEditorToolStyles() {\n\t\treturn this.$$.ctx[6];\n\t}\n\n\tset markupEditorToolStyles(markupEditorToolStyles) {\n\t\tthis.$set({ markupEditorToolStyles });\n\t\tflush();\n\t}\n\n\tget markupEditorShapeStyleControls() {\n\t\treturn this.$$.ctx[7];\n\t}\n\n\tset markupEditorShapeStyleControls(markupEditorShapeStyleControls) {\n\t\tthis.$set({ markupEditorShapeStyleControls });\n\t\tflush();\n\t}\n\n\tget decorateTools() {\n\t\treturn this.$$.ctx[8];\n\t}\n\n\tset decorateTools(decorateTools) {\n\t\tthis.$set({ decorateTools });\n\t\tflush();\n\t}\n\n\tget decorateToolShapes() {\n\t\treturn this.$$.ctx[9];\n\t}\n\n\tset decorateToolShapes(decorateToolShapes) {\n\t\tthis.$set({ decorateToolShapes });\n\t\tflush();\n\t}\n\n\tget decorateShapeControls() {\n\t\treturn this.$$.ctx[10];\n\t}\n\n\tset decorateShapeControls(decorateShapeControls) {\n\t\tthis.$set({ decorateShapeControls });\n\t\tflush();\n\t}\n\n\tget decorateActiveTool() {\n\t\treturn this.$$.ctx[11];\n\t}\n\n\tset decorateActiveTool(decorateActiveTool) {\n\t\tthis.$set({ decorateActiveTool });\n\t\tflush();\n\t}\n\n\tget decorateEnableButtonFlipVertical() {\n\t\treturn this.$$.ctx[12];\n\t}\n\n\tset decorateEnableButtonFlipVertical(decorateEnableButtonFlipVertical) {\n\t\tthis.$set({ decorateEnableButtonFlipVertical });\n\t\tflush();\n\t}\n\n\tget decorateEnableSelectImagePreset() {\n\t\treturn this.$$.ctx[27];\n\t}\n\n\tset decorateEnableSelectImagePreset(decorateEnableSelectImagePreset) {\n\t\tthis.$set({ decorateEnableSelectImagePreset });\n\t\tflush();\n\t}\n\n\tget decoratePresets() {\n\t\treturn this.$$.ctx[13];\n\t}\n\n\tset decoratePresets(decoratePresets) {\n\t\tthis.$set({ decoratePresets });\n\t\tflush();\n\t}\n\n\tget willRenderShapeControls() {\n\t\treturn this.$$.ctx[14];\n\t}\n\n\tset willRenderShapeControls(willRenderShapeControls) {\n\t\tthis.$set({ willRenderShapeControls });\n\t\tflush();\n\t}\n\n\tget beforeAddShape() {\n\t\treturn this.$$.ctx[15];\n\t}\n\n\tset beforeAddShape(beforeAddShape) {\n\t\tthis.$set({ beforeAddShape });\n\t\tflush();\n\t}\n\n\tget beforeRemoveShape() {\n\t\treturn this.$$.ctx[16];\n\t}\n\n\tset beforeRemoveShape(beforeRemoveShape) {\n\t\tthis.$set({ beforeRemoveShape });\n\t\tflush();\n\t}\n\n\tget beforeDeselectShape() {\n\t\treturn this.$$.ctx[17];\n\t}\n\n\tset beforeDeselectShape(beforeDeselectShape) {\n\t\tthis.$set({ beforeDeselectShape });\n\t\tflush();\n\t}\n\n\tget beforeSelectShape() {\n\t\treturn this.$$.ctx[18];\n\t}\n\n\tset beforeSelectShape(beforeSelectShape) {\n\t\tthis.$set({ beforeSelectShape });\n\t\tflush();\n\t}\n\n\tget beforeUpdateShape() {\n\t\treturn this.$$.ctx[19];\n\t}\n\n\tset beforeUpdateShape(beforeUpdateShape) {\n\t\tthis.$set({ beforeUpdateShape });\n\t\tflush();\n\t}\n}\n\n// @ts-ignore\nvar index$4 = { util: ['decorate', Decorate] };\n\n/* src/core/ui/plugins/sticker/index.svelte generated by Svelte v3.29.4 */\n\nfunction create_fragment$F(ctx) {\n\tlet shapeutil;\n\tlet current;\n\n\tshapeutil = new ShapeUtil({\n\t\t\tprops: {\n\t\t\t\tstores: /*stores*/ ctx[3],\n\t\t\t\tlocale: /*locale*/ ctx[4],\n\t\t\t\tisActive: /*isActive*/ ctx[0],\n\t\t\t\tisActiveFraction: /*isActiveFraction*/ ctx[1],\n\t\t\t\tisVisible: /*isVisible*/ ctx[2],\n\t\t\t\tmapScreenPointToImagePoint: /*mapScreenPointToImagePoint*/ ctx[29],\n\t\t\t\tmapImagePointToScreenPoint: /*mapImagePointToScreenPoint*/ ctx[30],\n\t\t\t\tutilKey: \"sticker\",\n\t\t\t\tshapePresets: /*stickers*/ ctx[5],\n\t\t\t\tshapes: /*stickerStickToImage*/ ctx[6]\n\t\t\t\t? /*imageAnnotation*/ ctx[22]\n\t\t\t\t: /*imageDecoration*/ ctx[23],\n\t\t\t\ttoolActive: \"preset\",\n\t\t\t\timageFlipX: /*stickerStickToImage*/ ctx[6]\n\t\t\t\t? /*$imageFlipX*/ ctx[15]\n\t\t\t\t: false,\n\t\t\t\timageFlipY: /*stickerStickToImage*/ ctx[6]\n\t\t\t\t? /*$imageFlipY*/ ctx[16]\n\t\t\t\t: false,\n\t\t\t\timageRotation: /*stickerStickToImage*/ ctx[6]\n\t\t\t\t? /*$imageRotation*/ ctx[17]\n\t\t\t\t: 0,\n\t\t\t\tparentRect: /*stickerStickToImage*/ ctx[6]\n\t\t\t\t? /*imageSize*/ ctx[24]\n\t\t\t\t: /*imageCropRect*/ ctx[20],\n\t\t\t\tenablePresetSelectImage: /*stickerEnableSelectImage*/ ctx[7],\n\t\t\t\tenableButtonFlipVertical: /*stickersEnableButtonFlipVertical*/ ctx[8],\n\t\t\t\thooks: {\n\t\t\t\t\twillRenderShapeControls: /*willRenderShapeControls*/ ctx[9],\n\t\t\t\t\tbeforeAddShape: /*beforeAddShape*/ ctx[10],\n\t\t\t\t\tbeforeRemoveShape: /*beforeRemoveShape*/ ctx[11],\n\t\t\t\t\tbeforeDeselectShape: /*beforeDeselectShape*/ ctx[12],\n\t\t\t\t\tbeforeSelectShape: /*beforeSelectShape*/ ctx[13],\n\t\t\t\t\tbeforeUpdateShape: /*beforeUpdateShape*/ ctx[14]\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\tshapeutil.$on(\"measure\", /*measure_handler*/ ctx[32]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(shapeutil.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(shapeutil, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst shapeutil_changes = {};\n\t\t\tif (dirty[0] & /*stores*/ 8) shapeutil_changes.stores = /*stores*/ ctx[3];\n\t\t\tif (dirty[0] & /*locale*/ 16) shapeutil_changes.locale = /*locale*/ ctx[4];\n\t\t\tif (dirty[0] & /*isActive*/ 1) shapeutil_changes.isActive = /*isActive*/ ctx[0];\n\t\t\tif (dirty[0] & /*isActiveFraction*/ 2) shapeutil_changes.isActiveFraction = /*isActiveFraction*/ ctx[1];\n\t\t\tif (dirty[0] & /*isVisible*/ 4) shapeutil_changes.isVisible = /*isVisible*/ ctx[2];\n\t\t\tif (dirty[0] & /*stickers*/ 32) shapeutil_changes.shapePresets = /*stickers*/ ctx[5];\n\n\t\t\tif (dirty[0] & /*stickerStickToImage*/ 64) shapeutil_changes.shapes = /*stickerStickToImage*/ ctx[6]\n\t\t\t? /*imageAnnotation*/ ctx[22]\n\t\t\t: /*imageDecoration*/ ctx[23];\n\n\t\t\tif (dirty[0] & /*stickerStickToImage, $imageFlipX*/ 32832) shapeutil_changes.imageFlipX = /*stickerStickToImage*/ ctx[6]\n\t\t\t? /*$imageFlipX*/ ctx[15]\n\t\t\t: false;\n\n\t\t\tif (dirty[0] & /*stickerStickToImage, $imageFlipY*/ 65600) shapeutil_changes.imageFlipY = /*stickerStickToImage*/ ctx[6]\n\t\t\t? /*$imageFlipY*/ ctx[16]\n\t\t\t: false;\n\n\t\t\tif (dirty[0] & /*stickerStickToImage, $imageRotation*/ 131136) shapeutil_changes.imageRotation = /*stickerStickToImage*/ ctx[6]\n\t\t\t? /*$imageRotation*/ ctx[17]\n\t\t\t: 0;\n\n\t\t\tif (dirty[0] & /*stickerStickToImage*/ 64) shapeutil_changes.parentRect = /*stickerStickToImage*/ ctx[6]\n\t\t\t? /*imageSize*/ ctx[24]\n\t\t\t: /*imageCropRect*/ ctx[20];\n\n\t\t\tif (dirty[0] & /*stickerEnableSelectImage*/ 128) shapeutil_changes.enablePresetSelectImage = /*stickerEnableSelectImage*/ ctx[7];\n\t\t\tif (dirty[0] & /*stickersEnableButtonFlipVertical*/ 256) shapeutil_changes.enableButtonFlipVertical = /*stickersEnableButtonFlipVertical*/ ctx[8];\n\n\t\t\tif (dirty[0] & /*willRenderShapeControls, beforeAddShape, beforeRemoveShape, beforeDeselectShape, beforeSelectShape, beforeUpdateShape*/ 32256) shapeutil_changes.hooks = {\n\t\t\t\twillRenderShapeControls: /*willRenderShapeControls*/ ctx[9],\n\t\t\t\tbeforeAddShape: /*beforeAddShape*/ ctx[10],\n\t\t\t\tbeforeRemoveShape: /*beforeRemoveShape*/ ctx[11],\n\t\t\t\tbeforeDeselectShape: /*beforeDeselectShape*/ ctx[12],\n\t\t\t\tbeforeSelectShape: /*beforeSelectShape*/ ctx[13],\n\t\t\t\tbeforeUpdateShape: /*beforeUpdateShape*/ ctx[14]\n\t\t\t};\n\n\t\t\tshapeutil.$set(shapeutil_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(shapeutil.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(shapeutil.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(shapeutil, detaching);\n\t\t}\n\t};\n}\n\nfunction instance$F($$self, $$props, $$invalidate) {\n\tlet $rootRect;\n\tlet $imageSize;\n\tlet $imageTransforms;\n\tlet $imageFlipX;\n\tlet $imageFlipY;\n\tlet $imageSelectionRectPresentation;\n\tlet $presentationScalar;\n\tlet $imageRotation;\n\tconst name = \"sticker\";\n\tlet { isActive } = $$props;\n\tlet { isActiveFraction } = $$props;\n\tlet { isVisible } = $$props;\n\tlet { stores } = $$props;\n\tlet { locale = {} } = $$props;\n\tlet { stickers = [] } = $$props;\n\tlet { stickerStickToImage = false } = $$props;\n\tlet { stickerEnableSelectImage = true } = $$props;\n\tlet { stickersEnableButtonFlipVertical = false } = $$props;\n\tlet { willRenderShapeControls = undefined } = $$props;\n\tlet { beforeAddShape = undefined } = $$props;\n\tlet { beforeRemoveShape = undefined } = $$props;\n\tlet { beforeDeselectShape = undefined } = $$props;\n\tlet { beforeSelectShape = undefined } = $$props;\n\tlet { beforeUpdateShape = undefined } = $$props;\n\n\t// connect filter choice to stores\n\tconst { presentationScalar, rootRect, imageCropRect, imageSelectionRectPresentation, imageAnnotation, imageDecoration, imageSize, imageTransforms, imageRotation, imageFlipX, imageFlipY } = stores;\n\n\tcomponent_subscribe($$self, presentationScalar, value => $$invalidate(37, $presentationScalar = value));\n\tcomponent_subscribe($$self, rootRect, value => $$invalidate(33, $rootRect = value));\n\tcomponent_subscribe($$self, imageSelectionRectPresentation, value => $$invalidate(36, $imageSelectionRectPresentation = value));\n\tcomponent_subscribe($$self, imageSize, value => $$invalidate(34, $imageSize = value));\n\tcomponent_subscribe($$self, imageTransforms, value => $$invalidate(35, $imageTransforms = value));\n\tcomponent_subscribe($$self, imageRotation, value => $$invalidate(17, $imageRotation = value));\n\tcomponent_subscribe($$self, imageFlipX, value => $$invalidate(15, $imageFlipX = value));\n\tcomponent_subscribe($$self, imageFlipY, value => $$invalidate(16, $imageFlipY = value));\n\n\t//\n\t// Mapping coordinates\n\t//\n\tconst mapScreenPointToImagePoint = stickerStickToImage\n\t? point => _mapScreenPointToImagePoint(point, $rootRect, $imageSize, $imageTransforms.origin, $imageTransforms.translation, $imageTransforms.rotation.z, $imageTransforms.scale, $imageFlipX, $imageFlipY)\n\t: point => {\n\t\t\tconst mappedPoint = vectorClone(point);\n\t\t\tmappedPoint.x -= $imageSelectionRectPresentation.x;\n\t\t\tmappedPoint.y -= $imageSelectionRectPresentation.y;\n\t\t\tmappedPoint.x /= $presentationScalar;\n\t\t\tmappedPoint.y /= $presentationScalar;\n\t\t\treturn mappedPoint;\n\t\t};\n\n\tconst mapImagePointToScreenPoint = stickerStickToImage\n\t? point => _mapImagePointToScreenPoint(point, $rootRect, $imageSize, $imageTransforms.origin, $imageTransforms.translation, $imageTransforms.rotation.z, $imageTransforms.scale, $imageFlipX, $imageFlipY)\n\t: point => {\n\t\t\tconst mappedPoint = vectorClone(point);\n\t\t\tmappedPoint.x *= $presentationScalar;\n\t\t\tmappedPoint.y *= $presentationScalar;\n\t\t\tmappedPoint.x += $imageSelectionRectPresentation.x;\n\t\t\tmappedPoint.y += $imageSelectionRectPresentation.y;\n\t\t\treturn mappedPoint;\n\t\t};\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"isActive\" in $$props) $$invalidate(0, isActive = $$props.isActive);\n\t\tif (\"isActiveFraction\" in $$props) $$invalidate(1, isActiveFraction = $$props.isActiveFraction);\n\t\tif (\"isVisible\" in $$props) $$invalidate(2, isVisible = $$props.isVisible);\n\t\tif (\"stores\" in $$props) $$invalidate(3, stores = $$props.stores);\n\t\tif (\"locale\" in $$props) $$invalidate(4, locale = $$props.locale);\n\t\tif (\"stickers\" in $$props) $$invalidate(5, stickers = $$props.stickers);\n\t\tif (\"stickerStickToImage\" in $$props) $$invalidate(6, stickerStickToImage = $$props.stickerStickToImage);\n\t\tif (\"stickerEnableSelectImage\" in $$props) $$invalidate(7, stickerEnableSelectImage = $$props.stickerEnableSelectImage);\n\t\tif (\"stickersEnableButtonFlipVertical\" in $$props) $$invalidate(8, stickersEnableButtonFlipVertical = $$props.stickersEnableButtonFlipVertical);\n\t\tif (\"willRenderShapeControls\" in $$props) $$invalidate(9, willRenderShapeControls = $$props.willRenderShapeControls);\n\t\tif (\"beforeAddShape\" in $$props) $$invalidate(10, beforeAddShape = $$props.beforeAddShape);\n\t\tif (\"beforeRemoveShape\" in $$props) $$invalidate(11, beforeRemoveShape = $$props.beforeRemoveShape);\n\t\tif (\"beforeDeselectShape\" in $$props) $$invalidate(12, beforeDeselectShape = $$props.beforeDeselectShape);\n\t\tif (\"beforeSelectShape\" in $$props) $$invalidate(13, beforeSelectShape = $$props.beforeSelectShape);\n\t\tif (\"beforeUpdateShape\" in $$props) $$invalidate(14, beforeUpdateShape = $$props.beforeUpdateShape);\n\t};\n\n\treturn [\n\t\tisActive,\n\t\tisActiveFraction,\n\t\tisVisible,\n\t\tstores,\n\t\tlocale,\n\t\tstickers,\n\t\tstickerStickToImage,\n\t\tstickerEnableSelectImage,\n\t\tstickersEnableButtonFlipVertical,\n\t\twillRenderShapeControls,\n\t\tbeforeAddShape,\n\t\tbeforeRemoveShape,\n\t\tbeforeDeselectShape,\n\t\tbeforeSelectShape,\n\t\tbeforeUpdateShape,\n\t\t$imageFlipX,\n\t\t$imageFlipY,\n\t\t$imageRotation,\n\t\tpresentationScalar,\n\t\trootRect,\n\t\timageCropRect,\n\t\timageSelectionRectPresentation,\n\t\timageAnnotation,\n\t\timageDecoration,\n\t\timageSize,\n\t\timageTransforms,\n\t\timageRotation,\n\t\timageFlipX,\n\t\timageFlipY,\n\t\tmapScreenPointToImagePoint,\n\t\tmapImagePointToScreenPoint,\n\t\tname,\n\t\tmeasure_handler\n\t];\n}\n\nclass Sticker extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$F,\n\t\t\tcreate_fragment$F,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tname: 31,\n\t\t\t\tisActive: 0,\n\t\t\t\tisActiveFraction: 1,\n\t\t\t\tisVisible: 2,\n\t\t\t\tstores: 3,\n\t\t\t\tlocale: 4,\n\t\t\t\tstickers: 5,\n\t\t\t\tstickerStickToImage: 6,\n\t\t\t\tstickerEnableSelectImage: 7,\n\t\t\t\tstickersEnableButtonFlipVertical: 8,\n\t\t\t\twillRenderShapeControls: 9,\n\t\t\t\tbeforeAddShape: 10,\n\t\t\t\tbeforeRemoveShape: 11,\n\t\t\t\tbeforeDeselectShape: 12,\n\t\t\t\tbeforeSelectShape: 13,\n\t\t\t\tbeforeUpdateShape: 14\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n\n\tget name() {\n\t\treturn this.$$.ctx[31];\n\t}\n\n\tget isActive() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tset isActive(isActive) {\n\t\tthis.$set({ isActive });\n\t\tflush();\n\t}\n\n\tget isActiveFraction() {\n\t\treturn this.$$.ctx[1];\n\t}\n\n\tset isActiveFraction(isActiveFraction) {\n\t\tthis.$set({ isActiveFraction });\n\t\tflush();\n\t}\n\n\tget isVisible() {\n\t\treturn this.$$.ctx[2];\n\t}\n\n\tset isVisible(isVisible) {\n\t\tthis.$set({ isVisible });\n\t\tflush();\n\t}\n\n\tget stores() {\n\t\treturn this.$$.ctx[3];\n\t}\n\n\tset stores(stores) {\n\t\tthis.$set({ stores });\n\t\tflush();\n\t}\n\n\tget locale() {\n\t\treturn this.$$.ctx[4];\n\t}\n\n\tset locale(locale) {\n\t\tthis.$set({ locale });\n\t\tflush();\n\t}\n\n\tget stickers() {\n\t\treturn this.$$.ctx[5];\n\t}\n\n\tset stickers(stickers) {\n\t\tthis.$set({ stickers });\n\t\tflush();\n\t}\n\n\tget stickerStickToImage() {\n\t\treturn this.$$.ctx[6];\n\t}\n\n\tset stickerStickToImage(stickerStickToImage) {\n\t\tthis.$set({ stickerStickToImage });\n\t\tflush();\n\t}\n\n\tget stickerEnableSelectImage() {\n\t\treturn this.$$.ctx[7];\n\t}\n\n\tset stickerEnableSelectImage(stickerEnableSelectImage) {\n\t\tthis.$set({ stickerEnableSelectImage });\n\t\tflush();\n\t}\n\n\tget stickersEnableButtonFlipVertical() {\n\t\treturn this.$$.ctx[8];\n\t}\n\n\tset stickersEnableButtonFlipVertical(stickersEnableButtonFlipVertical) {\n\t\tthis.$set({ stickersEnableButtonFlipVertical });\n\t\tflush();\n\t}\n\n\tget willRenderShapeControls() {\n\t\treturn this.$$.ctx[9];\n\t}\n\n\tset willRenderShapeControls(willRenderShapeControls) {\n\t\tthis.$set({ willRenderShapeControls });\n\t\tflush();\n\t}\n\n\tget beforeAddShape() {\n\t\treturn this.$$.ctx[10];\n\t}\n\n\tset beforeAddShape(beforeAddShape) {\n\t\tthis.$set({ beforeAddShape });\n\t\tflush();\n\t}\n\n\tget beforeRemoveShape() {\n\t\treturn this.$$.ctx[11];\n\t}\n\n\tset beforeRemoveShape(beforeRemoveShape) {\n\t\tthis.$set({ beforeRemoveShape });\n\t\tflush();\n\t}\n\n\tget beforeDeselectShape() {\n\t\treturn this.$$.ctx[12];\n\t}\n\n\tset beforeDeselectShape(beforeDeselectShape) {\n\t\tthis.$set({ beforeDeselectShape });\n\t\tflush();\n\t}\n\n\tget beforeSelectShape() {\n\t\treturn this.$$.ctx[13];\n\t}\n\n\tset beforeSelectShape(beforeSelectShape) {\n\t\tthis.$set({ beforeSelectShape });\n\t\tflush();\n\t}\n\n\tget beforeUpdateShape() {\n\t\treturn this.$$.ctx[14];\n\t}\n\n\tset beforeUpdateShape(beforeUpdateShape) {\n\t\tthis.$set({ beforeUpdateShape });\n\t\tflush();\n\t}\n}\n\n// @ts-ignore\nvar index$5 = { util: ['sticker', Sticker] };\n\n/* src/core/ui/plugins/resize/index.svelte generated by Svelte v3.29.4 */\n\nfunction create_default_slot_2$6(ctx) {\n\tlet g;\n\n\tlet raw_value = (isString(/*locale*/ ctx[1].resizeIconButtonMaintainAspectRatio)\n\t? /*locale*/ ctx[1].resizeIconButtonMaintainAspectRatio\n\t: /*locale*/ ctx[1].resizeIconButtonMaintainAspectRatio(/*maintainAspectRatio*/ ctx[3], /*$iconActiveFraction*/ ctx[11])) + \"\";\n\n\treturn {\n\t\tc() {\n\t\t\tg = svg_element(\"g\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, g, anchor);\n\t\t\tg.innerHTML = raw_value;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif (dirty[0] & /*locale, maintainAspectRatio, $iconActiveFraction*/ 2058 && raw_value !== (raw_value = (isString(/*locale*/ ctx[1].resizeIconButtonMaintainAspectRatio)\n\t\t\t? /*locale*/ ctx[1].resizeIconButtonMaintainAspectRatio\n\t\t\t: /*locale*/ ctx[1].resizeIconButtonMaintainAspectRatio(/*maintainAspectRatio*/ ctx[3], /*$iconActiveFraction*/ ctx[11])) + \"\")) g.innerHTML = raw_value;\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(g);\n\t\t}\n\t};\n}\n\n// (389:12) <Button type=\"submit\" class=\"implicit\">\nfunction create_default_slot_1$9(ctx) {\n\tlet t;\n\n\treturn {\n\t\tc() {\n\t\t\tt = text(\"Save\");\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, t, anchor);\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(t);\n\t\t}\n\t};\n}\n\n// (362:4) <form slot=\"footer\" style={footerStyle} on:submit|preventDefault={handleSubmit}>\nfunction create_footer_slot$4(ctx) {\n\tlet form;\n\tlet div4;\n\tlet fieldset;\n\tlet legend;\n\tlet t0_value = /*locale*/ ctx[1].resizeLabelFormCaption + \"\";\n\tlet t0;\n\tlet t1;\n\tlet div3;\n\tlet div0;\n\tlet label0;\n\tlet t2_value = /*locale*/ ctx[1].resizeLabelInputWidth + \"\";\n\tlet t2;\n\tlet label0_for_value;\n\tlet label0_title_value;\n\tlet label0_aria_label_value;\n\tlet t3;\n\tlet input0;\n\tlet input0_id_value;\n\tlet t4;\n\tlet div1;\n\tlet input1;\n\tlet input1_id_value;\n\tlet t5;\n\tlet label1;\n\tlet icon;\n\tlet label1_for_value;\n\tlet label1_title_value;\n\tlet t6;\n\tlet div2;\n\tlet label2;\n\tlet t7_value = /*locale*/ ctx[1].resizeLabelInputHeight + \"\";\n\tlet t7;\n\tlet label2_for_value;\n\tlet label2_title_value;\n\tlet label2_aria_label_value;\n\tlet t8;\n\tlet input2;\n\tlet input2_id_value;\n\tlet t9;\n\tlet button;\n\tlet current;\n\tlet mounted;\n\tlet dispose;\n\n\ticon = new Icon({\n\t\t\tprops: {\n\t\t\t\t$$slots: { default: [create_default_slot_2$6] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\tbutton = new Button({\n\t\t\tprops: {\n\t\t\t\ttype: \"submit\",\n\t\t\t\tclass: \"implicit\",\n\t\t\t\t$$slots: { default: [create_default_slot_1$9] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\treturn {\n\t\tc() {\n\t\t\tform = element(\"form\");\n\t\t\tdiv4 = element(\"div\");\n\t\t\tfieldset = element(\"fieldset\");\n\t\t\tlegend = element(\"legend\");\n\t\t\tt0 = text(t0_value);\n\t\t\tt1 = space();\n\t\t\tdiv3 = element(\"div\");\n\t\t\tdiv0 = element(\"div\");\n\t\t\tlabel0 = element(\"label\");\n\t\t\tt2 = text(t2_value);\n\t\t\tt3 = space();\n\t\t\tinput0 = element(\"input\");\n\t\t\tt4 = space();\n\t\t\tdiv1 = element(\"div\");\n\t\t\tinput1 = element(\"input\");\n\t\t\tt5 = space();\n\t\t\tlabel1 = element(\"label\");\n\t\t\tcreate_component(icon.$$.fragment);\n\t\t\tt6 = space();\n\t\t\tdiv2 = element(\"div\");\n\t\t\tlabel2 = element(\"label\");\n\t\t\tt7 = text(t7_value);\n\t\t\tt8 = space();\n\t\t\tinput2 = element(\"input\");\n\t\t\tt9 = space();\n\t\t\tcreate_component(button.$$.fragment);\n\t\t\tattr(legend, \"class\", \"implicit\");\n\t\t\tattr(label0, \"for\", label0_for_value = \"doka-width-\" + /*formId*/ ctx[18]);\n\t\t\tattr(label0, \"title\", label0_title_value = /*locale*/ ctx[1].resizeTitleInputWidth);\n\t\t\tattr(label0, \"aria-label\", label0_aria_label_value = /*locale*/ ctx[1].resizeTitleInputWidth);\n\t\t\tattr(input0, \"id\", input0_id_value = \"doka-width-\" + /*formId*/ ctx[18]);\n\t\t\tattr(input0, \"type\", \"text\");\n\t\t\tattr(input0, \"inputmode\", \"numeric\");\n\t\t\tattr(input0, \"pattern\", \"[0-9]*\");\n\t\t\tattr(input0, \"data-state\", /*widthState*/ ctx[8]);\n\t\t\tattr(input0, \"autocomplete\", \"off\");\n\t\t\tattr(input0, \"placeholder\", /*widthPlaceholder*/ ctx[6]);\n\t\t\tattr(div0, \"class\", \"DokaInputDimension\");\n\t\t\tattr(input1, \"class\", \"implicit\");\n\t\t\tattr(input1, \"id\", input1_id_value = \"doka-maintainAspectRatio-\" + /*formId*/ ctx[18]);\n\t\t\tattr(input1, \"type\", \"checkbox\");\n\t\t\tattr(label1, \"for\", label1_for_value = \"doka-maintainAspectRatio-\" + /*formId*/ ctx[18]);\n\t\t\tattr(label1, \"title\", label1_title_value = /*locale*/ ctx[1].resizeTitleButtonMaintainAspectRatio);\n\t\t\tattr(label2, \"for\", label2_for_value = \"doka-height-\" + /*formId*/ ctx[18]);\n\t\t\tattr(label2, \"title\", label2_title_value = /*locale*/ ctx[1].resizeTitleInputHeight);\n\t\t\tattr(label2, \"aria-label\", label2_aria_label_value = /*locale*/ ctx[1].resizeTitleInputHeight);\n\t\t\tattr(input2, \"id\", input2_id_value = \"doka-height-\" + /*formId*/ ctx[18]);\n\t\t\tattr(input2, \"type\", \"text\");\n\t\t\tattr(input2, \"inputmode\", \"numeric\");\n\t\t\tattr(input2, \"pattern\", \"[0-9]*\");\n\t\t\tattr(input2, \"autocomplete\", \"off\");\n\t\t\tattr(input2, \"data-state\", /*heightState*/ ctx[9]);\n\t\t\tattr(input2, \"placeholder\", /*heightPlaceholder*/ ctx[7]);\n\t\t\tattr(div2, \"class\", \"DokaInputDimension\");\n\t\t\tattr(div3, \"class\", \"DokaFieldsetInner\");\n\t\t\tattr(div4, \"class\", \"DokaFormInner\");\n\t\t\tattr(form, \"slot\", \"footer\");\n\t\t\tattr(form, \"style\", /*footerStyle*/ ctx[10]);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tinsert(target, form, anchor);\n\t\t\tappend(form, div4);\n\t\t\tappend(div4, fieldset);\n\t\t\tappend(fieldset, legend);\n\t\t\tappend(legend, t0);\n\t\t\tappend(fieldset, t1);\n\t\t\tappend(fieldset, div3);\n\t\t\tappend(div3, div0);\n\t\t\tappend(div0, label0);\n\t\t\tappend(label0, t2);\n\t\t\tappend(div0, t3);\n\t\t\tappend(div0, input0);\n\t\t\tset_input_value(input0, /*width*/ ctx[4]);\n\t\t\tappend(div3, t4);\n\t\t\tappend(div3, div1);\n\t\t\tappend(div1, input1);\n\t\t\tinput1.checked = /*maintainAspectRatio*/ ctx[3];\n\t\t\tappend(div1, t5);\n\t\t\tappend(div1, label1);\n\t\t\tmount_component(icon, label1, null);\n\t\t\tappend(div3, t6);\n\t\t\tappend(div3, div2);\n\t\t\tappend(div2, label2);\n\t\t\tappend(label2, t7);\n\t\t\tappend(div2, t8);\n\t\t\tappend(div2, input2);\n\t\t\tset_input_value(input2, /*height*/ ctx[5]);\n\t\t\t/*div3_binding*/ ctx[30](div3);\n\t\t\tappend(div4, t9);\n\t\t\tmount_component(button, div4, null);\n\t\t\tcurrent = true;\n\n\t\t\tif (!mounted) {\n\t\t\t\tdispose = [\n\t\t\t\t\tlisten(input0, \"input\", /*input0_input_handler*/ ctx[27]),\n\t\t\t\t\tlisten(input1, \"change\", /*input1_change_handler*/ ctx[28]),\n\t\t\t\t\tlisten(input2, \"input\", /*input2_input_handler*/ ctx[29]),\n\t\t\t\t\tlisten(div3, \"focusin\", /*handleFocusIn*/ ctx[19]),\n\t\t\t\t\tlisten(div3, \"focusout\", /*handleFocusOut*/ ctx[20]),\n\t\t\t\t\tlisten(form, \"submit\", prevent_default(/*handleSubmit*/ ctx[21]))\n\t\t\t\t];\n\n\t\t\t\tmounted = true;\n\t\t\t}\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tif ((!current || dirty[0] & /*locale*/ 2) && t0_value !== (t0_value = /*locale*/ ctx[1].resizeLabelFormCaption + \"\")) set_data(t0, t0_value);\n\t\t\tif ((!current || dirty[0] & /*locale*/ 2) && t2_value !== (t2_value = /*locale*/ ctx[1].resizeLabelInputWidth + \"\")) set_data(t2, t2_value);\n\n\t\t\tif (!current || dirty[0] & /*locale*/ 2 && label0_title_value !== (label0_title_value = /*locale*/ ctx[1].resizeTitleInputWidth)) {\n\t\t\t\tattr(label0, \"title\", label0_title_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*locale*/ 2 && label0_aria_label_value !== (label0_aria_label_value = /*locale*/ ctx[1].resizeTitleInputWidth)) {\n\t\t\t\tattr(label0, \"aria-label\", label0_aria_label_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*widthState*/ 256) {\n\t\t\t\tattr(input0, \"data-state\", /*widthState*/ ctx[8]);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*widthPlaceholder*/ 64) {\n\t\t\t\tattr(input0, \"placeholder\", /*widthPlaceholder*/ ctx[6]);\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*width*/ 16 && input0.value !== /*width*/ ctx[4]) {\n\t\t\t\tset_input_value(input0, /*width*/ ctx[4]);\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*maintainAspectRatio*/ 8) {\n\t\t\t\tinput1.checked = /*maintainAspectRatio*/ ctx[3];\n\t\t\t}\n\n\t\t\tconst icon_changes = {};\n\n\t\t\tif (dirty[0] & /*locale, maintainAspectRatio, $iconActiveFraction*/ 2058 | dirty[1] & /*$$scope*/ 65536) {\n\t\t\t\ticon_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\ticon.$set(icon_changes);\n\n\t\t\tif (!current || dirty[0] & /*locale*/ 2 && label1_title_value !== (label1_title_value = /*locale*/ ctx[1].resizeTitleButtonMaintainAspectRatio)) {\n\t\t\t\tattr(label1, \"title\", label1_title_value);\n\t\t\t}\n\n\t\t\tif ((!current || dirty[0] & /*locale*/ 2) && t7_value !== (t7_value = /*locale*/ ctx[1].resizeLabelInputHeight + \"\")) set_data(t7, t7_value);\n\n\t\t\tif (!current || dirty[0] & /*locale*/ 2 && label2_title_value !== (label2_title_value = /*locale*/ ctx[1].resizeTitleInputHeight)) {\n\t\t\t\tattr(label2, \"title\", label2_title_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*locale*/ 2 && label2_aria_label_value !== (label2_aria_label_value = /*locale*/ ctx[1].resizeTitleInputHeight)) {\n\t\t\t\tattr(label2, \"aria-label\", label2_aria_label_value);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*heightState*/ 512) {\n\t\t\t\tattr(input2, \"data-state\", /*heightState*/ ctx[9]);\n\t\t\t}\n\n\t\t\tif (!current || dirty[0] & /*heightPlaceholder*/ 128) {\n\t\t\t\tattr(input2, \"placeholder\", /*heightPlaceholder*/ ctx[7]);\n\t\t\t}\n\n\t\t\tif (dirty[0] & /*height*/ 32 && input2.value !== /*height*/ ctx[5]) {\n\t\t\t\tset_input_value(input2, /*height*/ ctx[5]);\n\t\t\t}\n\n\t\t\tconst button_changes = {};\n\n\t\t\tif (dirty[1] & /*$$scope*/ 65536) {\n\t\t\t\tbutton_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tbutton.$set(button_changes);\n\n\t\t\tif (!current || dirty[0] & /*footerStyle*/ 1024) {\n\t\t\t\tattr(form, \"style\", /*footerStyle*/ ctx[10]);\n\t\t\t}\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(icon.$$.fragment, local);\n\t\t\ttransition_in(button.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(icon.$$.fragment, local);\n\t\t\ttransition_out(button.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tif (detaching) detach(form);\n\t\t\tdestroy_component(icon);\n\t\t\t/*div3_binding*/ ctx[30](null);\n\t\t\tdestroy_component(button);\n\t\t\tmounted = false;\n\t\t\trun_all(dispose);\n\t\t}\n\t};\n}\n\nfunction create_fragment$G(ctx) {\n\tlet util;\n\tlet current;\n\n\tutil = new Util({\n\t\t\tprops: {\n\t\t\t\t$$slots: { footer: [create_footer_slot$4] },\n\t\t\t\t$$scope: { ctx }\n\t\t\t}\n\t\t});\n\n\tutil.$on(\"measure\", /*measure_handler*/ ctx[31]);\n\n\treturn {\n\t\tc() {\n\t\t\tcreate_component(util.$$.fragment);\n\t\t},\n\t\tm(target, anchor) {\n\t\t\tmount_component(util, target, anchor);\n\t\t\tcurrent = true;\n\t\t},\n\t\tp(ctx, dirty) {\n\t\t\tconst util_changes = {};\n\n\t\t\tif (dirty[0] & /*footerStyle, fieldsGroup, heightState, heightPlaceholder, height, locale, maintainAspectRatio, $iconActiveFraction, widthState, widthPlaceholder, width*/ 4094 | dirty[1] & /*$$scope*/ 65536) {\n\t\t\t\tutil_changes.$$scope = { dirty, ctx };\n\t\t\t}\n\n\t\t\tutil.$set(util_changes);\n\t\t},\n\t\ti(local) {\n\t\t\tif (current) return;\n\t\t\ttransition_in(util.$$.fragment, local);\n\t\t\tcurrent = true;\n\t\t},\n\t\to(local) {\n\t\t\ttransition_out(util.$$.fragment, local);\n\t\t\tcurrent = false;\n\t\t},\n\t\td(detaching) {\n\t\t\tdestroy_component(util, detaching);\n\t\t}\n\t};\n}\n\nfunction instance$G($$self, $$props, $$invalidate) {\n\tlet $imageCropRectAspectRatio;\n\tlet $imageCropRect;\n\tlet $imageOutputSize;\n\tlet $imageCropAspectRatio;\n\tlet $imageSize;\n\n\tlet $isActive,\n\t\t$$unsubscribe_isActive = noop$1,\n\t\t$$subscribe_isActive = () => ($$unsubscribe_isActive(), $$unsubscribe_isActive = subscribe(isActive, $$value => $$invalidate(41, $isActive = $$value)), isActive);\n\n\tlet $footerOffset;\n\tlet $iconActiveFraction;\n\t$$self.$$.on_destroy.push(() => $$unsubscribe_isActive());\n\n\tconst formatValue = (value, min = 0, max = 9999) => {\n\t\tif (isString(value)) {\n\t\t\tvalue = value.replace(/\\D/g, \"\");\n\t\t\tif (!value.length) return;\n\t\t}\n\n\t\tconst v = Math.round(value);\n\t\tif (Number.isNaN(v)) return;\n\t\treturn clamp(v, min, max);\n\t};\n\n\tconst name = \"resize\";\n\tlet { isActive } = $$props;\n\t$$subscribe_isActive();\n\tlet { stores } = $$props;\n\tlet { locale = {} } = $$props;\n\tlet { resizeMinSize = sizeCreate(1, 1) } = $$props;\n\tlet { resizeMaxSize = sizeCreate(9999, 9999) } = $$props;\n\n\t// offset\n\tconst iconActiveFraction = spring(0, { stiffness: 0.15, damping: 0.3 });\n\n\tcomponent_subscribe($$self, iconActiveFraction, value => $$invalidate(11, $iconActiveFraction = value));\n\tconst { imageSize, imageCropRect, imageCropRectAspectRatio, imageCropAspectRatio, imageOutputSize, history } = stores;\n\tcomponent_subscribe($$self, imageSize, value => $$invalidate(40, $imageSize = value));\n\tcomponent_subscribe($$self, imageCropRect, value => $$invalidate(37, $imageCropRect = value));\n\tcomponent_subscribe($$self, imageCropRectAspectRatio, value => $$invalidate(36, $imageCropRectAspectRatio = value));\n\tcomponent_subscribe($$self, imageCropAspectRatio, value => $$invalidate(39, $imageCropAspectRatio = value));\n\tcomponent_subscribe($$self, imageOutputSize, value => $$invalidate(38, $imageOutputSize = value));\n\tconst formId = getUniqueId();\n\tlet fieldsGroup;\n\tlet maintainAspectRatio = false;\n\tlet width;\n\tlet height;\n\tlet widthFormatted;\n\tlet heightFormatted;\n\tlet widthPlaceholder;\n\tlet heightPlaceholder;\n\tlet activeField;\n\tlet lastActiveField;\n\n\t// populate active field\n\tconst handleFocusIn = e => {\n\t\tconst id = e.target.id;\n\n\t\tif ((/width/).test(id)) {\n\t\t\t$$invalidate(34, activeField = \"width\");\n\t\t} else if ((/height/).test(id)) {\n\t\t\t$$invalidate(34, activeField = \"height\");\n\t\t} else if ((/aspectRatio/i).test(id)) {\n\t\t\t$$invalidate(34, activeField = \"lock\");\n\t\t} else {\n\t\t\t$$invalidate(34, activeField = undefined);\n\t\t}\n\t};\n\n\tconst handleFocusOut = e => {\n\t\tif (!fieldsGroup.contains(e.relatedTarget)) handleSubmit();\n\t\t$$invalidate(34, activeField = undefined);\n\t};\n\n\t// sync fields if one has a value and aspect ratio should be maintained\n\tconst syncFields = () => {\n\t\tif (activeField === \"width\") {\n\t\t\t// sync height field\n\t\t\t$$invalidate(5, height = Math.round(width / $imageCropRectAspectRatio));\n\t\t} else if (activeField === \"height\") {\n\t\t\t// sync width field\n\t\t\t$$invalidate(4, width = Math.round(height * $imageCropRectAspectRatio));\n\t\t} else {\n\t\t\tif (lastActiveField === \"width\") {\n\t\t\t\t$$invalidate(5, height = Math.round(width / $imageCropRectAspectRatio));\n\t\t\t} else if (lastActiveField === \"height\") {\n\t\t\t\t$$invalidate(4, width = Math.round(height * $imageCropRectAspectRatio));\n\t\t\t}\n\n\t\t\tconsolidateSize();\n\t\t}\n\t};\n\n\tconst consolidateSize = forcedAspectRatio => {\n\t\t// first need to limit values\n\t\tlet inputWidth = formatValue(width);\n\n\t\tlet inputHeight = formatValue(height);\n\t\tlet currentWidth = inputWidth;\n\t\tlet currentHeight = inputHeight;\n\t\tlet bothAxisDefined = currentWidth && currentHeight;\n\t\tlet aspectRatio = forcedAspectRatio || $imageCropRectAspectRatio;\n\n\t\t// done, no consolidation needed\n\t\tif (!currentWidth && !currentHeight) return;\n\n\t\t// need to fill in missing values\n\t\tif (currentWidth && !currentHeight) {\n\t\t\tcurrentHeight = Math.round(currentWidth / aspectRatio);\n\t\t} else if (currentHeight && !currentWidth) {\n\t\t\tcurrentWidth = Math.round(currentHeight * aspectRatio);\n\t\t}\n\n\t\taspectRatio = forcedAspectRatio || bothAxisDefined\n\t\t? getAspectRatio(currentWidth, currentHeight)\n\t\t: $imageCropRectAspectRatio;\n\n\t\t// now we have both width and height let's re-fit the min max size\n\t\tlet currentSize = sizeCreate(currentWidth, currentHeight);\n\n\t\tif (!sizeContains(resizeMaxSize, currentSize)) {\n\t\t\t// too big\n\t\t\tcurrentSize = rectContainRect(resizeMaxSize, aspectRatio);\n\t\t}\n\n\t\tif (!sizeContains(currentSize, resizeMinSize)) {\n\t\t\t// too small\n\t\t\tcurrentSize = rectCoverRect(resizeMinSize, aspectRatio);\n\t\t}\n\n\t\t$$invalidate(4, width = inputWidth != null\n\t\t? Math.round(currentSize.width)\n\t\t: undefined);\n\n\t\t$$invalidate(5, height = inputHeight != null\n\t\t? Math.round(currentSize.height)\n\t\t: undefined);\n\t};\n\n\tconst handleSubmit = () => {\n\t\t// calculate correct values\n\t\tconsolidateSize();\n\n\t\t// get curent values so we can check if they were changed (if not, no need to write history or update)\n\t\tconst { width: currentWidth, height: currentHeight } = $imageOutputSize || {};\n\n\t\t// no need to update\n\t\tif (currentWidth === width && currentHeight === height) return;\n\n\t\t// update state\n\t\tif (!width && !height) {\n\t\t\t// reset image crop\n\t\t\tset_store_value(imageCropAspectRatio, $imageCropAspectRatio = $imageSize.width / $imageSize.height, $imageCropAspectRatio);\n\n\t\t\tset_store_value(imageCropAspectRatio, $imageCropAspectRatio = undefined, $imageCropAspectRatio);\n\n\t\t\t// reset output size\n\t\t\tset_store_value(imageOutputSize, $imageOutputSize = undefined, $imageOutputSize);\n\t\t} else {\n\t\t\tif (width && height) set_store_value(imageCropAspectRatio, $imageCropAspectRatio = width / height, $imageCropAspectRatio);\n\t\t\tset_store_value(imageOutputSize, $imageOutputSize = sizeCreate(width, height), $imageOutputSize);\n\t\t}\n\n\t\thistory.write();\n\t};\n\n\t// handle external updates to outputSize\n\timageOutputSize.subscribe(size => {\n\t\tif (!size) {\n\t\t\t$$invalidate(4, width = undefined);\n\t\t\t$$invalidate(5, height = undefined);\n\t\t\treturn;\n\t\t}\n\n\t\t$$invalidate(4, width = size.width);\n\t\t$$invalidate(5, height = size.height);\n\n\t\t// make sure the size conforms to min max\n\t\tconsolidateSize();\n\t});\n\n\t// if the crop aspect ratio is changed we need to align width/height\n\timageCropAspectRatio.subscribe(cropAspectRatio => {\n\t\t// exit if no dimensions supplied\n\t\tif (!width && !height) return;\n\n\t\t// no crop aspect ratio has been selected, so all is fine\n\t\tif (!cropAspectRatio) return;\n\n\t\t// fix size to match new aspect ratio of the crop\n\t\tif (width && height && getAspectRatio(width, height) !== cropAspectRatio) {\n\t\t\t$$invalidate(5, height = width / cropAspectRatio);\n\t\t\tconsolidateSize(cropAspectRatio);\n\t\t} else {\n\t\t\tconsolidateSize();\n\t\t}\n\t});\n\n\t//\n\t// Footer\n\t//\n\tconst footerOffset = spring(0);\n\n\tcomponent_subscribe($$self, footerOffset, value => $$invalidate(42, $footerOffset = value));\n\n\tfunction input0_input_handler() {\n\t\twidth = this.value;\n\t\t$$invalidate(4, width);\n\t}\n\n\tfunction input1_change_handler() {\n\t\tmaintainAspectRatio = this.checked;\n\t\t$$invalidate(3, maintainAspectRatio);\n\t}\n\n\tfunction input2_input_handler() {\n\t\theight = this.value;\n\t\t$$invalidate(5, height);\n\t}\n\n\tfunction div3_binding($$value) {\n\t\tbinding_callbacks[$$value ? \"unshift\" : \"push\"](() => {\n\t\t\tfieldsGroup = $$value;\n\t\t\t$$invalidate(2, fieldsGroup);\n\t\t});\n\t}\n\n\tfunction measure_handler(event) {\n\t\tbubble($$self, event);\n\t}\n\n\t$$self.$$set = $$props => {\n\t\tif (\"isActive\" in $$props) $$subscribe_isActive($$invalidate(0, isActive = $$props.isActive));\n\t\tif (\"stores\" in $$props) $$invalidate(24, stores = $$props.stores);\n\t\tif (\"locale\" in $$props) $$invalidate(1, locale = $$props.locale);\n\t\tif (\"resizeMinSize\" in $$props) $$invalidate(25, resizeMinSize = $$props.resizeMinSize);\n\t\tif (\"resizeMaxSize\" in $$props) $$invalidate(26, resizeMaxSize = $$props.resizeMaxSize);\n\t};\n\n\tlet widthState;\n\tlet heightState;\n\tlet footerStyle;\n\n\t$$self.$$.update = () => {\n\t\tif ($$self.$$.dirty[0] & /*maintainAspectRatio*/ 8) {\n\t\t\t iconActiveFraction.set(maintainAspectRatio ? 1 : 0);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*activeField*/ 8) {\n\t\t\t if (activeField) lastActiveField = activeField;\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*width*/ 16) {\n\t\t\t $$invalidate(32, widthFormatted = formatValue(width));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*height*/ 32) {\n\t\t\t $$invalidate(33, heightFormatted = formatValue(height));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*resizeMinSize, resizeMaxSize*/ 100663296 | $$self.$$.dirty[1] & /*widthFormatted, activeField*/ 10) {\n\t\t\t $$invalidate(8, widthState = widthFormatted != null && activeField !== \"width\"\n\t\t\t? widthFormatted >= resizeMinSize.width && widthFormatted <= resizeMaxSize.width\n\t\t\t\t? \"valid\"\n\t\t\t\t: \"invalid\"\n\t\t\t: \"undetermined\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*resizeMinSize, resizeMaxSize*/ 100663296 | $$self.$$.dirty[1] & /*heightFormatted, activeField*/ 12) {\n\t\t\t $$invalidate(9, heightState = heightFormatted != null && activeField !== \"height\"\n\t\t\t? heightFormatted >= resizeMinSize.height && heightFormatted <= resizeMaxSize.height\n\t\t\t\t? \"valid\"\n\t\t\t\t: \"invalid\"\n\t\t\t: \"undetermined\");\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*heightFormatted, $imageCropRectAspectRatio, $imageCropRect*/ 100) {\n\t\t\t $$invalidate(6, widthPlaceholder = Math.round(heightFormatted != null\n\t\t\t? heightFormatted * $imageCropRectAspectRatio\n\t\t\t: $imageCropRect.width));\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*widthFormatted, $imageCropRectAspectRatio, $imageCropRect*/ 98) {\n\t\t\t $$invalidate(7, heightPlaceholder = Math.round(widthFormatted != null\n\t\t\t? widthFormatted / $imageCropRectAspectRatio\n\t\t\t: $imageCropRect.height));\n\t\t}\n\n\t\tif ($$self.$$.dirty[0] & /*maintainAspectRatio, width, height*/ 56) {\n\t\t\t if (maintainAspectRatio && width && height) syncFields();\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$isActive*/ 1024) {\n\t\t\t footerOffset.set($isActive ? 0 : 20);\n\t\t}\n\n\t\tif ($$self.$$.dirty[1] & /*$footerOffset*/ 2048) {\n\t\t\t $$invalidate(10, footerStyle = $footerOffset\n\t\t\t? `transform: translateY(${$footerOffset}px)`\n\t\t\t: undefined);\n\t\t}\n\t};\n\n\treturn [\n\t\tisActive,\n\t\tlocale,\n\t\tfieldsGroup,\n\t\tmaintainAspectRatio,\n\t\twidth,\n\t\theight,\n\t\twidthPlaceholder,\n\t\theightPlaceholder,\n\t\twidthState,\n\t\theightState,\n\t\tfooterStyle,\n\t\t$iconActiveFraction,\n\t\ticonActiveFraction,\n\t\timageSize,\n\t\timageCropRect,\n\t\timageCropRectAspectRatio,\n\t\timageCropAspectRatio,\n\t\timageOutputSize,\n\t\tformId,\n\t\thandleFocusIn,\n\t\thandleFocusOut,\n\t\thandleSubmit,\n\t\tfooterOffset,\n\t\tname,\n\t\tstores,\n\t\tresizeMinSize,\n\t\tresizeMaxSize,\n\t\tinput0_input_handler,\n\t\tinput1_change_handler,\n\t\tinput2_input_handler,\n\t\tdiv3_binding,\n\t\tmeasure_handler\n\t];\n}\n\nclass Resize extends SvelteComponent {\n\tconstructor(options) {\n\t\tsuper();\n\n\t\tinit(\n\t\t\tthis,\n\t\t\toptions,\n\t\t\tinstance$G,\n\t\t\tcreate_fragment$G,\n\t\t\tsafe_not_equal,\n\t\t\t{\n\t\t\t\tname: 23,\n\t\t\t\tisActive: 0,\n\t\t\t\tstores: 24,\n\t\t\t\tlocale: 1,\n\t\t\t\tresizeMinSize: 25,\n\t\t\t\tresizeMaxSize: 26\n\t\t\t},\n\t\t\t[-1, -1]\n\t\t);\n\t}\n\n\tget name() {\n\t\treturn this.$$.ctx[23];\n\t}\n\n\tget isActive() {\n\t\treturn this.$$.ctx[0];\n\t}\n\n\tset isActive(isActive) {\n\t\tthis.$set({ isActive });\n\t\tflush();\n\t}\n\n\tget stores() {\n\t\treturn this.$$.ctx[24];\n\t}\n\n\tset stores(stores) {\n\t\tthis.$set({ stores });\n\t\tflush();\n\t}\n\n\tget locale() {\n\t\treturn this.$$.ctx[1];\n\t}\n\n\tset locale(locale) {\n\t\tthis.$set({ locale });\n\t\tflush();\n\t}\n\n\tget resizeMinSize() {\n\t\treturn this.$$.ctx[25];\n\t}\n\n\tset resizeMinSize(resizeMinSize) {\n\t\tthis.$set({ resizeMinSize });\n\t\tflush();\n\t}\n\n\tget resizeMaxSize() {\n\t\treturn this.$$.ctx[26];\n\t}\n\n\tset resizeMaxSize(resizeMaxSize) {\n\t\tthis.$set({ resizeMaxSize });\n\t\tflush();\n\t}\n}\n\n// @ts-ignore\nvar index$6 = { util: ['resize', Resize] };\n\nconst cropSelectPresetOptionsDefault = [\n    [\n        'Crop',\n        [\n            [undefined, 'Custom'],\n            [1, 'Square'],\n            [4 / 3, 'Landscape'],\n            [3 / 4, 'Portrait'],\n        ],\n    ],\n    [\n        'Size',\n        [\n            [[180, 180], 'Profile Picture'],\n            [[1200, 600], 'Header Image'],\n            [[800, 400], 'Timeline Photo'],\n        ],\n    ],\n];\nvar defaults$2 = {\n    cropSelectPresetOptions: cropSelectPresetOptionsDefault,\n};\n\nconst IconCross =\n    '<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M18 6L6 18M6 6l12 12\"></path></path></g>';\n\nvar en_gb = {\n    // generic\n    labelReset: 'Reset',\n    labelDefault: 'Default',\n    labelAuto: 'Auto',\n    labelNone: 'None',\n    labelEdit: 'Edit',\n    labelClose: 'Close',\n    labelSupportError: (features) => `${features.join(', ')} not supported on this browser`,\n\n    // sizes\n    labelSizeExtraSmall: 'Extra small',\n    labelSizeSmall: 'Small',\n    labelSizeMediumSmall: 'Medium small',\n    labelSizeMedium: 'Medium',\n    labelSizeMediumLarge: 'Medium large',\n    labelSizeLarge: 'Large',\n    labelSizeExtraLarge: 'Extra large',\n\n    // unused?\n    labelButtonRevert: 'Revert',\n    labelButtonCancel: 'Cancel',\n\n    labelButtonUndo: 'Undo',\n    labelButtonRedo: 'Redo',\n    labelButtonExport: 'Done',\n\n    iconSupportError: `<g fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\"/><g><line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\"/><line x1=\"12\" y1=\"17\" x2=\"12.01\" y2=\"17\"/></g>`,\n    iconButtonClose: IconCross,\n    iconButtonRevert: `<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M7.388 18.538a8 8 0 10-2.992-9.03\"/><path fill=\"currentColor\" d=\"M2.794 11.696L2.37 6.714l5.088 3.18z\"/><path d=\"M12 8v4M12 12l4 2\"/></g>`,\n    iconButtonUndo: `<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M10 8h4c2.485 0 5 2 5 5s-2.515 5-5 5h-4\"/><path fill=\"currentColor\" d=\"M5 8l4-3v6z\"/></g>`,\n    iconButtonRedo: `<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M14 8h-4c-2.485 0-5 2-5 5s2.515 5 5 5h4\"/><path fill=\"currentColor\" d=\"M19 8l-4-3v6z\"/></g>`,\n    iconButtonExport: `<polyline points=\"20 6 9 17 4 12\" fill=\"none\" stroke=\"currentColor\" stroke-width=\".125em\"></polyline>`,\n\n    // status\n    statusLabelButtonClose: 'Close',\n    statusIconButtonClose: IconCross,\n    statusLabelLoadImage: (state) => {\n        if (!state || !state.task) return 'Waiting for image';\n        if (state.error)\n            return state.error.code === 'IMAGE_TOO_SMALL'\n                ? 'Minimum image size is {minWidth}  {minHeight}'\n                : 'Error loading image';\n        if (state.task === 'blob-to-bitmap') return 'Creating preview';\n        return 'Loading image';\n    },\n\n    // processing status message\n    statusLabelProcessImage: (state) => {\n        if (!state || !state.task) return undefined;\n        if (state.task === 'store') {\n            if (state.error) return 'Error uploading image';\n            return 'Uploading image';\n        }\n        if (state.error) return 'Error processing image';\n        return 'Processing image';\n    },\n};\n\nconst MarkupEditor = {\n    shapeLabelButtonSelectSticker: 'Select image',\n    shapeIconButtonSelectSticker: `<g><circle fill=\"currentColor\" cx=\"5\" cy=\"6\" r=\"1.333\"/><g fill=\"none\" stroke=\"currentColor\" stroke-width=\"0.0625em\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect x=\"1\" y=\"1\" width=\"14\" height=\"14\" rx=\"2\"/><path d=\"M15 13l-5-6-5 8\"/></g></g>`,\n\n    shapeIconButtonFlipHorizontal: `<svg width=\"24\" height=\"24\" xmlns=\"http://www.w3.org/2000/svg\"><g stroke=\"#FFF\" stroke-width=\"2\" fill=\"none\" fill-rule=\"evenodd\"><path d=\"M6 6.5h5v11H6z\"/><path fill=\"#FFF\" d=\"M15 6.5h3v11h-3z\"/><path d=\"M11 4v16\" fill=\"#fff\"/></g></svg>`,\n    shapeIconButtonFlipVertical: `<g stroke=\"currentColor\" stroke-width=\".125em\"><rect x=\"7\" y=\"8\" width=\"11\" height=\"5\" fill=\"none\"/><rect x=\"7\" y=\"17\" width=\"11\" height=\"2\" fill=\"currentColor\"/><line x1=\"5\" y1=\"13\" x2=\"20\" y2=\"13\"/></g>`,\n    shapeIconButtonRemove: `<g fill=\"none\" fill-rule=\"evenodd\"><path stroke=\"#FFF\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M7.5 7h9z\"/><path d=\"M7.916 9h8.168a1 1 0 01.99 1.14l-.972 6.862a2 2 0 01-1.473 1.653c-.877.23-1.753.345-2.629.345-.876 0-1.752-.115-2.628-.345a2 2 0 01-1.473-1.653l-.973-6.862A1 1 0 017.916 9z\" fill=\"#FFF\"/><rect fill=\"#FFF\" x=\"10\" y=\"5\" width=\"4\" height=\"3\" rx=\"1\"/></g>`,\n    shapeIconButtonDuplicate: `<g fill=\"none\" fill-rule=\"evenodd\"><path d=\"M15 13.994V16a2 2 0 01-2 2H8a2 2 0 01-2-2v-5a2 2 0 012-2h2.142\" stroke=\"currentColor\" stroke-width=\".125em\"/><path d=\"M15 9V8a1 1 0 00-2 0v1h-1a1 1 0 000 2h1v1a1 1 0 002 0v-1h1a1 1 0 000-2h-1zm-4-4h6a2 2 0 012 2v6a2 2 0 01-2 2h-6a2 2 0 01-2-2V7a2 2 0 012-2z\" fill=\"currentColor\"/></g>`,\n    shapeIconButtonMoveToFront: `<g fill=\"none\" fill-rule=\"evenodd\"><rect fill=\"currentColor\" x=\"11\" y=\"13\" width=\"8\" height=\"2\" rx=\"1\"/><rect fill=\"currentColor\" x=\"9\" y=\"17\" width=\"10\" height=\"2\" rx=\"1\"/><path d=\"M11.364 8H10a5 5 0 000 10M12 6.5L14.5 8 12 9.5z\" stroke=\"currentColor\" stroke-width=\".125em\" stroke-linecap=\"round\"/></g>`,\n\n    shapeTitleButtonFlipHorizontal: 'Flip Horizontal',\n    shapeTitleButtonFlipVertical: 'Flip Vertical',\n    shapeTitleButtonRemove: 'Remove',\n    shapeTitleButtonDuplicate: 'Duplicate',\n    shapeTitleButtonMoveToFront: 'Move to front',\n\n    shapeLabelInputText: 'Edit text',\n\n    shapeIconInputCancel: `<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M18 6L6 18M6 6l12 12\"/></g>`,\n    shapeIconInputConfirm: `<g fill=\"none\" fill-rule=\"evenodd\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><polyline points=\"20 6 9 17 4 12\"/></g>`,\n    shapeLabelInputCancel: 'Cancel',\n    shapeLabelInputConfirm: 'Confirm',\n\n    shapeLabelStrokeNone: 'No outline',\n\n    shapeLabelFontStyleNormal: 'Normal',\n    shapeLabelFontStyleBold: 'Bold',\n    shapeLabelFontStyleItalic: 'Italic',\n    shapeLabelFontStyleItalicBold: 'Italic Bold',\n\n    shapeTitleBackgroundColor: 'Fill color',\n\n    shapeTitleFontFamily: 'Font',\n    shapeTitleFontSize: 'Font size',\n    shapeTitleFontStyle: 'Font style',\n    shapeTitleLineHeight: 'Leading',\n\n    shapeTitleLineStart: 'Start',\n    shapeTitleLineEnd: 'End',\n    shapeTitleStrokeWidth: 'Line width',\n    shapeTitleStrokeColor: 'Line color',\n\n    shapeTitleLineDecorationBar: 'Bar',\n    shapeTitleLineDecorationCircle: 'Circle',\n    shapeTitleLineDecorationSquare: 'Square',\n    shapeTitleLineDecorationArrow: 'Arrow',\n    shapeTitleLineDecorationCircleSolid: 'Circle solid',\n    shapeTitleLineDecorationSquareSolid: 'Square solid',\n    shapeTitleLineDecorationArrowSolid: 'Arrow solid',\n\n    shapeIconLineDecorationBar: `<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H16\"/><path d=\"M16,8 V16\"/></g>`,\n    shapeIconLineDecorationCircle: `<g stroke=\"currentColor\" stroke-linecap=\"round\"><path stroke-width=\".125em\" d=\"M5,12 H12\"/><circle fill=\"none\" stroke-width=\".125em\" cx=\"16\" cy=\"12\" r=\"4\"/></g>`,\n    shapeIconLineDecorationSquare: `<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H16\"/><path d=\"M13,7 l6,5 l-6,5z\" fill=\"currentColor\"/></g>`,\n    shapeIconLineDecorationArrow: `<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H16 M13,7 l6,5 l-6,5\" fill=\"none\"/></g>`,\n    shapeIconLineDecorationCircleSolid: `<g stroke=\"currentColor\" stroke-linecap=\"round\"><path stroke-width=\".125em\" d=\"M5,12 H12\"/><circle fill=\"currentColor\" cx=\"16\" cy=\"12\" r=\"4\"/></g>`,\n    shapeIconLineDecorationSquareSolid: `<g stroke=\"currentColor\" stroke-linecap=\"round\"><path stroke-width=\".125em\" d=\"M5,12 H12\"/><rect fill=\"currentColor\" x=\"12\" y=\"8\" width=\"8\" height=\"8\"/></g>`,\n    shapeIconLineDecorationArrowSolid: `<g stroke=\"currentColor\" stroke-linecap=\"round\" stroke-width=\".125em\"><path d=\"M5,12 H16\"/><path d=\"M13,7 l6,5 l-6,5z\" fill=\"currentColor\"/></g>`,\n\n    shapeTitleColorTransparent: 'Transparent',\n    shapeTitleColorWhite: 'White',\n    shapeTitleColorSilver: 'Silver',\n    shapeTitleColorGray: 'Gray',\n    shapeTitleColorBlack: 'Black',\n    shapeTitleColorNavy: 'Navy',\n    shapeTitleColorBlue: 'Blue',\n    shapeTitleColorAqua: 'Aqua',\n    shapeTitleColorTeal: 'Teal',\n    shapeTitleColorOlive: 'Olive',\n    shapeTitleColorGreen: 'Green',\n    shapeTitleColorYellow: 'Yellow',\n    shapeTitleColorOrange: 'Orange',\n    shapeTitleColorRed: 'Red',\n    shapeTitleColorMaroon: 'Maroon',\n    shapeTitleColorFuchsia: 'Fuchsia',\n    shapeTitleColorPurple: 'Purple',\n\n    shapeTitleTextColor: 'Font color',\n    shapeTitleTextAlign: 'Text align',\n    shapeTitleTextAlignLeft: 'Left align text',\n    shapeTitleTextAlignCenter: 'Center align text',\n    shapeTitleTextAlignRight: 'Right align text',\n\n    shapeIconTextAlignLeft: `<g stroke-width=\".125em\" stroke=\"currentColor\"><line x1=\"5\" y1=\"8\" x2=\"15\" y2=\"8\"/><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/><line x1=\"5\" y1=\"16\" x2=\"14\" y2=\"16\"/></g>`,\n    shapeIconTextAlignCenter: `<g stroke-width=\".125em\" stroke=\"currentColor\"><line x1=\"7\" y1=\"8\" x2=\"17\" y2=\"8\"/><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/><line x1=\"8\" y1=\"16\" x2=\"16\" y2=\"16\"/></g>`,\n    shapeIconTextAlignRight: `<g stroke-width=\".125em\" stroke=\"currentColor\"><line x1=\"9\" y1=\"8\" x2=\"19\" y2=\"8\"/><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"/><line x1=\"11\" y1=\"16\" x2=\"19\" y2=\"16\"/></g>`,\n\n    shapeLabelToolSharpie: 'Sharpie',\n    shapeLabelToolEraser: 'Eraser',\n    shapeLabelToolRectangle: 'Rectangle',\n    shapeLabelToolEllipse: 'Ellipse',\n    shapeLabelToolArrow: 'Arrow',\n    shapeLabelToolLine: 'Line',\n    shapeLabelToolText: 'Text',\n    shapeLabelToolPreset: 'Stickers',\n\n    shapeIconToolSharpie: `<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1\" stroke=\"currentColor\" stroke-width=\".125em\" fill=\"none\" fill-rule=\"evenodd\" stroke-linejoin=\"round\"/></g>`,\n    shapeIconToolEraser: `<g stroke-width=\".125em\" stroke=\"currentColor\" stroke-linecap=\"round\" fill=\"none\"><g transform=\"translate(3, 15) rotate(-45)\"><rect x=\"0\" y=\"0\" width=\"18\" height=\"10\" rx=\"3\"/></g><line x1=\"11\" y1=\"21\" x2=\"18\" y2=\"21\"/><line x1=\"20\" y1=\"21\" x2=\"22\" y2=\"21\"/></g>`,\n    shapeIconToolRectangle: `<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><rect x=\"2\" y=\"2\" width=\"20\" height=\"20\" rx=\"3\"/></g>`,\n    shapeIconToolEllipse: `<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><circle cx=\"12\" cy=\"12\" r=\"11\"/></g>`,\n    shapeIconToolArrow: `<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><line x1=\"20\" y1=\"3\" x2=\"6\" y2=\"21\"/><path d=\"m10 5 L22 1 L21 13\" fill=\"currentColor\" stroke=\"none\"/></g>`,\n    shapeIconToolLine: `<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><line x1=\"20\" y1=\"3\" x2=\"6\" y2=\"21\"/></g>`,\n    shapeIconToolText: `<g stroke=\"none\" fill=\"currentColor\" transform=\"translate(6,0)\"><path d=\"M8.14 20.085c.459 0 .901-.034 1.329-.102a8.597 8.597 0 001.015-.21v1.984c-.281.135-.695.247-1.242.336a9.328 9.328 0 01-1.477.133c-3.312 0-4.968-1.745-4.968-5.235V6.804H.344v-1.25l2.453-1.078L3.89.819h1.5v3.97h4.97v2.015H5.39v10.078c0 1.031.245 1.823.735 2.375s1.161.828 2.015.828z\"/>`,\n    shapeIconToolPreset: `<g fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z\"></path><path d=\"M20 17c-3 3-5 5-8 5\"></path></g>`,\n};\n\nvar en_gb$1 = {\n    cropLabel: 'Crop',\n    cropIcon:\n        '<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M23 17H9a2 2 0 0 1-2-2v-5m0-3V1\"/><path d=\"M1 7h14a2 2 0 0 1 2 2v7m0 4v3\"/></g>',\n\n    cropIconButtonRecenter: `<path stroke=\"currentColor\" fill=\"none\" stroke-width=\"2\" stroke-linejoin=\"bevel\" d=\"M1.5 7.5v-6h6M1.5 16.5v6h6M22.5 16.5v6h-6M22.5 7.5v-6h-6\"/><circle cx=\"12\" cy=\"12\" r=\"3.5\" fill=\"currentColor\" stroke=\"none\"/>`,\n    cropIconButtonRotateLeft:\n        '<g stroke=\"none\" fill=\"currentColor\"><path fill=\"none\" d=\"M-1-1h582v402H-1z\"/><rect x=\"3\" rx=\"1\" height=\"12\" width=\"12\" y=\"9\"/><path d=\"M15 5h-1a5 5 0 015 5 1 1 0 002 0 7 7 0 00-7-7h-1.374l.747-.747A1 1 0 0011.958.84L9.603 3.194a1 1 0 000 1.415l2.355 2.355a1 1 0 001.415-1.414l-.55-.55H15z\"/></g>',\n    cropIconButtonRotateRight:\n        '<g stroke=\"none\" fill=\"currentColor\"><path fill=\"none\" d=\"M-1-1h582v402H-1z\"/><path d=\"M11.177 5H10a5 5 0 00-5 5 1 1 0 01-2 0 7 7 0 017-7h1.374l-.747-.747A1 1 0 0112.042.84l2.355 2.355a1 1 0 010 1.415l-2.355 2.354a1 1 0 01-1.415-1.414l.55-.55z\"/><rect rx=\"1\" height=\"12\" width=\"12\" y=\"9\" x=\"9\"/></g>',\n    cropIconButtonFlipVertical:\n        '<g stroke=\"none\" fill=\"currentColor\"><path d=\"M19.993 12.143H7a1 1 0 0 1-1-1V5.994a1 1 0 0 1 1.368-.93l12.993 5.15a1 1 0 0 1-.368 1.93z\"/><path d=\"M19.993 14a1 1 0 0 1 .368 1.93L7.368 21.078A1 1 0 0 1 6 20.148V15a1 1 0 0 1 1-1h12.993z\" opacity=\".6\"/></g>',\n    cropIconButtonFlipHorizontal:\n        '<g stroke=\"none\" fill=\"currentColor\"><path d=\"M11.93 7.007V20a1 1 0 0 1-1 1H5.78a1 1 0 0 1-.93-1.368l5.15-12.993a1 1 0 0 1 1.929.368z\"/><path d=\"M14 7.007V20a1 1 0 0 0 1 1h5.149a1 1 0 0 0 .93-1.368l-5.15-12.993A1 1 0 0 0 14 7.007z\" opacity=\".6\"/></g>',\n\n    cropLabelButtonRecenter: 'Recenter',\n    cropLabelButtonRotateLeft: 'Rotate left',\n    cropLabelButtonRotateRight: 'Rotate right',\n    cropLabelButtonFlipHorizontal: 'Flip horizontal',\n    cropLabelButtonFlipVertical: 'Flip vertical',\n\n    cropLabelSelectPreset: 'Crop shape',\n\n    cropLabelCropBoundary: 'Crop boundary',\n    cropLabelCropBoundaryEdge: 'Edge of image',\n    cropLabelCropBoundaryNone: 'None',\n\n    cropLabelTabRotation: 'Rotation',\n    cropLabelTabZoom: 'Zoom',\n};\n\nvar en_gb$2 = {\n    filterLabel: 'Filter',\n    filterIcon:\n        '<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M18.347 9.907a6.5 6.5 0 1 0-1.872 3.306M3.26 11.574a6.5 6.5 0 1 0 2.815-1.417\"/><path d=\"M10.15 17.897A6.503 6.503 0 0 0 16.5 23a6.5 6.5 0 1 0-6.183-8.51\"/></g>',\n    filterLabelChrome: 'Chrome',\n    filterLabelFade: 'Fade',\n    filterLabelCold: 'Cold',\n    filterLabelWarm: 'Warm',\n    filterLabelPastel: 'Pastel',\n    filterLabelMonoDefault: 'Mono',\n    filterLabelMonoNoir: 'Noir',\n    filterLabelMonoWash: 'Wash',\n    filterLabelMonoStark: 'Stark',\n    filterLabelSepiaDefault: 'Sepia',\n    filterLabelSepiaBlues: 'Blues',\n    filterLabelSepiaRust: 'Rust',\n    filterLabelSepiaColor: 'Color',\n};\n\nvar en_gb$3 = {\n    finetuneLabel: 'Finetune',\n    finetuneIcon:\n        '<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M4 1v5.5m0 3.503V23M12 1v10.5m0 3.5v8M20 1v15.5m0 3.5v3M2 7h4M10 12h4M18 17h4\"/></g>',\n\n    finetuneLabelBrightness: 'Brightness',\n    finetuneLabelContrast: 'Contrast',\n    finetuneLabelSaturation: 'Saturation',\n    finetuneLabelExposure: 'Exposure',\n    finetuneLabelTemperature: 'Temperature',\n    finetuneLabelGamma: 'Gamma',\n    finetuneLabelClarity: 'Clarity',\n    finetuneLabelVignette: 'Vignette',\n};\n\nvar en_gb$4 = {\n    resizeLabel: 'Resize',\n    resizeIcon:\n        '<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><rect x=\"2\" y=\"12\" width=\"10\" height=\"10\" rx=\"2\"/><path d=\"M4 11.5V4a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5\"/><path d=\"M14 10l3.365-3.365M14 6h4v4\"/></g>',\n\n    resizeLabelFormCaption: 'Image output size',\n\n    resizeLabelInputWidth: 'w',\n    resizeTitleInputWidth: 'Width',\n    resizeLabelInputHeight: 'h',\n    resizeTitleInputHeight: 'Height',\n\n    resizeTitleButtonMaintainAspectRatio: 'Maintain aspectratio',\n\n    resizeIconButtonMaintainAspectRatio: (active, activeFraction) => `\n        <defs>\n            <mask id=\"mask1\" x=\"0\" y=\"0\" width=\"24\" height=\"24\" >\n                <rect x=\"0\" y=\"0\" width=\"24\" height=\"10\" fill=\"#fff\" stroke=\"none\"/>\n            </mask>\n        </defs>\n        <g fill=\"none\" fill-rule=\"evenodd\">\n            <g  mask=\"url(#mask1)\">\n                <path transform=\"translate(0 ${\n                    (activeFraction - 1) * 3\n                })\" stroke=\"currentColor\" stroke-width=\"1.5\" stroke-linecap=\"round\" d=\"M9.401 10.205v-.804a2.599 2.599 0 0 1 5.198 0V17\"/>\n            </g>\n            <rect fill=\"currentColor\" x=\"7\" y=\"10\" width=\"10\" height=\"7\" rx=\"1.5\"/>\n        </g>\n    `,\n};\n\nvar en_gb$5 = {\n    decorateLabel: 'Decorate',\n    decorateIcon:\n        '<g fill=\"none\" fill-rule=\"evenodd\"><path stroke=\"currentColor\" stroke-width=\".125em\" stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M12 18.5l-6.466 3.4 1.235-7.2-5.23-5.1 7.228-1.05L12 2l3.233 6.55 7.229 1.05-5.231 5.1 1.235 7.2z\"/></g>',\n};\n\nvar en_gb$6 = {\n    annotateLabel: 'Annotate',\n    annotateIcon:\n        '<g stroke-width=\".125em\" stroke=\"currentColor\" fill=\"none\"><path d=\"M17.086 2.914a2.828 2.828 0 1 1 4 4l-14.5 14.5-5.5 1.5 1.5-5.5 14.5-14.5z\"/></g>',\n};\n\nvar en_gb$7 = {\n    stickerLabel: 'Sticker',\n    stickerIcon:\n        '<g fill=\"none\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke=\"currentColor\" stroke-width=\".125em\"><path d=\"M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z\"/><path d=\"M20 17c-3 3-5 5-8 5\"/></g>',\n};\n\n/* Deprecated, remove in v8, use `createDefaultImageOrienter` instead */\nconst imageOrienter = {\n    read: getImageOrientationFromFile,\n    apply: orientImageData,\n};\n\nconst createDefaultImageOrienter = () => ({\n    read: getImageOrientationFromFile,\n    apply: orientImageData,\n});\nconst createEditor = createImageEditor;\nconst getEditorProps$1 = () => getEditorProps().concat(getEditorViewProps());\n\nconst processImage = (src, options) => {\n    const { processImage } = createImageEditor();\n    return processImage(src, options);\n};\n\nconst createMarkupEditorToolbar = createToolbar;\nconst createMarkupEditorToolStyles = createToolStyles;\n\n// markup editor style controls\nconst createMarkupEditorShapeStyleControls = createShapeStyleControls;\n\nconst markup_editor_defaults = {\n    markupEditorToolbar: createToolbar(),\n    markupEditorToolStyles: createToolStyles(),\n    markupEditorShapeStyleControls: createShapeStyleControls(),\n};\n\n//\n// deprecated exports\n//\nconst plugin_annotate_defaults = {\n    ...markup_editor_defaults,\n    annotateTools: createToolbar(),\n    annotateToolShapes: createToolStyles(),\n    annotateShapeControls: createShapeStyleControls(),\n};\n\nconst plugin_decorate_defaults = {\n    ...markup_editor_defaults,\n    decorateTools: createToolbar(),\n    decorateToolShapes: createToolStyles(),\n    decorateShapeControls: createShapeStyleControls(),\n};\n\nconst plugin_resize_defaults = {};\nconst plugin_sticker_defaults = {};\n\nexport { appendEditor, appendEditors, appendNode, blobToFile, colorStringToColorArray, MarkupEditor as component_shape_editor_locale_en_gb, createDefaultColorOptions, createDefaultFontFamilyOptions, createDefaultFontScaleOptions, createDefaultFontSizeOptions, createDefaultFontStyleOptions, createDefaultImageOrienter, createDefaultImageReader, createDefaultImageWriter, createDefaultLineEndStyleOptions, createDefaultStrokeScaleOptions, createDefaultStrokeWidthOptions, createDefaultTextAlignOptions, createEditor, createBackgroundColorControl as createMarkupEditorBackgroundColorControl, createColorOptions as createMarkupEditorColorOptions, createFontColorControl as createMarkupEditorFontColorControl, createFontFamilyControl as createMarkupEditorFontFamilyControl, createFontFamilyOptions as createMarkupEditorFontFamilyOptions, createFontScaleOptions as createMarkupEditorFontScaleOptions, createFontSizeControl as createMarkupEditorFontSizeControl, createFontSizeOptions as createMarkupEditorFontSizeOptions, createFontStyleControl as createMarkupEditorFontStyleControl, createFontStyleOptions as createMarkupEditorFontStyleOptions, createLineEndStyleControl as createMarkupEditorLineEndStyleControl, createLineEndStyleOptions as createMarkupEditorLineEndStyleOptions, createLineHeightControl as createMarkupEditorLineHeightControl, createLineStartStyleControl as createMarkupEditorLineStartStyleControl, createMarkupEditorShapeStyleControls, createStrokeColorControl as createMarkupEditorStrokeColorControl, createStrokeScaleOptions as createMarkupEditorStrokeScaleOptions, createStrokeWidthControl as createMarkupEditorStrokeWidthControl, createStrokeWidthOptions as createMarkupEditorStrokeWidthOptions, createTextAlignControl as createMarkupEditorTextAlignControl, createToolStyle as createMarkupEditorToolStyle, createMarkupEditorToolStyles, createMarkupEditorToolbar, createNode, customElement as defineCustomElements, degToRad, dispatchEditorEvents, brightness as effectBrightness, clarity as effectClarity, contrast as effectContrast, exposure as effectExposure, gamma as effectGamma, saturation as effectSaturation, temperature as effectTemperature, vignette as effectVignette, chrome as filterChrome, cold as filterCold, fade$1 as filterFade, invert as filterInvert, monoDefault as filterMonoDefault, monoNoir as filterMonoNoir, monoStark as filterMonoStark, monoWash as filterMonoWash, pastel as filterPastel, sepiaBlues as filterSepiaBlues, sepiaColor as filterSepiaColor, sepiaDefault as filterSepiaDefault, sepiaRust as filterSepiaRust, warm as filterWarm, findNode, getEditorProps$1 as getEditorProps, imageOrienter, insertNodeAfter, insertNodeBefore, isModernBrowser as isSupported, legacyDataToImageState, en_gb as locale_en_gb, markup_editor_defaults, MarkupEditor as markup_editor_locale_en_gb, openEditor, overlayEditor, index$3 as plugin_annotate, plugin_annotate_defaults, en_gb$6 as plugin_annotate_locale_en_gb, index as plugin_crop, defaults$2 as plugin_crop_defaults, en_gb$1 as plugin_crop_locale_en_gb, index$4 as plugin_decorate, plugin_decorate_defaults, en_gb$5 as plugin_decorate_locale_en_gb, index$1 as plugin_filter, defaults$1 as plugin_filter_defaults, en_gb$2 as plugin_filter_locale_en_gb, index$2 as plugin_finetune, defaults as plugin_finetune_defaults, en_gb$3 as plugin_finetune_locale_en_gb, index$6 as plugin_resize, plugin_resize_defaults, en_gb$4 as plugin_resize_locale_en_gb, index$5 as plugin_sticker, plugin_sticker_defaults, en_gb$7 as plugin_sticker_locale_en_gb, processImage, removeNode, setEditorViewPlugins as setPlugins };\n"]},"metadata":{},"sourceType":"module"}