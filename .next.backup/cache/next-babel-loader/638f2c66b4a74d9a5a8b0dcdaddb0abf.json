{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useEffect } from 'react';\nimport { Contract } from '@ethersproject/contracts';\nimport { useWeb3React } from '@web3-react/core';\n\nvar getContract = function getContract(address, abi, library, account) {\n  return new Contract(address, abi, library.getSigner(account).connectUnchecked());\n};\n\nexport default function Approval(props) {\n  _s();\n\n  var _useWeb3React = useWeb3React(),\n      account = _useWeb3React.account;\n\n  useEffect(function () {\n    console.log('--------------', account);\n    var approved = checkApproval(props.handler, props.spending, props.library, props.account, props.amount);\n    console.log('--------------', approved);\n  });\n  return account ? __jsx(React.Fragment, null, \"test\") : null;\n\n  function checkApproval(handler, spending, library, account, amount) {\n    if (amount > 0) {\n      var check = /*#__PURE__*/function () {\n        var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          var spendingContract, allowance;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  spendingContract = getContract(spending.address, spending.abi, library, account);\n                  _context.next = 3;\n                  return spendingContract.allowance(account, handler.address);\n\n                case 3:\n                  allowance = _context.sent;\n                  return _context.abrupt(\"return\", allowance >= amount);\n\n                case 5:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee);\n        }));\n\n        return function check() {\n          return _ref.apply(this, arguments);\n        };\n      }();\n\n      var wtf = check().then(function (result) {\n        return result;\n      });\n      return wtf;\n    }\n\n    return false;\n  }\n} // export class Approval extends Component<AttributesProps> {\n//   render() {\n//     let handler = this.props.handler\n//     let spending = this.props.spending\n//     let amount = this.props.amount\n//     let label = this.props.label\n//     let library = this.props.library\n//     let account = this.props.account\n//     let approved = checkApproval(handler, spending, library, account, amount)\n//     return approved? (\n//       <></>\n//     ) : (\n//       <Flex w=\"100%\" flexWrap=\"wrap\" mt={3} >\n//         <Button backgroundColor={\"#02b402\"} color={\"black !important\"} fontWeight={\"bold !important\"} width=\"100%\">\n//           {label}\n//         </Button>\n//       </Flex>\n//     )\n//   }\n// }\n// export default Approval\n\n_s(Approval, \"tWAgYu2fF1waEiZXLSGmvTQNWT0=\", false, function () {\n  return [useWeb3React];\n});\n\n_c = Approval;\n\nvar _c;\n\n$RefreshReg$(_c, \"Approval\");","map":{"version":3,"sources":["/Users/shannoncode/repo/Emblem.Currentwork/emblem-vault-site/components/partials/Approval.tsx"],"names":["React","useEffect","Contract","useWeb3React","getContract","address","abi","library","account","getSigner","connectUnchecked","Approval","props","console","log","approved","checkApproval","handler","spending","amount","check","spendingContract","allowance","wtf","then","result"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAA2BC,SAA3B,QAA4C,OAA5C;AAaA,SAASC,QAAT,QAAyB,0BAAzB;AACA,SAASC,YAAT,QAA6B,kBAA7B;;AAEA,IAAMC,WAAW,GAAG,SAAdA,WAAc,CAACC,OAAD,EAAUC,GAAV,EAAeC,OAAf,EAAwBC,OAAxB,EAAwC;AAC1D,SAAO,IAAIN,QAAJ,CAAaG,OAAb,EAAsBC,GAAtB,EAA2BC,OAAO,CAACE,SAAR,CAAkBD,OAAlB,EAA2BE,gBAA3B,EAA3B,CAAP;AACD,CAFD;;AAcA,eAAe,SAASC,QAAT,CAAkBC,KAAlB,EAA0C;AAAA;;AAEvD,sBAAoBT,YAAY,EAAhC;AAAA,MAAQK,OAAR,iBAAQA,OAAR;;AAEAP,EAAAA,SAAS,CAAC,YAAI;AACVY,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA6BN,OAA7B;AACA,QAAIO,QAAQ,GAAGC,aAAa,CAACJ,KAAK,CAACK,OAAP,EAAgBL,KAAK,CAACM,QAAtB,EAAgCN,KAAK,CAACL,OAAtC,EAA+CK,KAAK,CAACJ,OAArD,EAA8DI,KAAK,CAACO,MAApE,CAA5B;AACAN,IAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BC,QAA9B;AACH,GAJQ,CAAT;AAMA,SAAOP,OAAO,GACV,mCADU,GAIX,IAJH;;AAMA,WAASQ,aAAT,CAAuBC,OAAvB,EAA+DC,QAA/D,EAAwGX,OAAxG,EAAsHC,OAAtH,EAAoIW,MAApI,EAAoJ;AAClJ,QAAIA,MAAM,GAAG,CAAb,EAAgB;AACd,UAAIC,KAAK;AAAA,4EAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AACNC,kBAAAA,gBADM,GACajB,WAAW,CAACc,QAAQ,CAACb,OAAV,EAAmBa,QAAQ,CAACZ,GAA5B,EAAiCC,OAAjC,EAA0CC,OAA1C,CADxB;AAAA;AAAA,yBAEYa,gBAAgB,CAACC,SAAjB,CAA2Bd,OAA3B,EAAoCS,OAAO,CAACZ,OAA5C,CAFZ;;AAAA;AAENiB,kBAAAA,SAFM;AAAA,mDAGHA,SAAS,IAAIH,MAHV;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAH;;AAAA,wBAALC,KAAK;AAAA;AAAA;AAAA,SAAT;;AAKA,UAAIG,GAAG,GAAGH,KAAK,GAAGI,IAAR,CAAa,UAACC,MAAD,EAAU;AAAC,eAAOA,MAAP;AAAc,OAAtC,CAAV;AACA,aAAOF,GAAP;AACD;;AACD,WAAO,KAAP;AACD;AACF,C,CACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;;GAlDwBZ,Q;UAEFR,Y;;;KAFEQ,Q","sourcesContent":["import React, { Component, useEffect } from 'react'\nimport {\n  Box,\n  Image,\n  Text,\n  Link,\n  useColorMode,\n  Button,\n  Flex,\n  PseudoBox\n} from '@chakra-ui/core'\n\nimport {HStack, VStack, Circle } from '@chakra-ui/react'\nimport { Contract } from '@ethersproject/contracts'\nimport { useWeb3React } from '@web3-react/core'\n\nconst getContract = (address, abi, library, account): any =>{\n  return new Contract(address, abi, library.getSigner(account).connectUnchecked())\n}\n\n\n\ntype AttributesProps = {\n  handler: {address: string, abi: any},\n  spending: {address: string, abi: any},\n  amount: number,\n  label: string,\n  library: any,\n  account: any,\n}\nexport default function Approval(props: AttributesProps) {\n  \n  const { account } = useWeb3React()\n\n  useEffect(()=>{\n      console.log('--------------',account)\n      let approved = checkApproval(props.handler, props.spending, props.library, props.account, props.amount)\n      console.log('--------------', approved)\n  })\n  \n  return account? (\n      <>\n          test\n      </>\n  ): null\n\n  function checkApproval(handler: { address: string; abi: any }, spending: { address: string; abi: any }, library: any, account: any, amount: number) {\n    if (amount > 0) {\n      let check = async ()=>{\n        let spendingContract = getContract(spending.address, spending.abi, library, account)\n        let allowance = await spendingContract.allowance(account, handler.address)\n        return allowance >= amount\n      }\n      let wtf = check().then((result)=>{return result})\n      return wtf\n    }\n    return false\n  }\n}\n// export class Approval extends Component<AttributesProps> {\n//   render() {\n//     let handler = this.props.handler\n//     let spending = this.props.spending\n//     let amount = this.props.amount\n//     let label = this.props.label\n//     let library = this.props.library\n//     let account = this.props.account\n//     let approved = checkApproval(handler, spending, library, account, amount)\n//     return approved? (\n//       <></>\n//     ) : (\n//       <Flex w=\"100%\" flexWrap=\"wrap\" mt={3} >\n//         <Button backgroundColor={\"#02b402\"} color={\"black !important\"} fontWeight={\"bold !important\"} width=\"100%\">\n//           {label}\n//         </Button>\n//       </Flex>\n//     )\n//   }\n// }\n\n// export default Approval\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}