{"ast":null,"code":"var _jsxFileName = \"/Users/shannoncode/repo/Emblem.Currentwork/emblem-vault-site/components/CreateCurated.tsx\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { FormControl, FormLabel, Stack, Tabs, TabList, TabPanels, Tab, TabPanel, Box, Flex, Button, ButtonGroup, Divider, useDisclosure, Select, Image } from '@chakra-ui/core';\nimport Loader from 'react-loader';\nimport { useWeb3React } from '@web3-react/core';\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/router';\nimport { EMBLEM_API, curatedContracts, curatedAssets } from '../constants';\nlet tokenId,\n    cipherTextHash,\n    nonce,\n    signature = null;\nlet mintPassword = null;\nexport default function CreateCurated(props) {\n  // modal\n  const {\n    0: modalVisible,\n    1: setModalVisible\n  } = useState(false);\n  const {\n    0: modalResult,\n    1: setModalResult\n  } = useState('');\n  const {\n    0: showEditorButton,\n    1: setShowEditorButton\n  } = useState(true);\n  const {\n    isOpen,\n    onToggle\n  } = useDisclosure();\n  const {\n    query\n  } = useRouter();\n  const {\n    0: tabIndex,\n    1: setTabIndex\n  } = useState(0);\n  const {\n    account,\n    chainId\n  } = useWeb3React();\n  const {\n    0: vaultAddress,\n    1: setVaultAddress\n  } = useState(account || '');\n  const {\n    0: vaultPubPriv,\n    1: setVaultPubPriv\n  } = useState('Public');\n  const {\n    0: vaultName,\n    1: setVaultName\n  } = useState('');\n  const {\n    0: vaultDesc,\n    1: setVaultDesc\n  } = useState('');\n  const {\n    0: vaultImage,\n    1: setVaultImage\n  } = useState('');\n  const {\n    0: ownedImage,\n    1: setOwnedImage\n  } = useState('');\n  const {\n    0: password,\n    1: setPassword\n  } = useState(''); // const [service, setService] = useState('')\n\n  const {\n    0: isCovalApproved,\n    1: setIsCovalApproved\n  } = useState(false);\n  const {\n    0: state,\n    1: setState\n  } = useState({\n    loaded: true,\n    private: false\n  });\n  const {\n    0: hash,\n    1: setHash\n  } = useState(null); // const [cipherTextHash, setCipherTextHash] = useState(null)\n  // const [tokenId, setTokenId] = useState(null)\n  // const [mintPassword, setMintPassword] = useState(null)\n  // const [nonce, setNonce] = useState(null)\n  // const [signature, setSignature] = useState(null)\n\n  const {\n    0: experimental,\n    1: setExperimental\n  } = useState(true);\n  const {\n    0: showPreVaultMsg,\n    1: setShowPreVaultMsg\n  } = useState(false);\n  const {\n    0: showMakingVaultMsg,\n    1: setShowMakingVaultMsg\n  } = useState(false);\n  const {\n    0: decimals,\n    1: setDecimals\n  } = useState(null);\n  const {\n    0: allowance,\n    1: setAllowance\n  } = useState(null);\n  const {\n    0: balance,\n    1: setBalance\n  } = useState(null);\n  const {\n    0: price,\n    1: setPrice\n  } = useState(null);\n  const {\n    0: creating,\n    1: setCreating\n  } = useState(false);\n  const {\n    0: approving,\n    1: setApproving\n  } = useState(false);\n  const {\n    0: vaultKey,\n    1: setVaultKey\n  } = useState('');\n  const {\n    0: vaultValue,\n    1: setVaultValue\n  } = useState('');\n  const {\n    0: showEmbed,\n    1: setShowEmbed\n  } = useState(false);\n  const {\n    0: targetAsset,\n    1: setTargetAsset\n  } = useState({\n    name: '',\n    image: ''\n  });\n  const {\n    0: targetContract,\n    1: setTargetContract\n  } = useState({\n    name: '',\n    chain: ''\n  });\n\n  const handleSubmit = evt => {\n    evt.preventDefault();\n    setState({\n      loaded: false,\n      private: state.private\n    });\n    let body = {\n      fromAddress: account,\n      toAddress: vaultAddress,\n      description: vaultDesc,\n      name: vaultName,\n      ownedImage: ownedImage,\n      image: vaultImage,\n      chainId: chainId,\n      private: state.private,\n      password: password || '',\n      values: [],\n      experimental: true,\n      targetContract: targetContract,\n      targetAsset: targetAsset\n    };\n\n    if (vaultKey && vaultValue) {\n      body.values.push({\n        \"key\": vaultKey,\n        value: vaultValue\n      });\n    }\n\n    console.log(JSON.stringify(body));\n    let apiSuffix = '/mint-curated'; //(chainId == 137 || chainId == 1) ? '/mint3' : '/mint'\n\n    fetch(EMBLEM_API + apiSuffix, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        service: 'evmetadata'\n      },\n      // We convert the React state to JSON and send it as the POST body\n      body: JSON.stringify(body)\n    }).then(async function (response) {\n      setState({\n        loaded: true,\n        private: state.private\n      });\n      let body = await response.json();\n      tokenId = body.data.tokenId; // console.log(body.data.nonce, body.data.signature, body.data.cipherTextHash)\n      // if (chainId === 137 || chainId == 1) {\n\n      nonce = body.data.nonce;\n      signature = body.data.signature;\n      cipherTextHash = body.data.cipherTextHash; // fireMetaMask()\n      // alert(\"Minting has been disabled temporarily while we work with Opensea to solve a bug where new vaults are not showing. Mint ONLY if you don't plan on using Opensea\")\n\n      setShowPreVaultMsg(false);\n      setTimeout(() => {\n        checkLiveliness(tokenId, () => {\n          location.href = location.origin + '/nft2?id=' + tokenId;\n        });\n      }, 500); // } else {\n      //   mintPassword = body.password\n      //   setHash(body.data.tx)\n      //   setShowPreVaultMsg(true)\n      // }\n    });\n  };\n\n  function previewFile() {\n    const preview = document.querySelector('#preview');\n    const inputelement = document.querySelector('input[type=file]'); //.files[0];\n\n    const reader = new FileReader();\n\n    if (inputelement.files[0].size > 5000000) {\n      delete inputelement.files;\n      return alert('File too large');\n    } else {// alert('under')\n    }\n\n    reader.addEventListener('load', function () {\n      var _reader$result;\n\n      // convert image file to base64 string\n      if (preview) preview.src = ((_reader$result = reader.result) === null || _reader$result === void 0 ? void 0 : _reader$result.toString()) || '';\n      if (preview) setVaultImage(preview.src);\n      setShowEditorButton(true);\n      setModalResult('');\n    }, false);\n\n    if (inputelement.files) {\n      reader.readAsDataURL(inputelement.files[0]);\n    }\n  }\n\n  const {\n    0: acct,\n    1: setAcct\n  } = useState('');\n  useEffect(() => {\n    if (account && acct != account) {\n      setAcct(account);\n      setVaultAddress(account);\n    }\n  }, [account, acct]);\n  useEffect(() => {\n    account && chainId ? getContractStates() : null;\n  });\n  return __jsx(Loader, {\n    loaded: state.loaded,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 5\n    }\n  }, __jsx(Flex, {\n    width: \"full\",\n    align: \"center\",\n    justifyContent: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }\n  }, __jsx(Box, {\n    maxW: \"sm\",\n    borderWidth: \"1px\",\n    rounded: \"lg\",\n    overflow: \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 9\n    }\n  }, __jsx(Tabs, {\n    defaultIndex: 0,\n    index: tabIndex,\n    onChange: index => setTabIndex(index),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 11\n    }\n  }, __jsx(TabList, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 13\n    }\n  }, __jsx(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 15\n    }\n  }, \"Create Curated Vault\")), __jsx(TabPanels, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 13\n    }\n  }, __jsx(TabPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 15\n    }\n  }, __jsx(Stack, {\n    direction: \"column\",\n    align: \"center\",\n    spacing: \"2rem\",\n    flexGrow: 1,\n    justifyContent: \"center\",\n    px: \"2rem\",\n    py: \"2rem\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 17\n    }\n  }, __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 208,\n      columnNumber: 19\n    }\n  }, __jsx(FormControl, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 21\n    }\n  }, __jsx(Box, {\n    p: 1,\n    rounded: \"lg\",\n    overflow: \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 23\n    }\n  }, __jsx(Stack, {\n    align: \"center\",\n    p: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 25\n    }\n  }, __jsx(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 27\n    }\n  }), __jsx(FormLabel, {\n    htmlFor: \"project-selector\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 27\n    }\n  }, \"Choose Curated Collection\"), __jsx(Select, {\n    id: \"project-selector\",\n    w: \"100%\",\n    value: targetContract.name,\n    onChange: e => {\n      let contractData = curatedContracts.filter(item => {\n        return item.name == e.target.value;\n      })[0];\n      setTargetContract(contractData);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 27\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 29\n    }\n  }, \"---Choose Project---\"), curatedContracts.map(project => {\n    return __jsx(\"option\", {\n      value: project.name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 33\n      }\n    }, project.name);\n  })), targetContract.name ? __jsx(Select, {\n    id: \"asset-selector\",\n    w: \"100%\",\n    value: targetAsset.name,\n    onChange: e => {\n      setTargetAsset(curatedAssets[targetContract.chain][targetContract.name].filter(item => {\n        return item.name == e.target.value;\n      })[0]);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 31\n    }\n  }, __jsx(\"option\", {\n    value: \"\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 33\n    }\n  }, \"---Choose One---\"), curatedAssets[targetContract.chain][targetContract.name] ? curatedAssets[targetContract.chain][targetContract.name].map(asset => {\n    return __jsx(\"option\", {\n      value: asset.name,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 37\n      }\n    }, asset.name);\n  }) : null) : null, targetAsset.name ? __jsx(Image, {\n    p: \"20px\",\n    h: \"100%\",\n    className: \"d-block w-100\",\n    src: targetAsset.image,\n    width: \"250px\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 35\n    }\n  }) : null)))), __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 19\n    }\n  }, __jsx(ButtonGroup, {\n    spacing: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 259,\n      columnNumber: 21\n    }\n  }, !account ? __jsx(Button, {\n    isDisabled: true,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 25\n    }\n  }, \"No Wallet Connected!\") : __jsx(Button, {\n    onClick: e => {\n      handleSubmit(e);\n    },\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 265,\n      columnNumber: 25\n    }\n  }, \"Create Vault\"))))))))));\n}","map":{"version":3,"sources":["/Users/shannoncode/repo/Emblem.Currentwork/emblem-vault-site/components/CreateCurated.tsx"],"names":["FormControl","FormLabel","Stack","Tabs","TabList","TabPanels","Tab","TabPanel","Box","Flex","Button","ButtonGroup","Divider","useDisclosure","Select","Image","Loader","useWeb3React","useEffect","useState","useRouter","EMBLEM_API","curatedContracts","curatedAssets","tokenId","cipherTextHash","nonce","signature","mintPassword","CreateCurated","props","modalVisible","setModalVisible","modalResult","setModalResult","showEditorButton","setShowEditorButton","isOpen","onToggle","query","tabIndex","setTabIndex","account","chainId","vaultAddress","setVaultAddress","vaultPubPriv","setVaultPubPriv","vaultName","setVaultName","vaultDesc","setVaultDesc","vaultImage","setVaultImage","ownedImage","setOwnedImage","password","setPassword","isCovalApproved","setIsCovalApproved","state","setState","loaded","private","hash","setHash","experimental","setExperimental","showPreVaultMsg","setShowPreVaultMsg","showMakingVaultMsg","setShowMakingVaultMsg","decimals","setDecimals","allowance","setAllowance","balance","setBalance","price","setPrice","creating","setCreating","approving","setApproving","vaultKey","setVaultKey","vaultValue","setVaultValue","showEmbed","setShowEmbed","targetAsset","setTargetAsset","name","image","targetContract","setTargetContract","chain","handleSubmit","evt","preventDefault","body","fromAddress","toAddress","description","values","push","value","console","log","JSON","stringify","apiSuffix","fetch","method","headers","service","then","response","json","data","setTimeout","checkLiveliness","location","href","origin","previewFile","preview","document","querySelector","inputelement","reader","FileReader","files","size","alert","addEventListener","src","result","toString","readAsDataURL","acct","setAcct","getContractStates","index","e","contractData","filter","item","target","map","project","asset"],"mappings":"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","sourcesContent":["import {\n  FormControl,\n  FormLabel,\n  FormHelperText,\n  FormErrorMessage,\n  Input,\n  Stack,\n  Tabs,\n  TabList,\n  TabPanels,\n  Tab,\n  TabPanel,\n  Box,\n  Flex,\n  RadioGroup,\n  Radio,\n  Textarea,\n  Button,\n  ButtonGroup,\n  Text,\n  Divider,\n  Alert,\n  AlertIcon,\n  Collapse,\n  useDisclosure,\n  Select,\n  Image\n} from '@chakra-ui/core'\n\nimport Loader from 'react-loader'\nimport { useWeb3React } from '@web3-react/core'\nimport { useEffect, useState } from 'react'\nimport { useRouter } from 'next/router'\nimport { TransactionToast } from './TransactionToast'\nimport { EMBLEM_API, contractAddresses, curatedContracts, curatedAssets } from '../constants'\nimport { Contract } from '@ethersproject/contracts'\nimport { useContract } from '../hooks'\nimport { isETHAddress } from '../utils'\nimport Embed from './Embed'\n\n\nlet tokenId, cipherTextHash, nonce, signature = null\nlet mintPassword = null\n\nexport default function CreateCurated(props: any) {\n  // modal\n  const [modalVisible, setModalVisible] = useState(false);\n  const [modalResult, setModalResult] = useState('');\n  const [showEditorButton, setShowEditorButton] = useState(true);\n\n  const { isOpen, onToggle } = useDisclosure()\n  const { query } = useRouter()\n  const [tabIndex, setTabIndex] = useState(0)\n  const { account, chainId } = useWeb3React()\n  const [vaultAddress, setVaultAddress] = useState(account || '')\n  const [vaultPubPriv, setVaultPubPriv] = useState('Public')\n  const [vaultName, setVaultName] = useState('')\n  const [vaultDesc, setVaultDesc] = useState('')\n  const [vaultImage, setVaultImage] = useState('')\n  const [ownedImage, setOwnedImage] = useState('')\n  const [password, setPassword] = useState('')\n  // const [service, setService] = useState('')\n  const [isCovalApproved, setIsCovalApproved] = useState(false)\n  const [state, setState] = useState({ loaded: true, private: false })\n  const [hash, setHash] = useState(null)\n  // const [cipherTextHash, setCipherTextHash] = useState(null)\n  // const [tokenId, setTokenId] = useState(null)\n  // const [mintPassword, setMintPassword] = useState(null)\n  // const [nonce, setNonce] = useState(null)\n  // const [signature, setSignature] = useState(null)\n  const [experimental, setExperimental] = useState(true)\n  const [showPreVaultMsg, setShowPreVaultMsg] = useState(false)\n  const [showMakingVaultMsg, setShowMakingVaultMsg] = useState(false)\n  const [decimals, setDecimals] = useState(null)\n  const [allowance, setAllowance] = useState(null)\n  const [balance, setBalance] = useState(null)\n  const [price, setPrice] = useState(null)\n  const [creating, setCreating] = useState(false)\n  const [approving, setApproving] = useState(false)\n  const [vaultKey, setVaultKey] = useState('')  \n  const [vaultValue, setVaultValue] = useState('')\n \n  const [showEmbed, setShowEmbed] = useState(false)\n\n  const [targetAsset, setTargetAsset] = useState({name: '', image: ''})\n  const [targetContract, setTargetContract] = useState({name: '', chain: ''})\n  \n\n  const handleSubmit = (evt: { preventDefault: () => void }) => {\n    evt.preventDefault()\n\n    setState({ loaded: false, private: state.private })\n    let body = {\n      fromAddress: account,\n      toAddress: vaultAddress,\n      description: vaultDesc,\n      name: vaultName,\n      ownedImage: ownedImage,\n      image: vaultImage,\n      chainId: chainId,\n      private: state.private,\n      password: password || '',\n      values: [],\n      experimental: true,\n      targetContract: targetContract,\n      targetAsset: targetAsset\n    }\n    if (vaultKey && vaultValue) {\n      body.values.push({\"key\": vaultKey, value: vaultValue})\n    }\n    console.log(JSON.stringify(body))\n    let apiSuffix = '/mint-curated' //(chainId == 137 || chainId == 1) ? '/mint3' : '/mint'\n    fetch(EMBLEM_API + apiSuffix, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        service: 'evmetadata',\n      },\n      // We convert the React state to JSON and send it as the POST body\n      body: JSON.stringify(body),\n    }).then(async function (response) {\n      setState({ loaded: true, private: state.private })\n      let body = await response.json()\n      tokenId = body.data.tokenId\n      // console.log(body.data.nonce, body.data.signature, body.data.cipherTextHash)\n      // if (chainId === 137 || chainId == 1) {\n        nonce = body.data.nonce\n        signature = body.data.signature\n        cipherTextHash = body.data.cipherTextHash\n        // fireMetaMask()\n        // alert(\"Minting has been disabled temporarily while we work with Opensea to solve a bug where new vaults are not showing. Mint ONLY if you don't plan on using Opensea\")\n        setShowPreVaultMsg(false)\n        setTimeout(() => {\n        checkLiveliness(tokenId, ()=>{\n          location.href = location.origin + '/nft2?id=' + tokenId\n        })\n      }, 500)\n      // } else {\n      //   mintPassword = body.password\n      //   setHash(body.data.tx)\n      //   setShowPreVaultMsg(true)\n      // }\n    })\n  }\n\n  function previewFile() {\n    const preview = document.querySelector('#preview') as HTMLImageElement\n    const inputelement = document.querySelector('input[type=file]') as HTMLInputElement //.files[0];\n    const reader = new FileReader()\n    if (inputelement.files[0].size > 5000000) {\n      delete inputelement.files\n      return alert('File too large')\n    } else {\n      // alert('under')\n    }\n    reader.addEventListener(\n      'load',\n      function () {\n        // convert image file to base64 string\n        if (preview) preview.src = reader.result?.toString() || ''\n        if (preview) setVaultImage(preview.src)\n        setShowEditorButton(true)\n        setModalResult('')\n      },\n      false\n    )\n\n    if (inputelement.files) {\n\n      \n      reader.readAsDataURL(inputelement.files[0])\n    }\n  }\n\n  const [acct, setAcct] = useState('')\n  useEffect(() => {\n    if (account && acct != account) {\n      setAcct(account)\n      setVaultAddress(account)\n    }\n  }, [account, acct])\n\n  useEffect(() => {\n    account && chainId ? getContractStates() : null\n  })\n\n  return (\n    <Loader loaded={state.loaded}>\n      <Flex width=\"full\" align=\"center\" justifyContent=\"center\">\n        <Box maxW=\"sm\" borderWidth=\"1px\" rounded=\"lg\" overflow=\"hidden\">\n          <Tabs defaultIndex={0} index={tabIndex} onChange={(index) => setTabIndex(index)}>\n            <TabList>\n              <Tab>Create Curated Vault</Tab>\n            </TabList>\n\n            <TabPanels>\n              <TabPanel>\n                <Stack\n                  direction=\"column\"\n                  align=\"center\"\n                  spacing=\"2rem\"\n                  flexGrow={1}\n                  justifyContent=\"center\"\n                  px=\"2rem\"\n                  py=\"2rem\"\n                  shouldWrapChildren\n                >\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <FormControl>\n                      \n                      <Box p={1} rounded=\"lg\" overflow=\"hidden\">\n                        <Stack align=\"center\" p={1}>\n                          <Divider />\n                          <FormLabel htmlFor=\"project-selector\">Choose Curated Collection</FormLabel>\n                          <Select id=\"project-selector\" w=\"100%\" value={targetContract.name}\n                            onChange={(e)=>{\n                              let contractData:any = curatedContracts.filter(item=>{return item.name == e.target.value})[0]\n                              setTargetContract(contractData)\n                            }}\n                          >\n                            <option value=\"\" >---Choose Project---</option>\n                            {curatedContracts.map(project=>{\n                              return (\n                                <option value={project.name} >{project.name}</option>\n                              )\n                            })}\n                            \n                          </Select>\n                          {targetContract.name ? (\n                              <Select id=\"asset-selector\" w=\"100%\" value={targetAsset.name}\n                                onChange={(e)=>{\n                                  setTargetAsset(curatedAssets[targetContract.chain][targetContract.name].filter(item=>{return item.name == e.target.value})[0])\n                                }}\n                              >\n                                <option value=\"\" >---Choose One---</option>\n                                {curatedAssets[targetContract.chain][targetContract.name] ? curatedAssets[targetContract.chain][targetContract.name].map(asset=>{\n                                  return (\n                                    <option value={asset.name} >{asset.name}</option>\n                                  )\n                                }): null}\n                                \n                              </Select>\n                            ) : null}\n                            {targetAsset.name? (\n                                  <Image\n                                    p={\"20px\"}\n                                    h={\"100%\"}\n                                    className={\"d-block w-100\"}\n                                    src={targetAsset.image}\n                                    width=\"250px\"\n                                  />\n                                ): null}\n                        </Stack>\n                      </Box>\n                    </FormControl>\n                  </Stack>\n\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <ButtonGroup spacing={4}>\n                      {!account ? (\n                        <Button isDisabled type=\"submit\">\n                          No Wallet Connected!\n                        </Button>\n                      ) : (\n                        <Button onClick={(e)=>{handleSubmit(e)}} type=\"submit\">\n                          Create Vault\n                        </Button>\n                      )}\n                    </ButtonGroup>\n                  </Stack>\n\n                </Stack>\n              </TabPanel>\n            </TabPanels>\n          </Tabs>\n        </Box>\n      </Flex>\n    </Loader>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}