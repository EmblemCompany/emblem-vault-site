{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/Users/shannoncode/repo/Emblem.Currentwork/emblem-vault-site/components/Create.tsx\",\n    _s = $RefreshSig$();\n\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { FormControl, FormLabel, FormHelperText, FormErrorMessage, Input, Stack, Tabs, TabList, TabPanels, Tab, TabPanel, Box, Flex, RadioGroup, Radio, Textarea, Button, ButtonGroup, Text, Divider, Alert, AlertIcon } from '@chakra-ui/core';\nimport Loader from 'react-loader';\nimport { useWeb3React } from '@web3-react/core';\nimport { useEffect, useState } from 'react';\nimport { TransactionToast } from './TransactionToast';\nimport { EMBLEM_API, contractAddresses } from '../constants';\nimport { useContract } from '../hooks';\nimport { isETHAddress } from '../utils';\nvar tokenId = null;\nvar mintPassword = null;\nexport default function Create(props) {\n  _s();\n\n  var _useState = useState(0),\n      tabIndex = _useState[0],\n      setTabIndex = _useState[1];\n\n  var _useWeb3React = useWeb3React(),\n      account = _useWeb3React.account,\n      chainId = _useWeb3React.chainId;\n\n  var _useState2 = useState(account || ''),\n      vaultAddress = _useState2[0],\n      setVaultAddress = _useState2[1];\n\n  var _useState3 = useState('Public'),\n      vaultPubPriv = _useState3[0],\n      setVaultPubPriv = _useState3[1];\n\n  var _useState4 = useState(''),\n      vaultName = _useState4[0],\n      setVaultName = _useState4[1];\n\n  var _useState5 = useState(''),\n      vaultDesc = _useState5[0],\n      setVaultDesc = _useState5[1];\n\n  var _useState6 = useState(''),\n      vaultImage = _useState6[0],\n      setVaultImage = _useState6[1];\n\n  var _useState7 = useState(''),\n      password = _useState7[0],\n      setPassword = _useState7[1];\n\n  var _useState8 = useState(''),\n      service = _useState8[0],\n      setService = _useState8[1];\n\n  var _useState9 = useState(false),\n      isCovalApproved = _useState9[0],\n      setIsCovalApproved = _useState9[1];\n\n  var _useState10 = useState({\n    loaded: true,\n    \"private\": false\n  }),\n      state = _useState10[0],\n      setState = _useState10[1];\n\n  var _useState11 = useState(null),\n      hash = _useState11[0],\n      setHash = _useState11[1]; // const [tokenId, setTokenId] = useState(null)\n  // const [mintPassword, setMintPassword] = useState(null)\n\n\n  var _useState12 = useState(false),\n      showPreVaultMsg = _useState12[0],\n      setShowPreVaultMsg = _useState12[1];\n\n  var _useState13 = useState(false),\n      showMakingVaultMsg = _useState13[0],\n      setShowMakingVaultMsg = _useState13[1];\n\n  var _useState14 = useState(null),\n      decimals = _useState14[0],\n      setDecimals = _useState14[1];\n\n  var _useState15 = useState(null),\n      allowance = _useState15[0],\n      setAllowance = _useState15[1];\n\n  var _useState16 = useState(null),\n      balance = _useState16[0],\n      setBalance = _useState16[1];\n\n  var _useState17 = useState(null),\n      price = _useState17[0],\n      setPrice = _useState17[1];\n\n  var _useState18 = useState(false),\n      creating = _useState18[0],\n      setCreating = _useState18[1];\n\n  var handlerContract = useContract(contractAddresses.vaultHandler[chainId], contractAddresses.vaultHandlerAbi, true);\n  var covalContract = useContract(contractAddresses.coval[chainId], contractAddresses.covalAbi, true);\n\n  var getContractStates = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.t0 = setDecimals;\n              _context.next = 3;\n              return covalContract.decimals();\n\n            case 3:\n              _context.t1 = _context.sent;\n              (0, _context.t0)(_context.t1);\n              _context.t2 = setAllowance;\n              _context.next = 8;\n              return covalContract.allowance(account, contractAddresses.vaultHandler[chainId]).then(function (balance) {\n                return balance.toString();\n              });\n\n            case 8:\n              _context.t3 = _context.sent;\n              (0, _context.t2)(_context.t3);\n              _context.t4 = setBalance;\n              _context.next = 13;\n              return covalContract.balanceOf(account).then(function (balance) {\n                return balance.toString();\n              });\n\n            case 13:\n              _context.t5 = _context.sent;\n              (0, _context.t4)(_context.t5);\n              _context.t6 = setPrice;\n              _context.next = 18;\n              return handlerContract.price().then(function (balance) {\n                return balance.toString();\n              });\n\n            case 18:\n              _context.t7 = _context.sent;\n              (0, _context.t6)(_context.t7);\n\n              // console.log(\n              //   'balance',\n              //   balance,\n              //   'allowance',\n              //   allowance,\n              //   'price',\n              //   price,\n              //   Number(allowance) >= Number(price),\n              //   Number(balance) > Number(price)\n              // )\n              if (Number(allowance) >= Number(price)) {\n                setIsCovalApproved(true);\n              } else {\n                setIsCovalApproved(false);\n              }\n\n            case 21:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getContractStates() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var fireMetaMask = function fireMetaMask() {\n    setCreating(true);\n    handlerContract.buyWithPaymentOnly(vaultAddress, tokenId, mintPassword).then(function (_ref2) {\n      var hash = _ref2.hash;\n      setTimeout(function () {\n        setHash(hash);\n        setShowMakingVaultMsg(true);\n      }, 100); // Solving State race condition where transaction watcher wouldn't notice we were creating\n    })[\"catch\"](function (error) {\n      if ((error === null || error === void 0 ? void 0 : error.code) !== 4001) {\n        console.log(\"tx failed.\", error);\n      } else {\n        setCreating(false);\n        setShowPreVaultMsg(false);\n      }\n    });\n  };\n\n  var approveCovalFlow = function approveCovalFlow() {\n    ;\n    covalContract.approve(contractAddresses.vaultHandler[chainId], '100000000000000').then(function (_ref3) {\n      var hash = _ref3.hash;\n      setHash(hash);\n    });\n  };\n\n  var handleSubmit = function handleSubmit(evt) {\n    evt.preventDefault();\n\n    if (service !== 'kms') {\n      return alert('incorrect password');\n    }\n\n    setState({\n      loaded: false,\n      \"private\": state[\"private\"]\n    });\n    fetch(EMBLEM_API + '/mint', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        service: 'evmetadata'\n      },\n      // We convert the React state to JSON and send it as the POST body\n      body: JSON.stringify({\n        fromAddress: account,\n        toAddress: vaultAddress,\n        description: vaultDesc,\n        name: vaultName,\n        image: vaultImage,\n        chainId: chainId,\n        \"private\": state[\"private\"],\n        password: password || ''\n      })\n    }).then( /*#__PURE__*/function () {\n      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response) {\n        var body;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                setState({\n                  loaded: true,\n                  \"private\": state[\"private\"]\n                });\n                _context2.next = 3;\n                return response.json();\n\n              case 3:\n                body = _context2.sent;\n                tokenId = body.data.tokenId;\n                mintPassword = body.password;\n                setHash(body.data.tx);\n                setShowPreVaultMsg(true);\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n\n      return function (_x) {\n        return _ref4.apply(this, arguments);\n      };\n    }());\n  };\n\n  function previewFile() {\n    var preview = document.querySelector('#preview');\n    var inputelement = document.querySelector('input[type=file]'); //.files[0];\n\n    var reader = new FileReader();\n    reader.addEventListener('load', function () {\n      var _reader$result;\n\n      // convert image file to base64 string\n      if (preview) preview.src = ((_reader$result = reader.result) === null || _reader$result === void 0 ? void 0 : _reader$result.toString()) || '';\n      if (preview) setVaultImage(preview.src);\n    }, false);\n\n    if (inputelement.files) {\n      reader.readAsDataURL(inputelement.files[0]);\n    }\n  }\n\n  var _useState19 = useState(''),\n      acct = _useState19[0],\n      setAcct = _useState19[1];\n\n  useEffect(function () {\n    if (account && acct != account) {\n      setAcct(account);\n      setVaultAddress(account);\n    }\n  }, [account, acct]);\n  useEffect(function () {\n    account && chainId ? getContractStates() : null;\n  });\n  return __jsx(Loader, {\n    loaded: state.loaded,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 5\n    }\n  }, __jsx(Flex, {\n    width: \"full\",\n    align: \"center\",\n    justifyContent: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 7\n    }\n  }, __jsx(Box, {\n    maxW: \"sm\",\n    borderWidth: \"1px\",\n    rounded: \"lg\",\n    overflow: \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 9\n    }\n  }, __jsx(Tabs, {\n    defaultIndex: 0,\n    index: tabIndex,\n    onChange: function onChange(index) {\n      return setTabIndex(index);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 11\n    }\n  }, __jsx(TabList, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 13\n    }\n  }, __jsx(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 15\n    }\n  }, \"Make\"), __jsx(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 15\n    }\n  }, \"My\"), __jsx(Tab, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 15\n    }\n  }, \"Vault\")), __jsx(TabPanels, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 13\n    }\n  }, __jsx(TabPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 15\n    }\n  }, __jsx(Stack, {\n    direction: \"column\",\n    align: \"center\",\n    spacing: \"2rem\",\n    flexGrow: 1,\n    justifyContent: \"center\",\n    px: \"2rem\",\n    py: \"2rem\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 17\n    }\n  }, __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 19\n    }\n  }, __jsx(FormControl, {\n    isRequired: true,\n    isInvalid: vaultAddress && !isETHAddress(vaultAddress),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 21\n    }\n  }, __jsx(FormLabel, {\n    htmlFor: \"owner-address\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 23\n    }\n  }, \"Vault Owner Address\"), __jsx(Input, {\n    type: \"text\",\n    id: \"owner-address\",\n    \"aria-describedby\": \"owner-helper-text\",\n    placeholder: \"0xdeadbeef\",\n    maxLength: 42,\n    value: vaultAddress,\n    onChange: function onChange(e) {\n      return setVaultAddress(e.target.value);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 23\n    }\n  }), __jsx(FormHelperText, {\n    id: \"owner-helper-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 23\n    }\n  }, \"What is the address of the first owner of this vault? Pro tip: When you connect a web3 wallet, this will populate automagically with your address.\"), __jsx(FormErrorMessage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 23\n    }\n  }, \"Address is not a valid ETH address\"))), __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 19\n    }\n  }, __jsx(FormControl, {\n    as: \"fieldset\",\n    isRequired: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 233,\n      columnNumber: 21\n    }\n  }, __jsx(FormLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 23\n    }\n  }, \"Public or Private?\"), __jsx(RadioGroup, {\n    id: \"pubpriv\",\n    defaultValue: \"Public\",\n    onChange: function onChange(e) {\n      setVaultPubPriv(e.target.value);\n      setState({\n        loaded: state.loaded,\n        \"private\": e.target.value === 'Private'\n      });\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 23\n    }\n  }, __jsx(Radio, {\n    value: \"Public\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 25\n    }\n  }, \"Public\"), __jsx(Radio, {\n    value: \"Private\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 244,\n      columnNumber: 25\n    }\n  }, \"Private\")), __jsx(FormHelperText, {\n    id: \"email-helper-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 23\n    }\n  }, \"Do you want the contents and addresses to be password protected?\")), state[\"private\"] ? __jsx(FormControl, {\n    isRequired: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 23\n    }\n  }, __jsx(FormLabel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 252,\n      columnNumber: 25\n    }\n  }, \"Password\"), __jsx(Input, {\n    type: \"password\",\n    id: \"vault-password\",\n    onChange: function onChange(e) {\n      return setPassword(e.target.value);\n    },\n    \"aria-describedby\": \"password-helper-text\",\n    autoComplete: \"off\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 25\n    }\n  }), __jsx(FormHelperText, {\n    id: \"password-helper-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 25\n    }\n  }, \"Used to encrypt/decrypt\")) : ''), __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 266,\n      columnNumber: 19\n    }\n  }, __jsx(Button, {\n    onClick: function onClick() {\n      return setTabIndex(1);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 267,\n      columnNumber: 21\n    }\n  }, \"Next\")))), __jsx(TabPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 15\n    }\n  }, __jsx(Stack, {\n    direction: \"column\",\n    align: \"center\",\n    spacing: \"2rem\",\n    flexGrow: 1,\n    justifyContent: \"center\",\n    px: \"2rem\",\n    py: \"2rem\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 273,\n      columnNumber: 17\n    }\n  }, __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 283,\n      columnNumber: 19\n    }\n  }, __jsx(FormControl, {\n    isRequired: true,\n    isInvalid: vaultName && vaultName.length < 3 && vaultName.length > 200,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 21\n    }\n  }, __jsx(FormLabel, {\n    htmlFor: \"vault-name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 23\n    }\n  }, \"Vault Name\"), __jsx(Input, {\n    type: \"text\",\n    id: \"vault-name\",\n    \"aria-describedby\": \"vault-name-text\",\n    minLength: 3,\n    maxLength: 200,\n    value: vaultName,\n    onChange: function onChange(e) {\n      return setVaultName(e.target.value);\n    },\n    autoComplete: \"off\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 23\n    }\n  }), __jsx(FormHelperText, {\n    id: \"vault-name-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 23\n    }\n  }, \"Give it some love so you can find it later.\"), __jsx(FormErrorMessage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 23\n    }\n  }, \"Name needs at least 3 characters. 200 is max.\"))), __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 19\n    }\n  }, __jsx(FormControl, {\n    isRequired: true,\n    isInvalid: vaultDesc && vaultDesc.length < 3 && vaultDesc.length > 1024,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 21\n    }\n  }, __jsx(FormLabel, {\n    htmlFor: \"vault-desc\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 302,\n      columnNumber: 23\n    }\n  }, \"Vault Description\"), __jsx(Textarea, {\n    id: \"vault-desc\",\n    size: \"lg\",\n    \"aria-describedby\": \"vault-desc-text\",\n    minLength: 3,\n    maxLength: 1024,\n    value: vaultDesc,\n    onChange: function onChange(e) {\n      return setVaultDesc(e.target.value);\n    },\n    autoComplete: \"off\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 23\n    }\n  }), __jsx(FormHelperText, {\n    id: \"vault-desc-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 23\n    }\n  }, \"Add some fluffy text to tell people what the point is!\"), __jsx(FormErrorMessage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 316,\n      columnNumber: 23\n    }\n  }, \"Description needs to be at least 3 characters. 1024 is max.\"))), __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 319,\n      columnNumber: 19\n    }\n  }, __jsx(ButtonGroup, {\n    spacing: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 320,\n      columnNumber: 21\n    }\n  }, __jsx(Button, {\n    onClick: function onClick() {\n      return setTabIndex(0);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 321,\n      columnNumber: 23\n    }\n  }, \"Back\"), __jsx(Button, {\n    onClick: function onClick() {\n      return setTabIndex(2);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 23\n    }\n  }, \"Next\"))))), __jsx(TabPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 15\n    }\n  }, __jsx(Stack, {\n    direction: \"column\",\n    align: \"center\",\n    spacing: \"2rem\",\n    flexGrow: 1,\n    justifyContent: \"center\",\n    px: \"2rem\",\n    py: \"2rem\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 17\n    }\n  }, __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 339,\n      columnNumber: 19\n    }\n  }, __jsx(FormControl, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 21\n    }\n  }, __jsx(FormLabel, {\n    htmlFor: \"vault-img\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 23\n    }\n  }, \"Vault Image\"), __jsx(Box, {\n    p: 1,\n    rounded: \"lg\",\n    overflow: \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 342,\n      columnNumber: 23\n    }\n  }, __jsx(Stack, {\n    align: \"center\",\n    p: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 343,\n      columnNumber: 25\n    }\n  }, __jsx(\"input\", {\n    type: \"file\",\n    onChange: function onChange() {\n      return previewFile();\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 344,\n      columnNumber: 27\n    }\n  }), __jsx(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 27\n    }\n  }), __jsx(\"img\", {\n    id: \"preview\",\n    src: \"\",\n    width: \"250\",\n    \"margin-top\": \"6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 346,\n      columnNumber: 27\n    }\n  }))))), __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 19\n    }\n  }, __jsx(FormControl, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 21\n    }\n  }, __jsx(FormLabel, {\n    htmlFor: \"service\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 23\n    }\n  }, \"API password:\"), __jsx(Input, {\n    type: \"password\",\n    id: \"service\",\n    \"aria-describedby\": \"service\",\n    onChange: function onChange(e) {\n      return setService(e.target.value);\n    },\n    autoComplete: \"off\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 355,\n      columnNumber: 23\n    }\n  }))), isCovalApproved ? __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 366,\n      columnNumber: 21\n    }\n  }, __jsx(Box, {\n    maxW: \"sm\",\n    borderWidth: \"1px\",\n    p: 1,\n    rounded: \"lg\",\n    overflow: \"hidden\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 367,\n      columnNumber: 23\n    }\n  }, __jsx(Text, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 368,\n      columnNumber: 25\n    }\n  }, \"Creating a vault spends \", price * Math.pow(10, -decimals), \" Coval from your wallet\"))) : null, Number(balance) < Number(price) ? __jsx(Box, {\n    d: \"flex\",\n    alignItems: \"baseline\",\n    justifyContent: \"space-between\",\n    mt: \"2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 374,\n      columnNumber: 21\n    }\n  }, __jsx(Button, _extends({\n    width: \"100%\",\n    as: \"a\"\n  }, {\n    href: location.origin + '/buy?chain=' + chainId + '&output=0x3D658390460295FB963f54dC0899cfb1c30776Df&input=0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2',\n    target: '_blank',\n    rel: 'noopener noreferrer'\n  }, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 23\n    }\n  }), \"Buy coval\")) : null, __jsx(Stack, {\n    direction: \"row\",\n    align: \"flex-start\",\n    spacing: \"0rem\",\n    flexWrap: \"wrap\",\n    shouldWrapChildren: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 393,\n      columnNumber: 19\n    }\n  }, __jsx(ButtonGroup, {\n    spacing: 4,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 394,\n      columnNumber: 21\n    }\n  }, __jsx(Button, {\n    onClick: function onClick() {\n      return setTabIndex(1);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 395,\n      columnNumber: 23\n    }\n  }, \"Back\"), !account ? __jsx(Button, {\n    isDisabled: true,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 25\n    }\n  }, \"No Wallet Connected!\") : !vaultAddress || !isETHAddress(vaultAddress) || !vaultName || vaultName.length < 3 || !vaultDesc || vaultDesc.length < 3 ? __jsx(Button, {\n    isDisabled: true,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 406,\n      columnNumber: 25\n    }\n  }, \"Check Fields!\") : !service ? __jsx(Button, {\n    isDisabled: true,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 25\n    }\n  }, \"Creation Password?\") : !isCovalApproved ? __jsx(Button, {\n    onClick: approveCovalFlow,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 25\n    }\n  }, \"Approve Coval\") : Number(balance) < Number(price) ? __jsx(Button, {\n    isDisabled: true,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 25\n    }\n  }, \"Insufficient Balance\") : hash || creating || showPreVaultMsg || showMakingVaultMsg ? __jsx(Button, {\n    isDisabled: true,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 422,\n      columnNumber: 25\n    }\n  }, \"Making Vault ...\") : __jsx(Button, {\n    onClick: handleSubmit,\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 426,\n      columnNumber: 25\n    }\n  }, \"DO IT!\")))), showPreVaultMsg ? __jsx(Alert, {\n    status: \"info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 19\n    }\n  }, __jsx(AlertIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 435,\n      columnNumber: 21\n    }\n  }), \"Talking to contract ...\") : null, showMakingVaultMsg ? __jsx(Alert, {\n    status: \"info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 440,\n      columnNumber: 19\n    }\n  }, __jsx(AlertIcon, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 441,\n      columnNumber: 21\n    }\n  }), \"Making vault ... one moment\") : null))))), hash ? __jsx(TransactionToast, {\n    hash: hash,\n    onComplete: function onComplete() {\n      setHash(null);\n\n      if (!creating) {\n        fireMetaMask();\n        setShowPreVaultMsg(false);\n      } else {\n        setShowMakingVaultMsg(false);\n        location.href = location.origin + '/vault?id=' + tokenId;\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 451,\n      columnNumber: 9\n    }\n  }) : null);\n}\n\n_s(Create, \"n/2rXAKu3eItf0+12FHPBbOvwxU=\", false, function () {\n  return [useWeb3React, useContract, useContract];\n});\n\n_c = Create;\n\nvar _c;\n\n$RefreshReg$(_c, \"Create\");","map":{"version":3,"sources":["/Users/shannoncode/repo/Emblem.Currentwork/emblem-vault-site/components/Create.tsx"],"names":["FormControl","FormLabel","FormHelperText","FormErrorMessage","Input","Stack","Tabs","TabList","TabPanels","Tab","TabPanel","Box","Flex","RadioGroup","Radio","Textarea","Button","ButtonGroup","Text","Divider","Alert","AlertIcon","Loader","useWeb3React","useEffect","useState","TransactionToast","EMBLEM_API","contractAddresses","useContract","isETHAddress","tokenId","mintPassword","Create","props","tabIndex","setTabIndex","account","chainId","vaultAddress","setVaultAddress","vaultPubPriv","setVaultPubPriv","vaultName","setVaultName","vaultDesc","setVaultDesc","vaultImage","setVaultImage","password","setPassword","service","setService","isCovalApproved","setIsCovalApproved","loaded","state","setState","hash","setHash","showPreVaultMsg","setShowPreVaultMsg","showMakingVaultMsg","setShowMakingVaultMsg","decimals","setDecimals","allowance","setAllowance","balance","setBalance","price","setPrice","creating","setCreating","handlerContract","vaultHandler","vaultHandlerAbi","covalContract","coval","covalAbi","getContractStates","then","toString","balanceOf","Number","fireMetaMask","buyWithPaymentOnly","setTimeout","error","code","console","log","approveCovalFlow","approve","handleSubmit","evt","preventDefault","alert","fetch","method","headers","body","JSON","stringify","fromAddress","toAddress","description","name","image","response","json","data","tx","previewFile","preview","document","querySelector","inputelement","reader","FileReader","addEventListener","src","result","files","readAsDataURL","acct","setAcct","index","e","target","value","length","Math","pow","href","location","origin","rel"],"mappings":"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","sourcesContent":["import {\n  FormControl,\n  FormLabel,\n  FormHelperText,\n  FormErrorMessage,\n  Input,\n  Stack,\n  Tabs,\n  TabList,\n  TabPanels,\n  Tab,\n  TabPanel,\n  Box,\n  Flex,\n  RadioGroup,\n  Radio,\n  Textarea,\n  Button,\n  ButtonGroup,\n  Text,\n  Divider,\n  Alert,\n  AlertIcon,\n} from '@chakra-ui/core'\n\nimport Loader from 'react-loader'\nimport { useWeb3React } from '@web3-react/core'\nimport { useEffect, useState } from 'react'\nimport { TransactionToast } from './TransactionToast'\nimport { EMBLEM_API, contractAddresses } from '../constants'\nimport { Notify } from './Notify'\nimport { Contract } from '@ethersproject/contracts'\nimport { useContract } from '../hooks'\nimport { isETHAddress } from '../utils'\n\nlet tokenId = null\nlet mintPassword = null\n\nexport default function Create(props: any) {\n  const [tabIndex, setTabIndex] = useState(0)\n  const { account, chainId } = useWeb3React()\n\n  const [vaultAddress, setVaultAddress] = useState(account || '')\n  const [vaultPubPriv, setVaultPubPriv] = useState('Public')\n  const [vaultName, setVaultName] = useState('')\n  const [vaultDesc, setVaultDesc] = useState('')\n  const [vaultImage, setVaultImage] = useState('')\n  const [password, setPassword] = useState('')\n  const [service, setService] = useState('')\n  const [isCovalApproved, setIsCovalApproved] = useState(false)\n  const [state, setState] = useState({ loaded: true, private: false })\n  const [hash, setHash] = useState(null)\n  // const [tokenId, setTokenId] = useState(null)\n  // const [mintPassword, setMintPassword] = useState(null)\n  const [showPreVaultMsg, setShowPreVaultMsg] = useState(false)\n  const [showMakingVaultMsg, setShowMakingVaultMsg] = useState(false)\n  const [decimals, setDecimals] = useState(null)\n  const [allowance, setAllowance] = useState(null)\n  const [balance, setBalance] = useState(null)\n  const [price, setPrice] = useState(null)\n  const [creating, setCreating] = useState(false)\n\n  const handlerContract = useContract(contractAddresses.vaultHandler[chainId], contractAddresses.vaultHandlerAbi, true)\n  const covalContract = useContract(contractAddresses.coval[chainId], contractAddresses.covalAbi, true)\n\n  interface ErrorWithCode extends Error {\n    code?: number\n  }\n\n  const getContractStates = async () => {\n    setDecimals(await covalContract.decimals())\n    setAllowance(\n      await covalContract\n        .allowance(account, contractAddresses.vaultHandler[chainId])\n        .then((balance: { toString: () => string }) => balance.toString())\n    )\n    setBalance(await covalContract.balanceOf(account).then((balance: { toString: () => string }) => balance.toString()))\n    setPrice(await handlerContract.price().then((balance: { toString: () => string }) => balance.toString()))\n    // console.log(\n    //   'balance',\n    //   balance,\n    //   'allowance',\n    //   allowance,\n    //   'price',\n    //   price,\n    //   Number(allowance) >= Number(price),\n    //   Number(balance) > Number(price)\n    // )\n    if (Number(allowance) >= Number(price)) {\n      setIsCovalApproved(true)\n    } else {\n      setIsCovalApproved(false)\n    }\n  }\n\n  const fireMetaMask = () => {\n    setCreating(true)\n    ;(handlerContract as Contract)\n      .buyWithPaymentOnly(vaultAddress, tokenId, mintPassword)\n      .then(({ hash }: { hash: string }) => {\n        setTimeout(() => {\n          setHash(hash)\n          setShowMakingVaultMsg(true)\n        }, 100) // Solving State race condition where transaction watcher wouldn't notice we were creating\n      })\n      .catch((error: ErrorWithCode) => {\n        if (error?.code !== 4001) {\n          console.log(`tx failed.`, error)\n        } else {\n          setCreating(false)\n          setShowPreVaultMsg(false)\n        }\n      })\n  }\n\n  const approveCovalFlow = () => {\n    ;(covalContract as Contract)\n      .approve(contractAddresses.vaultHandler[chainId], '100000000000000')\n      .then(({ hash }: { hash: string }) => {\n        setHash(hash)\n      })\n  }\n\n  const handleSubmit = (evt: { preventDefault: () => void }) => {\n    evt.preventDefault()\n    if (service !== 'kms') {\n      return alert('incorrect password')\n    }\n    setState({ loaded: false, private: state.private })\n    fetch(EMBLEM_API + '/mint', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        service: 'evmetadata',\n      },\n      // We convert the React state to JSON and send it as the POST body\n      body: JSON.stringify({\n        fromAddress: account,\n        toAddress: vaultAddress,\n        description: vaultDesc,\n        name: vaultName,\n        image: vaultImage,\n        chainId: chainId,\n        private: state.private,\n        password: password || '',\n      }),\n    }).then(async function (response) {\n      setState({ loaded: true, private: state.private })\n      let body = await response.json()\n      tokenId = body.data.tokenId\n      mintPassword = body.password\n      setHash(body.data.tx)\n      setShowPreVaultMsg(true)\n    })\n  }\n\n  function previewFile() {\n    const preview = document.querySelector('#preview') as HTMLImageElement\n    const inputelement = document.querySelector('input[type=file]') as HTMLInputElement //.files[0];\n    const reader = new FileReader()\n\n    reader.addEventListener(\n      'load',\n      function () {\n        // convert image file to base64 string\n        if (preview) preview.src = reader.result?.toString() || ''\n        if (preview) setVaultImage(preview.src)\n      },\n      false\n    )\n\n    if (inputelement.files) {\n      reader.readAsDataURL(inputelement.files[0])\n    }\n  }\n\n  const [acct, setAcct] = useState('')\n  useEffect(() => {\n    if (account && acct != account) {\n      setAcct(account)\n      setVaultAddress(account)\n    }\n  }, [account, acct])\n\n  useEffect(() => {\n    account && chainId ? getContractStates() : null\n  })\n\n  return (\n    <Loader loaded={state.loaded}>\n      <Flex width=\"full\" align=\"center\" justifyContent=\"center\">\n        <Box maxW=\"sm\" borderWidth=\"1px\" rounded=\"lg\" overflow=\"hidden\">\n          <Tabs defaultIndex={0} index={tabIndex} onChange={(index) => setTabIndex(index)}>\n            <TabList>\n              <Tab>Make</Tab>\n              <Tab>My</Tab>\n              <Tab>Vault</Tab>\n            </TabList>\n\n            <TabPanels>\n              <TabPanel>\n                <Stack\n                  direction=\"column\"\n                  align=\"center\"\n                  spacing=\"2rem\"\n                  flexGrow={1}\n                  justifyContent=\"center\"\n                  px=\"2rem\"\n                  py=\"2rem\"\n                  shouldWrapChildren\n                >\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <FormControl isRequired isInvalid={vaultAddress && !isETHAddress(vaultAddress)}>\n                      <FormLabel htmlFor=\"owner-address\">Vault Owner Address</FormLabel>\n                      <Input\n                        type=\"text\"\n                        id=\"owner-address\"\n                        aria-describedby=\"owner-helper-text\"\n                        placeholder=\"0xdeadbeef\"\n                        maxLength={42}\n                        value={vaultAddress}\n                        onChange={(e) => setVaultAddress(e.target.value)}\n                      />\n                      <FormHelperText id=\"owner-helper-text\">\n                        What is the address of the first owner of this vault? Pro tip: When you connect a web3 wallet,\n                        this will populate automagically with your address.\n                      </FormHelperText>\n                      <FormErrorMessage>Address is not a valid ETH address</FormErrorMessage>\n                    </FormControl>\n                  </Stack>\n\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <FormControl as=\"fieldset\" isRequired>\n                      <FormLabel>Public or Private?</FormLabel>\n                      <RadioGroup\n                        id=\"pubpriv\"\n                        defaultValue=\"Public\"\n                        onChange={(e) => {\n                          setVaultPubPriv(e.target.value)\n                          setState({ loaded: state.loaded, private: e.target.value === 'Private' })\n                        }}\n                      >\n                        <Radio value=\"Public\">Public</Radio>\n                        <Radio value=\"Private\">Private</Radio>\n                      </RadioGroup>\n                      <FormHelperText id=\"email-helper-text\">\n                        Do you want the contents and addresses to be password protected?\n                      </FormHelperText>\n                    </FormControl>\n                    {state.private ? (\n                      <FormControl isRequired>\n                        <FormLabel>Password</FormLabel>\n                        <Input\n                          type=\"password\"\n                          id=\"vault-password\"\n                          onChange={(e) => setPassword(e.target.value)}\n                          aria-describedby=\"password-helper-text\"\n                          autoComplete=\"off\"\n                        />\n                        <FormHelperText id=\"password-helper-text\">Used to encrypt/decrypt</FormHelperText>\n                      </FormControl>\n                    ) : (\n                      ''\n                    )}\n                  </Stack>\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <Button onClick={() => setTabIndex(1)}>Next</Button>\n                  </Stack>\n                </Stack>\n              </TabPanel>\n\n              <TabPanel>\n                <Stack\n                  direction=\"column\"\n                  align=\"center\"\n                  spacing=\"2rem\"\n                  flexGrow={1}\n                  justifyContent=\"center\"\n                  px=\"2rem\"\n                  py=\"2rem\"\n                  shouldWrapChildren\n                >\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <FormControl isRequired isInvalid={vaultName && vaultName.length < 3 && vaultName.length > 200}>\n                      <FormLabel htmlFor=\"vault-name\">Vault Name</FormLabel>\n                      <Input\n                        type=\"text\"\n                        id=\"vault-name\"\n                        aria-describedby=\"vault-name-text\"\n                        minLength={3}\n                        maxLength={200}\n                        value={vaultName}\n                        onChange={(e) => setVaultName(e.target.value)}\n                        autoComplete=\"off\"\n                      />\n                      <FormHelperText id=\"vault-name-text\">Give it some love so you can find it later.</FormHelperText>\n                      <FormErrorMessage>Name needs at least 3 characters. 200 is max.</FormErrorMessage>\n                    </FormControl>\n                  </Stack>\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <FormControl isRequired isInvalid={vaultDesc && vaultDesc.length < 3 && vaultDesc.length > 1024}>\n                      <FormLabel htmlFor=\"vault-desc\">Vault Description</FormLabel>\n                      <Textarea\n                        id=\"vault-desc\"\n                        size=\"lg\"\n                        aria-describedby=\"vault-desc-text\"\n                        minLength={3}\n                        maxLength={1024}\n                        value={vaultDesc}\n                        onChange={(e) => setVaultDesc(e.target.value)}\n                        autoComplete=\"off\"\n                      />\n                      <FormHelperText id=\"vault-desc-text\">\n                        Add some fluffy text to tell people what the point is!\n                      </FormHelperText>\n                      <FormErrorMessage>Description needs to be at least 3 characters. 1024 is max.</FormErrorMessage>\n                    </FormControl>\n                  </Stack>\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <ButtonGroup spacing={4}>\n                      <Button onClick={() => setTabIndex(0)}>Back</Button>\n                      <Button onClick={() => setTabIndex(2)}>Next</Button>\n                    </ButtonGroup>\n                  </Stack>\n                </Stack>\n              </TabPanel>\n\n              <TabPanel>\n                <Stack\n                  direction=\"column\"\n                  align=\"center\"\n                  spacing=\"2rem\"\n                  flexGrow={1}\n                  justifyContent=\"center\"\n                  px=\"2rem\"\n                  py=\"2rem\"\n                  shouldWrapChildren\n                >\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <FormControl>\n                      <FormLabel htmlFor=\"vault-img\">Vault Image</FormLabel>\n                      <Box p={1} rounded=\"lg\" overflow=\"hidden\">\n                        <Stack align=\"center\" p={1}>\n                          <input type=\"file\" onChange={() => previewFile()} />\n                          <Divider />\n                          <img id=\"preview\" src=\"\" width=\"250\" margin-top=\"6\"></img>\n                        </Stack>\n                      </Box>\n                    </FormControl>\n                  </Stack>\n\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <FormControl>\n                      <FormLabel htmlFor=\"service\">API password:</FormLabel>\n                      <Input\n                        type=\"password\"\n                        id=\"service\"\n                        aria-describedby=\"service\"\n                        onChange={(e) => setService(e.target.value)}\n                        autoComplete=\"off\"\n                      />\n                    </FormControl>\n                  </Stack>\n\n                  {isCovalApproved ? (\n                    <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                      <Box maxW=\"sm\" borderWidth=\"1px\" p={1} rounded=\"lg\" overflow=\"hidden\">\n                        <Text>Creating a vault spends {price * Math.pow(10, -decimals)} Coval from your wallet</Text>\n                      </Box>\n                    </Stack>\n                  ) : null}\n\n                  {Number(balance) < Number(price) ? (\n                    <Box d=\"flex\" alignItems=\"baseline\" justifyContent=\"space-between\" mt=\"2\">\n                      <Button\n                        width=\"100%\"\n                        as=\"a\"\n                        {...{\n                          href:\n                            location.origin +\n                            '/buy?chain=' +\n                            chainId +\n                            '&output=0x3D658390460295FB963f54dC0899cfb1c30776Df&input=0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2',\n                          target: '_blank',\n                          rel: 'noopener noreferrer',\n                        }}\n                      >\n                        Buy coval\n                      </Button>\n                    </Box>\n                  ) : null}\n\n                  <Stack direction=\"row\" align=\"flex-start\" spacing=\"0rem\" flexWrap=\"wrap\" shouldWrapChildren>\n                    <ButtonGroup spacing={4}>\n                      <Button onClick={() => setTabIndex(1)}>Back</Button>\n                      {!account ? (\n                        <Button isDisabled type=\"submit\">\n                          No Wallet Connected!\n                        </Button>\n                      ) : !vaultAddress ||\n                        !isETHAddress(vaultAddress) ||\n                        !vaultName ||\n                        vaultName.length < 3 ||\n                        !vaultDesc ||\n                        vaultDesc.length < 3 ? (\n                        <Button isDisabled type=\"submit\">\n                          Check Fields!\n                        </Button>\n                      ) : !service ? (\n                        <Button isDisabled type=\"submit\">\n                          Creation Password?\n                        </Button>\n                      ) : !isCovalApproved ? (\n                        <Button onClick={approveCovalFlow} type=\"submit\">\n                          Approve Coval\n                        </Button>\n                      ) : Number(balance) < Number(price) ? (\n                        <Button isDisabled type=\"submit\">\n                          Insufficient Balance\n                        </Button>\n                      ) : hash || creating || showPreVaultMsg || showMakingVaultMsg ? (\n                        <Button isDisabled type=\"submit\">\n                          Making Vault ...\n                        </Button>\n                      ) : (\n                        <Button onClick={handleSubmit} type=\"submit\">\n                          DO IT!\n                        </Button>\n                      )}\n                    </ButtonGroup>\n                  </Stack>\n                </Stack>\n                {showPreVaultMsg ? (\n                  <Alert status=\"info\">\n                    <AlertIcon />\n                    Talking to contract ...\n                  </Alert>\n                ) : null}\n                {showMakingVaultMsg ? (\n                  <Alert status=\"info\">\n                    <AlertIcon />\n                    Making vault ... one moment\n                  </Alert>\n                ) : null}\n              </TabPanel>\n            </TabPanels>\n          </Tabs>\n        </Box>\n      </Flex>\n      {hash ? (\n        <TransactionToast\n          hash={hash}\n          onComplete={() => {\n            setHash(null)\n            if (!creating) {\n              fireMetaMask()\n              setShowPreVaultMsg(false)\n            } else {\n              setShowMakingVaultMsg(false)\n              location.href = location.origin + '/vault?id=' + tokenId\n            }\n          }}\n        />\n      ) : null}\n    </Loader>\n  )\n}\n"]},"metadata":{},"sourceType":"module"}