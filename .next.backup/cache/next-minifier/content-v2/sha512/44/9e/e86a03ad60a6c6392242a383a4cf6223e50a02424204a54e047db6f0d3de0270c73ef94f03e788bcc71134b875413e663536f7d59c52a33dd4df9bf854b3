{"code":"(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[27],{CoEt:function(e,t,n){\"use strict\";var r=n(\"8OQS\"),a=n.n(r),o=n(\"pVnL\"),c=n.n(o),u=n(\"qKvR\"),s=n(\"q1tI\"),i=n(\"FpzS\"),l=n(\"mf32\"),f=n(\"BMxC\"),p=[\"m\",\"mt\",\"mr\",\"mb\",\"ml\",\"mx\",\"my\",\"margin\",\"marginTop\",\"marginBottom\",\"marginLeft\",\"marginRight\",\"marginY\",\"marginX\",\"flex\",\"flexBasis\",\"width\",\"minWidth\",\"maxWidth\",\"maxW\",\"minW\",\"w\",\"zIndex\",\"top\",\"right\",\"bottom\",\"left\",\"position\",\"pos\"],m=function(e){var t={},n={};for(var r in e)p.includes(r)?t[r]=e[r]:n[r]=e[r];return[t,n]},d=n(\"w0db\"),b=function(e){var t=e.icon,n=a()(e,[\"icon\"]);return\"string\"===typeof t?Object(u.d)(d.a,c()({focusable:\"false\",name:t,color:\"currentColor\"},n)):Object(u.d)(f.a,c()({as:t,\"data-custom-icon\":!0,focusable:\"false\",color:\"currentColor\"},n))},h=Object(s.forwardRef)((function(e,t){return Object(u.d)(f.a,c()({ref:t,position:\"absolute\",display:\"inline-flex\",width:\"1.5rem\",height:\"100%\",alignItems:\"center\",justifyContent:\"center\",right:\"0.5rem\",top:\"50%\",pointerEvents:\"none\",zIndex:2,transform:\"translateY(-50%)\"},e))})),v=Object(s.forwardRef)((function(e,t){var n=e.placeholder,r=e.children,o=a()(e,[\"placeholder\",\"children\"]);return Object(u.d)(i.a,c()({as:\"select\",appearance:\"none\",ref:t,pr:\"2rem\",pb:\"px\",lineHeight:\"normal\"},o),n&&Object(u.d)(\"option\",{value:\"\"},n),r)})),O=Object(s.forwardRef)((function(e,t){var n=e.rootProps,r=e.icon,o=e.iconSize,s=void 0===o?5:o,i=e.iconColor,p=a()(e,[\"rootProps\",\"icon\",\"iconSize\",\"iconColor\"]),d=\"dark\"===Object(l.c)().colorMode?\"whiteAlpha.800\":\"inherit\",O=p.isReadOnly||p.isDisabled?.5:null,k=m(p),g=k[0],x=k[1];return Object(u.d)(f.a,c()({position:\"relative\",width:\"100%\"},g,n),Object(u.d)(v,c()({ref:t,color:d},x)),Object(u.d)(h,{opacity:O,color:i||x.color||d},Object(u.d)(b,{focusable:\"false\",\"aria-hidden\":\"true\",icon:r||\"chevron-down\",size:s})))}));O.displayName=\"Select\";t.a=O},D3uo:function(e,t,n){\"use strict\";n.r(t),n.d(t,\"EMBLEM_API\",(function(){return C})),n.d(t,\"default\",(function(){return S}));var r=n(\"o0o1\"),a=n.n(r),o=n(\"HaE+\"),c=n(\"q1tI\"),u=n.n(c),s=n(\"mf32\"),i=n(\"XZ7F\"),l=n(\"IDkF\"),f=n(\"sK1y\"),p=n(\"Yn+B\"),m=n(\"CoEt\"),d=n(\"FpzS\"),b=n(\"eJLp\"),h=n(\"BMxC\"),v=n(\"pboS\"),O=(n(\"+QRC\"),n(\"N39q\")),k=n(\"Z6YE\"),g=n(\"iBPG\"),x=n(\"8XlW\"),w=n(\"zIq6\"),j=n(\"PLxQ\"),y=u.a.createElement,C=\"https://api.emblemvault.io\";function S(e){var t=e.isOpen,n=e.onClose,r=e.tokenId,S=e.mine,I=Object(s.c)().colorMode,E=Object(k.b)(),M=E.account,T=E.chainId,N=E.library,R=Object(c.useState)(!1),A=R[0],F=R[1],_=Object(c.useState)(!1),z=_[0],B=_[1],P=Object(c.useState)(!1),V=P[0],W=P[1],q=Object(c.useState)({address:\"\",balance:0,tokenType:\"\",name:\"\",symbol:\"\"}),L=q[0],H=q[1],Y=Object(c.useState)([]),D=Y[0],G=Y[1],J=Object(c.useState)(0),Q=J[0],U=J[1],X=Object(c.useState)(\"\"),K=X[0],Z=X[1],$=Object(c.useState)(0),ee=$[0],te=$[1],ne=Object(c.useState)(0),re=ne[0],ae=ne[1],oe=Object(c.useState)(!1),ce=oe[0],ue=oe[1],se=Object(c.useState)(0),ie=se[0],le=se[1],fe=Object(c.useState)(0),pe=fe[0],me=fe[1],de=Object(c.useState)([]),be=de[0],he=de[1],ve=Object(c.useState)([]),Oe=ve[0],ke=ve[1],ge=Object(c.useState)(null),xe=ge[0],we=ge[1],je=Object(c.useState)([]),ye=je[0],Ce=je[1],Se=Object(c.useState)(0),Ie=Se[0],Ee=Se[1],Me=Object(c.useState)(!1),Te=Me[0],Ne=Me[1],Re=Object(c.useState)(0),Ae=Re[0],Fe=Re[1],_e=Object(c.useState)(!1),ze=_e[0],Be=_e[1],Pe=Object(c.useState)(null),Ve=Pe[0],We=Pe[1],qe=Object(c.useState)(0),Le=qe[0],He=qe[1],Ye=Object(i.a)(),De=(Ye.isOpen,Ye.onToggle,Object(c.useState)(!1)),Ge=De[0],Je=De[1],Qe=Object(c.useState)(0),Ue=Qe[0],Xe=Qe[1],Ke=function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=t.replace(\"http://104.154.252.216\",\"https://api.emblemvault.io/s:evmetadata\"),e.prev=1,e.next=4,fetch(t,{method:\"GET\",headers:{}});case 4:return r=e.sent,e.next=7,r.json();case 7:return o=e.sent,e.abrupt(\"return\",n(o));case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt(\"return\",n(!1));case 14:case\"end\":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}(),Ze=function(e){return console.log(\"contract\",e),tt(e,O.o.covalAbi,!0)},$e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return tt(e||O.o.emblemVault[T],O.o.emblemAbi,!0)},et=function(){return tt(O.o.nftrade[T],O.o.nftradeAbi,!0)},tt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new x.a(e,t,n?N.getSigner(M).connectUnchecked():N)};Object(c.useEffect)((function(){M&&K!=M&&(Z(M),W(!1))}),[M,K]),Object(c.useEffect)((function(){if(A){var e=setTimeout((function(){F(!1)}),750);return function(){clearTimeout(e)}}}),[A]),Object(c.useEffect)((function(){V||z||(B(!0),pt(M,function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:G(t),ft(),W(!0),B(!1);case 4:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}));var nt=function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,o=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:ee,r=Ze(t),console.log(\"decimals\",ee),e.next=5,r.approve(O.o.nftrade[T],Q*Math.pow(10,+n)).then((function(e){var t=e.hash;we(t)}));case 5:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),rt=function(){var e=Object(o.a)(a.a.mark((function e(){var t,n,r=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:null,n=$e(t),e.next=4,n.setApprovalForAll(O.o.nftrade[T],!0).then((function(e){var t=e.hash;we(t)}));case 4:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),at=function(){var e=Object(o.a)(a.a.mark((function e(){var t,n,r,o=arguments;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:null,n=$e(t),e.next=4,n.isApprovedForAll(M,O.o.nftrade[T]);case 4:r=e.sent,ue(r);case 6:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ot=function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,c,u,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){return(s=Object(o.a)(a.a.mark((function e(t,o){var s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.tokenOfOwnerByIndex(M,t);case 2:if(s=e.sent,c.push(s.toNumber()),!(t+1>=r)){e.next=8;break}return e.abrupt(\"return\",o());case 8:return e.abrupt(\"return\",u(t+1,o));case 9:case\"end\":return e.stop()}}),e)})))).apply(this,arguments)},u=function(e,t){return s.apply(this,arguments)},n=$e(t),e.next=5,n.balanceOf(M);case 5:r=e.sent,c=[],u(0,(function(){Ce(c)}));case 8:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ct=function(){var e=Object(o.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=et(),e.next=3,t.addOffer(L.address,pe,O.o.emblemVault[T],r,ie*Math.pow(10,+ee)).then((function(e){var t=e.hash;we(t)}));case 3:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ut=function(){var e=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=et(),e.next=3,n.withdrawOffer(O.o.emblemVault[T],r,t).then((function(e){var t=e.hash;we(t)}));case 3:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),st=function(){var e=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=et(),e.next=3,n.rejectOffer(O.o.emblemVault[T],r,t).then((function(e){var t=e.hash;we(t)}));case 3:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),it=function(){var e=Object(o.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=et(),e.next=3,n.acceptOffer(O.o.emblemVault[T],r,t).then((function(e){var t=e.hash;we(t)}));case 3:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),lt=function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ze(t),e.next=3,n.decimals();case 3:return r=e.sent,te(r),e.t0=ae,e.next=8,n.allowance(M,O.o.nftrade[T]).then((function(e){return(e*Math.pow(10,-r)).toString()}));case 8:return e.t1=e.sent,(0,e.t0)(e.t1),e.t2=U,e.next=13,n.balanceOf(M).then((function(e){return(e*Math.pow(10,-r)).toString()}));case 13:e.t3=e.sent,(0,e.t2)(e.t3);case 15:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ft=function(){var e=Object(o.a)(a.a.mark((function e(){var t,n,c,u,s,i,l,f,p,m,d,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return b=function(){return(b=Object(o.a)(a.a.mark((function e(n,o,u,s){var i,l,f,p,m,b,h,v,k;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k=function(){return n+1>=c?s(o,u):d(n+1,o,u,s)},e.next=3,t.getOffer(O.o.emblemVault[T],r,n);case 3:if(i=e.sent,console.log(\"-------\",i),\"0x0000000000000000000000000000000000000000\"===i.token){e.next=40;break}return l={tokenId:i.tokenId.toNumber(),_from:i._from,token:i.token,amount:i.amount},f=Ze(l.token),e.next=10,f.name();case 10:if(p=e.sent,console.log(\"----- name ----\",p),l.name=p,l.index=n,l.address=l.token,console.log(\"----- offer tokenid ----\",i.tokenId.toNumber()),0!=i.tokenId.toNumber()){e.next=31;break}return e.next=19,f.decimals();case 19:return m=e.sent,e.next=22,f.symbol();case 22:b=e.sent,l.symbol=b,l.decimals=m,l.amount=l.amount.toNumber()*Math.pow(10,-m),o.push(l),l._from==M&&u.push(l),k(),e.next=38;break;case 31:return h=$e(l.token),e.next=34,h.tokenURI(l.tokenId);case 34:v=(v=e.sent).replace(\"ipfs://\",\"https://gateway.ipfs.io/\"),console.log(\"---------URI---------\",v),Ke(v,(function(e){console.log(\"metadata\",e),l.metadata=e,l.amount=i.amount.toNumber(),l.tokenId=i.tokenId.toNumber(),o.push(l),l._from==M&&u.push(l),k()}));case 38:e.next=42;break;case 40:console.log(\"----- wtf -----\"),k();case 42:case\"end\":return e.stop()}}),e)})))).apply(this,arguments)},d=function(e,t,n,r){return b.apply(this,arguments)},t=et(),e.next=5,t.paymentAddress();case 5:return n=e.sent,We(n),e.next=9,lt(n);case 9:return e.next=11,t.getOfferCount(O.o.emblemVault[T],r);case 11:return c=e.sent.toNumber(),e.next=14,t.payToMakeOffer();case 14:return u=e.sent,Ne(u),e.next=18,t.makeOfferPrice();case 18:return s=e.sent.toNumber(),Ee(s),e.next=22,t.payToAcceptOffer();case 22:return i=e.sent,Be(i),e.next=26,t.acceptOfferPrice();case 26:return l=e.sent.toNumber(),Fe(l),f=Ze(n),e.next=31,t.takePercentageOfERC20();case 31:return p=e.sent,Je(p),e.next=35,t.percentageFee();case 35:return m=e.sent.toNumber(),Xe(m),console.log(\"-----%\",p,m),e.t0=console,e.next=41,f.decimals();case 41:return e.t1=e.sent,e.t0.log.call(e.t0,\"dec\",e.t1),e.t2=He,e.next=46,f.decimals();case 46:e.t3=e.sent,(0,e.t2)(e.t3),console.log(\"_paymentToken\",n),at(),console.log(\"--------- payment ---------\",u,s,i,l,n,re),console.log(\"------ offer count ------\",c),c>0&&d(0,[],[],(function(e,t){he(e),ke(t),console.log(\"offers\",e,t)}));case 53:case\"end\":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),pt=function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!S){e.next=2;break}return e.abrupt(\"return\",n([]));case 2:return e.next=4,fetch(C+\"/\"+g.d[T]+\"/balance/\"+t,{method:\"GET\",headers:{\"Content-Type\":\"application/json\",service:\"evmetadata\"}});case 4:return r=e.sent,e.next=7,r.json();case 7:return o=e.sent,e.abrupt(\"return\",n(o.values));case 9:case\"end\":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return y(l.a,{isOpen:t,onClose:n,isCentered:!0},y(l.g,null),y(l.d,{color:O.c[I]},y(l.f,null,y(f.a,null,S?null:\"Make\",\" Offer\",S?\"s\":null,\" for: \",r)),y(l.c,null),y(l.b,null,S?null:y(p.a,{direction:\"column\"},y(p.a,{mt:\"6\"},y(f.a,null,\"Choose your Offer Token\"),y(m.a,{w:\"100%\",value:L.address,onChange:function(e){if(\"0\"!==e.target.value){var t=D.filter((function(t){return t.address==e.target.value}))[0];console.log(t),H(t),me(0),\"ERC-20\"==t.tokenType?lt(t.address):ot(t.address),console.log(D.filter((function(t){return t.address==e.target.value}))[0]),console.log(e.target.value)}}},y(\"option\",{value:\"0\"},\"Choose a Token\"),D.map((function(e,t){if(\"native\"!==e.tokenType)return y(\"option\",{value:e.address},e.name)}))),L.balance>0&&\"ERC-20\"==L.tokenType&&re>0?y(u.a.Fragment,null,y(f.a,null,\"Max: \",Number(Q)>Number(re)?re:Q,\" \"),y(d.a,{onChange:function(e){return le(e.target.value)}})):null),y(p.a,{direction:\"row\",justify:\"center\"},\"ERC-20\"==L.tokenType?Q>0&&0==re?y(b.a,{onClick:function(){nt(L.address)}},\"Approve offer of \",L.name):L&&0==Q?y(f.a,null,\"Insufficient Balance\"):y(b.a,{onClick:function(){ct()}},\"Make Offer\"):ye.length>0?y(m.a,{width:\"100%\",onChange:function(e){\"0\"!==e.target.value&&(me(Number(e.target.value)),at(L.address))}},y(\"option\",{key:-1,value:\"0\"},\"Select TokenId\"),ye.map((function(e,t){return y(\"option\",{key:t,value:e},e)}))):null,L.name&&\"ERC-20\"!=L.tokenType&&!ce&&0!=pe?y(b.a,{width:\"100%\",onClick:function(){rt(L.address)}},\"Approve \",L.name):L.name&&\"ERC-20\"!=L.tokenType&&ce?y(b.a,{onClick:function(){ct()}},\"Make Offer\"):null),Te?y(f.a,null,\" Cost: \",Ae*Math.pow(10,-Le),\" $Coval to make offers\"):null,Ge&&\"ERC-20\"==L.tokenType&&ie?y(u.a.Fragment,null,y(f.a,null,\"Fee: \",Ue,\"%  (\",ie*(Ue/100),\" \",L.symbol,\")\")):null,y(p.a,{maxHeight:\"200px\",overflow:\"scroll\"},Oe.length>0?y(f.a,{as:\"h2\"},\"My Offers\"):null,Te&&Q>0&&re*Math.pow(10,+Le)<Ie?y(u.a.Fragment,null,y(b.a,{onClick:function(){nt(Ve,Le)}},\"Approve spending \")):L&&Q<Ie*Math.pow(10,-Le)?y(f.a,null,\"Insufficient Balance\"):null,Oe.map((function(e,t){return y(h.a,{borderRadius:\"0.25rem\",borderWidth:1,p:2,mb:2},y(f.a,{fontSize:\"bold\",color:\"dark\"==I?\"lightgreen\":\"forestgreen\"},e.amount>0?e.amount:null,y(v.a,{ml:3,color:\"dark\"==I?\"white\":\"black\",href:Object(g.f)(g.b.Token,[T,e.token]),isExternal:!0},e.name),e.amount<1?\" [\"+e.tokenId+\"]\":null),y(b.a,{onClick:function(){ut(e.index)},m:2},\"Withdraw Offer\"),e.metadata?y(h.a,null,y(j.b,{className:\"\",url:e.metadata.image.replace(\"ipfs://\",\"https://gateway.ipfs.io/\")})):null)})))),S?y(h.a,null,ce?null:y(b.a,{onClick:function(){rt()}},\"Allow accepting of Offers\"),y(p.a,{direction:\"column\",maxHeight:\"200px\",overflow:\"scroll\"},ze&&Q>0&&re*Math.pow(10,+Le)<Ae?y(u.a.Fragment,null,y(f.a,null,\"Cost: \",Ae*Math.pow(10,-Le),\" $Coval to accept offers\"),y(b.a,{onClick:function(){nt(Ve,Le)}},\"Approve spending \")):L&&Q<Ae*Math.pow(10,-Le)?y(f.a,null,\"Insufficient Balance\"):null,be.map((function(e,t){return y(h.a,{borderRadius:\"0.25rem\",borderWidth:1,p:2,mb:2},y(f.a,{fontSize:\"bold\",color:\"dark\"==I?\"lightgreen\":\"forestgreen\"},e.amount>0?e.amount:null,y(v.a,{ml:3,color:\"dark\"==I?\"white\":\"black\",href:Object(g.f)(g.b.Token,[T,e.token]),isExternal:!0},e.name),e.amount<1?\"[\"+e.tokenId+\"]\":null),y(f.a,{color:\"dark\"==I?\"#baaa94\":\"gray\",fontSize:\"xs\"},\"From:\",y(v.a,{ml:3,color:\"dark\"==I?\"white\":\"darkgray\",href:Object(g.f)(g.b.Account,[T,e._from]),isExternal:!0},e._from)),y(b.a,{onClick:function(){st(e.index)},m:2},\"Reject Offer\"),ce?y(b.a,{onClick:function(){it(e.index)},m:2},\"Accept Offer\"):null,e.metadata?y(h.a,null,y(j.b,{className:\"\",url:e.metadata.image.replace(\"ipfs://\",\"https://gateway.ipfs.io/\")})):null)})))):null,xe?y(w.a,{hash:xe,onComplete:function(){we(null),W(!1)}}):null),y(l.e,null)))}}}]);","extractedComments":[]}