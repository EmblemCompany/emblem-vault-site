(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2417],{7532:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/create",function(){return n(42348)}])},33862:function(t,e,n){"use strict";n.d(e,{Z:function(){return k}});var r=n(85893),o=n(67294),a=n(62850),l=n(6089);class s extends o.Component{render(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("div",{className:"sketchfab-embed-wrapper",children:(0,r.jsx)("iframe",{width:"100%",src:this.props.url,frameBorder:"0",allow:"autoplay; fullscreen; vr",allowFullScreen:!0})})})}}class c extends o.Component{render(){let t=this.props.url.replace("paused=true","paused=false");return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{width:"95%",frameBorder:"0",src:t,allowFullScreen:!0})})}}class u extends o.Component{render(){let t=this.props.url.replace("paused=true","paused=false");return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{height:"753px",src:t,seamless:!0})})}}class d extends o.Component{render(){let t=this.props.url.replace("paused=true","paused=false");return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{width:"95%",height:"100%",scrolling:"no",frameBorder:"no",allow:"autoplay",src:t})})}}class h extends o.Component{render(){let t=this.props.url.replace("paused=true","paused=false");return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{width:"95%",height:"256px",scrolling:"no",frameBorder:"no",allow:"autoplay",src:t})})}}class p extends o.Component{render(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{src:this.props.url,frameBorder:"0",scrolling:"no",width:"580",height:"326",allowFullScreen:!0})})}}class f extends o.Component{render(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{src:this.props.url,width:"800",height:"600",allowFullScreen:!0})})}}class g extends o.Component{render(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{width:"230",height:"285",src:this.props.url,frameBorder:"0",scrolling:"no",allowTransparency:!0})})}}class m extends o.Component{render(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{src:this.props.url,width:"100%",height:"400",allow:"encrypted-media"})})}}var $=n(76649);class y extends o.Component{render(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)($.Z,{log:!0,src:this.props.url,scrolling:!0,width:"100%",height:"400",allow:"encrypted-media"})})}}class x extends o.Component{render(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{className:"ytembed",src:this.props.url.split(" ")[0].trim().replace('"',"").replace("/watch?v=","/embed/"),width:"100%",height:"315",frameBorder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})}}class b extends o.Component{render(){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("iframe",{src:this.props.url,width:"100%",frameBorder:"0",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0})})}}class v extends o.Component{render(){let t=this.props.url||"",e=t.replace("ipfs://","").split("?")[0].split("&")[0];return t.includes("ipfs://")&&(t="https://gateway.ipfs.io/ipfs/"+e,w(e)),t.includes("image-scale")&&(t+="&size=400"),(0,r.jsx)(r.Fragment,{children:t.includes("sketchfab.com/")?(0,r.jsx)(s,{url:t}):t.includes("shadertoy.com/")?(0,r.jsx)(c,{url:t}):t.includes("bandcamp.com/")?(0,r.jsx)(u,{url:t}):t.includes("soundcloud.com/")?(0,r.jsx)(d,{url:t}):t.includes("clyp.it/")?(0,r.jsx)(h,{url:t}):t.includes("sketchup.com/")?(0,r.jsx)(p,{url:t}):t.includes("clara.io/")?(0,r.jsx)(f,{url:t}):t.includes("myminifactory.com/")?(0,r.jsx)(g,{url:t}):t.includes("audius.co/")?(0,r.jsx)(m,{url:t}):t.includes("youtube.com")?(0,r.jsx)(x,{url:t}):t.includes("vimeo.com")?(0,r.jsx)(b,{url:t}):t.includes("ipfs.io")?(0,r.jsx)(l.E,{p:"20px",h:"100%",className:this.props.className+" "+e||"d-block w-100",src:t,width:"250px",maxWidth:"250px"}):t.includes("image-scaler.vercel")?(0,r.jsx)(l.E,{p:"20px",h:"100%",className:this.props.className||"d-block w-100",src:t,width:"250px",height:"300px"}):t.includes("/dynamic/")||t.includes("https://s3.amazonaws.com/")||t.includes("googleusercontent.com")||t.includes("ipfs.io")||t.includes("framed/")||t.includes(".png")||t.includes(".jpg")||t.includes(".jpeg")||t.includes(".gif")||t.includes(".svg")||t.includes("data:image")?(0,r.jsx)(l.E,{p:"20px",h:"100%",className:this.props.className||"d-block w-100",src:(0,a.yo)(t)?t:"https://raw.githubusercontent.com/EmblemCompany/Coval-Site/master/public/coval-logo.png",width:"250px",maxWidth:"250px"}):(0,r.jsx)(y,{url:t})})}}let w=async function(t){let e=await fetch("https://gateway.ipfs.io/ipfs/"+t,{method:"GET"}),n=await e.text();if(n.includes("data:image")){let e=document.querySelector("img."+t);e.src=n,console.log(n)}};var k=v},42348:function(t,e,n){"use strict";let r,o,a,l,s,c,u,d;n.r(e),n.d(e,{default:function(){return fb}});var h=n(85893),p=n(7335),f=n(93717),g=n(57747),m=n(36752),$=n(77458),y=n(35232),x=n(72047),b=n(37365),v=n(51343),w=n(18020),k=n(66529),C=n(33090),M=n(51001),S=n(53600),A=n(93108),E=n(57169),T=n(78590),R=n(49289),I=n(41731),P=n(71293),D=n(89645),L=n(74153),F=n(7405),B=n(86511),O=n(8161),j=n(70758),_=n.n(j),z=n(77044),N=n(67294),U=n(11163),W=n(64541),X=n(31238),V=n(80902),H=n(62850),Y=n(33862),G=n(10043),K=n.n(G);/*!
 * Doka Image Editor 7.8.0
 * (c) 2018-2021 PQINA Inc. - All Rights Reserved
 * License: https://pqina.nl/doka/license/
 */let q="__doka_webapi__";var Z=t=>window[q]?window[q][t]:window[t],Q=function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n="progress",r={loaded:100*t,total:100,lengthComputable:e};try{return new(Z("ProgressEvent"))(n,r)}catch(t){return{type:n,...r}}},J=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n]},tt=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((r,o)=>{let{dataFormat:a="readAsArrayBuffer"}=n,l=new(Z("FileReader"));l.onload=()=>r(l.result),l.onerror=o,l.onprogress=e,l[a](t)})};let te=null;var tn=()=>(null===te&&(te=void 0!==window.document),te);let ti=null;var tr=()=>new Promise(t=>{if(null===ti){let e=tn()?new Image:{};e.onload=()=>{ti=1===e.naturalWidth,e=void 0,t(ti)},e.src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";return}return t(ti)}),to=t=>{let e=t.getContext("2d").getImageData(0,0,t.width,t.height);return e},ta=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=document.createElement(t),o=Object.getOwnPropertyDescriptors(r.__proto__);for(let t in e)"style"===t?r.style.cssText=e[t]:o[t]&&o[t].set||/textContent|innerHTML/.test(t)||"function"==typeof e[t]?r[t]=e[t]:r.setAttribute(t,e[t]);return n.forEach(t=>r.appendChild(t)),r};let tl={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]};var ts=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;return -1===n&&(n=1),tl[n](t,e)},tc=t=>{t.width=1,t.height=1;let e=t.getContext("2d");e&&e.clearRect(0,0,1,1)},tu=t=>"data"in t,td=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,[n,r]=await tr()||e<5?[t.width,t.height]:[t.height,t.width],o=ta("canvas",{width:n,height:r}),a=o.getContext("2d");if(tu(t)&&!await tr()&&e>1){let e=ta("canvas",t),n=e.getContext("2d");n.putImageData(t,0,0),t=e}return!await tr()&&e>1&&a.transform.apply(a,ts(t.width,t.height,e)),tu(t)?a.putImageData(t,0,0):a.drawImage(t,0,0),t instanceof HTMLCanvasElement&&tc(t),o},th=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 1===e?t:await tr()?t:to(await td(t,e))},tp=(t,e)=>{let n=t.naturalWidth,r=t.naturalHeight,o=n*r;if(e&&o>e){let t=Math.sqrt(e)/Math.sqrt(o);n=Math.floor(n*t),r=Math.floor(r*t)}let a=ta("canvas");a.width=n,a.height=r;let l=a.getContext("2d");return l.drawImage(t,0,0,n,r),a},tf=(t,e)=>new Promise((n,r)=>{let o=()=>n(tp(t,e));t.complete&&t.width?o():(t.onload=o,t.onerror=r)}),tg=async(t,e)=>{let n=ta("img",{src:URL.createObjectURL(t)}),r=await tf(n,e);return URL.revokeObjectURL(n.src),r},tm=()=>"createImageBitmap"in window,t$=()=>"OffscreenCanvas"in window,ty=t=>/svg/.test(t.type),tx=()=>Math.random().toString(36).substr(2,9),tb=t=>new Blob(["(","function"==typeof t?t.toString():t,")()"],{type:"application/javascript"});let tv=t=>"function () {self.onmessage = function (message) {(".concat(t.toString(),").apply(null, message.data.content.concat([function (err, response) {\n    response = response || {};\n    const transfer = 'data' in response ? [response.data.buffer] : 'width' in response ? [response] : [];\n    return self.postMessage({ id: message.data.id, content: response, error: err }, transfer);\n}]))}}"),tw=new Map;var tk=(t,e,n)=>new Promise((r,o)=>{let a=t.toString(),l=tw.get(a);if(!l){let e=tv(t),n=URL.createObjectURL(tb(e)),r=new Map,o=new Worker(n);l={url:n,worker:o,messages:r,terminate:()=>{l.worker.terminate(),URL.revokeObjectURL(n)}},o.onmessage=function(t){let{id:e,content:n,error:o}=t.data;if(!r.has(e))return;let a=r.get(e);r.delete(e),null!=o?a.reject(o):a.resolve(n)},tw.set(a,l)}let s=tx();l.messages.set(s,{resolve:r,reject:o}),l.worker.postMessage({id:s,content:e},n)}),tC=async(t,e)=>{let n;if(tm()&&!ty(t)&&t$())try{n=await tk((t,e,n)=>{createImageBitmap(t).then(t=>{let r=t.width,o=t.height,a=r*o;if(e&&a>e){let t=Math.sqrt(e)/Math.sqrt(a);r=Math.floor(r*t),o=Math.floor(o*t)}let l=new OffscreenCanvas(r,o),s=l.getContext("2d");s.drawImage(t,0,0);let c=s.getImageData(0,0,l.width,l.height);n(null,c)}).catch(t=>{n(t)})},[t,e])}catch(t){}if(!n||!n.width){let r=await tg(t,e);n=to(r),tc(r)}return n},tM=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return new Promise((r,o)=>{try{t.toBlob(t=>{r(t)},e,n)}catch(t){o(t)}})},tS=async(t,e,n)=>{try{let r=await td(t),o=await tM(r,e,n);return tc(r),o}catch(t){throw t}},tA=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,t.size],n=arguments.length>2?arguments[2]:void 0;return await tt(t.slice(...e),n)},tE=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,t.size];return e?new Blob([e,t.slice(...n)],{type:t.type}):t},tT=t=>t.match(/\/([a-z]+)/)[1],tR=t=>t.substr(0,t.lastIndexOf("."))||t,tI=t=>t.split(".").pop();let tP=/avif|bmp|gif|jpg|jpeg|jpe|jif|jfif|png|svg|tiff|webp/;var tD=t=>tP.test(t)?"image/"+(/jfif|jif|jpe|jpg/.test(t)?"jpeg":"svg"===t?"svg+xml":t):"",tL=t=>t&&tD(tI(t).toLowerCase()),tF=(t,e)=>{let n=tL(t);if(n===e)return t;let r=tT(e);return"".concat(tR(t),".").concat(r)},tB=(t,e,n)=>{let r=new Date().getTime(),o=t.type.length&&"null"!==t.type,a=o?t.type:n,l=tF(e,a);try{return new(Z("File"))([t],l,{lastModified:r,type:o?t.type:a})}catch(n){let e=o?t.slice():t.slice(0,t.size,a);return e.lastModified=r,e.name=l,e}},tO=(t,e)=>t/e,tj=t=>t;let t_=Math.PI,tz=Math.PI/2,tN=tz/2;var tU=t=>{let e=Math.abs(t)%Math.PI;return e>tN&&e<Math.PI-tN};let tW=(t,e,n)=>n+(t-n)*e,tX=t=>({x:t.x+.5*t.width,y:t.y+.5*t.height,rx:.5*t.width,ry:.5*t.height}),tV=()=>tH(0,0),tH=(t,e)=>({x:t,y:e}),tY=t=>tH(t.width,t.height),tG=t=>tH(t.pageX,t.pageY),tK=t=>tH(t.offsetX,t.offsetY),tq=t=>tH(t.x,t.y),tZ=t=>(t.x=-t.x,t.y=-t.y,t),tQ=t=>{let e=t.x;return t.x=-t.y,t.y=e,t},tJ=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tV(),r=Math.cos(e),o=Math.sin(e),a=t.x-n.x,l=t.y-n.y;return t.x=n.x+r*a-o*l,t.y=n.y+o*a+r*l,t},t0=t=>Math.sqrt(t.x*t.x+t.y*t.y),t1=t=>{let e=Math.sqrt(t.x*t.x+t.y*t.y);return 0===e?tV():(t.x/=e,t.y/=e,t)},t2=t=>Math.atan2(t.y,t.x),t4=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),t5=(t,e)=>t.x===e.x&&t.y===e.y,t3=(t,e)=>(t.x=e(t.x),t.y=e(t.y),t),t6=(t,e)=>(t.x+=e.x,t.y+=e.y,t),t8=(t,e)=>(t.x-=e.x,t.y-=e.y,t),t7=(t,e)=>(t.x*=e,t.y*=e,t),t9=(t,e)=>t.x*e.x+t.y*e.y,et=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tV(),n=t.x-e.x,r=t.y-e.y;return n*n+r*r},ee=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tV();return Math.sqrt(et(t,e))},en=t=>{let e=0,n=0;return t.forEach(t=>{e+=t.x,n+=t.y}),tH(e/t.length,n/t.length)},ei=(t,e,n,r,o)=>(t.forEach(t=>{t.x=e?r-(t.x-r):t.x,t.y=n?o-(t.y-o):t.y}),t),er=(t,e,n,r)=>{let o=Math.sin(e),a=Math.cos(e);return t.forEach(t=>{t.x-=n,t.y-=r;let e=t.x*a-t.y*o,l=t.x*o+t.y*a;t.x=n+e,t.y=r+l}),t},eo=(t,e)=>({width:t,height:e}),ea=t=>eo(t.width,t.height),el=t=>eo(t.width,t.height),es=t=>eo(t.width,t.height),ec=t=>eo(t[0],t[1]),eu=(t,e)=>eo(t,e),ed=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tj;return n(t.width)===n(e.width)&&n(t.height)===n(e.height)},eh=(t,e)=>(t.width*=e,t.height*=e,t),ep=t=>tH(.5*t.width,.5*t.height),ef=(t,e)=>{let n=Math.cos(e),r=Math.sin(e),o=n*t.width+r*t.height,a=r*t.width+n*t.height;return t.width=o,t.height=a,t},eg=(t,e)=>{let n=t.width,r=t.height;return tU(e)&&(t.width=r,t.height=n),t},em=(t,e)=>t.width>=e.width&&t.height>=e.height,e$=(t,e)=>(t.width=e(t.width),t.height=e(t.height),t),ey=t=>Math.sqrt(t.width*t.width+t.height*t.height),ex=(t,e)=>eu(Math.min(t.width,e.width),Math.min(t.height,e.height)),eb=(t,e)=>({start:t,end:e}),ev=t=>eb(tq(t.start),tq(t.end)),ew=(t,e)=>{let n=tH(t.start.x-t.end.x,t.start.y-t.end.y),r=t1(n),o=t7(r,e);return t.start.x+=o.x,t.start.y+=o.y,t.end.x-=o.x,t.end.y-=o.y,t},ek=(t,e)=>{let n=tH(t.start.x-t.end.x,t.start.y-t.end.y),r=t1(n),o=t7(r,e);return t.end.x+=o.x,t.end.y+=o.y,t},eC=[tH(-1,-1),tH(-1,1),tH(1,1),tH(1,-1)],eM=(t,e,n,r)=>({x:t,y:e,width:n,height:r}),eS=t=>eM(t.x,t.y,t.width,t.height),eA=()=>eM(0,0,0,0),eE=(t,e)=>eM(0,0,t,e),eT=t=>eM(0,0,t.width,t.height),eR=t=>eM(t.x||0,t.y||0,t.width||0,t.height||0),eI=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];let r=Array.isArray(e[0])?e[0]:e,o=r[0].x,a=r[0].x,l=r[0].y,s=r[0].y;return r.forEach(t=>{o=Math.min(o,t.x),a=Math.max(a,t.x),l=Math.min(l,t.y),s=Math.max(s,t.y)}),eM(o,l,a-o,s-l)},eP=t=>eL(t.x-t.rx,t.y-t.ry,2*t.rx,2*t.ry),eD=(t,e)=>eM(t.x-.5*e.width,t.y-.5*e.height,e.width,e.height),eL=(t,e,n,r)=>eM(t,e,n,r),eF=t=>tH(t.x+.5*t.width,t.y+.5*t.height),eB=(t,e)=>(t.x+=e.x,t.y+=e.y,t),eO=(t,e,n)=>(n=n||eF(t),t.x=e*(t.x-n.x)+n.x,t.y=e*(t.y-n.y)+n.y,t.width=e*t.width,t.height=e*t.height,t),ej=(t,e)=>(t.x*=e,t.y*=e,t.width*=e,t.height*=e,t),e_=(t,e)=>(t.x/=e,t.y/=e,t.width/=e,t.height/=e,t),ez=(t,e)=>(t.x-=e.x,t.y-=e.y,t.width-=e.width,t.height-=e.height,t),eN=(t,e)=>(t.x+=e.x,t.y+=e.y,t.width+=e.width,t.height+=e.height,t),eU=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tj;return n(t.x)===n(e.x)&&n(t.y)===n(e.y)&&n(t.width)===n(e.width)&&n(t.height)===n(e.height)},eW=t=>tO(t.width,t.height),eX=(t,e,n,r,o)=>(t.x=e,t.y=n,t.width=r,t.height=o,t),eV=(t,e)=>(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t),eH=(t,e,n)=>(n||(n=eF(t)),eQ(t).map(t=>tJ(t,e,n))),eY=(t,e)=>eM(.5*t.width-.5*e.width,.5*t.height-.5*e.height,e.width,e.height),eG=(t,e)=>!(e.x<t.x)&&!(e.y<t.y)&&!(e.x>t.x+t.width)&&!(e.y>t.y+t.height),eK=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tV();if(0===t.width||0===t.height)return eA();let r=eW(t);e||(e=r);let o=t.width,a=t.height;return e>r?o=a*e:a=o/e,eM(n.x+(t.width-o)*.5,n.y+(t.height-a)*.5,o,a)},eq=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eW(t),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tV();if(0===t.width||0===t.height)return eA();let r=t.width,o=r/e;return o>t.height&&(r=(o=t.height)*e),eM(n.x+(t.width-r)*.5,n.y+(t.height-o)*.5,r,o)},eZ=t=>[Math.min(t.y,t.y+t.height),Math.max(t.x,t.x+t.width),Math.max(t.y,t.y+t.height),Math.min(t.x,t.x+t.width)],eQ=t=>[tH(t.x,t.y),tH(t.x+t.width,t.y),tH(t.x+t.width,t.y+t.height),tH(t.x,t.y+t.height)],eJ=(t,e)=>{if(t)return t.x=e(t.x),t.y=e(t.y),t.width=e(t.width),t.height=e(t.height),t},e0=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:eF(t);return eQ(t).map((t,r)=>{let o=eC[r];return tH(tW(t.x,1+o.x*e.x,n.x),tW(t.y,1+o.y*e.y,n.y))})},e1=t=>(t.x=0,t.y=0,t),e2=t=>{let e,n,r;let o=t.map(tq),a=o[0],l=o[o.length-1];(a.x!=l.x||a.y!=l.y)&&o.push(a);let s=0,c=0,u=0,d=o.length;for(let t=0,l=d-1;t<d;l=t++)e=o[t],n=o[l],s+=r=(e.y-a.y)*(n.x-a.x)-(n.y-a.y)*(e.x-a.x),c+=(e.x+n.x-2*a.x)*r,u+=(e.y+n.y-2*a.y)*r;return tH(c/(r=3*s)+a.x,u/r+a.y)},e4=(t,e)=>e5(t.start,t.end,e.start,e.end),e5=(t,e,n,r)=>{let o=((r.x-n.x)*(t.y-n.y)-(r.y-n.y)*(t.x-n.x))/((r.y-n.y)*(e.x-t.x)-(r.x-n.x)*(e.y-t.y)),a=((e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x))/((r.y-n.y)*(e.x-t.x)-(r.x-n.x)*(e.y-t.y));if(o>=0&&o<=1&&a>=0&&a<=1)return tH(t.x+o*(e.x-t.x),t.y+o*(e.y-t.y))},e3=(t,e)=>{let n=[...e,e[0]],r=n.length,o=[];for(let e=0;e<r-1;e++){let r=e5(t.start,t.end,tH(n[e].x,n[e].y),tH(n[e+1].x,n[e+1].y));r&&o.push(r)}return o.length?o:void 0},e6=(t,e)=>{let n,r,o,a,l,s,c,u,d;let h=e.length;for(n=0;n<h;n++)if(r=e[n],o=e[n+1>h-1?0:n+1],a=r.x-t.x,l=r.y-t.y,s=o.x-t.x,c=o.y-t.y,u=a-s,d=l-c,u*l-d*a<-.00001)return!1;return!0},e8=t=>{let e=[];for(let n=0;n<t.length;n++){let r=n+1;r===t.length&&(r=0),e.push(eb(tq(t[n]),tq(t[r])))}return e};var e7=(t,e)=>{let n=eT(t),r=eF(n),o=eH(n,e,r);return e1(eI(o))},e9=(t,e)=>t instanceof HTMLElement&&(!e||RegExp("^".concat(e,"$"),"i").test(t.nodeName)),nt=t=>t instanceof File,ne=t=>"string"==typeof t,nn=async(t,e,n)=>{let r=await tM(t,e,n);return tB(r,"canvas")},ni=t=>t.split("/").pop().split(/\?|\#/).shift();let nr=null;var no=()=>(null===nr&&(nr=nr=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),nr),na=t=>new Promise((e,n)=>{let r=!1;!t.parentNode&&no()&&(r=!0,t.style.cssText="position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;",document.body.appendChild(t));let o=()=>{let n=t.naturalWidth,o=t.naturalHeight,l=n&&o;l&&(r&&t.parentNode.removeChild(t),clearInterval(a),e({width:n,height:o}))};t.onerror=t=>{clearInterval(a),n(t)};let a=setInterval(o,1);o()}),nl=async t=>{let e,n=t;n.src||((n=new Image).src=ne(t)?t:URL.createObjectURL(t));try{e=await na(n)}catch(t){throw t}finally{nt(t)&&URL.revokeObjectURL(n.src)}return e};let ns=t=>new Promise((e,n)=>{if(t.complete)return e(t);t.onload=()=>e(t),t.onerror=n});var nc=async t=>{try{let e=await nl(t),n=await ns(t),r=document.createElement("canvas");r.width=e.width,r.height=e.height;let o=r.getContext("2d");o.drawImage(n,0,0);let a=await tM(r);return tB(a,ni(n.src))}catch(t){throw t}},nu=t=>/^data:/.test(t),nd=t=>tn()?RegExp(t).test(window.navigator.userAgent):void 0;let nh=null;var np=()=>(null===nh&&(nh=nd(/MSIE|Trident/)),nh);let nf=t=>{let e=t.split(","),n=e[0].substr(4),r=atob(e[1]),o=r.length,a=new ArrayBuffer(r.length),l=new Uint8Array(a);for(var s=0;s<o;s++)l[s]=r.charCodeAt(s);return new Blob([a],{type:n})};var ng=async function(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"data-uri",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:J;if(r(Q(0)),np())e=nf(t),r(Q(.5));else{let n=await fetch(t);r(Q(.33)),e=await n.blob(),r(Q(.66))}let o=tB(e,n);return r(Q(1)),o},nm=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t=>t;return t.getAllResponseHeaders().indexOf(e)>=0?n(t.getResponseHeader(e)):void 0},n$=t=>{if(!t)return null;let e=t.split(/filename=|filename\*=.+''/).splice(1).map(t=>t.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(t=>t.length);return e.length?decodeURI(e[e.length-1]):null};class ny extends Error{constructor(t,e,n){super(t),this.name="DokaError",this.code=e,this.metadata=n}}var nx=(t,e)=>new Promise((n,r)=>{let o=()=>r(new ny("Error fetching image","URL_REQUEST",a)),a=new XMLHttpRequest;a.onprogress=e,a.onerror=o,a.onload=()=>{if(!a.response||a.status>=300||a.status<200)return o();let e=nm(a,"Content-Type"),r=nm(a,"Content-Disposition",n$)||ni(t);n(tB(a.response,r,e||tL(r)))},a.open("GET",t),a.responseType="blob",a.send()}),nb=(t,e)=>nu(t)?ng(t,void 0,e):nx(t,e),nv=t=>t instanceof Blob&&!(t instanceof File),nw=async(t,e)=>{if(nt(t)||nv(t))return t;if(ne(t))return await nb(t,e);if(e9(t,"canvas"))return await nn(t);if(e9(t,"img"))return await nc(t);throw new ny("Invalid image source","invalid-image-source")},nk=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return await tr()||e<5?t:eu(t.height,t.width)},nC=t=>{let e,n;let r=new DataView(t);if(65496!==r.getUint16(0))return null;let o=2;for(;o<r.byteLength;){e=r.getUint16(o,!1),n=r.getUint16(o+2,!1)+2;let t=e>=65504&&e<=65519||65534===e;if(!t||o+n>r.byteLength)break;o+=n}return t.slice(0,o)};let nM=(t,e)=>{if(1165519206!==t.getUint32(e+=2,!1))return -1;let n=18761===t.getUint16(e+=6,!1);e+=t.getUint32(e+4,n);let r=t.getUint16(e,n);e+=2;for(let o=0;o<r;o++)if(274===t.getUint16(e+12*o,n))return t.getUint16(e+12*o+8,n)};var nS=t=>{let e;if(!t)return;let n=new DataView(t);if(65496!=n.getUint16(0,!1))return;let r=n.byteLength,o=2;for(;o<r;){if(8>=n.getUint16(o+2,!1))return;if(e=n.getUint16(o,!1),o+=2,65505===e)return nM(n,o);if((65280&e)!=65280)return;o+=n.getUint16(o,!1)}},nA=function(t){let e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!t)return!1;let o=new DataView(t);if(65496!==o.getUint16(0))return!1;let a=2,l=!1;for(;a<o.byteLength;){e=o.getUint16(a,!1),n=o.getUint16(a+2,!1)+2;let t=e>=65504&&e<=65519||65534===e;if(!t||(l||(l=nE(o,a,r)),a+n>o.byteLength))break;a+=n}return l};let nE=(t,e,n)=>{if(1165519206!==t.getUint32(e+4,!1))return;e+=4;let r=18761===t.getUint16(e+=6,!1);e+=t.getUint32(e+4,r);let o=t.getUint16(e,r);e+=2;for(let a=0;a<o;a++)if(274===t.getUint16(e+12*a,r))return t.setUint16(e+12*a+8,n,r),!0;return!1};var nT=t=>/jpeg/.test(t.type),nR=t=>"object"==typeof t&&t.constructor==Object,nI=t=>nR(t)?JSON.stringify(t):t,nP=(t,e,n)=>new Promise((r,o)=>{let{token:a={},beforeSend:l=J,onprogress:s=J}=n;a.cancel=()=>c.abort();let c=new XMLHttpRequest;c.upload.onprogress=s,c.onload=()=>c.status>=200&&c.status<300?r(c):o(c),c.onerror=()=>o(c),c.ontimeout=()=>o(c),c.open("POST",encodeURI(t)),l(c),c.send(e.reduce((t,e)=>(t.append(...e.map(nI)),t),new FormData))}),nD=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return 0===e||(t.translate(n.x,n.y),t.rotate(e),t.translate(-n.x,-n.y)),t},nL=(t,e,n)=>(t.translate(e,n),t),nF=(t,e,n)=>(t.scale(e,n),t),nB=async function(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{flipX:r,flipY:o,rotation:a,crop:l}=n,s=el(t),c=r||o,u=!!a,d=l&&(l.x||l.y||l.width||l.height),h=d&&eU(l,eT(s)),p=d&&!h;if(!c&&!u&&!p)return t;let f=ta("canvas",{width:t.width,height:t.height});if(f.getContext("2d").putImageData(t,0,0),c){let t=ta("canvas",{width:f.width,height:f.height}).getContext("2d");nF(t,r?-1:1,o?-1:1),t.drawImage(f,r?-f.width:0,o?-f.height:0),t.restore(),tc(f),f=t.canvas}if(u){let t=e$(es(eI(eH(eR(f),a))),Math.floor),e=ta("canvas",{width:l.width,height:l.height}).getContext("2d");nL(e,-l.x,-l.y),nD(e,a,ep(t)),e.drawImage(f,(t.width-f.width)*.5,(t.height-f.height)*.5),e.restore(),tc(f),f=e.canvas}else if(p){let t=f.getContext("2d");return e=t.getImageData(l.x,l.y,l.width,l.height),tc(f),e}let g=f.getContext("2d");return e=g.getImageData(0,0,f.width,f.height),tc(f),e},nO=(t,e)=>{let{imageData:n,width:r,height:o}=t,a=n.width,l=n.height,s=Math.round(r),c=Math.round(o),u=n.data,d=new Uint8ClampedArray(s*c*4),h=a/s,p=l/c,f=Math.ceil(.5*h),g=Math.ceil(.5*p);for(let t=0;t<c;t++)for(let e=0;e<s;e++){let n=(e+t*s)*4,r=0,o=0,l=0,c=0,m=0,$=0,y=0,x=(t+.5)*p;for(let n=Math.floor(t*p);n<(t+1)*p;n++){let t=Math.abs(x-(n+.5))/g,s=(e+.5)*h,d=t*t;for(let t=Math.floor(e*h);t<(e+1)*h;t++){let e=Math.abs(s-(t+.5))/f,h=Math.sqrt(d+e*e);if(h>=-1&&h<=1&&(r=2*h*h*h-3*h*h+1)>0){e=4*(t+n*a);let s=u[e+3];y+=r*s,l+=r,s<255&&(r=r*s/250),c+=r*u[e],m+=r*u[e+1],$+=r*u[e+2],o+=r}}}d[n]=c/o,d[n+1]=m/o,d[n+2]=$/o,d[n+3]=y/l}e(null,{data:d,width:s,height:c})},nj=t=>{let e;if(t instanceof ImageData)return t;try{e=new ImageData(t.width,t.height)}catch(r){let n=ta("canvas");e=n.getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},n_=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{width:n,height:r,fit:o,upscale:a}=e;if(!n&&!r)return t;let l=n,s=r;if(n?r||(s=n):l=r,"force"!==o){let e=l/t.width,n=s/t.height,r=1;if("cover"===o?r=Math.max(e,n):"contain"===o&&(r=Math.min(e,n)),r>1&&!1===a)return t;l=Math.round(t.width*r),s=Math.round(t.height*r)}return t.width===l&&t.height===s?t:nj(t=await tk(nO,[{imageData:t,width:l,height:s}],[t.data.buffer]))},nz=(t,e)=>{let{imageData:n,matrix:r}=t;if(!r)return e(null,n);let o=new Uint8ClampedArray(n.width*n.height*4),a=n.data,l=a.length,s=r[0],c=r[1],u=r[2],d=r[3],h=r[4],p=r[5],f=r[6],g=r[7],m=r[8],$=r[9],y=r[10],x=r[11],b=r[12],v=r[13],w=r[14],k=r[15],C=r[16],M=r[17],S=r[18],A=r[19],E=0,T=0,R=0,I=0,P=0,D=0,L=0,F=0,B=0,O=0,j=0,_=0;for(;E<l;E+=4)T=a[E]/255,D=T*s+(R=a[E+1]/255)*c+(I=a[E+2]/255)*u+(P=a[E+3]/255)*d+h,L=T*p+R*f+I*g+P*m+$,F=T*y+R*x+I*b+P*v+w,O=Math.max(0,D*(B=T*k+R*C+I*M+P*S+A))+(1-B),j=Math.max(0,L*B)+(1-B),_=Math.max(0,F*B)+(1-B),o[E]=255*Math.max(0,Math.min(1,O)),o[E+1]=255*Math.max(0,Math.min(1,j)),o[E+2]=255*Math.max(0,Math.min(1,_)),o[E+3]=255*P;e(null,{data:o,width:n.width,height:n.height})},nN=(t,e)=>{let{imageData:n,matrix:r}=t;if(!r)return e(null,n);let o=r.reduce((t,e)=>t+e),a=n.width,l=n.height,s=n.data,c=0,u=0,d=0,h=Math.round(Math.sqrt(r.length)),p=Math.floor(h/2),f=0,g=0,m=0,$=0,y=0,x=0,b=0,v=0,w=0,k=0,C=new Uint8ClampedArray(a*l*4);for(d=0;d<l;d++)for(u=0;u<a;u++){for(x=0,f=0,g=0,m=0,$=0;x<h;x++)for(y=0;y<h;y++)b=d+x-p,v=u+y-p,b<0||b>=l||v<0||v>=a||(w=(b*a+v)*4,k=r[x*h+y],f+=s[w]*k,g+=s[w+1]*k,m+=s[w+2]*k,$+=s[w+3]*k);C[c]=f/o,C[c+1]=g/o,C[c+2]=m/o,C[c+3]=$/o,c+=4}e(null,{data:C,width:a,height:l})},nU=(t,e)=>{let n,r,o;let{imageData:a,strength:l}=t;if(!l)return e(null,a);let s=new Uint8ClampedArray(a.width*a.height*4),c=a.width,u=a.height,d=a.data,h=(t,e)=>Math.sqrt((n=t-m)*n+(r=e-$)*r),p=0,f=0,g=0,m=.5*c,$=.5*u,y=h(0,0);for(g=0;g<u;g++)for(f=0;f<c;f++)p=(f+g*c)*4,o=h(f,g)*l/y,l>0?(s[p]=d[p]*(1-o),s[p+1]=d[p+1]*(1-o),s[p+2]=d[p+2]*(1-o)):(s[p]=d[p]+-(o*(255-d[p])),s[p+1]=d[p+1]+-(o*(255-d[p+1])),s[p+2]=d[p+2]+-(o*(255-d[p+2]))),s[p+3]=d[p+3];e(null,{data:s,width:a.width,height:a.height})},nW=(t,e)=>{let n,r,o,a;let{imageData:l,level:s,monochrome:c=!1}=t;if(!s)return e(null,l);let u=new Uint8ClampedArray(l.width*l.height*4),d=l.data,h=d.length,p=0,f=()=>(-1+2*Math.random())*255*s;for(;p<h;p+=4)c?(n=a=f(),r=a,o=a):(n=f(),r=f(),o=f()),u[p]=d[p]+n,u[p+1]=d[p+1]+r,u[p+2]=d[p+2]+o,u[p+3]=d[p+3];e(null,{data:u,width:l.width,height:l.height})},nX=(t,e)=>{let n,r,o;let{imageData:a,level:l}=t;if(!l)return e(null,a);let s=new Uint8ClampedArray(a.width*a.height*4),c=a.data,u=c.length,d=0;for(;d<u;d+=4)n=c[d]/255,r=c[d+1]/255,o=c[d+2]/255,s[d]=255*Math.pow(n,l),s[d+1]=255*Math.pow(r,l),s[d+2]=255*Math.pow(o,l),s[d+3]=c[d+3];e(null,{data:s,width:a.width,height:a.height})},nV=t=>{let e;let n=t.length,r=n>=20?6:n>=16?5:3;for(let o=0;o<n;o++)if(1===(e=t[o])&&o%r!=0||0!==e&&1!==e)return!1;return!0},nH=async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{colorMatrix:n,convolutionMatrix:r,gamma:o,noise:a,vignette:l}=e,s=[];if(r&&s.push([nN,{matrix:r.clarity}]),o>0&&s.push([nX,{level:1/o}]),n&&!nV(n)&&s.push([nz,{matrix:n}]),(a>0||a<0)&&s.push([nW,{level:a}]),(l>0||l<0)&&s.push([nU,{strength:l}]),!s.length)return t;let c=(t,e)=>"(err, imageData) => {\n            (".concat(t[e][0].toString(),")(Object.assign({ imageData: imageData }, filterInstructions[").concat(e,"]), \n                ").concat(t[e+1]?c(t,e+1):"done",")\n        }"),u="function (options, done) {\n        const filterInstructions = options.filterInstructions;\n        const imageData = options.imageData;\n        (".concat(c(s,0),")(null, imageData)\n    }");return nj(t=await tk(u,[{imageData:t,filterInstructions:s.map(t=>t[1])}],[t.data.buffer]))},nY=t=>"number"==typeof t,nG=t=>ne(t)&&null!==t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g),nK=(t,e)=>t.hasOwnProperty(e),nq=t=>"object"==typeof t;let nZ=t=>nq(t)?nQ(t):t,nQ=t=>{let e;return Array.isArray(t)?(e=[],t.forEach((t,n)=>{e[n]=nZ(t)})):(e={},Object.keys(t).forEach(n=>{let r=t[n];e[n]=nZ(r)})),e};var nJ=t=>"function"==typeof t,n0=t=>Array.isArray(t);let n1=null;var n2=()=>(null===n1&&(n1=tn()&&/^mac/i.test(navigator.platform)),n1);let n4=null;var n5=()=>(null===n4&&(n4=tn()&&(nd(/iPhone|iPad|iPod/)||n2()&&navigator.maxTouchPoints>=1)),n4),n3=()=>n5()||n2(),n6=()=>/^win/i.test(navigator.platform);let n8=64,n7=102,n9=112,it=!1;var ie=(t,e)=>(!it&&tn()&&(n6()&&(n7=103),n3()&&(n8=63.5,n7=110,n9=123),it=!0),"<svg".concat(e?' aria-label="'.concat(e,'"'):"",' width="128" height="128" viewBox="0 0 128 128" preserveAspectRatio="xMinYMin meet" xmlns="http://www.w3.org/2000/svg"><text x="').concat(n8,'" y="').concat(n7,'" alignment-baseline="text-top" dominant-baseline="text-top" text-anchor="middle" font-size="').concat(n9,'px">').concat(t,"</text></svg>")),ii=t=>"data:image/svg+xml,".concat(t.replace("<","%3C").replace(">","%3E")),ir=t=>t instanceof Blob,io=(t,e)=>"".concat(t/e*100,"%"),ia=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return new Promise((n,r)=>{let o=t,a=!1,l=()=>{!a&&(a=!0,nJ(e)&&Promise.resolve().then(()=>e(eu(o.naturalWidth,o.naturalHeight))))};if(o.src||((o=new Image).src=ne(t)?t:URL.createObjectURL(t)),o.complete)return l(),n(o);nJ(e)&&na(o).then(l).catch(r),o.onload=()=>{l(),n(o)},o.onerror=r})},il=t=>"rgba(".concat(Math.round(255*t[0]),", ").concat(Math.round(255*t[1]),", ").concat(Math.round(255*t[2]),", ").concat(nY(t[3])?t[3]:1,")");let is=t=>{if(!d){let t=ic(32,32);iu(t,{fontSize:100,color:"#fff"}),t.fillText("F",0,0);let e=t.getImageData(0,0,32,32).data,n=0,r=4,o=e.length,a=o-128;for(n=a;n<o&&!e[n];n+=r);let l=(n-a)/r;for(r=128,n=a=124;n<o&&!e[n];n+=r);let s=(n-a)/r;d=tH(l,s),tc(t.canvas)}return tH(-d.x*t*.01,-d.y*t*.01)},ic=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=ta("canvas"),r=n.getContext("2d");return r.canvas.width=t,r.canvas.height=e,r},iu=(t,e)=>{let{fontSize:n=16,fontFamily:r="sans-serif",fontWeight:o="normal",fontVariant:a="normal",fontStyle:l="normal",textAlign:s="left",color:c="#000"}=e;t.font="".concat(l," ").concat(a," ").concat(o," ").concat(n,"px ").concat(r),t.textBaseline="top",t.textAlign=s,t.fillStyle=Array.isArray(c)?il(c):c},id=t=>{let e=ic();return iu(e,t),e},ih=(t,e)=>nJ(e)?e(t):e,ip=t=>Math.abs(t.actualBoundingBoxLeft)+Math.abs(t.actualBoundingBoxRight),ig=(t,e,n)=>{let{width:r,height:o}=im(t,e,ih(n.fontSize,n.lineHeight));return t.canvas.width=Math.ceil(r),t.canvas.height=Math.ceil(o),t},im=(t,e,n)=>{let r=t.textAlign;t.textAlign="left";let o=e.split("\n"),a=o.reduce((e,n)=>{let r=ip(t.measureText(n));return r>e&&(e=r),e},1);t.textAlign=r;let l=n*o.length;return eu(Math.ceil(a),Math.ceil(l))},i$=new Map,iy=(t,e)=>{let{fontSize:n,fontFamily:r,lineHeight:o,fontWeight:a,fontStyle:l,fontVariant:s}=e;return"".concat([t,n,a,l,s,r].join("_"),"_").concat(nJ(o)?o(n):o)},ix=(t,e)=>{let n=id(e);e.width&&(t=ib(n,t,e.width));let r=iy(t,e),o=i$.get(r);return o||(o=im(n,t,ih(e.fontSize,e.lineHeight)),i$.set(r,o)),{...o}},ib=(t,e,n)=>{if(0===e.length)return"";let r=[],o="",a=0,l=e.split("\n\n"),s=()=>{o.length&&(r[a]||(r[a]=[]),r[a].push(o),o="")},c=e=>{let r=o+e;t.measureText(r).width<n?o=r:(o.length?(s(),o=e):(o=r,s()),a++)},u=e=>{let r=o.length?o+" "+e:e;t.measureText(r).width<n?o=r:o.length?(s(),a++,u(e)):e.split("").forEach(c)};return l.forEach(t=>{let e=t.split("\n");e.forEach(t=>{t.split(" ").forEach(u),o.length&&s(),a++}),a++}),r.map(t=>t.join(" ")).join("\n")},iv=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0===e.length)return t;let{x:r=0,y:o=0,lineWidth:a=0,textAlign:l,fontSize:s,lineHeight:c}=n,u=t6(is(s),tH(s/12,s/3.75)),d=r+u.x,h=o+u.y,p=nJ(c)?c(s):c,f="right"===l?a:"center"===l?.5*a:0;return e.split("\n").forEach((e,n)=>{t.fillText(e,d+f,h+n*p)}),t},iw=(t,e)=>{let n=t.width/t.height,r=eq(e,n);return(t.width>r.width||t.height>r.height)&&(t.width=r.width,t.height=r.height),t},ik=(t,e)=>(t.x=e.x-.5*t.width,t.y=e.y-.5*t.height,t),iC=t=>{let e={...t};e.backgroundImageElement=void 0;let n=nQ(e);return t.backgroundImageElement&&(n.backgroundImageElement=t.backgroundImageElement),n},iM=function(t){let e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=eW(t);if(r.width&&r.height)return ea(r);if(r.width||r.height){e=parseFloat(r.width||Number.MAX_SAFE_INTEGER),n=parseFloat(r.height||Number.MAX_SAFE_INTEGER);let t=Math.min(e,n);ne(r.width)||ne(r.height)?(e="".concat(t,"%"),n="".concat(t*o,"%")):(e=t,n=t)}else e="".concat(10,"%"),n="".concat(10*o,"%");return{width:e,height:n}},iS=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{width:void 0,height:void 0,...e,aspectRatio:1,backgroundImage:ii(ie(t))}},iA=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r={width:void 0,height:void 0,aspectRatio:void 0,backgroundColor:[0,0,0,0],...n,backgroundImage:ne(t)?t:URL.createObjectURL(t)};return iE(r,e)},iE=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:J;if(t.backgroundImage){if(t.isComplete)return e(t.isError,t),t;if(t.isLoading)return t;t.isComplete=!1,t.isError=!1,t.isLoading=!0,ia(t.backgroundImage,e=>{if(t.backgroundSize)return;let n=e.width/e.height,r=t.width||e.width,o=r/n;t.width=r,t.height=o,t.aspectRatio=e.width/e.height}).then(e=>{t.backgroundImageElement=e}).catch(e=>{t.isError=e}).finally(()=>{t.isLoading=!1,t.isComplete=!0,e(t.isError,t)})}return t},iT=(t,e,n)=>{let r;if(ne(t)||ir(t))nG(t)?(r=iS(t,iM(e)),setTimeout(()=>n(void 0,r),0)):r=iA(t,n,{...iM(e)});else if(t.src){let o={...t.shape,...iM(e,t.shape||t)};nG(t.src)?(r=iS(t.src,o),setTimeout(()=>n(void 0,r),0)):ne(t.src)&&(r=iA(t.src,n,o))}else t.shape&&(r=iC(t.shape));return nK(r,"backgroundImage")&&(nK(r,"backgroundColor")||(r.backgroundColor=[0,0,0,0]),nK(r,"disableStyle")||(r.disableStyle=!0),nK(r,"disableFlip")||(r.disableFlip=!0)),e?rb(r,e):r},iR=t=>tH(t.x1,t.y1),iI=t=>tH(t.x2,t.y2),iP=t=>{let{text:e,textAlign:n,fontSize:r,fontFamily:o,lineHeight:a,fontWeight:l,fontStyle:s,fontVariant:c}=t;return"".concat([e,n,r,l,s,c,o].join("_"),"_").concat(nJ(a)?a(r):a)},iD=t=>nK(t,"text"),iL=t=>iD(t)&&!(iq(t)||nK(t,"width")),iF=t=>iD(t)&&(iq(t)||nK(t,"width")),iB=t=>!iD(t)&&iZ(t),iO=t=>nK(t,"rx"),ij=t=>nK(t,"x1")&&!i_(t),i_=t=>nK(t,"x3"),iz=t=>nK(t,"points"),iN=t=>iD(t)&&!t.text.length,iU=t=>iD(t)&&t.isEditing,iW=t=>!nK(t,"opacity")||t.opacity>0,iX=t=>t.isSelected,iV=t=>t.isDraft,iH=t=>nK(t,"width")&&nK(t,"height"),iY=t=>nY(t.strokeWidth)&&t.strokeWidth>0,iG=t=>{let e=nK(t,"right"),n=nK(t,"bottom");return e||n},iK=t=>nK(t,"backgroundImage")||nK(t,"text"),iq=t=>(nK(t,"x")||nK(t,"left"))&&nK(t,"right")||(nK(t,"y")||nK(t,"top"))&&nK(t,"bottom"),iZ=t=>iH(t)||iq(t),iQ=t=>(t.isSelected=!0,t),iJ=t=>(t.isDraft=!0,t),i0=(t,e)=>!0!==t.disableStyle&&(!n0(t.disableStyle)||!t.disableStyle.includes(e)),i1=t=>!0!==t.disableErase,i2=t=>!0!==t.disableSelect&&!iz(t)&&!i_(t),i4=t=>!0!==t.disableRemove,i5=t=>!0!==t.disableDuplicate&&i7(t),i3=t=>!0!==t.disableReorder,i6=t=>!(t.disableFlip||iV(t)||iG(t))&&iK(t),i8=(t,e)=>!!iD(t)&&!0!==t.disableInput&&(nJ(t.disableInput)?t.disableInput(null!=e?e:t.text):e||!0),i7=t=>!0!==t.disableMove&&!iV(t)&&!iz(t)&&!iG(t),i9=t=>!0!==t.disableResize&&!iV(t)&&(iH(t)||iF(t)||iO(t)||ij(t))&&!iG(t)&&i7(t),rt=t=>!0!==t.disableRotate&&!iV(t)&&(iH(t)||nK(t,"text")||iO(t))&&!iG(t),re=t=>(delete t.left,delete t.right,delete t.top,delete t.bottom,t),rn=t=>(delete t.rotation,t),ri=t=>(t.strokeWidth=t.strokeWidth||1,t.strokeColor=t.strokeColor||[0,0,0],t),rr=t=>(t.backgroundColor=t.backgroundColor?t.backgroundColor:t.strokeWidth||t.backgroundImage?void 0:[0,0,0],t),ro=t=>1.2*t,ra=t=>(t.fontSize=t.fontSize||16,t.fontFamily=t.fontFamily||"sans-serif",t.fontWeight=t.fontWeight||"normal",t.fontStyle=t.fontStyle||"normal",t.fontVariant=t.fontVariant||"normal",t.lineHeight=nY(t.lineHeight)?t.lineHeight:ro,t.color=t.color||[0,0,0],iL(t)?rl(t):rs(t)),rl=t=>(delete t.textAlign,re(t)),rs=t=>(t.textAlign=t.textAlign||"left",t),rc=t=>(t.cornerRadius=t.cornerRadius||0,t.strokeWidth=t.strokeWidth||0,t.strokeColor=t.strokeColor||[0,0,0],rr(t)),ru=t=>(t.strokeWidth=t.strokeWidth||0,t.strokeColor=t.strokeColor||[0,0,0],rr(t),re(t)),rd=t=>(t.strokeWidth=t.strokeWidth||0,t.strokeColor=t.strokeColor||[0,0,0],rr(t)),rh=t=>(ri(t),rn(t),re(t)),rp=t=>(ri(t),t.lineStart=t.lineStart||void 0,t.lineEnd=t.lineEnd||void 0,rn(t),re(t)),rf=t=>{ne(t.id)||(t.id=tx()),nK(t,"rotation")||(t.rotation=0),nK(t,"opacity")||(t.opacity=1),nK(t,"disableErase")||(t.disableErase=!0)},rg=t=>(rf(t),iD(t)?ra(t):iB(t)?rc(t):iz(t)?rh(t):ij(t)?rp(t):iO(t)?rd(t):i_(t)&&ru(t),iE(t),t),rm=t=>iD(t)?"text":iB(t)?"rectangle":iz(t)?"path":ij(t)?"line":iO(t)?"ellipse":i_(t)?"triangle":void 0,r$=(t,e)=>parseFloat(t)/100*e,ry=(t,e,n)=>{let{width:r,height:o}=n;if(!nK(t,e))return;let a=t[e];if(/points/.test(e)){let n=t[e];if(!ne(n[0].x))return;t[e]=n.map(t=>tH(r$(t.x,r),r$(t.y,o)))}else if(ne(a)){let n=parseFloat(a)/100;/^x|left|width|rx|fontSize|cornerRadius|strokeWidth/.test(e)?t[e]=r*n:/^right/.test(e)?t[e]=r-r*n:/^y|top|height|ry/.test(e)?t[e]=o*n:/^bottom/.test(e)&&(t[e]=o-o*n)}},rx=["width","height","left","top","right","bottom","x","y","rx","ry","points","fontSize","strokeWidth","lineHeight","x1","y1","x2","y2","x3","y3"],rb=(t,e)=>(rx.forEach(n=>ry(t,n,e)),rS(t,e),t),rv=(t,e)=>{let n;return/^x|width|rx|fontSize|strokeWidth|cornerRadius/.test(t)?n=e.width:/^y|height|ry/.test(t)&&(n=e.height),n},rw=(t,e,n,r)=>{if(!ne(t[e]))return t[e]=n;let o=rv(e,r);return t[e]=io(n,o),t},rk=(t,e,n)=>ne(t[e])?r$(t[e],rv(e,n)):t[e],rC=(t,e,n)=>e.reduce((e,r)=>{let o=rk(t,r,n);return e[r]=o,e},{}),rM=(t,e,n)=>(Object.keys(e).forEach(r=>rw(t,r,e[r],n)),t),rS=(t,e)=>{if(nK(t,"left")&&(t.x=t.left),nK(t,"right")){let n=e.width-t.right;nK(t,"left")?(t.x=t.left,t.width=Math.max(0,n-t.left)):nK(t,"width")&&(t.x=n-t.width)}if(nK(t,"top")&&(t.y=t.top),nK(t,"bottom")){let n=e.height-t.bottom;nK(t,"top")?(t.y=t.top,t.height=Math.max(0,n-t.top)):nK(t,"height")&&(t.y=n-t.height)}return t},rA=(t,e,n)=>(iz(t)&&t.points.filter(t=>nY(t.x)).forEach(t=>{t.x*=n,t.y*=n,t.x+=e.x,t.y+=e.y}),i_(t)&&nY(t.x1)&&(t.x1*=n,t.y1*=n,t.x2*=n,t.y2*=n,t.x3*=n,t.y3*=n,t.x1+=e.x,t.y1+=e.y,t.x2+=e.x,t.y2+=e.y,t.x3+=e.x,t.y3+=e.y),ij(t)&&nY(t.x1)&&(t.x1*=n,t.y1*=n,t.x2*=n,t.y2*=n,t.x1+=e.x,t.y1+=e.y,t.x2+=e.x,t.y2+=e.y),nY(t.x)&&nY(t.y)&&(t.x*=n,t.y*=n,t.x+=e.x,t.y+=e.y),nY(t.width)&&nY(t.height)&&(t.width*=n,t.height*=n),nY(t.rx)&&nY(t.ry)&&(t.rx*=n,t.ry*=n),iY(t)&&(t.strokeWidth*=n),iD(t)&&nY(t.fontSize)&&(t.fontSize*=n,nY(t.width)&&(t.width*=n)),nK(t,"cornerRadius")&&nY(t.cornerRadius)&&(t.cornerRadius*=n),t),rE=t=>{if(iB(t))return tH(t.x+.5*t.width,t.y+.5*t.height);if(iO(t))return tH(t.x,t.y);if(iF(t)){let e=t.height||ix(t.text,t).height;return tH(t.x+.5*t.width,t.y+.5*e)}if(iL(t)){let e=ix(t.text,t);return tH(t.x+.5*e.width,t.y+.5*e.height)}return iz(t)?en(t.points):ij(t)?en([iR(t),iI(t)]):void 0},rT=(t,e,n,r,o)=>{let a={},l=/solid/.test(r),s=5*e,c=l?s:s-1,u=l?.5*c:Math.ceil(.5*c),d=t1(o),h=t7(tq(d),u),p=tq(t),f=tq(t);if(/arrow/.test(r)){let r=t.x,o=t.y,c=t7(tq(d),s),p=tH(r+c.x,o+c.y);if(t7(c,.55),l){let t=t7(tq(d),.5*u);r-=t.x,o-=t.y,a={points:[tH(r,o),tH(p.x-c.y,p.y+c.x),tH(p.x+c.y,p.y-c.x)],backgroundColor:n},f.x+=h.x,f.y+=h.y}else{let t=t7(tQ(tq(d)),.5),l=tH(r-t.x,o-t.y),s=tH(r+t.x,o+t.y);a={points:[tH(p.x+c.y,p.y-c.x),l,tH(r,o),s,tH(p.x-c.y,p.y+c.x)],strokeWidth:e,strokeColor:n}}}else/circle/.test(r)?(f.x+=h.x,f.y+=h.y,a={x:p.x,y:p.y,rx:u,ry:u,backgroundColor:l?n:void 0,strokeWidth:l?void 0:e,strokeColor:l?void 0:n}):/square/.test(r)?(f.x+=h.x,f.y+=h.y,a={x:p.x-u,y:p.y-u,width:2*u,height:2*u,rotation:t2(d),backgroundColor:l?n:void 0,strokeWidth:l?void 0:e,strokeColor:l?void 0:n}):"bar"===r&&(a={points:[tH(p.x-h.y,p.y+h.x),tH(p.x+h.y,p.y-h.x)],strokeWidth:e,strokeColor:n});return{position:f,shape:a}};var rR=(t,e,n,r,o,a)=>(r<2*a&&(a=r/2),o<2*a&&(a=o/2),t.beginPath(),t.moveTo(e+a,n),t.arcTo(e+r,n,e+r,n+o,a),t.arcTo(e+r,n+o,e,n+o,a),t.arcTo(e,n+o,e,n,a),t.arcTo(e,n,e+r,n,a),t.closePath(),t);let rI=(t,e)=>(e.cornerRadius>0?rR(t,e.x,e.y,e.width,e.height,e.cornerRadius):t.rect(e.x,e.y,e.width,e.height),t),rP=(t,e)=>(e.backgroundColor&&t.fill(),t),rD=(t,e)=>(e.strokeWidth&&t.stroke(),t);var rL=async(t,e)=>new Promise((n,r)=>{t.lineWidth=e.strokeWidth?e.strokeWidth:1,t.strokeStyle=e.strokeColor?il(e.strokeColor):"none",t.fillStyle=e.backgroundColor?il(e.backgroundColor):"none",t.globalAlpha=e.opacity,e.backgroundImage?iE(e,(e,o)=>{if(e)return r(e);let a=0,l=0,s=o.backgroundImageElement.naturalWidth,c=o.backgroundImageElement.naturalHeight,u=o.x,d=o.y,h=o.width,p=o.height;if("contain"===o.backgroundSize){let t=eq(o,s/c);h=t.width,p=t.height,u+=t.x,d+=t.y}else if("cover"===o.backgroundSize){let t=eq(eL(0,0,s,c),h/p);s=t.width,c=t.height,a=t.x,l=t.y}rI(t,o),rP(t,o),t.save(),t.clip(),t.drawImage(o.backgroundImageElement,a,l,s,c,u,d,h,p),t.restore(),rD(t,o),n([])}):(rI(t,e),rP(t,e),rD(t,e),n([]))}),rF=async(t,e)=>new Promise((n,r)=>{t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?il(e.strokeColor):"none",t.fillStyle=e.backgroundColor?il(e.backgroundColor):"none",t.globalAlpha=e.opacity,t.ellipse(e.x,e.y,e.rx,e.ry,0,0,2*Math.PI),e.backgroundColor&&t.fill(),e.backgroundImage?iE(e,(o,a)=>{if(o)return r(o);t.drawImage(a.backgroundImageElement,e.x,e.y,e.width,e.height),e.strokeWidth&&t.stroke(),n([])}):e.strokeWidth&&t.stroke(),n([])}),rB=async(t,e)=>{let n=e.width&&e.height?el(e):ix(e.text,e),r={x:e.x,y:e.y,width:e.width||n.width,height:n.height};rL(t,{...e,...r}),iu(t,e);let o=0;return"center"==e.textAlign?o=-10:"right"===e.textAlign&&(o=-20),t.rect(e.x+o,e.y,e.width+40,e.height),t.save(),t.clip(),iv(t,e.width?ib(t,e.text,e.width):e.text,{x:e.x,y:e.y,fontSize:e.fontSize,textAlign:e.textAlign,lineHeight:e.lineHeight,lineWidth:e.width}),t.restore(),[]},rO=async(t,e)=>new Promise(async(n,r)=>{t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?il(e.strokeColor):"none",t.globalAlpha=e.opacity;let o=iR(e),a=iI(e),l=e.lineStart&&rT(o,e.strokeWidth,e.strokeColor,e.lineStart,tH(a.x-o.x,a.y-o.y)),s=e.lineEnd&&rT(a,e.strokeWidth,e.strokeColor,e.lineEnd,tH(o.x-a.x,o.y-a.y));o=l?l.position:o,a=s?s.position:a,t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),e.strokeWidth&&t.stroke(),n([l&&l.shape,s&&s.shape].filter(Boolean))}),rj=async(t,e)=>new Promise((n,r)=>{t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?il(e.strokeColor):"none",t.fillStyle=e.backgroundColor?il(e.backgroundColor):"none",t.globalAlpha=e.opacity;let{points:o}=e;t.moveTo(o[0].x,o[0].y);let a=o.length;for(let e=1;e<a;e++)t.lineTo(o[e].x,o[e].y);e.strokeWidth&&t.stroke(),e.backgroundColor&&t.fill(),n([])}),r_=(t,e,n,r)=>((e||n)&&(t.translate(r.x,r.y),t.scale(e?-1:1,n?-1:1),t.translate(-r.x,-r.y)),t);let rz=async(t,e)=>{let n;let r=rE(e);return nD(t,e.rotation,r),r_(t,e.flipX,e.flipY,r),iB(e)?n=rL:iO(e)?n=rF:ij(e)?n=rO:iz(e)?n=rj:iD(e)&&(n=rB),[e,...await rN(t,await n(t,e))]};var rN=async(t,e)=>{let n=[];for(let r of e)t.save(),t.beginPath(),n=[...n,...await rz(t,r)],t.restore();return n},rU=async function(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{shapes:r=[],context:o=t,transform:a=J}=n;if(!r.length)return t;let l=ta("canvas");l.width=t.width,l.height=t.height;let s=l.getContext("2d");s.putImageData(t,0,0);let c=r.map(iC).map(t=>rb(t,{x:0,y:0,width:o.width,height:o.height}));return a(s),await rN(s,c),e=s.getImageData(0,0,l.width,l.height),tc(l),e},rW=async function(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{backgroundColor:r}=n;if(!r||r&&0===r[3])return t;let o=ta("canvas");o.width=t.width,o.height=t.height;let a=o.getContext("2d");return a.putImageData(t,0,0),a.globalCompositeOperation="destination-over",a.fillStyle=il(r),a.fillRect(0,0,o.width,o.height),e=a.getImageData(0,0,o.width,o.height),tc(o),e},rX=(t,e)=>{let n=Array(20);return n[0]=t[0]*e[0]+t[1]*e[5]+t[2]*e[10]+t[3]*e[15],n[1]=t[0]*e[1]+t[1]*e[6]+t[2]*e[11]+t[3]*e[16],n[2]=t[0]*e[2]+t[1]*e[7]+t[2]*e[12]+t[3]*e[17],n[3]=t[0]*e[3]+t[1]*e[8]+t[2]*e[13]+t[3]*e[18],n[4]=t[0]*e[4]+t[1]*e[9]+t[2]*e[14]+t[3]*e[19]+t[4],n[5]=t[5]*e[0]+t[6]*e[5]+t[7]*e[10]+t[8]*e[15],n[6]=t[5]*e[1]+t[6]*e[6]+t[7]*e[11]+t[8]*e[16],n[7]=t[5]*e[2]+t[6]*e[7]+t[7]*e[12]+t[8]*e[17],n[8]=t[5]*e[3]+t[6]*e[8]+t[7]*e[13]+t[8]*e[18],n[9]=t[5]*e[4]+t[6]*e[9]+t[7]*e[14]+t[8]*e[19]+t[9],n[10]=t[10]*e[0]+t[11]*e[5]+t[12]*e[10]+t[13]*e[15],n[11]=t[10]*e[1]+t[11]*e[6]+t[12]*e[11]+t[13]*e[16],n[12]=t[10]*e[2]+t[11]*e[7]+t[12]*e[12]+t[13]*e[17],n[13]=t[10]*e[3]+t[11]*e[8]+t[12]*e[13]+t[13]*e[18],n[14]=t[10]*e[4]+t[11]*e[9]+t[12]*e[14]+t[13]*e[19]+t[14],n[15]=t[15]*e[0]+t[16]*e[5]+t[17]*e[10]+t[18]*e[15],n[16]=t[15]*e[1]+t[16]*e[6]+t[17]*e[11]+t[18]*e[16],n[17]=t[15]*e[2]+t[16]*e[7]+t[17]*e[12]+t[18]*e[17],n[18]=t[15]*e[3]+t[16]*e[8]+t[17]*e[13]+t[18]*e[18],n[19]=t[15]*e[4]+t[16]*e[9]+t[17]*e[14]+t[18]*e[19]+t[19],n},rV=t=>t.length?t.reduce((t,e)=>rX([...t],e),t.shift()):[];let rH=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return e},n=arguments.length>2?arguments[2]:void 0;return async(r,o,a)=>{let l;a(Q(0,!1));let s=!1;try{l=await t(...e(r,o,t=>{s=!0,a(t)}))}catch(t){throw t}return n&&n(r,l),s||a(Q(1,!1)),r}},rY=function(){let{srcProp:t="src",destProp:e="dest"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(nw,(e,n,r)=>[e[t],r],(t,n)=>t[e]=n),"any-to-file"]},rG=function(){let{srcProp:t="src",destProp:e="size"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(nl,(e,n)=>[e[t]],(t,n)=>t[e]=n),"read-image-size"]},rK=function(){let{srcSize:t="size",srcOrientation:e="orientation",destSize:n="size"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(nk,n=>[n[t],n[e]],(t,e)=>t[n]=e),"image-size-match-orientation"]},rq=function(){let{srcProp:t="src",destProp:e="head"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH((t,e)=>nT(t)?tA(t,e):void 0,e=>[e[t],[0,65536],onprogress],(t,n)=>t[e]=n),"read-image-head"]},rZ=function(){let{srcProp:t="head",destProp:e="orientation"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(nS,e=>[e[t]],(t,n)=>t[e]=n),"read-exif-orientation-tag"]},rQ=function(){let{srcProp:t="head"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(nA,e=>[e[t],1]),"clear-exif-orientation-tag"]},rJ=function(){let{srcImageSize:t="size",srcCanvasSize:e="imageData",srcImageState:n="imageState",destImageSize:r="size",destScalar:o="scalar"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH((t,e,n)=>{let r=Math.min(e.width/t.width,e.height/t.height);if(1!==r){let{crop:t,annotation:e,decoration:o}=n,a=tV();t&&(n.crop=eO(t,r,a));let l=tV();n.annotation=e.map(t=>rA(t,l,r)),n.decoration=o.map(t=>rA(t,l,r))}return[r,el(e)]},r=>[r[t],r[e],r[n]],(t,e)=>{let[n,a]=e;t[o]=n,t[r]=a}),"calculate-canvas-scalar"]},r0=t=>{let{srcProp:e="src",destProp:n="imageData",canvasMemoryLimit:r}=t;return[rH(tC,t=>[t[e],r],(t,e)=>t[n]=e),"blob-to-image-data"]},r1=function(){let{srcImageData:t="imageData",srcOrientation:e="orientation"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(th,n=>[n[t],n[e]],(t,e)=>t.imageData=e),"image-data-match-orientation"]},r2=function(){let{srcImageData:t="imageData",srcImageState:e="imageState"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(rW,n=>[n[t],{backgroundColor:n[e].backgroundColor}],(t,e)=>t.imageData=e),"image-data-fill"]},r4=function(){let{srcImageData:t="imageData",srcImageState:e="imageState"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(nB,n=>[n[t],{crop:n[e].crop,rotation:n[e].rotation,flipX:n[e].flipX,flipY:n[e].flipY}],(t,e)=>t.imageData=e),"image-data-crop"]},r5=t=>{let{resize:e={width:void 0,height:void 0,fit:void 0,upscale:void 0},srcProp:n="imageData",srcImageState:r="imageState",destImageScaledSize:o="imageScaledSize"}=t;return[rH(n_,t=>[t[n],{width:Math.min(e.width||Number.MAX_SAFE_INTEGER,t[r].targetSize&&t[r].targetSize.width||Number.MAX_SAFE_INTEGER),height:Math.min(e.height||Number.MAX_SAFE_INTEGER,t[r].targetSize&&t[r].targetSize.height||Number.MAX_SAFE_INTEGER),fit:e.fit||"contain",upscale:e.upscale||!1}],(t,e)=>{ed(t.imageData,e)||(t[o]=el(e)),t.imageData=e}),"image-data-resize"]},r3=function(){let{srcImageData:t="imageData",srcImageState:e="imageState",destImageData:n="imageData"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(nH,n=>{let{colorMatrix:r}=n[e],o=r&&Object.keys(r).map(t=>r[t]).filter(Boolean);return[n[t],{colorMatrix:o&&rV(o),convolutionMatrix:n[e].convolutionMatrix,gamma:n[e].gamma,noise:n[e].noise,vignette:n[e].vignette}]},(t,e)=>t[n]=e),"image-data-filter"]},r6=function(){let{srcImageData:t="imageData",srcSize:e="size",srcImageState:n="imageState",destImageData:r="imageData",destImageScaledSize:o="imageScaledSize"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(rU,r=>[r[t],{shapes:r[n].annotation,context:r[e],transform:t=>{let a=r[e],{crop:l=eT(a),rotation:s=0,flipX:c,flipY:u}=r[n],d=e7(a,s),h={width:d.width,height:d.height},p=r[o],f=p?Math.min(p.width/l.width,p.height/l.height):1,g=.5*a.width-.5*h.width,m=.5*a.height-.5*h.height,$=ep(a);t.scale(f,f),t.translate(-g,-m),t.translate(-l.x,-l.y),t.translate($.x,$.y),t.rotate(s),t.translate(-$.x,-$.y),t.scale(c?-1:1,u?-1:1),t.translate(c?-a.width:0,u?-a.height:0),t.rect(0,0,a.width,a.height),t.clip()}}],(t,e)=>t[r]=e),"image-data-annotate"]},r8=function(){let{srcImageData:t="imageData",srcImageState:e="imageState",destImageData:n="imageData",destImageScaledSize:r="imageScaledSize"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(rU,n=>[n[t],{shapes:n[e].decoration,context:n[e].crop,transform:t=>{let{crop:e}=n.imageState,o=n[r],a=o?Math.min(o.width/e.width,o.height/e.height):1;t.scale(a,a)}}],(t,e)=>t[n]=e),"image-data-decorate"]},r7=function(){let{mimeType:t,quality:e,srcImageData:n="imageData",srcFile:r="src",destBlob:o="blob"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(tS,o=>[o[n],t||tL(o[r].name)||o[r].type,e],(t,e)=>t[o]=e),"image-data-to-blob"]},r9=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"blob",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"head",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"blob";return[rH((t,e)=>nT(t)&&e?tE(t,nC(e),[20]):t,n=>[n[t],n[e]],(t,e)=>t[n]=e),"blob-write-image-head"]},ot=function(){let{renameFile:t,srcBlob:e="blob",srcFile:n="src",destFile:r="dest",defaultFilename:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return[rH(tB,r=>[r[e],t?t(r[n]):r[n].name||"".concat(o,".").concat(tT(r[e].type))],(t,e)=>t[r]=e),"blob-to-file"]},oe=t=>{let{url:e="./",dataset:n=t=>[["dest",t.dest,t.dest.name],["imageState",t.imageState]],destStore:r="store"}=t;return[rH(async(t,n)=>{try{return await nP(e,t,{onprogress:n})}catch(t){throw t}},(t,e,r)=>[n(t),r],(t,e)=>t[r]=e),"store"]},on=t=>[rH(e=>(t&&t.length&&Object.keys(e).forEach(n=>{t.includes(n)||delete e[n]}),e)),"prop-filter"];function oi(){}let or=t=>t;function oo(t,e){for(let n in e)t[n]=e[n];return t}function oa(t){return t()}function ol(){return Object.create(null)}function os(t){t.forEach(oa)}function oc(t){return"function"==typeof t}function ou(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function od(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(null==t)return oi;let o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}function oh(t){let e;return od(t,t=>e=t)(),e}function op(t,e,n){t.$$.on_destroy.push(od(e,n))}function of(t,e,n,r){if(t){let o=og(t,e,n,r);return t[0](o)}}function og(t,e,n,r){return t[1]&&r?oo(n.ctx.slice(),t[1](r(e))):n.ctx}function om(t,e,n,r,o,a,l){let s=function(t,e,n,r){if(t[2]&&r){let o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){let t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}(e,r,o,a);if(s){let o=og(e,n,r,l);t.p(o,s)}}function o$(t){let e={};for(let n in t)"$"!==n[0]&&(e[n]=t[n]);return e}function oy(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return t.set(n),e}function ox(t){return t&&oc(t.destroy)?t.destroy:oi}let ob=()=>window.performance.now(),ov=t=>requestAnimationFrame(t),ow=new Set;function ok(t){ow.forEach(e=>{e.c(t)||(ow.delete(e),e.f())}),0!==ow.size&&ov(ok)}function oC(t){let e;return 0===ow.size&&ov(ok),{promise:new Promise(n=>{ow.add(e={c:t,f:n})}),abort(){ow.delete(e)}}}function oM(t,e){t.appendChild(e)}function oS(t,e,n){t.insertBefore(e,n||null)}function oA(t){t.parentNode.removeChild(t)}function oE(t){return document.createElement(t)}function oT(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function oR(t){return document.createTextNode(t)}function oI(){return oR(" ")}function oP(){return oR("")}function oD(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function oL(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function oF(t,e){let n=Object.getOwnPropertyDescriptors(t.__proto__);for(let r in e)null==e[r]?t.removeAttribute(r):"style"===r?t.style.cssText=e[r]:"__value"===r?t.value=t[r]=e[r]:n[r]&&n[r].set?t[r]=e[r]:oL(t,r,e[r])}function oB(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function oO(t,e){let n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}let oj=new Set,o_=0;function oz(t,e,n,r,o,a,l){let s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,c=16.666/r,u="{\n";for(let t=0;t<=1;t+=c){let r=e+(n-e)*a(t);u+=100*t+"%{".concat(l(r,1-r),"}\n")}let d=u+"100% {".concat(l(n,1-n),"}\n}"),h="__svelte_".concat(function(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}(d),"_").concat(s),p=t.ownerDocument;oj.add(p);let f=p.__svelte_stylesheet||(p.__svelte_stylesheet=p.head.appendChild(oE("style")).sheet),g=p.__svelte_rules||(p.__svelte_rules={});g[h]||(g[h]=!0,f.insertRule("@keyframes ".concat(h," ").concat(d),f.cssRules.length));let m=t.style.animation||"";return t.style.animation="".concat(m?"".concat(m,", "):"").concat(h," ").concat(r,"ms linear ").concat(o,"ms 1 both"),o_+=1,h}function oN(){if(!r)throw Error("Function called outside component initialization");return r}function oU(t){oN().$$.on_mount.push(t)}function oW(t){oN().$$.on_destroy.push(t)}function oX(){let t=oN();return(e,n)=>{let r=t.$$.callbacks[e];if(r){let o=oO(e,n);r.slice().forEach(e=>{e.call(t,o)})}}}function oV(t,e){oN().$$.context.set(t,e)}function oH(t){return oN().$$.context.get(t)}function oY(t,e){let n=t.$$.callbacks[e.type];n&&n.slice().forEach(t=>t(e))}let oG=[],oK=[],oq=[],oZ=[],oQ=Promise.resolve(),oJ=!1;function o0(t){oq.push(t)}function o1(t){oZ.push(t)}let o2=!1,o4=new Set;function o5(){if(!o2){o2=!0;do{for(let t=0;t<oG.length;t+=1){let e=oG[t];r=e,function(t){if(null!==t.fragment){t.update(),os(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(o0)}}(e.$$)}for(r=null,oG.length=0;oK.length;)oK.pop()();for(let t=0;t<oq.length;t+=1){let e=oq[t];o4.has(e)||(o4.add(e),e())}oq.length=0}while(oG.length);for(;oZ.length;)oZ.pop()();oJ=!1,o2=!1,o4.clear()}}function o3(t,e,n){t.dispatchEvent(oO("".concat(e?"intro":"outro").concat(n)))}let o6=new Set;function o8(){a={r:0,c:[],p:a}}function o7(){a.r||os(a.c),a=a.p}function o9(t,e){t&&t.i&&(o6.delete(t),t.i(e))}function at(t,e,n,r){t&&t.o&&!o6.has(t)&&(o6.add(t),a.c.push(()=>{o6.delete(t),r&&(n&&t.d(1),r())}),t.o(e))}let ae={duration:0};function an(t,e,n,r){let l=e(t,n),s=r?0:1,c=null,u=null,d=null;function h(){d&&function(t,e){let n=(t.style.animation||"").split(", "),r=n.filter(e?t=>0>t.indexOf(e):t=>-1===t.indexOf("__svelte")),o=n.length-r.length;!o||(t.style.animation=r.join(", "),(o_-=o)||ov(()=>{o_||(oj.forEach(t=>{let e=t.__svelte_stylesheet,n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.__svelte_rules={}}),oj.clear())}))}(t,d)}function p(t,e){let n=t.b-s;return e*=Math.abs(n),{a:s,b:t.b,d:n,duration:e,start:t.start,end:t.start+e,group:t.group}}function f(e){let{delay:n=0,duration:r=300,easing:o=or,tick:f=oi,css:g}=l||ae,m={start:ob()+n,b:e};e||(m.group=a,a.r+=1),c||u?u=m:(g&&(h(),d=oz(t,s,e,r,n,o,g)),e&&f(0,1),c=p(m,r),o0(()=>o3(t,e,"start")),oC(e=>{if(u&&e>u.start&&(c=p(u,r),u=null,o3(t,c.b,"start"),g&&(h(),d=oz(t,s,c.b,c.duration,0,o,l.css))),c){if(e>=c.end)f(s=c.b,1-s),o3(t,c.b,"end"),u||(c.b?h():--c.group.r||os(c.group.c)),c=null;else if(e>=c.start){let t=e-c.start;f(s=c.a+c.d*o(t/c.duration),1-s)}}return!!(c||u)}))}return{run(t){oc(l)?(o||(o=Promise.resolve()).then(()=>{o=null}),o).then(()=>{l=l(),f(t)}):f(t)},end(){h(),c=u=null}}}let ai=window;function ar(t,e){t.d(1),e.delete(t.key)}function ao(t,e){at(t,1,1,()=>{e.delete(t.key)})}function aa(t,e,n,r,o,a,l,s,c,u,d,h){let p=t.length,f=a.length,g=p,m={};for(;g--;)m[t[g].key]=g;let $=[],y=new Map,x=new Map;for(g=f;g--;){let t=h(o,a,g),s=n(t),c=l.get(s);c?r&&c.p(t,e):(c=u(s,t)).c(),y.set(s,$[g]=c),s in m&&x.set(s,Math.abs(g-m[s]))}let b=new Set,v=new Set;function w(t){o9(t,1),t.m(s,d),l.set(t.key,t),d=t.first,f--}for(;p&&f;){let e=$[f-1],n=t[p-1],r=e.key,o=n.key;e===n?(d=e.first,p--,f--):y.has(o)?!l.has(r)||b.has(r)?w(e):v.has(o)?p--:x.get(r)>x.get(o)?(v.add(r),w(e)):(b.add(o),p--):(c(n,l),p--)}for(;p--;){let e=t[p];y.has(e.key)||c(e,l)}for(;f;)w($[f-1]);return $}function al(t,e){let n={},r={},o={$$scope:1},a=t.length;for(;a--;){let l=t[a],s=e[a];if(s){for(let t in l)t in s||(r[t]=1);for(let t in s)o[t]||(n[t]=s[t],o[t]=1);t[a]=s}else for(let t in l)o[t]=1}for(let t in r)t in n||(n[t]=void 0);return n}function as(t){return"object"==typeof t&&null!==t?t:{}}function ac(t,e,n){let r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function au(t){t&&t.c()}function ad(t,e,n){let{fragment:r,on_mount:o,on_destroy:a,after_update:l}=t.$$;r&&r.m(e,n),o0(()=>{let e=o.map(oa).filter(oc);a?a.push(...e):os(e),t.$$.on_mount=[]}),l.forEach(o0)}function ah(t,e){let n=t.$$;null!==n.fragment&&(os(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ap(t,e,n,o,a,l){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[-1],c=r;r=t;let u=e.props||{},d=t.$$={fragment:null,ctx:null,props:l,update:oi,not_equal:a,bound:ol(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:[]),callbacks:ol(),dirty:s,skip_bound:!1},h=!1;if(d.ctx=n?n(t,u,function(e,n){for(var r=arguments.length,o=Array(r>2?r-2:0),l=2;l<r;l++)o[l-2]=arguments[l];let s=o.length?o[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=s)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](s),h)&&(-1===t.$$.dirty[0]&&(oG.push(t),oJ||(oJ=!0,oQ.then(o5)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31),n}):[],d.update(),h=!0,os(d.before_update),d.fragment=!!o&&o(d.ctx),e.target){if(e.hydrate){let t=Array.from(e.target.childNodes);d.fragment&&d.fragment.l(t),t.forEach(oA)}else d.fragment&&d.fragment.c();e.intro&&o9(t.$$.fragment),ad(t,e.target,e.anchor),o5()}r=c}class af{$destroy(){ah(this,1),this.$destroy=oi}$on(t,e){let n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{let t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){this.$$set&&0!==Object.keys(t).length&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}let ag=[];function am(t,e){return{subscribe:a$(t,e).subscribe}}function a$(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oi,r=[];function o(n){if(ou(t,n)&&(t=n,e)){let e=!ag.length;for(let e=0;e<r.length;e+=1){let n=r[e];n[1](),ag.push(n,t)}if(e){for(let t=0;t<ag.length;t+=2)ag[t][0](ag[t+1]);ag.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(a){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oi,s=[a,l];return r.push(s),1===r.length&&(e=n(o)||oi),a(t),()=>{let t=r.indexOf(s);-1!==t&&r.splice(t,1),0===r.length&&(e(),e=null)}}}}function ay(t,e,n){let r=!Array.isArray(t),o=r?[t]:t,a=e.length<2;return am(n,t=>{let n=!1,l=[],s=0,c=oi,u=()=>{if(s)return;c();let n=e(r?l[0]:l,t);a?t(n):c=oc(n)?n:oi},d=o.map((t,e)=>od(t,t=>{l[e]=t,s&=~(1<<e),n&&u()},()=>{s|=1<<e}));return n=!0,u(),function(){os(d),c()}})}var ax=t=>t.reduce((t,e)=>Object.assign(t,e),{});let ab=t=>({updateValue:t}),av=t=>({defaultValue:t}),aw=t=>({store:(e,n)=>ay(...t(n))}),ak=t=>({store:(e,n)=>{let r;let[o,a,l=()=>!1]=t(n),s=!0;return ay(o,(t,e)=>{a(t,t=>{!s&&l(r,t)||(r=t,s=!1,e(t))})})}}),aC=t=>({store:(e,n)=>{let[r,o={}]=t(n),a=[],l={},s=t=>r(t,l),c=t=>{(a.length||t.length)&&(a=t,u())},u=()=>{let t=a.map(s);a=t,h(t)};Object.keys(o).forEach(t=>{let e=o[t];e.subscribe(e=>{l[t]=e,e&&u()})});let{subscribe:d,set:h}=a$(e);return{set:c,update:t=>c(t(null)),subscribe:d}}}),aM=(t,e,n)=>{let r;let{store:o=t=>a$(t),defaultValue:a=J,updateValue:l}=n,s=o(a(),e,t),{subscribe:c,update:u=J}=s,d=t=>{let e=!0;r&&r(),r=c(n=>{if(e)return e=!1;t(n),r(),r=void 0})},h=l?l(t):tj;return s.set=t=>u(e=>h(t,e,d)),s.defaultValue=a,s};var aS=t=>{let e={},n={};return t.forEach(t=>{let[r,...o]=t,a=ax(o),l=e[r]=aM(n,e,a),s={get:()=>oh(l),set:l.set};Object.defineProperty(n,r,s)}),{stores:e,accessors:n}},aA=[["src"],["imageReader"],["imageWriter"],["images",av(()=>[])]],aE=()=>{let t=[];return{sub:(e,n)=>(t.push({event:e,callback:n}),()=>t=t.filter(t=>t.event!==e||t.callback!==n)),pub:(e,n)=>{t.filter(t=>t.event===e).forEach(t=>t.callback(n))}}},aT=t=>t.charAt(0).toUpperCase()+t.slice(1),aR=(t,e)=>{Object.keys(e).forEach(n=>{let r=nJ(e[n])?{value:e[n],writable:!1}:e[n];Object.defineProperty(t,n,r)})},aI=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return parseFloat(t.toFixed(e))},aP=(t,e)=>{let n=e8(e),r=tV(),o=eQ(t);o.forEach(t=>{t6(t,r),e6(t,e)||n.forEach(e=>{let n=Math.atan2(e.start.y-e.end.y,e.start.x-e.end.x),o=tH(t.x+1e4*Math.sin(Math.PI-n),t.y+1e4*Math.cos(Math.PI-n)),a=ew(ev(e),1e4),l=e4(eb(t,o),a);l&&t6(r,t8(tq(l),t))})});let a=eS(t);t6(a,r);let l=eQ(a),s=l.every(t=>e6(t,e));return!!s&&(eV(t,a),!0)},aD=(t,e)=>{let n=eQ(t),r=e8(e).map(t=>ew(t,5)),o=eF(t),a=[];n.forEach(t=>{let e=ek(eb(tq(o),tq(t)),1e6),n=!1;r.map(ev).forEach(t=>{let r=e4(e,t);r&&!n&&(a.push(r),n=!0)})});let l=ee(a[0],a[2]),s=ee(a[1],a[3]),c=l<s?[a[0],a[2]]:[a[1],a[3]],u=eI(c);return u.width<t.width&&(eV(t,u),!0)},aL=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},r=eT(t),o=eF(r),a=e0(r,n,o).map(t=>tJ(t,e,o)),l=eI(a);return a.map(t=>t8(t,l))},aF=function(t){let e,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:eW(t);if(0!==r){let a,l;let s=Math.atan2(1,o),c=Math.sign(r)*r,u=c%Math.PI,d=c%tz;l=u>tN&&u<tz+tN?d>tN?c:tz-d:d>tN?tz-d:c,a=Math.min(Math.abs(t.height/Math.sin(s+l)),Math.abs(t.width/Math.cos(s-l))),n=(e=Math.cos(s)*a)/o}else(n=(e=t.width)/o)>t.height&&(e=(n=t.height)*o);return eu(e,n)},aB=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tV(),o=arguments.length>4?arguments[4]:void 0;if(nY(n)&&0!==n||r.x||r.y){let o=eW(t),a=aL(e,n,r),l=aF(e,n,o),s=t.width<l.width&&t.height<l.height;if(!s){let e=.5*t.width-.5*l.width,n=.5*t.height-.5*l.height;t.width>l.width&&(t.width=l.width,t.x+=e),t.height>l.height&&(t.height=l.height,t.y+=n)}aP(t,a);let c=aD(t,a);c&&aP(t,a)}else{let n=eW(t);t.width=Math.min(t.width,e.width),t.height=Math.min(t.height,e.height),t.x=Math.max(t.x,0),t.x+t.width>e.width&&(t.x-=t.x+t.width-e.width),t.y=Math.max(t.y,0),t.y+t.height>e.height&&(t.y-=t.y+t.height-e.height);let r=eF(t),a=eq(t,n);a.width=Math.max(o.width,a.width),a.height=Math.max(o.height,a.height),a.x=r.x-.5*a.width,a.y=r.y-.5*a.height,eV(t,a)}},aO=(t,e,n,r,o,a,l,s)=>{let c=ea(l),u=ea(s),d=aI(Math.max(e.width/u.width,e.height/u.height)),h=aI(Math.min(e.width/c.width,e.height/c.height)),p=eS(e);if(h<1||d>1){let n=eF(t),r=eF(e),o=h<1?h:d,a=(r.x+n.x)/2,l=(r.y+n.y)/2,s=p.width/o,c=p.height/o;eX(p,a-.5*s,l-.5*c,s,c)}return a&&aB(p,n,r,o,c),{crop:p}},aj=function(t,e,n){arguments.length>3&&void 0!==arguments[3]&&arguments[3];let r=eT(t),o=eF(r),a=eH(r,n,o),l=eF(e1(eI(a))),s=eF(e),c=tJ(s,-n,l),u=t8(c,l),d=t3(t6(o,u),aI);return eL(d.x-.5*e.width,d.y-.5*e.height,e.width,e.height)},a_=(t,e,n)=>Math.max(e,Math.min(t,n)),az=(t,e,n,r,o,a,l,s,c,u)=>{let d=ea(c),h=ea(u);l&&(h.width=Math.min(u.width,o.width),h.height=Math.min(u.height,o.height));let p=!1,f=(e,n)=>{let c=aj(o,r,e,null),u=eT(o),g=eF(u),m=e0(u,a,g),$=t8(tq(g),e2(m)),y=tJ(eF(c),n,g),x=t8(tq(g),y);m.forEach(t=>tJ(t,n,g));let b=eI(m),v=e2(m),w=t6(t8(t8(v,x),b),$),k=eL(w.x-.5*c.width,w.y-.5*c.height,c.width,c.height);if(s&&eO(k,s.width/k.width),l){let t=aL(o,n,a);aD(k,t)}let C=aI(Math.min(k.width/d.width,k.height/d.height),8),M=aI(Math.max(k.width/h.width,k.height/h.height),8);if(C<1||M>1){let r=aI(Math.abs(n-e))===aI(Math.PI/2);if(r&&!p)return p=!0,f(t,t+Math.sign(n-e)*Math.PI)}return{rotation:n,crop:eJ(k,t=>aI(t,8))}},g=Math.sign(e)*Math.round(Math.abs(e)/tz)*tz,m=a_(e,g+n[0],g+n[1]);return f(t,m)};let aN=["cropLimitToImage","cropMinSize","cropMaxSize","cropAspectRatio","flipX","flipY","rotation","crop","colorMatrix","convolutionMatrix","gamma","vignette","annotation","decoration","backgroundColor","targetSize"],aU=t=>n0(t)?t.map(aU):nq(t)?{...t}:t,aW=["isDraft","isFormatted","isComplete","isError","isLoading","isEditing","isSelected"],aX=t=>!e9(t),aV=t=>t.map(t=>Object.keys(t).reduce((e,n)=>(aW.includes(n)||!aX(t[n])||(e[n]=t[n]),e),{}));var aH=t=>{if(t){if(/:/.test(t)){let[e,n]=t.split(":");return e/n}return parseFloat(t)}},aY=(t,e)=>{if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0};let aG=null;var aK=()=>(null===aG&&(aG=nd(/Android/)),aG);let aq=null;var aZ=()=>(null===aq&&(aq=nd(/Firefox/)),aq);let aQ=null;var aJ=()=>(null===aQ&&(aQ=nd(/Edge/)),aQ),a0=()=>l||(l=n5()?"ios":aK()?"android":aZ()?"firefox":np()?"ie":aJ()?"edge":"chrome"),a1=()=>{if(!s){let t={android:[32767,32767,10836],ios:[4194303,8388607,16777216],chrome:[32767,32767,268435456],firefox:[32767,32767,124992400],edge:[16384,16384,268435456],ie:[16384,16384,67108864]};s=t[a0()]||t.chrome}let[t,e,n]=s;return{width:t,height:e,density:n}},a2=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0,0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return 4===t.length?t:[...t,e]};let a4=-tN,a5=(t,e,n)=>{let r=t3(eF(t),t=>aI(t,8)),o=eT(e),a=eF(o),l=eH(o,n,a),s=t3(ep(eI(l)),t=>aI(t,8)),c=Math.abs(s.x-r.x),u=Math.abs(s.y-r.y);return c<1&&u<1},a3=(t,e,n)=>{let r=aF(e,n,eW(t));return ed(e$(r,Math.round),e$(ea(t),Math.round))},a6=(t,e,n,r)=>{let o=Math.max(n.width/r.width,n.height/r.height),a=eu(r.width*o,r.height*o),l=ey(a),s=Math.min(t.width,t.height);if(l<s)return[a4,tN];let c=e?t.height:t.width,u=e?t.width:t.height,d=Math.acos(a.height/l),h=d-Math.acos(u/l),p=Math.asin(c/l)-d;if(Number.isNaN(h)&&Number.isNaN(p))return[a4,tN];let f=Number.isNaN(h)?p:Number.isNaN(p)?h:Math.min(h,p);return[Math.max(-f,a4),Math.min(f,tN)]},a8=(t,e,n,r,o,a)=>{let l=ea(r),s=ea(o);return a?[l,e$(aF(t,e,n),Math.round)]:[l,s]},a7=(t,e)=>(t.isFormatted||((t=rg(t)).isFormatted=!0),!t.isDraft&&iq(t)&&(!t.context||!eU(e.context,t.context))&&((t=rS(t,e.context)).context={...e.context}),t);var a9=[["file"],["size"],["loadState"],["processState"],["aspectRatio",aw(t=>{let{size:e}=t;return[e,t=>t?eW(t):void 0]})],["perspectiveX",av(()=>0)],["perspectiveY",av(()=>0)],["perspective",aw(t=>{let{perspectiveX:e,perspectiveY:n}=t;return[[e,n],t=>{let[e,n]=t;return{x:e,y:n}}]})],["rotation",av(()=>0),ab(t=>(e,n,r)=>{if(e===n)return e;let{loadState:o,size:a,rotationRange:l,cropMinSize:s,cropMaxSize:c,crop:u,perspective:d,cropLimitToImage:h,cropOrigin:p}=t;if(!o||!o.beforeComplete)return e;let f=a3(u,a,n),g=a5(u,a,n),m=az(n,e,l,u,a,d,h,p,s,c);if(f&&g){let t=aF(a,e,eW(m.crop));m.crop.x+=.5*m.crop.width,m.crop.y+=.5*m.crop.height,m.crop.x-=.5*t.width,m.crop.y-=.5*t.height,m.crop.width=t.width,m.crop.height=t.height}return r(()=>{t.crop=eJ(m.crop,t=>aI(t,8))}),m.rotation})],["flipX",av(()=>!1)],["flipY",av(()=>!1)],["flip",aw(t=>{let{flipX:e,flipY:n}=t;return[[e,n],t=>{let[e,n]=t;return{x:e,y:n}}]})],["isRotatedSideways",ak(t=>{let{rotation:e}=t;return[[e],(t,e)=>{let[n]=t;return e(tU(n))},(t,e)=>t!==e]})],["crop",ab(t=>function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,{loadState:r,size:o,cropMinSize:a,cropMaxSize:l,cropLimitToImage:s,rotation:c,perspective:u}=t;if(!e||!r||!r.beforeComplete)return e;let d=aO(n,e,o,c,u,s,a,l),h=eJ(d.crop,t=>aI(t,8));return h})],["cropAspectRatio",ab(t=>e=>{let{loadState:n,crop:r,size:o,rotation:a}=t,l=aH(e);if(l){if(!n||!n.beforeComplete)return l;if(a5(r,o,a)){let n=eg(ea(o),a);t.crop=eJ(eq(eT(n),e),aI)}else{let e={width:r.height*l,height:r.height},n=(r.width-e.width)*.5,o=(r.height-e.height)*.5;t.crop=eJ(eL(r.x+n,r.y+o,e.width,e.height),aI)}return l}})],["cropOrigin"],["cropMinSize",av(()=>({width:1,height:1}))],["cropMaxSize",av(()=>ea(a1()))],["cropLimitToImage",av(()=>!0),ab(t=>(e,n,r)=>(!n&&e&&r(()=>t.crop=eS(t.crop)),e))],["cropSize",ak(t=>{let{crop:e}=t;return[[e],(t,e)=>{let[n]=t;n&&e(eu(n.width,n.height))},(t,e)=>ed(t,e)]})],["cropRectAspectRatio",aw(t=>{let{cropSize:e}=t;return[[e],(t,e)=>{let[n]=t;n&&e(aI(eW(n),5))}]})],["cropRange",ak(t=>{let{size:e,rotation:n,cropRectAspectRatio:r,cropMinSize:o,cropMaxSize:a,cropLimitToImage:l}=t;return[[e,n,r,o,a,l],(t,e)=>{let[n,r,o,a,l,s]=t;if(!n)return;let c=a8(n,r,o,a,l,s);e(c)},(t,e)=>aY(t,e)]})],["rotationRange",ak(t=>{let{size:e,isRotatedSideways:n,cropMinSize:r,cropSize:o}=t;return[[e,n,r,o],(t,e)=>{let[n,r,o,a]=t;if(!n||!a)return;let l=a6(n,r,o,a);e(l)},(t,e)=>aY(t,e)]})],["backgroundColor",ab(()=>t=>a2(t))],["targetSize"],["colorMatrix"],["convolutionMatrix"],["gamma"],["noise"],["vignette"],["annotation",aC(t=>{let{size:e}=t;return[a7,{context:e}]}),av(()=>[])],["decoration",aC(t=>{let{crop:e}=t;return[a7,{context:e}]}),av(()=>[])],["state",{store:(t,e,n)=>{let r=aN.map(t=>e[t]),{subscribe:o}=ay(r,(t,e)=>{let n=aN.reduce((e,n,r)=>(e[n]=aU(t[r]),e),{});n.crop&&eJ(n.crop,Math.round),n.annotation=n.annotation&&aV(n.annotation),n.decoration=n.decoration&&aV(n.decoration),e(n)}),a=t=>{t&&(n.cropOrigin=void 0,aN.filter(e=>t.hasOwnProperty(e)).forEach(e=>{n[e]=aU(t[e])}))};return{set:a,update:t=>a(t(null)),subscribe:o}}}]],lt=async function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0,{ontaskstart:o,ontaskprogress:a,ontaskend:l,token:s}=r,c=!1;for(let[r,u]of(s.cancel=()=>{c=!0},e.entries())){if(c)return;let[e,s]=u;o(r,s);try{t=await e(t,{...n},t=>a(r,s,t))}catch(t){throw c=!0,t}l(r,s)}return t},le=function(){let{minSize:t={width:1,height:1}}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{stores:e,accessors:n}=aS(a9),{pub:r,sub:o}=aE(),a=(t,e)=>{let o=()=>n[t]||{},a=e=>n[t]={...o(),...e,timeStamp:Date.now()},l=()=>o().error,s=t=>{l()||(a({error:t}),r("".concat(e,"error"),{...o()}))};return{start(){r("".concat(e,"start"))},onabort(){r("".concat(e,"abort"))},ontaskstart(t,n){l()||(a({index:t,task:n,taskProgress:void 0,taskLengthComputable:void 0}),r("".concat(e,"taskstart"),{...o()}))},ontaskprogress(t,n,s){l()||(a({index:t,task:n,taskProgress:s.loaded/s.total,taskLengthComputable:s.lengthComputable}),r("".concat(e,"taskprogress"),{...o()}),r("".concat(e,"progress"),{...o()}))},ontaskend(t,n){l()||(a({index:t,task:n}),r("".concat(e,"taskend"),{...o()}))},ontaskerror(t){s(t)},error(t){s(t)},beforeComplete(t){l()||(a({beforeComplete:!0}),r("before".concat(e),t))},complete(t){l()||(a({complete:!0}),r(e,t))}}};return aR(n,{read:(e,r)=>{let{reader:o}=r;if(!o)return;Object.assign(n,{file:void 0,size:void 0,loadState:void 0});let l={cancel:J},s=!1,c=a("loadState","load"),u={token:l,...c},d={src:e,size:void 0,dest:void 0},h={};return(async()=>{try{c.start();let e=await lt(d,o,h,u);if(s)return c.onabort();let{size:r,dest:a}=e||{};if(!r||!r.width||!r.height)throw new ny("Image size missing","IMAGE_SIZE_MISSING",e);if(r.width<t.width||r.height<t.height)throw new ny("Image too small","IMAGE_TOO_SMALL",{...e,minWidth:t.width,minHeight:t.height});Object.assign(n,{size:r,file:a}),n.crop||(n.crop=eq(eT(r),n.cropAspectRatio)),n.state=n.state,c.beforeComplete(e),c.complete(e)}catch(t){c.error(t)}finally{l=void 0}})(),()=>{s=!0,l&&l.cancel()}},write:t=>{if(!n.loadState.complete)return;n.processState=void 0;let e=a("processState","process"),r={src:n.file,imageState:n.state,dest:void 0};if(!t){e.start(),e.complete(r);return}let o={cancel:J},l={},s={token:o,...e};return(async()=>{e.start();try{let n=await lt(r,t,l,s);e.complete(n)}catch(t){e.error(t)}finally{o=void 0}})(),()=>o&&o.cancel()},on:o}),{accessors:n,stores:e}};let ln=["loadstart","loadabort","loaderror","loadprogress","load","processstart","processabort","processerror","processprogress","process"],li=["flip","cropOrigin","isRotatedSideways","perspective","perspectiveX","perspectiveY","cropRange"],lr=t=>"image".concat(aT(t)),lo=t=>t.map(t=>{let[e]=t;return e}).filter(t=>!li.includes(t));var la=t=>{let e=Object.getOwnPropertyDescriptors(t.prototype);return Object.keys(e).filter(t=>!!e[t].get)};function ll(t){return Math.sqrt(1- --t*t)}function ls(t){return"[object Date]"===Object.prototype.toString.call(t)}function lc(t){let e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=a$(t),o=t;function a(a,l){let s;if(null==t)return r.set(t=a),Promise.resolve();o=a;let c=e,u=!1,{delay:d=0,duration:h=400,easing:p=or,interpolate:f=function t(e,n){if(e===n||e!=e)return()=>e;let r=typeof e;if(r!==typeof n||Array.isArray(e)!==Array.isArray(n))throw Error("Cannot interpolate values of different type");if(Array.isArray(e)){let r=n.map((n,r)=>t(e[r],n));return t=>r.map(e=>e(t))}if("object"===r){if(!e||!n)throw Error("Object cannot be null");if(ls(e)&&ls(n)){e=e.getTime(),n=n.getTime();let t=n-e;return n=>new Date(e+n*t)}let r=Object.keys(n),o={};return r.forEach(r=>{o[r]=t(e[r],n[r])}),t=>{let e={};return r.forEach(n=>{e[n]=o[n](t)}),e}}if("number"===r){let t=n-e;return n=>e+n*t}throw Error("Cannot interpolate ".concat(r," values"))}}=oo(oo({},n),l);if(0===h)return c&&(c.abort(),c=null),r.set(t=o),Promise.resolve();let g=ob()+d;return(e=oC(e=>{if(e<g)return!0;u||(s=f(t,a),"function"==typeof h&&(h=h(t,a)),u=!0),c&&(c.abort(),c=null);let n=e-g;return n>h?(r.set(t=a),!1):(r.set(t=s(p(n/h))),!0)})).promise}return{set:a,update:(e,n)=>a(e(o,t),n),subscribe:r.subscribe}}function lu(t){let e,n,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=a$(t),{stiffness:l=.15,damping:s=.8,precision:c=.01}=o,u=t,d=t,h=1,p=0,f=!1;function g(o){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};d=o;let s=r={};if(null==t||l.hard||m.stiffness>=1&&m.damping>=1)return f=!0,e=null,u=o,a.set(t=d),Promise.resolve();if(l.soft){let t=!0===l.soft?.5:+l.soft;p=1/(60*t),h=0}if(!n){e=null,f=!1;let r={inv_mass:void 0,opts:m,settled:!0,dt:void 0};n=oC(o=>{if(null===e&&(e=o),f)return f=!1,n=null,!1;h=Math.min(h+p,1),r.inv_mass=h,r.opts=m,r.settled=!0,r.dt=(o-e)*60/1e3;let l=function t(e,n,r,o){if("number"==typeof r){let t=o-r,a=(r-n)/(e.dt||1/60),l=e.opts.stiffness*t,s=e.opts.damping*a,c=(l-s)*e.inv_mass,u=(a+c)*e.dt;return Math.abs(u)<e.opts.precision&&Math.abs(t)<e.opts.precision?o:(e.settled=!1,r+u)}if(n0(r))return r.map((a,l)=>t(e,n[l],r[l],o[l]));if("object"==typeof r){let a={};for(let l in r)a[l]=t(e,n[l],r[l],o[l]);return a}throw Error("Cannot spring ".concat(typeof r," values"))}(r,u,t,d);return e=o,u=t,a.set(t=l),r.settled&&(n=null),!r.settled})}return new Promise(t=>{n.promise.then(()=>{s===r&&t()})})}let m={set:g,update:(e,n)=>g(e(d,t),n),subscribe:a.subscribe,stiffness:l,damping:s,precision:c};return m}var ld=am(!1,t=>{let e=window.matchMedia("(prefers-reduced-motion:reduce)");t(e.matches),e.onchange=()=>t(e.matches)}),lh=()=>"ResizeObserver"in window;let lp=eA(),lf=(t,e,n,r,o)=>{t.rect||(t.rect=eA());let a=t.rect;eX(lp,e,n,r,o),eU(a,lp)||(eV(a,lp),t.dispatchEvent(new CustomEvent("measure",{detail:a})))},lg=Math.round,lm=t=>{let e=t.getBoundingClientRect();lf(t,lg(e.x),lg(e.y),lg(e.width),lg(e.height))},l$=t=>lf(t,t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight),ly=[],lx=null;function lb(){if(!ly.length){lx=null;return}ly.forEach(t=>t.measure(t)),lx=requestAnimationFrame(lb)}var lv=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{observePosition:n=!1,observeViewRect:r=!1,once:o=!1,disabled:a=!1}=e;if(!a)return!lh()||n||r?(t.measure=r?lm:l$,ly.push(t),lx||(lx=requestAnimationFrame(lb)),t.measure(t),{destroy(){let e=ly.indexOf(t);ly.splice(e,1)}}):(c||(c=new ResizeObserver(t=>{t.forEach(t=>l$(t.target))})),c.observe(t),l$(t),o&&c.unobserve(t),{destroy(){o||c.unobserve(t)}})},lw=t=>{let e=!1,n={pointerdown:()=>{e=!1},keydown:()=>{e=!0},keyup:()=>{e=!1},focus:t=>{e&&(t.target.dataset.focusVisible="")},blur:t=>{delete t.target.dataset.focusVisible}};return Object.keys(n).forEach(e=>t.addEventListener(e,n[e],!0)),{destroy(){Object.keys(n).forEach(e=>t.removeEventListener(e,n[e],!0))}}},lk=t=>/^image/.test(t.type);let lC=t=>{let{items:e,files:n}=t.dataTransfer;return e?Array.from(e).filter(t=>"file"===t.kind).map(t=>t.getAsFile()):Array.from(n)||[]};var lM=t=>{let e=t=>{t.preventDefault()},n=e=>{e.preventDefault(),e.stopPropagation(),t.dispatchEvent(new CustomEvent("dropfiles",{detail:{event:e,files:lC(e).filter(t=>lk(t))}}))};return t.addEventListener("drop",n),t.addEventListener("dragover",e),{destroy(){t.removeEventListener("drop",n),t.removeEventListener("dragover",e)}}};let lS=null;var lA=()=>{if(null===lS){if("WebGL2RenderingContext"in window){let t;try{lS=!!(t=ta("canvas")).getContext("webgl2")}catch(t){lS=!1}t&&tc(t)}else lS=!1}return lS},lE=t=>(t&t-1)==0,lT=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return Object.keys(e).filter(t=>!nq(e[t])).reduce((t,o)=>t.replace(new RegExp(n+o+r),e[o]),t)};let lR={head:"#version 300 es\n\nin vec4 aPosition;uniform mat4 uMatrix;",text:"\nin vec2 aTexCoord;out vec2 vTexCoord;",matrix:"\ngl_Position=uMatrix*vec4(aPosition.x,aPosition.y,0,1);"},lI={head:"#version 300 es\nprecision highp float;\n\nout vec4 fragColor;",mask:"\nuniform float uMaskFeather[8];uniform float uMaskBounds[4];uniform float uMaskOpacity;float mask(float x,float y,float bounds[4],float opacity){return 1.0-(1.0-(smoothstep(bounds[3],bounds[3]+1.0,x)*(1.0-smoothstep(bounds[1]-1.0,bounds[1],x))*(1.0-step(bounds[0],y))*step(bounds[2],y)))*(1.0-opacity);}",init:"\nfloat a=1.0;vec4 fillColor=uColor;vec4 textureColor=texture(uTexture,vTexCoord);textureColor*=(1.0-step(1.0,vTexCoord.y))*step(0.0,vTexCoord.y)*(1.0-step(1.0,vTexCoord.x))*step(0.0,vTexCoord.x);",colorize:"\nif(uTextureColor.a!=0.0&&textureColor.a>0.0){vec3 colorFlattened=textureColor.rgb/textureColor.a;if(colorFlattened.r>.999999&&colorFlattened.g==0.0&&colorFlattened.b>.999999){textureColor.rgb=uTextureColor.rgb*textureColor.a;}textureColor*=uTextureColor.a;}",maskapply:"\nfloat m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);",maskfeatherapply:"\nfloat leftFeatherOpacity=step(uMaskFeather[1],gl_FragCoord.x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],gl_FragCoord.x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],gl_FragCoord.x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],gl_FragCoord.x));a*=leftFeatherOpacity*rightFeatherOpacity;",edgeaa:"\nvec2 scaledPoint=vec2(vRectCoord.x*uSize.x,vRectCoord.y*uSize.y);a*=smoothstep(0.0,1.0,uSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);",cornerradius:"\nvec2 s=(uSize-2.0)*.5;vec2 r=(vRectCoord*uSize);vec2 p=r-(uSize*.5);float cornerRadius=uCornerRadius[0];bool left=r.x<s.x;bool top=r.y<s.x;if(!left&&top){cornerRadius=uCornerRadius[1];}if(!left&&!top){cornerRadius=uCornerRadius[3];}if(left&&!top){cornerRadius=uCornerRadius[2];}a*=1.0-clamp(length(max(abs(p)-(s-cornerRadius),0.0))-cornerRadius,0.0,1.0);",fragcolor:"\nfillColor.a*=a;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);textureColor*=uTextureOpacity;textureColor.a*=a;textureColor.rgb*=m*a;textureColor.rgb+=(1.0-m)*(uCanvasColor.rgb*textureColor.a);fragColor=textureColor+(fillColor*(1.0-textureColor.a));"},lP=(t,e,n)=>(e=lT(e,n===t.VERTEX_SHADER?lR:lI,"##").trim(),lA())?e:(e=(e=e.replace(/#version.+/gm,"").trim()).replace(/^\/\/\#/gm,"#"),n===t.VERTEX_SHADER&&(e=e.replace(/in /gm,"attribute ").replace(/out /g,"varying ")),n===t.FRAGMENT_SHADER&&(e=e.replace(/in /gm,"varying ").replace(/out.*?;/gm,"").replace(/texture\(/g,"texture2D(").replace(/fragColor/g,"gl_FragColor")),"".concat(e)),lD=(t,e,n)=>{let r=t.createShader(n),o=lP(t,e,n);return t.shaderSource(r,o),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(r)),r},lL=(t,e,n,r,o)=>{let a=t.createProgram();t.attachShader(a,lD(t,e,t.VERTEX_SHADER)),t.attachShader(a,lD(t,n,t.FRAGMENT_SHADER)),t.linkProgram(a);let l={};return r.forEach(e=>{l[e]=t.getAttribLocation(a,e)}),o.forEach(e=>{l[e]=t.getUniformLocation(a,e)}),{program:a,locations:l}},lF=t=>!!lA()||lE(t.width)&&lE(t.height),lB=(t,e)=>{t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,lF(e)?t.LINEAR_MIPMAP_LINEAR:t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),lF(e)&&t.generateMipmap(t.TEXTURE_2D)},lO=(t,e)=>{let n=t.createTexture();return t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),lB(t,e),t.bindTexture(t.TEXTURE_2D,null),n},lj=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t?[t[0],t[1],t[2],nY(t[3])?e*t[3]:e]:[0,0,0,0]},l_=()=>{let t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},lz=(t,e,n,r,o)=>{let a=1/Math.tan(e/2),l=1/(r-o);t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(o+r)*l,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*o*r*l,t[15]=0},lN=(t,e,n,r,o,a,l)=>{let s=1/(e-n),c=1/(r-o),u=1/(a-l);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(o+r)*c,t[14]=(l+a)*u,t[15]=1},lU=(t,e,n,r)=>{t[12]=t[0]*e+t[4]*n+t[8]*r+t[12],t[13]=t[1]*e+t[5]*n+t[9]*r+t[13],t[14]=t[2]*e+t[6]*n+t[10]*r+t[14],t[15]=t[3]*e+t[7]*n+t[11]*r+t[15]},lW=(t,e)=>{t[0]=t[0]*e,t[1]=t[1]*e,t[2]=t[2]*e,t[3]=t[3]*e,t[4]=t[4]*e,t[5]=t[5]*e,t[6]=t[6]*e,t[7]=t[7]*e,t[8]=t[8]*e,t[9]=t[9]*e,t[10]=t[10]*e,t[11]=t[11]*e},lX=(t,e)=>{t[0]=t[0]*e,t[1]=t[1]*e,t[2]=t[2]*e,t[3]=t[3]*e},lV=(t,e)=>{t[4]=t[4]*e,t[5]=t[5]*e,t[6]=t[6]*e,t[7]=t[7]*e},lH=(t,e)=>{let n=Math.sin(e),r=Math.cos(e),o=t[4],a=t[5],l=t[6],s=t[7],c=t[8],u=t[9],d=t[10],h=t[11];t[4]=o*r+c*n,t[5]=a*r+u*n,t[6]=l*r+d*n,t[7]=s*r+h*n,t[8]=c*r-o*n,t[9]=u*r-a*n,t[10]=d*r-l*n,t[11]=h*r-s*n},lY=(t,e)=>{let n=Math.sin(e),r=Math.cos(e),o=t[0],a=t[1],l=t[2],s=t[3],c=t[8],u=t[9],d=t[10],h=t[11];t[0]=o*r-c*n,t[1]=a*r-u*n,t[2]=l*r-d*n,t[3]=s*r-h*n,t[8]=o*n+c*r,t[9]=a*n+u*r,t[10]=l*n+d*r,t[11]=s*n+h*r},lG=(t,e)=>{let n=Math.sin(e),r=Math.cos(e),o=t[0],a=t[1],l=t[2],s=t[3],c=t[4],u=t[5],d=t[6],h=t[7];t[0]=o*r+c*n,t[1]=a*r+u*n,t[2]=l*r+d*n,t[3]=s*r+h*n,t[4]=c*r-o*n,t[5]=u*r-a*n,t[6]=d*r-l*n,t[7]=h*r-s*n};var lK=t=>t*Math.PI/180;let lq=(t,e,n,r,o)=>{let a,l;a=t1(tH(r.x-n.x,r.y-n.y)),l=t1(tH(o.x-r.x,o.y-r.y));let s=t1(tH(a.x+l.x,a.y+l.y)),c=tH(-s.y,s.x),u=tH(-a.y,a.x),d=1/t9(c,u);t[e]=r.x,t[e+1]=r.y,t[e+2]=c.x,t[e+3]=c.y,t[e+4]=-d,t[e+5]=r.x,t[e+6]=r.y,t[e+7]=c.x,t[e+8]=c.y,t[e+9]=d},lZ=(t,e)=>{let n,r,o,a=0,l=t.length,s=new Float32Array((e?l+1:l)*10),c=t[0],u=t[l-1];for(a=0;a<l;a++)n=t[a-1],r=t[a],o=t[a+1],n||(n=e?u:tH(r.x+(r.x-o.x),r.y+(r.y-o.y))),o||(o=e?c:tH(r.x+(r.x-n.x),r.y+(r.y-n.y))),lq(s,10*a,n,r,o);return e&&lq(s,10*l,u,c,t[1]),s},lQ=t=>{let e=new Float32Array(8);return e[0]=t[3].x,e[1]=t[3].y,e[2]=t[0].x,e[3]=t[0].y,e[4]=t[2].x,e[5]=t[2].y,e[6]=t[1].x,e[7]=t[1].y,e},lJ=t=>{let e=new Float32Array(6);return e[0]=t[0].x,e[1]=t[0].y,e[2]=t[1].x,e[3]=t[1].y,e[4]=t[2].x,e[5]=t[2].y,e},l0=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,o=eQ(t),a=t.x+.5*t.width,l=t.y+.5*t.height;return(n||r)&&ei(o,n,r,a,l),0!==e&&er(o,e,a,l),o},l1=(t,e,n,r,o,a,l)=>{let s=[],c=Math.max(20,Math.round((Math.abs(n)+Math.abs(r))/6)),u=.5*n,d=.5*r,h=t+u,p=e+d;for(let t=0;t<c;t++)s.push(tH(h+u*Math.cos(t*(2*Math.PI)/c),p+d*Math.sin(t*(2*Math.PI)/c)));return(a||l)&&ei(s,a,l,h,p),o&&er(s,o,h,p),s},l2=(t,e,n,r,o,a,l,s)=>{let c=[];if(a.every(t=>0===t))c.push(tH(t,e),tH(t+n,e),tH(t+n,e+r),tH(t,e+r));else{let[o,l,s,u]=a,d=t+n,h=e+r;c.push(tH(t+o,e)),l4(c,d-l,e+l,l,-1),c.push(tH(d,e+l)),l4(c,d-u,h-u,u,0),c.push(tH(d-u,h)),l4(c,t+s,h-s,s,1),c.push(tH(t,h-s)),l4(c,t+o,e+o,o,2)}return(l||s)&&ei(c,l,s,t+.5*n,e+.5*r),o&&er(c,o,t+.5*n,e+.5*r),c},l4=(t,e,n,r,o)=>{let a=Math.min(20,Math.max(4,Math.round(r/2))),l=0,s=0,c=0,u=0;for(;u<a;u++)s=r*Math.cos(l=o*tz+u/a*tz),c=r*Math.sin(l),t.push(tH(e+s,n+c))};var l5=(t,e)=>t.getContext("webgl2",e)||t.getContext("webgl",e)||t.getContext("experimental-webgl",e);let l3=new Float32Array([0,1,0,0,1,1,1,0]);var l6=(t,e,n,r)=>{let o,a,l,s,c,u,d,h,p,f,g,m,$,y,x={width:0,height:0},b={width:0,height:0},v=[0,0,0],w=[],k=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,r=w[t];return r&&T.deleteTexture(r.texture),w[t]={texture:e,source:n,textureAspectRatio:n?tO(n.width,n.height):void 0},t},C=()=>{let t=w.findIndex(t=>void 0===t);return t<4?w.length:t},M=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;return k(C(),t,e)},S=(t,e)=>{k(t,lO(T,e),e)},A=lK(30),E=Math.tan(A/2),T=l5(t,{antialias:!1,alpha:!1,premultipliedAlpha:!0});if(!T)return;T.getExtension("OES_standard_derivatives"),T.disable(T.DEPTH_TEST),T.enable(T.BLEND),T.blendFunc(T.ONE,T.ONE_MINUS_SRC_ALPHA),T.pixelStorei(T.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0);let R=T.createTexture();T.bindTexture(T.TEXTURE_2D,R),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,1,1,0,T.RGBA,T.UNSIGNED_BYTE,new Uint8Array([255,255,255,255])),k(0,R);let I=T.createTexture();T.bindTexture(T.TEXTURE_2D,I),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,1,1,0,T.RGBA,T.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),k(1,I);let P=T.createTexture();k(2,P);let D=T.createFramebuffer();S(3,e);let L=T.createBuffer(),F=T.createBuffer();T.bindBuffer(T.ARRAY_BUFFER,F),T.bufferData(T.ARRAY_BUFFER,l3,T.STATIC_DRAW);let B=lL(T,"\n##head\n##text\nvoid main(){vTexCoord=aTexCoord;gl_Position=uMatrix*aPosition;}","\n##head\nin vec2 vTexCoord;uniform sampler2D uTexture;uniform sampler2D uTextureMarkup;uniform vec2 uTextureSize;uniform float uOpacity;uniform vec4 uFillColor;uniform vec4 uOverlayColor;uniform mat4 uColorMatrix;uniform vec4 uColorOffset;uniform float uClarityKernel[9];uniform float uClarityKernelWeight;uniform float uColorGamma;uniform float uColorVignette;uniform float uMaskClip;uniform float uMaskOpacity;uniform float uMaskBounds[4];uniform float uMaskCornerRadius[4];uniform float uMaskFeather[8];vec4 applyGamma(vec4 c,float g){c.r=pow(c.r,g);c.g=pow(c.g,g);c.b=pow(c.b,g);return c;}vec4 applyColorMatrix(vec4 c,mat4 m,vec4 o){vec4 cM=(c*m)+o;cM*=cM.a;return cM;}vec4 applyConvolutionMatrix(vec4 c,float k0,float k1,float k2,float k3,float k4,float k5,float k6,float k7,float k8,float w){if(w<=0.0)return c;vec2 pixel=vec2(1)/uTextureSize;vec4 colorSum=texture(uTexture,vTexCoord+pixel*vec2(-1.0,-1.0))*k0+texture(uTexture,vTexCoord+pixel*vec2(0.0,-1.0))*k1+texture(uTexture,vTexCoord+pixel*vec2(1.0,-1.0))*k2+texture(uTexture,vTexCoord+pixel*vec2(-1.0,0.0))*k3+texture(uTexture,vTexCoord+pixel*vec2(0.0,0.0))*k4+texture(uTexture,vTexCoord+pixel*vec2(1.0,0.0))*k5+texture(uTexture,vTexCoord+pixel*vec2(-1.0,1.0))*k6+texture(uTexture,vTexCoord+pixel*vec2(0.0,1.0))*k7+texture(uTexture,vTexCoord+pixel*vec2(1.0,1.0))*k8;vec4 color=vec4((colorSum/w).rgb,c.a);color.rgb=clamp(color.rgb,0.0,1.0);return color;}vec4 applyVignette(vec4 c,vec2 pos,vec2 center,float v){float d=distance(pos,center)/length(center);float f=1.0-(d*abs(v));if(v>0.0){c.rgb*=f;}else if(v<0.0){c.rgb+=(1.0-f)*(1.0-c.rgb);}return c;}vec4 blendPremultipliedAlpha(vec4 back,vec4 front){return front+(back*(1.0-front.a));}void main(){float x=gl_FragCoord.x;float y=gl_FragCoord.y;float a=1.0;float maskTop=uMaskBounds[0];float maskRight=uMaskBounds[1];float maskBottom=uMaskBounds[2];float maskLeft=uMaskBounds[3];float leftFeatherOpacity=step(uMaskFeather[1],x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],x));a*=leftFeatherOpacity*rightFeatherOpacity;float overlayColorAlpha=(smoothstep(maskLeft,maskLeft+1.0,x)*(1.0-smoothstep(maskRight-1.0,maskRight,x))*(1.0-step(maskTop,y))*step(maskBottom,y));if(uOverlayColor.a==0.0){a*=overlayColorAlpha;}vec2 offset=vec2(maskLeft,maskBottom);vec2 size=vec2(maskRight-maskLeft,maskTop-maskBottom)*.5;vec2 center=offset.xy+size.xy;int pixelX=int(step(center.x,x));int pixelY=int(step(y,center.y));float cornerRadius=0.0;if(pixelX==0&&pixelY==0)cornerRadius=uMaskCornerRadius[0];if(pixelX==1&&pixelY==0)cornerRadius=uMaskCornerRadius[1];if(pixelX==0&&pixelY==1)cornerRadius=uMaskCornerRadius[2];if(pixelX==1&&pixelY==1)cornerRadius=uMaskCornerRadius[3];float cornerOffset=sign(cornerRadius)*length(max(abs(gl_FragCoord.xy-size-offset)-size+cornerRadius,0.0))-cornerRadius;float cornerOpacity=1.0-smoothstep(0.0,1.0,cornerOffset);a*=cornerOpacity;vec2 scaledPoint=vec2(vTexCoord.x*uTextureSize.x,vTexCoord.y*uTextureSize.y);a*=smoothstep(0.0,1.0,uTextureSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uTextureSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);vec4 color=texture(uTexture,vTexCoord);color=applyConvolutionMatrix(color,uClarityKernel[0],uClarityKernel[1],uClarityKernel[2],uClarityKernel[3],uClarityKernel[4],uClarityKernel[5],uClarityKernel[6],uClarityKernel[7],uClarityKernel[8],uClarityKernelWeight);color=applyGamma(color,uColorGamma);color=applyColorMatrix(color,uColorMatrix,uColorOffset);color=blendPremultipliedAlpha(uFillColor,color);color*=a;color=blendPremultipliedAlpha(color,texture(uTextureMarkup,vTexCoord));if(uColorVignette!=0.0){vec2 pos=gl_FragCoord.xy-offset;color=applyVignette(color,pos,center-offset,uColorVignette);}vec4 overlayColor=uOverlayColor*(1.0-overlayColorAlpha);overlayColor.rgb*=overlayColor.a;color=blendPremultipliedAlpha(color,overlayColor);if(uOverlayColor.a>0.0&&color.a<1.0&&uFillColor.a>0.0){color=blendPremultipliedAlpha(uFillColor,overlayColor);}color*=uOpacity;fragColor=color;}",["aPosition","aTexCoord"],["uMatrix","uTexture","uTextureMarkup","uTextureSize","uColorGamma","uColorVignette","uColorOffset","uColorMatrix","uClarityKernel","uClarityKernelWeight","uOpacity","uMaskOpacity","uMaskBounds","uMaskCornerRadius","uMaskFeather","uFillColor","uOverlayColor"]);T.useProgram(B.program);let O=lL(T,"#version 300 es\n\nin vec4 aPosition;in vec2 aNormal;in float aMiter;out vec2 vNormal;out float vMiter;uniform float uWidth;uniform mat4 uMatrix;void main(){vMiter=aMiter;vNormal=aNormal;float w=uWidth;gl_Position=uMatrix*vec4(aPosition.x+(aNormal.x*w*.5*aMiter),aPosition.y+(aNormal.y*w*.5*aMiter),0,1);}","\n##head\n##mask\nin vec2 vNormal;in float vMiter;uniform float uWidth;uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;float w=(uWidth-1.0)*.5;float d=1.0-abs(vMiter);float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);fillColor.a*=clamp(smoothstep(0.25,1.0,d*w),0.0,1.0);fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}",["aPosition","aNormal","aMiter"],["uColor","uCanvasColor","uMatrix","uWidth","uMaskBounds","uMaskOpacity"]),j=T.createBuffer(),_=(t,e,n,r)=>{let{program:o,locations:a}=O;T.useProgram(o),T.enableVertexAttribArray(a.aPosition),T.enableVertexAttribArray(a.aNormal),T.enableVertexAttribArray(a.aMiter);let l=lZ(t,r),s=5*Float32Array.BYTES_PER_ELEMENT,c=2*Float32Array.BYTES_PER_ELEMENT,d=4*Float32Array.BYTES_PER_ELEMENT;T.uniform1f(a.uWidth,e+2),T.uniform4fv(a.uColor,n),T.uniformMatrix4fv(a.uMatrix,!1,u),T.uniform4f(a.uCanvasColor,v[0],v[1],v[2],1),T.uniform1fv(a.uMaskBounds,$),T.uniform1f(a.uMaskOpacity,m),T.bindBuffer(T.ARRAY_BUFFER,j),T.bufferData(T.ARRAY_BUFFER,l,T.STATIC_DRAW),T.vertexAttribPointer(a.aPosition,2,T.FLOAT,!1,s,0),T.vertexAttribPointer(a.aNormal,2,T.FLOAT,!1,s,c),T.vertexAttribPointer(a.aMiter,1,T.FLOAT,!1,s,d),T.drawArrays(T.TRIANGLE_STRIP,0,l.length/5),T.disableVertexAttribArray(a.aPosition),T.disableVertexAttribArray(a.aNormal),T.disableVertexAttribArray(a.aMiter)},z=lL(T,"\n##head\nvoid main(){\n##matrix\n}","\n##head\n##mask\nuniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;\n##maskapply\nfillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}",["aPosition"],["uColor","uCanvasColor","uMatrix","uMaskBounds","uMaskOpacity"]),N=T.createBuffer(),U=(t,e)=>{let{program:n,locations:r}=z;return T.useProgram(n),T.enableVertexAttribArray(r.aPosition),T.uniform4fv(r.uColor,e),T.uniformMatrix4fv(r.uMatrix,!1,u),T.uniform1fv(r.uMaskBounds,$),T.uniform1f(r.uMaskOpacity,m),T.uniform4f(r.uCanvasColor,v[0],v[1],v[2],1),T.bindBuffer(T.ARRAY_BUFFER,N),T.bufferData(T.ARRAY_BUFFER,t,T.STATIC_DRAW),T.vertexAttribPointer(r.aPosition,2,T.FLOAT,!1,0,0),T.drawArrays(T.TRIANGLE_STRIP,0,t.length/2),T.disableVertexAttribArray(r.aPosition),t},W=lL(T,"\n##head\n##text\nin vec2 aRectCoord;out vec2 vRectCoord;void main(){vTexCoord=aTexCoord;vRectCoord=aRectCoord;\n##matrix\n}","\n##head\n##mask\nin vec2 vTexCoord;in vec2 vRectCoord;uniform sampler2D uTexture;uniform vec4 uTextureColor;uniform float uTextureOpacity;uniform vec4 uColor;uniform float uCornerRadius[4];uniform vec2 uSize;uniform vec2 uPosition;uniform vec4 uCanvasColor;void main(){\n##init\n##colorize\n##edgeaa\n##cornerradius\n##maskfeatherapply\n##maskapply\n##fragcolor\n}",["aPosition","aTexCoord","aRectCoord"],["uTexture","uColor","uMatrix","uCanvasColor","uTextureColor","uTextureOpacity","uPosition","uSize","uMaskBounds","uMaskOpacity","uMaskFeather","uCornerRadius"]),X=T.createBuffer(),V=T.createBuffer(),H=T.createBuffer(),Y=[0,0,0,0],G=function(t,n,o,a,l,s){let c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Y,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:l3,p=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[1,0,1,0,1,Math.max(x.width,e.width),1,Math.max(x.width,e.width)],{program:f,locations:g}=W;T.useProgram(f),T.enableVertexAttribArray(g.aPosition),T.enableVertexAttribArray(g.aTexCoord),T.enableVertexAttribArray(g.aRectCoord),T.uniform4fv(g.uColor,l),T.uniform4fv(g.uTextureColor,d),T.uniform1f(g.uTextureOpacity,c),T.uniform2fv(g.uSize,[n,o]),T.uniform2fv(g.uPosition,[t[2],t[3]]),T.uniform1fv(g.uCornerRadius,a),T.uniform4f(g.uCanvasColor,v[0],v[1],v[2],1),T.uniform1fv(g.uMaskFeather,p.map((t,e)=>e%2==0?t:t*r)),T.uniform1fv(g.uMaskBounds,$),T.uniform1f(g.uMaskOpacity,m),T.uniformMatrix4fv(g.uMatrix,!1,u);let y=w[s]&&w[s].texture?s:1;return T.uniform1i(g.uTexture,y),T.activeTexture(T.TEXTURE0+y),T.bindTexture(T.TEXTURE_2D,w[y].texture),T.bindBuffer(T.ARRAY_BUFFER,V),T.bufferData(T.ARRAY_BUFFER,h,T.STATIC_DRAW),T.vertexAttribPointer(g.aTexCoord,2,T.FLOAT,!1,0,0),T.bindBuffer(T.ARRAY_BUFFER,H),T.bufferData(T.ARRAY_BUFFER,l3,T.STATIC_DRAW),T.vertexAttribPointer(g.aRectCoord,2,T.FLOAT,!1,0,0),T.bindBuffer(T.ARRAY_BUFFER,X),T.bufferData(T.ARRAY_BUFFER,t,T.STATIC_DRAW),T.vertexAttribPointer(g.aPosition,2,T.FLOAT,!1,0,0),T.drawArrays(T.TRIANGLE_STRIP,0,t.length/2),T.disableVertexAttribArray(g.aPosition),T.disableVertexAttribArray(g.aTexCoord),T.disableVertexAttribArray(g.aRectCoord),t},K=lL(T,"\n##head\n##text\nvoid main(){vTexCoord=vec2(aTexCoord.x*2.0-1.0,aTexCoord.y*2.0-1.0);\n##matrix\n}","\n##head\n##mask\nin vec2 vTexCoord;uniform sampler2D uTexture;uniform float uTextureOpacity;uniform vec2 uRadius;uniform vec4 uColor;uniform int uInverted;uniform vec4 uCanvasColor;void main(){\n##init\nfloat ar=uRadius.x/uRadius.y;vec2 rAA=vec2(uRadius.x-1.0,uRadius.y-(1.0/ar));vec2 scaledPointSq=vec2((vTexCoord.x*uRadius.x)*(vTexCoord.x*uRadius.x),(vTexCoord.y*uRadius.y)*(vTexCoord.y*uRadius.y));float p=(scaledPointSq.x/(uRadius.x*uRadius.x))+(scaledPointSq.y/(uRadius.y*uRadius.y));float pAA=(scaledPointSq.x/(rAA.x*rAA.x))+(scaledPointSq.y/(rAA.y*rAA.y));a=smoothstep(1.0,p/pAA,p);if(uInverted==1)a=1.0-a;\n##maskapply\n##fragcolor\n}",["aPosition","aTexCoord"],["uTexture","uTextureOpacity","uColor","uCanvasColor","uMatrix","uRadius","uInverted","uMaskBounds","uMaskOpacity"]),q=T.createBuffer(),Z=T.createBuffer(),Q=function(t,e,n,r){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],{program:s,locations:c}=K;T.useProgram(s),T.enableVertexAttribArray(c.aPosition),T.enableVertexAttribArray(c.aTexCoord),T.uniform2fv(c.uRadius,[.5*e,.5*n]),T.uniform1i(c.uInverted,l?1:0),T.uniform4fv(c.uColor,r),T.uniformMatrix4fv(c.uMatrix,!1,u),T.uniform4f(c.uCanvasColor,v[0],v[1],v[2],1),T.uniform1fv(c.uMaskBounds,$),T.uniform1f(c.uMaskOpacity,m),T.uniform1i(c.uTexture,o),T.uniform1f(c.uTextureOpacity,a),T.activeTexture(T.TEXTURE0+o),T.bindTexture(T.TEXTURE_2D,w[o].texture),T.bindBuffer(T.ARRAY_BUFFER,Z),T.bufferData(T.ARRAY_BUFFER,l3,T.STATIC_DRAW),T.vertexAttribPointer(c.aTexCoord,2,T.FLOAT,!1,0,0),T.bindBuffer(T.ARRAY_BUFFER,q),T.bufferData(T.ARRAY_BUFFER,t,T.STATIC_DRAW),T.vertexAttribPointer(c.aPosition,2,T.FLOAT,!1,0,0),T.drawArrays(T.TRIANGLE_STRIP,0,t.length/2),T.disableVertexAttribArray(c.aPosition),T.disableVertexAttribArray(c.aTexCoord)},J=(t,e,n,o)=>{if(!n&&!o)return l3;let a=o.x/n.width,l=o.y/n.height,s=t/n.width/r,c=e/n.height/r;s-=a,c-=l;let u=c,d=s,h=c,p=s;return new Float32Array([-a,u,-a,-l,d,h,p,-l])},tt=(t,e)=>Math.floor(a_(t,0,Math.min((e.width-1)*.5,(e.height-1)*.5)));return{drawPath:(t,e,n,o)=>{t.length<2||_(t.map(t=>({x:t.x*r,y:t.y*r})),e*r,lj(n,o),!1)},drawTriangle:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,l=arguments.length>5?arguments[5]:void 0;if(!a)return;let s=t.map(t=>({x:t.x*r,y:t.y*r})),c=e2(s);(n||o)&&ei(s,n,o,c.x,c.y),er(s,e,c.x,c.y);let u=lJ(s);U(u,lj(a,l))},drawRect:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],l=arguments.length>4?arguments[4]:void 0,s=arguments.length>5?arguments[5]:void 0,c=arguments.length>6?arguments[6]:void 0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:void 0,h=arguments.length>9?arguments[9]:void 0,p=arguments.length>10?arguments[10]:void 0,f=arguments.length>11?arguments[11]:void 0,g=arguments.length>12&&void 0!==arguments[12]?arguments[12]:void 0,m=arguments.length>13?arguments[13]:void 0,$=ej(eS(t),r),y=l.map(e=>tt(e||0,t)).map(t=>t*a);if(s||c){let t;let r=eS($);r.x-=.5,r.y-=.5,r.width+=1,r.height+=1;let a=l0(r,e,n,o),l=lQ(a);m&&0===(t=lj(m))[3]&&(t[3]=.001),G(l,r.width,r.height,y,lj(s,f),c,f,t,J(r.width,r.height,u,d),g)}h&&(h=Math.min(h,$.width,$.height),_(l2($.x,$.y,$.width,$.height,e,y,n,o),h*r,lj(p,f),!0))},drawEllipse:(t,e,n,o,a,l,s,c,u,d,h,p)=>{let f=ej(eL(t.x-e,t.y-n,2*e,2*n),r);if(s||c){let t=eS(f);t.x-=.5,t.y-=.5,t.width+=1,t.height+=1;let e=l0(t,o,a,l),n=lQ(e);Q(n,t.width,t.height,lj(s,h),c,h,p)}u&&_(l1(f.x,f.y,f.width,f.height,o,a,l),u*r,lj(d,h),!0)},drawPreviewImage:function(t,n,s,c,u,d,h,p,f){let g,x=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,v=arguments.length>10?arguments[10]:void 0,k=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1,C=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,M=arguments.length>13&&void 0!==arguments[13]?arguments[13]:[1,0,1,0,1,b.width,1,b.width],S=arguments.length>14&&void 0!==arguments[14]?arguments[14]:[0,0,0,0],E=arguments.length>15&&void 0!==arguments[15]?arguments[15]:[0,0,0,0],R=arguments.length>16&&void 0!==arguments[16]?arguments[16]:[0,0,0,0],I=!(arguments.length>17)||void 0===arguments[17]||arguments[17],{program:P,locations:D}=B;s*=a,c*=a,t*=a,n*=a,lz(y=l_(),A,o,1,-(2*l)),lU(y,s,-c,l),lU(y,t,-n,0),lG(y,-h),lW(y,p),lU(y,-t,n,0),lY(y,d),lH(y,u),T.useProgram(P),T.enableVertexAttribArray(D.aPosition),T.enableVertexAttribArray(D.aTexCoord);let O=w[3];T.uniform1i(D.uTexture,3),T.uniform2f(D.uTextureSize,e.width,e.height),T.activeTexture(T.TEXTURE0+3),T.bindTexture(T.TEXTURE_2D,O.texture);let j=I?2:1,_=w[j];T.uniform1i(D.uTextureMarkup,j),T.activeTexture(T.TEXTURE0+j),T.bindTexture(T.TEXTURE_2D,_.texture),T.bindBuffer(T.ARRAY_BUFFER,L),T.vertexAttribPointer(D.aPosition,3,T.FLOAT,!1,0,0),T.bindBuffer(T.ARRAY_BUFFER,F),T.vertexAttribPointer(D.aTexCoord,2,T.FLOAT,!1,0,0),T.uniformMatrix4fv(D.uMatrix,!1,y),T.uniform4fv(D.uOverlayColor,R),T.uniform4fv(D.uFillColor,E),v?g=(g=v.reduce((t,e)=>t+e,0))<=0?1:g:(v=[0,0,0,0,1,0,0,0,0],g=-1),T.uniform1fv(D.uClarityKernel,v),T.uniform1f(D.uClarityKernelWeight,g),T.uniform1f(D.uColorGamma,1/k),T.uniform1f(D.uColorVignette,C),T.uniform4f(D.uColorOffset,f[4],f[9],f[14],f[19]),T.uniformMatrix4fv(D.uColorMatrix,!1,[f[0],f[1],f[2],f[3],f[5],f[6],f[7],f[8],f[10],f[11],f[12],f[13],f[15],f[16],f[17],f[18]]),T.uniform1f(D.uOpacity,x),T.uniform1f(D.uMaskOpacity,m),T.uniform1fv(D.uMaskBounds,$),T.uniform1fv(D.uMaskCornerRadius,S.map(t=>t*r)),T.uniform1fv(D.uMaskFeather,M.map((t,e)=>e%2==0?t:t*r)),T.drawArrays(T.TRIANGLE_STRIP,0,4),T.disableVertexAttribArray(D.aPosition),T.disableVertexAttribArray(D.aTexCoord)},setCanvasColor(t){v=t},drawToCanvas(){T.bindFramebuffer(T.FRAMEBUFFER,null),u=s,T.viewport(0,0,T.drawingBufferWidth,T.drawingBufferHeight),T.colorMask(!0,!0,!0,!1),T.clearColor(v[0],v[1],v[2],1),T.clear(T.COLOR_BUFFER_BIT)},drawToFramebuffer(){T.bindFramebuffer(T.FRAMEBUFFER,D),u=c,T.viewport(0,0,e.width,e.height),T.colorMask(!0,!0,!0,!0),T.clearColor(0,0,0,0),T.clear(T.COLOR_BUFFER_BIT)},addTexture:t=>M(lO(T,t),t),setTexture:S,reserveTexture:t=>{w[t]={}},removeTexture:t=>{let e=w[t];T.deleteTexture(e.texture),e.source instanceof HTMLCanvasElement&&tc(e.source),w[t]=void 0},getTextureSize:t=>{let e=w[t].source;return e&&{width:e.width,height:e.height}},getAvailableTextureIndex:C,enableMask(t,e){let n=t.x*a,r=t.y*a,o=t.width*a,l=t.height*a;p=(g=n)+o,h=x.height-r,f=x.height-(r+l),m=1-e,$=[h,p,f,g]},disableMask(){g=0,p=x.width,h=x.height,m=1,$=[h,p,f=0,g]},resize:(r,u,h)=>{a=h,b.width=r,b.height=u,x.width=r*h,x.height=u*h,o=tO(x.width,x.height),t.width=x.width,t.height=x.height,lN(s=l_(),0,x.width,x.height,0,-1,1),c=l_();let p=e.width*h,f=e.height*h;lN(c,0,p,f,0,-1,1),lU(c,0,f,0),lX(c,1),lV(c,-1),T.bindTexture(T.TEXTURE_2D,w[2].texture),T.texImage2D(T.TEXTURE_2D,0,T.RGBA,e.width,e.height,0,T.RGBA,T.UNSIGNED_BYTE,null),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_MIN_FILTER,T.LINEAR),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_S,T.CLAMP_TO_EDGE),T.texParameteri(T.TEXTURE_2D,T.TEXTURE_WRAP_T,T.CLAMP_TO_EDGE),T.bindFramebuffer(T.FRAMEBUFFER,D),T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_2D,w[2].texture,0);let g=n.width*h,m=n.height*h,$=-.5*g,y=.5*m,v=.5*g,k=-.5*m;d=new Float32Array([$,k,0,$,y,0,v,k,0,v,y,0]),T.bindBuffer(T.ARRAY_BUFFER,L),T.bufferData(T.ARRAY_BUFFER,d,T.STATIC_DRAW),l=-(n.height/2/E*(x.height/n.height)*1)},release(){t.width=1,t.height=1}}};function l8(t){let e,n,r,o;return{c(){e=oE("div"),n=oE("canvas"),oL(e,"class","DokaCanvas")},m(a,l){oS(a,e,l),oM(e,n),t[15](n),r||(o=[oD(n,"measure",t[4]),ox(lv.call(null,n))],r=!0)},p:oi,i:oi,o:oi,d(n){n&&oA(e),t[15](null),r=!1,os(o)}}}function l7(t,e,n){let r,o,a,l,s,c,u;let d=oX(),h=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],{animate:p}=e,{imageData:f}=e,{imageSize:g}=e,{imageProps:m}=e,{imagePreviews:$=[]}=e,{maskRect:y}=e,{pixelRatio:x=1}=e,{willRender:b=tj}=e,{loadImageData:v=tj}=e,{backgroundColor:w}=e,k=(t,e)=>t.set(e,{hard:!p}),C=(t,e)=>{let[n,r,o]=t,[a,l,s,c]=e;return[a*c+n*(1-c),l*c+r*(1-c),s*c+o*(1-c),1]},M={precision:1e-4},S={precision:.01*M.precision},A=lc(void 0,{duration:250});op(t,A,t=>n(22,o=t));let E=lu(void 0,M),T=lu(void 0,S),R=lu(void 0,M),I=lu(void 0,S),P=lu(void 0,S),D=lu(void 0,S),L=lu(void 0,S),F=lu([...h],M),B=a$(void 0),O=lu(0,S),j=lu(1,S),_=a$();op(t,_,t=>n(24,a=t));let z=a$(),N=ay([R,E,I,T,P,O,F,_,j,B,D,L,z,A],(t,e)=>{let[n,r,o,a,l,s,c,u,d,h,p,f,g,$]=t;if(!m||!$)return e(void 0);let y=a_(d,0,1);e({origin:n,translation:r,perspective:o,rotation:a,scale:l,colorMatrix:c,opacity:a_(s,0,1),clarity:h,gamma:p,vignette:f,mask:u,maskOpacity:y,overlayColor:[$[0],$[1],$[2],y],backgroundColor:g})});op(t,N,t=>n(21,r=t));let U=null,W=null,X=null,V=t=>{let{origin:e,translation:n,rotation:r,scale:a,colorMatrix:l,opacity:s,clarity:c,gamma:u,vignette:d,offset:p,maskFeather:f,maskCornerRadius:g,backgroundColor:m,overlayColor:$,enableShapes:y}=t,x=n.x,b=n.y;p&&(x+=p.x-.5*W,b+=p.y-.5*X),m[3]<1&&m[3]>0&&(m=C(o,m)),U.drawPreviewImage(e.x,e.y,x,b,r.x,r.y,r.z,a,l||h,s,c,u,d,f,g,m,$,y)},H=new Map([]),Y=t=>{let{backgroundImage:e}=t,n=H.get(e);return n||(n=U.getAvailableTextureIndex(),U.reserveTexture(n),H.set(e,n),v(e).then(t=>{U.setTexture(n,t),requestAnimationFrame(u)}).catch(t=>{console.error(t)})),n},G=ic(),K=t=>{let{text:e,textAlign:n,fontFamily:r,fontSize:o,fontWeight:a,fontVariant:l,fontStyle:s,lineHeight:c,width:u}=t;iu(G,{fontSize:o,fontFamily:r,fontWeight:a,fontVariant:l,fontStyle:s,textAlign:n});let d=u?ib(G,e,u):e,h=iP({...t,text:d}),p=H.get(h);if(p)return p;let f=ic();iu(f,{fontSize:o,fontFamily:r,fontWeight:a,fontVariant:l,fontStyle:s,textAlign:n}),ig(f,d,{fontSize:o,fontFamily:r,fontWeight:a,fontVariant:l,fontStyle:s,textAlign:n,lineHeight:c});let g=f.canvas.width;return f.canvas.width+=20,iu(f,{fontSize:o,fontFamily:r,fontWeight:a,fontVariant:l,fontStyle:s,textAlign:n,color:[1,0,1]}),iv(f,d,{fontSize:o,textAlign:n,lineHeight:c,lineWidth:g}),p=U.addTexture(f.canvas),H.set(h,p),p},q=t=>{let e;if(t.backgroundImage)e=Y(t);else if(ne(t.text)){if(t.width&&t.width<1||t.height&&t.height<1)return;e=K(t)}return e},Z=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(t=>{let e=q(t);if(n0(t.points))3===t.points.length&&t.backgroundColor?U.drawTriangle(t.points,t.rotation,t.flipX,t.flipY,t.backgroundColor,t.strokeWidth,t.strokeColor,t.opacity):U.drawPath(t.points,t.strokeWidth,t.strokeColor,t.opacity);else if(nY(t.rx))U.drawEllipse(t,t.rx,t.ry,t.rotation,t.flipX,t.flipY,t.backgroundColor,e,t.strokeWidth,t.strokeColor,t.opacity,t.inverted);else if(ne(t.text)&&e||t.width){let n,r,o,a;let l=e&&U.getTextureSize(e),s=[t.cornerRadius,t.cornerRadius,t.cornerRadius,t.cornerRadius];if(n=t.width?t:{x:t.x,y:t.y,...l},l){if(t.backgroundImage&&t.backgroundSize){let e=tO(l.width,l.height);if("contain"===t.backgroundSize){let a=eq(t,e,n);r=es(a),o=tH((t.width-r.width)*.5,(t.height-r.height)*.5)}else if("cover"===t.backgroundSize){let a=eK(t,e,n);r=es(a),o=tH(a.x,a.y),o=tH((t.width-r.width)*.5,(t.height-r.height)*.5)}}else t.text&&t.width?(r=l,o=tH(0,0),t.height||(t.height=l.height),t.x-=20,t.width+=40,"left"===t.textAlign&&(o.x=20),"center"===t.textAlign&&(o.x=10+(t.width-l.width)*.5),"right"===t.textAlign&&(o.x=t.width-l.width)):t.text&&(o=tH(0,0),r={width:n.width,height:n.height},n.width-=20);t.text&&(a=t.color)}U.drawRect(n,t.rotation,t.flipX,t.flipY,s,t.backgroundColor,e,r,o,t.strokeWidth,t.strokeColor,t.opacity,void 0,a)}return e?[t.id,e]:void 0}).filter(Boolean)},Q=()=>{let t=b({opacity:r.opacity,rotation:r.rotation,scale:r.scale,size:s,backgroundColor:[...o]});t.backgroundColor=[...o],t.image=r,t.imageMask=r.mask,t.imageMaskOpacity=r.maskOpacity,t.imagePreviews=$;let e=t.annotationShapes.length>0,n=r.backgroundColor[3]>0,l=r.maskOpacity<1,c=[];if(l&&n){let e=t.backgroundColor[0],n=t.backgroundColor[1],o=t.backgroundColor[2],a=1-r.maskOpacity,l=r.backgroundColor[0]*a,s=r.backgroundColor[1]*a,c=r.backgroundColor[2]*a,u=1-a;t.backgroundColor=[l+e*u,s+n*u,c+o*u,1]}U.setCanvasColor(t.backgroundColor),e&&(U.disableMask(),U.drawToFramebuffer(),c.push(...Z(t.annotationShapes))),U.drawToCanvas(),U.enableMask(t.imageMask,t.imageMaskOpacity),n&&U.drawRect(a,0,!1,!1,[0,0,0,0],C(o,r.backgroundColor)),t.image.enableShapes=e,V(t.image),c.push(...Z(t.decorationShapes)),U.disableMask(),c.push(...Z(t.interfaceShapes)),t.imagePreviews.forEach(t=>{U.enableMask(t.mask,t.maskOpacity),n&&U.drawRect(t.mask,0,!1,!1,t.maskCornerRadius,r.backgroundColor,void 0,void 0,void 0,void 0,void 0,t.opacity,t.maskFeather),V({...t,backgroundColor:r.backgroundColor,overlayColor:[0,0,0,0],enableShapes:!1})}),U.disableMask(),H.forEach((t,e,n)=>{let r=!!c.find(e=>{let[n,r]=e;return r===t});r||(H.delete(e),U.removeTexture(t))})};return oN().$$.after_update.push(()=>u()),oU(()=>n(16,U=l6(l,f,g,x))),oW(()=>{U&&(U.release(),tc(G.canvas))}),t.$$set=t=>{"animate"in t&&n(5,p=t.animate),"imageData"in t&&n(6,f=t.imageData),"imageSize"in t&&n(7,g=t.imageSize),"imageProps"in t&&n(8,m=t.imageProps),"imagePreviews"in t&&n(9,$=t.imagePreviews),"maskRect"in t&&n(10,y=t.maskRect),"pixelRatio"in t&&n(11,x=t.pixelRatio),"willRender"in t&&n(12,b=t.willRender),"loadImageData"in t&&n(13,v=t.loadImageData),"backgroundColor"in t&&n(14,w=t.backgroundColor)},t.$$.update=()=>{16384&t.$$.dirty[0]&&w&&k(A,w),256&t.$$.dirty[0]&&m&&k(R,m.origin),256&t.$$.dirty[0]&&m&&k(E,m.translation),256&t.$$.dirty[0]&&m&&k(I,m.perspective),256&t.$$.dirty[0]&&m&&k(T,m.rotation),256&t.$$.dirty[0]&&m&&k(P,m.scale),256&t.$$.dirty[0]&&m&&k(F,m.colorMatrix||[...h]),256&t.$$.dirty[0]&&m&&k(L,m.vignette||0),256&t.$$.dirty[0]&&m&&k(D,m.gamma||1),256&t.$$.dirty[0]&&m&&B.set(m.convolutionMatrix&&m.convolutionMatrix.clarity||void 0),256&t.$$.dirty[0]&&m&&k(O,1),256&t.$$.dirty[0]&&m&&k(j,nY(m.maskOpacity)?m.maskOpacity:1),1024&t.$$.dirty[0]&&y&&_.set(y),256&t.$$.dirty[0]&&m&&z.set(m.backgroundColor),393216&t.$$.dirty[0]&&(s={width:W,height:X}),2555904&t.$$.dirty[0]&&n(20,c=U&&W&&X&&r),460800&t.$$.dirty[0]&&W&&X&&U&&U.resize(W,X,x),1048576&t.$$.dirty[0]&&(u=c?Q:J)},[l,A,_,N,t=>{n(17,W=t.detail.width),n(18,X=t.detail.height),d("measure",{width:W,height:X})},p,f,g,m,$,y,x,b,v,w,function(t){oK[t?"unshift":"push"](()=>{n(0,l=t)})}]}class l9 extends af{constructor(t){super(),ap(this,t,l7,l8,ou,{animate:5,imageData:6,imageSize:7,imageProps:8,imagePreviews:9,maskRect:10,pixelRatio:11,willRender:12,loadImageData:13,backgroundColor:14},[-1,-1])}}var st=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Boolean,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:" ";return t.filter(e).join(n)};let se=t=>({tab:8&t}),sn=t=>({tab:t[16]});function si(t,e,n){let r=t.slice();return r[16]=e[n],r}function sr(t,e){let n,r,o,a,l,s,c,u,d,h;let p=e[10].default,f=of(p,e,e[9],sn);function g(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e[11](e[16],...n)}function m(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e[12](e[16],...n)}return{key:t,first:null,c(){n=oE("li"),r=oE("button"),f&&f.c(),c=oI(),oL(r,"role","tab"),oL(r,"aria-controls",o=e[16].href),oL(r,"id",a=e[16].tabId),oL(r,"aria-selected",l=e[16].selected),r.disabled=s=e[16].disabled,this.first=n},m(t,e){oS(t,n,e),oM(n,r),f&&f.m(r,null),oM(n,c),u=!0,d||(h=[oD(r,"keydown",g),oD(r,"click",m)],d=!0)},p(t,n){e=t,f&&f.p&&520&n&&om(f,p,e,e[9],n,se,sn),(!u||8&n&&o!==(o=e[16].href))&&oL(r,"aria-controls",o),(!u||8&n&&a!==(a=e[16].tabId))&&oL(r,"id",a),(!u||8&n&&l!==(l=e[16].selected))&&oL(r,"aria-selected",l),(!u||8&n&&s!==(s=e[16].disabled))&&(r.disabled=s)},i(t){u||(o9(f,t),u=!0)},o(t){at(f,t),u=!1},d(t){t&&oA(n),f&&f.d(t),d=!1,os(h)}}}function so(t){let e,n,r;let o=[],a=new Map,l=t[3],s=t=>t[16].id;for(let e=0;e<l.length;e+=1){let n=si(t,l,e),r=s(n);a.set(r,o[e]=sr(r,n))}return{c(){e=oE("ul");for(let t=0;t<o.length;t+=1)o[t].c();oL(e,"class",n=st(["DokaTabList",t[0]])),oL(e,"role","tablist"),oL(e,"data-layout",t[1])},m(n,a){oS(n,e,a);for(let t=0;t<o.length;t+=1)o[t].m(e,null);t[13](e),r=!0},p(t,l){let[c]=l;if(568&c){let n=t[3];o8(),o=aa(o,c,s,1,t,n,a,e,ao,sr,null,si),o7()}(!r||1&c&&n!==(n=st(["DokaTabList",t[0]])))&&oL(e,"class",n),(!r||2&c)&&oL(e,"data-layout",t[1])},i(t){if(!r){for(let t=0;t<l.length;t+=1)o9(o[t]);r=!0}},o(t){for(let t=0;t<o.length;t+=1)at(o[t]);r=!1},d(n){n&&oA(e);for(let t=0;t<o.length;t+=1)o[t].d();t[13](null)}}}function sa(t,e,n){let r,o,{$$slots:a={},$$scope:l}=e,{class:s}=e,{name:c}=e,{selected:u}=e,{tabs:d=[]}=e,{layout:h}=e,p=oX(),f=t=>{let e=r.querySelectorAll('button[role="tab"]')[t];e&&e.focus()},g=(t,e)=>{t.preventDefault(),t.stopPropagation(),p("select",e)},m=(t,e)=>{let{key:n}=t;if(!/arrow/i.test(n))return;let r=d.findIndex(t=>t.id===e);return/right|down/i.test(n)?f(r<d.length-1?r+1:0):/left|up/i.test(n)?f(r>0?r-1:d.length-1):void 0};return t.$$set=t=>{"class"in t&&n(0,s=t.class),"name"in t&&n(6,c=t.name),"selected"in t&&n(7,u=t.selected),"tabs"in t&&n(8,d=t.tabs),"layout"in t&&n(1,h=t.layout),"$$scope"in t&&n(9,l=t.$$scope)},t.$$.update=()=>{448&t.$$.dirty&&n(3,o=d.map(t=>{let e=t.id===u;return{...t,tabId:"doka-tab-".concat(c,"-").concat(t.id),href:"#doka-".concat(c,"-").concat(t.id),selected:e}}))},[s,h,r,o,g,m,c,u,d,l,a,(t,e)=>m(e,t.id),(t,e)=>g(e,t.id),function(t){oK[t?"unshift":"push"](()=>{n(2,r=t)})}]}class sl extends af{constructor(t){super(),ap(this,t,sa,so,ou,{class:0,name:6,selected:7,tabs:8,layout:1})}}let ss=t=>({panel:16&t,panelIsActive:16&t}),sc=t=>({panel:t[11],panelIsActive:!t[15]});function su(t,e,n){let r=t.slice();return r[11]=e[n].id,r[12]=e[n].panelId,r[13]=e[n].tabindex,r[14]=e[n].labelledBy,r[15]=e[n].hidden,r[3]=e[n].visible,r}function sd(t,e){let n,r,o,a,l,s,c,u,d;let h=e[9].default,p=of(h,e,e[8],sc);return{key:t,first:null,c(){n=oE("div"),p&&p.c(),r=oI(),oL(n,"class",o=st(["DokaTabPanel",e[1]])),n.hidden=a=e[15],oL(n,"id",l=e[12]),oL(n,"tabindex",s=e[13]),oL(n,"aria-labelledby",c=e[14]),oL(n,"data-inert",u=!e[3]),this.first=n},m(t,e){oS(t,n,e),p&&p.m(n,null),oM(n,r),d=!0},p(t,e){p&&p.p&&272&e&&om(p,h,t,t[8],e,ss,sc),(!d||2&e&&o!==(o=st(["DokaTabPanel",t[1]])))&&oL(n,"class",o),(!d||16&e&&a!==(a=t[15]))&&(n.hidden=a),(!d||16&e&&l!==(l=t[12]))&&oL(n,"id",l),(!d||16&e&&s!==(s=t[13]))&&oL(n,"tabindex",s),(!d||16&e&&c!==(c=t[14]))&&oL(n,"aria-labelledby",c),(!d||16&e&&u!==(u=!t[3]))&&oL(n,"data-inert",u)},i(t){d||(o9(p,t),d=!0)},o(t){at(p,t),d=!1},d(t){t&&oA(n),p&&p.d(t)}}}function sh(t){let e,n,r,o,a;let l=[],s=new Map,c=t[4],u=t=>t[11];for(let e=0;e<c.length;e+=1){let n=su(t,c,e),r=u(n);s.set(r,l[e]=sd(r,n))}return{c(){e=oE("div");for(let t=0;t<l.length;t+=1)l[t].c();oL(e,"class",n=st(["DokaTabPanels",t[0]])),oL(e,"style",t[2])},m(n,s){oS(n,e,s);for(let t=0;t<l.length;t+=1)l[t].m(e,null);r=!0,o||(a=[oD(e,"measure",t[10]),ox(lv.call(null,e))],o=!0)},p(t,o){let[a]=o;if(274&a){let n=t[4];o8(),l=aa(l,a,u,1,t,n,s,e,ao,sd,null,su),o7()}(!r||1&a&&n!==(n=st(["DokaTabPanels",t[0]])))&&oL(e,"class",n),(!r||4&a)&&oL(e,"style",t[2])},i(t){if(!r){for(let t=0;t<c.length;t+=1)o9(l[t]);r=!0}},o(t){for(let t=0;t<l.length;t+=1)at(l[t]);r=!1},d(t){t&&oA(e);for(let t=0;t<l.length;t+=1)l[t].d();o=!1,os(a)}}}function sp(t,e,n){let r,{$$slots:o={},$$scope:a}=e,{class:l}=e,{name:s}=e,{selected:c}=e,{visible:u}=e,{panelClass:d}=e,{panels:h=[]}=e,{style:p}=e;return t.$$set=t=>{"class"in t&&n(0,l=t.class),"name"in t&&n(5,s=t.name),"selected"in t&&n(6,c=t.selected),"visible"in t&&n(3,u=t.visible),"panelClass"in t&&n(1,d=t.panelClass),"panels"in t&&n(7,h=t.panels),"style"in t&&n(2,p=t.style),"$$scope"in t&&n(8,a=t.$$scope)},t.$$.update=()=>{232&t.$$.dirty&&n(4,r=h.map(t=>{let e=t===c,n=!u||-1!==u.indexOf(t);return{id:t,panelId:"doka-".concat(s,"_").concat(t),labelledBy:"doka-tab-".concat(s,"_").concat(t),hidden:!e,visible:n,tabindex:e?0:-1}}))},[l,d,p,u,r,s,c,h,a,o,function(e){oY(t,e)}]}class sf extends af{constructor(t){super(),ap(this,t,sp,sh,ou,{class:0,name:5,selected:6,visible:3,panelClass:1,panels:7,style:2})}}function sg(t){let e,n,r,o,a;let l=[t[7]];function s(e){t[17].call(null,e)}var c=t[11];function u(t){let e={};for(let t=0;t<l.length;t+=1)e=oo(e,l[t]);return void 0!==t[3]&&(e.name=t[3]),{props:e}}return c&&(n=new c(u(t)),oK.push(()=>ac(n,"name",s)),t[18](n),n.$on("measure",t[19])),{c(){e=oE("div"),n&&au(n.$$.fragment),oL(e,"data-util",t[3]),oL(e,"class",o=st(["DokaPanel",t[1]])),oL(e,"style",t[6])},m(t,r){oS(t,e,r),n&&ad(n,e,null),a=!0},p(t,d){let[h]=d,p=128&h?al(l,[as(t[7])]):{};if(!r&&8&h&&(r=!0,p.name=t[3],o1(()=>r=!1)),c!==(c=t[11])){if(n){o8();let t=n;at(t.$$.fragment,1,0,()=>{ah(t,1)}),o7()}c?(n=new c(u(t)),oK.push(()=>ac(n,"name",s)),t[18](n),n.$on("measure",t[19]),au(n.$$.fragment),o9(n.$$.fragment,1),ad(n,e,null)):n=null}else c&&n.$set(p);(!a||8&h)&&oL(e,"data-util",t[3]),(!a||2&h&&o!==(o=st(["DokaPanel",t[1]])))&&oL(e,"class",o),(!a||64&h)&&oL(e,"style",t[6])},i(t){a||(n&&o9(n.$$.fragment,t),a=!0)},o(t){n&&at(n.$$.fragment,t),a=!1},d(r){r&&oA(e),t[18](null),n&&ah(n)}}}function sm(t,e,n){let r,o,a,l,s,c,u,d;let h=oX(),{isActive:p=!0}=e,{stores:f}=e,{content:g}=e,{component:m}=e,{locale:$}=e,{class:y}=e,x=lu(0),b=ay(x,t=>a_(t,0,1));op(t,b,t=>n(22,r=t));let v=!p,w=a$(p);op(t,w,t=>n(23,o=t));let k={isActive:ay(w,t=>t),isActiveFraction:ay(b,t=>t),isVisible:ay(b,t=>t>0)},C=g.view,M=la(C),S=Object.keys(g.props||{}).reduce((t,e)=>(M.includes(e)&&(t[e]=g.props[e]),t),{}),A=Object.keys(k).reduce((t,e)=>(M.includes(e)&&(t[e]=k[e]),t),{}),E=!1;return oU(()=>{n(4,E=!0),clearTimeout(c),c=setTimeout(()=>{!a&&s&&h("measure",{...s})},0)}),t.$$set=t=>{"isActive"in t&&n(12,p=t.isActive),"stores"in t&&n(13,f=t.stores),"content"in t&&n(14,g=t.content),"component"in t&&n(0,m=t.component),"locale"in t&&n(15,$=t.locale),"class"in t&&n(1,y=t.class)},t.$$.update=()=>{4101&t.$$.dirty&&a&&p&&m&&h("measure",a),4096&t.$$.dirty&&x.set(p?1:0),5242880&t.$$.dirty&&(r<=0&&!v?(n(20,v=!0),h("hide")):r>0&&v&&(n(20,v=!1),h("show"))),4194304&t.$$.dirty&&h("fade",r),4194304&t.$$.dirty&&n(6,u=r<1?"opacity: ".concat(r):void 0),4096&t.$$.dirty&&oy(w,o=p,o),40960&t.$$.dirty&&n(7,d={...S,...A,stores:f,locale:$})},[m,y,a,l,E,s,u,d,h,b,w,C,p,f,g,$,x,function(t){n(3,l=t)},function(t){oK[t?"unshift":"push"](()=>{n(0,m=t)})},t=>{n(5,s={...t.detail}),E&&(n(2,a=t.detail),h("measure",{...a}))}]}class s$ extends af{get opacity(){return this.$$.ctx[16]}constructor(t){super(),ap(this,t,sm,sg,ou,{isActive:12,stores:13,content:14,component:0,locale:15,class:1,opacity:16})}}function sy(t){let e,n,r;let o=t[5].default,a=of(o,t,t[4],null);return{c(){e=oT("svg"),a&&a.c(),oL(e,"class",t[3]),oL(e,"style",t[2]),oL(e,"width",t[0]),oL(e,"height",t[1]),oL(e,"viewBox",n="0 0 "+t[0]+"\n    "+t[1]),oL(e,"xmlns","http://www.w3.org/2000/svg"),oL(e,"aria-hidden","true"),oL(e,"focusable","false"),oL(e,"stroke-linecap","round"),oL(e,"stroke-linejoin","round")},m(t,n){oS(t,e,n),a&&a.m(e,null),r=!0},p(t,l){let[s]=l;a&&a.p&&16&s&&om(a,o,t,t[4],s,null,null),(!r||8&s)&&oL(e,"class",t[3]),(!r||4&s)&&oL(e,"style",t[2]),(!r||1&s)&&oL(e,"width",t[0]),(!r||2&s)&&oL(e,"height",t[1]),(!r||3&s&&n!==(n="0 0 "+t[0]+"\n    "+t[1]))&&oL(e,"viewBox",n)},i(t){r||(o9(a,t),r=!0)},o(t){at(a,t),r=!1},d(t){t&&oA(e),a&&a.d(t)}}}function sx(t,e,n){let{$$slots:r={},$$scope:o}=e,{width:a=24}=e,{height:l=24}=e,{style:s}=e,{class:c}=e;return t.$$set=t=>{"width"in t&&n(0,a=t.width),"height"in t&&n(1,l=t.height),"style"in t&&n(2,s=t.style),"class"in t&&n(3,c=t.class),"$$scope"in t&&n(4,o=t.$$scope)},[a,l,s,c,o,r]}class sb extends af{constructor(t){super(),ap(this,t,sx,sy,ou,{width:0,height:1,style:2,class:3})}}var sv=(t,e)=>e===t.target||e.contains(t.target);function sw(t){let e,n;return e=new sb({props:{class:"DokaButtonIcon",$$slots:{default:[sk]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};1048578&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function sk(t){let e;return{c(){e=oT("g")},m(n,r){oS(n,e,r),e.innerHTML=t[1]},p(t,n){2&n&&(e.innerHTML=t[1])},d(t){t&&oA(e)}}}function sC(t){let e,n;return{c(){e=oE("span"),n=oR(t[0]),oL(e,"class",t[11])},m(t,r){oS(t,e,r),oM(e,n)},p(t,r){1&r&&oB(n,t[0]),2048&r&&oL(e,"class",t[11])},d(t){t&&oA(e)}}}function sM(t){var e;let n,r,o,a,l,s,c,u,d;let h=t[18].default,p=of(h,t,t[20],null),f=p||(u=(e=t)[1]&&sw(e),d=e[0]&&sC(e),{c(){l=oE("span"),u&&u.c(),s=oI(),d&&d.c(),oL(l,"class",e[9])},m(t,e){oS(t,l,e),u&&u.m(l,null),oM(l,s),d&&d.m(l,null),c=!0},p(t,e){t[1]?u?(u.p(t,e),2&e&&o9(u,1)):((u=sw(t)).c(),o9(u,1),u.m(l,s)):u&&(o8(),at(u,1,1,()=>{u=null}),o7()),t[0]?d?d.p(t,e):((d=sC(t)).c(),d.m(l,null)):d&&(d.d(1),d=null),(!c||512&e)&&oL(l,"class",t[9])},i(t){c||(o9(u),c=!0)},o(t){at(u),c=!1},d(t){t&&oA(l),u&&u.d(),d&&d.d()}});return{c(){n=oE("button"),f&&f.c(),oL(n,"type",t[4]),oL(n,"style",t[2]),n.disabled=t[3],oL(n,"class",t[10]),oL(n,"title",t[0])},m(e,l){oS(e,n,l),f&&f.m(n,null),t[19](n),r=!0,o||(a=[oD(n,"keydown",function(){oc(t[6])&&t[6].apply(this,arguments)}),oD(n,"click",function(){oc(t[5])&&t[5].apply(this,arguments)}),ox(t[7].call(null,n))],o=!0)},p(e,o){let[a]=o;t=e,p?p.p&&1048576&a&&om(p,h,t,t[20],a,null,null):f&&f.p&&2563&a&&f.p(t,a),(!r||16&a)&&oL(n,"type",t[4]),(!r||4&a)&&oL(n,"style",t[2]),(!r||8&a)&&(n.disabled=t[3]),(!r||1024&a)&&oL(n,"class",t[10]),(!r||1&a)&&oL(n,"title",t[0])},i(t){r||(o9(f,t),r=!0)},o(t){at(f,t),r=!1},d(e){e&&oA(n),f&&f.d(e),t[19](null),o=!1,os(a)}}}function sS(t,e,n){let r,o,a,l,{$$slots:s={},$$scope:c}=e,{class:u}=e,{label:d}=e,{labelClass:h}=e,{innerClass:p}=e,{hideLabel:f=!1}=e,{icon:g}=e,{style:m}=e,{disabled:$}=e,{type:y="button"}=e,{onclick:x}=e,{onkeydown:b}=e,{action:v=()=>{}}=e;return t.$$set=t=>{"class"in t&&n(12,u=t.class),"label"in t&&n(0,d=t.label),"labelClass"in t&&n(13,h=t.labelClass),"innerClass"in t&&n(14,p=t.innerClass),"hideLabel"in t&&n(15,f=t.hideLabel),"icon"in t&&n(1,g=t.icon),"style"in t&&n(2,m=t.style),"disabled"in t&&n(3,$=t.disabled),"type"in t&&n(4,y=t.type),"onclick"in t&&n(5,x=t.onclick),"onkeydown"in t&&n(6,b=t.onkeydown),"action"in t&&n(7,v=t.action),"$$scope"in t&&n(20,c=t.$$scope)},t.$$.update=()=>{16384&t.$$.dirty&&n(9,o=st(["DokaButtonInner",p])),36864&t.$$.dirty&&n(10,a=st(["DokaButton",f&&"DokaButtonIconOnly",u])),40960&t.$$.dirty&&n(11,l=st([f?"implicit":"DokaButtonLabel",h]))},[d,g,m,$,y,x,b,v,r,o,a,l,u,h,p,f,t=>sv(t,r),()=>r,s,function(t){oK[t?"unshift":"push"](()=>{n(8,r=t)})},c]}class sA extends af{get isEventTarget(){return this.$$.ctx[16]}get getElement(){return this.$$.ctx[17]}constructor(t){super(),ap(this,t,sS,sM,ou,{class:12,label:0,labelClass:13,innerClass:14,hideLabel:15,icon:1,style:2,disabled:3,type:4,onclick:5,onkeydown:6,action:7,isEventTarget:16,getElement:17})}}var sE=(t,e)=>{let n=t.findIndex(e);if(n>=0)return t.splice(n,1)};let sT=t=>nY(t.button)&&0!==t.button,sR=(t,e)=>(e-t)/t;var sI=function(t){let e,n,r,o,a,l,s,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{inertia:u=!1,matchTarget:d=!1,pinch:h=!1,getEventPosition:p=t=>tH(t.clientX,t.clientY)}=c;function f(e,n){t.dispatchEvent(new CustomEvent(e,{detail:n}))}function g(){r&&r(),r=void 0}let m=[],$=t=>{let e={timeStamp:t.timeStamp,timeStampInitial:t.timeStamp,position:p(t),origin:p(t),velocity:tV(),translation:tV(),interactionState:void 0,event:t};m.push(e),e.interactionState=S(m)},y=t=>{let e=sE(m,e=>e.event.pointerId===t.pointerId);if(e)return e[0]},x=t=>m.findIndex(e=>e.event.pointerId===t.pointerId),b=t=>{t.origin.x=t.position.x,t.origin.y=t.position.y,t.translation.x=0,t.translation.y=0},v=t=>{let e=w(t);if(!e)return;let{timeStamp:n}=t,r=p(t),o=Math.max(1,n-e.timeStamp);e.velocity.x=(r.x-e.position.x)/o,e.velocity.y=(r.y-e.position.y)/o,e.translation.x=r.x-e.origin.x,e.translation.y=r.y-e.origin.y,e.timeStamp=n,e.position.x=r.x,e.position.y=r.y,e.event=t},w=t=>{let e=x(t);if(!(e<0))return m[e]},k=()=>1===m.length,C=()=>2===m.length,M=(t,e)=>{let n=t.reduce((t,n)=>t+=ee(e,n.position),0);return n/t.length},S=t=>{let e=en(t.map(t=>t.position)),n=M(t,e);return{center:e,distance:n,velocity:en(t.map(t=>t.velocity)),translation:en(t.map(t=>t.translation))}},A=0;function E(e){C()||sT(e)||d&&e.target!==t||(g(),$(e),k()?(document.documentElement.addEventListener("pointermove",T),document.documentElement.addEventListener("pointerup",R),document.documentElement.addEventListener("pointercancel",R),s=!1,l=0,a=tV(),o=void 0,f("interactionstart",{origin:tq(w(e).origin)})):h&&(s=!0,o=ee(m[0].position,m[1].position),a.x+=m[0].translation.x,a.y+=m[0].translation.y,b(m[0])))}function T(t){t.preventDefault(),v(t);let e=l,n=tq(m[0].translation);if(h&&C()){n.x+=m[1].translation.x,n.y+=m[1].translation.y;let t=ee(m[0].position,m[1].position);e+=sR(o,t)}n.x+=a.x,n.y+=a.y,f("interactionupdate",{translation:n,scalar:h?e:void 0})}function R(t){let c=y(t);if(h&&k()){let t=ee(m[0].position,c.position);l=(l||0)+sR(o,t),a.x+=m[0].translation.x+c.translation.x,a.y+=m[0].translation.y+c.translation.y,b(m[0])}let d=!1,p=!1;if(!s){let t=performance.now(),n=t-c.timeStampInitial,r=et(c.translation);d=r<64&&n<300,p=!!(e&&d&&t-A<700&&128>et(e,c.position)),d&&(e=tq(c.position),A=t)}if(m.length>0)return;document.documentElement.removeEventListener("pointermove",T),document.documentElement.removeEventListener("pointerup",R),document.documentElement.removeEventListener("pointercancel",R);let g=tq(c.translation),$=tq(c.velocity),x=!1;f("interactionrelease",{isTap:d,isDoubleTap:p,translation:g,scalar:l,preventInertia:()=>x=!0});let v=ee($);if(x||!u||v<.25)return P(g,{isTap:d,isDoubleTap:p});(n=lc(tq(g),{easing:ll,duration:80*v})).set({x:g.x+50*$.x,y:g.y+50*$.y}).then(()=>{r&&P(oh(n),{isTap:d,isDoubleTap:p})}),r=n.subscribe(I)}function I(t){t&&f("interactionupdate",{translation:t,scalar:h?l:void 0})}function P(t,e){g(),f("interactionend",{...e,translation:t,scalar:h?l:void 0})}return t.addEventListener("pointerdown",E),{destroy(){g(),t.removeEventListener("pointerdown",E)}}},sP=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{direction:n,shiftMultiplier:r=10,bubbles:o=!1,stopKeydownPropagation:a=!0}=e,l="horizontal"===n,s="vertical"===n,c=e=>{let{key:n}=e,c=e.shiftKey,u=/up|down/i.test(n),d=/left|right/i.test(n);if(!u&&!d||l&&d||s&&u)return;let h=c?r:1;a&&e.stopPropagation(),t.dispatchEvent(new CustomEvent("nudge",{bubbles:o,detail:tH((/left/i.test(n)?-1:/right/i.test(n)?1:0)*h,(/up/i.test(n)?-1:/down/i.test(n)?1:0)*h)}))};return t.addEventListener("keydown",c),{destroy(){t.removeEventListener("keydown",c)}}};function sD(t,e){return e*Math.sign(t)*Math.log10(1+Math.abs(t)/e)}let sL=(t,e,n)=>{if(!e)return eS(t);let r=t.x+sD(e.x-t.x,n),o=t.x+t.width+sD(e.x+e.width-(t.x+t.width),n),a=t.y+sD(e.y-t.y,n),l=t.y+t.height+sD(e.y+e.height-(t.y+t.height),n);return{x:r,y:a,width:o-r,height:l-a}};var sF=(t,e)=>{if(t){if(/em/.test(t))return 16*parseInt(t,10);if(/px/.test(t))return parseInt(t,10)}},sB=t=>{let e=t.detail||0;return(t.wheelDelta||t.wheelDeltaY)&&(e=(-t.wheelDelta||-t.wheelDeltaY)/120),e||(e=t.deltaY),e};function sO(t){let e,n,r,o,a,l,s;let c=t[29].default,u=of(c,t,t[28],null);return{c(){e=oE("div"),n=oE("div"),u&&u.c(),oL(n,"style",t[6]),oL(e,"class",r=st(["DokaScrollable",t[0]])),oL(e,"style",t[4]),oL(e,"data-direction",t[1]),oL(e,"data-state",t[5])},m(r,c){oS(r,e,c),oM(e,n),u&&u.m(n,null),t[31](e),a=!0,l||(s=[oD(n,"interactionstart",t[9]),oD(n,"interactionupdate",t[11]),oD(n,"interactionend",t[12]),oD(n,"interactionrelease",t[10]),ox(sI.call(null,n,{inertia:!0})),oD(n,"measure",t[30]),ox(lv.call(null,n)),oD(e,"wheel",t[14]),oD(e,"scroll",t[16]),oD(e,"focusin",t[15]),oD(e,"nudge",t[17]),oD(e,"measure",t[13]),ox(lv.call(null,e,{observePosition:!0})),ox(o=sP.call(null,e,{direction:"x"===t[1]?"horizontal":"vertical",stopKeydownPropagation:!1}))],l=!0)},p(t,l){u&&u.p&&268435456&l[0]&&om(u,c,t,t[28],l,null,null),(!a||64&l[0])&&oL(n,"style",t[6]),(!a||1&l[0]&&r!==(r=st(["DokaScrollable",t[0]])))&&oL(e,"class",r),(!a||16&l[0])&&oL(e,"style",t[4]),(!a||2&l[0])&&oL(e,"data-direction",t[1]),(!a||32&l[0])&&oL(e,"data-state",t[5]),o&&oc(o.update)&&2&l[0]&&o.update.call(null,{direction:"x"===t[1]?"horizontal":"vertical",stopKeydownPropagation:!1})},i(t){a||(o9(u,t),a=!0)},o(t){at(u,t),a=!1},d(n){n&&oA(e),u&&u.d(n),t[31](null),l=!1,os(s)}}}function sj(t,e,n){let r,o,a,l,s,c,u,d,h,p,f,g,m,$,y,x,b;let{$$slots:v={},$$scope:w}=e,k=oX(),C=oH("keysPressed");op(t,C,t=>n(46,o=t));let M="idle",S=lu(0);op(t,S,t=>n(44,r=t));let{class:A}=e,{scrollBlockInteractionDist:E=5}=e,{scrollStep:T=10}=e,{scrollFocusMargin:R=64}=e,{scrollDirection:I="x"}=e,{scrollAutoCancel:P=!1}=e,{elasticity:D=0}=e,{onscroll:L=J}=e,{maskFeatherSize:F}=e,{maskFeatherStartOpacity:B}=e,{maskFeatherEndOpacity:O}=e,{scroll:j}=e,_="",z=!0;S.subscribe(t=>{let e=tV();e[I]=t,L(e)});let N=t=>Math.max(Math.min(0,t),s[f]-l[f]),U=t=>{let e=t3(tH(t.x-p.x,t.y-p.y),Math.abs);p=tq(t);let n=et(e),r=e.x-e.y;return!(n>1&&r<-.5)},W=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{elastic:r=!1,animate:o=!1}=e;Math.abs(t)>E&&"idle"===M&&!c&&n(32,M="scrolling");let a=N(t),l=r&&D&&!c?a+sD(t-a,D):a,s=!0;o?s=!1:z||(s=!c),z=!1,S.set(l,{hard:s}).then(t=>{c&&(z=!0)})};return t.$$set=t=>{"class"in t&&n(0,A=t.class),"scrollBlockInteractionDist"in t&&n(21,E=t.scrollBlockInteractionDist),"scrollStep"in t&&n(22,T=t.scrollStep),"scrollFocusMargin"in t&&n(23,R=t.scrollFocusMargin),"scrollDirection"in t&&n(1,I=t.scrollDirection),"scrollAutoCancel"in t&&n(24,P=t.scrollAutoCancel),"elasticity"in t&&n(25,D=t.elasticity),"onscroll"in t&&n(26,L=t.onscroll),"maskFeatherSize"in t&&n(18,F=t.maskFeatherSize),"maskFeatherStartOpacity"in t&&n(19,B=t.maskFeatherStartOpacity),"maskFeatherEndOpacity"in t&&n(20,O=t.maskFeatherEndOpacity),"scroll"in t&&n(27,j=t.scroll),"$$scope"in t&&n(28,w=t.$$scope)},t.$$.update=()=>{if(2&t.$$.dirty[0]&&n(40,f="x"===I?"width":"height"),2&t.$$.dirty[0]&&n(41,g=I.toUpperCase()),8&t.$$.dirty[0]&&n(42,m=u&&getComputedStyle(u)),8&t.$$.dirty[0]|2048&t.$$.dirty[1]&&n(43,$=m&&sF(m.getPropertyValue("--scrollable-feather-size"))),1572868&t.$$.dirty[0]|12808&t.$$.dirty[1]&&null!=r&&s&&null!=$&&l){let t=-r/$,e=-(s[f]-l[f]-r)/$;n(19,B=a_(1-t,0,1)),n(20,O=a_(1-e,0,1)),n(18,F=$),n(4,_="--scrollable-feather-start-opacity: ".concat(B,";--scrollable-feather-end-opacity: ").concat(O))}134217736&t.$$.dirty[0]&&u&&void 0!==j&&(nY(j)?W(j):W(j.scrollOffset,j)),4&t.$$.dirty[0]|520&t.$$.dirty[1]&&n(45,y=s&&l?l[f]>s[f]:void 0),16386&t.$$.dirty[1]&&n(5,x=st([M,y?"overflows":void 0])),25600&t.$$.dirty[1]&&n(6,b=y?"transform: translate".concat(g,"(").concat(r,"px)"):void 0)},[A,I,l,u,_,x,b,C,S,()=>{y&&(h=!1,d=!0,p=tH(0,0),c=!1,n(32,M="idle"),a=oh(S))},t=>{let{detail:e}=t;y&&(c=!0,n(32,M="idle"))},t=>{let{detail:e}=t;if(y&&!h){if(d&&(d=!1,.1>et(e.translation)))return;if(P&&"x"===I&&!U(e.translation)){h=!0;return}W(a+e.translation[I],{elastic:!0})}},t=>{let{detail:e}=t;if(!y||h)return;let n=a+e.translation[I],r=N(n);z=!1,S.set(r).then(t=>{c&&(z=!0)})},t=>{let{detail:e}=t;n(34,s=e),k("measure",{x:e.x,y:e.y,width:e.width,height:e.height})},t=>{if(!y)return;t.preventDefault(),t.stopPropagation();let e=sB(t),n=oh(S);W(n+e*T,{animate:!0})},t=>{if(!y||!c&&!o.length)return;let e=t.target;t.target.classList.contains("implicit")&&(e=e.parentNode);let n=e["x"===I?"offsetLeft":"offsetTop"],r=e["x"===I?"offsetWidth":"offsetHeight"],a=n+r,l=oh(S),u=R+F;l+n<u?W(-n+u):l+a>s[f]-u&&W(s[f]-a-u,{animate:!0})},()=>{n(3,u["x"===I?"scrollLeft":"scrollTop"]=0,u)},t=>{let{detail:e}=t,n=-2*e[I],r=oh(S);W(r+n*T,{animate:!0})},F,B,O,E,T,R,P,D,L,j,w,v,t=>n(2,l=t.detail),function(t){oK[t?"unshift":"push"](()=>{n(3,u=t)})}]}class s_ extends af{constructor(t){super(),ap(this,t,sj,sO,ou,{class:0,scrollBlockInteractionDist:21,scrollStep:22,scrollFocusMargin:23,scrollDirection:1,scrollAutoCancel:24,elasticity:25,onscroll:26,maskFeatherSize:18,maskFeatherStartOpacity:19,maskFeatherEndOpacity:20,scroll:27},[-1,-1])}}function sz(t,e){let{delay:n=0,duration:r=400,easing:o=or}=e,a=+getComputedStyle(t).opacity;return{delay:n,duration:r,easing:o,css:t=>"opacity: ".concat(t*a)}}function sN(t){let e,n,r,o,a,l;return{c(){e=oE("span"),n=oR(t[0]),oL(e,"class","DokaStatusMessage")},m(r,s){oS(r,e,s),oM(e,n),o=!0,a||(l=[oD(e,"measure",function(){oc(t[1])&&t[1].apply(this,arguments)}),ox(lv.call(null,e))],a=!0)},p(e,r){let[a]=r;t=e,(!o||1&a)&&oB(n,t[0])},i(t){o||(o0(()=>{r||(r=an(e,sz,{},!0)),r.run(1)}),o=!0)},o(t){r||(r=an(e,sz,{},!1)),r.run(0),o=!1},d(t){t&&oA(e),t&&r&&r.end(),a=!1,os(l)}}}function sU(t,e,n){let{text:r}=e,{onmeasure:o=J}=e;return t.$$set=t=>{"text"in t&&n(0,r=t.text),"onmeasure"in t&&n(1,o=t.onmeasure)},[r,o]}class sW extends af{constructor(t){super(),ap(this,t,sU,sN,ou,{text:0,onmeasure:1})}}function sX(t){let e,n,r,o,a,l,s,c;return{c(){e=oE("span"),n=oT("svg"),r=oT("g"),o=oT("circle"),a=oT("circle"),l=oI(),s=oE("span"),c=oR(t[0]),oL(o,"class","DokaProgressIndicatorBar"),oL(o,"r","8.5"),oL(o,"cx","10"),oL(o,"cy","10"),oL(o,"stroke-linecap","round"),oL(o,"opacity",".25"),oL(a,"class","DokaProgressIndicatorFill"),oL(a,"r","8.5"),oL(a,"stroke-dasharray",t[1]),oL(a,"cx","10"),oL(a,"cy","10"),oL(a,"transform","rotate(-90) translate(-20)"),oL(r,"fill","none"),oL(r,"stroke","currentColor"),oL(r,"stroke-width","2.5"),oL(r,"stroke-linecap","round"),oL(r,"opacity",t[2]),oL(n,"width","20"),oL(n,"height","20"),oL(n,"viewBox","0 0 20 20"),oL(n,"xmlns","http://www.w3.org/2000/svg"),oL(n,"aria-hidden","true"),oL(n,"focusable","false"),oL(s,"class","implicit"),oL(e,"class","DokaProgressIndicator"),oL(e,"data-status",t[3])},m(t,u){oS(t,e,u),oM(e,n),oM(n,r),oM(r,o),oM(r,a),oM(e,l),oM(e,s),oM(s,c)},p(t,n){let[o]=n;2&o&&oL(a,"stroke-dasharray",t[1]),4&o&&oL(r,"opacity",t[2]),1&o&&oB(c,t[0]),8&o&&oL(e,"data-status",t[3])},i:oi,o:oi,d(t){t&&oA(e)}}}function sV(t,e,n){let r,o,a,l,s;let c=oX(),{progress:u}=e,{min:d=0}=e,{max:h=100}=e,{labelBusy:p="Busy"}=e,f=lu(0,{precision:.01}),g=ay([f],t=>a_(t,d,h));return op(t,g,t=>n(9,r=t)),g.subscribe(t=>{1===u&&Math.round(t)>=100&&c("complete")}),t.$$set=t=>{"progress"in t&&n(5,u=t.progress),"min"in t&&n(6,d=t.min),"max"in t&&n(7,h=t.max),"labelBusy"in t&&n(8,p=t.labelBusy)},t.$$.update=()=>{32&t.$$.dirty&&u&&u!==1/0&&f.set(100*u),800&t.$$.dirty&&n(0,o=u===1/0?p:"".concat(Math.round(r),"%")),544&t.$$.dirty&&n(1,a=u===1/0?"26.5 53":"".concat(r/100*53," 53")),544&t.$$.dirty&&n(2,l=Math.min(1,u===1/0?1:r/10)),32&t.$$.dirty&&n(3,s=u===1/0?"busy":"loading")},[o,a,l,s,g,u,d,h,p]}class sH extends af{constructor(t){super(),ap(this,t,sV,sX,ou,{progress:5,min:6,max:7,labelBusy:8})}}function sY(t){let e,n,r;return(n=new sH({props:{progress:t[0]}})).$on("complete",function(){oc(t[1])&&t[1].apply(this,arguments)}),{c(){e=oE("span"),au(n.$$.fragment),oL(e,"class","DokaStatusProgress"),oL(e,"style",t[2])},m(t,o){oS(t,e,o),ad(n,e,null),r=!0},p(o,a){let[l]=a;t=o;let s={};1&l&&(s.progress=t[0]),n.$set(s),(!r||4&l)&&oL(e,"style",t[2])},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n)}}}function sG(t,e,n){let r,{offset:o=0}=e,{visible:a=!0}=e,{progress:l}=e,{oncomplete:s=J}=e;return t.$$set=t=>{"offset"in t&&n(3,o=t.offset),"visible"in t&&n(4,a=t.visible),"progress"in t&&n(0,l=t.progress),"oncomplete"in t&&n(1,s=t.oncomplete)},t.$$.update=()=>{24&t.$$.dirty&&n(2,r="transform: translateX(".concat(o,"px); opacity: ").concat(a?1:0))},[l,s,r,o,a]}class sK extends af{constructor(t){super(),ap(this,t,sG,sY,ou,{offset:3,visible:4,progress:0,oncomplete:1})}}function sq(t,e,n){let r=t.slice();return r[4]=e[n][0],r[5]=e[n][1],r[6]=e[n][2],r[0]=e[n][3],r}function sZ(t){let e,n,r;let o=[t[6]];var a=t[4];function l(t){let e={};for(let t=0;t<o.length;t+=1)e=oo(e,o[t]);return{props:e}}return a&&(e=new a(l())),{c(){e&&au(e.$$.fragment),n=oP()},m(t,o){e&&ad(e,t,o),oS(t,n,o),r=!0},p(t,r){let s=1&r?al(o,[as(t[6])]):{};if(a!==(a=t[4])){if(e){o8();let t=e;at(t.$$.fragment,1,0,()=>{ah(t,1)}),o7()}a?(au((e=new a(l())).$$.fragment),o9(e.$$.fragment,1),ad(e,n.parentNode,n)):e=null}else a&&e.$set(s)},i(t){r||(e&&o9(e.$$.fragment,t),r=!0)},o(t){e&&at(e.$$.fragment,t),r=!1},d(t){t&&oA(n),e&&ah(e,t)}}}function sQ(t){let e,n,r;n=new s2({props:{items:t[0],discardEmptyItems:!0}});let o=[t[6]],a={};for(let t=0;t<o.length;t+=1)a=oo(a,o[t]);return{c(){e=oE("div"),au(n.$$.fragment),oF(e,a)},m(t,o){oS(t,e,o),ad(n,e,null),r=!0},p(t,r){let l={};1&r&&(l.items=t[0]),n.$set(l),oF(e,a=al(o,[1&r&&t[6]]))},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n)}}}function sJ(t,e){let n,r,o,a,l,s;let c=[sQ,sZ],u=[];function d(t,e){return(1&e&&(r=!!ne(t[4])),r)?0:1}return a=u[o=d(e,-1)]=c[o](e),{key:t,first:null,c(){n=oP(),a.c(),l=oP(),this.first=n},m(t,e){oS(t,n,e),u[o].m(t,e),oS(t,l,e),s=!0},p(t,e){let n=o;(o=d(t,e))===n?u[o].p(t,e):(o8(),at(u[n],1,1,()=>{u[n]=null}),o7(),(a=u[o])||(a=u[o]=c[o](t)).c(),o9(a,1),a.m(l.parentNode,l))},i(t){s||(o9(a),s=!0)},o(t){at(a),s=!1},d(t){t&&oA(n),u[o].d(t),t&&oA(l)}}}function s0(t){let e,n,r=[],o=new Map,a=t[0],l=t=>t[5];for(let e=0;e<a.length;e+=1){let n=sq(t,a,e),s=l(n);o.set(s,r[e]=sJ(s,n))}return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=oP()},m(t,o){for(let e=0;e<r.length;e+=1)r[e].m(t,o);oS(t,e,o),n=!0},p(t,n){let[a]=n;if(1&a){let n=t[0];o8(),r=aa(r,a,l,1,t,n,o,e.parentNode,ao,sJ,e,sq),o7()}},i(t){if(!n){for(let t=0;t<a.length;t+=1)o9(r[t]);n=!0}},o(t){for(let t=0;t<r.length;t+=1)at(r[t]);n=!1},d(t){for(let e=0;e<r.length;e+=1)r[e].d(t);t&&oA(e)}}}function s1(t,e,n){let r,{items:o}=e,{discardEmptyItems:a=!0}=e,l=t=>{if(!t)return!1;let[e,,,n]=t;return!ne(e)||n.some(l)};return t.$$set=t=>{"items"in t&&n(1,o=t.items),"discardEmptyItems"in t&&n(2,a=t.discardEmptyItems)},t.$$.update=()=>{6&t.$$.dirty&&n(0,r=(o&&a?o.filter(l):o)||[])},[r,o,a]}class s2 extends af{constructor(t){super(),ap(this,t,s1,s0,ou,{items:1,discardEmptyItems:2})}}let s4=["file","size","loadState","processState","cropAspectRatio","cropLimitToImage","crop","cropMinSize","cropMaxSize","cropRange","cropOrigin","cropRectAspectRatio","rotation","rotationRange","targetSize","flipX","flipY","perspectiveX","perspectiveY","perspective","colorMatrix","convolutionMatrix","gamma","vignette","noise","decoration","annotation","backgroundColor","state"],s5=function(t,e,n){let r=[];return{set:e,update:n,publish:t=>{r.forEach(e=>e(t))},subscribe:e=>(r.push(e),t(e),()=>{r=r.filter(t=>t!==e)})}};var s3=()=>{let t,e;let n=s4.reduce((t,n)=>(t[n]=s5(t=>{if(!e)return t();let r=e.stores[n].subscribe(t);r()},t=>{e&&e.stores[n].set(t)},t=>{e&&e.stores[n].update(t)}),t),{});return{update:r=>{if(e=r,t&&(t.forEach(t=>t()),t=void 0),!r){n.file.publish(void 0),n.loadState.publish(void 0);return}t=s4.map(t=>r.stores[t].subscribe(e=>n[t].publish(e)))},stores:n}},s6=function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return n=>{"ping"===n.type&&(e&&n.stopPropagation(),t(n.detail.type,n.detail.data))}},s8=t=>/textarea/i.test(t.nodeName),s7=t=>/date|email|number|search|text|url/.test(t.type),s9=t=>s8(t)||s7(t),ct=(t,e)=>(e?lT(t,e):t).replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase(),ce=(t,e)=>{let n=matchMedia(t);return n.addListener(e),e(n),{get matches(){return n.matches},destroy:()=>n.removeListener(e)}},cn=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tj,{subscribe:n,set:r}=a$(void 0),o=ce(t,t=>{let{matches:n}=t;return r(e(n))});return{subscribe:n,unsubscribe:o.destroy}},ci=()=>{if(!n5())return!1;let t=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/i)||[],[,e,n]=t.map(t=>parseInt(t,10)||0);return e>13||13===e&&n>=4},cr=(t,e,n,r,o,a,l,s,c,u,d)=>{if(!t||!e||!n||!r||!a)return;let h=e1(eS(e)),p=eF(h),f=eF(t),g=eT(n),m=eF(g),$=tH(l,s),y=aj(n,r,c,$),x=eF(y),b=t8(tq(m),x),v=t8(tq(f),p);b.x+=v.x,b.y+=v.y;let w=tZ(tq(b));w.x+=v.x,w.y+=v.y;let k=eF(eB(eS(o),t)),C=t8(k,f);return t6(b,C),{origin:w,translation:b,rotation:{x:d?Math.PI:0,y:u?Math.PI:0,z:c},perspective:$,scale:a}},co=(t,e)=>{let n;let{sub:r,pub:o}=aE(),a=[],l=a$(-1),s=[],c=()=>s.forEach(t=>t({index:oh(l),length:a.length})),u={get index(){return oh(l)},set index(i){i=a_(i=Number.isInteger(i)?i:-1,-1,a.length-1),l.set(i),e(a[u.index]||n),c()},get state(){return a[a.length-1]||n},length:()=>a.length,undo(){let t=u.index--;return o("undo",t),t},redo(){let t=u.index++;return o("redo",u.index),t},revert(){a.length=0,u.index=-1,o("revert")},write(){a.length=u.index+1,a.push(t()),l.set(a.length-1),c()},set(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n=t},subscribe:t=>(s.push(t),t({index:u.index,length:a.length}),()=>s.splice(s.indexOf(t),1)),on:r};return u},ca=()=>tn()&&!!window.chrome,cl=async t=>to(await td(t)),cs=(t,e,n)=>new Promise(async(r,o)=>{let a;let l=await e.read(t),s=t=>tC(t,n).then(t=>e.apply(t,l)).then(r).catch(o);if(!tm()||ty(t))return s(t);try{a=await tk((t,e)=>createImageBitmap(t).then(t=>e(null,t)).catch(e),[t])}catch(t){}return a&&a.width?await tr()?ca()&&l>1?r(await cl(a)):void r(a):r(e.apply(a,l)):s(t)}),cc=(t,e)=>new Promise(async n=>{if(t.width<e.width&&t.height<e.height)return n(t);let r=Math.min(e.width/t.width,e.height/t.height),o=r*t.width,a=r*t.height,l=ta("canvas",{width:o,height:a}),s=l.getContext("2d"),c=tu(t)?await td(t):t;s.drawImage(c,0,0,o,a),n(to(l))});let cu=null;var cd=()=>{if(null!==cu)return cu;let t=ta("canvas"),e=l5(t);return cu=e?e.getParameter(e.MAX_TEXTURE_SIZE):void 0,tc(t),cu},ch=()=>tn()&&window.devicePixelRatio||1,cp=t=>{let[,e,n,r]=t.split("");t=4===t.length?"#".concat(e).concat(e).concat(n).concat(n).concat(r).concat(r):t;let[,o,a,l]=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return[o,a,l].map(t=>parseInt(t,16)/255)},cf=t=>/^rgba/.test(t)?t.substr(5).split(",").map(parseFloat).map((t,e)=>t/(3===e?1:255)):/^rgb/.test(t)?t.substr(4).split(",").map(parseFloat).map(t=>t/255):/^#/.test(t)?cp(t):void 0,cg=t=>t[0]<.25&&t[1]<.25&&t[2]<.25;let cm=null;var c$=()=>{if(null===cm){let t=ta("canvas");cm=!!l5(t),tc(t)}return cm};function cy(t){let e,n,r;let o=t[47]&&cx(t),a=t[38]&&!t[32]&&cS(t);return{c(){o&&o.c(),e=oI(),a&&a.c(),n=oP()},m(t,l){o&&o.m(t,l),oS(t,e,l),a&&a.m(t,l),oS(t,n,l),r=!0},p(t,r){t[47]?o?(o.p(t,r),65536&r[1]&&o9(o,1)):((o=cx(t)).c(),o9(o,1),o.m(e.parentNode,e)):o&&(o8(),at(o,1,1,()=>{o=null}),o7()),t[38]&&!t[32]?a?(a.p(t,r),130&r[1]&&o9(a,1)):((a=cS(t)).c(),o9(a,1),a.m(n.parentNode,n)):a&&(o8(),at(a,1,1,()=>{a=null}),o7())},i(t){r||(o9(o),o9(a),r=!0)},o(t){at(o),at(a),r=!1},d(t){o&&o.d(t),t&&oA(e),a&&a.d(t),t&&oA(n)}}}function cx(t){let e,n,r,o,a,l,s;let c=[cw,cv,cb],u=[];function d(t,e){return t[32]?0:t[34]||t[33]||t[36]||t[37]?1:t[39]&&t[42]?2:-1}return~(r=d(t))&&(o=u[r]=c[r](t)),{c(){e=oE("div"),n=oE("p"),o&&o.c(),oL(n,"style",a="transform: translateX(".concat(t[48],"px)")),oL(e,"class","DokaStatus"),oL(e,"style",l="opacity: ".concat(t[46]))},m(t,o){oS(t,e,o),oM(e,n),~r&&u[r].m(n,null),s=!0},p(t,h){let p=r;(r=d(t))===p?~r&&u[r].p(t,h):(o&&(o8(),at(u[p],1,1,()=>{u[p]=null}),o7()),~r?((o=u[r])||(o=u[r]=c[r](t)).c(),o9(o,1),o.m(n,null)):o=null),(!s||131072&h[1]&&a!==(a="transform: translateX(".concat(t[48],"px)")))&&oL(n,"style",a),(!s||32768&h[1]&&l!==(l="opacity: ".concat(t[46])))&&oL(e,"style",l)},i(t){s||(o9(o),s=!0)},o(t){at(o),s=!1},d(t){t&&oA(e),~r&&u[r].d()}}}function cb(t){let e,n,r,o,a,l;e=new sW({props:{text:t[42],onmeasure:t[106]}}),r=new sK({props:{offset:t[49],visible:t[44],progress:t[43]}});let s=t[45]&&ck(t);return{c(){au(e.$$.fragment),n=oI(),au(r.$$.fragment),o=oI(),s&&s.c(),a=oP()},m(t,c){ad(e,t,c),oS(t,n,c),ad(r,t,c),oS(t,o,c),s&&s.m(t,c),oS(t,a,c),l=!0},p(t,n){let o={};2048&n[1]&&(o.text=t[42]),e.$set(o);let l={};262144&n[1]&&(l.offset=t[49]),8192&n[1]&&(l.visible=t[44]),4096&n[1]&&(l.progress=t[43]),r.$set(l),t[45]?s?(s.p(t,n),16384&n[1]&&o9(s,1)):((s=ck(t)).c(),o9(s,1),s.m(a.parentNode,a)):s&&(o8(),at(s,1,1,()=>{s=null}),o7())},i(t){l||(o9(e.$$.fragment,t),o9(r.$$.fragment,t),o9(s),l=!0)},o(t){at(e.$$.fragment,t),at(r.$$.fragment,t),at(s),l=!1},d(t){ah(e,t),t&&oA(n),ah(r,t),t&&oA(o),s&&s.d(t),t&&oA(a)}}}function cv(t){let e,n,r,o,a,l;e=new sW({props:{text:t[41],onmeasure:t[106]}}),r=new sK({props:{offset:t[49],visible:t[40],progress:t[35]}});let s=t[33]&&cC(t);return{c(){au(e.$$.fragment),n=oI(),au(r.$$.fragment),o=oI(),s&&s.c(),a=oP()},m(t,c){ad(e,t,c),oS(t,n,c),ad(r,t,c),oS(t,o,c),s&&s.m(t,c),oS(t,a,c),l=!0},p(t,n){let o={};1024&n[1]&&(o.text=t[41]),e.$set(o);let l={};262144&n[1]&&(l.offset=t[49]),512&n[1]&&(l.visible=t[40]),16&n[1]&&(l.progress=t[35]),r.$set(l),t[33]?s?(s.p(t,n),4&n[1]&&o9(s,1)):((s=cC(t)).c(),o9(s,1),s.m(a.parentNode,a)):s&&(o8(),at(s,1,1,()=>{s=null}),o7())},i(t){l||(o9(e.$$.fragment,t),o9(r.$$.fragment,t),o9(s),l=!0)},o(t){at(e.$$.fragment,t),at(r.$$.fragment,t),at(s),l=!1},d(t){ah(e,t),t&&oA(n),ah(r,t),t&&oA(o),s&&s.d(t),t&&oA(a)}}}function cw(t){let e,n,r,o,a,l;return e=new sW({props:{text:t[32],onmeasure:t[106]}}),o=new sb({props:{$$slots:{default:[cM]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment),n=oI(),r=oE("span"),au(o.$$.fragment),oL(r,"class","DokaStatusIcon"),oL(r,"style",a="transform: translateX(".concat(t[49],"px)"))},m(t,a){ad(e,t,a),oS(t,n,a),oS(t,r,a),ad(o,r,null),l=!0},p(t,n){let s={};2&n[1]&&(s.text=t[32]),e.$set(s);let c={};4&n[0]|4096&n[8]&&(c.$$scope={dirty:n,ctx:t}),o.$set(c),(!l||262144&n[1]&&a!==(a="transform: translateX(".concat(t[49],"px)")))&&oL(r,"style",a)},i(t){l||(o9(e.$$.fragment,t),o9(o.$$.fragment,t),l=!0)},o(t){at(e.$$.fragment,t),at(o.$$.fragment,t),l=!1},d(t){ah(e,t),t&&oA(n),t&&oA(r),ah(o)}}}function ck(t){let e,n,r,o;return n=new sA({props:{onclick:t[108],label:t[2].statusLabelButtonClose,icon:t[2].statusIconButtonClose,hideLabel:!0}}),{c(){e=oE("span"),au(n.$$.fragment),oL(e,"class","DokaStatusButton"),oL(e,"style",r="transform: translateX(".concat(t[49],"px)"))},m(t,r){oS(t,e,r),ad(n,e,null),o=!0},p(t,a){let l={};4&a[0]&&(l.label=t[2].statusLabelButtonClose),4&a[0]&&(l.icon=t[2].statusIconButtonClose),n.$set(l),(!o||262144&a[1]&&r!==(r="transform: translateX(".concat(t[49],"px)")))&&oL(e,"style",r)},i(t){o||(o9(n.$$.fragment,t),o=!0)},o(t){at(n.$$.fragment,t),o=!1},d(t){t&&oA(e),ah(n)}}}function cC(t){let e,n,r,o;return n=new sA({props:{onclick:t[107],label:t[2].statusLabelButtonClose,icon:t[2].statusIconButtonClose,hideLabel:!0}}),{c(){e=oE("span"),au(n.$$.fragment),oL(e,"class","DokaStatusButton"),oL(e,"style",r="transform: translateX(".concat(t[49],"px)"))},m(t,r){oS(t,e,r),ad(n,e,null),o=!0},p(t,a){let l={};4&a[0]&&(l.label=t[2].statusLabelButtonClose),4&a[0]&&(l.icon=t[2].statusIconButtonClose),n.$set(l),(!o||262144&a[1]&&r!==(r="transform: translateX(".concat(t[49],"px)")))&&oL(e,"style",r)},i(t){o||(o9(n.$$.fragment,t),o=!0)},o(t){at(n.$$.fragment,t),o=!1},d(t){t&&oA(e),ah(n)}}}function cM(t){let e;let n=t[2].iconSupportError+"";return{c(){e=oT("g")},m(t,r){oS(t,e,r),e.innerHTML=n},p(t,r){4&r[0]&&n!==(n=t[2].iconSupportError+"")&&(e.innerHTML=n)},d(t){t&&oA(e)}}}function cS(t){let e,n,r,o,a,l,s,c,u;let d=t[6]&&cA(t),h=t[16]&&t[14]&&cE(t),p=[cD,cP],f=[];return o=f[r=t[16]?0:1]=p[r](t),l=new l9({props:{animate:t[18],pixelRatio:t[56],backgroundColor:t[28],maskRect:t[31],imageSize:t[17],imageData:t[38],imageProps:t[30],imagePreviews:t[57],loadImageData:t[8],willRender:t[152]}}),{c(){d&&d.c(),e=oI(),h&&h.c(),n=oI(),o.c(),a=oI(),au(l.$$.fragment),s=oI(),oL(c=oE("div"),"class","DokaRootPortal")},m(o,p){d&&d.m(o,p),oS(o,e,p),h&&h.m(o,p),oS(o,n,p),f[r].m(o,p),oS(o,a,p),ad(l,o,p),oS(o,s,p),oS(o,c,p),t[153](c),u=!0},p(t,s){t[6]?d?(d.p(t,s),64&s[0]&&o9(d,1)):((d=cA(t)).c(),o9(d,1),d.m(e.parentNode,e)):d&&(o8(),at(d,1,1,()=>{d=null}),o7()),t[16]&&t[14]?h?(h.p(t,s),81920&s[0]&&o9(h,1)):((h=cE(t)).c(),o9(h,1),h.m(n.parentNode,n)):h&&(o8(),at(h,1,1,()=>{h=null}),o7());let c=r;(r=t[16]?0:1)===c?f[r].p(t,s):(o8(),at(f[c],1,1,()=>{f[c]=null}),o7(),(o=f[r])||(o=f[r]=p[r](t)).c(),o9(o,1),o.m(a.parentNode,a));let u={};262144&s[0]&&(u.animate=t[18]),33554432&s[1]&&(u.pixelRatio=t[56]),268435456&s[0]&&(u.backgroundColor=t[28]),1&s[1]&&(u.maskRect=t[31]),131072&s[0]&&(u.imageSize=t[17]),128&s[1]&&(u.imageData=t[38]),1073741824&s[0]&&(u.imageProps=t[30]),67108864&s[1]&&(u.imagePreviews=t[57]),256&s[0]&&(u.loadImageData=t[8]),32&s[0]|939524096&s[1]&&(u.willRender=t[152]),l.$set(u)},i(t){u||(o9(d),o9(h),o9(o),o9(l.$$.fragment,t),u=!0)},o(t){at(d),at(h),at(o),at(l.$$.fragment,t),u=!1},d(o){d&&d.d(o),o&&oA(e),h&&h.d(o),o&&oA(n),f[r].d(o),o&&oA(a),ah(l,o),o&&oA(s),o&&oA(c),t[153](null)}}}function cA(t){let e,n,r,o,a;return n=new s2({props:{items:t[51]}}),{c(){e=oE("div"),au(n.$$.fragment),oL(e,"class","DokaNav DokaNavTools")},m(l,s){oS(l,e,s),ad(n,e,null),r=!0,o||(a=[oD(e,"measure",t[137]),ox(lv.call(null,e))],o=!0)},p(t,e){let r={};1048576&e[1]&&(r.items=t[51]),n.$set(r)},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n),o=!1,os(a)}}}function cE(t){let e,n,r;return n=new s_({props:{elasticity:t[4]*cB,scrollDirection:t[27]?"y":"x",$$slots:{default:[cI]},$$scope:{ctx:t}}}),{c(){e=oE("div"),au(n.$$.fragment),oL(e,"class","DokaNav DokaNavMain")},m(t,o){oS(t,e,o),ad(n,e,null),r=!0},p(t,e){let r={};16&e[0]&&(r.elasticity=t[4]*cB),134217728&e[0]&&(r.scrollDirection=t[27]?"y":"x"),27262976&e[0]|4096&e[8]&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n)}}}function cT(t){let e;let n=t[259].icon+"";return{c(){e=oT("g")},m(t,r){oS(t,e,r),e.innerHTML=n},p(t,r){2048&r[8]&&n!==(n=t[259].icon+"")&&(e.innerHTML=n)},d(t){t&&oA(e)}}}function cR(t){let e,n,r,o,a;let l=t[259].label+"";return e=new sb({props:{$$slots:{default:[cT]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment),n=oI(),r=oE("span"),o=oR(l)},m(t,l){ad(e,t,l),oS(t,n,l),oS(t,r,l),oM(r,o),a=!0},p(t,n){let r={};6144&n[8]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r),(!a||2048&n[8])&&l!==(l=t[259].label+"")&&oB(o,l)},i(t){a||(o9(e.$$.fragment,t),a=!0)},o(t){at(e.$$.fragment,t),a=!1},d(t){ah(e,t),t&&oA(n),t&&oA(r)}}}function cI(t){let e,n;let r=[t[23],{tabs:t[24]}],o={$$slots:{default:[cR,t=>{let{tab:e}=t;return{259:e}},t=>{let{tab:e}=t;return[0,0,0,0,0,0,0,0,e?2048:0]}]},$$scope:{ctx:t}};for(let t=0;t<r.length;t+=1)o=oo(o,r[t]);return(e=new sl({props:o})).$on("select",t[138]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let o=25165824&n[0]?al(r,[8388608&n[0]&&as(t[23]),16777216&n[0]&&{tabs:t[24]}]):{};6144&n[8]&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function cP(t){let e,n,r;function o(e){t[147].call(null,e)}let a={class:"DokaMain",content:{...t[20].find(t[146]),props:t[7][t[21]]},locale:t[2],stores:t[101]};return void 0!==t[0][t[21]]&&(a.component=t[0][t[21]]),e=new s$({props:a}),oK.push(()=>ac(e,"component",o)),e.$on("measure",t[148]),e.$on("show",t[149]),e.$on("hide",t[150]),e.$on("fade",t[151]),{c(){au(e.$$.fragment)},m(t,n){ad(e,t,n),r=!0},p(t,r){let o={};3145856&r[0]&&(o.content={...t[20].find(t[146]),props:t[7][t[21]]}),4&r[0]&&(o.locale=t[2]),!n&&2097153&r[0]&&(n=!0,o.component=t[0][t[21]],o1(()=>n=!1)),e.$set(o)},i(t){r||(o9(e.$$.fragment,t),r=!0)},o(t){at(e.$$.fragment,t),r=!1},d(t){ah(e,t)}}}function cD(t){let e,n;let r=[{class:"DokaMain"},{visible:t[12]},t[23],{panels:t[25]}],o={$$slots:{default:[cL,t=>{let{panel:e}=t;return{258:e}},t=>{let{panel:e}=t;return[0,0,0,0,0,0,0,0,e?1024:0]}]},$$scope:{ctx:t}};for(let t=0;t<r.length;t+=1)o=oo(o,r[t]);return(e=new sf({props:o})).$on("measure",t[145]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let o=41947136&n[0]?al(r,[r[0],4096&n[0]&&{visible:t[12]},8388608&n[0]&&as(t[23]),33554432&n[0]&&{panels:t[25]}]):{};7344261&n[0]|16777216&n[1]|5120&n[8]&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function cL(t){let e,n,r;function o(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t[139](t[258],...n)}function a(e){t[140].call(null,e,t[258])}let l={content:{...t[20].find(o),props:t[7][t[258]]},locale:t[2],isActive:t[258]===t[21],stores:t[101]};return void 0!==t[0][t[258]]&&(l.component=t[0][t[258]]),e=new s$({props:l}),oK.push(()=>ac(e,"component",a)),e.$on("measure",t[141]),e.$on("show",function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t[142](t[258],...n)}),e.$on("hide",function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t[143](t[258],...n)}),e.$on("fade",function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t[144](t[258],...n)}),{c(){au(e.$$.fragment)},m(t,n){ad(e,t,n),r=!0},p(r,a){t=r;let l={};1048704&a[0]|1024&a[8]&&(l.content={...t[20].find(o),props:t[7][t[258]]}),4&a[0]&&(l.locale=t[2]),2097152&a[0]|1024&a[8]&&(l.isActive=t[258]===t[21]),!n&&1&a[0]|1024&a[8]&&(n=!0,l.component=t[0][t[258]],o1(()=>n=!1)),e.$set(l)},i(t){r||(o9(e.$$.fragment,t),r=!0)},o(t){at(e.$$.fragment,t),r=!1},d(t){ah(e,t)}}}function cF(t){let e,n,r,o;o0(t[136]);let a=t[52]&&cy(t);return{c(){e=oE("div"),a&&a.c(),oL(e,"id",t[3]),oL(e,"class",t[26]),oL(e,"data-env",t[29])},m(l,s){oS(l,e,s),a&&a.m(e,null),t[154](e),n=!0,r||(o=[oD(window,"keydown",t[110]),oD(window,"keyup",t[111]),oD(window,"blur",t[112]),oD(window,"resize",t[136]),oD(e,"ping",function(){oc(t[53])&&t[53].apply(this,arguments)}),oD(e,"contextmenu",t[113]),oD(e,"touchstart",function(){oc(t[50])&&t[50].apply(this,arguments)}),oD(e,"transitionend",t[102]),oD(e,"dropfiles",t[114]),oD(e,"measure",t[155]),ox(lv.call(null,e,{observeViewRect:!0})),ox(lw.call(null,e)),ox(lM.call(null,e))],r=!0)},p(r,o){(t=r)[52]?a?(a.p(t,o),2097152&o[1]&&o9(a,1)):((a=cy(t)).c(),o9(a,1),a.m(e,null)):a&&(o8(),at(a,1,1,()=>{a=null}),o7()),(!n||8&o[0])&&oL(e,"id",t[3]),(!n||67108864&o[0])&&oL(e,"class",t[26]),(!n||536870912&o[0])&&oL(e,"data-env",t[29])},i(t){n||(o9(a),n=!0)},o(t){at(a),n=!1},d(n){n&&oA(e),a&&a.d(),t[154](null),r=!1,os(o)}}}let cB=10;function cO(t,e,n){let r,o,a,l,s,c,u,d,h,p,f,g,m,$,y,x,b,v,w,k,C,M,S,A,E,T,R,I,P,D,L,F,B,O,j,_,z,N,U,W,X,V,H,Y,G,K,q,Z,Q,tt,te,tn,ti,tr,to,ta,tl,ts,tc,tu,td,th,tp,tf,tg,tm,t$,ty,tb,tv,tw,tk,tC,tM,tS,tA,tE,tT,tR,tI,tP,tD,tL,tF,tB,tO,t_,tz,tN,tU,tW,tX,tV,tY,tG,tK,tq,tZ,tQ,tJ,t0,t1,t2,t4,t5,t3,t6;let t8,t7=oi;op(t,ld,t=>n(179,v=t)),t.$$.on_destroy.push(()=>t7());let t9=aE(),et=oX(),{class:ee}=e,{layout:en}=e,{stores:ei}=e,{locale:er}=e,{id:eo}=e,{util:ea}=e,{utils:el}=e,{animations:ec="auto"}=e,{previewUpscale:ed=!1}=e,{elasticityMultiplier:eh=10}=e,{willRevert:ep=()=>Promise.resolve(!0)}=e,{willRenderCanvas:ef=tj}=e,{willRenderToolbar:eg=tj}=e,{enableButtonExport:em=!0}=e,{enableButtonRevert:e$=!0}=e,{enableNavigateHistory:ey=!0}=e,{enableToolbar:eb=!0}=e,{enableUtils:ev=!0}=e,{enableButtonClose:ew=!1}=e,{previewImageDataMaxSize:ek}=e,{enableDropImage:eC=!1}=e,{imageOrienter:eM={read:()=>1,apply:t=>t}}=e,{pluginComponents:eE}=e,{pluginOptions:eT={}}=e,eR=t9.sub,eI={},{root:eP}=e,eD=[],eF=cd()||1024,eO=eu(eF,eF),eU=n5()?16777216:1/0,{imageSourceToImageData:eX=t=>ne(t)?fetch(t).then(t=>t.blob()).then(t=>cs(t,eM,eU)).then(t=>cc(t,tr)):cs(t,eM,eU).then(t=>cc(t,tr))}=e,eV=s3(),{file:eH,size:eG,loadState:eK,processState:eZ,cropAspectRatio:eQ,cropLimitToImage:eJ,crop:e0,cropMinSize:e1,cropMaxSize:e2,cropRange:e4,cropOrigin:e5,cropRectAspectRatio:e3,rotation:e6,rotationRange:e8,targetSize:e7,flipX:e9,flipY:nt,backgroundColor:nn,colorMatrix:ni,convolutionMatrix:nr,gamma:no,vignette:na,noise:nl,decoration:ns,annotation:nc,state:nu}=eV.stores;op(t,eH,t=>n(210,L=t)),op(t,eG,t=>n(17,y=t)),op(t,eK,t=>n(165,s=t)),op(t,eZ,t=>n(211,B=t)),op(t,e0,t=>n(169,h=t)),op(t,nn,t=>n(207,I=t)),op(t,ns,t=>n(58,H=t)),op(t,nc,t=>n(59,Y=t)),op(t,nu,t=>n(164,l=t));let{images:nd,imageReader:nh}=ei;op(t,nd,t=>n(162,r=t));let np=a$([0,0,0]);op(t,np,t=>n(28,C=t));let nf=a$();op(t,nf,t=>n(15,o=t));let ng=a$();op(t,ng,t=>n(163,a=t));let nm=()=>{eQ.set(eW(a)),nq.set(l)},n$=a$(eA());op(t,n$,t=>n(19,w=t));let ny=a$(eA());op(t,ny,t=>n(54,U=t));let nx=a$();op(t,nx,t=>n(55,W=t));let nb=ay([nx,n$,ny],(t,e)=>{let[n,r,o]=t;if(!n)return e(void 0);let a=r.x,l=r.y+(tv&&ti||tn?0:o.y+o.height);e(eL(a+n.x,l+n.y,n.width,n.height))});op(t,nb,t=>n(173,m=t));let nv=cn("(pointer: fine)",t=>t?"pointer-fine":"pointer-coarse");op(t,nv,t=>n(202,S=t));let nw=cn("(hover: hover)",t=>t?"pointer-hover":"pointer-no-hover");op(t,nw,t=>n(203,A=t));let nk=a$(!1);op(t,nk,t=>n(170,p=t));let nC=am(void 0,t=>{let e=lu(0),n=[nk.subscribe(t=>{e.set(t?1:0)}),e.subscribe(t)];return()=>n.forEach(t=>t())});op(t,nC,t=>n(214,N=t));let nM=a$(ed);op(t,nM,t=>n(168,d=t));let nS=ay([nb,e0],(t,e)=>{let[n,r]=t,o=!!(c||u);if(!n||!r||o)return;let a=Math.min(n.width/r.width,n.height/r.height),l=d?a:Math.min(1,a);e(l)});op(t,nS,t=>n(174,$=t));let nA=a$();op(t,nA,t=>n(166,c=t));let nE=a$();op(t,nE,t=>n(167,u=t));let nT=am(void 0,t=>{let e=lu(void 0,{precision:1e-4}),n=[e0.subscribe(()=>{if(!h)return;let t=void 0===u||p,n=sL(h,u,5*eh);e.set(n,{hard:t})}),e.subscribe(t)];return()=>n.forEach(t=>t())}),nR=a$();op(t,nR,t=>n(171,f=t));let nI=a$();op(t,nI,t=>n(176,b=t));let nP=a$(void 0);op(t,nP,t=>n(172,g=t));let nD=am(void 0,t=>{let e=lu(void 0,{precision:1e-4}),n=()=>{if(!f)return;let t=p,n=sL(f,g,1*eh);n.width<0&&(n.width=0,n.x=f.x),n.height<0&&(n.height=0,n.y=f.y),eB(n,m),e.set(n,{hard:t})},r=[nb.subscribe(n),nR.subscribe(n),e.subscribe(t)];return()=>r.forEach(t=>t())});op(t,nD,t=>n(31,P=t)),nb.subscribe(()=>{if(!m||!h)return;let t=h.width<=m.width&&h.height<=m.height,e=t?eY(m,ej(eS(h),$||1)):eq(m,eW(h||y));nR.set(e)}),nI.subscribe(t=>{if(!t){K=void 0,oy(nA,c=void 0,c);return}K=x;let e=eS(h);nA.set(e)}),nR.subscribe(t=>{if(!t||!b)return;let e=ez(eS(t),b);e_(e,K);let n=eN(eS(c),e);e0.set(n)}),e0.subscribe(t=>{if(p||b||u||!t||!f)return;let e=eW(f),n=eW(t);if(aI(e,6)===aI(n,6))return;let r=Math.min(m.width/h.width,m.height/h.height),o=eu(t.width*r,t.height*r),a=(f.width-o.width)*.5,l=(f.height-o.height)*.5,s=eL(f.x+a,f.y+l,o.width,o.height);nR.set(s)});let nL=ay([nS,e0,nR],(t,e)=>{let[n,r,o]=t;if(!n||!r||!o)return;let a=o.width/r.width,l=o.height/r.height,s=Math.max(a,l)/n;e(s)}),nF=ay([nS,nL],(t,e)=>{let[n,r]=t;r&&e(n*r)});op(t,nF,t=>n(175,x=t));let nB=ay([np,nk,nD,nC],(t,e)=>{let[n,r,o,a]=t;if(!o)return e([]);let{x:l,y:s,width:c,height:u}=o,d=a>0,h=d?3:1,p=d?3:1,f=c/p,g=u/h,m=[],$=cg(n)?[1,1,1]:[0,0,0];for(let t=0;t<=h;t++){let e=0===t||t===h;if(tn&&e)continue;let n=e?1:.25*a,r=s+g*t;m.push({id:"image-selection-guide-row-".concat(t),points:[tH(l,r),tH(l+c,r)],opacity:n,strokeWidth:1,strokeColor:$})}for(let t=0;t<=p;t++){let e=0===t||t===p;if(tn&&e)continue;let n=e?1:.25*a,r=l+f*t;m.push({id:"image-selection-guide-col-".concat(t),points:[tH(r,s),tH(r,s+u)],opacity:n,strokeWidth:1,strokeColor:$})}e(m)}),nO=a$([]),nj=ay([nB,nO],(t,e)=>{let[n,r]=t;e(n.concat(r))});op(t,nj,t=>n(60,G=t));let n_=a$(!1);op(t,n_,t=>n(209,D=t));let nz=(t,e)=>new Promise((n,r)=>{let o,a=!1;e.cancel=()=>a=!0;let l=Date.now();eX(t).then(t=>{let e=Date.now()-l;clearTimeout(o),o=setTimeout(()=>{a||n(t)},Math.max(0,1e3-e))}).catch(r)}),nN=ay([n_,eH],(t,e)=>{let[n,r]=t;if(q&&q.cancel(),!n||!r)return e(void 0);nz(r,q={cancel:J}).then(e).catch(t=>oy(eK,s.error=t,s))});op(t,nN,t=>n(38,F=t));let nU=a$({});op(t,nU,t=>n(205,T=t));let nW=a$([]);op(t,nW,t=>n(57,V=t));let nX=ay([nb,ng,eG,nT,nR,nF,e6,e9,nt],(t,e)=>{let[n,r,o,a,l,s,c,u,d]=t;e(cr(n,r,o,a,l,s,0,0,c,u,d))});op(t,nX,t=>n(204,E=t));let nV=ay([ni,nr,no,na,nl],(t,e)=>{let[n,r,o,a,l]=t,s=n&&Object.keys(n).map(t=>n[t]).filter(Boolean),c={gamma:o||void 0,vignette:a||void 0,noise:l||void 0,convolutionMatrix:r||void 0,colorMatrix:s&&s.length&&rV(s)};e(c)});op(t,nV,t=>n(206,R=t));let nH=ci(),nY=a$({});op(t,nY,t=>n(201,M=t));let nG=ch(),nK=am(nG,t=>{let e=()=>t(ch()),n=matchMedia("(resolution: ".concat(nG,"dppx)"));return n.addListener(e),()=>n.removeListener(e)});op(t,nK,t=>n(56,X=t));let nq=co(()=>l,t=>{oy(nu,l=t,l),n$.set(w)});t7(),t7=od(nq,t=>n(181,t8=t)),eK.subscribe(function(){let{complete:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t&&nq.set(l)});let nZ=()=>ep().then(t=>t&&nq.revert()),nQ=a$(!1);op(t,nQ,t=>n(183,k=t));let n0=()=>{oy(nQ,k=!0,k);let t=ie.subscribe(e=>{1===e&&(t(),et("processImage"))})};eZ.subscribe(t=>{if(!t)return;oy(nQ,k=!0,k);let{task:e,error:n,complete:r}=t;r&&oy(nQ,k=!1,k)});let n1={...ei,imageFile:eH,imageSize:eG,imageCropAspectRatio:eQ,imageCropMinSize:e1,imageCropMaxSize:e2,imageCropLimitToImage:eJ,imageCropRect:e0,imageCropRectOrigin:e5,imageCropRectSnapshot:nA,imageCropRectAspectRatio:e3,imageCropRange:e4,imageRotation:e6,imageRotationRange:e8,imageFlipX:e9,imageFlipY:nt,imageOutputSize:e7,imageColorMatrix:ni,imageConvolutionMatrix:nr,imageGamma:no,imageVignette:na,imageNoise:nl,imageDecoration:ns,imageAnnotation:nc,imagePreview:nN,imageTransforms:nX,imagePreviewModifiers:nU,history:nq,pixelRatio:nK,elasticityMultiplier:eh,scrollElasticity:cB,rangeInputElasticity:5,pointerAccuracy:nv,pointerHoverable:nw,env:nY,rootRect:ng,stageRect:nb,stageScalar:nS,utilRect:nx,presentationScalar:nF,rootBackgroundColor:np,imageOverlayMarkup:nO,imagePreviews:nW,isInteracting:nk,imageCropRectIntent:nE,imageCropRectPresentation:nT,imageSelectionRect:nR,imageSelectionRectIntent:nP,imageSelectionRectPresentation:nD,imageSelectionRectSnapshot:nI,imageScalar:nL};delete n1.image;let n2="util-".concat(tx()),n4=[],n3=n5(),n6=()=>{let t=tB.getPropertyValue("background-color"),e=cf(t);0!==e[3]&&(e.length=3,oy(np,C=e,C))},n8=(t,e)=>rb(t,{x:P.x/e.scale,y:P.y/e.scale,width:P.width/e.scale,height:P.height/e.scale}),n7=(t,e)=>(rA(t,P,e.scale,e.size),t),n9=t=>{let e=[];return t.forEach(t=>e.push(...it(t))),e.filter(Boolean)},it=t=>{let e=[t];if(ij(t)){let n=tH(t.x1,t.y1),r=tH(t.x2,t.y2);if(t.lineStart){let o=rT(n,t.strokeWidth,t.strokeColor,t.lineStart,tH(r.x-n.x,r.y-n.y));n=o.position||n,e.push(o.shape)}if(t.lineEnd){let o=rT(r,t.strokeWidth,t.strokeColor,t.lineEnd,tH(n.x-r.x,n.y-r.y));r=o.position||n,e.push(o.shape)}t.points=[n,r]}else i_(t)?t.points=[tH(t.x1,t.y1),tH(t.x2,t.y2),tH(t.x3,t.y3)]:iN(t)&&(iL(t)&&(t.width=5,t.height=nJ(t.lineHeight)?t.lineHeight(t.fontSize):t.lineHeight),t.strokeWidth=1,t.strokeColor=[1,1,1,.5],t.backgroundColor=[0,0,0,.1]);return e},ie=lc(void 0,{duration:500});op(t,ie,t=>n(46,O=t));let ii=lu(void 0,{stiffness:.02,damping:.5,precision:.25});op(t,ii,t=>n(48,j=t));let ir=lu(void 0,{stiffness:.03,damping:.4,precision:.25});op(t,ir,t=>n(49,_=t));let io=()=>{ii.set(void 0,{hard:!0}),ir.set(void 0,{hard:!0})},ia=a$([]);op(t,ia,t=>n(213,z=t)),oV("keysPressed",ia);let il=()=>({utilVisibility:{...tm},isInteracting:p,isInteractingFraction:N,rootRect:eS(a),stageRect:eS(m),selectionRect:eS(P)}),is=(t,e,n,r)=>({annotationShapes:n9(e.filter(iW).map(iC).map(t=>rb(t,y))),decorationShapes:n9(n.filter(iW).map(iC).map(e=>n8(e,t)).map(e=>n7(e,t))),interfaceShapes:n9(r.filter(iW))}),ic=a$();return oV("rootPortal",ic),oV("rootRect",ng),t.$$set=t=>{"class"in t&&n(117,ee=t.class),"layout"in t&&n(118,en=t.layout),"stores"in t&&n(119,ei=t.stores),"locale"in t&&n(2,er=t.locale),"id"in t&&n(3,eo=t.id),"util"in t&&n(120,ea=t.util),"utils"in t&&n(121,el=t.utils),"animations"in t&&n(122,ec=t.animations),"previewUpscale"in t&&n(123,ed=t.previewUpscale),"elasticityMultiplier"in t&&n(4,eh=t.elasticityMultiplier),"willRevert"in t&&n(124,ep=t.willRevert),"willRenderCanvas"in t&&n(5,ef=t.willRenderCanvas),"willRenderToolbar"in t&&n(125,eg=t.willRenderToolbar),"enableButtonExport"in t&&n(126,em=t.enableButtonExport),"enableButtonRevert"in t&&n(127,e$=t.enableButtonRevert),"enableNavigateHistory"in t&&n(128,ey=t.enableNavigateHistory),"enableToolbar"in t&&n(6,eb=t.enableToolbar),"enableUtils"in t&&n(129,ev=t.enableUtils),"enableButtonClose"in t&&n(130,ew=t.enableButtonClose),"previewImageDataMaxSize"in t&&n(131,ek=t.previewImageDataMaxSize),"enableDropImage"in t&&n(132,eC=t.enableDropImage),"imageOrienter"in t&&n(133,eM=t.imageOrienter),"pluginComponents"in t&&n(134,eE=t.pluginComponents),"pluginOptions"in t&&n(7,eT=t.pluginOptions),"root"in t&&n(1,eP=t.root),"imageSourceToImageData"in t&&n(8,eX=t.imageSourceToImageData)},t.$$.update=()=>{if(33554432&t.$$.dirty[3]&&n(160,tn="overlay"===en),32&t.$$.dirty[4]|32&t.$$.dirty[5]&&n(14,ti=ev&&!tn),129&t.$$.dirty[0]&&eT&&Object.keys(eT).forEach(t=>{Object.keys(eT[t]).forEach(e=>{eI[t]&&n(0,eI[t][e]=eT[t][e],eI)})}),1&t.$$.dirty[0]|1024&t.$$.dirty[4]){let t=!1;eE.forEach(e=>{let[r]=e;eI[r]||(n(0,eI[r]={},eI),t=!0)}),t&&n(156,eD=[...eE])}128&t.$$.dirty[4]&&(tr=ek?ex(ek,eO):eO),128&t.$$.dirty[5]&&eV.update(r[0]),32768&t.$$.dirty[0]&&o&&ng.set(eL(o.x,o.y,o.width,o.height)),1312&t.$$.dirty[5]&&a&&tn&&s&&s.complete&&nm(),1073741824&t.$$.dirty[3]|32&t.$$.dirty[5]&&nM.set(ed||tn),32768&t.$$.dirty[5]&&n(177,to=!p),16777216&t.$$.dirty[5]&&n(178,ta=!v),536870912&t.$$.dirty[3]|12582912&t.$$.dirty[5]&&n(18,tl="always"===ec?to:"never"!==ec&&to&&ta),67108864&t.$$.dirty[5]&&n(180,ts=t8.index>-1),67108864&t.$$.dirty[5]&&n(182,tc=t8.index<t8.length-1),4&t.$$.dirty[0]|268435456&t.$$.dirty[3]|2&t.$$.dirty[5]&&n(184,tu=er&&eD.length?el||eD.map(t=>{let[e]=t;return e}):[]),536870914&t.$$.dirty[5]&&n(185,td=eD.filter(t=>{let[e]=t;return tu.includes(e)})),1073741824&t.$$.dirty[5]&&n(186,th=td.length),4&t.$$.dirty[0]|1610612736&t.$$.dirty[5]&&n(20,tp=tu.map(t=>{let e=td.find(e=>{let[n]=e;return t===n});if(e)return{id:t,view:e[1],tabIcon:er["".concat(t,"Icon")],tabLabel:er["".concat(t,"Label")]}}).filter(Boolean)||[]),134217728&t.$$.dirty[3]|536870912&t.$$.dirty[5]|1&t.$$.dirty[6]&&n(21,tf=ea&&"string"==typeof ea&&tu.includes(ea)?ea:th&&tu[0]),2097153&t.$$.dirty[0]&&n(187,tg=tf&&eI[tf].tools||[]),5242880&t.$$.dirty[0]&&n(22,tm=tp.reduce((t,e)=>(t[e.id]=tm&&tm[e.id]||0,t),{})),2097152&t.$$.dirty[0]&&n(23,t$={name:n2,selected:tf}),1048576&t.$$.dirty[0]&&n(24,ty=tp.map(t=>({id:t.id,icon:t.tabIcon,label:t.tabLabel}))),1048576&t.$$.dirty[0]&&n(25,tb=tp.map(t=>t.id)),536870912&t.$$.dirty[5]&&n(16,tv=tu.length>1),16777216&t.$$.dirty[3]&&n(26,tw=st(["DokaRoot","DokaRootComponent",ee])),256&t.$$.dirty[5]&&n(188,tk=a&&(a.width>a.height?"landscape":"portrait")),4&t.$$.dirty[6]&&n(27,tC="landscape"===tk),256&t.$$.dirty[5]&&n(189,tM=a&&(a.width>1e3?"wide":a.width<600?"narrow":void 0)),256&t.$$.dirty[5]&&n(190,tS=a&&(a.width<=320||a.height<=460)),256&t.$$.dirty[5]&&n(191,tA=a&&(a.height>1e3?"tall":a.height<600?"short":void 0)),2&t.$$.dirty[0]&&n(192,tE=eP&&eP.parentNode&&eP.parentNode.classList.contains("DokaModal")),1024&t.$$.dirty[0]|256&t.$$.dirty[5]|64&t.$$.dirty[6]&&n(193,tT=tE&&a&&Z>a.width),2048&t.$$.dirty[0]|256&t.$$.dirty[5]|64&t.$$.dirty[6]&&n(194,tR=tE&&a&&Q>a.height),384&t.$$.dirty[6]&&n(195,tI=tT&&tR),8&t.$$.dirty[6]&&n(196,tP="narrow"===tM),1056&t.$$.dirty[6]&&n(197,tD=tP||"short"===tA),1024&t.$$.dirty[0]|256&t.$$.dirty[5]&&n(198,tL=n3&&a&&Z===a.width&&!nH),34&t.$$.dirty[6]&&n(199,tF=tg.length&&"short"===tA),2&t.$$.dirty[0]&&n(200,tB=eP&&getComputedStyle(eP)),16384&t.$$.dirty[6]&&tB&&n6(),81984&t.$$.dirty[0]|33554432&t.$$.dirty[3]|236540&t.$$.dirty[6]&&nY.set({...M,layoutMode:en,orientation:tk,horizontalSpace:tM,verticalSpace:tA,isModal:tE,isCentered:tI,isCenteredHorizontally:tT,isCenteredVertically:tR,pointerAccuracy:S,pointerHoverable:A,isCompact:tD,hasSwipeNavigation:tL,hasLimitedSpace:tS,hasToolbar:eb,hasNavigation:tv&&ti,isIOS:n3}),32768&t.$$.dirty[6]&&n(29,tO=Object.keys(M).map(t=>/^is|has/.test(t)?M[t]?ct(t):void 0:M[t]).filter(Boolean).join(" ")),16384&t.$$.dirty[5]|3932160&t.$$.dirty[6]&&n(30,t_=E?{...Object.keys(T).filter(t=>null!=T[t]).reduce((t,e)=>t={...t,...T[e]},{}),...E,...R,backgroundColor:I,size:es(h)}:void 0),4&t.$$.dirty[0]|4194304&t.$$.dirty[6]&&n(32,tN=er&&tz.length&&er.labelSupportError(tz)),1024&t.$$.dirty[5]&&n(33,tU=s&&!!s.error),1024&t.$$.dirty[5]&&n(34,tW=!s||!s.complete&&void 0===s.task),1024&t.$$.dirty[5]&&n(35,tX=s&&(s.taskLengthComputable?s.taskProgress:1/0)),1040&t.$$.dirty[5]&&(s&&s.complete?(clearTimeout(tt),n(159,tt=setTimeout(()=>{oy(n_,D=!0,D)},500))):s||oy(n_,D=!1,D)),12&t.$$.dirty[1]|1024&t.$$.dirty[5]|8388608&t.$$.dirty[6]&&n(36,tV=s&&!tU&&!tW&&!D),128&t.$$.dirty[1]|16777216&t.$$.dirty[6]&&n(37,tY=!!(L&&!F)),268435456&t.$$.dirty[5]|33554432&t.$$.dirty[6]&&n(39,tG=k||B&&void 0!==B.progress&&!B.complete),8&t.$$.dirty[1]|1024&t.$$.dirty[5]&&n(40,tK=s&&!(s.error||tW)),4&t.$$.dirty[0]|1024&t.$$.dirty[5]&&n(41,tq=er&&(s?s.complete?er.statusLabelLoadImage({progress:1/0,task:"blob-to-bitmap"}):lT(er.statusLabelLoadImage(s),s.error&&s.error.metadata,"{","}"):er.statusLabelLoadImage(s))),4&t.$$.dirty[0]|33554432&t.$$.dirty[6]&&n(42,tZ=B&&er&&er.statusLabelProcessImage(B)),33554432&t.$$.dirty[6]&&n(43,tQ=B&&(B.taskLengthComputable?B.taskProgress:1/0)),33554432&t.$$.dirty[6]&&n(44,tJ=B&&!B.error),33554432&t.$$.dirty[6]&&n(45,t0=B&&B.error),366&t.$$.dirty[1]&&oy(ie,O=tN||tW||tU||tV||tY||tG?1:0,O),32768&t.$$.dirty[1]&&n(47,t1=O>0),32768&t.$$.dirty[1]&&O<=0&&io(),1024&t.$$.dirty[0]&&n(50,t2=nH&&(t=>{let e=t.touches?t.touches[0]:t;e.pageX>10&&e.pageX<Z-10||t.preventDefault()})),4&t.$$.dirty[0]|94&t.$$.dirty[4]|167772160&t.$$.dirty[5]|41986&t.$$.dirty[6]&&n(51,t4=er&&eg([["div","alpha",{class:"DokaNavGroup"},[["div","alpha-set",{class:"DokaNavSet"},[ew&&[sA,"close",{label:er.labelClose,icon:er.iconButtonClose,onclick:()=>et("close"),hideLabel:!0}],e$&&[sA,"revert",{label:er.labelButtonRevert,icon:er.iconButtonRevert,disabled:!ts,onclick:nZ,hideLabel:!0}]]]]],["div","beta",{class:"DokaNavGroup DokaNavGroupFloat"},[ey&&["div","history",{class:"DokaNavSet"},[[sA,"undo",{label:er.labelButtonUndo,icon:er.iconButtonUndo,disabled:!ts,onclick:nq.undo,hideLabel:!0}],[sA,"redo",{label:er.labelButtonRedo,icon:er.iconButtonRedo,disabled:!tc,onclick:nq.redo,hideLabel:!0}]]],tF&&["div","plugin-tools",{class:"DokaNavSet"},tg.filter(Boolean).map(t=>{let[e,n,r]=t;return[e,n,{...r,hideLabel:!0}]})]]],["div","gamma",{class:"DokaNavGroup"},[em&&[sA,"export",{label:er.labelButtonExport,icon:tP&&er.iconButtonExport,class:"DokaButtonExport",onclick:n0,hideLabel:tP}]]]],{...M})),32768&t.$$.dirty[0]&&n(212,t5=o&&o.width>0&&o.height>0),4&t.$$.dirty[0]|67108865&t.$$.dirty[6]&&n(52,t3=t5&&er&&th),8192&t.$$.dirty[0]&&te&&ic.set(te)},n(208,tz=[!c$()&&"WebGL"].filter(Boolean)),n(53,t6=s6(t9.pub)),[eI,eP,er,eo,eh,ef,eb,eT,eX,nq,Z,Q,n4,te,ti,o,tv,y,tl,w,tp,tf,tm,t$,ty,tb,tw,tC,C,tO,t_,P,tN,tU,tW,tX,tV,tY,F,tG,tK,tq,tZ,tQ,tJ,t0,O,t1,j,_,t2,t4,t3,t6,U,W,X,V,H,Y,G,eH,eG,eK,eZ,e0,nn,ns,nc,nu,nd,np,nf,ng,n$,ny,nx,nb,nv,nw,nk,nC,nM,nS,nA,nE,nR,nI,nP,nD,nF,nj,n_,nN,nU,nW,nX,nV,nY,nK,nQ,n1,t=>{let{target:e,propertyName:n}=t;e===eP&&"background-color"===n&&n6()},ie,ii,ir,t=>{oy(ii,j=Math.round(-(.5*t.detail.width))-16,j),oy(ir,_=t.detail.width,_)},()=>{et("abortLoadImage")},()=>{et("abortProcessImage"),oy(nQ,k=!1,k)},ia,t=>{let{keyCode:e}=t,n=new Set([...z,e]);ia.set(Array.from(n))},t=>{let{keyCode:e}=t;ia.set(z.filter(t=>t!==e))},()=>{ia.set([])},t=>{s9(t.target)||t.preventDefault()},t=>{eC&&t.detail.files.length&&et("loadImage",t.detail.files[0])},il,is,ee,en,ei,ea,el,ec,ed,ep,eg,em,e$,ey,ev,ew,ek,eC,eM,eE,eR,function(){n(10,Z=window.innerWidth),n(11,Q=window.innerHeight)},t=>oy(ny,U=t.detail,U),t=>{let{detail:e}=t;return n(21,tf=e)},(t,e)=>e.id===t,function(t,e){eI[e]=t,n(0,eI),n(7,eT),n(134,eE)},t=>oy(nx,W=t.detail,W),t=>n(12,n4=n4.concat(t)),t=>n(12,n4=n4.filter(e=>e!==t)),(t,e)=>{let{detail:r}=e;return n(22,tm[t]=r,tm)},t=>oy(n$,w=t.detail,w),t=>t.id===tf,function(t){eI[tf]=t,n(0,eI),n(7,eT),n(134,eE)},t=>oy(nx,W=t.detail,W),()=>n(12,n4=n4.concat(tf)),()=>n(12,n4=n4.filter(t=>t!==tf)),t=>{let{detail:e}=t;return n(22,tm[tf]=e,tm)},t=>{let e={...t,...il()},{annotationShapes:n,decorationShapes:r,interfaceShapes:o}=ef({decorationShapes:H,annotationShapes:Y,interfaceShapes:G},e);return is(e,n,r,o)},function(t){oK[t?"unshift":"push"](()=>{n(13,te=t)})},function(t){oK[t?"unshift":"push"](()=>{n(1,eP=t)})},t=>oy(nf,o=t.detail,o)]}class cj extends af{get class(){return this.$$.ctx[117]}set class(t){this.$set({class:t}),o5()}get layout(){return this.$$.ctx[118]}set layout(t){this.$set({layout:t}),o5()}get stores(){return this.$$.ctx[119]}set stores(t){this.$set({stores:t}),o5()}get locale(){return this.$$.ctx[2]}set locale(t){this.$set({locale:t}),o5()}get id(){return this.$$.ctx[3]}set id(t){this.$set({id:t}),o5()}get util(){return this.$$.ctx[120]}set util(t){this.$set({util:t}),o5()}get utils(){return this.$$.ctx[121]}set utils(t){this.$set({utils:t}),o5()}get animations(){return this.$$.ctx[122]}set animations(t){this.$set({animations:t}),o5()}get previewUpscale(){return this.$$.ctx[123]}set previewUpscale(t){this.$set({previewUpscale:t}),o5()}get elasticityMultiplier(){return this.$$.ctx[4]}set elasticityMultiplier(t){this.$set({elasticityMultiplier:t}),o5()}get willRevert(){return this.$$.ctx[124]}set willRevert(t){this.$set({willRevert:t}),o5()}get willRenderCanvas(){return this.$$.ctx[5]}set willRenderCanvas(t){this.$set({willRenderCanvas:t}),o5()}get willRenderToolbar(){return this.$$.ctx[125]}set willRenderToolbar(t){this.$set({willRenderToolbar:t}),o5()}get enableButtonExport(){return this.$$.ctx[126]}set enableButtonExport(t){this.$set({enableButtonExport:t}),o5()}get enableButtonRevert(){return this.$$.ctx[127]}set enableButtonRevert(t){this.$set({enableButtonRevert:t}),o5()}get enableNavigateHistory(){return this.$$.ctx[128]}set enableNavigateHistory(t){this.$set({enableNavigateHistory:t}),o5()}get enableToolbar(){return this.$$.ctx[6]}set enableToolbar(t){this.$set({enableToolbar:t}),o5()}get enableUtils(){return this.$$.ctx[129]}set enableUtils(t){this.$set({enableUtils:t}),o5()}get enableButtonClose(){return this.$$.ctx[130]}set enableButtonClose(t){this.$set({enableButtonClose:t}),o5()}get previewImageDataMaxSize(){return this.$$.ctx[131]}set previewImageDataMaxSize(t){this.$set({previewImageDataMaxSize:t}),o5()}get enableDropImage(){return this.$$.ctx[132]}set enableDropImage(t){this.$set({enableDropImage:t}),o5()}get imageOrienter(){return this.$$.ctx[133]}set imageOrienter(t){this.$set({imageOrienter:t}),o5()}get pluginComponents(){return this.$$.ctx[134]}set pluginComponents(t){this.$set({pluginComponents:t}),o5()}get pluginOptions(){return this.$$.ctx[7]}set pluginOptions(t){this.$set({pluginOptions:t}),o5()}get sub(){return this.$$.ctx[135]}get pluginInterface(){return this.$$.ctx[0]}get root(){return this.$$.ctx[1]}set root(t){this.$set({root:t}),o5()}get imageSourceToImageData(){return this.$$.ctx[8]}set imageSourceToImageData(t){this.$set({imageSourceToImageData:t}),o5()}get history(){return this.$$.ctx[9]}constructor(t){super(),ap(this,t,cO,cF,ou,{class:117,layout:118,stores:119,locale:2,id:3,util:120,utils:121,animations:122,previewUpscale:123,elasticityMultiplier:4,willRevert:124,willRenderCanvas:5,willRenderToolbar:125,enableButtonExport:126,enableButtonRevert:127,enableNavigateHistory:128,enableToolbar:6,enableUtils:129,enableButtonClose:130,previewImageDataMaxSize:131,enableDropImage:132,imageOrienter:133,pluginComponents:134,pluginOptions:7,sub:135,pluginInterface:0,root:1,imageSourceToImageData:8,history:9},[-1,-1,-1,-1,-1,-1,-1,-1,-1])}}let c_=["klass","stores","isVisible","isActive","isActiveFraction","locale"],cz=["history","klass","stores","navButtons","pluginComponents","pluginInterface","pluginOptions","sub"],cN=new Set([]),cU={},cW=new Map;[...ln];let{document:cX}=ai;tn()&&HTMLElement;let cV=t=>Math.round(100*t),cH=null;var cY=t=>(null===cH&&(cH=1===ch()?t=>Math.round(t):t=>t),cH(t));let cG=t=>({}),cK=t=>({}),cq=t=>({}),cZ=t=>({});function cQ(t){let e;let n=t[19].label,r=of(n,t,t[23],cZ);return{c(){r&&r.c()},m(t,n){r&&r.m(t,n),e=!0},p(t,e){r&&r.p&&8388608&e[0]&&om(r,n,t,t[23],e,cq,cZ)},i(t){e||(o9(r,t),e=!0)},o(t){at(r,t),e=!1},d(t){r&&r.d(t)}}}function cJ(t){let e,n,r,o,a;let l=t[19].details,s=of(l,t,t[23],cK);return{c(){e=oE("div"),s&&s.c(),oL(e,"class",n=st(["DokaDetailsPanel",t[1]])),oL(e,"tabindex","-1"),oL(e,"style",t[6])},m(n,l){oS(n,e,l),s&&s.m(e,null),t[21](e),r=!0,o||(a=[oD(e,"keydown",t[16]),oD(e,"measure",t[22]),ox(lv.call(null,e))],o=!0)},p(t,o){s&&s.p&&8388608&o[0]&&om(s,l,t,t[23],o,cG,cK),(!r||2&o[0]&&n!==(n=st(["DokaDetailsPanel",t[1]])))&&oL(e,"class",n),(!r||64&o[0])&&oL(e,"style",t[6])},i(t){r||(o9(s,t),r=!0)},o(t){at(s,t),r=!1},d(n){n&&oA(e),s&&s.d(n),t[21](null),o=!1,os(a)}}}function c0(t){let e,n,r,o,a,l,s,c;let u={class:st(["DokaDetailsButton",t[0]]),onkeydown:t[15],onclick:t[14],$$slots:{default:[cQ]},$$scope:{ctx:t}};n=new sA({props:u}),t[20](n);let d=t[5]&&cJ(t);return{c(){e=oI(),au(n.$$.fragment),r=oI(),d&&d.c(),o=oI(),a=oP()},m(u,h){oS(u,e,h),ad(n,u,h),oS(u,r,h),d&&d.m(u,h),oS(u,o,h),oS(u,a,h),l=!0,s||(c=[oD(document.body,"pointerdown",function(){oc(t[7])&&t[7].apply(this,arguments)}),oD(document.body,"pointerup",function(){oc(t[8])&&t[8].apply(this,arguments)})],s=!0)},p(e,r){t=e;let a={};1&r[0]&&(a.class=st(["DokaDetailsButton",t[0]])),8388608&r[0]&&(a.$$scope={dirty:r,ctx:t}),n.$set(a),t[5]?d?(d.p(t,r),32&r[0]&&o9(d,1)):((d=cJ(t)).c(),o9(d,1),d.m(o.parentNode,o)):d&&(o8(),at(d,1,1,()=>{d=null}),o7())},i(t){l||(o9(n.$$.fragment,t),o9(d),o9(!1),l=!0)},o(t){at(n.$$.fragment,t),at(d),at(!1),l=!1},d(l){l&&oA(e),t[20](null),ah(n,l),l&&oA(r),d&&d.d(l),l&&oA(o),l&&oA(a),s=!1,os(c)}}}function c1(t,e,n){let r,o,a,l,s,c,u,d,h,p,f,g,m,$,y,x,b;let{$$slots:v={},$$scope:w}=e,{buttonClass:k}=e,{panelClass:C}=e,{isActive:M=!1}=e,{onshow:S=t=>{let{panel:e}=t;return e.focus()}}=e,A=oH("rootPortal");op(t,A,t=>n(35,s=t));let E=oH("rootRect");op(t,E,t=>n(29,r=t));let T=tV(),R=lu(0);op(t,R,t=>n(31,a=t));let I=a$({x:0,y:0});op(t,I,t=>n(30,o=t));let P=lu(-5);op(t,P,t=>n(34,l=t));let D=t=>sv(t,s)||u.isEventTarget(t),L=!1;return oW(()=>{s&&h&&s.removeChild(h)}),t.$$set=t=>{"buttonClass"in t&&n(0,k=t.buttonClass),"panelClass"in t&&n(1,C=t.panelClass),"isActive"in t&&n(17,M=t.isActive),"onshow"in t&&n(18,S=t.onshow),"$$scope"in t&&n(23,w=t.$$scope)},t.$$.update=()=>{if(8&t.$$.dirty[0]&&(f=u&&u.getElement()),67239936&t.$$.dirty[0]&&n(8,b=M?t=>{L&&(n(26,L=!1),D(t)||n(17,M=!1))}:void 0),131072&t.$$.dirty[0]&&R.set(M?1:0),131072&t.$$.dirty[0]&&P.set(M?0:-5),553648132&t.$$.dirty[0]&&r&&c&&d){let t=d.x-r.x+.5*d.width-.5*c.width,e=d.y-r.y+d.height,a=r.width-12,l=r.height-12,s=t,u=e,h=s+c.width,p=u+c.height;if(s<12&&(t=12),h>a&&(t=a-c.width),p>l){n(25,T.y=-1,T);let t=e-c.height-d.height;12<t?e-=c.height+d.height:e-=p-l}else n(25,T.y=1,T);oy(I,o=t3(tH(t,e),cY),o)}1&t.$$.dirty[1]&&n(5,g=a>0),1&t.$$.dirty[1]&&n(32,m=a<1),1107296256&t.$$.dirty[0]|8&t.$$.dirty[1]&&n(33,$="translateX(".concat(o.x+12*T.x,"px) translateY(").concat(o.y+12*T.y+T.y*l,"px)")),7&t.$$.dirty[1]&&n(6,y=m?"opacity: ".concat(a,"; pointer-events: ").concat(a<1?"none":"all","; transform: ").concat($,";"):"transform: ".concat($)),131072&t.$$.dirty[0]&&n(7,x=M?t=>{D(t)||n(26,L=!0)}:void 0),48&t.$$.dirty[0]|16&t.$$.dirty[1]&&g&&s&&h&&h.parentNode!==s&&s.appendChild(h),131072&t.$$.dirty[0]&&!M&&n(27,p=void 0),134479920&t.$$.dirty[0]&&g&&h&&S({e:p,panel:h})},[k,C,c,u,h,g,y,x,b,A,E,R,I,P,t=>{M||n(24,d=f.getBoundingClientRect()),n(27,p=t),n(17,M=!M)},t=>{/down/i.test(t.key)&&(n(17,M=!0),n(27,p=t))},t=>{/esc/i.test(t.key)&&(n(17,M=!1),f.focus())},M,S,v,function(t){oK[t?"unshift":"push"](()=>{n(3,u=t)})},function(t){oK[t?"unshift":"push"](()=>{n(4,h=t)})},t=>n(2,c=el(t.detail)),w]}class c2 extends af{constructor(t){super(),ap(this,t,c1,c0,ou,{buttonClass:0,panelClass:1,isActive:17,onshow:18},[-1,-1])}}function c4(t){let e,n,r,o,a,l,s,c;let u=t[14].default,d=of(u,t,t[13],null);return{c(){e=oE("li"),n=oE("input"),r=oI(),o=oE("label"),d&&d.c(),oL(n,"type","radio"),oL(n,"class","implicit"),oL(n,"id",t[6]),oL(n,"name",t[0]),n.value=t[3],n.disabled=t[5],n.checked=t[4],oL(o,"for",t[6]),oL(o,"title",t[2]),oL(e,"class",a=st(["DokaRadioGroupOption",t[1]])),oL(e,"data-disabled",t[5]),oL(e,"data-selected",t[4])},m(a,u){if(oS(a,e,u),oM(e,n),oM(e,r),oM(e,o),d&&d.m(o,null),l=!0,!s){var h;c=[oD(n,"change",(h=t[15],function(t){return t.stopPropagation(),h.call(this,t)})),oD(n,"keydown",t[8]),oD(n,"click",t[9])],s=!0}},p(t,r){let[s]=r;(!l||64&s)&&oL(n,"id",t[6]),(!l||1&s)&&oL(n,"name",t[0]),(!l||8&s)&&(n.value=t[3]),(!l||32&s)&&(n.disabled=t[5]),(!l||16&s)&&(n.checked=t[4]),d&&d.p&&8192&s&&om(d,u,t,t[13],s,null,null),(!l||64&s)&&oL(o,"for",t[6]),(!l||4&s)&&oL(o,"title",t[2]),(!l||2&s&&a!==(a=st(["DokaRadioGroupOption",t[1]])))&&oL(e,"class",a),(!l||32&s)&&oL(e,"data-disabled",t[5]),(!l||16&s)&&oL(e,"data-selected",t[4])},i(t){l||(o9(d,t),l=!0)},o(t){at(d,t),l=!1},d(t){t&&oA(e),d&&d.d(t),s=!1,os(c)}}}function c5(t,e,n){let r,o;let{$$slots:a={},$$scope:l}=e,{name:s}=e,{class:c}=e,{label:u}=e,{id:d}=e,{value:h}=e,{checked:p}=e,{onkeydown:f}=e,{onclick:g}=e,{disabled:m=!1}=e,$=oH("keysPressed");return op(t,$,t=>n(16,r=t)),t.$$set=t=>{"name"in t&&n(0,s=t.name),"class"in t&&n(1,c=t.class),"label"in t&&n(2,u=t.label),"id"in t&&n(10,d=t.id),"value"in t&&n(3,h=t.value),"checked"in t&&n(4,p=t.checked),"onkeydown"in t&&n(11,f=t.onkeydown),"onclick"in t&&n(12,g=t.onclick),"disabled"in t&&n(5,m=t.disabled),"$$scope"in t&&n(13,l=t.$$scope)},t.$$.update=()=>{1025&t.$$.dirty&&n(6,o="".concat(s,"-").concat(d))},[s,c,u,h,p,m,o,$,t=>{f(t)},t=>{r.length||g(t)},d,f,g,l,a,function(e){oY(t,e)}]}class c3 extends af{constructor(t){super(),ap(this,t,c5,c4,ou,{name:0,class:1,label:2,id:10,value:3,checked:4,onkeydown:11,onclick:12,disabled:5})}}var c6=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.reduce((t,e)=>{let n=n0(e)?n0(e[1]):!!e.options;return n?t.concat(n0(e)?e[1]:e.options):(t.push(e),t)},[])};let c8=(t,e,n)=>{let r;return n0(t)?r={id:e,value:t[0],label:t[1],...t[2]||{}}:(r=t).id=null!=r.id?r.id:e,n?n(r):r};var c7=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1?arguments[1]:void 0,n=0;return t.map(t=>(n++,n0(t))?n0(t[1])?{id:n,label:t[0],options:t[1].map(t=>c8(t,++n,e))}:c8(t,n,e):t.options?{id:t.id||n,label:t.label,options:t.options.map(t=>c8(t,++n,e))}:c8(t,n,e))},c9=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return t&&t(...n)},ut=(t,e,n)=>nJ(t)?t(e,n):t;let ue=(t,e)=>t.map(t=>{let[n,r,o]=t;if(n0(r))return[ut(n,e),ue(r,e)];{let t=[n,ut(r,e)];if(o){let n={...o};o.icon&&(n.icon=ut(o.icon,e)),t.push(n)}return t}});var un=(t,e)=>ue(t,e);let ui=t=>({option:2048&t[0]}),ur=t=>({option:t[27]}),uo=t=>({option:2048&t[0]}),ua=t=>({option:t[27]});function ul(t,e,n){let r=t.slice();return r[27]=e[n],r}let us=t=>({option:2048&t[0]}),uc=t=>({option:t[27]});function uu(t,e,n){let r=t.slice();return r[27]=e[n],r}function ud(t){let e,n,r,o,a;let l=[],s=new Map,c=t[1]&&uh(t),u=t[11],d=t=>t[27].id;for(let e=0;e<u.length;e+=1){let n=uu(t,u,e),r=d(n);s.set(r,l[e]=uC(r,n))}return{c(){e=oE("fieldset"),c&&c.c(),n=oI(),r=oE("ul");for(let t=0;t<l.length;t+=1)l[t].c();oL(r,"class","DokaRadioGroupOptions"),oL(e,"class",o=st(["DokaRadioGroup",t[3]])),oL(e,"data-layout",t[5]),oL(e,"title",t[7])},m(t,o){oS(t,e,o),c&&c.m(e,null),oM(e,n),oM(e,r);for(let t=0;t<l.length;t+=1)l[t].m(r,null);a=!0},p(t,u){if(t[1]?c?c.p(t,u):((c=uh(t)).c(),c.m(e,n)):c&&(c.d(1),c=null),4225873&u[0]){let e=t[11];o8(),l=aa(l,u,d,1,t,e,s,r,ao,uC,null,uu),o7()}(!a||8&u[0]&&o!==(o=st(["DokaRadioGroup",t[3]])))&&oL(e,"class",o),(!a||32&u[0])&&oL(e,"data-layout",t[5]),(!a||128&u[0])&&oL(e,"title",t[7])},i(t){if(!a){for(let t=0;t<u.length;t+=1)o9(l[t]);a=!0}},o(t){for(let t=0;t<l.length;t+=1)at(l[t]);a=!1},d(t){t&&oA(e),c&&c.d();for(let t=0;t<l.length;t+=1)l[t].d()}}}function uh(t){let e,n,r;return{c(){e=oE("legend"),n=oR(t[1]),oL(e,"class",r=t[2]&&"implicit")},m(t,r){oS(t,e,r),oM(e,n)},p(t,o){2&o[0]&&oB(n,t[1]),4&o[0]&&r!==(r=t[2]&&"implicit")&&oL(e,"class",r)},d(t){t&&oA(e)}}}function up(t){let e,n;return e=new c3({props:{name:t[4],label:t[27].label,id:t[27].id,value:t[27].value,disabled:t[27].disabled,class:t[8],checked:t[12](t[27])===t[0],onkeydown:t[13](t[27]),onclick:t[14](t[27]),$$slots:{default:[uy]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};16&n[0]&&(r.name=t[4]),2048&n[0]&&(r.label=t[27].label),2048&n[0]&&(r.id=t[27].id),2048&n[0]&&(r.value=t[27].value),2048&n[0]&&(r.disabled=t[27].disabled),256&n[0]&&(r.class=t[8]),2049&n[0]&&(r.checked=t[12](t[27])===t[0]),2048&n[0]&&(r.onkeydown=t[13](t[27])),2048&n[0]&&(r.onclick=t[14](t[27])),4196416&n[0]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function uf(t){let e,n,r,o,a,l,s,c,u;let d=[],h=new Map,p=t[21].group,f=of(p,t,t[22],uc),g=f||(u=t[27].label+"",{c(){s=oE("span"),c=oR(u),oL(s,"class","DokaRadioGroupOptionGroupLabel")},m(t,e){oS(t,s,e),oM(s,c)},p(t,e){2048&e[0]&&u!==(u=t[27].label+"")&&oB(c,u)},d(t){t&&oA(s)}}),m=t[27].options,$=t=>t[27].id;for(let e=0;e<m.length;e+=1){let n=ul(t,m,e),r=$(n);h.set(r,d[e]=uk(r,n))}return{c(){e=oE("li"),g&&g.c(),n=oI(),r=oE("ul");for(let t=0;t<d.length;t+=1)d[t].c();o=oI(),oL(r,"class","DokaRadioGroupOptions"),oL(e,"class",a=st(["DokaRadioGroupOptionGroup",t[9]]))},m(t,a){oS(t,e,a),g&&g.m(e,null),oM(e,n),oM(e,r);for(let t=0;t<d.length;t+=1)d[t].m(r,null);oM(e,o),l=!0},p(t,n){if(f?f.p&&4196352&n[0]&&om(f,p,t,t[22],n,us,uc):g&&g.p&&2048&n[0]&&g.p(t,n),4225361&n[0]){let e=t[27].options;o8(),d=aa(d,n,$,1,t,e,h,r,ao,uk,null,ul),o7()}(!l||512&n[0]&&a!==(a=st(["DokaRadioGroupOptionGroup",t[9]])))&&oL(e,"class",a)},i(t){if(!l){o9(g,t);for(let t=0;t<m.length;t+=1)o9(d[t]);l=!0}},o(t){at(g,t);for(let t=0;t<d.length;t+=1)at(d[t]);l=!1},d(t){t&&oA(e),g&&g.d(t);for(let t=0;t<d.length;t+=1)d[t].d()}}}function ug(t){let e,n;return e=new sb({props:{$$slots:{default:[um]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};4196352&n[0]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function um(t){let e;let n=t[27].icon+"";return{c(){e=oT("g")},m(t,r){oS(t,e,r),e.innerHTML=n},p(t,r){2048&r[0]&&n!==(n=t[27].icon+"")&&(e.innerHTML=n)},d(t){t&&oA(e)}}}function u$(t){let e,n;let r=t[27].label+"";return{c(){e=oE("span"),n=oR(r),oL(e,"class",t[6])},m(t,r){oS(t,e,r),oM(e,n)},p(t,o){2048&o[0]&&r!==(r=t[27].label+"")&&oB(n,r),64&o[0]&&oL(e,"class",t[6])},d(t){t&&oA(e)}}}function uy(t){let e,n,r,o,a,l;let s=t[21].option,c=of(s,t,t[22],ur),u=c||(a=t[27].icon&&ug(t),l=!t[27].hideLabel&&u$(t),{c(){a&&a.c(),n=oI(),l&&l.c(),r=oI()},m(t,e){a&&a.m(t,e),oS(t,n,e),l&&l.m(t,e),oS(t,r,e),o=!0},p(t,e){t[27].icon?a?(a.p(t,e),2048&e[0]&&o9(a,1)):((a=ug(t)).c(),o9(a,1),a.m(n.parentNode,n)):a&&(o8(),at(a,1,1,()=>{a=null}),o7()),t[27].hideLabel?l&&(l.d(1),l=null):l?l.p(t,e):((l=u$(t)).c(),l.m(r.parentNode,r))},i(t){o||(o9(a),o=!0)},o(t){at(a),o=!1},d(t){a&&a.d(t),t&&oA(n),l&&l.d(t),t&&oA(r)}});return{c(){u&&u.c()},m(t,n){u&&u.m(t,n),e=!0},p(t,e){c?c.p&&4196352&e[0]&&om(c,s,t,t[22],e,ui,ur):u&&u.p&&2112&e[0]&&u.p(t,e)},i(t){e||(o9(u,t),e=!0)},o(t){at(u,t),e=!1},d(t){u&&u.d(t)}}}function ux(t){let e,n;return e=new sb({props:{$$slots:{default:[ub]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};4196352&n[0]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function ub(t){let e;let n=t[27].icon+"";return{c(){e=oT("g")},m(t,r){oS(t,e,r),e.innerHTML=n},p(t,r){2048&r[0]&&n!==(n=t[27].icon+"")&&(e.innerHTML=n)},d(t){t&&oA(e)}}}function uv(t){let e,n;let r=t[27].label+"";return{c(){e=oE("span"),n=oR(r),oL(e,"class",t[6])},m(t,r){oS(t,e,r),oM(e,n)},p(t,o){2048&o[0]&&r!==(r=t[27].label+"")&&oB(n,r),64&o[0]&&oL(e,"class",t[6])},d(t){t&&oA(e)}}}function uw(t){let e,n,r,o,a,l;let s=t[21].option,c=of(s,t,t[22],ua),u=c||(a=t[27].icon&&ux(t),l=!t[27].hideLabel&&uv(t),{c(){a&&a.c(),n=oI(),l&&l.c(),r=oI()},m(t,e){a&&a.m(t,e),oS(t,n,e),l&&l.m(t,e),oS(t,r,e),o=!0},p(t,e){t[27].icon?a?(a.p(t,e),2048&e[0]&&o9(a,1)):((a=ux(t)).c(),o9(a,1),a.m(n.parentNode,n)):a&&(o8(),at(a,1,1,()=>{a=null}),o7()),t[27].hideLabel?l&&(l.d(1),l=null):l?l.p(t,e):((l=uv(t)).c(),l.m(r.parentNode,r))},i(t){o||(o9(a),o=!0)},o(t){at(a),o=!1},d(t){a&&a.d(t),t&&oA(n),l&&l.d(t),t&&oA(r)}});return{c(){u&&u.c()},m(t,n){u&&u.m(t,n),e=!0},p(t,e){c?c.p&&4196352&e[0]&&om(c,s,t,t[22],e,uo,ua):u&&u.p&&2112&e[0]&&u.p(t,e)},i(t){e||(o9(u,t),e=!0)},o(t){at(u,t),e=!1},d(t){u&&u.d(t)}}}function uk(t,e){let n,r,o;return r=new c3({props:{name:e[4],label:e[27].label,id:e[27].id,value:e[27].value,disabled:e[27].disabled,class:e[8],checked:e[12](e[27])===e[0],onkeydown:e[13](e[27]),onclick:e[14](e[27]),$$slots:{default:[uw]},$$scope:{ctx:e}}}),{key:t,first:null,c(){n=oP(),au(r.$$.fragment),this.first=n},m(t,e){oS(t,n,e),ad(r,t,e),o=!0},p(t,e){let n={};16&e[0]&&(n.name=t[4]),2048&e[0]&&(n.label=t[27].label),2048&e[0]&&(n.id=t[27].id),2048&e[0]&&(n.value=t[27].value),2048&e[0]&&(n.disabled=t[27].disabled),256&e[0]&&(n.class=t[8]),2049&e[0]&&(n.checked=t[12](t[27])===t[0]),2048&e[0]&&(n.onkeydown=t[13](t[27])),2048&e[0]&&(n.onclick=t[14](t[27])),4196416&e[0]&&(n.$$scope={dirty:e,ctx:t}),r.$set(n)},i(t){o||(o9(r.$$.fragment,t),o=!0)},o(t){at(r.$$.fragment,t),o=!1},d(t){t&&oA(n),ah(r,t)}}}function uC(t,e){let n,r,o,a,l;let s=[uf,up],c=[];function u(t,e){return t[27].options?0:1}return o=c[r=u(e)]=s[r](e),{key:t,first:null,c(){n=oP(),o.c(),a=oP(),this.first=n},m(t,e){oS(t,n,e),c[r].m(t,e),oS(t,a,e),l=!0},p(t,e){let n=r;(r=u(t))===n?c[r].p(t,e):(o8(),at(c[n],1,1,()=>{c[n]=null}),o7(),(o=c[r])||(o=c[r]=s[r](t)).c(),o9(o,1),o.m(a.parentNode,a))},i(t){l||(o9(o),l=!0)},o(t){at(o),l=!1},d(t){t&&oA(n),c[r].d(t),t&&oA(a)}}}function uM(t){let e,n,r;let o=t[10].length&&ud(t);return{c(){o&&o.c(),e=oI(),n=oP()},m(t,a){o&&o.m(t,a),oS(t,e,a),oS(t,n,a),r=!0},p(t,n){t[10].length?o?(o.p(t,n),1024&n[0]&&o9(o,1)):((o=ud(t)).c(),o9(o,1),o.m(e.parentNode,e)):o&&(o8(),at(o,1,1,()=>{o=null}),o7())},i(t){r||(o9(o),o9(!1),r=!0)},o(t){at(o),at(!1),r=!1},d(t){o&&o.d(t),t&&oA(e),t&&oA(n)}}}function uS(t,e,n){let r,o,a,{$$slots:l={},$$scope:s}=e,c=oX(),{label:u}=e,{hideLabel:d=!0}=e,{class:h}=e,{name:p="doka-radio-group-".concat(tx())}=e,{selectedIndex:f=-1}=e,{options:g=[]}=e,{onchange:m}=e,{layout:$}=e,{optionMapper:y}=e,{optionFilter:x}=e,{value:b}=e,{optionLabelClass:v}=e,{title:w}=e,{locale:k}=e,{optionClass:C}=e,{optionGroupClass:M}=e,S=t=>a.findIndex(e=>e.id===t.id),A=t=>/enter| /i.test(t),E=t=>{n(0,f=S(t));let e={index:f,...t};c9(m,e),c("change",e)};return t.$$set=t=>{"label"in t&&n(1,u=t.label),"hideLabel"in t&&n(2,d=t.hideLabel),"class"in t&&n(3,h=t.class),"name"in t&&n(4,p=t.name),"selectedIndex"in t&&n(0,f=t.selectedIndex),"options"in t&&n(15,g=t.options),"onchange"in t&&n(16,m=t.onchange),"layout"in t&&n(5,$=t.layout),"optionMapper"in t&&n(17,y=t.optionMapper),"optionFilter"in t&&n(18,x=t.optionFilter),"value"in t&&n(19,b=t.value),"optionLabelClass"in t&&n(6,v=t.optionLabelClass),"title"in t&&n(7,w=t.title),"locale"in t&&n(20,k=t.locale),"optionClass"in t&&n(8,C=t.optionClass),"optionGroupClass"in t&&n(9,M=t.optionGroupClass),"$$scope"in t&&n(22,s=t.$$scope)},t.$$.update=()=>{1343488&t.$$.dirty[0]&&n(10,r=un(x?g.filter(x):g,k)),132096&t.$$.dirty[0]&&n(11,o=c7(r,y)),2048&t.$$.dirty[0]&&n(23,a=c6(o)),8912897&t.$$.dirty[0]&&b&&f<0&&n(0,f=a.findIndex(t=>t.value===b))},[f,u,d,h,p,$,v,w,C,M,r,o,S,t=>e=>{A(e.key)&&E(t)},t=>e=>{E(t)},g,m,y,x,b,k,l,s]}class uA extends af{constructor(t){super(),ap(this,t,uS,uM,ou,{label:1,hideLabel:2,class:3,name:4,selectedIndex:0,options:15,onchange:16,layout:5,optionMapper:17,optionFilter:18,value:19,optionLabelClass:6,title:7,locale:20,optionClass:8,optionGroupClass:9},[-1,-1])}}var uE=(t,e)=>Array.isArray(t)&&Array.isArray(e)?aY(t,e):t===e;function uT(t){let e,n;return e=new sb({props:{$$slots:{default:[uR]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};134217792&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function uR(t){let e;return{c(){e=oT("g")},m(n,r){oS(n,e,r),e.innerHTML=t[6]},p(t,n){64&n&&(e.innerHTML=t[6])},d(t){t&&oA(e)}}}function uI(t){let e,n,r;let o=(t[2]||t[18])+"";return{c(){e=oE("span"),n=oR(o),oL(e,"class",r=st(["DokaButtonLabel",t[3]]))},m(t,r){oS(t,e,r),oM(e,n)},p(t,a){262148&a&&o!==(o=(t[2]||t[18])+"")&&oB(n,o),8&a&&r!==(r=st(["DokaButtonLabel",t[3]]))&&oL(e,"class",r)},d(t){t&&oA(e)}}}function uP(t){let e,n,r,o,a;let l=t[6]&&uT(t),s=!t[5]&&uI(t);return{c(){e=oE("span"),l&&l.c(),n=oI(),s&&s.c(),oL(e,"slot","label"),oL(e,"title",r=ut(t[1],t[15])),oL(e,"class",o=st(["DokaButtonInner",t[4]]))},m(t,r){oS(t,e,r),l&&l.m(e,null),oM(e,n),s&&s.m(e,null),a=!0},p(t,c){t[6]?l?(l.p(t,c),64&c&&o9(l,1)):((l=uT(t)).c(),o9(l,1),l.m(e,n)):l&&(o8(),at(l,1,1,()=>{l=null}),o7()),t[5]?s&&(s.d(1),s=null):s?s.p(t,c):((s=uI(t)).c(),s.m(e,null)),(!a||32770&c&&r!==(r=ut(t[1],t[15])))&&oL(e,"title",r),(!a||16&c&&o!==(o=st(["DokaButtonInner",t[4]])))&&oL(e,"class",o)},i(t){a||(o9(l),a=!0)},o(t){at(l),a=!1},d(t){t&&oA(e),l&&l.d(),s&&s.d()}}}function uD(t){let e,n;let r=t[26].label+"";return{c(){e=oE("span"),n=oR(r),oL(e,"slot","group")},m(t,r){oS(t,e,r),oM(e,n)},p(t,e){67108864&e&&r!==(r=t[26].label+"")&&oB(n,r)},d(t){t&&oA(e)}}}function uL(t){let e,n;return e=new sb({props:{style:nJ(t[13])?t[13](t[26].value):t[13],$$slots:{default:[uF]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};67117056&n&&(r.style=nJ(t[13])?t[13](t[26].value):t[13]),201326592&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function uF(t){let e;let n=t[26].icon+"";return{c(){e=oT("g")},m(t,r){oS(t,e,r),e.innerHTML=n},p(t,r){67108864&r&&n!==(n=t[26].icon+"")&&(e.innerHTML=n)},d(t){t&&oA(e)}}}function uB(t){let e,n,r,o,a,l,s;let c=t[26].label+"",u=t[26].icon&&uL(t);return{c(){e=oE("span"),u&&u.c(),n=oI(),r=oE("span"),o=oR(c),oL(r,"style",a=nJ(t[14])?t[14](t[26].value):t[14]),oL(r,"class",l=st(["DokaDropdownOptionLabel",t[10]])),oL(e,"slot","option")},m(t,a){oS(t,e,a),u&&u.m(e,null),oM(e,n),oM(e,r),oM(r,o),s=!0},p(t,d){t[26].icon?u?(u.p(t,d),67108864&d&&o9(u,1)):((u=uL(t)).c(),o9(u,1),u.m(e,n)):u&&(o8(),at(u,1,1,()=>{u=null}),o7()),(!s||67108864&d)&&c!==(c=t[26].label+"")&&oB(o,c),(!s||67125248&d&&a!==(a=nJ(t[14])?t[14](t[26].value):t[14]))&&oL(r,"style",a),(!s||1024&d&&l!==(l=st(["DokaDropdownOptionLabel",t[10]])))&&oL(r,"class",l)},i(t){s||(o9(u),s=!0)},o(t){at(u),s=!1},d(t){t&&oA(e),u&&u.d()}}}function uO(t){let e;return{c(){e=oI()},m(t,n){oS(t,e,n)},p:oi,i:oi,o:oi,d(t){t&&oA(e)}}}function uj(t){let e,n,r,o,a;return n=new uA({props:{name:t[7],value:t[9],selectedIndex:t[8],optionFilter:t[11],optionMapper:t[12],optionLabelClass:st(["DokaDropdownOptionLabel",t[10]]),optionGroupClass:"DokaDropdownOptionGroup",optionClass:"DokaDropdownOption",options:t[17],onchange:t[19],$$slots:{default:[uO,t=>{let{option:e}=t;return{26:e}},t=>{let{option:e}=t;return e?67108864:0}],option:[uB,t=>{let{option:e}=t;return{26:e}},t=>{let{option:e}=t;return e?67108864:0}],group:[uD,t=>{let{option:e}=t;return{26:e}},t=>{let{option:e}=t;return e?67108864:0}]},$$scope:{ctx:t}}}),{c(){e=oE("div"),au(n.$$.fragment),oL(e,"class","DokaDropdownPanel"),oL(e,"slot","details")},m(l,s){oS(l,e,s),ad(n,e,null),r=!0,o||(a=oD(e,"keydown",t[21]),o=!0)},p(t,e){let r={};128&e&&(r.name=t[7]),512&e&&(r.value=t[9]),256&e&&(r.selectedIndex=t[8]),2048&e&&(r.optionFilter=t[11]),4096&e&&(r.optionMapper=t[12]),1024&e&&(r.optionLabelClass=st(["DokaDropdownOptionLabel",t[10]])),131072&e&&(r.options=t[17]),201352192&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n),o=!1,a()}}}function u_(t){let e;return{c(){e=oI()},m(t,n){oS(t,e,n)},p:oi,i:oi,o:oi,d(t){t&&oA(e)}}}function uz(t){let e,n,r;function o(e){t[24].call(null,e)}let a={onshow:t[20],buttonClass:st(["DokaDropdownButton",t[0],t[5]&&"DokaDropdownIconOnly"]),$$slots:{default:[u_],details:[uj],label:[uP]},$$scope:{ctx:t}};return void 0!==t[16]&&(a.isActive=t[16]),e=new c2({props:a}),oK.push(()=>ac(e,"isActive",o)),{c(){au(e.$$.fragment)},m(t,n){ad(e,t,n),r=!0},p(t,r){let[o]=r,a={};33&o&&(a.buttonClass=st(["DokaDropdownButton",t[0],t[5]&&"DokaDropdownIconOnly"])),134676478&o&&(a.$$scope={dirty:o,ctx:t}),!n&&65536&o&&(n=!0,a.isActive=t[16],o1(()=>n=!1)),e.$set(a)},i(t){r||(o9(e.$$.fragment,t),r=!0)},o(t){at(e.$$.fragment,t),r=!1},d(t){ah(e,t)}}}function uN(t,e,n){let r,o,a,{class:l}=e,{title:s}=e,{label:c}=e,{labelClass:u}=e,{innerClass:d}=e,{hideLabel:h=!1}=e,{icon:p}=e,{name:f}=e,{options:g=[]}=e,{selectedIndex:m=-1}=e,{value:$}=e,{optionLabelClass:y}=e,{optionFilter:x}=e,{optionMapper:b}=e,{optionIconStyle:v}=e,{optionLabelStyle:w}=e,{onchange:k}=e,{locale:C}=e,M=t=>{let e=o.find(t=>void 0===t[0]);if(e)return e[1]};return t.$$set=t=>{"class"in t&&n(0,l=t.class),"title"in t&&n(1,s=t.title),"label"in t&&n(2,c=t.label),"labelClass"in t&&n(3,u=t.labelClass),"innerClass"in t&&n(4,d=t.innerClass),"hideLabel"in t&&n(5,h=t.hideLabel),"icon"in t&&n(6,p=t.icon),"name"in t&&n(7,f=t.name),"options"in t&&n(22,g=t.options),"selectedIndex"in t&&n(8,m=t.selectedIndex),"value"in t&&n(9,$=t.value),"optionLabelClass"in t&&n(10,y=t.optionLabelClass),"optionFilter"in t&&n(11,x=t.optionFilter),"optionMapper"in t&&n(12,b=t.optionMapper),"optionIconStyle"in t&&n(13,v=t.optionIconStyle),"optionLabelStyle"in t&&n(14,w=t.optionLabelStyle),"onchange"in t&&n(23,k=t.onchange),"locale"in t&&n(15,C=t.locale)},t.$$.update=()=>{4227072&t.$$.dirty&&n(17,o=un(g,C)),131584&t.$$.dirty&&n(18,a=o.reduce((t,e)=>{if(t)return t;let[n,r]=e;if(uE(n,$))return r},void 0)||M())},[l,s,c,u,d,h,p,f,m,$,y,x,b,v,w,C,r,o,a,t=>{n(18,a=t.value),k(t),n(16,r=!1)},t=>{let{e,panel:n}=t;if(e&&e.key&&/up|down/i.test(e.key))return n.querySelector("input:not([disabled])").focus();n.querySelector("fieldset").focus()},t=>{/tab/i.test(t.key)&&t.preventDefault()},g,k,function(t){n(16,r=t)}]}class uU extends af{constructor(t){super(),ap(this,t,uN,uz,ou,{class:0,title:1,label:2,labelClass:3,innerClass:4,hideLabel:5,icon:6,name:7,options:22,selectedIndex:8,value:9,optionLabelClass:10,optionFilter:11,optionMapper:12,optionIconStyle:13,optionLabelStyle:14,onchange:23,locale:15})}}function uW(t){let e,n,r,o,a,l,s,c,u,d,h;return{c(){e=oE("div"),n=oE("input"),r=oI(),o=oE("div"),a=oI(),l=oE("div"),s=oE("div"),oL(n,"type","range"),oL(n,"id",t[4]),oL(n,"min",t[1]),oL(n,"max",t[2]),oL(n,"step",t[3]),n.value=t[0],oL(o,"class","DokaSliderTrack"),oL(o,"style",t[5]),oL(s,"class","DokaSliderKnob"),oL(s,"style",t[6]),oL(l,"class","DokaSliderKnobController"),oL(l,"style",c="transform: translateX(".concat(t[9],"%)")),oL(e,"class",u=st(["DokaSlider",t[7]]))},m(c,u){oS(c,e,u),oM(e,n),t[14](n),oM(e,r),oM(e,o),oM(e,a),oM(e,l),oM(l,s),d||(h=[oD(n,"pointerdown",t[12]),oD(n,"input",t[10]),oD(n,"nudge",t[11]),ox(sP.call(null,n))],d=!0)},p(t,r){let[a]=r;16&a&&oL(n,"id",t[4]),2&a&&oL(n,"min",t[1]),4&a&&oL(n,"max",t[2]),8&a&&oL(n,"step",t[3]),1&a&&(n.value=t[0]),32&a&&oL(o,"style",t[5]),64&a&&oL(s,"style",t[6]),512&a&&c!==(c="transform: translateX(".concat(t[9],"%)"))&&oL(l,"style",c),128&a&&u!==(u=st(["DokaSlider",t[7]]))&&oL(e,"class",u)},i:oi,o:oi,d(n){n&&oA(e),t[14](null),d=!1,os(h)}}}function uX(t,e,n){let r,o,a,l,s,c,{min:u=0}=e,{max:d=100}=e,{step:h=1}=e,{id:p}=e,{value:f=0}=e,{trackStyle:g}=e,{knobStyle:m}=e,{onchange:$}=e,{class:y}=e,x=(t,e)=>{n(0,f=a_(u+t/e*s,u,d)),$(f)},b=t=>{let e=t.pageX-l;x(a+e,o)},v=t=>{o=void 0,document.documentElement.removeEventListener("pointermove",b),document.documentElement.removeEventListener("pointerup",v),$(f)};return t.$$set=t=>{"min"in t&&n(1,u=t.min),"max"in t&&n(2,d=t.max),"step"in t&&n(3,h=t.step),"id"in t&&n(4,p=t.id),"value"in t&&n(0,f=t.value),"trackStyle"in t&&n(5,g=t.trackStyle),"knobStyle"in t&&n(6,m=t.knobStyle),"onchange"in t&&n(13,$=t.onchange),"class"in t&&n(7,y=t.class)},t.$$.update=()=>{6&t.$$.dirty&&n(18,s=d-u),262145&t.$$.dirty&&n(9,c=f/s*100)},[f,u,d,h,p,g,m,y,r,c,t=>{o||(n(0,f=parseFloat(t.target.value)),$(f))},t=>{let e=r.offsetWidth,n=f/s*e;x(n+t.detail.x,e)},t=>{t.stopPropagation(),o=r.offsetWidth,a=t.offsetX,l=t.pageX,x(a,o),document.documentElement.addEventListener("pointermove",b),document.documentElement.addEventListener("pointerup",v)},$,function(t){oK[t?"unshift":"push"](()=>{n(8,r=t)})}]}class uV extends af{constructor(t){super(),ap(this,t,uX,uW,ou,{min:1,max:2,step:3,id:4,value:0,trackStyle:5,knobStyle:6,onchange:13,class:7})}}var uH=(t,e,n)=>{let r=Math.max(t,e,n),o=r-Math.min(t,e,n),a=o&&(r==t?(e-n)/o:r==e?2+(n-t)/o:4+(t-e)/o);return[60*(a<0?a+6:a)/360,r&&o/r,r]},uY=(t,e,n)=>{let r,o,a;let l=Math.floor(6*t),s=6*t-l,c=n*(1-e),u=n*(1-s*e),d=n*(1-(1-s)*e);switch(l%6){case 0:r=n,o=d,a=c;break;case 1:r=u,o=n,a=c;break;case 2:r=c,o=n,a=d;break;case 3:r=c,o=u,a=n;break;case 4:r=d,o=c,a=n;break;case 5:r=n,o=c,a=u}return[r,o,a]};function uG(t){let e,n,r;return{c(){e=oE("div"),n=oE("span"),oL(e,"class","DokaColorPreview"),oL(e,"title",t[0]),oL(e,"style",r="--color:".concat(t[1]))},m(t,r){oS(t,e,r),oM(e,n)},p(t,n){let[o]=n;1&o&&oL(e,"title",t[0]),2&o&&r!==(r="--color:".concat(t[1]))&&oL(e,"style",r)},i:oi,o:oi,d(t){t&&oA(e)}}}function uK(t,e,n){let r,{color:o}=e,{title:a}=e;return t.$$set=t=>{"color"in t&&n(2,o=t.color),"title"in t&&n(0,a=t.title)},t.$$.update=()=>{4&t.$$.dirty&&n(1,r=o?il(o):"transparent")},[a,r,o]}class uq extends af{constructor(t){super(),ap(this,t,uK,uG,ou,{color:2,title:0})}}function uZ(t){let e,n;return{c(){e=oE("span"),n=oR(t[0])},m(t,r){oS(t,e,r),oM(e,n)},p(t,e){1&e[0]&&oB(n,t[0])},d(t){t&&oA(e)}}}function uQ(t){let e,n,r,o;n=new uq({props:{color:t[4],title:ut(t[8],t[10])}});let a=!t[9]&&uZ(t);return{c(){e=oE("span"),au(n.$$.fragment),r=oI(),a&&a.c(),oL(e,"slot","label"),oL(e,"class","DokaButtonLabel")},m(t,l){oS(t,e,l),ad(n,e,null),oM(e,r),a&&a.m(e,null),o=!0},p(t,r){let o={};16&r[0]&&(o.color=t[4]),1280&r[0]&&(o.title=ut(t[8],t[10])),n.$set(o),t[9]?a&&(a.d(1),a=null):a?a.p(t,r):((a=uZ(t)).c(),a.m(e,null))},i(t){o||(o9(n.$$.fragment,t),o=!0)},o(t){at(n.$$.fragment,t),o=!1},d(t){t&&oA(e),ah(n),a&&a.d()}}}function uJ(t){let e,n,r,o,a,l,s,c,u,d,h,p,f;u=new uV({props:{class:"DokaHuePicker",knobStyle:"background-color:".concat(t[19]),onchange:t[24],value:t[14],min:0,max:1,step:.001}});let g=t[11]&&u0(t);return{c(){e=oE("div"),n=oE("div"),r=oE("div"),o=oE("div"),c=oI(),au(u.$$.fragment),d=oI(),g&&g.c(),oL(o,"role","button"),oL(o,"class","DokaPickerKnob"),oL(o,"tabindex","0"),oL(o,"style",a="background-color:".concat(t[18],";")),oL(r,"class","DokaPickerKnobController"),oL(r,"style",l="transform:translate(".concat(t[21],"%,").concat(t[22],"%)")),oL(n,"class","DokaSaturationPicker"),oL(n,"style",s="background-color: ".concat(t[19])),oL(e,"class","DokaPicker")},m(a,l){oS(a,e,l),oM(e,n),oM(n,r),oM(r,o),t[29](n),oM(e,c),ad(u,e,null),oM(e,d),g&&g.m(e,null),h=!0,p||(f=[oD(o,"nudge",t[27]),ox(sP.call(null,o)),oD(n,"pointerdown",t[26])],p=!0)},p(t,c){(!h||262144&c[0]&&a!==(a="background-color:".concat(t[18],";")))&&oL(o,"style",a),(!h||6291456&c[0]&&l!==(l="transform:translate(".concat(t[21],"%,").concat(t[22],"%)")))&&oL(r,"style",l),(!h||524288&c[0]&&s!==(s="background-color: ".concat(t[19])))&&oL(n,"style",s);let d={};524288&c[0]&&(d.knobStyle="background-color:".concat(t[19])),16384&c[0]&&(d.value=t[14]),u.$set(d),t[11]?g?(g.p(t,c),2048&c[0]&&o9(g,1)):((g=u0(t)).c(),o9(g,1),g.m(e,null)):g&&(o8(),at(g,1,1,()=>{g=null}),o7())},i(t){h||(o9(u.$$.fragment,t),o9(g),h=!0)},o(t){at(u.$$.fragment,t),at(g),h=!1},d(n){n&&oA(e),t[29](null),ah(u),g&&g.d(),p=!1,os(f)}}}function u0(t){let e,n;return e=new uV({props:{class:"DokaOpacityPicker",knobStyle:"background-color: ".concat(t[16]),trackStyle:"background-image: linear-gradient(to right, ".concat(t[17],", ").concat(t[18],")"),onchange:t[25],value:t[15],min:0,max:1,step:.001}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};65536&n[0]&&(r.knobStyle="background-color: ".concat(t[16])),393216&n[0]&&(r.trackStyle="background-image: linear-gradient(to right, ".concat(t[17],", ").concat(t[18],")")),32768&n[0]&&(r.value=t[15]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function u1(t){let e,n;return e=new uA({props:{label:"Presets",class:st(["DokaColorPresets",t[9]?"DokaColorPresetsGrid":"DokaColorPresetsList"]),hideLabel:!1,name:t[1],value:t[4],optionGroupClass:"DokaDropdownOptionGroup",optionClass:"DokaDropdownOption",options:t[2].map(t[30]),selectedIndex:t[3],optionMapper:t[7],optionLabelClass:t[6],onchange:t[31],$$slots:{default:[u3,t=>{let{option:e}=t;return{44:e}},t=>{let{option:e}=t;return[0,e?8192:0]}],option:[u5,t=>{let{option:e}=t;return{44:e}},t=>{let{option:e}=t;return[0,e?8192:0]}],group:[u2,t=>{let{option:e}=t;return{44:e}},t=>{let{option:e}=t;return[0,e?8192:0]}]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};512&n[0]&&(r.class=st(["DokaColorPresets",t[9]?"DokaColorPresetsGrid":"DokaColorPresetsList"])),2&n[0]&&(r.name=t[1]),16&n[0]&&(r.value=t[4]),1028&n[0]&&(r.options=t[2].map(t[30])),8&n[0]&&(r.selectedIndex=t[3]),128&n[0]&&(r.optionMapper=t[7]),64&n[0]&&(r.optionLabelClass=t[6]),512&n[0]|24576&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function u2(t){let e,n;let r=t[44].label+"";return{c(){e=oE("span"),n=oR(r),oL(e,"slot","group")},m(t,r){oS(t,e,r),oM(e,n)},p(t,e){8192&e[1]&&r!==(r=t[44].label+"")&&oB(n,r)},d(t){t&&oA(e)}}}function u4(t){let e,n;let r=t[44].label+"";return{c(){e=oE("span"),n=oR(r),oL(e,"class","DokaButtonLabel")},m(t,r){oS(t,e,r),oM(e,n)},p(t,e){8192&e[1]&&r!==(r=t[44].label+"")&&oB(n,r)},d(t){t&&oA(e)}}}function u5(t){let e,n,r,o;n=new uq({props:{title:t[44].label,color:t[44].value}});let a=!t[9]&&u4(t);return{c(){e=oE("span"),au(n.$$.fragment),r=oI(),a&&a.c(),oL(e,"slot","option")},m(t,l){oS(t,e,l),ad(n,e,null),oM(e,r),a&&a.m(e,null),o=!0},p(t,r){let o={};8192&r[1]&&(o.title=t[44].label),8192&r[1]&&(o.color=t[44].value),n.$set(o),t[9]?a&&(a.d(1),a=null):a?a.p(t,r):((a=u4(t)).c(),a.m(e,null))},i(t){o||(o9(n.$$.fragment,t),o=!0)},o(t){at(n.$$.fragment,t),o=!1},d(t){t&&oA(e),ah(n),a&&a.d()}}}function u3(t){let e;return{c(){e=oI()},m(t,n){oS(t,e,n)},p:oi,i:oi,o:oi,d(t){t&&oA(e)}}}function u6(t){let e,n,r;let o=t[13]&&uJ(t),a=t[12]&&u1(t);return{c(){e=oE("div"),o&&o.c(),n=oI(),a&&a.c(),oL(e,"slot","details"),oL(e,"class","DokaColorPickerPanel")},m(t,l){oS(t,e,l),o&&o.m(e,null),oM(e,n),a&&a.m(e,null),r=!0},p(t,r){t[13]?o?(o.p(t,r),8192&r[0]&&o9(o,1)):((o=uJ(t)).c(),o9(o,1),o.m(e,n)):o&&(o8(),at(o,1,1,()=>{o=null}),o7()),t[12]?a?(a.p(t,r),4096&r[0]&&o9(a,1)):((a=u1(t)).c(),o9(a,1),a.m(e,null)):a&&(o8(),at(a,1,1,()=>{a=null}),o7())},i(t){r||(o9(o),o9(a),r=!0)},o(t){at(o),at(a),r=!1},d(t){t&&oA(e),o&&o.d(),a&&a.d()}}}function u8(t){let e;return{c(){e=oI()},m(t,n){oS(t,e,n)},p:oi,i:oi,o:oi,d(t){t&&oA(e)}}}function u7(t){let e,n;return e=new c2({props:{buttonClass:st(["DokaColorPickerButton",t[5]]),$$slots:{default:[u8],details:[u6],label:[uQ]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};32&n[0]&&(r.buttonClass=st(["DokaColorPickerButton",t[5]])),8388575&n[0]|16384&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function u9(t,e,n){let r,o,a,l,s,c,u,d,h,p,f,g,m,$,y,{label:x}=e,{name:b}=e,{options:v=[]}=e,{selectedIndex:w=-1}=e,{value:k}=e,{buttonClass:C}=e,{optionLabelClass:M}=e,{optionMapper:S}=e,{onchange:A}=e,{title:E}=e,{hidePresetLabel:T=!0}=e,{locale:R}=e,{enableOpacity:I=!0}=e,{enablePresets:P=!0}=e,{enablePicker:D=!0}=e,L=(t,e)=>{if(s=[t[0],t[1],t[2]],e){let e=uH(...s);n(14,r=e[0]),n(32,o=e[1]),n(33,a=e[2]),n(15,l=nY(t[3])?t[3]:1)}n(16,c=il(t)),n(17,u=il([...s,0])),n(18,d=il([...s,1])),n(19,h=il(uY(r,1,1)))};k&&L(k,!0);let F=()=>{let t=uY(r,o,a),e=[...t,l];L(e),A(e)},B=t=>{let e=3===t.length?[...t,1]:t;L(e,!0),A(e)},O=(t,e)=>{n(32,o=t),n(33,a=e),0===l&&n(15,l=1),F()},j=(t,e)=>{let n=a_(t.x/e.width,0,1),r=a_(t.y/e.height,0,1);O(n,1-r)},_=t=>{let e=t8(tG(t),m);j(t6(tq(g),e),f)},z=t=>{f=void 0,document.documentElement.removeEventListener("pointermove",_),document.documentElement.removeEventListener("pointerup",z)};return t.$$set=t=>{"label"in t&&n(0,x=t.label),"name"in t&&n(1,b=t.name),"options"in t&&n(2,v=t.options),"selectedIndex"in t&&n(3,w=t.selectedIndex),"value"in t&&n(4,k=t.value),"buttonClass"in t&&n(5,C=t.buttonClass),"optionLabelClass"in t&&n(6,M=t.optionLabelClass),"optionMapper"in t&&n(7,S=t.optionMapper),"onchange"in t&&n(28,A=t.onchange),"title"in t&&n(8,E=t.title),"hidePresetLabel"in t&&n(9,T=t.hidePresetLabel),"locale"in t&&n(10,R=t.locale),"enableOpacity"in t&&n(11,I=t.enableOpacity),"enablePresets"in t&&n(12,P=t.enablePresets),"enablePicker"in t&&n(13,D=t.enablePicker)},t.$$.update=()=>{2&t.$$.dirty[1]&&n(21,$=100*o),4&t.$$.dirty[1]&&n(22,y=100-100*a)},[x,b,v,w,k,C,M,S,E,T,R,I,P,D,r,l,c,u,d,h,p,$,y,B,t=>{n(14,r=t),0===l&&n(15,l=1),F()},t=>{n(15,l=t),F()},t=>{t.stopPropagation(),f=eu(p.offsetWidth,p.offsetHeight),g=tK(t),m=tG(t),j(g,f),document.documentElement.addEventListener("pointermove",_),document.documentElement.addEventListener("pointerup",z)},t=>{f=eu(p.offsetWidth,p.offsetHeight);let e=$/100*f.width,n=y/100*f.height;j({x:e+t.detail.x,y:n+t.detail.y},f)},A,function(t){oK[t?"unshift":"push"](()=>{n(20,p=t)})},t=>{let[e,n]=t;return[e,nJ(n)?n(R):n]},t=>B(t.value)]}class dt extends af{constructor(t){super(),ap(this,t,u9,u7,ou,{label:0,name:1,options:2,selectedIndex:3,value:4,buttonClass:5,optionLabelClass:6,optionMapper:7,onchange:28,title:8,hidePresetLabel:9,locale:10,enableOpacity:11,enablePresets:12,enablePicker:13},[-1,-1])}}var de=t=>t.charAt(0).toUpperCase()+t.slice(1);let dn=(t,e)=>n=>n[e?"".concat(e).concat(de(t)):t],di=(t,e)=>n=>[t[n],dn(n,e)],dr=[1,.2549,.2118],da=[1,1,1,0],dl={path:()=>({points:[],disableErase:!1}),line:()=>({x1:0,y1:0,x2:0,y2:0,disableErase:!1}),rectangle:()=>({x:0,y:0,width:0,height:0}),ellipse:()=>({x:0,y:0,rx:0,ry:0}),text:()=>({x:0,y:0,text:"Text"})},ds=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{position:"relative"};if(!dl[t])return;let r={...dl[t](),...e};return[r,n]},dc=t=>({sharpie:ds("path",{strokeWidth:"0.5%",strokeColor:[...dr]}),line:ds("line",{strokeColor:[...dr],strokeWidth:"0.5%"}),arrow:ds("line",{lineEnd:"arrow-solid",strokeColor:[...dr],strokeWidth:"0.5%"}),rectangle:ds("rectangle",{strokeColor:[...da],backgroundColor:[...dr]}),ellipse:ds("ellipse",{strokeColor:[...da],backgroundColor:[...dr]}),text:ds("text",{color:[...dr],fontSize:"2%"}),...t}),du=(t,e,n)=>[t,e||dn(t,"shapeLabelTool"),{icon:dn(t,"shapeIconTool"),...n}],dd=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["sharpie","eraser","line","arrow","rectangle","ellipse","text","preset"];return t.map(t=>ne(t)?du(t):Array.isArray(t)?nq(t[1])?du(t[0],void 0,t[1]):du(t[0],t[1],t[2]):void 0).filter(Boolean)},dh=()=>({transparent:[1,1,1,0],white:[1,1,1],silver:[.8667,.8667,.8667],gray:[.6667,.6667,.6667],black:[0,0,0],navy:[0,.1216,.2471],blue:[0,.4549,.851],aqua:[.498,.8588,1],teal:[.2235,.8,.8],olive:[.2392,.6,.4392],green:[.1804,.8,.251],yellow:[1,.8627,0],orange:[1,.5216,.1059],red:[1,.2549,.2118],maroon:[.5216,.0784,.2941],fuchsia:[.9412,.0706,.7451],purple:[.6941,.051,.7882]}),dp=()=>({extraSmall:"2%",small:"4%",mediumSmall:"8%",medium:"10%",mediumLarge:"15%",large:"20%",extraLarge:"25%"}),df=()=>({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}),dg=()=>["bar","arrow","arrowSolid","circle","circleSolid","square","squareSolid"],dm=()=>[["Helvetica, Arial, Verdana, 'Droid Sans', sans-serif","Sans Serif"],["'Arial Black', 'Avenir-Black', 'Arial Bold'","Black"],["'Arial Narrow', 'Futura-CondensedMedium'","Narrow"],["'Trebuchet MS'","Humanist"],["Georgia, 'Avenir-Black', 'Times New Roman', 'Droid Serif', serif","Serif"],["Palatino","Old-Style"],["'Times New Roman', 'TimesNewRomanPSMT'","Transitional"],["Menlo, Monaco, 'Lucida Console', monospace","Monospaced"],["'Courier New', monospace","Slab Serif"]],d$=()=>["left","center","right"],dy=()=>[["normal","bold"],["italic","normal"],["italic","bold"]],dx=t=>Object.keys(t).map(di(t,"shapeTitleColor")),db=t=>Object.keys(t).map(di(t,"labelSize")),dv=t=>Object.keys(t).map(di(t,"labelSize")),dw=t=>[...t],dk=t=>t.map(t=>[t,e=>e["shapeLabelFontStyle".concat(t.filter(t=>"normal"!==t).map(de).join(""))]]),dC=t=>t.map(t=>[ct(t),e=>e["shapeTitleLineDecoration".concat(de(t))],{icon:e=>e["shapeIconLineDecoration".concat(de(t))]}]),dM=t=>t.map(t=>[t,e=>e["shapeTitleTextAlign".concat(de(t))],{hideLabel:!0,icon:e=>e["shapeIconTextAlign".concat(de(t))]}]),dS=(t,e)=>{let{defaultKey:n,defaultOptions:r}=e||{},o=[];return n&&(o[0]=[void 0,t=>t[n],{...r}]),[...o,...t]},dA=t=>[uU,{title:t=>t.shapeTitleFontFamily,optionLabelStyle:t=>"font-family: ".concat(t),options:dS(t,{defaultKey:"labelDefault"}),optionFilter:t=>{if(!tn())return!0;let[e]=t;return!e||e.split(",").map(t=>t.trim()).some(t=>document.fonts.check("16px ".concat(t)))}}],dE=t=>[dt,{title:t=>t.shapeTitleBackgroundColor,options:dS(t)}],dT=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[dt,{title:t=>t.shapeTitleStrokeColor,options:dS(t),buttonClass:"DokaColorPickerButtonStroke",onchange:(t,n)=>{let r=n.strokeWidth;(nY(r)||ne(r)?parseFloat(r):0)>0||(n.strokeWidth=e&&e.defaultStrokeWidth||"0.5%")}}]},dR=t=>[uU,{title:t=>t.shapeTitleStrokeWidth,options:e=>nK(e,"backgroundColor")?dS(t,{defaultKey:"shapeLabelStrokeNone"}):dS(t)}],dI=(t,e,n)=>[uU,{title:t=>t[e],options:dS(t,{defaultKey:"labelNone",defaultOptions:{icon:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H14"/></g>'}}),optionIconStyle:n}],dP=t=>dI(t,"shapeTitleLineStart","transform: scaleX(-1)"),dD=t=>dI(t,"shapeTitleLineEnd"),dL=t=>[dt,{title:t=>t.shapeTitleTextColor,options:dS(t)}],dF=t=>[uU,{title:t=>t.shapeTitleFontStyle,optionLabelStyle:t=>t&&"font-style:".concat(t[0],";font-weight:").concat(t[1]),options:dS(t,{defaultKey:"shapeLabelFontStyleNormal"})}],dB=t=>[uU,{title:t=>t.shapeTitleFontSize,options:dS(t,{defaultKey:"labelDefault"})}],dO=t=>[uA,{title:t=>t.shapeTitleTextAlign,options:dS(t)}],dj=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{colorOptions:e=dx(dh()),strokeWidthOptions:n=dv(df()),lineEndStyleOptions:r=dC(dg()),fontFamilyOptions:o=dw(dm()),fontStyleOptions:a=dk(dy()),fontSizeOptions:l=db(dp()),textAlignOptions:s=dM(d$())}=t;return{backgroundColor:e&&dE(e),strokeColor:e&&dT(e),strokeWidth:n&&dR(n),lineStart:r&&dP(r),lineEnd:r&&dD(r),color:e&&dL(e),fontFamily:o&&dA(o),fontStyle_fontWeight:a&&dF(a),fontSize:l&&dB(l),textAlign:s&&dO(s)}};function d_(t){let e,n,r,o;let a=t[3].default,l=of(a,t,t[2],null);return{c(){e=oE("div"),l&&l.c(),oL(e,"class",t[0])},m(a,s){oS(a,e,s),l&&l.m(e,null),n=!0,r||(o=[oD(e,"measure",t[1]),ox(lv.call(null,e))],r=!0)},p(t,r){let[o]=r;l&&l.p&&4&o&&om(l,a,t,t[2],o,null,null),(!n||1&o)&&oL(e,"class",t[0])},i(t){n||(o9(l,t),n=!0)},o(t){at(l,t),n=!1},d(t){t&&oA(e),l&&l.d(t),r=!1,os(o)}}}function dz(t,e,n){let{$$slots:r={},$$scope:o}=e,a=oX(),{class:l=null}=e;return t.$$set=t=>{"class"in t&&n(0,l=t.class),"$$scope"in t&&n(2,o=t.$$scope)},[l,t=>{let{detail:e}=t;return a("measure",e)},o,r]}class dN extends af{constructor(t){super(),ap(this,t,dz,d_,ou,{class:0})}}let dU=t=>({}),dW=t=>({}),dX=t=>({}),dV=t=>({}),dH=t=>({}),dY=t=>({});function dG(t){let e,n;let r=t[4].header,o=of(r,t,t[3],dY);return{c(){e=oE("div"),o&&o.c(),oL(e,"class","DokaUtilHeader")},m(t,r){oS(t,e,r),o&&o.m(e,null),n=!0},p(t,e){o&&o.p&&8&e&&om(o,r,t,t[3],e,dH,dY)},i(t){n||(o9(o,t),n=!0)},o(t){at(o,t),n=!1},d(t){t&&oA(e),o&&o.d(t)}}}function dK(t){let e,n;let r=t[4].footer,o=of(r,t,t[3],dW);return{c(){e=oE("div"),o&&o.c(),oL(e,"class","DokaUtilFooter")},m(t,r){oS(t,e,r),o&&o.m(e,null),n=!0},p(t,e){o&&o.p&&8&e&&om(o,r,t,t[3],e,dU,dW)},i(t){n||(o9(o,t),n=!0)},o(t){at(o,t),n=!1},d(t){t&&oA(e),o&&o.d(t)}}}function dq(t){let e,n,r,o,a,l,s,c;let u=t[1]&&dG(t),d=t[4].main,h=of(d,t,t[3],dV),p=h||((s=new dN({props:{class:"DokaStage"}})).$on("measure",t[5]),{c(){au(s.$$.fragment)},m(t,e){ad(s,t,e),c=!0},p:oi,i(t){c||(o9(s.$$.fragment,t),c=!0)},o(t){at(s.$$.fragment,t),c=!1},d(t){ah(s,t)}}),f=t[2]&&dK(t);return{c(){u&&u.c(),e=oI(),n=oE("div"),p&&p.c(),r=oI(),f&&f.c(),o=oI(),a=oP(),oL(n,"class","DokaUtilMain")},m(s,c){u&&u.m(s,c),oS(s,e,c),oS(s,n,c),p&&p.m(n,null),t[6](n),oS(s,r,c),f&&f.m(s,c),oS(s,o,c),oS(s,a,c),l=!0},p(t,n){let[r]=n;t[1]?u?(u.p(t,r),2&r&&o9(u,1)):((u=dG(t)).c(),o9(u,1),u.m(e.parentNode,e)):u&&(o8(),at(u,1,1,()=>{u=null}),o7()),h&&h.p&&8&r&&om(h,d,t,t[3],r,dX,dV),t[2]?f?(f.p(t,r),4&r&&o9(f,1)):((f=dK(t)).c(),o9(f,1),f.m(o.parentNode,o)):f&&(o8(),at(f,1,1,()=>{f=null}),o7())},i(t){l||(o9(u),o9(p,t),o9(f),o9(!1),l=!0)},o(t){at(u),at(p,t),at(f),at(!1),l=!1},d(l){u&&u.d(l),l&&oA(e),l&&oA(n),p&&p.d(l),t[6](null),l&&oA(r),f&&f.d(l),l&&oA(o),l&&oA(a)}}}function dZ(t,e,n){let{$$slots:r={},$$scope:o}=e,{hasHeader:a=!!e.$$slots.header}=e,{hasFooter:l=!!e.$$slots.footer}=e,{root:s}=e;return t.$$set=t=>{n(7,e=oo(oo({},e),o$(t))),"hasHeader"in t&&n(1,a=t.hasHeader),"hasFooter"in t&&n(2,l=t.hasFooter),"root"in t&&n(0,s=t.root),"$$scope"in t&&n(3,o=t.$$scope)},e=o$(e),[s,a,l,o,r,function(e){oY(t,e)},function(t){oK[t?"unshift":"push"](()=>{n(0,s=t)})}]}class dQ extends af{constructor(t){super(),ap(this,t,dZ,dq,ou,{hasHeader:1,hasFooter:2,root:0})}}var dJ=(t,e,n)=>(t-e)/(n-e);function d0(t){let e,n;return{c(){oL(e=oE("div"),"class","DokaRangeInputMeter"),oL(e,"style",n="transform: translateX(".concat(t[9].x-t[10].x,"px) translateY(").concat(t[9].y-t[10].y,"px)"))},m(n,r){oS(n,e,r),e.innerHTML=t[6]},p(t,r){64&r[0]&&(e.innerHTML=t[6]),512&r[0]&&n!==(n="transform: translateX(".concat(t[9].x-t[10].x,"px) translateY(").concat(t[9].y-t[10].y,"px)"))&&oL(e,"style",n)},d(t){t&&oA(e)}}}function d1(t){let e,n,r,o,a,l,s,c,u,d,h,p;let f=t[9]&&d0(t);return{c(){e=oE("div"),n=oE("span"),r=oR(t[4]),o=oI(),a=oE("button"),l=oR(t[1]),c=oI(),u=oE("div"),f&&f.c(),oL(n,"class","DokaRangeInputValue"),oL(a,"class","DokaRangeInputReset"),oL(a,"type","button"),a.disabled=s=t[0]===t[3],oL(u,"class","DokaRangeInputInner"),oL(u,"style",t[8]),oL(u,"data-value-limited",t[7]),oL(e,"class","DokaRangeInput"),oL(e,"tabindex","0")},m(s,g){oS(s,e,g),oM(e,n),oM(n,r),oM(e,o),oM(e,a),oM(a,l),oM(e,c),oM(e,u),f&&f.m(u,null),h||(p=[oD(a,"click",t[15]),oD(u,"interactionstart",t[11]),oD(u,"interactionupdate",t[13]),oD(u,"interactionend",t[14]),oD(u,"interactionrelease",t[12]),ox(sI.call(null,u,{inertia:!0})),oD(u,"measure",t[27]),ox(lv.call(null,u)),oD(e,"wheel",t[17]),oD(e,"nudge",t[18]),ox(d=sP.call(null,e,t[2]="horizontal"))],h=!0)},p(t,e){16&e[0]&&oB(r,t[4]),2&e[0]&&oB(l,t[1]),9&e[0]&&s!==(s=t[0]===t[3])&&(a.disabled=s),t[9]?f?f.p(t,e):((f=d0(t)).c(),f.m(u,null)):f&&(f.d(1),f=null),256&e[0]&&oL(u,"style",t[8]),128&e[0]&&oL(u,"data-value-limited",t[7]),d&&oc(d.update)&&4&e[0]&&d.update.call(null,t[2]="horizontal")},i:oi,o:oi,d(t){t&&oA(e),f&&f.d(),h=!1,os(p)}}}function d2(t,e,n){let r,o,a,l,s,c,u,d,h,p,f,g,m;let{labelReset:$="Reset"}=e,{direction:y="x"}=e,{min:x=0}=e,{max:b=1}=e,{base:v=x}=e,{value:w=0}=e,{valueLabel:k=0}=e,{valueMin:C}=e,{valueMax:M}=e,{oninputstart:S=J}=e,{oninputmove:A=J}=e,{oninputend:E=J}=e,{elasticity:T=0}=e,R=(t,e,n)=>Math.ceil((t-n)/e)*e+n,I={x:2,y:0},P=!1,D={snap:!1,elastic:!1},L=(t,e,n)=>{let r=t[y]+e[y],o=a_(r,s[1][y],s[0][y]),a=T?o+sD(r-o,T):o,l=n.elastic?a:o,c=tH(0,0);return c[y]=l,F.set(c,{hard:n.snap}),a_(O(c,y),x,b)},F=lu();op(t,F,t=>n(9,r=t));let B=(t,e)=>{let n=(o[e]-h[e])*.5,r=dJ(t,x,b),a=r*h[e]-.5*h[e],l=n-a;return{x:"x"===e?l:0,y:"y"===e?l:0}},O=(t,e)=>{let n=t[e]-.5*o[e],r=-(n/h[e]);return x+r*c};F.subscribe(t=>{t&&m&&A(a_(O(t,y),x,b))});let j=t=>{let e=[B(null!=C?C:x,y),B(null!=M?M:b,y)],n=a_({x:"x"===y?r.x+t:0,y:"y"===y?r.y+t:0}[y],e[1][y],e[0][y]),o={...r,[y]:n};oy(F,r=o,r);let a=a_(O(o,y),x,b);S(),A(a),E(a)};return t.$$set=t=>{"labelReset"in t&&n(1,$=t.labelReset),"direction"in t&&n(2,y=t.direction),"min"in t&&n(19,x=t.min),"max"in t&&n(20,b=t.max),"base"in t&&n(3,v=t.base),"value"in t&&n(0,w=t.value),"valueLabel"in t&&n(4,k=t.valueLabel),"valueMin"in t&&n(21,C=t.valueMin),"valueMax"in t&&n(22,M=t.valueMax),"oninputstart"in t&&n(23,S=t.oninputstart),"oninputmove"in t&&n(24,A=t.oninputmove),"oninputend"in t&&n(25,E=t.oninputend),"elasticity"in t&&n(26,T=t.elasticity)},t.$$.update=()=>{if(1572864&t.$$.dirty[0]&&n(33,c=b-x),2621440&t.$$.dirty[0]&&n(34,u=null!=C?Math.max(C,x):x),5242880&t.$$.dirty[0]&&n(35,d=null!=M?Math.min(M,b):b),1572872&t.$$.dirty[0]&&n(37,p=dJ(v,x,b)),32&t.$$.dirty[0]|64&t.$$.dirty[1]&&o){let t;let e=.5*o.y,r=40*p,s="",c=o.y;for(let n=0;n<=40;n++){let o=I.x+10*n,a=n%5==0?2:.75;s+='<circle cx="'.concat(o,'" cy="').concat(e,'" r="').concat(a,'"/>'),t=o+I.x,n===r&&(s+='<path stroke="none" fill="currentColor" d="M'.concat(o," ").concat(e-4,' l2 3 l-2 -1 l-2 1 z"/>'))}n(6,a='<svg width="'.concat(t,'" height="').concat(c,'" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ').concat(t," ").concat(c,'" aria-hidden="true" focusable="false">').concat(s,'<rect rx="4" ry="4" y="').concat(e-4,'"" height="8"></rect></svg>')),n(28,l={x:t-2*I.x,y:c})}268435488&t.$$.dirty[0]&&(h=o&&l),1572864&t.$$.dirty[0]|24&t.$$.dirty[1]&&n(7,f=u!==x||d!==b),128&t.$$.dirty[0]|24&t.$$.dirty[1]&&n(8,g=f?function(t,e){let n=dJ(t,x,b),r=dJ(e,x,b),o=aI(R(n,.025,0)-.0125),a=aI(R(r,.025,0)-.0125);return"--range-mask-from:".concat(100*o,"%;--range-mask-to:").concat(100*a,"%")}(u,d):""),37&t.$$.dirty[0]|4&t.$$.dirty[1]&&c&&o&&o.x&&o.y&&F.set(B(w,y))},[w,$,y,v,k,o,a,f,g,r,I,()=>{P=!1,m=oh(F),s=[B(null!=C?C:x,y),B(null!=M?M:b,y)],S()},()=>{P=!0},t=>{let{detail:e}=t;D.snap=!P,D.elastic=!P,L(m,e.translation,D)},t=>{let{detail:e}=t;D.snap=!1,D.elastic=!1;let n=L(m,e.translation,D);if(m=void 0,s=void 0,.01>Math.abs(n-v))return E(v);E(n)},()=>{n(0,w=a_(v,u,d)),S(),E(w)},F,t=>{t.preventDefault(),t.stopPropagation();let e=8*sB(t);j(e)},t=>{let{detail:e}=t;j(8*e[y])},x,b,C,M,S,A,E,T,t=>n(5,o=tY(t.detail))]}class d4 extends af{constructor(t){super(),ap(this,t,d2,d1,ou,{labelReset:1,direction:2,min:19,max:20,base:3,value:0,valueLabel:4,valueMin:21,valueMax:22,oninputstart:23,oninputmove:24,oninputend:25,elasticity:26},[-1,-1])}}function d5(t){let e,n,r,o,a;let l=t[5].default,s=of(l,t,t[4],null);return{c(){e=oE("div"),n=oE("div"),s&&s.c(),oL(n,"class","DokaToolbarInner"),oL(e,"class","DokaToolbar"),oL(e,"data-layout",t[1]),oL(e,"data-overflow",t[0])},m(l,c){oS(l,e,c),oM(e,n),s&&s.m(n,null),r=!0,o||(a=[oD(n,"measure",t[3]),ox(lv.call(null,n)),oD(e,"measure",t[2]),ox(lv.call(null,e))],o=!0)},p(t,n){let[o]=n;s&&s.p&&16&o&&om(s,l,t,t[4],o,null,null),(!r||2&o)&&oL(e,"data-layout",t[1]),(!r||1&o)&&oL(e,"data-overflow",t[0])},i(t){r||(o9(s,t),r=!0)},o(t){at(s,t),r=!1},d(t){t&&oA(e),s&&s.d(t),o=!1,os(a)}}}function d3(t,e,n){let r,o,{$$slots:a={},$$scope:l}=e,s=0,c=0,u=0,d=()=>{n(0,r="compact"===o&&s>u?"overflow":void 0)};return t.$$set=t=>{"$$scope"in t&&n(4,l=t.$$scope)},t.$$.update=()=>{384&t.$$.dirty&&n(1,o=c>u?"compact":"default")},[r,o,t=>{let{detail:e}=t,{width:r,height:o}=e;n(8,u=r),d()},t=>{let{detail:e}=t,{width:o,height:a}=e;o>c&&n(7,c=o),s=o,r||d()},l,a]}class d6 extends af{constructor(t){super(),ap(this,t,d3,d5,ou,{})}}let d8={Top:"t",Right:"r",Bottom:"b",Left:"l",TopLeft:"tl",TopRight:"tr",BottomRight:"br",BottomLeft:"bl"},{Top:d7,Right:d9,Bottom:ht,Left:he,TopLeft:hn,TopRight:hi,BottomRight:hr,BottomLeft:ho}=d8;var ha={[d7]:t=>({x:t.x,y:t.y}),[hi]:t=>({x:t.x+t.width,y:t.y}),[d9]:t=>({x:t.x+t.width,y:t.y}),[hr]:t=>({x:t.x+t.width,y:t.y+t.height}),[ht]:t=>({x:t.x,y:t.y+t.height}),[ho]:t=>({x:t.x,y:t.y+t.height}),[he]:t=>({x:t.x,y:t.y}),[hn]:t=>({x:t.x,y:t.y})};function hl(t,e,n){let r=t.slice();return r[11]=e[n].key,r[12]=e[n].translate,r[13]=e[n].scale,r[14]=e[n].type,r[15]=e[n].opacity,r}function hs(t,e){let n,r,o,a,l,s,c;return{key:t,first:null,c(){oL(n=oE("div"),"role","button"),oL(n,"tabindex",r="edge"===e[14]?-1:0),oL(n,"class","DokaRectManipulator"),oL(n,"data-direction",o=e[11]),oL(n,"data-shape",a="".concat("edge"===e[14]?"edge":"".concat(e[0]))),oL(n,"style",l="transform: translate3d(".concat(e[12].x,"px, ").concat(e[12].y,"px, 0) scale(").concat(e[13].x,", ").concat(e[13].y,"); opacity: ").concat(e[15])),this.first=n},m(t,r){oS(t,n,r),s||(c=[oD(n,"nudge",function(){oc(e[5](e[11]))&&e[5](e[11]).apply(this,arguments)}),ox(sP.call(null,n)),oD(n,"interactionstart",function(){oc(e[4]("resizestart",e[11]))&&e[4]("resizestart",e[11]).apply(this,arguments)}),oD(n,"interactionupdate",function(){oc(e[4]("resizemove",e[11]))&&e[4]("resizemove",e[11]).apply(this,arguments)}),oD(n,"interactionend",function(){oc(e[4]("resizeend",e[11]))&&e[4]("resizeend",e[11]).apply(this,arguments)}),ox(sI.call(null,n))],s=!0)},p(t,s){e=t,2&s&&r!==(r="edge"===e[14]?-1:0)&&oL(n,"tabindex",r),2&s&&o!==(o=e[11])&&oL(n,"data-direction",o),3&s&&a!==(a="".concat("edge"===e[14]?"edge":"".concat(e[0])))&&oL(n,"data-shape",a),2&s&&l!==(l="transform: translate3d(".concat(e[12].x,"px, ").concat(e[12].y,"px, 0) scale(").concat(e[13].x,", ").concat(e[13].y,"); opacity: ").concat(e[15]))&&oL(n,"style",l)},d(t){t&&oA(n),s=!1,os(c)}}}function hc(t){let e,n=[],r=new Map,o=t[1],a=t=>t[11];for(let e=0;e<o.length;e+=1){let l=hl(t,o,e),s=a(l);r.set(s,n[e]=hs(s,l))}return{c(){for(let t=0;t<n.length;t+=1)n[t].c();e=oP()},m(t,r){for(let e=0;e<n.length;e+=1)n[e].m(t,r);oS(t,e,r)},p(t,o){let[l]=o;if(51&l){let o=t[1];n=aa(n,l,a,1,t,o,r,e.parentNode,ar,hs,e,hl)}},i:oi,o:oi,d(t){for(let e=0;e<n.length;e+=1)n[e].d(t);t&&oA(e)}}}function hu(t,e,n){let r,o,a;let{rect:l=null}=e,{visible:s=!1}=e,{style:c}=e,u=lu(void 0,{precision:1e-4,stiffness:.2,damping:.4});op(t,u,t=>n(8,r=t));let d=lu(0,{precision:.001});op(t,d,t=>n(9,o=t));let h=oX();return t.$$set=t=>{"rect"in t&&n(6,l=t.rect),"visible"in t&&n(7,s=t.visible),"style"in t&&n(0,c=t.style)},t.$$.update=()=>{128&t.$$.dirty&&u.set(s?1:.5),128&t.$$.dirty&&d.set(s?1:0),832&t.$$.dirty&&n(1,a=Object.keys(d8).map((t,e)=>{let n=d8[t],a=ha[n](l),s=1===n.length?"edge":"corner",c="corner"===s;return{key:n,type:s,scale:{x:/^(t|b)$/.test(n)?l.width:c?a_(r,.5,1.25):1,y:/^(r|l)$/.test(n)?l.height:c?a_(r,.5,1.25):1},translate:{x:a.x,y:a.y},opacity:o}}))},[c,a,u,d,(t,e)=>n=>{let{detail:r}=n;return h(t,{direction:e,translation:r&&r.translation})},t=>e=>{let{detail:n}=e;h("resizestart",{direction:t,translation:{x:0,y:0}}),h("resizemove",{direction:t,translation:n}),h("resizeend",{direction:t,translation:{x:0,y:0}})},l,s]}class hd extends af{constructor(t){super(),ap(this,t,hu,hc,ou,{rect:6,visible:7,style:0})}}var hh=t=>tH(t.clientX,t.clientY),hp=(t,e,n)=>{let r=hh(t);return t8(t8(r,e),n)},hf={[d7]:ht,[d9]:he,[ht]:d7,[he]:d9,[hn]:hr,[hi]:ho,[hr]:hn,[ho]:hi},hg={[d7]:[.5,0],[d9]:[1,.5],[ht]:[.5,1],[he]:[0,.5],[hn]:[0,0],[hi]:[1,0],[hr]:[1,1],[ho]:[0,1]},hm=t=>{let e=t===he||t===d9,n=t===d7||t===ht;return[t===d9||t===hi||t===hr,t===he||t===ho||t===hn,t===d7||t===hi||t===hn,t===ht||t===hr||t===ho,e,n,e||n]},h$=function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{target:o,translate:a}=e,{aspectRatio:l,minSize:s,maxSize:c}=r,u=hf[o],d=hg[u],h=t6(tH(t.x,t.y),tH(d[0]*t.width,d[1]*t.height)),p=hg[o],f=t6(eS(t),tH(p[0]*t.width,p[1]*t.height)),[g,m,$,y,x,b,v]=hm(o),w=a.x,k=a.y;x?k=0:b&&(w=0);let C=hy(h,o,n,{aspectRatio:l,minSize:s,maxSize:c}),[M,S,A,E]=eZ(t);if(g?E=h.x:m&&(S=h.x),y?M=h.y:$&&(A=h.y),g){let t=C.inner.x+C.inner.width,e=C.outer.x+C.outer.width;S=a_(f.x+w,t,e)}else if(m){let t=C.outer.x,e=C.inner.x;E=a_(f.x+w,t,e)}if(y){let t=C.inner.y+C.inner.height,e=C.outer.y+C.outer.height;A=a_(f.y+k,t,e)}else if($){let t=C.outer.y,e=C.inner.y;M=a_(f.y+k,t,e)}if(l){if(v){let t=S-E,e=A-M;x?(e=t/l,M=h.y-.5*e,A=h.y+.5*e):b&&(t=e*l,E=h.x-.5*t,S=h.x+.5*t)}else{let t=tH(f.x+w-h.x,f.y+k-h.y);o===hi?(t.x=Math.max(0,t.x),t.y=Math.min(0,t.y)):o===hr?(t.x=Math.max(0,t.x),t.y=Math.max(0,t.y)):o===ho?(t.x=Math.min(0,t.x),t.y=Math.max(0,t.y)):o===hn&&(t.x=Math.min(0,t.x),t.y=Math.min(0,t.y));let e=t0(t),n=t0(tH(C.inner.width,C.inner.height)),r=t0(tH(C.outer.width,C.outer.height)),a=a_(e,n,r),s=tH(l,1),c=t7(t1(s),a);o===hi?(S=h.x+c.x,M=h.y-c.y):o===hr?(S=h.x+c.x,A=h.y+c.y):o===ho?(E=h.x-c.x,A=h.y+c.y):o===hn&&(E=h.x-c.x,M=h.y-c.y)}}return eL(E,M,S-E,A-M)};let hy=(t,e,n,r)=>{let o,a,l,s;let{aspectRatio:c,minSize:u,maxSize:d}=r,h=e===d9||e===hi||e===hr,p=e===he||e===ho||e===hn,f=e===d7||e===hi||e===hn,g=e===ht||e===hr||e===ho,m=e===he||e===d9,$=e===d7||e===ht,y=eS(n);h?(y.x=t.x,y.width-=t.x):p&&(y.width=t.x),g?(y.y=t.y,y.height-=t.y):f&&(y.height=t.y);let x=eE(Math.min(y.width,d.width),Math.min(y.height,d.height));if(c){if(m){let e=Math.min(t.y,n.height-t.y);x.height=Math.min(2*e,x.height)}else if($){let e=Math.min(t.x,n.width-t.x);x.width=Math.min(2*e,x.width)}}let b=c?es(eq(x,c)):x,v=c?es(eK(eT(u),c)):u;h?o=t.x:p&&(a=t.x),g?l=t.y:f&&(s=t.y),h?a=o+v.width:p&&(o=a-v.width),g?s=l+v.height:f&&(l=s-v.height),m?(l=t.y-.5*v.height,s=t.y+.5*v.height):$&&(o=t.x-.5*v.width,a=t.x+.5*v.width);let w=eI(tH(o,l),tH(a,s));h?a=o+b.width:p&&(o=a-b.width),g?s=l+b.height:f&&(l=s-b.height),m?(l=t.y-.5*b.height,s=t.y+.5*b.height):$&&(o=t.x-.5*b.width,a=t.x+.5*b.width);let k=eI(tH(o,l),tH(a,s));return{inner:w,outer:k}};var hx=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{target:r,translate:o}=e,{aspectRatio:a}=n,l=hf[r],s=hg[l],c=t6(eS(t),tH(s[0]*t.width,s[1]*t.height)),u=hg[r],d=t6(eS(t),tH(u[0]*t.width,u[1]*t.height)),[h,p,f,g,m,$,y]=hm(r),x=o.x,b=o.y;m?b=0:$&&(x=0);let[v,w,k,C]=eZ(t);if(h?C=c.x:p&&(w=c.x),g?v=c.y:f&&(k=c.y),h?w=d.x+x:p&&(C=d.x+x),g?k=d.y+b:f&&(v=d.y+b),a){if(y){let t=w-C,e=k-v;m?(e=t/a,v=c.y-.5*e,k=c.y+.5*e):$&&(t=e*a,C=c.x-.5*t,w=c.x+.5*t)}else{let t=tH(d.x+x-c.x,d.y+b-c.y);r===hi?(t.x=Math.max(0,t.x),t.y=Math.min(0,t.y)):r===hr?(t.x=Math.max(0,t.x),t.y=Math.max(0,t.y)):r===ho?(t.x=Math.min(0,t.x),t.y=Math.max(0,t.y)):r===hn&&(t.x=Math.min(0,t.x),t.y=Math.min(0,t.y));let e=t0(t),n=tH(a,1),o=t7(t1(n),e);r===hi?(w=c.x+o.x,v=c.y-o.y):r===hr?(w=c.x+o.x,k=c.y+o.y):r===ho?(C=c.x-o.x,k=c.y+o.y):r===hn&&(C=c.x-o.x,v=c.y-o.y)}}return eL(C,v,w-C,k-v)},hb=t=>180*t/Math.PI;function hv(t){let e,n,r;return n=new d4({props:{elasticity:t[5],min:t[7],max:t[8],value:t[12],valueMin:t[0],valueMax:t[1],labelReset:t[6],base:t[9],valueLabel:"".concat(Math.round(hb(t[12])),"\xb0"),oninputstart:t[2],oninputmove:t[14],oninputend:t[15]}}),{c(){e=oE("div"),au(n.$$.fragment),oL(e,"class","DokaImageRotator")},m(t,o){oS(t,e,o),ad(n,e,null),r=!0},p(t,e){let[r]=e,o={};32&r&&(o.elasticity=t[5]),128&r&&(o.min=t[7]),256&r&&(o.max=t[8]),4096&r&&(o.value=t[12]),1&r&&(o.valueMin=t[0]),2&r&&(o.valueMax=t[1]),64&r&&(o.labelReset=t[6]),512&r&&(o.base=t[9]),4096&r&&(o.valueLabel="".concat(Math.round(hb(t[12])),"\xb0")),4&r&&(o.oninputstart=t[2]),3080&r&&(o.oninputmove=t[14]),3088&r&&(o.oninputend=t[15]),n.$set(o)},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n)}}}function hw(t,e,n){let r,o,a,l,s,c;let u=Math.PI/2,d=Math.PI/4,{rotation:h}=e,{valueMin:p}=e,{valueMax:f}=e,{oninputstart:g=J}=e,{oninputmove:m=J}=e,{oninputend:$=J}=e,{elasticity:y=0}=e,{labelReset:x}=e;return t.$$set=t=>{"rotation"in t&&n(13,h=t.rotation),"valueMin"in t&&n(0,p=t.valueMin),"valueMax"in t&&n(1,f=t.valueMax),"oninputstart"in t&&n(2,g=t.oninputstart),"oninputmove"in t&&n(3,m=t.oninputmove),"oninputend"in t&&n(4,$=t.oninputend),"elasticity"in t&&n(5,y=t.elasticity),"labelReset"in t&&n(6,x=t.labelReset)},t.$$.update=()=>{384&t.$$.dirty&&n(9,a=r+(o-r)*.5),8192&t.$$.dirty&&n(10,l=Math.sign(h)),8192&t.$$.dirty&&n(11,s=Math.round(Math.abs(h)/u)*u),11264&t.$$.dirty&&n(12,c=h-l*s)},n(7,r=-d+1e-9),n(8,o=d-1e-9),[p,f,g,m,$,y,x,r,o,a,l,s,c,h,t=>m(l*s+t),t=>$(l*s+t)]}class hk extends af{constructor(t){super(),ap(this,t,hw,hv,ou,{rotation:13,valueMin:0,valueMax:1,oninputstart:2,oninputmove:3,oninputend:4,elasticity:5,labelReset:6})}}function hC(t){let e,n,r,o,a;return{c(){e=oE("div"),n=oE("p"),r=oR(t[0]),o=oR(" \xd7 "),a=oR(t[1]),oL(e,"class","DokaImageInfo")},m(t,l){oS(t,e,l),oM(e,n),oM(n,r),oM(n,o),oM(n,a)},p(t,e){let[n]=e;1&n&&oB(r,t[0]),2&n&&oB(a,t[1])},i:oi,o:oi,d(t){t&&oA(e)}}}function hM(t,e,n){let{width:r}=e,{height:o}=e;return t.$$set=t=>{"width"in t&&n(0,r=t.width),"height"in t&&n(1,o=t.height)},[r,o]}class hS extends af{constructor(t){super(),ap(this,t,hM,hC,ou,{width:0,height:1})}}var hA=function(t){let e,n,r,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{width:l=24,height:s=24,bounds:c=16,radius:u=3}=a,d=n0(t)?tO(t[0],t[1]):t,h=!!d;o=(r=(d=h?d:1)>1?c:d*c)/d,e=Math.round((l-r)*.5),n=Math.round((s-o)*.5);let p=[l/12,l/6].join(" ");return'<rect fill="'.concat(h?"currentColor":"none",'" stroke="').concat(h?"none":"currentColor",'" stroke-width="').concat(l/16,'" stroke-dasharray="').concat(p,'" x="').concat(e,'" y="').concat(n,'" width="').concat(r,'" height="').concat(o,'" rx="').concat(u,'"/>')};function hE(t){let e,n;return e=new s2({props:{items:t[0]}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};1&n[0]&&(r.items=t[0]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function hT(t){let e,n,r;return n=new d6({props:{$$slots:{default:[hE]},$$scope:{ctx:t}}}),{c(){e=oE("div"),au(n.$$.fragment),oL(e,"slot","header")},m(t,o){oS(t,e,o),ad(n,e,null),r=!0},p(t,e){let r={};1&e[0]|16384&e[5]&&(r.$$scope={dirty:e,ctx:t}),n.$set(r)},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n)}}}function hR(t){let e,n;return e=new sA({props:{onclick:t[74],label:t[4].cropLabelButtonRecenter,icon:t[4].cropIconButtonRecenter,class:"DokaButtonCenter",disabled:!t[11],hideLabel:!0,style:"opacity: ".concat(t[24],"; transform: translate3d(").concat(t[25].x,"px, ").concat(t[25].y,"px, 0)")}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};16&n[0]&&(r.label=t[4].cropLabelButtonRecenter),16&n[0]&&(r.icon=t[4].cropIconButtonRecenter),2048&n[0]&&(r.disabled=!t[11]),50331648&n[0]&&(r.style="opacity: ".concat(t[24],"; transform: translate3d(").concat(t[25].x,"px, ").concat(t[25].y,"px, 0)")),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function hI(t){let e,n;return(e=new hd({props:{rect:t[14],visible:t[16],style:t[2]}})).$on("resizestart",t[57]),e.$on("resizemove",t[58]),e.$on("resizeend",t[59]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};16384&n[0]&&(r.rect=t[14]),65536&n[0]&&(r.visible=t[16]),4&n[0]&&(r.style=t[2]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function hP(t){let e,n;return e=new hS({props:{width:Math.round(t[7].width),height:Math.round(t[7].height)}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};128&n[0]&&(r.width=Math.round(t[7].width)),128&n[0]&&(r.height=Math.round(t[7].height)),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function hD(t){let e,n,r,o,a,l,s,c;let u=t[13]&&t[15]&&hR(t),d=t[13]&&hI(t),h=t[12]&&hP(t);return{c(){e=oE("div"),n=oE("div"),u&&u.c(),r=oI(),d&&d.c(),a=oI(),h&&h.c(),oL(n,"class","DokaStage"),oL(e,"slot","main")},m(p,f){oS(p,e,f),oM(e,n),u&&u.m(n,null),oM(n,r),d&&d.m(n,null),oM(e,a),h&&h.m(e,null),l=!0,s||(c=[oD(n,"measure",t[98]),ox(lv.call(null,n)),oD(n,"wheel",function(){oc(t[3]&&t[73])&&(t[3]&&t[73]).apply(this,arguments)}),oD(n,"interactionstart",t[63]),oD(n,"interactionupdate",t[64]),oD(n,"interactionrelease",t[66]),oD(n,"interactionend",t[65]),ox(o=sI.call(null,n,{drag:!0,pinch:t[3],inertia:!0,matchTarget:!0,getEventPosition:t[99]}))],s=!0)},p(a,l){(t=a)[13]&&t[15]?u?(u.p(t,l),40960&l[0]&&o9(u,1)):((u=hR(t)).c(),o9(u,1),u.m(n,r)):u&&(o8(),at(u,1,1,()=>{u=null}),o7()),t[13]?d?(d.p(t,l),8192&l[0]&&o9(d,1)):((d=hI(t)).c(),o9(d,1),d.m(n,null)):d&&(o8(),at(d,1,1,()=>{d=null}),o7()),o&&oc(o.update)&&1032&l[0]&&o.update.call(null,{drag:!0,pinch:t[3],inertia:!0,matchTarget:!0,getEventPosition:t[99]}),t[12]?h?(h.p(t,l),4096&l[0]&&o9(h,1)):((h=hP(t)).c(),o9(h,1),h.m(e,null)):h&&(o8(),at(h,1,1,()=>{h=null}),o7())},i(t){l||(o9(u),o9(d),o9(h),l=!0)},o(t){at(u),at(d),at(h),l=!1},d(t){t&&oA(e),u&&u.d(),d&&d.d(),h&&h.d(),s=!1,os(c)}}}function hL(t){let e,n,r;let o=t[19]&&hF(t),a=[{class:"DokaControlPanels"},{panelClass:"DokaControlPanel"},{panels:t[22]},t[20]],l={$$slots:{default:[h_,t=>{let{panel:e}=t;return{167:e}},t=>{let{panel:e}=t;return[0,0,0,0,0,e?4096:0]}]},$$scope:{ctx:t}};for(let t=0;t<a.length;t+=1)l=oo(l,a[t]);return n=new sf({props:l}),{c(){o&&o.c(),e=oI(),au(n.$$.fragment)},m(t,a){o&&o.m(t,a),oS(t,e,a),ad(n,t,a),r=!0},p(t,r){t[19]?o?(o.p(t,r),524288&r[0]&&o9(o,1)):((o=hF(t)).c(),o9(o,1),o.m(e.parentNode,e)):o&&(o8(),at(o,1,1,()=>{o=null}),o7());let l=5242880&r[0]?al(a,[a[0],a[1],4194304&r[0]&&{panels:t[22]},1048576&r[0]&&as(t[20])]):{};471859984&r[0]|20480&r[5]&&(l.$$scope={dirty:r,ctx:t}),n.$set(l)},i(t){r||(o9(o),o9(n.$$.fragment,t),r=!0)},o(t){at(o),at(n.$$.fragment,t),r=!1},d(t){o&&o.d(t),t&&oA(e),ah(n,t)}}}function hF(t){let e,n;let r=[{class:"DokaControlList"},{tabs:t[21]},t[20]],o={$$slots:{default:[hB,t=>{let{tab:e}=t;return{168:e}},t=>{let{tab:e}=t;return[0,0,0,0,0,e?8192:0]}]},$$scope:{ctx:t}};for(let t=0;t<r.length;t+=1)o=oo(o,r[t]);return(e=new sl({props:o})).$on("select",t[100]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let o=3145728&n[0]?al(r,[r[0],2097152&n[0]&&{tabs:t[21]},1048576&n[0]&&as(t[20])]):{};24576&n[5]&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function hB(t){let e,n;let r=t[168].label+"";return{c(){e=oE("span"),n=oR(r)},m(t,r){oS(t,e,r),oM(e,n)},p(t,e){8192&e[5]&&r!==(r=t[168].label+"")&&oB(n,r)},d(t){t&&oA(e)}}}function hO(t){let e,n;return e=new d4({props:{elasticity:t[34]*t[35],base:hX,min:t[9],max:hW,valueMin:t[27][0],valueMax:t[27][1],value:t[28],labelReset:t[4].labelReset,valueLabel:"".concat(Math.round(100*t[28]),"%"),oninputstart:t[70],oninputmove:t[71],oninputend:t[72]}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};512&n[0]&&(r.min=t[9]),134217728&n[0]&&(r.valueMin=t[27][0]),134217728&n[0]&&(r.valueMax=t[27][1]),268435456&n[0]&&(r.value=t[28]),16&n[0]&&(r.labelReset=t[4].labelReset),268435456&n[0]&&(r.valueLabel="".concat(Math.round(100*t[28]),"%")),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function hj(t){let e,n;return e=new hk({props:{elasticity:t[34]*t[35],rotation:t[8],labelReset:t[4].labelReset,valueMin:t[26][0],valueMax:t[26][1],oninputstart:t[60],oninputmove:t[61],oninputend:t[62]}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};256&n[0]&&(r.rotation=t[8]),16&n[0]&&(r.labelReset=t[4].labelReset),67108864&n[0]&&(r.valueMin=t[26][0]),67108864&n[0]&&(r.valueMax=t[26][1]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function h_(t){let e,n,r,o;let a=[hj,hO],l=[];function s(t,e){return t[167]===t[21][0].id?0:t[167]===t[21][1].id?1:-1}return~(e=s(t))&&(n=l[e]=a[e](t)),{c(){n&&n.c(),r=oP()},m(t,n){~e&&l[e].m(t,n),oS(t,r,n),o=!0},p(t,o){let c=e;(e=s(t))===c?~e&&l[e].p(t,o):(n&&(o8(),at(l[c],1,1,()=>{l[c]=null}),o7()),~e?((n=l[e])||(n=l[e]=a[e](t)).c(),o9(n,1),n.m(r.parentNode,r)):n=null)},i(t){o||(o9(n),o=!0)},o(t){at(n),o=!1},d(t){~e&&l[e].d(t),t&&oA(r)}}}function hz(t){let e,n;let r=t[18]&&hL(t);return{c(){e=oE("div"),r&&r.c(),oL(e,"slot","footer"),oL(e,"style",t[23])},m(t,o){oS(t,e,o),r&&r.m(e,null),n=!0},p(t,o){t[18]?r?(r.p(t,o),262144&o[0]&&o9(r,1)):((r=hL(t)).c(),o9(r,1),r.m(e,null)):r&&(o8(),at(r,1,1,()=>{r=null}),o7()),(!n||8388608&o[0])&&oL(e,"style",t[23])},i(t){n||(o9(r),n=!0)},o(t){at(r),n=!1},d(t){t&&oA(e),r&&r.d()}}}function hN(t){let e,n;return{c(){e=oI(),n=oI()},m(t,r){oS(t,e,r),oS(t,n,r)},p:oi,i:oi,o:oi,d(t){t&&oA(e),t&&oA(n)}}}function hU(t){let e,n,r;function o(e){t[101].call(null,e)}let a={hasHeader:t[17],$$slots:{default:[hN],footer:[hz],main:[hD],header:[hT]},$$scope:{ctx:t}};return void 0!==t[6]&&(a.root=t[6]),e=new dQ({props:a}),oK.push(()=>ac(e,"root",o)),e.$on("measure",t[102]),{c(){au(e.$$.fragment)},m(t,n){ad(e,t,n),r=!0},p(t,r){let o={};131072&r[0]&&(o.hasHeader=t[17]),536739773&r[0]|16384&r[5]&&(o.$$scope={dirty:r,ctx:t}),!n&&64&r[0]&&(n=!0,o.root=t[6],o1(()=>n=!1)),e.$set(o)},i(t){r||(o9(e.$$.fragment,t),r=!0)},o(t){at(e.$$.fragment,t),r=!1},d(t){ah(e,t)}}}let hW=1,hX=0;function hV(t,e,n){let r,o,a,l,s,c,u,d,h,p,f,g,m,$,y,x,b,v,w,k,C,M,S,A,E,T,R,I,P,D,L,F,B,O,j,_,z,N,U,W,X,V,H,Y,G,K,q,Z,Q,J,tt,te,tn,ti,tr,to,ta,tl,ts,tc,tu,td,th,tp,tf,tg;let tm,t$=oi,ty=()=>(t$(),t$=od(tb,t=>n(16,tm=t)),tb);t.$$.on_destroy.push(()=>t$());let{isActive:tb}=e;ty();let{stores:tv}=e,{cropImageSelectionCornerStyle:tw="circle"}=e,{cropAutoCenterImageSelectionTimeout:tk}=e,{cropEnableZoomMatchImageAspectRatio:tC=!0}=e,{cropEnableRotateMatchImageAspectRatio:tM="never"}=e,{cropEnableRotationInput:tS=!0}=e,{cropEnableZoom:tA=!0}=e,{cropEnableZoomInput:tE=!0}=e,{cropEnableImageSelection:tT=!0}=e,{cropEnableInfoIndicator:tR=!1}=e,{cropEnableZoomTowardsWheelPosition:tI=!0}=e,{cropEnableLimitWheelInputToCropSelection:tP=!0}=e,{cropEnableCenterImageSelection:tD=!0}=e,{cropEnableButtonRotateLeft:tL=!0}=e,{cropEnableButtonRotateRight:tF=!1}=e,{cropEnableButtonFlipHorizontal:tB=!0}=e,{cropEnableButtonFlipVertical:tj=!1}=e,{cropSelectPresetOptions:t_}=e,{cropEnableSelectPreset:tN=!0}=e,{cropEnableButtonToggleCropLimit:tW=!1}=e,{locale:tX={}}=e,{tools:tV=[]}=e,tY=()=>void 0===r,tG=t=>1/t,tK=()=>{if(1===r)return!1;let t=tG(r);return!!(t_&&c6(t_).find(e=>{let[n]=e;return n===t}))},tQ=(t,e,n)=>tU(n)?e.width===Math.round(t.height)||e.height===Math.round(t.width):e.width===Math.round(t.width)||e.height===Math.round(t.height),tJ=(t,e,n)=>{let r=e$(ef(ea(e),n),t=>Math.abs(Math.round(t))),o=ep(r),a=eF(t);return t5(o,a)},t1=()=>(tY()||"always"===tM&&tK())&&tJ(o,a,l)&&tQ(o,a,l),t2=t=>{if("never"!==tM&&t1()){oy(ey,l+=t,l);let e=tU(l),n=e?a.height:a.width,s=e?a.width:a.height;oy(eE,o=eL(0,0,n,s),o),tY()||oy(ej,r=tO(n,s),r)}else oy(ey,l+=t,l)},{history:t4,env:t3,isInteracting:t9,rootRect:et,stageRect:ee,utilRect:en,elasticityMultiplier:ei,rangeInputElasticity:er,presentationScalar:eo,imagePreviewModifiers:el,imageFlipX:ed,imageFlipY:eg,imageRotation:ey,imageRotationRange:ex,imageOutputSize:eb,imageSelectionRect:ev,imageSelectionRectSnapshot:ew,imageSelectionRectIntent:ek,imageSelectionRectPresentation:eC,imageCropRectIntent:eM,imageCropRectOrigin:eA,imageCropRect:eE,imageCropMinSize:eR,imageCropMaxSize:eI,imageCropRange:eP,imageCropAspectRatio:ej,imageCropRectAspectRatio:ez,imageCropLimitToImage:eN,imageSize:eX,imageScalar:eV}=tv;op(t,t3,t=>n(140,E=t)),op(t,t9,t=>n(120,f=t)),op(t,et,t=>n(10,C=t)),op(t,ee,t=>n(130,M=t)),op(t,en,t=>n(126,b=t)),op(t,eo,t=>n(123,$=t)),op(t,el,t=>n(143,R=t)),op(t,ed,t=>n(113,c=t)),op(t,eg,t=>n(112,s=t)),op(t,ey,t=>n(8,l=t)),op(t,ex,t=>n(26,L=t)),op(t,eb,t=>n(116,d=t)),op(t,ev,t=>n(122,m=t)),op(t,ew,t=>n(121,g=t)),op(t,ek,t=>n(125,x=t)),op(t,eC,t=>n(134,A=t)),op(t,eM,t=>n(128,w=t)),op(t,eA,t=>n(127,v=t)),op(t,eE,t=>n(7,o=t)),op(t,eR,t=>n(118,h=t)),op(t,eI,t=>n(124,y=t)),op(t,eP,t=>n(129,k=t)),op(t,ej,t=>n(110,r=t)),op(t,eN,t=>n(119,p=t)),op(t,eX,t=>n(111,a=t)),op(t,eV,t=>n(142,T=t));let eH=(t,e)=>{let n;let o={target:t,translate:e},s=hx(g,o,{aspectRatio:r}),c=es(e_(eS(s),$)),u=aL(a,l);if(e2(u),c.width<h.width||c.height<h.height){let r=e.y<0,o=e.x>0,s=e.x<0,u=e.y>0,d="t"===t&&r||"r"===t&&o||"b"===t&&u||"l"===t&&s||"tr"===t&&(o||r)||"tl"===t&&(s||r)||"br"===t&&(o||u)||"bl"===t&&(s||u),p=eW(c),f=aF(a,l,p);if(d&&(f.width<h.width||f.height<h.height)){if(0!==l){let t=Math.sign(l),e=Math.round(Math.abs(l)/tz)*tz,n=l-t*e,r=e/tz%2==1,o=r?a.height:a.width,s=r?a.width:a.height,u=Math.abs(n),d=Math.sin(u),p=Math.cos(u);if(c.width<h.width){c.width=h.width;let t=p*c.width+d*c.height,e=d*c.width+p*c.height,n=o-t,r=s-e;n<r?c.height=(o-p*c.width)/d:r<n&&(c.height=(s-d*c.width)/p)}if(c.height<h.height){c.height=h.height;let t=p*c.width+d*c.height,e=d*c.width+p*c.height,n=o-t,r=s-e;n<r?c.width=(o-d*c.height)/p:r<n&&(c.width=(s-p*c.height)/d)}}else c.width<h.width&&(c.width=h.width,c.height=a.height),c.height<h.height&&(c.height=h.height,c.width=a.width);n=eW(c)}}return n&&(s=hx(g,o,{aspectRatio:n||r})),{boundsLimited:h$(g,o,b,{aspectRatio:r||n,minSize:j,maxSize:_}),boundsIntent:s}},eZ=t=>{let e,{translation:n,scalar:r}=t,a=Math.min(m.width/o.width,m.height/o.height),l=t7(tq(n),1/a);if(tf){let t=t8(tq(tf),n);tf=n,e=eB(eS(o),t)}else e=eB(eS(tp),tZ(tq(l))),void 0!==r&&eO(e,1-r);oy(eM,w=e,w),oy(eE,o=e,o)},eQ=(t,e,n)=>tU(n)?1-1/Math.min(t.height/e.width,t.width/e.height):1-1/Math.min(t.width/e.width,t.height/e.height),e0=ay([eP,eE],(t,e)=>{let[n,r]=t;if(!r)return;let[o,a]=n,l=eW(r);e([es(eJ(eK(o,l),aI)),es(eJ(eq(a,l),aI))])});op(t,e0,t=>n(131,S=t));let e1=ay([eX,eN,eR,eI,eP,ey],(t,e)=>{let n,r,[o,a,l,s,c,u]=t;if(!o)return;let d=c[0],h=c[1];a?(n=eQ(o,h,u),r=Math.min(d.width/l.width,d.height/l.height)):(r=1,n=-1);let p=[aI(n),aI(r)];e(p)});op(t,e1,t=>n(27,F=t));let e4=ay([eX,eE,eP,ey],(t,e)=>{let n,[r,o,a,l]=t;if(!r||!o)return e(0);let s=a[0],c=a[1],u=o.width,d=o.height,h=eW(o),p=tU(l)?eu(r.height,r.width):r,f=eq(p,h);if(u<=f.width||d<=f.height){let t=f.width-s.width,e=f.height-s.height;n=0===t||0===e?1:1-Math.min((u-s.width)/t,(d-s.height)/e)}else{let t=c.width-f.width,e=c.height-f.height,r=eq({width:t,height:e},h);n=-Math.min((u-f.width)/r.width,(d-f.height)/r.height)}e(n)});op(t,e4,t=>n(28,B=t));let e5=()=>{tp=eS(o)},e3=t=>{let e,n,r;let s=eW(tp),c=tU(l)?eu(a.height,a.width):a,u=eq(c,s);if(t>=0){let o=u.width-k[0].width,a=u.height-k[0].height;e=u.width-o*t,n=u.height-a*t,r=eK({width:e,height:n},s)}else{let o=k[1].width-u.width,a=k[1].height-u.height;e=u.width+-(o*t),n=u.height+-(a*t),r=eq({width:e,height:n},s)}e=r.width,n=r.height;let d=tp.x+.5*tp.width-.5*e,h=tp.y+.5*tp.height-.5*n;oy(eE,o={x:d,y:h,width:e,height:n},o)},e6=oX(),e8=()=>{e6("measure",eS(b))},e7=lu(0,{precision:1e-4});op(t,e7,t=>n(24,P=t));let e9=lu();op(t,e9,t=>n(25,D=t));let nt=lu(0);op(t,nt,t=>n(146,I=t));let ne=ay([ej,eb],(t,e)=>{let[n,r]=t;if(!t_)return;let o=c6(t_),a=[...o].map(t=>t[0]).sort((t,e)=>n0(t[0])&&!n0(e[0])?1:-1).find(t=>{if(n0(t)&&r){let[e,o]=t,a=r.width===e&&r.height===o,l=n===tO(e,o);return a&&l}return t===n}),l=o.map(t=>t[0]).findIndex(t=>n0(t)?aY(t,a):t===a);e(l)});op(t,ne,t=>n(115,u=t));let nn=t=>{if(!t_)return;let e=c6(t_)[t][0],n=e?n0(e)?tO(e[0],e[1]):e:void 0,[r,o,a]=n?[n<1?1:.3,1===n?.85:.5,n>1?1:.3]:[.2,.3,.4];return'<g fill="currentColor">\n        <rect opacity="'.concat(r,'" x="2" y="4" width="10" height="18" rx="1"/>\n        <rect opacity="').concat(o,'" x="4" y="8" width="14" height="14" rx="1"/>\n        <rect opacity="').concat(a,'" x="6" y="12" width="17" height="10" rx="1"/>\n    </g>')},ni=t=>{let[e,n,r,o]=t?[.3,1,0,0]:[0,0,.3,1];return'<g fill="currentColor">\n        <rect opacity="'.concat(e,'" x="2" y="3" width="20" height="20" rx="1"/>\n        <rect opacity="').concat(n,'" x="7" y="8" width="10" height="10" rx="1"/>\n        <rect opacity="').concat(r,'" x="4" y="8" width="14" height="14" rx="1"/>\n        <rect opacity="').concat(o,'" x="12" y="4" width="10" height="10" rx="1"/>\n    </g>')},nr="crop-".concat(tx()),no=nr+"-"+(tS?"rotation":"zoom"),na=no;return t.$$set=t=>{"isActive"in t&&ty(n(1,tb=t.isActive)),"stores"in t&&n(80,tv=t.stores),"cropImageSelectionCornerStyle"in t&&n(2,tw=t.cropImageSelectionCornerStyle),"cropAutoCenterImageSelectionTimeout"in t&&n(81,tk=t.cropAutoCenterImageSelectionTimeout),"cropEnableZoomMatchImageAspectRatio"in t&&n(82,tC=t.cropEnableZoomMatchImageAspectRatio),"cropEnableRotateMatchImageAspectRatio"in t&&n(83,tM=t.cropEnableRotateMatchImageAspectRatio),"cropEnableRotationInput"in t&&n(84,tS=t.cropEnableRotationInput),"cropEnableZoom"in t&&n(3,tA=t.cropEnableZoom),"cropEnableZoomInput"in t&&n(85,tE=t.cropEnableZoomInput),"cropEnableImageSelection"in t&&n(86,tT=t.cropEnableImageSelection),"cropEnableInfoIndicator"in t&&n(87,tR=t.cropEnableInfoIndicator),"cropEnableZoomTowardsWheelPosition"in t&&n(88,tI=t.cropEnableZoomTowardsWheelPosition),"cropEnableLimitWheelInputToCropSelection"in t&&n(89,tP=t.cropEnableLimitWheelInputToCropSelection),"cropEnableCenterImageSelection"in t&&n(90,tD=t.cropEnableCenterImageSelection),"cropEnableButtonRotateLeft"in t&&n(91,tL=t.cropEnableButtonRotateLeft),"cropEnableButtonRotateRight"in t&&n(92,tF=t.cropEnableButtonRotateRight),"cropEnableButtonFlipHorizontal"in t&&n(93,tB=t.cropEnableButtonFlipHorizontal),"cropEnableButtonFlipVertical"in t&&n(94,tj=t.cropEnableButtonFlipVertical),"cropSelectPresetOptions"in t&&n(95,t_=t.cropSelectPresetOptions),"cropEnableSelectPreset"in t&&n(96,tN=t.cropEnableSelectPreset),"cropEnableButtonToggleCropLimit"in t&&n(97,tW=t.cropEnableButtonToggleCropLimit),"locale"in t&&n(4,tX=t.locale),"tools"in t&&n(0,tV=t.tools)},t.$$.update=()=>{65536&t.$$.dirty[4]&&n(139,q="overlay"===E.layoutMode),8&t.$$.dirty[3]|32768&t.$$.dirty[4]&&n(114,ti=tN&&!q),536870912&t.$$.dirty[3]|4&t.$$.dirty[4]&&n(135,V=b&&m&&eY(b,m)),536870912&t.$$.dirty[3]|2048&t.$$.dirty[4]&&n(136,H=!!(m&&V)),536870912&t.$$.dirty[3]|6144&t.$$.dirty[4]&&n(117,Y=H&&eU(m,V,t=>aI(t,5))),272&t.$$.dirty[0]|1610612736&t.$$.dirty[2]|125566999&t.$$.dirty[3]&&n(0,tV=[tL&&[sA,"rotate-left",{label:tX.cropLabelButtonRotateLeft,labelClass:"DokaToolbarContentWide",icon:tX.cropIconButtonRotateLeft,onclick:()=>{t2(-Math.PI/2),t4.write()}}],tF&&[sA,"rotate-right",{label:tX.cropLabelButtonRotateRight,labelClass:"DokaToolbarContentWide",icon:tX.cropIconButtonRotateRight,onclick:()=>{t2(Math.PI/2),t4.write()}}],tB&&[sA,"flip-horizontal",{label:tX.cropLabelButtonFlipHorizontal,labelClass:"DokaToolbarContentWide",icon:tX.cropIconButtonFlipHorizontal,onclick:()=>{tU(l)?oy(eg,s=!s,s):oy(ed,c=!c,c),t4.write()}}],tj&&[sA,"flip-vertical",{label:tX.cropLabelButtonFlipVertical,labelClass:"DokaToolbarContentWide",icon:tX.cropIconButtonFlipVertical,onclick:()=>{tU(l)?oy(ed,c=!c,c):oy(eg,s=!s,s),t4.write()}}],ti&&t_&&[uU,"select-preset",{icon:nn(u),label:tX.cropLabelSelectPreset,labelClass:"DokaToolbarContentWide",options:t_,selectedIndex:u,onchange:t=>{let{value:e}=t;n0(e)?(oy(ej,r=tO(e[0],e[1]),r),oy(eb,d=ec(e),d)):oy(ej,r=e,r),Y&&e8(),t4.write()},optionMapper:t=>{let e=!1,n=n0(t.value)?t.value[0]/t.value[1]:t.value;if(n){let t=aF(a,l,n);e=t.width<h.width||t.height<h.height}return t.icon=hA(t.value,{bounds:14}),{...t,disabled:e}}}],tW&&[uU,"select-crop-limit",{icon:ni(p),label:tX.cropLabelCropBoundary,labelClass:"DokaToolbarContentWide",onchange:t=>{let{value:e}=t;oy(eN,p=e,p),t4.write()},options:[[!0,tX.cropLabelCropBoundaryEdge,{icon:ni(!0)}],[!1,tX.cropLabelCropBoundaryNone,{icon:ni(!1)}]]}]]),67108864&t.$$.dirty[3]&&n(9,U=p?0:-1),68&t.$$.dirty[4]&&n(132,W=b&&tH(-(M.x-b.x),-(M.y-b.y))),1280&t.$$.dirty[4]&&n(133,X=A&&tH(cY(A.x+.5*A.width+W.x),cY(A.y+.5*A.height+W.y))),268435456&t.$$.dirty[3]&&n(137,G=null!=g),2052&t.$$.dirty[4]&&n(138,K=b&&V&&(V.height===b.height||V.width===b.width)),1073741824&t.$$.dirty[3]|278528&t.$$.dirty[4]&&n(141,Z=!K&&$<1&&T<1),16777216&t.$$.dirty[3]|143360&t.$$.dirty[4]&&n(11,Q=H&&!G&&(!Y||Z)),128&t.$$.dirty[0]|33554432&t.$$.dirty[2]|32768&t.$$.dirty[4]&&n(12,J=tR&&!!o&&!q),1280&t.$$.dirty[4]&&n(14,tn=A&&W&&{x:A.x+W.x,y:A.y+W.y,width:A.width,height:A.height}),16384&t.$$.dirty[0]|16777216&t.$$.dirty[2]|32768&t.$$.dirty[4]&&n(13,tt=tT&&!!tn&&!q),268959744&t.$$.dirty[2]|512&t.$$.dirty[4]&&n(15,te=tD&&!!X&&!tk),2048&t.$$.dirty[0]|524288&t.$$.dirty[2]|134283264&t.$$.dirty[3]&&Q&&tk&&!f&&(clearTimeout(N),n(109,N=setTimeout(e8,tk))),134283264&t.$$.dirty[3]&&f&&clearTimeout(N),2048&t.$$.dirty[0]&&e7.set(Q?1:0),512&t.$$.dirty[4]&&e9.set(X),65536&t.$$.dirty[0]&&nt.set(tm?0:20),65536&t.$$.dirty[0]|524288&t.$$.dirty[4]&&(tm?oy(el,R.crop={maskOpacity:.85,maskMarkupOpacity:.85},R):delete R.crop),98304&t.$$.dirty[4]&&n(144,tr=!q&&"short"!==E.verticalSpace),1048576&t.$$.dirty[4]&&n(17,to=tr),8&t.$$.dirty[0]|8388608&t.$$.dirty[2]|1048576&t.$$.dirty[4]&&n(145,ta=tA&&tE&&tr),4194304&t.$$.dirty[2]|2097152&t.$$.dirty[4]&&n(18,tl=tS||ta),4194304&t.$$.dirty[2]|2097152&t.$$.dirty[4]&&n(19,ts=tS&&ta),2097152&t.$$.dirty[4]&&!ta&&n(5,na=no),32&t.$$.dirty[0]&&n(20,tc={name:nr,selected:na}),16&t.$$.dirty[0]&&n(21,tu=[{id:nr+"-rotation",label:tX.cropLabelTabRotation},{id:nr+"-zoom",label:tX.cropLabelTabZoom}]),2097152&t.$$.dirty[0]&&n(22,td=tu.map(t=>t.id)),4194304&t.$$.dirty[4]&&n(23,th=I?"transform: translateY(".concat(I,"px)"):void 0)},[tV,tb,tw,tA,tX,na,tg,o,l,U,C,Q,J,tt,tn,te,tm,to,tl,ts,tc,tu,td,th,P,D,L,F,B,t3,t9,et,ee,en,ei,er,eo,el,ed,eg,ey,ex,eb,ev,ew,ek,eC,eM,eA,eE,eR,eI,eP,ej,eN,eX,eV,()=>{oy(t9,f=!0,f),oy(ew,g=eS(m),g),O=$,j=eh(ea(h),O),_=eh(ea(y),O)},t=>{let{detail:e}=t,{boundsLimited:n,boundsIntent:r}=eH(e.direction,e.translation);oy(ek,x=r,x),oy(ev,m=n,m)},t=>{let{detail:e}=t,{boundsLimited:n}=eH(e.direction,e.translation);oy(t9,f=!1,f),oy(ek,x=void 0,x),t0(e.translation)&&(oy(ev,m=n,m),t4.write()),oy(ew,g=void 0,g)},()=>{oy(t9,f=!0,f),oy(eA,v=eS(o),v)},t=>{oy(ey,l=t,l)},t=>{oy(t9,f=!1,f),oy(ey,l=t,l),t4.write(),oy(eA,v=void 0,v)},()=>{tf=void 0,oy(t9,f=!0,f),tp=eS(o)},t=>{let{detail:e}=t;return eZ(e)},t=>{let{detail:e}=t;oy(t9,f=!1,f),(t0(e.translation)>0||0!==e.scalar)&&(eZ(e),t4.write()),oy(eM,w=void 0,w),tp=void 0},t=>{let{detail:e}=t;tf=e.translation,oy(t9,f=!1,f)},e0,e1,e4,()=>{oy(t9,f=!0,f),e5()},t=>{e3(t)},t=>{e3(t),t4.write(),oy(t9,f=!1,f),tp=void 0},t=>{let e=hp(t,C,M);if(tP&&!eG(m,e))return;oy(t9,f=!0,f),t.preventDefault(),t.stopPropagation();let n=eS(o),r=sB(t),s=1===Math.min(o.width/h.width,o.height/h.height);if(tC&&p){let t=tQ(o,a,l);if(tY()&&t&&r>0&&Y){oy(t9,f=!1,f);let t=tU(l)?eT({height:a.width,width:a.height}):eT(a);if(eU(n,t)||(clearTimeout(z),eU(t4.state.crop,t)))return;oy(eE,o=t,o),t4.write();return}}let c=eF(o);if(tI&&r<0&&!s){let t=t8(tq(e),m),n=Math.min(m.width/o.width,m.height/o.height),r=eO(eS(m),1.1);c=eG(r,e)?t6(eS(o),t7(t,1/n)):c}let u=eO(eS(o),1+r/100,c);if(em(S[1],u)||(u=eD(eF(u),S[1])),em(u,S[0])||(u=eD(eF(u),S[0])),eU(n,u,aI)){oy(t9,f=!1,f);return}oy(eE,o=eJ(u,t=>aI(t,5)),o),oy(t9,f=!1,f),clearTimeout(z),z=setTimeout(()=>{t4.write()},500)},e8,e7,e9,nt,ne,"crop",tv,tk,tC,tM,tS,tE,tT,tR,tI,tP,tD,tL,tF,tB,tj,t_,tN,tW,function(e){oY(t,e)},t=>hh(t),t=>{let{detail:e}=t;return n(5,na=e)},function(t){n(6,tg=t)},function(e){oY(t,e)}]}function hH(t){let e,n,r,o,a,l,s;let c=t[61],u=(nJ(t[61].label)?t[61].label(t[2]):t[61].label)+"";function d(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return t[29](t[61],...n)}let h=()=>t[30](n,c),p=()=>t[30](null,c);return{c(){e=oE("div"),n=oE("div"),r=oI(),o=oE("span"),a=oR(u),oL(n,"class",hq),oL(e,"slot","option"),oL(e,"class","DokaFilterOption")},m(t,c){oS(t,e,c),oM(e,n),h(),oM(e,r),oM(e,o),oM(o,a),l||(s=[oD(n,"measure",d),ox(lv.call(null,n))],l=!0)},p(e,n){c!==(t=e)[61]&&(p(),c=t[61],h()),4&n[0]|1073741824&n[1]&&u!==(u=(nJ(t[61].label)?t[61].label(t[2]):t[61].label)+"")&&oB(a,u)},d(t){t&&oA(e),p(),l=!1,os(s)}}}function hY(t){let e,n;return e=new uA({props:{locale:t[2],layout:"row",options:t[3],selectedIndex:t[10],onchange:t[25],$$slots:{option:[hH,t=>{let{option:e}=t;return{61:e}},t=>{let{option:e}=t;return[0,e?1073741824:0]}]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};4&n[0]&&(r.locale=t[2]),8&n[0]&&(r.options=t[3]),1024&n[0]&&(r.selectedIndex=t[10]),20&n[0]|1073741824&n[1]|1&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function hG(t){let e,n,r,o,a,l,s,c;function u(e){t[32].call(null,e)}function d(e){t[33].call(null,e)}function h(e){t[34].call(null,e)}let p={elasticity:t[14]*t[15],onscroll:t[31],$$slots:{default:[hY]},$$scope:{ctx:t}};return void 0!==t[5]&&(p.maskFeatherStartOpacity=t[5]),void 0!==t[6]&&(p.maskFeatherEndOpacity=t[6]),void 0!==t[7]&&(p.maskFeatherSize=t[7]),n=new s_({props:p}),oK.push(()=>ac(n,"maskFeatherStartOpacity",u)),oK.push(()=>ac(n,"maskFeatherEndOpacity",d)),oK.push(()=>ac(n,"maskFeatherSize",h)),n.$on("measure",t[35]),{c(){e=oE("div"),au(n.$$.fragment),oL(e,"slot","footer"),oL(e,"style",t[11])},m(r,o){oS(r,e,o),ad(n,e,null),l=!0,s||(c=oD(e,"transitionend",t[23]),s=!0)},p(t,s){let c={};256&s[0]&&(c.onscroll=t[31]),1052&s[0]|1&s[2]&&(c.$$scope={dirty:s,ctx:t}),!r&&32&s[0]&&(r=!0,c.maskFeatherStartOpacity=t[5],o1(()=>r=!1)),!o&&64&s[0]&&(o=!0,c.maskFeatherEndOpacity=t[6],o1(()=>o=!1)),!a&&128&s[0]&&(a=!0,c.maskFeatherSize=t[7],o1(()=>a=!1)),n.$set(c),(!l||2048&s[0])&&oL(e,"style",t[11])},i(t){l||(o9(n.$$.fragment,t),l=!0)},o(t){at(n.$$.fragment,t),l=!1},d(t){t&&oA(e),ah(n),s=!1,c()}}}function hK(t){let e,n;return(e=new dQ({props:{$$slots:{footer:[hG]},$$scope:{ctx:t}}})).$on("measure",t[36]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};4092&n[0]|1&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}let hq="DokaFilterPreview";function hZ(t,e,n){let r,o,a,l,s,c,u,d,h,p,f,g,m,$,y,x,b,v;let w,k=oi,C=()=>(k(),k=od(E,t=>n(44,w=t)),E),M,S=oi,A=()=>(S(),S=od(T,t=>n(48,M=t)),T);t.$$.on_destroy.push(()=>k()),t.$$.on_destroy.push(()=>S());let{isActive:E}=e;C();let{isActiveFraction:T}=e;A();let{stores:R}=e,{locale:I}=e,{filterFunctions:P}=e,{filterOptions:D}=e,{history:L,imagePreviews:F,stageRect:B,utilRect:O,elasticityMultiplier:j,scrollElasticity:_,imageCropRect:z,imageSize:N,imageRotation:U,imageFlipX:W,imageFlipY:X,imageGamma:V,imageColorMatrix:H}=R;op(t,B,t=>n(46,c=t)),op(t,O,t=>n(45,s=t)),op(t,V,t=>n(47,u=t)),op(t,H,t=>n(40,r=t));let Y=(t,e)=>{if(!t||!t.filter||!e)return 0;let n=t.filter;return e.findIndex(t=>{let[e]=t;if(!P[e])return!1;let r=P[e]();return aY(r,n)})},G=a$({});op(t,G,t=>n(41,o=t));let K=(t,e)=>oy(G,o[t.value]=e,o),q=ay(G,t=>{if(!t[void 0])return;let e=t[void 0];return a&&ed(a,e)?a:ea(e)});op(t,q,t=>n(42,a=t));let Z=ay([E,q,z,N,U,W,X],(t,e)=>{let[n,r,o,a,s,c,u]=t;if(!n||!r||!a)return l;let d=eT(a),h=eF(d),p=aj(a,o,s),f=eF(p),g=t8(tq(h),f),m=tZ(tq(g)),$=Math.max(r.width/o.width,r.height/o.height);e({origin:m,translation:g,rotation:{x:u?Math.PI:0,y:c?Math.PI:0,z:s},perspective:tV(),scale:$})});op(t,Z,t=>n(43,l=t));let Q=t=>({origin:tq(t.origin),translation:tq(t.translation),rotation:{...t.rotation},perspective:tq(t.perspective),scale:t.scale}),J=lu(0);op(t,J,t=>n(49,d=t));let tt={},te={x:0,y:0},tn=a$([]);op(t,tn,t=>n(50,h=t));let ti=t=>{let e={...t,offset:{...t.offset},mask:{...t.mask}};return e.opacity=M,e.offset.y+=d,e.mask.y+=d,e};return t.$$set=t=>{"isActive"in t&&C(n(0,E=t.isActive)),"isActiveFraction"in t&&A(n(1,T=t.isActiveFraction)),"stores"in t&&n(27,R=t.stores),"locale"in t&&n(2,I=t.locale),"filterFunctions"in t&&n(28,P=t.filterFunctions),"filterOptions"in t&&n(3,D=t.filterOptions)},t.$$.update=()=>{if(8&t.$$.dirty[0]&&n(39,x=c6(D)),768&t.$$.dirty[1]&&n(10,b=Y(r,x)),8192&t.$$.dirty[1]&&J.set(w?0:20),57344&t.$$.dirty[1]&&w&&s&&c){let t=c.y+c.height+s.y;n(38,y={x:c.x-s.x,y:t})}if(268436448&t.$$.dirty[0]|71616&t.$$.dirty[1]&&l&&y&&te&&$&&p){let t=y.x+$.x,e=t+te.x,n=y.y,a=$.x+y.x,s=a+$.width;tn.set(x.map((t,c)=>{let[d]=t,h=o[d],y=te.x+h.x,x=y+h.width;if(x<0||y>$.width)return!1;let b=e+h.x,v=n+h.y,w=Q(l);w.offset=tH(.5*h.width+b,.5*h.height+v),w.maskOpacity=1,w.mask=eL(b+0,v,h.width+0,h.height),w.maskFeather=[1,0,1,0,1,s,1,s],y<m&&f<1&&(w.maskFeather[0]=f,w.maskFeather[1]=a,w.maskFeather[2]=1,w.maskFeather[3]=a+m),x>$.width-m&&g<1&&(w.maskFeather[4]=g,w.maskFeather[5]=s-m,w.maskFeather[6]=1,w.maskFeather[7]=s),w.maskCornerRadius=p[d];let k=r&&Object.keys(r).filter(t=>"filter"!=t).map(t=>r[t])||[];return nJ(P[d])&&k.push(P[d]()),w.colorMatrix=k.length?rV(k):void 0,w.gamma=u,w}).filter(Boolean))}925696&t.$$.dirty[1]&&(w&&h?F.set(h.map(ti)):F.set([])),262144&t.$$.dirty[1]&&n(11,v=d?"transform: translateY(".concat(d,"px)"):void 0)},[E,T,I,D,tt,f,g,m,te,$,b,v,B,O,j,_,V,H,G,K,q,Z,J,t=>{t.target.className===hq&&n(37,p=Object.keys(tt).reduce((t,e)=>{let n=tt[e],r=getComputedStyle(n),o=["top-left","top-right","bottom-left","bottom-right"].map(t=>r.getPropertyValue("border-".concat(t,"-radius"))).map(sF).map(t=>1.25*t);return t[e]=o,t},{}))},tn,t=>{let{value:e}=t;oy(H,r={...r,filter:nJ(P[e])?P[e]():void 0},r),L.write()},"filter",R,P,(t,e)=>K(t,e.detail),function(t,e){oK[t?"unshift":"push"](()=>{tt[e.value]=t,n(4,tt)})},t=>n(8,te=t),function(t){n(5,f=t)},function(t){n(6,g=t)},function(t){n(7,m=t)},t=>n(9,$=t.detail),function(e){oY(t,e)}]}function hQ(t){let e,n;let r=t[35].label+"";return{c(){e=oE("span"),n=oR(r)},m(t,r){oS(t,e,r),oM(e,n)},p(t,e){16&e[1]&&r!==(r=t[35].label+"")&&oB(n,r)},d(t){t&&oA(e)}}}function hJ(t){let e,n;let r=[{class:"DokaControlList"},{tabs:t[1]},t[3]],o={$$slots:{default:[hQ,t=>{let{tab:e}=t;return{35:e}},t=>{let{tab:e}=t;return[0,e?16:0]}]},$$scope:{ctx:t}};for(let t=0;t<r.length;t+=1)o=oo(o,r[t]);return(e=new sl({props:o})).$on("select",t[17]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let o=10&n[0]?al(r,[r[0],2&n[0]&&{tabs:t[1]},8&n[0]&&as(t[3])]):{};48&n[1]&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function h0(t){let e,n;let r=[t[5][t[34]]],o={};for(let t=0;t<r.length;t+=1)o=oo(o,r[t]);return e=new d4({props:o}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let o=32&n[0]|8&n[1]?al(r,[as(t[5][t[34]])]):{};e.$set(o)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function h1(t){let e,n,r,o,a;n=new s_({props:{elasticity:t[8]*t[7],class:"DokaControlListScroller",$$slots:{default:[hJ]},$$scope:{ctx:t}}});let l=[{class:"DokaControlPanels"},{panelClass:"DokaControlPanel"},{panels:t[4]},t[3]],s={$$slots:{default:[h0,t=>{let{panel:e}=t;return{34:e}},t=>{let{panel:e}=t;return[0,e?8:0]}]},$$scope:{ctx:t}};for(let t=0;t<l.length;t+=1)s=oo(s,l[t]);return o=new sf({props:s}),{c(){e=oE("div"),au(n.$$.fragment),r=oI(),au(o.$$.fragment),oL(e,"slot","footer"),oL(e,"style",t[6])},m(t,l){oS(t,e,l),ad(n,e,null),oM(e,r),ad(o,e,null),a=!0},p(t,r){let s={};14&r[0]|32&r[1]&&(s.$$scope={dirty:r,ctx:t}),n.$set(s);let c=24&r[0]?al(l,[l[0],l[1],16&r[0]&&{panels:t[4]},8&r[0]&&as(t[3])]):{};32&r[0]|40&r[1]&&(c.$$scope={dirty:r,ctx:t}),o.$set(c),(!a||64&r[0])&&oL(e,"style",t[6])},i(t){a||(o9(n.$$.fragment,t),o9(o.$$.fragment,t),a=!0)},o(t){at(n.$$.fragment,t),at(o.$$.fragment,t),a=!1},d(t){t&&oA(e),ah(n),ah(o)}}}function h2(t){let e,n;return(e=new dQ({props:{$$slots:{footer:[h1]},$$scope:{ctx:t}}})).$on("measure",t[18]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};126&n[0]|32&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function h4(t,e,n){let r,o,a,l,s,c,u,d;let h,p=oi,f=()=>(p(),p=od(m,t=>n(21,h=t)),m);t.$$.on_destroy.push(()=>p());let{stores:g}=e,{isActive:m}=e;f();let{locale:$={}}=e,{finetuneControlConfiguration:y}=e,{finetuneOptions:x}=e,{history:b,scrollElasticity:v,elasticityMultiplier:w,rangeInputElasticity:k,imageColorMatrix:C,imageConvolutionMatrix:M,imageGamma:S,imageVignette:A,imageNoise:E}=g,T={imageColorMatrix:C,imageConvolutionMatrix:M,imageGamma:S,imageVignette:A,imageNoise:E},R="doka-finetune-".concat(tx()),I=a$({});op(t,I,t=>n(20,o=t));let P=a$({});op(t,P,t=>n(5,r=t));let D=()=>{oy(P,r=Object.keys(o).reduce((t,e)=>{let{base:n,min:r,max:a,getLabel:l,getStore:s,setValue:c=(t,e)=>t.set(e)}=y[e],u=s(T),d=null!=o[e]?o[e]:n;return t[e]={base:n,min:r,max:a,value:d,valueLabel:l?l(d,r,a,a-r):Math.round(100*d),oninputmove:t=>{c(u,t)},oninputend:t=>{c(u,t),b.write()},elasticity:w*k,labelReset:$.labelReset},t},{}),r)},L=[],F=t=>{L&&L.forEach(t=>t()),L=u.map(e=>{let{getStore:n,getValue:r=tj}=t[e],a=n(T);return a.subscribe(t=>{let n=null!=t?r(t):t;oy(I,o={...o,[e]:n},o)})})},B=lu(0);return op(t,B,t=>n(22,a=t)),t.$$set=t=>{"stores"in t&&n(13,g=t.stores),"isActive"in t&&f(n(0,m=t.isActive)),"locale"in t&&n(14,$=t.locale),"finetuneControlConfiguration"in t&&n(15,y=t.finetuneControlConfiguration),"finetuneOptions"in t&&n(16,x=t.finetuneOptions)},t.$$.update=()=>{81920&t.$$.dirty[0]&&n(1,l=x?x.map(t=>{let[e,n]=t;return{id:e,label:nJ(n)?n($):n}}):[]),2&t.$$.dirty[0]&&n(2,s=l.length&&l[0].id),4&t.$$.dirty[0]&&n(3,c={name:R,selected:s}),2&t.$$.dirty[0]&&n(4,u=l.map(t=>t.id)),32768&t.$$.dirty[0]&&y&&F(y),1081344&t.$$.dirty[0]&&y&&o&&D(),2097152&t.$$.dirty[0]&&B.set(h?0:20),4194304&t.$$.dirty[0]&&n(6,d=a?"transform: translateY(".concat(a,"px)"):void 0)},[m,l,s,c,u,r,d,v,w,I,P,B,"finetune",g,$,y,x,t=>{let{detail:e}=t;return n(2,s=e)},function(e){oY(t,e)}]}function h5(t,e,n){let r=t.slice();return r[47]=e[n].key,r[48]=e[n].index,r[49]=e[n].translate,r[50]=e[n].scale,r[14]=e[n].rotate,r[51]=e[n].dir,r[52]=e[n].center,r[53]=e[n].type,r}function h3(t){let e,n;return{c(){oL(e=oE("div"),"class","DokaShapeManipulator"),oL(e,"data-control","point"),oL(e,"style",n="pointer-events:none;transform: translate3d(".concat(t[52].x,"px, ").concat(t[52].y,"px, 0) scale(").concat(t[5],", ").concat(t[5],"); opacity: ").concat(t[6]))},m(t,n){oS(t,e,n)},p(t,r){104&r[0]&&n!==(n="pointer-events:none;transform: translate3d(".concat(t[52].x,"px, ").concat(t[52].y,"px, 0) scale(").concat(t[5],", ").concat(t[5],"); opacity: ").concat(t[6]))&&oL(e,"style",n)},d(t){t&&oA(e)}}}function h6(t,e){let n,r,o,a,l,s,c,u;function d(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e[18](e[48],...n)}let h="edge"===e[53]&&"both"!==e[2]&&h3(e);return{key:t,first:null,c(){n=oE("div"),l=oI(),h&&h.c(),s=oP(),oL(n,"role","button"),oL(n,"tabindex",r="edge"===e[53]?-1:0),oL(n,"class","DokaShapeManipulator"),oL(n,"data-control",o=e[53]),oL(n,"style",a="cursor: ".concat(e[51]?e[51]+"-resize":"move","; transform: translate3d(").concat(e[49].x,"px, ").concat(e[49].y,"px, 0) rotate(").concat(e[14],"rad) scale(").concat("point"===e[53]?e[5]:e[50].x,", ").concat("point"===e[53]?e[5]:e[50].y,"); opacity: ").concat(e[6])),this.first=n},m(t,r){oS(t,n,r),oS(t,l,r),h&&h.m(t,r),oS(t,s,r),c||(u=[oD(n,"keydown",e[7]),oD(n,"keyup",e[8]),oD(n,"nudge",d),ox(sP.call(null,n)),oD(n,"interactionstart",function(){oc(e[11]("start",e[48]))&&e[11]("start",e[48]).apply(this,arguments)}),oD(n,"interactionupdate",function(){oc(e[11]("move",e[48]))&&e[11]("move",e[48]).apply(this,arguments)}),oD(n,"interactionend",function(){oc(e[11]("end",e[48]))&&e[11]("end",e[48]).apply(this,arguments)}),ox(sI.call(null,n))],c=!0)},p(t,l){e=t,8&l[0]&&r!==(r="edge"===e[53]?-1:0)&&oL(n,"tabindex",r),8&l[0]&&o!==(o=e[53])&&oL(n,"data-control",o),104&l[0]&&a!==(a="cursor: ".concat(e[51]?e[51]+"-resize":"move","; transform: translate3d(").concat(e[49].x,"px, ").concat(e[49].y,"px, 0) rotate(").concat(e[14],"rad) scale(").concat("point"===e[53]?e[5]:e[50].x,", ").concat("point"===e[53]?e[5]:e[50].y,"); opacity: ").concat(e[6]))&&oL(n,"style",a),"edge"===e[53]&&"both"!==e[2]?h?h.p(e,l):((h=h3(e)).c(),h.m(s.parentNode,s)):h&&(h.d(1),h=null)},d(t){t&&oA(n),t&&oA(l),h&&h.d(t),t&&oA(s),c=!1,os(u)}}}function h8(t){let e,n,r,o;return{c(){oL(e=oE("div"),"role","button"),oL(e,"tabindex","0"),oL(e,"class","DokaShapeManipulator"),oL(e,"data-control","rotate"),oL(e,"style",n="transform: translate3d(".concat(t[0].x,"px, ").concat(t[0].y,"px, 0) scale(").concat(t[5],", ").concat(t[5],"); opacity: ").concat(t[6]))},m(n,a){oS(n,e,a),r||(o=[oD(e,"keydown",t[7]),oD(e,"keyup",t[8]),oD(e,"nudge",t[13]),ox(sP.call(null,e)),oD(e,"interactionstart",t[14]("start")),oD(e,"interactionupdate",t[14]("move")),oD(e,"interactionend",t[14]("end")),ox(sI.call(null,e))],r=!0)},p(t,r){97&r[0]&&n!==(n="transform: translate3d(".concat(t[0].x,"px, ").concat(t[0].y,"px, 0) scale(").concat(t[5],", ").concat(t[5],"); opacity: ").concat(t[6]))&&oL(e,"style",n)},d(t){t&&oA(e),r=!1,os(o)}}}function h7(t){let e,n,r=[],o=new Map,a=t[3],l=t=>t[47];for(let e=0;e<a.length;e+=1){let n=h5(t,a,e),s=l(n);o.set(s,r[e]=h6(s,n))}let s=t[1]&&t[4]&&h8(t);return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=oI(),s&&s.c(),n=oP()},m(t,o){for(let e=0;e<r.length;e+=1)r[e].m(t,o);oS(t,e,o),s&&s.m(t,o),oS(t,n,o)},p(t,a){if(6636&a[0]){let n=t[3];r=aa(r,a,l,1,t,n,o,e.parentNode,ar,h6,e,h5)}t[1]&&t[4]?s?s.p(t,a):((s=h8(t)).c(),s.m(n.parentNode,n)):s&&(s.d(1),s=null)},i:oi,o:oi,d(t){for(let e=0;e<r.length;e+=1)r[e].d(t);t&&oA(e),s&&s.d(t),t&&oA(n)}}}function h9(t,e,n){let r,o,a,l,s;let c=oX(),u=.5*tN,d=tz-u,h=tz+u,p=-tz,f=p-u,g=p+u,m=t_-u,$=-t_+u,y=-u,x=tz-tN,b=x-u,v=x+u,w=t_-tN,k=w-u,C=w+u,M=p-tN,S=M+u,A=M-u,E=p+tN,T=E+u,R=E-u,{points:I=[]}=e,{rotatorPoint:P}=e,{visible:D=!1}=e,{enableResizing:L=!0}=e,{enableRotating:F=!0}=e,B=!1,O=lu(.5,{precision:1e-4,stiffness:.3,damping:.7});op(t,O,t=>n(5,r=t));let j=lu(0,{precision:.001});op(t,j,t=>n(6,o=t));let _=t=>{let e="";return(t<=h&&t>=d||t>=f&&t<=g)&&(e="ns"),(t<=$||t>=m||t>=y&&t<=u)&&(e="ew"),(t>=k&&t<=C||t<=T&&t>=R)&&(e="nesw"),(t>=b&&t<=v||t<=S&&t>=A)&&(e="nwse"),e},z=(t,e)=>{let n=0,r=en(t),o=[],a=t.length,l=2===a,s="both"!==e;for(;n<a;n++){let c=t[n-1]||t[t.length-1],u=t[n],d=t[n+1]||t[0],h=Math.atan2(d.y-u.y,d.x-u.x);if(!s){let t=t1(tH(c.x-u.x,c.y-u.y)),e=t1(tH(d.x-u.x,d.y-u.y)),r=tH(t.x+e.x,t.y+e.y);o.push({index:[n],key:"point-".concat(n),type:"point",scale:{x:1,y:1},translate:{x:u.x,y:u.y},angle:void 0,rotate:l?0:h,center:u,dir:l?void 0:_(Math.atan2(r.y,r.x))})}if(l)continue;let p=tH(u.x+(d.x-u.x)*.5,u.y+(d.y-u.y)*.5);("horizontal"!==e||n%2!=0)&&("vertical"!==e||n%2==0)&&o.push({index:[n,n+1===a?0:n+1],key:"edge-".concat(n),type:"edge",scale:{x:ee(u,d),y:1},translate:{x:u.x,y:u.y},angle:h,rotate:h,center:p,dir:_(Math.atan2(r.y-p.y,r.x-p.x))})}return o},N=(t,e)=>{c("resizestart",{indexes:t,translation:tV()}),c("resizemove",{indexes:t,translation:e}),c("resizeend",{indexes:t,translation:tV()})};return t.$$set=t=>{"points"in t&&n(15,I=t.points),"rotatorPoint"in t&&n(0,P=t.rotatorPoint),"visible"in t&&n(16,D=t.visible),"enableResizing"in t&&n(17,L=t.enableResizing),"enableRotating"in t&&n(1,F=t.enableRotating)},t.$$.update=()=>{65536&t.$$.dirty[0]&&O.set(D?1:.5),65536&t.$$.dirty[0]&&j.set(D?1:0),131072&t.$$.dirty[0]&&n(2,a=!!L&&(ne(L)?L:"both")),32772&t.$$.dirty[0]&&n(3,l=a&&z(I,a)||[]),32768&t.$$.dirty[0]&&n(4,s=I.length>2)},[P,F,a,l,s,r,o,t=>B=t.shiftKey,t=>B=!1,O,j,(t,e)=>n=>{let{detail:r}=n,o=r&&r.translation?r.translation:tH(0,0);c("resize".concat(t),{indexes:e,translation:o,shiftKey:B})},N,t=>{let{detail:e}=t;c("rotatestart",{translation:tV()}),c("rotatemove",{translation:e}),c("rotateend",{translation:tV()})},t=>e=>{let{detail:n}=e,r=n&&n.translation?n.translation:tH(0,0);c("rotate".concat(t),{translation:r,shiftKey:B})},I,D,L,(t,e)=>{let{detail:n}=e;return N(t,n)}]}class pt extends af{constructor(t){super(),ap(this,t,h9,h7,ou,{points:15,rotatorPoint:0,visible:16,enableResizing:17,enableRotating:1},[-1,-1])}}var pe=(t,e)=>{let n=hh(t);return t8(n,e)},pn=t=>t.selectionStart=t.selectionEnd=t.value.length;let pi=null;var pr=()=>(null===pi&&(pi=tn()&&"visualViewport"in window),pi),po=t=>{if(!pr())return!1;let e=visualViewport.height,n=()=>{t(visualViewport.height<e?"visible":"hidden")};return visualViewport.addEventListener("resize",n),()=>visualViewport.removeEventListener("resize",n)};function pa(t){let e,n,r,o,a,l,s,c,u,d;r=new sA({props:{onclick:t[1],label:t[5],icon:t[7],hideLabel:!t[6]}});let h=t[17].default,p=of(h,t,t[16],null);return s=new sA({props:{onclick:t[0],label:t[2],icon:t[4],hideLabel:!t[3],class:"DokaInputFormButtonConfirm"}}),{c(){e=oE("div"),n=oE("div"),au(r.$$.fragment),o=oI(),a=oE("div"),p&&p.c(),l=oI(),au(s.$$.fragment),oL(a,"class","DokaInputFormFields"),oL(n,"class","DokaInputFormInner"),oL(e,"class","DokaInputForm"),oL(e,"style",t[9])},m(h,f){oS(h,e,f),oM(e,n),ad(r,n,null),oM(n,o),oM(n,a),p&&p.m(a,null),oM(n,l),ad(s,n,null),t[18](e),c=!0,u||(d=[oD(e,"focusin",t[10]),oD(e,"focusout",t[11]),oD(e,"measure",t[12]),ox(lv.call(null,e))],u=!0)},p(t,n){let o={};2&n[0]&&(o.onclick=t[1]),32&n[0]&&(o.label=t[5]),128&n[0]&&(o.icon=t[7]),64&n[0]&&(o.hideLabel=!t[6]),r.$set(o),p&&p.p&&65536&n[0]&&om(p,h,t,t[16],n,null,null);let a={};1&n[0]&&(a.onclick=t[0]),4&n[0]&&(a.label=t[2]),16&n[0]&&(a.icon=t[4]),8&n[0]&&(a.hideLabel=!t[3]),s.$set(a),(!c||512&n[0])&&oL(e,"style",t[9])},i(t){c||(o9(r.$$.fragment,t),o9(p,t),o9(s.$$.fragment,t),c=!0)},o(t){at(r.$$.fragment,t),at(p,t),at(s.$$.fragment,t),c=!1},d(n){n&&oA(e),ah(r),p&&p.d(n),ah(s),t[18](null),u=!1,os(d)}}}function pl(t,e,n){let r,o,a,l,s,c,u,{$$slots:d={},$$scope:h}=e,{onconfirm:p}=e,{oncancel:f}=e,{autoFocus:g=!0}=e,{autoPositionCursor:m=!0}=e,{labelConfirm:$}=e,{labelConfirmShow:y=!0}=e,{iconConfirm:x}=e,{labelCancel:b}=e,{labelCancelShow:v=!1}=e,{iconCancel:w}=e,{panelOffset:k=tV()}=e,C=!1,M="",S=0,A=t=>{let e;let n=t=>e=t.touches[0].screenY,r=t=>{let n=t.touches[0].screenY,r=t.target;/textarea/i.test(r.nodeName)?(n>e?0==r.scrollTop&&t.preventDefault():n<e?r.scrollTop+r.offsetHeight==r.scrollHeight&&t.preventDefault():t.preventDefault(),e=n):t.preventDefault()};return t.addEventListener("touchstart",n),t.addEventListener("touchmove",r),()=>{t.removeEventListener("touchstart",n),t.removeEventListener("touchmove",r)}},E=()=>{let t=a.querySelector("input, textarea");t.focus()},T=()=>{C=!0,!I&&(n5()||aK())&&n(22,M="top:1em;bottom:auto;"),n5()&&A(a),n(23,S=1)},R=()=>{C=!1,n(23,S=0)},I=po(t=>{if(c){if("hidden"===t&&!C){E();return}clearTimeout(o),o=void 0,n(22,M="top:".concat(visualViewport.height-r-k.y,"px")),"visible"===t?(n(8,a.dataset.layout="stick",a),E(),T()):R()}});return oU(()=>{g&&E()}),oW(()=>{I&&I()}),t.$$set=t=>{"onconfirm"in t&&n(0,p=t.onconfirm),"oncancel"in t&&n(1,f=t.oncancel),"autoFocus"in t&&n(13,g=t.autoFocus),"autoPositionCursor"in t&&n(14,m=t.autoPositionCursor),"labelConfirm"in t&&n(2,$=t.labelConfirm),"labelConfirmShow"in t&&n(3,y=t.labelConfirmShow),"iconConfirm"in t&&n(4,x=t.iconConfirm),"labelCancel"in t&&n(5,b=t.labelCancel),"labelCancelShow"in t&&n(6,v=t.labelCancelShow),"iconCancel"in t&&n(7,w=t.iconCancel),"panelOffset"in t&&n(15,k=t.panelOffset),"$$scope"in t&&n(16,h=t.$$scope)},t.$$.update=()=>{256&t.$$.dirty[0]&&n(25,s=a&&getComputedStyle(a)),33554432&t.$$.dirty[0]&&(c=s&&"1"===s.getPropertyValue("--editor-modal")),12582912&t.$$.dirty[0]&&n(9,u="opacity:".concat(S,";").concat(M))},[p,f,$,y,x,b,v,w,a,u,t=>{l=Date.now(),m&&pn(t.target),o=setTimeout(T,200)},t=>{let e=Date.now()-l;e>50||(t.stopPropagation(),E())},t=>{let{detail:e}=t;r=e.height},g,m,k,h,d,function(t){oK[t?"unshift":"push"](()=>{n(8,a=t)})}]}class ps extends af{constructor(t){super(),ap(this,t,pl,pa,ou,{onconfirm:0,oncancel:1,autoFocus:13,autoPositionCursor:14,labelConfirm:2,labelConfirmShow:3,iconConfirm:4,labelCancel:5,labelCancelShow:6,iconCancel:7,panelOffset:15},[-1,-1])}}function pc(t,e,n){let r=t.slice();return r[153]=e[n],r[155]=n,r}function pu(t,e){let n,r,o,a,l,s,c,u,d,h,p;let f=e[153].name+"";function g(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e[94](e[155],...n)}return o=new uq({props:{color:e[153].color}}),{key:t,first:null,c(){n=oE("li"),r=oE("button"),au(o.$$.fragment),a=oI(),l=oE("span"),s=oR(f),u=oI(),oL(r,"class","DokaShapeListItem"),oL(r,"type","button"),oL(r,"aria-label",c="Select shape "+e[153].name),this.first=n},m(t,e){oS(t,n,e),oM(n,r),ad(o,r,null),oM(r,a),oM(r,l),oM(l,s),oM(n,u),d=!0,h||(p=oD(r,"click",g),h=!0)},p(t,n){e=t;let a={};524288&n[0]&&(a.color=e[153].color),o.$set(a),(!d||524288&n[0])&&f!==(f=e[153].name+"")&&oB(s,f),(!d||524288&n[0]&&c!==(c="Select shape "+e[153].name))&&oL(r,"aria-label",c)},i(t){d||(o9(o.$$.fragment,t),d=!0)},o(t){at(o.$$.fragment,t),d=!1},d(t){t&&oA(n),ah(o),h=!1,p()}}}function pd(t){let e,n;return(e=new pt({props:{visible:!0,points:t[11],rotatorPoint:t[12],enableResizing:t[9],enableRotating:t[8]}})).$on("resizestart",t[26]),e.$on("resizemove",t[27]),e.$on("resizeend",t[28]),e.$on("rotatestart",t[29]),e.$on("rotatemove",t[30]),e.$on("rotateend",t[31]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};2048&n[0]&&(r.points=t[11]),4096&n[0]&&(r.rotatorPoint=t[12]),512&n[0]&&(r.enableResizing=t[9]),256&n[0]&&(r.enableRotating=t[8]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function ph(t){let e,n;return e=new ps({props:{panelOffset:t[1],onconfirm:t[37],oncancel:t[38],labelCancel:t[3].shapeLabelInputCancel,iconCancel:t[3].shapeIconInputCancel,labelConfirm:t[3].shapeLabelInputConfirm,iconConfirm:t[3].shapeIconInputConfirm,$$slots:{default:[pp]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};2&n[0]&&(r.panelOffset=t[1]),8&n[0]&&(r.labelCancel=t[3].shapeLabelInputCancel),8&n[0]&&(r.iconCancel=t[3].shapeIconInputCancel),8&n[0]&&(r.labelConfirm=t[3].shapeLabelInputConfirm),8&n[0]&&(r.iconConfirm=t[3].shapeIconInputConfirm),49184&n[0]|2&n[5]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function pp(t){let e,n,r;return{c(){oL(e=oE("textarea"),"style",t[15]),oL(e,"spellcheck","false"),oL(e,"autocorrect","off"),oL(e,"autocapitalize","off"),e.value=t[14]},m(o,a){oS(o,e,a),t[95](e),n||(r=[oD(e,"keydown",t[35]),oD(e,"keypress",t[34]),oD(e,"keyup",t[36]),oD(e,"input",t[33])],n=!0)},p(t,n){32768&n[0]&&oL(e,"style",t[15]),16384&n[0]&&(e.value=t[14])},d(o){o&&oA(e),t[95](null),n=!1,os(r)}}}function pf(t){let e,n,r,o,a;return n=new s2({props:{items:t[18]}}),{c(){e=oE("div"),au(n.$$.fragment),oL(e,"class","DokaShapeControls"),oL(e,"style",t[16])},m(l,s){oS(l,e,s),ad(n,e,null),r=!0,o||(a=[oD(e,"measure",t[96]),ox(lv.call(null,e))],o=!0)},p(t,o){let a={};262144&o[0]&&(a.items=t[18]),n.$set(a),(!r||65536&o[0])&&oL(e,"style",t[16])},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n),o=!1,os(a)}}}function pg(t){let e,n,r,o,a,l,s,c,u,d;let h=[],p=new Map,f=t[19],g=t=>t[153].id;for(let e=0;e<f.length;e+=1){let n=pc(t,f,e),r=g(n);p.set(r,h[e]=pu(r,n))}let m=t[10]&&pd(t),$=t[13]&&ph(t),y=t[17]>0&&pf(t);return{c(){e=oE("div"),n=oE("nav"),r=oE("ul");for(let t=0;t<h.length;t+=1)h[t].c();o=oI(),m&&m.c(),a=oI(),$&&$.c(),l=oI(),y&&y.c(),oL(n,"class","DokaShapeList"),oL(n,"data-visible",t[7]),oL(e,"class","DokaShapeEditor"),oL(e,"tabindex","0")},m(p,f){oS(p,e,f),oM(e,n),oM(n,r);for(let t=0;t<h.length;t+=1)h[t].m(r,null);oM(e,o),m&&m.m(e,null),oM(e,a),$&&$.m(e,null),oM(e,l),y&&y.m(e,null),c=!0,u||(d=[oD(n,"focusin",t[41]),oD(n,"focusout",t[42]),oD(e,"keydown",t[32]),oD(e,"nudge",t[40]),oD(e,"measure",t[93]),ox(lv.call(null,e)),ox(sP.call(null,e)),oD(e,"wheel",t[21]),oD(e,"interactionstart",t[22]),oD(e,"interactionupdate",t[23]),oD(e,"interactionrelease",t[24]),oD(e,"interactionend",t[25]),ox(s=sI.call(null,e,{drag:!0,pinch:!0,inertia:!0,matchTarget:!0,getEventPosition:t[97]}))],u=!0)},p(t,o){if(524305&o[0]){let e=t[19];o8(),h=aa(h,o,g,1,t,e,p,r,ao,pu,null,pc),o7()}(!c||128&o[0])&&oL(n,"data-visible",t[7]),t[10]?m?(m.p(t,o),1024&o[0]&&o9(m,1)):((m=pd(t)).c(),o9(m,1),m.m(e,a)):m&&(o8(),at(m,1,1,()=>{m=null}),o7()),t[13]?$?($.p(t,o),8192&o[0]&&o9($,1)):(($=ph(t)).c(),o9($,1),$.m(e,l)):$&&(o8(),at($,1,1,()=>{$=null}),o7()),t[17]>0?y?(y.p(t,o),131072&o[0]&&o9(y,1)):((y=pf(t)).c(),o9(y,1),y.m(e,null)):y&&(o8(),at(y,1,1,()=>{y=null}),o7()),s&&oc(s.update)&&4&o[0]&&s.update.call(null,{drag:!0,pinch:!0,inertia:!0,matchTarget:!0,getEventPosition:t[97]})},i(t){if(!c){for(let t=0;t<f.length;t+=1)o9(h[t]);o9(m),o9($),o9(y),c=!0}},o(t){for(let t=0;t<h.length;t+=1)at(h[t]);at(m),at($),at(y),c=!1},d(t){t&&oA(e);for(let t=0;t<h.length;t+=1)h[t].d();m&&m.d(),$&&$.d(),y&&y.d(),u=!1,os(d)}}}function pm(t,e,n){let r,o,a,l,s,c,u,d,h,p,f,g,m,$,y,x,b,v,w,k,C,M,S,A,E,T,R,I,P,D,L,F,B,O,j,_,z,N,U,W,X,V,H;let{markup:Y}=e,{offset:G}=e,{rotation:K=0}=e,{scale:q}=e,{ui:Z}=e,{opacity:Q=1}=e,{parentRect:tt}=e,{rootRect:te}=e,{stageRect:tn}=e,{utilRect:ti}=e,{oninteractionstart:tr=J}=e,{oninteractionupdate:to=J}=e,{oninteractionrelease:ta=J}=e,{oninteractionend:tl=J}=e,{onaddshape:ts=J}=e,{onupdateshape:tc=J}=e,{onselectshape:tu=J}=e,{onremoveshape:td=J}=e,{beforeSelectShape:th=()=>!0}=e,{beforeDeselectShape:tp=()=>!0}=e,{beforeAddShape:tf=()=>!0}=e,{beforeRemoveShape:tg=()=>!0}=e,{beforeUpdateShape:tm=(t,e)=>e}=e,{willRenderShapeControls:t$=tj}=e,{mapEditorPointToImagePoint:ty}=e,{mapImagePointToEditorPoint:tb}=e,{enableButtonFlipVertical:tv=!1}=e,{locale:tw}=e,tk=(t,e,n)=>{let r=tm({...t},e,{...n});rM(t,r,n)},tC=(t,e,n,r)=>{if(n)return!!e6(t,eH(e,n,r||eF(e)));let[o,a,l,s]=eZ(e);return t.x>=s&&t.x<=a&&t.y>=o&&t.y<=l},tM=(t,e,n)=>{let r=e.rx,o=e.ry,a=e.x,l=e.y,s=n||0,c=Math.cos(s),u=Math.sin(s),d=c*(t.x-a)+u*(t.y-l),h=u*(t.x-a)-c*(t.y-l);return d*d/(r*r)+h*h/(o*o)<=1},tS=(t,e,n,r)=>{let o=Math.atan2(t.y-e.y,t.x-e.x),a=Math.atan2(t.y-n.y,t.x-n.x);if(o>0&&a>0||o<0&&a<0)return!1;let l=tH(n.x-e.x,n.y-e.y),s=tH(e.x-t.x,e.y-t.y),c=t9(l,l),u=2*t9(s,l),d=t9(s,s)-r*r;return u*u-4*c*d>=0},tA=oH("keysPressed");op(t,tA,t=>n(105,r=t));let tE=(t,e)=>{let n=tb(t);return ty(t6(n,e))},tT=(t,e,n)=>{if(ij(t)){let r=tE(iR(e),n),o=tE(iI(e),n);tk(t,{x1:r.x,y1:r.y,x2:o.x,y2:o.y},tt)}else if(iB(t)||iD(t)||iO(t)){let r=tE(e,n);tk(t,r,tt)}tB()},tR=(t,e,n,o,a)=>{if(ij(t)){let[a]=n,l=r.includes(16)?(t,e)=>{let n=ee(t,e),r=t4(t,e),o=Math.PI/4,a=o*Math.round(r/o)-K%o;e.x=t.x+n*Math.cos(a),e.y=t.y+n*Math.sin(a)}:(t,e)=>e;if(0===a){let n=tE(iR(e),o);l(tH(e.x2,e.y2),n),tk(t,{x1:n.x,y1:n.y},tt)}else if(1===a){let n=tE(iI(e),o);l(tH(e.x1,e.y1),n),tk(t,{x2:n.x,y2:n.y},tt)}}else if(iH(t)||iO(t)||iF(t)){let r,l,s=!1;if(iO(t))r=eP(e);else if(iH(t))r=eR(e);else{s=!0,r=eR(e);let t=ix(e.text,e);r.height=t.height}t.aspectRatio?l=t.aspectRatio:a.shiftKey&&!s&&(l=r.width/r.height);let c=eR(r),u=eF(c),d=t.rotation,h=eQ(c),p=eH(c,d);if(1===n.length){let e,r=n[0],[a,s,c,f]=h,g=tb(p[r]);t6(g,o);let m=ty(g),$=tH(m.x-p[r].x,m.y-p[r].y);t.flipX&&($.x=-$.x),t.flipY&&($.y=-$.y);let y=tJ(tq($),-d),x=tH(h[r].x+y.x,h[r].y+y.y);0===r&&(e=c),1===r&&(e=f),2===r&&(e=a),3===r&&(e=s);let b=eI(e,x);if(l){let{width:t,height:n}=eq(b,l),[r,o,a,s]=eZ(b);b.width=t,b.height=n,x.y<e.y&&(b.y=a-n),x.x<e.x&&(b.x=o-t)}let v=eH(b,d,u),w=en(v),k=tJ(v[0],-d,w),C=tJ(v[2],-d,w);(t.flipX||t.flipY)&&ei([k,C],t.flipX,t.flipY,u.x,u.y);let M=eI(k,C);tk(t,iO(t)?tX(M):M,tt)}else{let e;let[r,a]=n.map(t=>p[t]),c={x:r.x+(a.x-r.x)*.5,y:r.y+(a.y-r.y)*.5},[f,g]=n.map(t=>h[t]),[m,$]=n.map(t=>{let e=t+2;return e<4?h[e]:h[e-4]});f.x,g.x,f.x,f.y,g.y,f.y;let y={x:m.x+($.x-m.x)*.5,y:m.y+($.y-m.y)*.5},x=tb(c);t6(x,o);let b=ty(x),v=tH(b.x-c.x,b.y-c.y);t.flipX&&(v.x=-v.x),t.flipY&&(v.y=-v.y);let w=tJ(tq(v),-d),k=t8(tq(f),g),C=t3(k,t=>1-Math.abs(Math.sign(t))),M=tH(w.x*C.x,w.y*C.y);t6(f,M),t6(g,M);let S=eI(h);if(l){let t=S.width,e=S.height;0===C.y?e=t/l:t=e*l,S.width=t,S.height=e,0===C.y?S.y=y.y-.5*e:S.x=y.x-.5*t}let A=eH(S,d,u),E=en(A),T=tJ(A[0],-d,E),R=tJ(A[2],-d,E);(t.flipX||t.flipY)&&ei([T,R],t.flipX,t.flipY,u.x,u.y);let I=eI(T,R);iO(t)?e=tX(I):iH(t)?e=I:s&&(e={x:I.x,y:I.y,width:I.width}),tk(t,e,tt)}}tB()},tI=(t,e,n,r)=>{let o=eo(rb(iC(t),tt)),l=eF(o),s=tE(a,n),c=t4(s,l)+Math.PI/2;if(r.shiftKey){let t=Math.PI/16;c=t*Math.round(c/t)-K%t}tk(t,{rotation:c},tt),tB()},tP=()=>{if(!Y.length)return;let t=Y[Y.length-1];return t.isDraft?t:void 0},tD=function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!tP())return tO(t=Object.assign(t,{isDraft:!0}),e)},tL=()=>{let t=tP();if(t)return tz(t,"isDraft",!1),t},tF=()=>{tP()&&n(0,Y=Y.slice(0,-1))},tB=()=>n(0,Y),tO=function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];return Y.push(t),e&&tB(),t},t_=function(t,e){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];t=Object.assign(t,e),n&&tB()},tz=function(t,e,n){let r=!(arguments.length>3)||void 0===arguments[3]||arguments[3];t[e]=n,r&&tB()},tN=function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];Y.forEach(e=>t_(e,t,!1)),e&&tB()},tU=()=>[...Y].reverse().find(iX),tW=()=>!!tU(),tV=function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!tg(t))return!1;let r=Y.filter(e=>e!==t);td(t),e&&n(0,Y=r)},tY=()=>{let t=tU();if(!t)return;let e=Y.filter(t=>i4(t)&&i2(t)),n=e.findIndex(e=>e===t),r=tV(t);if(!1===r)return;if(U=t,e.length-1==0)return tG();let o=n-1<0?e.length-1:n-1;tZ(e[o])},tG=()=>{U=tK(),tN({isSelected:!1,isEditing:!1})},tK=()=>Y.find(iX),tZ=function(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(t.isDraft)return;let n=tK()||U;U=void 0,th(n,t)&&(tG(),iQ(t),tu(t),e&&tB())},tQ=t=>{t_(t,{isSelected:!1,isEditing:!1})},t0=t=>{t_(t,{isSelected:!0,isEditing:!0})},t2=t=>{t_(t,{isSelected:!0,isEditing:!1})},t5=t=>{let e=t.filter(tg);return n(0,Y=Y.filter(t=>!e.includes(t))),e},et=t=>{let e=ix(t.text,t);return eL(t.x,t.y,t.width?Math.min(t.width,e.width):e.width,t.height?Math.min(t.height,e.height):e.height)},eo=t=>{if(iH(t))return eR(t);if(iO(t))return eP(t);let e=et(t);return e.width=Math.max(10,t.width||e.width),e},ea=t=>[...Y].reverse().map(t=>({shape:t,priority:1})).filter(t=>i2(t.shape)).filter(e=>{let{shape:n}=e,r=rb(iC(n),tt);if(iB(r))return tC(t,r,n.rotation);if(iD(r)){let o=eo(r),a=tC(t,o,n.rotation);if(a&&!iX(n)){let a=et(r);"right"!==n.textAlign||n.flipX||(a.x=o.x+o.width-a.width),"center"===n.textAlign&&(a.x=o.x+.5*o.width-.5*a.width),tC(t,a,n.rotation,eF(o))||(e.priority=-1)}return a}return iO(r)?tM(t,r,n.rotation):!!ij(r)&&tS(t,iR(r),iI(r),16)}).sort((t,e)=>t.priority<e.priority?1:t.priority>e.priority?-1:0),el=(t,e)=>{let n=eb(t,e);return Y.filter(i1).filter(t=>!!e3(n,ec(rb(iC(t),tt))))},es=!1,ec=t=>{let e,n;if(iB(t))e=eF(t),n=eQ(t),(t.flipX||t.flipY)&&ei(n,t.flipX,t.flipY,e.x,e.y),n=er(n,t.rotation,e.x,e.y);else if(iO(t))e=t,n=eQ(eP(t)),(t.flipX||t.flipY)&&ei(n,t.flipX,t.flipY,e.x,e.y),n=er(n,t.rotation,e.x,e.y);else if(ij(t))e=en(n=[iR(t),iI(t)]);else if(iz(t))e=en(n=[...t.points]);else if(iD(t)){let r=eo(t);r.width=Math.max(10,r.width),e=eF(r),n=eQ(r),(t.flipX||t.flipY)&&ei(n,t.flipX,t.flipY,e.x,e.y),n=er(n,t.rotation,e.x,e.y)}return n},eu=t=>{let e,n;let r=ec(t);return t.flipY?(e=en([r[0],r[1]]),n=t1(tH(r[1].x-r[2].x,r[1].y-r[2].y))):(e=en([r[2],r[3]]),n=t1(tH(r[2].x-r[1].x,r[2].y-r[1].y))),t7(n,20/q),{origin:e,dir:n}},ed=t=>{let e=eu(t),n=tb({x:e.origin.x+e.dir.x,y:e.origin.y+e.dir.y}),r=tb(e.origin);return{origin:r,position:n}},eh="markup-manipulator-segment";oW(()=>{n(43,Z=Z.filter(t=>t.id!==eh))});let ep=()=>({...c}),ef=()=>{let t=iL(c)?em(l.value):l.value,e=i8(c,t),n=!0===e?t:e,r=S.x,o=S.y;if(!c.height&&0!==c.rotation){let t=ix(n,c),e=eL(S.x,S.y,t.width,t.height),[a]=eH(e,S.rotation),[l]=eH(E,S.rotation);r+=l.x-a.x,o+=l.y-a.y}t_(c,{x:r,y:o,text:n})},eg=()=>t0(c),em=t=>t.split(/[\n\r]/g).map(t=>t.trim()).filter(t=>t.length).join(" "),e$=()=>{let t=c.isDraft;c.isDraft&&tL(),ef(),t2(c),t?ts(c):tc(c)},ey=()=>{t_(c,{text:S.text,x:S.x,y:S.y}),c.isDraft&&tF(),t2(c)},ex=t=>{t.stopPropagation();let e=c.flipX||!1;tz(c,"flipX",!e),tc(c)},ev=t=>{t.stopPropagation();let e=c.flipY||!1;tz(c,"flipY",!e),tc(c)},ew=t=>{t.stopPropagation(),t.target.blur(),tY()},ek=t=>{t.stopPropagation();let e=Y.findIndex(t=>t===c);e!==Y.length-1&&(n(0,Y=Y.filter(t=>t!==c).concat([c])),tc(c))},eC=t=>{t.stopPropagation();let e=iC(c);e.id=tx();let n=tH(50,-50);if(ij(e)){let t=rC(e,["x1","y1","x2","y2"],tt);t.x1+=n.x,t.y1+=n.y,t.x2+=n.x,t.y2+=n.y,rM(e,t,tt)}else{let t=rC(e,["x","y"],tt);t.x+=50,t.y-=50,rM(e,t,tt)}Y.push(e),ts(e),tZ(e)},eM=t=>t3(tH(t.x+.5*t.width,t.y),cY),eS=lu(0,{stiffness:.2,damping:.7});op(t,eS,t=>n(17,o=t));let eA=t=>{let e=ti.x,n=ti.y,r=e+ti.width,o=Math.max(t.x-.5*s.width,e),a=Math.max(t.y-s.height-16,n);return o+s.width>r&&(o=r-s.width),tH(o,a)},eE=()=>{C||tG()},eT=!1;return t.$$set=t=>{"markup"in t&&n(0,Y=t.markup),"offset"in t&&n(1,G=t.offset),"rotation"in t&&n(44,K=t.rotation),"scale"in t&&n(45,q=t.scale),"ui"in t&&n(43,Z=t.ui),"opacity"in t&&n(46,Q=t.opacity),"parentRect"in t&&n(47,tt=t.parentRect),"rootRect"in t&&n(2,te=t.rootRect),"stageRect"in t&&n(48,tn=t.stageRect),"utilRect"in t&&n(49,ti=t.utilRect),"oninteractionstart"in t&&n(50,tr=t.oninteractionstart),"oninteractionupdate"in t&&n(51,to=t.oninteractionupdate),"oninteractionrelease"in t&&n(52,ta=t.oninteractionrelease),"oninteractionend"in t&&n(53,tl=t.oninteractionend),"onaddshape"in t&&n(54,ts=t.onaddshape),"onupdateshape"in t&&n(55,tc=t.onupdateshape),"onselectshape"in t&&n(56,tu=t.onselectshape),"onremoveshape"in t&&n(57,td=t.onremoveshape),"beforeSelectShape"in t&&n(58,th=t.beforeSelectShape),"beforeDeselectShape"in t&&n(59,tp=t.beforeDeselectShape),"beforeAddShape"in t&&n(60,tf=t.beforeAddShape),"beforeRemoveShape"in t&&n(61,tg=t.beforeRemoveShape),"beforeUpdateShape"in t&&n(62,tm=t.beforeUpdateShape),"willRenderShapeControls"in t&&n(63,t$=t.willRenderShapeControls),"mapEditorPointToImagePoint"in t&&n(64,ty=t.mapEditorPointToImagePoint),"mapImagePointToEditorPoint"in t&&n(65,tb=t.mapImagePointToEditorPoint),"enableButtonFlipVertical"in t&&n(66,tv=t.enableButtonFlipVertical),"locale"in t&&n(3,tw=t.locale)},t.$$.update=()=>{if(1&t.$$.dirty[0]&&n(106,c=Y&&(tP()||tU())),8192&t.$$.dirty[3]&&n(107,u=c&&!iV(c)?c.id:void 0),65536&t.$$.dirty[1]|8192&t.$$.dirty[3]&&n(108,d=c&&rb(iC(c),tt)),8192&t.$$.dirty[3]&&n(109,h=!!(c&&iV(c))),8192&t.$$.dirty[3]&&n(110,p=c||void 0),40960&t.$$.dirty[3]&&n(111,f=c&&!iz(d)&&ec(d)||[]),8192&t.$$.dirty[3]&&n(112,g=c&&i9(c)&&!iU(c)),8192&t.$$.dirty[3]&&n(8,m=c&&rt(c)&&!iU(c)),532480&t.$$.dirty[3]&&n(9,$=g&&nK(c,"text")&&!c.height?"horizontal":g),270336&t.$$.dirty[3]&&n(10,y=c&&f.length>1),8&t.$$.dirty[2]|262144&t.$$.dirty[3]&&n(113,x=f.map(tb)),2&t.$$.dirty[0]|1048576&t.$$.dirty[3]&&n(11,b=x.map(t=>tH(t.x-G.x,t.y-G.y))),1280&t.$$.dirty[0]|32768&t.$$.dirty[3]&&n(114,v=y&&m&&ed(d)),2&t.$$.dirty[0]|2097152&t.$$.dirty[3]&&n(12,w=v&&tH(v.position.x-G.x,v.position.y-G.y)),32768&t.$$.dirty[1]&&n(115,k=Q),2048&t.$$.dirty[0]|36864&t.$$.dirty[1]|7340032&t.$$.dirty[3]){if(Q>0&&b.length>2){let t=[...x,x[0]],e=t.length,r=[],o=[1,1,1,k];for(let n=0;n<e-1;n++)r[n]={id:eh,points:[t[n],t[n+1]],opacity:1,strokeColor:o,strokeWidth:1};v&&(r[r.length]={id:eh,opacity:1,points:[{x:v.origin.x,y:v.origin.y},{x:v.position.x,y:v.position.y}],strokeColor:o,strokeWidth:1}),n(43,Z=[...Z.filter(t=>t.id!==eh),...r])}else n(43,Z=Z.filter(t=>t.id!==eh))}8192&t.$$.dirty[3]&&n(116,C=c&&iD(c)),8396800&t.$$.dirty[3]&&n(13,M=C&&!1!==i8(c)&&c.isEditing),8192&t.$$.dirty[0]&&n(117,S=M?ep():void 0),16777216&t.$$.dirty[3]&&n(118,A=S&&ix(S.text,S)),50331648&t.$$.dirty[3]&&(E=S&&eL(S.x,S.y,A.width,A.height)),8192&t.$$.dirty[0]|8192&t.$$.dirty[3]&&n(14,T=M?c.text:""),8192&t.$$.dirty[0]|131072&t.$$.dirty[3]&&n(15,R=M&&"\n    text-align: ".concat(p.textAlign||"left",";\n    font-family: ").concat(p.fontFamily||"sans-serif",";\n")),134291456&t.$$.dirty[3]&&n(120,I=c&&!h?c:I),134217728&t.$$.dirty[3]&&n(121,P=I&&i6(I)),134217728&t.$$.dirty[3]&&n(122,D=I&&i5(I)),134217728&t.$$.dirty[3]&&n(123,L=I&&i4(I)),134217728&t.$$.dirty[3]&&n(124,F=I&&i3(I)),134217728&t.$$.dirty[3]&&n(125,B=I&&!1!==i8(I)),8192&t.$$.dirty[0]|75776&t.$$.dirty[3]&&eS.set(!c||h||es||M?0:1),2048&t.$$.dirty[0]|73728&t.$$.dirty[3]|4&t.$$.dirty[4]&&n(126,O=c&&!h?eM(eI(b)):O),64&t.$$.dirty[0]|262144&t.$$.dirty[1]|4&t.$$.dirty[4]&&n(127,j=O&&s&&ti&&eA(O)),131072&t.$$.dirty[0]|8&t.$$.dirty[4]&&n(16,_=j&&"transform: translate(".concat(j.x,"px, ").concat(j.y,"px);opacity:").concat(o)),8&t.$$.dirty[0]|18&t.$$.dirty[2]|1879064576&t.$$.dirty[3]|3&t.$$.dirty[4]&&n(18,z=u&&t$([["div","alpha",{class:"DokaShapeControlsGroup"},[P&&[sA,"flip-horizontal",{onclick:ex,label:tw.shapeTitleButtonFlipHorizontal,icon:tw.shapeIconButtonFlipHorizontal,hideLabel:!0}],P&&tv&&[sA,"flip-vertical",{onclick:ev,label:tw.shapeTitleButtonFlipVertical,icon:tw.shapeIconButtonFlipVertical,hideLabel:!0}],F&&[sA,"to-front",{onclick:ek,label:tw.shapeTitleButtonMoveToFront,icon:tw.shapeIconButtonMoveToFront,hideLabel:!0}],D&&[sA,"duplicate",{onclick:eC,label:tw.shapeTitleButtonDuplicate,icon:tw.shapeIconButtonDuplicate,hideLabel:!0}],L&&[sA,"remove",{onclick:ew,label:tw.shapeTitleButtonRemove,icon:tw.shapeIconButtonRemove,hideLabel:!0}]]],B&&["div","beta",{class:"DokaShapeControlsGroup"},[[sA,"edit-text",{label:tw.shapeLabelInputText,onclick:eg}]]]],u)),4&t.$$.dirty[0]&&te&&eE(),9&t.$$.dirty[0]&&n(19,N=Y.filter(i2).filter(t=>!iV(t)).map(t=>({id:t.id,color:iD(t)?t.color:ij(t)?t.strokeColor:t.backgroundColor,name:t.name||tw["shapeLabelTool".concat(aT(rm(t)))]})))},[Y,G,te,tw,tZ,l,s,eT,m,$,y,b,w,M,T,R,_,o,z,N,tA,t=>{},t=>{let{origin:e}=t.detail;V=void 0,H=void 0,X=void 0,clearTimeout(W),W=setTimeout(()=>n(104,es=!0),250);let r=ty(tq(e)),o=ea(r),a=o.length&&o.shift().shape;if(a&&iX(a)){H=rb(iC(V=a),tt);return}X=a,tr(t)},t=>{if(V){if(!i7(V)||iU(V))return;return tT(V,H,t.detail.translation)}to(t)},t=>{if(clearTimeout(W),n(104,es=!1),V){V.isEditing?ey():t.detail.isDoubleTap&&iD(V)&&!1!==i8(V)&&t0(V);return}ta(t)},t=>{if(V){tc(V),V=void 0;return}let e=tK(),n=X&&t.detail.isTap,r=!e||tp(e,X);r&&tG(),tl(t),r&&n&&tZ(X)},t=>{n(104,es=!0),V=c,H=d},t=>{let{translation:e,indexes:n,shiftKey:r}=t.detail;tR(V,H,n,e,{shiftKey:r})},t=>{tZ(V),V=void 0,n(104,es=!1),tc(c)},t=>{a=eu(d).origin,n(104,es=!0),V=c,H=d},t=>{let{translation:e,shiftKey:n}=t.detail;tI(V,H,e,{shiftKey:n})},()=>{tZ(V),V=void 0,n(104,es=!1),tc(c)},t=>{if(!tW())return;let{key:e}=t;if(/escape/i.test(e))return tQ(c);/backspace/i.test(e)&&!/input|textarea/i.test(t.target.nodeName)&&(t.preventDefault(),tY())},ef,t=>{let e=t.target.value,n=t.target.selectionStart,r=t.target.selectionEnd,o=e.substring(0,n),a=e.substring(r),l=o+t.key+a,s=i8(c,l);if(s!==l)return t.preventDefault()},t=>iL(c)&&/enter/i.test(t.code)?t.preventDefault():/arrow/i.test(t.code)?t.stopPropagation():/escape/i.test(t.key)?ey():void 0,t=>{let{key:e,ctrlKey:n,altKey:r}=t;if(/enter/i.test(e)&&n|r)return e$()},e$,ey,eS,t=>{let e=tU();e&&i7(e)&&(H=rb(iC(V=e),tt),tT(V,H,t.detail))},t=>{n(7,eT=!0)},t=>{let{relatedTarget:e}=t;e.classList.contains("shape-selector__button")||n(7,eT=!1)},Z,K,q,Q,tt,tn,ti,tr,to,ta,tl,ts,tc,tu,td,th,tp,tf,tg,tm,t$,ty,tb,tv,function(t){let e,n,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},l=iO(t),s=iD(t),c="relative"===a.position;return iz(t)?{start:r=>{let{origin:a}=r.detail;n=4,e=tq(a),o=tq(a);let l=ty(a);c&&(l.x=c?io(l.x,tt.width):l.x,l.y=c?io(l.y,tt.height):l.y),tD({...t,points:[l]})},update:t=>{let r=tP(),{translation:a}=t.detail,l=tH(e.x+a.x,e.y+a.y),s=ee(o,l);if(aI(s,5)<=n)return;let u=t4(l,o),d=n-s;o.x+=d*Math.cos(u),o.y+=d*Math.sin(u);let h=ty(o);h&&(h.x=c?io(h.x,tt.width):h.x,h.y=c?io(h.y,tt.height):h.y),r.points=r.points.concat(h),tB()},release:t=>t.detail.preventInertia(),end:t=>{if(tP(),t.detail.isTap)return tF();let e=tL();ts(e)}}:l||s||iB(t)?{start:n=>{let{origin:r}=n.detail;e=tq(r);let o=ty(e),a={...t,rotation:-K,x:c?io(o.x,tt.width):o.x,y:c?io(o.y,tt.height):o.y};delete a.position,a.opacity=0,l?(a.rx=c?io(0):0,a.ry=c?io(0):0):(a.width=c?io(0):0,a.height=c?io(0):0),tD(a)},update:t=>{let n=tP();n.opacity=1;let{aspectRatio:r}=n,{translation:o}=t.detail;if(r){let t=Math.abs(o.x)*r;o.x=o.x,o.y=t*Math.sign(o.y)}let a=tH(e.x+o.x,e.y+o.y),s=ty(e),c=ty(a),u={x:s.x+(c.x-s.x)*.5,y:s.y+(c.y-s.y)*.5};tJ(s,K,u),tJ(c,K,u);let d=Math.min(s.x,c.x),h=Math.min(s.y,c.y),p=Math.max(s.x,c.x),f=Math.max(s.y,c.y),g=p-d,m=f-h,$={};l?($.x=d+.5*g,$.y=h+.5*m,$.rx=.5*g,$.ry=.5*m):($.x=d,$.y=h,$.width=g,$.height=m),tk(n,$,tt),tB()},release:t=>{t.detail.preventInertia()},end:t=>{let e=tP();if(t.detail.isTap)return tF();if(e.opacity=1,!iD(e)){let t=tL();ts(t)}tZ(e),iD(e)&&t0(e)}}:ij(t)?{start:n=>{let{origin:r}=n.detail,o=ty(r),a=t3(o,cY);e=tq(r),tD({...t,x1:c?io(a.x,tt.width):a.x,y1:c?io(a.y,tt.height):a.y,x2:c?io(a.x,tt.width):a.x,y2:c?io(a.y,tt.height):a.y,opacity:0})},update:t=>{let n=tP(),{translation:o}=t.detail,a=t6(tq(e),o);if(r.includes(16)){let t=ee(e,a),n=t4(e,a),r=Math.PI/4,o=r*Math.round(n/r);a.x=e.x+t*Math.cos(o),a.y=e.y+t*Math.sin(o)}let l=ty(a);t_(n,{x2:c?io(l.x,tt.width):l.x,y2:c?io(l.y,tt.height):l.y,opacity:1}),tB()},release:t=>t.detail.preventInertia(),end:t=>{let e=tP();if(t.detail.isTap)return tF();e.opacity=1,tL(),tZ(e)}}:void 0},()=>{let t,e;return{start:n=>{e=t=n.detail.origin},update:n=>{let{translation:r}=n.detail,o=tH(t.x+r.x,t.y+r.y),a=el(ty(e),ty(o)),l=t5(a);l.forEach(td),e=tq(o)},release:t=>t.detail.preventInertia(),end:()=>{}}},tP,tD,tL,tF,function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{id:tx(),...t}},tB,tO,t_,tz,function(t,e){let n=!(arguments.length>2)||void 0===arguments[2]||arguments[2];Y.forEach(n=>tz(n,t,e,!1)),n&&tB()},tN,tU,tW,tV,tY,tG,tQ,t0,t2,t5,et,eo,ea,el,function(e){oY(t,e)},(t,e)=>tZ(Y[t]),function(t){oK[t?"unshift":"push"](()=>{n(5,l=t)})},t=>n(6,s=t.detail),t=>pe(t,te)]}class p$ extends af{get createShape(){return this.$$.ctx[67]}get eraseShape(){return this.$$.ctx[68]}get getMarkupItemDraft(){return this.$$.ctx[69]}get addMarkupItemDraft(){return this.$$.ctx[70]}get confirmMarkupItemDraft(){return this.$$.ctx[71]}get discardMarkupItemDraft(){return this.$$.ctx[72]}get createMarkupItem(){return this.$$.ctx[73]}get syncShapes(){return this.$$.ctx[74]}get addShape(){return this.$$.ctx[75]}get updateMarkupShape(){return this.$$.ctx[76]}get updateMarkupShapeProperty(){return this.$$.ctx[77]}get updateMarkupItemsShapeProperty(){return this.$$.ctx[78]}get updateMarkupShapeItems(){return this.$$.ctx[79]}get getActiveMarkupItem(){return this.$$.ctx[80]}get hasActiveMarkupItem(){return this.$$.ctx[81]}get removeShape(){return this.$$.ctx[82]}get removeActiveMarkupItem(){return this.$$.ctx[83]}get blurShapes(){return this.$$.ctx[84]}get selectShape(){return this.$$.ctx[4]}get deselectMarkupItem(){return this.$$.ctx[85]}get editMarkupItem(){return this.$$.ctx[86]}get finishEditMarkupItem(){return this.$$.ctx[87]}get removeMarkupItems(){return this.$$.ctx[88]}get getTextShapeRect(){return this.$$.ctx[89]}get getMarkupShapeRect(){return this.$$.ctx[90]}get getShapesAtPosition(){return this.$$.ctx[91]}get getMarkupBetweenPoints(){return this.$$.ctx[92]}constructor(t){super(),ap(this,t,pm,pg,ou,{markup:0,offset:1,rotation:44,scale:45,ui:43,opacity:46,parentRect:47,rootRect:2,stageRect:48,utilRect:49,oninteractionstart:50,oninteractionupdate:51,oninteractionrelease:52,oninteractionend:53,onaddshape:54,onupdateshape:55,onselectshape:56,onremoveshape:57,beforeSelectShape:58,beforeDeselectShape:59,beforeAddShape:60,beforeRemoveShape:61,beforeUpdateShape:62,willRenderShapeControls:63,mapEditorPointToImagePoint:64,mapImagePointToEditorPoint:65,enableButtonFlipVertical:66,locale:3,createShape:67,eraseShape:68,getMarkupItemDraft:69,addMarkupItemDraft:70,confirmMarkupItemDraft:71,discardMarkupItemDraft:72,createMarkupItem:73,syncShapes:74,addShape:75,updateMarkupShape:76,updateMarkupShapeProperty:77,updateMarkupItemsShapeProperty:78,updateMarkupShapeItems:79,getActiveMarkupItem:80,hasActiveMarkupItem:81,removeShape:82,removeActiveMarkupItem:83,blurShapes:84,selectShape:4,deselectMarkupItem:85,editMarkupItem:86,finishEditMarkupItem:87,removeMarkupItems:88,getTextShapeRect:89,getMarkupShapeRect:90,getShapesAtPosition:91,getMarkupBetweenPoints:92},[-1,-1,-1,-1,-1,-1])}}function py(t,e,n){let r=t.slice();return r[10]=e[n],r}function px(t){let e,n,r=t[2],o=pw(t);return{c(){o.c(),e=oP()},m(t,r){o.m(t,r),oS(t,e,r),n=!0},p(t,n){4&n&&ou(r,r=t[2])?(o8(),at(o,1,1,oi),o7(),(o=pw(t)).c(),o9(o),o.m(e.parentNode,e)):o.p(t,n)},i(t){n||(o9(o),n=!0)},o(t){at(o),n=!1},d(t){t&&oA(e),o.d(t)}}}function pb(t,e){let n,r,o,a,l,s,c;let u=ut(e[10].componentProps.title,e[0])+"",d=[e[10].componentProps];var h=e[10].component;function p(t){let e={};for(let t=0;t<d.length;t+=1)e=oo(e,d[t]);return{props:e}}return h&&(l=new h(p())),{key:t,first:null,c(){n=oE("li"),r=oE("span"),o=oR(u),a=oI(),l&&au(l.$$.fragment),s=oI(),oL(r,"class","DokaShapeStyleLabel"),oL(n,"class","DokaShapeStyle"),this.first=n},m(t,e){oS(t,n,e),oM(n,r),oM(r,o),oM(n,a),l&&ad(l,n,null),oM(n,s),c=!0},p(t,e){(!c||9&e)&&u!==(u=ut(t[10].componentProps.title,t[0])+"")&&oB(o,u);let r=8&e?al(d,[as(t[10].componentProps)]):{};if(h!==(h=t[10].component)){if(l){o8();let t=l;at(t.$$.fragment,1,0,()=>{ah(t,1)}),o7()}h?(au((l=new h(p())).$$.fragment),o9(l.$$.fragment,1),ad(l,n,s)):l=null}else h&&l.$set(r)},i(t){c||(l&&o9(l.$$.fragment,t),c=!0)},o(t){l&&at(l.$$.fragment,t),c=!1},d(t){t&&oA(n),l&&ah(l)}}}function pv(t){let e,n,r;let o=[],a=new Map,l=t[3],s=t=>t[10].id;for(let e=0;e<l.length;e+=1){let n=py(t,l,e),r=s(n);a.set(r,o[e]=pb(r,n))}return{c(){e=oE("ul");for(let t=0;t<o.length;t+=1)o[t].c();oL(e,"class","DokaShapeStyleList")},m(t,n){oS(t,e,n);for(let t=0;t<o.length;t+=1)o[t].m(e,null);r=!0},p(t,n){if(9&n){let r=t[3];o8(),o=aa(o,n,s,1,t,r,a,e,ao,pb,null,py),o7()}},i(t){if(!r){for(let t=0;t<l.length;t+=1)o9(o[t]);o0(()=>{n||(n=an(e,sz,{duration:250},!0)),n.run(1)}),r=!0}},o(t){for(let t=0;t<o.length;t+=1)at(o[t]);n||(n=an(e,sz,{duration:250},!1)),n.run(0),r=!1},d(t){t&&oA(e);for(let t=0;t<o.length;t+=1)o[t].d();t&&n&&n.end()}}}function pw(t){let e,n;return e=new s_({props:{class:"DokaShapeStyles",elasticity:t[1],$$slots:{default:[pv]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};2&n&&(r.elasticity=t[1]),8201&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function pk(t){let e,n;let r=t[2]&&px(t);return{c(){e=oE("div"),r&&r.c(),oL(e,"class","DokaShapeStyleEditor")},m(t,o){oS(t,e,o),r&&r.m(e,null),n=!0},p(t,n){let[o]=n;t[2]?r?(r.p(t,o),4&o&&o9(r,1)):((r=px(t)).c(),o9(r,1),r.m(e,null)):r&&(o8(),at(r,1,1,()=>{r=null}),o7())},i(t){n||(o9(r),n=!0)},o(t){at(r),n=!1},d(t){t&&oA(e),r&&r.d()}}}function pC(t,e,n){let r,o,a,l,{controls:s={}}=e,{shape:c}=e,{onchange:u}=e,{locale:d}=e,{scrollElasticity:h}=e,p=t=>{let e=t.id||"tool",n=a.filter(e=>e.split("_").every(e=>t.hasOwnProperty(e)&&i0(t,e))).map(n=>{let r=n.split("_"),o=r.length>1?r.map(e=>t[e]):t[n],[a,l]=s[n],c=nJ(l.options)?l.options(t):l.options;return{id:"".concat(e,"_").concat(n),component:a,componentProps:{...l,options:c,locale:d,value:o,optionLabelClass:"DokaButtonLabel",onchange:e=>{let o=nq(e)&&!n0(e)?e.value:e;l.onchange&&l.onchange(o,t);let a=r.length>1?r.reduce((t,e,n)=>({...t,[e]:Array.isArray(o)?o[n]:o}),{}):{[n]:o};u(a)}}}});return n};return t.$$set=t=>{"controls"in t&&n(4,s=t.controls),"shape"in t&&n(5,c=t.shape),"onchange"in t&&n(6,u=t.onchange),"locale"in t&&n(0,d=t.locale),"scrollElasticity"in t&&n(1,h=t.scrollElasticity)},t.$$.update=()=>{if(16&t.$$.dirty&&n(8,a=Object.keys(s).filter(t=>s[t])),288&t.$$.dirty&&n(3,l=c&&a&&i0(c)?p(c):[]),160&t.$$.dirty&&c){let t=Object.keys(c).join("_");t!=o&&(n(7,o=t),n(2,r=t))}},[d,h,r,l,s,c,u]}class pM extends af{constructor(t){super(),ap(this,t,pC,pk,ou,{controls:4,shape:5,onchange:6,locale:0,scrollElasticity:1})}}function pS(t){let e,n;return e=new sb({props:{width:16,height:16,$$slots:{default:[pA]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};65&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function pA(t){let e;let n=t[0].shapeIconButtonSelectSticker+"";return{c(){e=oT("g")},m(t,r){oS(t,e,r),e.innerHTML=n},p(t,r){1&r&&n!==(n=t[0].shapeIconButtonSelectSticker+"")&&(e.innerHTML=n)},d(t){t&&oA(e)}}}function pE(t){let e,n;let r=t[0].shapeLabelButtonSelectSticker+"";return{c(){e=oE("span"),n=oR(r)},m(t,r){oS(t,e,r),oM(e,n)},p(t,e){1&e&&r!==(r=t[0].shapeLabelButtonSelectSticker+"")&&oB(n,r)},d(t){t&&oA(e)}}}function pT(t){let e,n,r,o,a,l,s,c;let u=t[0].shapeIconButtonSelectSticker&&pS(t),d=t[0].shapeLabelButtonSelectSticker&&pE(t);return{c(){e=oE("form"),n=oE("input"),r=oI(),o=oE("label"),u&&u.c(),a=oI(),d&&d.c(),oL(n,"id",t[2]),oL(n,"type","file"),oL(n,"accept","image/*"),oL(o,"for",t[2]),oL(e,"class","DokaShapePresetSelect")},m(h,p){oS(h,e,p),oM(e,n),oM(e,r),oM(e,o),u&&u.m(o,null),oM(o,a),d&&d.m(o,null),t[5](e),l=!0,s||(c=oD(n,"input",t[3]),s=!0)},p(t,e){let[n]=e;t[0].shapeIconButtonSelectSticker?u?(u.p(t,n),1&n&&o9(u,1)):((u=pS(t)).c(),o9(u,1),u.m(o,a)):u&&(o8(),at(u,1,1,()=>{u=null}),o7()),t[0].shapeLabelButtonSelectSticker?d?d.p(t,n):((d=pE(t)).c(),d.m(o,null)):d&&(d.d(1),d=null)},i(t){l||(o9(u),l=!0)},o(t){at(u),l=!1},d(n){n&&oA(e),u&&u.d(),d&&d.d(),t[5](null),s=!1,c()}}}function pR(t,e,n){let r,{locale:o}=e,{oninput:a}=e,l="doka-preset-select-".concat(tx());return t.$$set=t=>{"locale"in t&&n(0,o=t.locale),"oninput"in t&&n(4,a=t.oninput)},[o,r,l,t=>{Array.from(t.target.files).filter(lk).forEach(a),r.reset()},a,function(t){oK[t?"unshift":"push"](()=>{n(1,r=t)})}]}class pI extends af{constructor(t){super(),ap(this,t,pR,pT,ou,{locale:0,oninput:4})}}function pP(t){let e,n,r;return{c(){oL(e=oE("button"),"class","DokaDragButton"),oL(e,"title",t[1]),e.disabled=t[2]},m(o,a){oS(o,e,a),e.innerHTML=t[0],t[9](e),n||(r=oD(e,"pointerdown",t[4]),n=!0)},p(t,n){let[r]=n;1&r&&(e.innerHTML=t[0]),2&r&&oL(e,"title",t[1]),4&r&&(e.disabled=t[2])},i:oi,o:oi,d(o){o&&oA(e),t[9](null),n=!1,r()}}}function pD(t,e,n){let r,o,{html:a}=e,{title:l}=e,{onclick:s}=e,{disabled:c=!1}=e,{ongrab:u=J}=e,{ondrag:d=J}=e,{ondrop:h=J}=e,p=t=>256>et(o,tH(t.pageX,t.pageY)),f=t=>{document.documentElement.removeEventListener("pointermove",g),document.documentElement.removeEventListener("pointerup",f);let e=tH(t.pageX,t.pageY);if(32>et(o,e))return s(t);p(t)||h(t)},g=t=>{p(t)||d(t)};return t.$$set=t=>{"html"in t&&n(0,a=t.html),"title"in t&&n(1,l=t.title),"onclick"in t&&n(5,s=t.onclick),"disabled"in t&&n(2,c=t.disabled),"ongrab"in t&&n(6,u=t.ongrab),"ondrag"in t&&n(7,d=t.ondrag),"ondrop"in t&&n(8,h=t.ondrop)},[a,l,c,r,t=>{o=tH(t.pageX,t.pageY),u(t),document.documentElement.addEventListener("pointermove",g),document.documentElement.addEventListener("pointerup",f)},s,u,d,h,function(t){oK[t?"unshift":"push"](()=>{n(3,r=t)})}]}class pL extends af{constructor(t){super(),ap(this,t,pD,pP,ou,{html:0,title:1,onclick:5,disabled:2,ongrab:6,ondrag:7,ondrop:8})}}function pF(t,e,n){let r=t.slice();return r[14]=e[n],r}function pB(t,e){let n,r,o,a,l,s,c;function u(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e[9](e[14],...n)}function d(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e[10](e[14],...n)}function h(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e[11](e[14],...n)}function p(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return e[12](e[14],...n)}return r=new pL({props:{onclick:u,ongrab:d,ondrag:h,ondrop:p,disabled:e[1]||e[14].disabled,title:e[14].title,html:e[14].thumb}}),{key:t,first:null,c(){n=oE("li"),au(r.$$.fragment),o=oI(),oL(n,"class","DokaShapePreset"),oL(n,"style",e[6]),this.first=n},m(t,u){oS(t,n,u),ad(r,n,null),oM(n,o),l=!0,s||(c=ox(a=e[8].call(null,n,e[14])),s=!0)},p(t,o){e=t;let s={};5&o&&(s.onclick=u),9&o&&(s.ongrab=d),17&o&&(s.ondrag=h),33&o&&(s.ondrop=p),3&o&&(s.disabled=e[1]||e[14].disabled),1&o&&(s.title=e[14].title),1&o&&(s.html=e[14].thumb),r.$set(s),(!l||64&o)&&oL(n,"style",e[6]),a&&oc(a.update)&&1&o&&a.update.call(null,e[14])},i(t){l||(o9(r.$$.fragment,t),l=!0)},o(t){at(r.$$.fragment,t),l=!1},d(t){t&&oA(n),ah(r),s=!1,c()}}}function pO(t){let e,n;let r=[],o=new Map,a=t[0],l=t=>t[14].id;for(let e=0;e<a.length;e+=1){let n=pF(t,a,e),s=l(n);o.set(s,r[e]=pB(s,n))}return{c(){e=oE("ul");for(let t=0;t<r.length;t+=1)r[t].c();oL(e,"class","DokaShapePresetsList")},m(t,o){oS(t,e,o);for(let t=0;t<r.length;t+=1)r[t].m(e,null);n=!0},p(t,n){let[a]=n;if(127&a){let n=t[0];o8(),r=aa(r,a,l,1,t,n,o,e,ao,pB,null,pF),o7()}},i(t){if(!n){for(let t=0;t<a.length;t+=1)o9(r[t]);n=!0}},o(t){for(let t=0;t<r.length;t+=1)at(r[t]);n=!1},d(t){t&&oA(e);for(let t=0;t<r.length;t+=1)r[t].d()}}}function pj(t,e,n){let r,o;let{presets:a}=e,{disabled:l}=e,{onclickpreset:s}=e,{ongrabpreset:c}=e,{ondragpreset:u}=e,{ondroppreset:d}=e,h=lc(0,{duration:300});return op(t,h,t=>n(13,r=t)),oU(()=>h.set(1)),t.$$set=t=>{"presets"in t&&n(0,a=t.presets),"disabled"in t&&n(1,l=t.disabled),"onclickpreset"in t&&n(2,s=t.onclickpreset),"ongrabpreset"in t&&n(3,c=t.ongrabpreset),"ondragpreset"in t&&n(4,u=t.ondragpreset),"ondroppreset"in t&&n(5,d=t.ondroppreset)},t.$$.update=()=>{8192&t.$$.dirty&&n(6,o="opacity:".concat(r))},[a,l,s,c,u,d,o,h,(t,e)=>e.mount&&e.mount(t.firstChild,e),t=>s(t.id),(t,e)=>c(t.id,e),(t,e)=>u(t.id,e),(t,e)=>d(t.id,e)]}class p_ extends af{constructor(t){super(),ap(this,t,pj,pO,ou,{presets:0,disabled:1,onclickpreset:2,ongrabpreset:3,ondragpreset:4,ondroppreset:5})}}var pz=t=>/<svg /.test(t);function pN(t){let e,n;return e=new pI({props:{locale:t[0],oninput:t[3]}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};1&n&&(r.locale=t[0]),8&n&&(r.oninput=t[3]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function pU(t){let e,n,r,o;let a=[pX,pW],l=[];return n=l[e=t[9]?0:1]=a[e](t),{c(){n.c(),r=oP()},m(t,n){l[e].m(t,n),oS(t,r,n),o=!0},p(t,o){let s=e;(e=t[9]?0:1)===s?l[e].p(t,o):(o8(),at(l[s],1,1,()=>{l[s]=null}),o7(),(n=l[e])||(n=l[e]=a[e](t)).c(),o9(n,1),n.m(r.parentNode,r))},i(t){o||(o9(n),o=!0)},o(t){at(n),o=!1},d(t){l[e].d(t),t&&oA(r)}}}function pW(t){let e,n,r,o;let a=t[2]&&pV(t);return r=new s_({props:{scrollAutoCancel:t[8],elasticity:t[1],$$slots:{default:[pH]},$$scope:{ctx:t}}}),{c(){e=oE("div"),a&&a.c(),n=oI(),au(r.$$.fragment),oL(e,"class","DokaShapePresetsFlat")},m(t,l){oS(t,e,l),a&&a.m(e,null),oM(e,n),ad(r,e,null),o=!0},p(t,o){t[2]?a?(a.p(t,o),4&o&&o9(a,1)):((a=pV(t)).c(),o9(a,1),a.m(e,n)):a&&(o8(),at(a,1,1,()=>{a=null}),o7());let l={};256&o&&(l.scrollAutoCancel=t[8]),2&o&&(l.elasticity=t[1]),268435704&o&&(l.$$scope={dirty:o,ctx:t}),r.$set(l)},i(t){o||(o9(a),o9(r.$$.fragment,t),o=!0)},o(t){at(a),at(r.$$.fragment,t),o=!1},d(t){t&&oA(e),a&&a.d(),ah(r)}}}function pX(t){let e,n,r,o,a,l,s;let c=t[2]&&pY(t),u=[{class:"DokaControlList"},{tabs:t[10]},t[13],{layout:"compact"}],d={$$slots:{default:[pZ,t=>{let{tab:e}=t;return{27:e}},t=>{let{tab:e}=t;return e?134217728:0}]},$$scope:{ctx:t}};for(let t=0;t<u.length;t+=1)d=oo(d,u[t]);(o=new sl({props:d})).$on("select",t[16]);let h=[{class:"DokaControlPanels"},{panelClass:"DokaControlPanel"},{panels:t[14]},t[13]],p={$$slots:{default:[pJ,t=>{let{panel:e,panelIsActive:n}=t;return{25:e,26:n}},t=>{let{panel:e,panelIsActive:n}=t;return(e?33554432:0)|(n?67108864:0)}]},$$scope:{ctx:t}};for(let t=0;t<h.length;t+=1)p=oo(p,h[t]);return l=new sf({props:p}),{c(){e=oE("div"),n=oE("div"),c&&c.c(),r=oI(),au(o.$$.fragment),a=oI(),au(l.$$.fragment),oL(n,"class","DokaShapePresetsGroups"),oL(e,"class","DokaShapePresetsGrouped")},m(t,u){oS(t,e,u),oM(e,n),c&&c.m(n,null),oM(n,r),ad(o,n,null),oM(e,a),ad(l,e,null),s=!0},p(t,e){t[2]?c?(c.p(t,e),4&e&&o9(c,1)):((c=pY(t)).c(),o9(c,1),c.m(n,r)):c&&(o8(),at(c,1,1,()=>{c=null}),o7());let a=9216&e?al(u,[u[0],1024&e&&{tabs:t[10]},8192&e&&as(t[13]),u[3]]):{};402653184&e&&(a.$$scope={dirty:e,ctx:t}),o.$set(a);let s=24576&e?al(h,[h[0],h[1],16384&e&&{panels:t[14]},8192&e&&as(t[13])]):{};369101178&e&&(s.$$scope={dirty:e,ctx:t}),l.$set(s)},i(t){s||(o9(c),o9(o.$$.fragment,t),o9(l.$$.fragment,t),s=!0)},o(t){at(c),at(o.$$.fragment,t),at(l.$$.fragment,t),s=!1},d(t){t&&oA(e),c&&c.d(),ah(o),ah(l)}}}function pV(t){let e,n;return e=new pI({props:{locale:t[0],oninput:t[3]}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};1&n&&(r.locale=t[0]),8&n&&(r.oninput=t[3]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function pH(t){let e,n;return e=new p_({props:{presets:t[7],onclickpreset:t[3],ongrabpreset:t[4],ondragpreset:t[5],ondroppreset:t[6]}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};128&n&&(r.presets=t[7]),8&n&&(r.onclickpreset=t[3]),16&n&&(r.ongrabpreset=t[4]),32&n&&(r.ondragpreset=t[5]),64&n&&(r.ondroppreset=t[6]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function pY(t){let e,n;return e=new pI({props:{locale:t[0],oninput:t[3]}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};1&n&&(r.locale=t[0]),8&n&&(r.oninput=t[3]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function pG(t){let e,n;return e=new sb({props:{$$slots:{default:[pK]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};402653184&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function pK(t){let e;let n=t[27].icon+"";return{c(){e=oT("g")},m(t,r){oS(t,e,r),e.innerHTML=n},p(t,r){134217728&r&&n!==(n=t[27].icon+"")&&(e.innerHTML=n)},d(t){t&&oA(e)}}}function pq(t){let e,n;let r=t[27].label+"";return{c(){e=oE("span"),n=oR(r)},m(t,r){oS(t,e,r),oM(e,n)},p(t,e){134217728&e&&r!==(r=t[27].label+"")&&oB(n,r)},d(t){t&&oA(e)}}}function pZ(t){let e,n,r;let o=t[27].icon&&pG(t),a=!t[27].hideLabel&&pq(t);return{c(){o&&o.c(),e=oI(),a&&a.c(),n=oP()},m(t,l){o&&o.m(t,l),oS(t,e,l),a&&a.m(t,l),oS(t,n,l),r=!0},p(t,r){t[27].icon?o?(o.p(t,r),134217728&r&&o9(o,1)):((o=pG(t)).c(),o9(o,1),o.m(e.parentNode,e)):o&&(o8(),at(o,1,1,()=>{o=null}),o7()),t[27].hideLabel?a&&(a.d(1),a=null):a?a.p(t,r):((a=pq(t)).c(),a.m(n.parentNode,n))},i(t){r||(o9(o),r=!0)},o(t){at(o),r=!1},d(t){o&&o.d(t),t&&oA(e),a&&a.d(t),t&&oA(n)}}}function pQ(t){let e,n;return e=new p_({props:{presets:t[11][t[25]].items,disabled:t[11][t[25]].disabled,onclickpreset:t[3],ongrabpreset:t[4],ondragpreset:t[5],ondroppreset:t[6]}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};33556480&n&&(r.presets=t[11][t[25]].items),33556480&n&&(r.disabled=t[11][t[25]].disabled),8&n&&(r.onclickpreset=t[3]),16&n&&(r.ongrabpreset=t[4]),32&n&&(r.ondragpreset=t[5]),64&n&&(r.ondroppreset=t[6]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function pJ(t){let e,n;return e=new s_({props:{scroll:t[26]?{scrollOffset:0,animate:!1}:void 0,scrollAutoCancel:t[8],elasticity:t[1],$$slots:{default:[pQ]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};67108864&n&&(r.scroll=t[26]?{scrollOffset:0,animate:!1}:void 0),256&n&&(r.scrollAutoCancel=t[8]),2&n&&(r.elasticity=t[1]),301992056&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function p0(t){let e,n,r,o;let a=[pU,pN],l=[];function s(t,e){return t[8]?0:t[2]?1:-1}return~(n=s(t))&&(r=l[n]=a[n](t)),{c(){e=oE("div"),r&&r.c(),oL(e,"class","DokaShapePresetsPalette")},m(t,r){oS(t,e,r),~n&&l[n].m(e,null),o=!0},p(t,o){let[c]=o,u=n;(n=s(t))===u?~n&&l[n].p(t,c):(r&&(o8(),at(l[u],1,1,()=>{l[u]=null}),o7()),~n?((r=l[n])||(r=l[n]=a[n](t)).c(),o9(r,1),r.m(e,null)):r=null)},i(t){o||(o9(r),o=!0)},o(t){at(r),o=!1},d(t){t&&oA(e),~n&&l[n].d()}}}function p1(t,e,n){let r,o,a,l,s,c,u,d,{locale:h}=e,{presets:p}=e,{scrollElasticity:f}=e,{enableSelectImage:g=!0}=e,{onaddpreset:m=J}=e,{ongrabpreset:$=J}=e,{ondragpreset:y=J}=e,{ondroppreset:x=J}=e,b="doka-presets-".concat(tx()),v=t=>n0(t)&&ne(t[0])&&n0(t[1]),w=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return pz(t)?t:nG(t)?ie(t,e):'<img src="'.concat(t,'" alt="').concat(e,'"/>')},k=t=>tR(ni(t)),C=["src","alt","thumb","shape","id","mount","disabled"],M=t=>{let e,n,r,o,a,l,s;return ne(t)?nG(t)?o=w(e=t,a=t):(a=k(e=t),o=w(e,a)):(e=t.src,a=t.alt||(ne(e)?k(e):ne(t.thumb)?k(t.thumb):void 0),o=w(t.thumb||e,a),n=t.shape,l=t.mount,s=t.disabled,r=Object.keys(t).reduce((e,n)=>(C.includes(n)||(e[n]=t[n]),e),{})),{id:t,src:e,thumb:o,shape:n,shapeProps:r,alt:a,title:a,mount:l,disabled:s}},S=t=>t.map(t=>v(t)?{...t[2],id:"".concat(b,"-").concat(t[0].toLowerCase()),label:t[0],items:S(t[1])}:M(t));return t.$$set=t=>{"locale"in t&&n(0,h=t.locale),"presets"in t&&n(15,p=t.presets),"scrollElasticity"in t&&n(1,f=t.scrollElasticity),"enableSelectImage"in t&&n(2,g=t.enableSelectImage),"onaddpreset"in t&&n(3,m=t.onaddpreset),"ongrabpreset"in t&&n(4,$=t.ongrabpreset),"ondragpreset"in t&&n(5,y=t.ondragpreset),"ondroppreset"in t&&n(6,x=t.ondroppreset)},t.$$.update=()=>{32768&t.$$.dirty&&n(7,r=S(p)),128&t.$$.dirty&&n(8,o=r.length),384&t.$$.dirty&&n(9,a=o&&r.some(t=>!!t.items)),640&t.$$.dirty&&n(10,l=a&&r),640&t.$$.dirty&&n(11,s=a&&r.reduce((t,e)=>(t[e.id]=e,t),{})),5120&t.$$.dirty&&n(12,c=c||l&&(l.find(t=>!t.disabled)||{}).id),4096&t.$$.dirty&&n(13,u={name:b,selected:c}),1024&t.$$.dirty&&n(14,d=l&&l.map(t=>t.id))},[h,f,g,m,$,y,x,r,o,a,l,s,c,u,d,p,t=>{let{detail:e}=t;return n(12,c=e)}]}class p2 extends af{constructor(t){super(),ap(this,t,p1,p0,ou,{locale:0,presets:15,scrollElasticity:1,enableSelectImage:2,onaddpreset:3,ongrabpreset:4,ondragpreset:5,ondroppreset:6})}}var p4=t=>(e,n)=>{t.dispatchEvent(new CustomEvent("ping",{detail:{type:e,data:n},cancelable:!0,bubbles:!0}))};function p5(t){let e,n,r,o;let a=[{locale:t[4]},{parentRect:t[27]},{rootRect:t[18]},{stageRect:t[22]},{utilRect:t[21]},{offset:t[20]},{scale:t[32]},{rotation:t[12]},{opacity:t[26]},{enableButtonFlipVertical:t[7]},{mapEditorPointToImagePoint:t[10]},{mapImagePointToEditorPoint:t[11]},{oninteractionstart:t[41]},{oninteractionupdate:t[42]},{oninteractionrelease:t[43]},{oninteractionend:t[44]},{onaddshape:t[59]},{onselectshape:t[60]},{onupdateshape:t[61]},{onremoveshape:t[62]},t[14]];function l(e){t[64].call(null,e)}function s(e){t[65].call(null,e)}let c={};for(let t=0;t<a.length;t+=1)c=oo(c,a[t]);return void 0!==t[23]&&(c.markup=t[23]),void 0!==t[31]&&(c.ui=t[31]),e=new p$({props:c}),t[63](e),oK.push(()=>ac(e,"markup",l)),oK.push(()=>ac(e,"ui",s)),e.$on("measure",t[66]),{c(){au(e.$$.fragment)},m(t,n){ad(e,t,n),o=!0},p(t,o){let l=477387920&o[0]|1063938&o[1]?al(a,[16&o[0]&&{locale:t[4]},134217728&o[0]&&{parentRect:t[27]},262144&o[0]&&{rootRect:t[18]},4194304&o[0]&&{stageRect:t[22]},2097152&o[0]&&{utilRect:t[21]},1048576&o[0]&&{offset:t[20]},2&o[1]&&{scale:t[32]},4096&o[0]&&{rotation:t[12]},67108864&o[0]&&{opacity:t[26]},128&o[0]&&{enableButtonFlipVertical:t[7]},1024&o[0]&&{mapEditorPointToImagePoint:t[10]},2048&o[0]&&{mapImagePointToEditorPoint:t[11]},1024&o[1]&&{oninteractionstart:t[41]},2048&o[1]&&{oninteractionupdate:t[42]},4096&o[1]&&{oninteractionrelease:t[43]},8192&o[1]&&{oninteractionend:t[44]},268435456&o[0]|1048576&o[1]&&{onaddshape:t[59]},268435456&o[0]&&{onselectshape:t[60]},268435456&o[0]|1048576&o[1]&&{onupdateshape:t[61]},268435456&o[0]|1048576&o[1]&&{onremoveshape:t[62]},16384&o[0]&&as(t[14])]):{};!n&&8388608&o[0]&&(n=!0,l.markup=t[23],o1(()=>n=!1)),!r&&1&o[1]&&(r=!0,l.ui=t[31],o1(()=>r=!1)),e.$set(l)},i(t){o||(o9(e.$$.fragment,t),o=!0)},o(t){at(e.$$.fragment,t),o=!1},d(n){t[63](null),ah(e,n)}}}function p3(t){let e,n,r,o;let a=t[19]&&p5(t);return{c(){e=oE("div"),a&&a.c(),oL(e,"slot","main"),function(t,e,n,r){t.style.setProperty(e,n,"")}(e,"cursor","crosshair")},m(l,s){oS(l,e,s),a&&a.m(e,null),t[67](e),n=!0,r||(o=[ox(lM.call(null,e)),oD(e,"dropfiles",t[50])],r=!0)},p(t,n){t[19]?a?(a.p(t,n),524288&n[0]&&o9(a,1)):((a=p5(t)).c(),o9(a,1),a.m(e,null)):a&&(o8(),at(a,1,1,()=>{a=null}),o7())},i(t){n||(o9(a),n=!0)},o(t){at(a),n=!1},d(n){n&&oA(e),a&&a.d(),t[67](null),r=!1,os(o)}}}function p6(t){let e,n;return e=new p2({props:{locale:t[4],presets:t[9],enableSelectImage:t[8],onaddpreset:t[49],ongrabpreset:t[46],ondragpreset:t[47],ondroppreset:t[48],scrollElasticity:t[29]}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};16&n[0]&&(r.locale=t[4]),512&n[0]&&(r.presets=t[9]),256&n[0]&&(r.enableSelectImage=t[8]),536870912&n[0]&&(r.scrollElasticity=t[29]),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function p8(t){let e,n,r,o,a,l;let s=[p9,p7],c=[];return r=c[n=t[25]?0:1]=s[n](t),a=new s_({props:{class:"DokaControlListScroller",elasticity:t[29],$$slots:{default:[fi]},$$scope:{ctx:t}}}),{c(){e=oE("div"),r.c(),o=oI(),au(a.$$.fragment),oL(e,"class","DokaControlPanels")},m(t,r){oS(t,e,r),c[n].m(e,null),oS(t,o,r),ad(a,t,r),l=!0},p(t,o){let l=n;(n=t[25]?0:1)===l?c[n].p(t,o):(o8(),at(c[l],1,1,()=>{c[l]=null}),o7(),(r=c[n])||(r=c[n]=s[n](t)).c(),o9(r,1),r.m(e,null));let u={};536870912&o[0]&&(u.elasticity=t[29]),131089&o[0]|268435456&o[2]&&(u.$$scope={dirty:o,ctx:t}),a.$set(u)},i(t){l||(o9(r),o9(a.$$.fragment,t),l=!0)},o(t){at(r),at(a.$$.fragment,t),l=!1},d(t){t&&oA(e),c[n].d(),t&&oA(o),ah(a,t)}}}function p7(t){let e,n,r;return n=new pM({props:{locale:t[4],shape:t[24],onchange:t[45],controls:t[6],scrollElasticity:t[29]}}),{c(){e=oE("div"),au(n.$$.fragment),oL(e,"class","DokaControlPanel")},m(t,o){oS(t,e,o),ad(n,e,null),r=!0},p(t,e){let r={};16&e[0]&&(r.locale=t[4]),16777216&e[0]&&(r.shape=t[24]),64&e[0]&&(r.controls=t[6]),536870912&e[0]&&(r.scrollElasticity=t[29]),n.$set(r)},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n)}}}function p9(t){let e,n,r;return n=new p2({props:{locale:t[4],presets:t[9],enableSelectImage:t[8],onaddpreset:t[49],ongrabpreset:t[46],ondragpreset:t[47],ondroppreset:t[48],scrollElasticity:t[29]}}),{c(){e=oE("div"),au(n.$$.fragment),oL(e,"class","DokaControlPanel")},m(t,o){oS(t,e,o),ad(n,e,null),r=!0},p(t,e){let r={};16&e[0]&&(r.locale=t[4]),512&e[0]&&(r.presets=t[9]),256&e[0]&&(r.enableSelectImage=t[8]),536870912&e[0]&&(r.scrollElasticity=t[29]),n.$set(r)},i(t){r||(o9(n.$$.fragment,t),r=!0)},o(t){at(n.$$.fragment,t),r=!1},d(t){t&&oA(e),ah(n)}}}function ft(t){let e,n;return e=new sb({props:{$$slots:{default:[fe]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};16&n[0]|402653184&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function fe(t){let e;let n=(nJ(t[89].icon)?t[89].icon(t[4]):t[89].icon)+"";return{c(){e=oT("g")},m(t,r){oS(t,e,r),e.innerHTML=n},p(t,r){16&r[0]|134217728&r[2]&&n!==(n=(nJ(t[89].icon)?t[89].icon(t[4]):t[89].icon)+"")&&(e.innerHTML=n)},d(t){t&&oA(e)}}}function fn(t){let e,n,r,o,a;let l=(nJ(t[89].label)?t[89].label(t[4]):t[89].label)+"",s=t[89].icon&&ft(t);return{c(){e=oE("div"),s&&s.c(),n=oI(),r=oE("span"),o=oR(l),oL(e,"slot","option")},m(t,l){oS(t,e,l),s&&s.m(e,null),oM(e,n),oM(e,r),oM(r,o),a=!0},p(t,r){t[89].icon?s?(s.p(t,r),134217728&r[2]&&o9(s,1)):((s=ft(t)).c(),o9(s,1),s.m(e,n)):s&&(o8(),at(s,1,1,()=>{s=null}),o7()),(!a||16&r[0]|134217728&r[2])&&l!==(l=(nJ(t[89].label)?t[89].label(t[4]):t[89].label)+"")&&oB(o,l)},i(t){a||(o9(s),a=!0)},o(t){at(s),a=!1},d(t){t&&oA(e),s&&s.d()}}}function fi(t){let e,n;return e=new uA({props:{locale:t[4],class:"DokaControlList",optionClass:"DokaControlListOption",layout:"row",options:t[17],selectedIndex:t[17].findIndex(t[68]),onchange:t[40],$$slots:{option:[fn,t=>{let{option:e}=t;return{89:e}},t=>{let{option:e}=t;return[0,0,e?134217728:0]}]},$$scope:{ctx:t}}}),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};16&n[0]&&(r.locale=t[4]),131072&n[0]&&(r.options=t[17]),131073&n[0]&&(r.selectedIndex=t[17].findIndex(t[68])),16&n[0]|402653184&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function fr(t){let e,n,r,o;let a=[p8,p6],l=[];function s(t,e){return t[17].length?0:t[25]?1:-1}return~(n=s(t))&&(r=l[n]=a[n](t)),{c(){e=oE("div"),r&&r.c(),oL(e,"slot","footer"),oL(e,"style",t[30])},m(t,r){oS(t,e,r),~n&&l[n].m(e,null),o=!0},p(t,c){let u=n;(n=s(t))===u?~n&&l[n].p(t,c):(r&&(o8(),at(l[u],1,1,()=>{l[u]=null}),o7()),~n?((r=l[n])||(r=l[n]=a[n](t)).c(),o9(r,1),r.m(e,null)):r=null),(!o||1073741824&c[0])&&oL(e,"style",t[30])},i(t){o||(o9(r),o=!0)},o(t){at(r),o=!1},d(t){t&&oA(e),~n&&l[n].d()}}}function fo(t){let e;return{c(){e=oI()},m(t,n){oS(t,e,n)},p:oi,i:oi,o:oi,d(t){t&&oA(e)}}}function fa(t){let e,n;return(e=new dQ({props:{$$slots:{default:[fo],footer:[fr],main:[p3]},$$scope:{ctx:t}}})).$on("measure",t[69]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};2147475409&n[0]|3&n[1]|268435456&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function fl(t,e,n){let r,o,a,l,s,c,u,d,h,p,f,g,m,$,y,x,b,v,w,k,C,M,S;let A,E=oi,T=()=>(E(),E=od(U,t=>n(73,A=t)),U),R,I=oi,P=()=>(I(),I=od(X,t=>n(76,R=t)),X),D,L=oi,F=()=>(L(),L=od(Y,t=>n(23,D=t)),Y),B,O=oi,j=()=>(O(),O=od(W,t=>n(26,B=t)),W),_,z=oi,N=()=>(z(),z=od(tl,t=>n(27,_=t)),tl);t.$$.on_destroy.push(()=>E()),t.$$.on_destroy.push(()=>I()),t.$$.on_destroy.push(()=>L()),t.$$.on_destroy.push(()=>O()),t.$$.on_destroy.push(()=>z());let{isActive:U}=e;T();let{isActiveFraction:W}=e;j();let{isVisible:X}=e;P();let{stores:V}=e,{locale:H={}}=e,{shapes:Y=[]}=e;F();let{tools:G=[]}=e,{toolShapes:K=[]}=e,{toolActive:q="sharpie"}=e,{shapeControls:Z=[]}=e,{enableButtonFlipVertical:Q=!1}=e,{enablePresetSelectImage:J=!0}=e,{shapePresets:tt=[]}=e,{utilKey:te}=e,{mapScreenPointToImagePoint:tn}=e,{mapImagePointToScreenPoint:ti}=e,{imageRotation:tr=0}=e,{imageFlipX:to=!1}=e,{imageFlipY:ta=!1}=e,{parentRect:tl}=e;N();let{hooks:ts={}}=e,{history:tc,rootRect:tu,stageRect:td,utilRect:th,elasticityMultiplier:tp,scrollElasticity:tf,imageOverlayMarkup:tg,imagePreviewModifiers:tm,imageCropRect:t$,presentationScalar:ty}=V;op(t,tu,t=>n(18,r=t)),op(t,td,t=>n(22,l=t)),op(t,th,t=>n(21,a=t)),op(t,tg,t=>n(31,u=t)),op(t,tm,t=>n(74,o=t)),op(t,t$,t=>n(80,s=t)),op(t,ty,t=>n(32,d=t));let tx=t=>tn(pe(t,r)),tb={},tv=(t,e)=>{let n=!1;if(e||(n=!0,e=eF(s)),e.x-=_.x||0,e.y-=_.y||0,0!==tr){let t={width:_.width,height:_.height};ef(t,tr);let n=(_.width-Math.abs(t.width))*.5,r=(_.height-Math.abs(t.height))*.5;e.x+=n,e.y+=r}let r=iT(t,s,(t,n)=>{if(D.find(t=>t.id===n.id)){if(t)return h.removeShape(n),console.error(t);iw(n,s),ik(n,e),D[D.length-1]===n&&h.selectShape(n)}});r.flipX=to,r.flipY=ta,r.rotation=0!==tr?-tr:0;let o=h.getShapesAtPosition(e),a=s.width,l=s.height;if(n&&o.length&&r.width<a&&r.height<l){let t=.1*Math.min(a,l);e.x+=Math.round(-t+Math.random()*t*2),e.y+=Math.round(-t+Math.random()*t*2)}return r.width&&r.height&&(iw(r,s),ik(r,e)),r},tw=(t,e)=>{let{beforeAddShape:n=()=>!0}=ts,r=tv(t,e);if(n(r))return h.addShape(r),tc.write(),r},tk=!1,tC=(t,e)=>t.forEach(t=>tw(t,e)),tM=()=>tc.write(),tS=lu(0);return op(t,tS,t=>n(81,c=t)),t.$$set=t=>{"isActive"in t&&T(n(1,U=t.isActive)),"isActiveFraction"in t&&j(n(2,W=t.isActiveFraction)),"isVisible"in t&&P(n(3,X=t.isVisible)),"stores"in t&&n(53,V=t.stores),"locale"in t&&n(4,H=t.locale),"shapes"in t&&F(n(5,Y=t.shapes)),"tools"in t&&n(54,G=t.tools),"toolShapes"in t&&n(55,K=t.toolShapes),"toolActive"in t&&n(0,q=t.toolActive),"shapeControls"in t&&n(6,Z=t.shapeControls),"enableButtonFlipVertical"in t&&n(7,Q=t.enableButtonFlipVertical),"enablePresetSelectImage"in t&&n(8,J=t.enablePresetSelectImage),"shapePresets"in t&&n(9,tt=t.shapePresets),"utilKey"in t&&n(56,te=t.utilKey),"mapScreenPointToImagePoint"in t&&n(10,tn=t.mapScreenPointToImagePoint),"mapImagePointToScreenPoint"in t&&n(11,ti=t.mapImagePointToScreenPoint),"imageRotation"in t&&n(12,tr=t.imageRotation),"imageFlipX"in t&&n(57,to=t.imageFlipX),"imageFlipY"in t&&n(58,ta=t.imageFlipY),"parentRect"in t&&N(n(13,tl=t.parentRect)),"hooks"in t&&n(14,ts=t.hooks)},t.$$.update=()=>{512&t.$$.dirty[0]|8388608&t.$$.dirty[1]&&n(17,g=0===tt.length?G.filter(t=>"preset"!==t[0]):G),33554432&t.$$.dirty[1]|6144&t.$$.dirty[2]&&(A?oy(tm,o[te]={maskMarkupOpacity:.85},o):delete o[te]),16384&t.$$.dirty[2]&&n(19,m=R),6291456&t.$$.dirty[0]&&n(20,$=a&&tH(l.x-a.x,l.y-a.y)),32769&t.$$.dirty[0]&&q&&h&&h.blurShapes(),64&t.$$.dirty[0]&&n(77,y=Object.keys(Z)),8388608&t.$$.dirty[0]&&n(78,x=(D.filter(iX)||[])[0]),1&t.$$.dirty[0]|16777216&t.$$.dirty[1]|2048&t.$$.dirty[2]&&n(79,b=A&&(K[q]?rg(iC(K[q][0])):{})),164096&t.$$.dirty[2]&&n(75,v=b&&Object.keys(b).reduce((t,e)=>{let n="disableStyle"===e,r=y.find(t=>t.split("_").includes(e));return(n||r)&&(t[e]=tb[e]||b[e]),t},{})),73728&t.$$.dirty[2]&&n(24,w=x||v),67109633&t.$$.dirty[0]&&n(25,k=B>0&&"preset"===q&&(tt.length>0||J)),65536&t.$$.dirty[0]&&n(28,C=f&&p4(f)),2048&t.$$.dirty[2]&&tS.set(A?0:20),524288&t.$$.dirty[2]&&n(30,S=c?"transform: translateY(".concat(c,"px)"):void 0)},n(29,M=tp*tf),[q,U,W,X,H,Y,Z,Q,J,tt,tn,ti,tr,tl,ts,h,f,g,r,m,$,a,l,D,w,k,B,_,C,M,S,u,d,tu,td,th,tg,tm,t$,ty,t=>{let{value:e}=t;return n(0,q=e)},t=>{if(K[q]){let[t,e]=K[q];p=h.createShape({...t,...v},e)}else p="eraser"===q?h.eraseShape():void 0;p&&p.start(t)},t=>{p&&p.update(t)},t=>{p&&p.release(t)},t=>{p&&(p.end(t),p=void 0)},function(t){Object.keys(t).forEach(e=>n(70,tb[e]=t[e],tb)),x&&(h.updateMarkupShape(x,t),tM())},(t,e)=>{tk=!1},(t,e)=>{if(tk)return;let{beforeAddShape:n=()=>!0}=ts,r=tx(e),o=h.getMarkupItemDraft(),a=eG(s,{x:r.x+(_.x||0),y:r.y+(_.y||0)});if(o&&!a&&h.discardMarkupItemDraft(),a){if(!o){let o=tv(t,r);if(!n(o)){tk=!0,e.preventDefault();return}iJ(o),h.addShape(o);return}h.updateMarkupShape(o,{x:r.x-.5*o.width,y:r.y-.5*o.height})}},(t,e)=>{if(tk)return;let n=tx(e);if(eG(s,{x:n.x+(_.x||0),y:n.y+(_.y||0)})){let t=h.confirmMarkupItemDraft();h.selectShape(t),tc.write()}else h.discardMarkupItemDraft()},t=>tw(t),t=>tC(t.detail.files,tx(t.detail.event)),tM,tS,V,G,K,te,to,ta,t=>{C("addshape",t),tM()},t=>{C("selectshape",t)},t=>{C("updateshape",t),tM()},t=>{C("removeshape",t),tM()},function(t){oK[t?"unshift":"push"](()=>{n(15,h=t)})},function(t){D=t,Y.set(D)},function(t){u=t,tg.set(u)},function(e){oY(t,e)},function(t){oK[t?"unshift":"push"](()=>{n(16,f=t)})},t=>t[0]===q,function(e){oY(t,e)}]}class fs extends af{get isActive(){return this.$$.ctx[1]}set isActive(t){this.$set({isActive:t}),o5()}get isActiveFraction(){return this.$$.ctx[2]}set isActiveFraction(t){this.$set({isActiveFraction:t}),o5()}get isVisible(){return this.$$.ctx[3]}set isVisible(t){this.$set({isVisible:t}),o5()}get stores(){return this.$$.ctx[53]}set stores(t){this.$set({stores:t}),o5()}get locale(){return this.$$.ctx[4]}set locale(t){this.$set({locale:t}),o5()}get shapes(){return this.$$.ctx[5]}set shapes(t){this.$set({shapes:t}),o5()}get tools(){return this.$$.ctx[54]}set tools(t){this.$set({tools:t}),o5()}get toolShapes(){return this.$$.ctx[55]}set toolShapes(t){this.$set({toolShapes:t}),o5()}get toolActive(){return this.$$.ctx[0]}set toolActive(t){this.$set({toolActive:t}),o5()}get shapeControls(){return this.$$.ctx[6]}set shapeControls(t){this.$set({shapeControls:t}),o5()}get enableButtonFlipVertical(){return this.$$.ctx[7]}set enableButtonFlipVertical(t){this.$set({enableButtonFlipVertical:t}),o5()}get enablePresetSelectImage(){return this.$$.ctx[8]}set enablePresetSelectImage(t){this.$set({enablePresetSelectImage:t}),o5()}get shapePresets(){return this.$$.ctx[9]}set shapePresets(t){this.$set({shapePresets:t}),o5()}get utilKey(){return this.$$.ctx[56]}set utilKey(t){this.$set({utilKey:t}),o5()}get mapScreenPointToImagePoint(){return this.$$.ctx[10]}set mapScreenPointToImagePoint(t){this.$set({mapScreenPointToImagePoint:t}),o5()}get mapImagePointToScreenPoint(){return this.$$.ctx[11]}set mapImagePointToScreenPoint(t){this.$set({mapImagePointToScreenPoint:t}),o5()}get imageRotation(){return this.$$.ctx[12]}set imageRotation(t){this.$set({imageRotation:t}),o5()}get imageFlipX(){return this.$$.ctx[57]}set imageFlipX(t){this.$set({imageFlipX:t}),o5()}get imageFlipY(){return this.$$.ctx[58]}set imageFlipY(t){this.$set({imageFlipY:t}),o5()}get parentRect(){return this.$$.ctx[13]}set parentRect(t){this.$set({parentRect:t}),o5()}get hooks(){return this.$$.ctx[14]}set hooks(t){this.$set({hooks:t}),o5()}constructor(t){super(),ap(this,t,fl,fa,ou,{isActive:1,isActiveFraction:2,isVisible:3,stores:53,locale:4,shapes:5,tools:54,toolShapes:55,toolActive:0,shapeControls:6,enableButtonFlipVertical:7,enablePresetSelectImage:8,shapePresets:9,utilKey:56,mapScreenPointToImagePoint:10,mapImagePointToScreenPoint:11,imageRotation:12,imageFlipX:57,imageFlipY:58,parentRect:13,hooks:14},[-1,-1,-1])}}var fc=(t,e,n,r,o,a,l,s,c)=>{let u=tq(t),d=.5*n.width,h=.5*n.height,p=.5*e.width,f=.5*e.height,g=o.x+r.x,m=o.y+r.y;s&&(u.x=n.width-u.x),c&&(u.y=n.height-u.y);let $=Math.cos(a),y=Math.sin(a);u.x-=d,u.y-=h;let x=u.x*$-u.y*y,b=u.x*y+u.y*$;u.x=d+x,u.y=h+b,u.x*=l,u.y*=l,u.x+=p,u.y+=f,u.x+=g,u.y+=m,u.x-=d*l,u.y-=h*l;let v=(o.x-g)*l,w=(o.y-m)*l;return u.x+=v*$-w*y,u.y+=v*y+w*$,u},fu=(t,e,n,r,o,a,l,s,c)=>{let u=tq(t),d=ep(n),h=ep(e),p=tH(o.x+r.x,o.y+r.y),f=Math.cos(a),g=Math.sin(a);u.x-=h.x,u.y-=h.y;let m=(o.x-p.x)*l,$=(o.y-p.y)*l;u.x-=m*f-$*g,u.y-=m*g+$*f,u.x-=p.x,u.y-=p.y,u.x/=l,u.y/=l;let y=u.x*f+u.y*g,x=u.x*g-u.y*f;return u.x=y,u.y=-x,u.x+=d.x,u.y+=d.y,s&&(u.x=n.width-u.x),c&&(u.y=n.height-u.y),u};function fd(t){let e,n;return(e=new fs({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[31],mapImagePointToScreenPoint:t[32],utilKey:"annotate",imageRotation:t[23],imageFlipX:t[21],imageFlipY:t[22],shapes:t[25],tools:t[8]||t[5],toolShapes:t[9]||t[6],toolActive:t[11],shapeControls:t[10]||t[7],shapePresets:t[14],enableButtonFlipVertical:t[12],parentRect:t[26],enablePresetSelectImage:t[13],hooks:{willRenderShapeControls:t[15],beforeAddShape:t[16],beforeRemoveShape:t[17],beforeDeselectShape:t[18],beforeSelectShape:t[19],beforeUpdateShape:t[20]}}})).$on("measure",t[34]),{c(){au(e.$$.fragment)},m(t,r){ad(e,t,r),n=!0},p(t,n){let r={};8&n[0]&&(r.stores=t[3]),16&n[0]&&(r.locale=t[4]),1&n[0]&&(r.isActive=t[0]),2&n[0]&&(r.isActiveFraction=t[1]),4&n[0]&&(r.isVisible=t[2]),8388608&n[0]&&(r.imageRotation=t[23]),2097152&n[0]&&(r.imageFlipX=t[21]),4194304&n[0]&&(r.imageFlipY=t[22]),288&n[0]&&(r.tools=t[8]||t[5]),576&n[0]&&(r.toolShapes=t[9]||t[6]),2048&n[0]&&(r.toolActive=t[11]),1152&n[0]&&(r.shapeControls=t[10]||t[7]),16384&n[0]&&(r.shapePresets=t[14]),4096&n[0]&&(r.enableButtonFlipVertical=t[12]),8192&n[0]&&(r.enablePresetSelectImage=t[13]),2064384&n[0]&&(r.hooks={willRenderShapeControls:t[15],beforeAddShape:t[16],beforeRemoveShape:t[17],beforeDeselectShape:t[18],beforeSelectShape:t[19],beforeUpdateShape:t[20]}),e.$set(r)},i(t){n||(o9(e.$$.fragment,t),n=!0)},o(t){at(e.$$.fragment,t),n=!1},d(t){ah(e,t)}}}function fh(t,e,n){let r,o,a,l,s,c;let{isActive:u}=e,{isActiveFraction:d}=e,{isVisible:h}=e,{stores:p}=e,{locale:f={}}=e,{markupEditorToolbar:g}=e,{markupEditorToolStyles:m}=e,{markupEditorShapeStyleControls:$}=e,{annotateTools:y}=e,{annotateToolShapes:x}=e,{annotateShapeControls:b}=e,{annotateActiveTool:v="sharpie"}=e,{annotateEnableButtonFlipVertical:w=!1}=e,{annotateEnableSelectImagePreset:k=!1}=e,{annotatePresets:C=[]}=e,{willRenderShapeControls:M}=e,{beforeAddShape:S}=e,{beforeRemoveShape:A}=e,{beforeDeselectShape:E}=e,{beforeSelectShape:T}=e,{beforeUpdateShape:R}=e,{rootRect:I,imageAnnotation:P,imageSize:D,imageTransforms:L,imageRotation:F,imageFlipX:B,imageFlipY:O}=p;return op(t,I,t=>n(35,r=t)),op(t,D,t=>n(36,o=t)),op(t,L,t=>n(37,a=t)),op(t,F,t=>n(23,c=t)),op(t,B,t=>n(21,l=t)),op(t,O,t=>n(22,s=t)),t.$$set=t=>{"isActive"in t&&n(0,u=t.isActive),"isActiveFraction"in t&&n(1,d=t.isActiveFraction),"isVisible"in t&&n(2,h=t.isVisible),"stores"in t&&n(3,p=t.stores),"locale"in t&&n(4,f=t.locale),"markupEditorToolbar"in t&&n(5,g=t.markupEditorToolbar),"markupEditorToolStyles"in t&&n(6,m=t.markupEditorToolStyles),"markupEditorShapeStyleControls"in t&&n(7,$=t.markupEditorShapeStyleControls),"annotateTools"in t&&n(8,y=t.annotateTools),"annotateToolShapes"in t&&n(9,x=t.annotateToolShapes),"annotateShapeControls"in t&&n(10,b=t.annotateShapeControls),"annotateActiveTool"in t&&n(11,v=t.annotateActiveTool),"annotateEnableButtonFlipVertical"in t&&n(12,w=t.annotateEnableButtonFlipVertical),"annotateEnableSelectImagePreset"in t&&n(13,k=t.annotateEnableSelectImagePreset),"annotatePresets"in t&&n(14,C=t.annotatePresets),"willRenderShapeControls"in t&&n(15,M=t.willRenderShapeControls),"beforeAddShape"in t&&n(16,S=t.beforeAddShape),"beforeRemoveShape"in t&&n(17,A=t.beforeRemoveShape),"beforeDeselectShape"in t&&n(18,E=t.beforeDeselectShape),"beforeSelectShape"in t&&n(19,T=t.beforeSelectShape),"beforeUpdateShape"in t&&n(20,R=t.beforeUpdateShape)},[u,d,h,p,f,g,m,$,y,x,b,v,w,k,C,M,S,A,E,T,R,l,s,c,I,P,D,L,F,B,O,t=>fu(t,r,o,a.origin,a.translation,a.rotation.z,a.scale,l,s),t=>fc(t,r,o,a.origin,a.translation,a.rotation.z,a.scale,l,s),"annotate",function(e){oY(t,e)}]}dd(),dc(),dj(),dd(),dc(),dj(),dd(),dc(),dj();var fp=n(30724),ff=n.n(fp);!function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach(t=>{let[e,n]=t.util;cW.set(e,n),la(n).filter(t=>!c_.includes(t)).forEach(t=>{if(cN.add(t),cU[t]){cU[t].push(e);return}cU[t]=[e]})})}({util:["crop",class extends af{get name(){return this.$$.ctx[79]}get isActive(){return this.$$.ctx[1]}set isActive(t){this.$set({isActive:t}),o5()}get stores(){return this.$$.ctx[80]}set stores(t){this.$set({stores:t}),o5()}get cropImageSelectionCornerStyle(){return this.$$.ctx[2]}set cropImageSelectionCornerStyle(t){this.$set({cropImageSelectionCornerStyle:t}),o5()}get cropAutoCenterImageSelectionTimeout(){return this.$$.ctx[81]}set cropAutoCenterImageSelectionTimeout(t){this.$set({cropAutoCenterImageSelectionTimeout:t}),o5()}get cropEnableZoomMatchImageAspectRatio(){return this.$$.ctx[82]}set cropEnableZoomMatchImageAspectRatio(t){this.$set({cropEnableZoomMatchImageAspectRatio:t}),o5()}get cropEnableRotateMatchImageAspectRatio(){return this.$$.ctx[83]}set cropEnableRotateMatchImageAspectRatio(t){this.$set({cropEnableRotateMatchImageAspectRatio:t}),o5()}get cropEnableRotationInput(){return this.$$.ctx[84]}set cropEnableRotationInput(t){this.$set({cropEnableRotationInput:t}),o5()}get cropEnableZoom(){return this.$$.ctx[3]}set cropEnableZoom(t){this.$set({cropEnableZoom:t}),o5()}get cropEnableZoomInput(){return this.$$.ctx[85]}set cropEnableZoomInput(t){this.$set({cropEnableZoomInput:t}),o5()}get cropEnableImageSelection(){return this.$$.ctx[86]}set cropEnableImageSelection(t){this.$set({cropEnableImageSelection:t}),o5()}get cropEnableInfoIndicator(){return this.$$.ctx[87]}set cropEnableInfoIndicator(t){this.$set({cropEnableInfoIndicator:t}),o5()}get cropEnableZoomTowardsWheelPosition(){return this.$$.ctx[88]}set cropEnableZoomTowardsWheelPosition(t){this.$set({cropEnableZoomTowardsWheelPosition:t}),o5()}get cropEnableLimitWheelInputToCropSelection(){return this.$$.ctx[89]}set cropEnableLimitWheelInputToCropSelection(t){this.$set({cropEnableLimitWheelInputToCropSelection:t}),o5()}get cropEnableCenterImageSelection(){return this.$$.ctx[90]}set cropEnableCenterImageSelection(t){this.$set({cropEnableCenterImageSelection:t}),o5()}get cropEnableButtonRotateLeft(){return this.$$.ctx[91]}set cropEnableButtonRotateLeft(t){this.$set({cropEnableButtonRotateLeft:t}),o5()}get cropEnableButtonRotateRight(){return this.$$.ctx[92]}set cropEnableButtonRotateRight(t){this.$set({cropEnableButtonRotateRight:t}),o5()}get cropEnableButtonFlipHorizontal(){return this.$$.ctx[93]}set cropEnableButtonFlipHorizontal(t){this.$set({cropEnableButtonFlipHorizontal:t}),o5()}get cropEnableButtonFlipVertical(){return this.$$.ctx[94]}set cropEnableButtonFlipVertical(t){this.$set({cropEnableButtonFlipVertical:t}),o5()}get cropSelectPresetOptions(){return this.$$.ctx[95]}set cropSelectPresetOptions(t){this.$set({cropSelectPresetOptions:t}),o5()}get cropEnableSelectPreset(){return this.$$.ctx[96]}set cropEnableSelectPreset(t){this.$set({cropEnableSelectPreset:t}),o5()}get cropEnableButtonToggleCropLimit(){return this.$$.ctx[97]}set cropEnableButtonToggleCropLimit(t){this.$set({cropEnableButtonToggleCropLimit:t}),o5()}get locale(){return this.$$.ctx[4]}set locale(t){this.$set({locale:t}),o5()}get tools(){return this.$$.ctx[0]}set tools(t){this.$set({tools:t}),o5()}constructor(t){super(),ap(this,t,hV,hU,ou,{name:79,isActive:1,stores:80,cropImageSelectionCornerStyle:2,cropAutoCenterImageSelectionTimeout:81,cropEnableZoomMatchImageAspectRatio:82,cropEnableRotateMatchImageAspectRatio:83,cropEnableRotationInput:84,cropEnableZoom:3,cropEnableZoomInput:85,cropEnableImageSelection:86,cropEnableInfoIndicator:87,cropEnableZoomTowardsWheelPosition:88,cropEnableLimitWheelInputToCropSelection:89,cropEnableCenterImageSelection:90,cropEnableButtonRotateLeft:91,cropEnableButtonRotateRight:92,cropEnableButtonFlipHorizontal:93,cropEnableButtonFlipVertical:94,cropSelectPresetOptions:95,cropEnableSelectPreset:96,cropEnableButtonToggleCropLimit:97,locale:4,tools:0},[-1,-1,-1,-1,-1,-1])}}]},{util:["finetune",class extends af{get name(){return this.$$.ctx[12]}get stores(){return this.$$.ctx[13]}set stores(t){this.$set({stores:t}),o5()}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$set({isActive:t}),o5()}get locale(){return this.$$.ctx[14]}set locale(t){this.$set({locale:t}),o5()}get finetuneControlConfiguration(){return this.$$.ctx[15]}set finetuneControlConfiguration(t){this.$set({finetuneControlConfiguration:t}),o5()}get finetuneOptions(){return this.$$.ctx[16]}set finetuneOptions(t){this.$set({finetuneOptions:t}),o5()}constructor(t){super(),ap(this,t,h4,h2,ou,{name:12,stores:13,isActive:0,locale:14,finetuneControlConfiguration:15,finetuneOptions:16},[-1,-1])}}]},{util:["filter",class extends af{get name(){return this.$$.ctx[26]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$set({isActive:t}),o5()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$set({isActiveFraction:t}),o5()}get stores(){return this.$$.ctx[27]}set stores(t){this.$set({stores:t}),o5()}get locale(){return this.$$.ctx[2]}set locale(t){this.$set({locale:t}),o5()}get filterFunctions(){return this.$$.ctx[28]}set filterFunctions(t){this.$set({filterFunctions:t}),o5()}get filterOptions(){return this.$$.ctx[3]}set filterOptions(t){this.$set({filterOptions:t}),o5()}constructor(t){super(),ap(this,t,hZ,hK,ou,{name:26,isActive:0,isActiveFraction:1,stores:27,locale:2,filterFunctions:28,filterOptions:3},[-1,-1,-1])}}]},{util:["annotate",class extends af{get name(){return this.$$.ctx[33]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$set({isActive:t}),o5()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$set({isActiveFraction:t}),o5()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$set({isVisible:t}),o5()}get stores(){return this.$$.ctx[3]}set stores(t){this.$set({stores:t}),o5()}get locale(){return this.$$.ctx[4]}set locale(t){this.$set({locale:t}),o5()}get markupEditorToolbar(){return this.$$.ctx[5]}set markupEditorToolbar(t){this.$set({markupEditorToolbar:t}),o5()}get markupEditorToolStyles(){return this.$$.ctx[6]}set markupEditorToolStyles(t){this.$set({markupEditorToolStyles:t}),o5()}get markupEditorShapeStyleControls(){return this.$$.ctx[7]}set markupEditorShapeStyleControls(t){this.$set({markupEditorShapeStyleControls:t}),o5()}get annotateTools(){return this.$$.ctx[8]}set annotateTools(t){this.$set({annotateTools:t}),o5()}get annotateToolShapes(){return this.$$.ctx[9]}set annotateToolShapes(t){this.$set({annotateToolShapes:t}),o5()}get annotateShapeControls(){return this.$$.ctx[10]}set annotateShapeControls(t){this.$set({annotateShapeControls:t}),o5()}get annotateActiveTool(){return this.$$.ctx[11]}set annotateActiveTool(t){this.$set({annotateActiveTool:t}),o5()}get annotateEnableButtonFlipVertical(){return this.$$.ctx[12]}set annotateEnableButtonFlipVertical(t){this.$set({annotateEnableButtonFlipVertical:t}),o5()}get annotateEnableSelectImagePreset(){return this.$$.ctx[13]}set annotateEnableSelectImagePreset(t){this.$set({annotateEnableSelectImagePreset:t}),o5()}get annotatePresets(){return this.$$.ctx[14]}set annotatePresets(t){this.$set({annotatePresets:t}),o5()}get willRenderShapeControls(){return this.$$.ctx[15]}set willRenderShapeControls(t){this.$set({willRenderShapeControls:t}),o5()}get beforeAddShape(){return this.$$.ctx[16]}set beforeAddShape(t){this.$set({beforeAddShape:t}),o5()}get beforeRemoveShape(){return this.$$.ctx[17]}set beforeRemoveShape(t){this.$set({beforeRemoveShape:t}),o5()}get beforeDeselectShape(){return this.$$.ctx[18]}set beforeDeselectShape(t){this.$set({beforeDeselectShape:t}),o5()}get beforeSelectShape(){return this.$$.ctx[19]}set beforeSelectShape(t){this.$set({beforeSelectShape:t}),o5()}get beforeUpdateShape(){return this.$$.ctx[20]}set beforeUpdateShape(t){this.$set({beforeUpdateShape:t}),o5()}constructor(t){super(),ap(this,t,fh,fd,ou,{name:33,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,markupEditorToolbar:5,markupEditorToolStyles:6,markupEditorShapeStyleControls:7,annotateTools:8,annotateToolShapes:9,annotateShapeControls:10,annotateActiveTool:11,annotateEnableButtonFlipVertical:12,annotateEnableSelectImagePreset:13,annotatePresets:14,willRenderShapeControls:15,beforeAddShape:16,beforeRemoveShape:17,beforeDeselectShape:18,beforeSelectShape:19,beforeUpdateShape:20},[-1,-1])}}]}),function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{orientImage:e=!0,outputProps:n=["src","dest","size"],preprocessImageFile:r}=t;[rY(),r&&[rH(r,(t,e,n)=>[t.dest,e,n],(t,e)=>t.dest=e),"preprocess-image-file"],rG({srcProp:"dest"}),e&&rq({srcProp:"dest"}),e&&rZ(),e&&rK(),on(n)].filter(Boolean)}(),function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{canvasMemoryLimit:e=n5()?16777216:1/0,orientImage:n=!0,copyImageHead:r=!0,mimeType:o,quality:a,renameFile:l,targetSize:s,store:c,outputProps:u=["src","dest","imageState","store"],preprocessImageState:d,postprocessImageData:h}=t;[(n||r)&&rq(),n&&rZ(),rG(),d&&[rH(d,(t,e,n)=>[t.imageState,e,n],(t,e)=>t.imageState=e),"preprocess-image-state"],r0({canvasMemoryLimit:e}),rJ(),n&&rK(),n&&r1(),r4(),r5({resize:s}),r3(),r2(),r6(),r8(),h&&[rH(h,(t,e,n)=>[t.imageData,e,n],(t,e)=>t.imageData=e),"postprocess-image-data"],r7({mimeType:o,quality:a}),n&&rQ(),r&&r9(),ot({defaultFilename:"image",renameFile:l}),c&&(ne(c)?oe({url:c}):nJ(c)?[c,"store"]:oe(c)),on(u)].filter(Boolean)}(),t=>{if(t&&t.task)return"store"===t.task?t.error?"Error uploading image":"Uploading image…":t.error?"Error processing image":"Processing image…"};let fg,fm,f$,fy=null;function fx(t){let[e,n]=(0,N.useState)(!1),[r,o]=(0,N.useState)(""),[a,l]=(0,N.useState)(!0),{isOpen:s,onToggle:c}=(0,p.q)(),{query:u}=(0,U.useRouter)(),[d,j]=(0,N.useState)(u.image?2:u.to||u.title||u.description?1:0),[G,q]=(0,N.useState)(u.batchId?u.batchId.toString():null),{account:Z,chainId:Q}=(0,z.Ge)(),[J,tt]=(0,N.useState)(u.to||Z||""),[te,tn]=(0,N.useState)("f"==u.public?"Private":"Public"),[ti,tr]=(0,N.useState)(u.title||""),[to,ta]=(0,N.useState)(u.description||""),[tl,ts]=(0,N.useState)(u.image||""),[tc,tu]=(0,N.useState)(u.ownedUrl||""),[td,th]=(0,N.useState)(""),[tp,tf]=(0,N.useState)(!1),[tg,tm]=(0,N.useState)({loaded:!0,private:!1}),[t$,ty]=(0,N.useState)(null),[tx,tb]=(0,N.useState)(!0),[tv,tw]=(0,N.useState)(!1),[tk,tC]=(0,N.useState)(!1),[tM,tS]=(0,N.useState)(null),[tA,tE]=(0,N.useState)(null),[tT,tR]=(0,N.useState)(null),[tI,tP]=(0,N.useState)(null),[tD,tL]=(0,N.useState)(!1),[tF,tB]=(0,N.useState)(!1),[tO,tj]=(0,N.useState)(""),[t_,tz]=(0,N.useState)(""),[tN,tU]=(0,N.useState)(u.image?"embed":"upload"),[tW,tX]=(0,N.useState)(!!u.image),[tV,tH]=(0,N.useState)(!1),[tY,tG]=(0,N.useState)(!0),tK=(0,V.cq)(X.q7.vaultHandler[Q],X.q7.vaultHandlerAbi,!0),tq=(0,V.cq)(X.q7.coval[Q],X.q7.covalAbi,!0),tZ=()=>{"true"==localStorage.getItem("tos")?(tH(!0),tG(!1)):(tH(!1),tG(!0))},tQ=async()=>{tS(await tq.decimals()),tE(await tq.allowance(Z,X.q7.vaultHandler[Q]).then(t=>t.toString())),tR(await tq.balanceOf(Z).then(t=>t.toString())),tP(await tK.price().then(t=>t.toString())),Number(tA)>=Number(tI)?tf(!0):tf(!1)},tJ=()=>{console.log("fire?"),tL(!0),tK.buyWithSignature(J,fg,fm,f$,fy).then(t=>{let{hash:e}=t;setTimeout(()=>{ty(e),tC(!0)},100)}).catch(t=>{tL(!1),tw(!1),t0(fg,()=>{location.href=location.origin+"/nft?id="+fg})})},t0=(t,e)=>(fetch(X.HP+"/liveliness",{method:"POST",headers:{"Content-Type":"application/json",service:"evmetadata",chainid:Q.toString()},body:JSON.stringify({tokenId:t})}).then(async function(t){console.log("Liveliness check",await t.json())}),e()),t1=t=>{t.preventDefault(),tm({loaded:!1,private:tg.private});let e={fromAddress:Z,toAddress:J,description:to,name:ti,ownedImage:tc,image:tl,chainId:Q,private:tg.private,password:td||"",values:[],experimental:!0};tO&&t_&&e.values.push({key:tO,value:t_}),G&&(e.batchId=G),console.log(JSON.stringify(e)),fetch(X.HP+"/mint3",{method:"POST",headers:{"Content-Type":"application/json",service:"evmetadata"},body:JSON.stringify(e)}).then(async function(t){tm({loaded:!0,private:tg.private});let e=await t.json();fg=e.data.tokenId,f$=e.data.nonce,fy=e.data.signature,fm=e.data.cipherTextHash,tw(!1),setTimeout(()=>{t0(fg,()=>{location.href=location.origin+"/nft?id="+fg})},500)})},[t2,t4]=(0,N.useState)("");return(0,N.useEffect)(()=>{Z&&t2!=Z&&(t4(Z),tt(u.to||Z),tZ())},[Z,t2]),(0,N.useEffect)(()=>{Z&&Q&&tQ()}),(0,h.jsxs)(_(),{loaded:tg.loaded,children:[(0,h.jsx)(f.k,{width:"full",align:"center",justifyContent:"center",children:(0,h.jsx)(g.xu,{maxW:"sm",borderWidth:"1px",rounded:"lg",overflow:"hidden",children:(0,h.jsxs)(m.m,{defaultIndex:0,index:d,onChange:t=>j(t),children:[(0,h.jsxs)($.t,{children:[(0,h.jsx)(y.O,{children:"Make"}),(0,h.jsx)(y.O,{children:"My"}),(0,h.jsx)(y.O,{children:"Vault"})]}),(0,h.jsxs)(x.n,{children:[(0,h.jsx)(b.x,{children:(0,h.jsxs)(v.K,{direction:"column",align:"center",spacing:"2rem",flexGrow:1,justifyContent:"center",px:"2rem",py:"2rem",shouldWrapChildren:!0,children:[(0,h.jsx)(v.K,{direction:"row",align:"flex-start",spacing:"0rem",flexWrap:"wrap",shouldWrapChildren:!0,children:(0,h.jsxs)(w.NI,{isRequired:!0,isInvalid:J&&!(0,H.uO)(J),children:[(0,h.jsx)(k.l,{htmlFor:"owner-address",children:"Vault Owner Address"}),(0,h.jsx)(C.I,{type:"text",id:"owner-address","aria-describedby":"owner-helper-text",placeholder:"0xdeadbeef",maxLength:42,value:J,onChange:t=>tt(t.target.value)}),(0,h.jsx)(w.Q6,{id:"owner-helper-text",children:"What is the address of the first owner of this vault? Pro tip: When you connect a web3 wallet, this will populate automagically with your address."}),(0,h.jsx)(M.J1,{children:"Address is not a valid ETH address"})]})}),(0,h.jsxs)(v.K,{direction:"row",align:"flex-start",spacing:"0rem",flexWrap:"wrap",shouldWrapChildren:!0,children:[(0,h.jsxs)(w.NI,{as:"fieldset",isRequired:!0,children:[(0,h.jsx)(k.l,{children:"Public or Private?"}),(0,h.jsxs)(B.Z,{id:"pubpriv",defaultValue:te,onChange:t=>{tn(t.target.value),tm({loaded:tg.loaded,private:"Private"===t.target.value})},children:[(0,h.jsx)(S.Y,{value:"Public",children:"Public"}),(0,h.jsx)(S.Y,{value:"Private",children:"Private"})]}),(0,h.jsx)(w.Q6,{id:"email-helper-text",children:"Do you want the contents and addresses to be password protected?"})]}),tg.private?(0,h.jsxs)(w.NI,{isRequired:!0,children:[(0,h.jsx)(k.l,{children:"Password"}),(0,h.jsx)(C.I,{type:"password",id:"vault-password",onChange:t=>th(t.target.value),"aria-describedby":"password-helper-text",autoComplete:"off"}),(0,h.jsx)(w.Q6,{id:"password-helper-text",children:"Used to encrypt/decrypt"})]}):""]}),(0,h.jsx)(v.K,{direction:"row",align:"flex-start",spacing:"0rem",flexWrap:"wrap",shouldWrapChildren:!0,children:(0,h.jsx)(A.z,{onClick:()=>j(1),children:"Next"})})]})}),(0,h.jsx)(b.x,{children:(0,h.jsxs)(v.K,{direction:"column",align:"center",spacing:"2rem",flexGrow:1,justifyContent:"center",px:"2rem",py:"2rem",shouldWrapChildren:!0,children:[(0,h.jsx)(v.K,{direction:"row",align:"flex-start",spacing:"0rem",flexWrap:"wrap",shouldWrapChildren:!0,children:(0,h.jsxs)(w.NI,{isRequired:!0,isInvalid:ti&&ti.length<3&&ti.length>200,children:[(0,h.jsx)(k.l,{htmlFor:"vault-name",children:"Vault Name"}),(0,h.jsx)(C.I,{type:"text",id:"vault-name","aria-describedby":"vault-name-text",minLength:3,maxLength:200,value:ti,onChange:t=>tr(t.target.value),autoComplete:"off"}),(0,h.jsx)(w.Q6,{id:"vault-name-text",children:"Give it some love so you can find it later."}),(0,h.jsx)(M.J1,{children:"Name needs at least 3 characters. 200 is max."})]})}),(0,h.jsx)(v.K,{direction:"row",align:"flex-start",spacing:"0rem",flexWrap:"wrap",shouldWrapChildren:!0,children:(0,h.jsxs)(w.NI,{isRequired:!0,isInvalid:to&&to.length<3&&to.length>1024,children:[(0,h.jsx)(k.l,{htmlFor:"vault-desc",children:"Vault Description"}),(0,h.jsx)(E.g,{id:"vault-desc",size:"lg","aria-describedby":"vault-desc-text",minLength:3,maxLength:1024,value:to,onChange:t=>ta(t.target.value),autoComplete:"off"}),(0,h.jsx)(w.Q6,{id:"vault-desc-text",children:"Add some fluffy text to tell people what the point is!"}),(0,h.jsx)(M.J1,{children:"Description needs to be at least 3 characters. 1024 is max."})]})}),(0,h.jsx)(A.z,{onClick:c,children:"Include Encrypted Text In Vault"}),(0,h.jsx)(O.Z,{isOpen:s,children:tx?(0,h.jsxs)(v.K,{direction:"row",align:"flex-start",spacing:"0rem",flexWrap:"wrap",shouldWrapChildren:!0,children:[(0,h.jsxs)(w.NI,{children:[(0,h.jsx)(k.l,{htmlFor:"vault-key",children:"Key"}),(0,h.jsx)(C.I,{type:"text",id:"vault-key","aria-describedby":"vault-key-text",maxLength:200,value:tO,onChange:t=>tj(t.target.value),autoComplete:"off"}),(0,h.jsx)(w.Q6,{id:"vault-key-text",children:"Key Name (Public)"}),(0,h.jsx)(M.J1,{children:"---Some Error"})]}),(0,h.jsxs)(w.NI,{children:[(0,h.jsx)(k.l,{htmlFor:"vault-value",children:"Value"}),(0,h.jsx)(C.I,{type:"password",id:"vault-value","aria-describedby":"vault-value-text",maxLength:200,value:t_,onChange:t=>tz(t.target.value),autoComplete:"off"}),(0,h.jsx)(w.Q6,{id:"vault-value-text",children:"Key Value (Encrypted)"}),(0,h.jsx)(M.J1,{children:"---Some Error"})]})]}):null}),(0,h.jsx)(v.K,{direction:"row",align:"flex-start",spacing:"0rem",flexWrap:"wrap",shouldWrapChildren:!0,children:(0,h.jsxs)(T.h,{spacing:4,children:[(0,h.jsx)(A.z,{onClick:()=>j(0),children:"Back"}),(0,h.jsx)(A.z,{onClick:()=>j(2),children:"Next"})]})})]})}),(0,h.jsxs)(b.x,{children:[(0,h.jsxs)(v.K,{direction:"column",align:"center",spacing:"2rem",flexGrow:1,justifyContent:"center",px:"2rem",py:"2rem",shouldWrapChildren:!0,children:[(0,h.jsx)(v.K,{direction:"row",align:"flex-start",spacing:"0rem",flexWrap:"wrap",shouldWrapChildren:!0,children:(0,h.jsx)(w.NI,{children:(0,h.jsx)(g.xu,{p:1,rounded:"lg",overflow:"hidden",children:(0,h.jsxs)(v.K,{align:"center",p:1,children:["upload"!==tN?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(k.l,{htmlFor:"vault-image-url",children:"Embed Display URL"}),(0,h.jsx)(C.I,{type:"text",id:"vault-image-url","aria-describedby":"vault-image-url-text",minLength:3,maxLength:200,value:tl,defaultValue:"http://",onChange:t=>{ts(t.target.value),tX(!0),console.log("showEmbed",tW)},autoComplete:"off",w:300}),u.image&&u.ownedUrl||!u.image?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(k.l,{mt:3,htmlFor:"owned-url",children:"Optional URL For Vault Owner *"}),(0,h.jsx)(C.I,{type:"text",id:"owned-url","aria-describedby":"owned-url-text",minLength:3,maxLength:200,value:tc,defaultValue:"http://",onChange:t=>{tu(t.target.value)},autoComplete:"off",w:300})]}):null]}):(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(k.l,{htmlFor:"vault-img",children:"Vault Image"}),(0,h.jsx)("input",{type:"file",onChange:()=>(function(){let t=document.querySelector("#preview"),e=document.querySelector("input[type=file]"),n=new FileReader;if(e.files[0].size>5e6)return delete e.files,alert("File too large");n.addEventListener("load",function(){var e;t&&(t.src=(null===(e=n.result)||void 0===e?void 0:e.toString())||""),t&&ts(t.src),l(!0),o("")},!1),e.files&&n.readAsDataURL(e.files[0])})()}),(0,h.jsx)(R.i,{})]}),u.image?null:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(R.i,{}),(0,h.jsx)(k.l,{htmlFor:"type-selector",children:"Display Type"}),(0,h.jsxs)(I.P,{id:"type-selector",w:"100%",value:tN,onChange:t=>{tU(t.target.value),console.log("type",tN)},children:[(0,h.jsx)("option",{value:"embed",children:"Embed (url)"}),(0,h.jsx)("option",{value:"upload",children:"Image (upload)"})]})]}),"upload"==tN?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("img",{id:"preview",src:r,width:"250","margin-top":"6"}),a&&tl?(0,h.jsx)(A.z,{mt:2,onClick:()=>n(!0),children:"Edit Image"}):null]}):!0==tW?(0,h.jsx)(h.Fragment,{children:(0,h.jsx)(Y.Z,{url:tl.toString()})}):null]})})})}),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(P.x,{mt:2,as:"h4",ml:"4",mr:"4",textAlign:"center",fontSize:"xs",fontStyle:"italic",className:"md",children:(0,h.jsx)(ff(),{plugins:[K()],children:ti.toString()+"\n\n"})}),(0,h.jsx)(P.x,{mt:2,as:"h4",ml:"4",mr:"4",fontSize:"xs",fontStyle:"italic",className:"md",children:(0,h.jsx)(ff(),{plugins:[K()],children:to.toString()})})]}),Number(tT)<Number(tI)?(0,h.jsx)(g.xu,{display:"flex",alignItems:"baseline",justifyContent:"space-between",mt:"2",children:(0,h.jsx)(A.z,{width:"100%",onClick:()=>{location.href="https://app.uniswap.org/#/swap?outputCurrency=0x3d658390460295fb963f54dc0899cfb1c30776df"},children:"Buy $Coval"})}):null,(0,h.jsx)(v.K,{direction:"row",align:"flex-start",spacing:"0rem",flexWrap:"wrap",shouldWrapChildren:!0,children:(0,h.jsxs)(T.h,{spacing:4,children:[(0,h.jsx)(A.z,{onClick:()=>j(1),children:"Back"}),Z?J&&(0,H.uO)(J)&&ti&&!(ti.length<3)&&to&&!(to.length<3)&&tl&&tV?t$||tD||tv||tk?(0,h.jsx)(A.z,{isDisabled:!0,type:"submit",children:"Making Vault ..."}):(0,h.jsx)(A.z,{onClick:t=>{t1(t)},type:"submit",children:"Create Vault"}):(0,h.jsx)(A.z,{isDisabled:!0,type:"submit",children:"Check Fields!"}):(0,h.jsx)(A.z,{isDisabled:!0,type:"submit",children:"No Wallet Connected!"})]})}),tY?(0,h.jsx)(v.K,{children:(0,h.jsxs)(k.l,{children:[(0,h.jsx)(D.X,{mr:5,mt:1,onClick:t=>{tH(t.target.checked),localStorage.setItem("tos",t.target.checked)}}),"Agree to ",(0,h.jsx)("a",{href:"/tos",target:"_blank",children:"Terms of Service"})]})}):(0,h.jsx)(P.x,{children:(0,h.jsx)("a",{href:"/tos",target:"_blank",children:"Terms of Service"})})]}),tv?(0,h.jsxs)(L.b,{status:"info",children:[(0,h.jsx)(F.z,{}),"Talking to contract ..."]}):null,tk?(0,h.jsxs)(L.b,{status:"info",children:[(0,h.jsx)(F.z,{}),"Making vault ... one moment"]}):null,tF?(0,h.jsxs)(L.b,{status:"info",children:[(0,h.jsx)(F.z,{}),"Handling approval flow ..."]}):null]})]})]})})}),t$?(0,h.jsx)(W.Z,{hash:t$,onComplete:()=>{ty(null),tD?setTimeout(()=>{tC(!1),t0(fg,()=>{location.href=location.origin+"/nft?id="+fg})},500):tF?tB(!1):(tJ(),tw(!1))}}):null]})}function fb(){return(0,h.jsx)(fx,{})}}},function(t){t.O(0,[758,6649,7119,3216,487,4038,9774,2888,179],function(){return t(t.s=7532)}),_N_E=t.O()}]);