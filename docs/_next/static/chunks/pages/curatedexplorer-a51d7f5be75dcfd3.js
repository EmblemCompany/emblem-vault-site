(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[859],{95208:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/curatedexplorer",function(){return a(60469)}])},60469:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return J}});var n=a(85893),l=a(20967),o=a(45161),r=a(70959),i=a(44461),c=a(24124),s=a(84028),d=a(90889),u=a(6089),h=a(32883),f=a(93717),m=a(33090),g=a(93108),p=a(53468),v=a(41731),x=a(57169),j=a(71293),w=a(35541),y=a(46199),k=a(22243),C=a(64859),b=a(66205),S=a(54346),N=a(57747),E=a(70758),_=a.n(E),T=a(11163),I=a(67294),R=a(82174),A=a(96084),M=a(11249),U=a(68209),D=a(77044),P=a(82729),O=a(59477),L=a(14438),z=a(45889);function G(){let e=(0,P._)(["\n  .injected-row {\n    background-color: rgba(0, 0, 0, 0.05);\n    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1), inset 0 -2px 4px rgba(255, 255, 255, 0.1);\n  }\n  .internal-balance-row {\n    background-color: #a0a0a0; // Mid-gray color\n  }\n"]);return G=function(){return e},e}let Z=(0,a(37883).Z)(A._$r)(G());var B=e=>{let{vaults:t,onAssetNameClick:a,onProjectClick:l,onAssetChainClick:o,onCategoryClick:r,onStatusClick:i,getCuratedByContractNetwork:c,setModalImage:s,onOpen:d,selectionModel:f,onSelectionModelChange:m,onRowClick:g,onContractAddressClick:p}=e,[v,x]=(0,I.useState)(new Set),w=e=>{x(t=>{let a=new Set(t);return a.has(e)?a.delete(e):a.add(e),a})},y=[{field:"expansion",headerName:"",width:50,renderCell:e=>(0,n.jsx)(N.xu,{onClick:t=>{t.stopPropagation(),w(e.id.toString())},children:v.has(e.id.toString())?(0,n.jsx)(L.Z,{}):(0,n.jsx)(z.Z,{})}),sortable:!1,filterable:!1},{field:"asset_name",headerName:"Asset Name",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),a(e.value)},children:e.value}),filterable:!0},{field:"project",headerName:"Project",width:150,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),l(e.value)},children:e.value}),filterable:!0},{field:"asset_chain",headerName:"Chain",width:100,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),o(e.value)},children:e.value}),filterable:!0},{field:"network",headerName:"Network",width:100,filterable:!0},{field:"balance",headerName:"Balance",width:100,type:"number",filterable:!0},{field:"balances",headerName:"Inside Balances",width:150,renderCell:e=>{let t=e.value,a=Array.isArray(t)?t.length:0;return(0,n.jsx)(O.u,{label:JSON.stringify(t,null,2),placement:"top",hasArrow:!0,children:(0,n.jsx)(N.xu,{children:a})})},sortComparator:(e,t)=>(Array.isArray(e)?e.length:0)-(Array.isArray(t)?t.length:0),filterable:!0},{field:"expired",headerName:"Expired",width:100,renderCell:e=>{var t;return(null===(t=e.row.balances)||void 0===t?void 0:t.some(e=>{var t;return null===(t=e.traits)||void 0===t?void 0:t.some(e=>"Expired"===e.value)}))?"â³":""},filterable:!0},{field:"image",headerName:"Image",width:100,renderCell:e=>(0,n.jsx)(u.E,{src:e.value,alt:"Asset Image",boxSize:"64px",onClick:()=>{s(e.value),d()}}),filterable:!1},{field:"tokenid",headerName:"Token ID",width:200,renderCell:e=>(0,n.jsx)(h.r,{href:"erc721Legacy"===e.row.category?"https://emblem.finance/nft?id=".concat(e.value):"https://emblem.finance/nft2?id=".concat(e.value),isExternal:!0,children:e.value}),filterable:!0},{field:"category",headerName:"Category",width:150,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),r(e.value)},children:e.value}),filterable:!0},{field:"status",headerName:"Status",width:150,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),i(e.value)},children:e.value}),filterable:!0},{field:"contract",headerName:"Contract",width:200,renderCell:e=>{var t,a;return(0,n.jsxs)(n.Fragment,{children:["erc721Legacy"!==e.row.category&&(0,n.jsx)(u.E,{src:null===(t=c(e.value,e.row.network))||void 0===t?void 0:t.loadingImages[0],boxSize:"25px"}),(0,n.jsx)(j.x,{as:"span",cursor:"pointer",textDecoration:"underline",onClick:t=>{t.stopPropagation(),p(e.value)},children:"erc721Legacy"===e.row.category?"Legacy":null===(a=c(e.value,e.row.network))||void 0===a?void 0:a.name})]})},filterable:!0},{field:"fraud",headerName:"\uD83D\uDEA9",width:70,renderCell:e=>e.value?"\uD83D\uDEA9":"",filterable:!0},{field:"jumps_count",headerName:"Jumps",width:100,type:"number",filterable:!0}],k=t.flatMap(e=>{let t={...e,id:e.tokenid};return v.has(e.tokenid)?[t,...(e.balances||[]).map((t,a)=>({id:"".concat(e.tokenid,"-").concat(a),asset_name:t.name,project:t.project,asset_chain:t.coin,balance:t.balance,image:t.image,tokenid:e.tokenid,network:null,balances:null,expired:null,category:null,status:null,contract:null,fraud:null,jumps_count:null,isInternalBalance:!0}))]:[t]});return(0,n.jsx)(N.xu,{height:"auto",minHeight:800,width:"100%",overflow:"visible",children:(0,n.jsx)(Z,{rows:k,columns:y,pageSize:100,rowsPerPageOptions:[100,200,500],checkboxSelection:!0,selectionModel:f,onSelectionModelChange:m,onRowClick:g,getRowId:e=>e.id,rowHeight:52,getRowClassName:e=>e.row.isInternalBalance?"internal-balance-row":"",style:{backgroundColor:"var(--background-color)",color:"var(--text-color)",overflow:"visible"},autoHeight:!0,disableColumnMenu:!1,components:{Toolbar:()=>null}})})};let H="curatedDataCache";function q(){let e=(0,T.useRouter)(),{account:t,chainId:a,library:E}=(0,D.Ge)(),{asPath:P}=e,O=new URLSearchParams(window.location.search),L=O.get("tab")?Number(O.get("tab")):0,z=O.get("filterType")||null,G=O.get("filterValue")||null,[Z,q]=(0,I.useState)({loaded:!0}),[J,K]=(0,I.useState)(null),[V,F]=(0,I.useState)(null),[Q,W]=(0,I.useState)(null),[X,Y]=(0,I.useState)(!1),[$,ee]=(0,I.useState)([]),[et,ea]=(0,I.useState)([]),[en,el]=(0,I.useState)(1),[eo,er]=(0,I.useState)(!1),[ei,ec]=(0,I.useState)(null),[es,ed]=(0,I.useState)(null),[eu,eh]=(0,I.useState)([]),[ef,em]=(0,I.useState)([]),[eg,ep]=(0,I.useState)([]),[ev,ex]=(0,I.useState)(null),[ej,ew]=(0,I.useState)(null),[ey,ek]=(0,I.useState)(null),[eC,eb]=(0,I.useState)([]),[eS,eN]=(0,I.useState)([]),[eE,e_]=(0,I.useState)([]),eT=A._$r,[eI,eR]=(0,I.useState)(L),{isOpen:eA,onOpen:eM,onClose:eU}=(0,l.q)(),[eD,eP]=(0,I.useState)(null),{colorMode:eO}=(0,o.If)(),[eL,ez]=(0,I.useState)(!0),[eG,eZ]=(0,I.useState)(!1),eB="dark"===eO,[eH,eq]=(0,I.useState)(!0),[eJ,eK]=(0,I.useState)(null),[eV,eF]=(0,I.useState)([]),[eQ,eW]=(0,I.useState)(""),eX=(0,I.useCallback)(async()=>{if(eJ)return eJ;let e=localStorage.getItem(H);if(e){let{data:t,timestamp:a}=JSON.parse(e);if(Date.now()-a<36e5)return eK(t),t}let t=await fetch("".concat(R._z,"/curated")),a=await t.json();return eK(a),localStorage.setItem(H,JSON.stringify({data:a,timestamp:Date.now()})),a},[eJ]),eY=t=>{eR(t);let a=new URLSearchParams(window.location.search);a.set("tab",t),e.push("".concat(e.pathname,"?").concat(a.toString()))};async function e$(){return fetch("https://api.etherscan.io/api?module=gastracker&action=gasoracle&apikey=TMWK7RK9YTQ8VYWD8Q8GFAZS6UZ8MTH57E").then(e=>e.json()).then(e=>{if("1"===e.status)return e.result.ProposeGasPrice;throw Error("Failed to fetch gas prices")}).catch(e=>(console.error("Error fetching gas prices:",e),null))}function e0(e){ex(e),fetch("".concat(R.N0,"/asset_metadata/projects"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project:e})}).then(e=>e.json()).then(e=>{ep(e)})}function e1(t){q({loaded:!1}),ex(t),fetch("".concat(R.N0,"/vaults?project=").concat(t),{method:"GET",headers:{"x-api-key":localStorage.apiKey}}).then(e=>e.json()).then(a=>{eb(a),q({loaded:!0}),e.push("".concat(e.pathname,"?filterType=project&filterValue=").concat(encodeURIComponent(t),"&tab=").concat(eI))})}function e2(t){q({loaded:!1}),ex(t),fetch("".concat(R.N0,"/vaults?asset_name=").concat(encodeURIComponent(t)),{method:"GET",headers:{"x-api-key":localStorage.apiKey}}).then(e=>e.json()).then(a=>{eb(a),q({loaded:!0}),e.push("".concat(e.pathname,"?filterType=asset_name&filterValue=").concat(encodeURIComponent(t),"&tab=").concat(eI))})}function e5(t){q({loaded:!1}),ex(t),fetch("".concat(R.N0,"/vaults?asset_chain=").concat(t),{method:"GET",headers:{"x-api-key":localStorage.apiKey}}).then(e=>e.json()).then(a=>{eb(a),q({loaded:!0}),e.push("".concat(e.pathname,"?filterType=asset_chain&filterValue=").concat(t,"&tab=").concat(eI))})}function e9(t){q({loaded:!1}),ex(t),fetch("".concat(R.N0,"/vaults?category=").concat(t),{method:"GET",headers:{"x-api-key":localStorage.apiKey}}).then(e=>e.json()).then(a=>{eb(a),q({loaded:!0}),e.push("".concat(e.pathname,"?filterType=category&filterValue=").concat(t,"&tab=").concat(eI))})}function e7(t){q({loaded:!1}),ex(t),fetch("".concat(R.N0,"/vaults?status=").concat(t),{method:"GET",headers:{"x-api-key":localStorage.apiKey}}).then(e=>e.json()).then(a=>{eb(a),q({loaded:!0}),e.push("".concat(e.pathname,"?filterType=status&filterValue=").concat(t,"&tab=").concat(eI))})}(0,I.useEffect)(()=>{es&&tn({target:{value:es}})},[eo]),(0,I.useEffect)(()=>{G&&!ev&&(ex(()=>decodeURIComponent(G)),"project"===z?e1(decodeURIComponent(G)):"asset_name"===z?e2(decodeURIComponent(G)):"asset_chain"===z?e5(decodeURIComponent(G)):"category"===z?e9(decodeURIComponent(G)):"status"===z?e7(decodeURIComponent(G)):"contractAddress"===z&&e3(decodeURIComponent(G)))},[G,ev]),(0,I.useEffect)(()=>{(async()=>{eq(!0);try{let[e,t]=await Promise.all([eX(),(0,M.f_)()]);F(e),W(e),ec(t),eq(!1)}catch(e){console.error("Error loading data:",e),eq(!1)}})()},[eX]),(0,I.useEffect)(()=>{V&&0===et.length&&fetch("".concat(R.N0,"/v3/deployments")).then(e=>e.json()).then(e=>{ea(e.filter((e,t)=>!V.some(t=>t.contracts["1"]==e.address)&&e.name.includes("upgradableERC")))})},[V,et]),(0,I.useEffect)(()=>{fetch("".concat(R.N0,"/asset_metadata/projects/vaulted")).then(e=>e.json()).then(e=>{eh(e)})},[]),(0,I.useEffect)(()=>{fetch("".concat(R.N0,"/asset_metadata/projects")).then(e=>e.json()).then(e=>{em(e)})},[]);let e3=t=>{q({loaded:!1}),ex(t),fetch("".concat(R.N0,"/vaults?contractAddress=").concat(encodeURIComponent(t)),{method:"GET",headers:{"x-api-key":localStorage.apiKey}}).then(e=>e.json()).then(a=>{eb(a),q({loaded:!0}),e.push("".concat(e.pathname,"?filterType=contractAddress&filterValue=").concat(encodeURIComponent(t),"&tab=").concat(eI))})};async function e4(e){let t=V.find(e=>e.name==es);if(!es||!t)return alert("Target contract address not found");if(0==e.length)return e6.log("No vaults to migrate");try{let n,l="ERC1155"==t.collectionType?R.q7.erc1155Abi:R.q7.erc721aAbi,o=new U.CH(t.contracts[a],l).connect(E.getSigner()),r=await e$();if("ERC721a"===t.collectionType)n=await o.estimateGas.mintMany(e.map(e=>e.to),e.map(e=>e.tokenId));else if("ERC1155"===t.collectionType)n=await o.estimateGas.migrationMintMany(e.map(e=>e.serial),e.map(e=>e.to),e.map(e=>e.tokenId));else throw Error("Unsupported contract collection type");let i=n*r*1e-9;e6.log("Estimated gas for mintMany: ".concat(i))}catch(e){e6.log("Error estimating gas for mintMany:",e)}}async function e8(e){let t=V.find(e=>e.name==es);if(!es||!t)return alert("Target contract address not found");if(0==e.length)return alert("No vaults to migrate");try{let n,l="ERC1155"==t.collectionType?R.q7.erc1155Abi:R.q7.erc721aAbi,o=new U.CH(t.contracts[a],l).connect(E.getSigner());if("ERC721a"===t.collectionType)n=await o.mintMany(e.map(e=>e.to),e.map(e=>e.tokenId));else if("ERC1155"===t.collectionType)n=await o.migrationMintMany(e.map(e=>e.serial),e.map(e=>e.to),e.map(e=>e.tokenId));else throw Error("Unsupported contract collection type");await n.wait(),alert("TX hash: ".concat(n.hash)),e6.log("Minted vaults:",e.length),e6.log("refreshing"),tt(),e6.log("Refreshed metadata and liveliness for migrated vaults")}catch(e){e6.log("Error minting vaults:",e)}}let e6={log:function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];let n=document.getElementById("migrationUpdates");if(n){let e=document.createElement("p");e.textContent=t.join(" "),n.insertBefore(e,n.firstChild)}}};function te(){let e=eC.filter(e=>eV.includes(e.tokenid)&&"minted"==e.status&&"erc721Legacy"!==e.category).map(e=>"".concat(e.contract,":").concat(e.externalTokenId)),t=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,l=e.slice(a,a+n);0!==l.length&&(await ta(l),t(e,a+n,n))};t(e)}function tt(){let e=0,t=eC.filter(e=>eV.includes(e.tokenid)&&"claimed"!==e.status&&"deleted"!==e.status),a=t.length,n=Math.ceil(a/en),l=async function(o,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=o+r*n;if(c>=a)return;let s=t[c];if(s&&s.tokenid){e6.log("Refreshing liveliness for vault",s.tokenid,"at index",c,"of",a,"vaults","thread #",r),ek("".concat(e," of ").concat(a," vaults * ").concat(en," threads"));try{"ERC721a"===s.category?await M.SZ.fetchMetadata(s.tokenid):"ERC1155"===s.category?(await M.SZ.fetchMetadata(s.tokenid),await M.SZ.fetchMetadata("".concat(s.tokenid,"1"))):(await M.SZ.fetchMetadata(s.tokenid),s.serialNumber&&(await M.SZ.fetchMetadata("".concat(Number(s.serialNumber))),await M.SZ.fetchMetadata("".concat(Number(s.serialNumber),"1")))),e++,setTimeout(()=>l(o+1,r),5e3)}catch(e){if(e6.log("Error refreshing liveliness:",e),i<7){let e=1e3*Math.pow(2,i);e6.log("Retrying in",e,"ms"),setTimeout(()=>l(o,r,i+1),e)}else e6.log("Failed to refresh liveliness after 7 attempts, moving to next index"),setTimeout(()=>l(o+1,r),5e3)}}else setTimeout(()=>l(o+1,r),0);e>=a&&ek("complete")};for(let e=0;e<en;e++)e*n<a&&l(0,e)}let ta=async e=>{let t=new Headers;t.append("content-type","application/json");let a=JSON.stringify({tokens:e});try{let e=await fetch("https://api.reservoir.tools/tokens/refresh/v2",{method:"POST",headers:t,body:a,redirect:"follow"}),n=await e.json();return alert("Marketplace Refreshed"),console.log(n),n}catch(e){return console.error(e),e}};async function tn(e){if(""===e.target.value||es&&e.target.value!==es){eb(eS),""===e.target.value&&ed(null);return}ed(e.target.value);let t=await M.SZ.fetchCuratedContractByName(e.target.value,ei);0===eS.length&&eN(eC);let a=eS.length>0?eS:eC,n=a.filter(e=>{let a=!e.fraud,n="erc721Legacy"===e.category,l=e.balance>=1,o=0===e.jumps_count,r="claimed"!==e.status,i="minted"==e.status,c="mainnet"===e.network,s=e.balances.some(e=>e.traits&&e.traits.some(e=>"Expired"===e.value)),d=t.allowed(e.balances,t);return a&&n&&l&&o&&r&&d&&c&&i&&!s}),l=a.filter(e=>!n.includes(e));e_(l),eb(eo?l:n),e6.log("Filtered to ".concat(eo?"unqualified":"eligible"," vaults"))}return(0,n.jsxs)(_(),{loaded:Z.loaded,children:[(0,n.jsxs)(r.m,{index:eI,onChange:eY,colorScheme:eB?"white":"black",children:[(0,n.jsx)(i.t,{children:["Tracked Metadata Projects","Metadata Project","Vaulted Projects","Vaults","Curated Collections"].map((e,t)=>(0,n.jsxs)(c.O,{isDisabled:!(0===t||2===t||4===t)&&!ev,fontWeight:eI===t?"bold":"normal",color:eI===t?eB?"white":"black":eB?"gray":"black",children:[e," ",ev&&(1===t||3===t)?"(: ".concat(ev,")"):""]},t))}),(0,n.jsxs)(s.n,{children:[(0,n.jsx)(d.x,{children:ef.length>0&&(0,n.jsx)(eT,{style:{backgroundColor:"var(--background-color)",color:eB?"white":"black",margin:"20px",borderRadius:"10px"},columns:[{field:"project_name",headerName:"Project Name",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e0(e.value),e1(e.value),eY(1)},children:e.value})},{field:"protocol",headerName:"Protocol",width:200},{field:"total_assets_count",headerName:"Total Assets Count",width:200}],rows:ef.map((e,t)=>({id:t,project_name:e.project_name,protocol:e.protocol,total_assets_count:e.total_assets_count})),autoHeight:!0})}),(0,n.jsx)(d.x,{children:V&&V.length>0&&eg.length>0&&(0,n.jsx)(eT,{style:{backgroundColor:"var(--background-color)",color:"var(--text-color)",margin:"20px",borderRadius:"10px"},columns:[{field:"asset_name",headerName:"Asset Name",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e2(e.value),eY(1)},children:e.value})},{field:"project_name",headerName:"Project Name",width:200},{field:"chain",headerName:"Chain",width:100},{field:"supply",headerName:"Supply",width:100},{field:"image",headerName:"Image",width:200,renderCell:e=>{var t;return(0,n.jsx)(N.xu,{position:"relative",zIndex:"docked",children:(0,n.jsx)(u.E,{src:null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.toString(),alt:"Asset Image",boxSize:"64px",onClick:()=>{var t;eP(null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.toString()),eM()}})})}},{field:"link",headerName:"Link",width:300,renderCell:e=>{var t,a;return(0,n.jsx)(h.r,{href:null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.toString(),isExternal:!0,children:null==e?void 0:null===(a=e.value)||void 0===a?void 0:a.toString()})}}],rows:eg.map((e,t)=>({id:e.id,created_at:e.created_at,asset_name:e.asset_name,project_name:e.project_name,chain:e.chain,supply:e.supply,link:e.link,image:e.image})),autoHeight:!0})}),(0,n.jsx)(d.x,{children:eu.length>0&&(0,n.jsx)(eT,{style:{backgroundColor:"var(--background-color)",color:"var(--text-color)",margin:"20px",borderRadius:"10px"},columns:[{field:"project",headerName:"Project",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e1(e.value),e0(e.value),eY(3)},children:e.value})},{field:"project_count",headerName:"Project Count",width:200}],rows:eu.map((e,t)=>({id:t,project:e.project,project_count:e.project_count})),autoHeight:!0})}),(0,n.jsx)(d.x,{children:(null==eC?void 0:eC.length)>0||es?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(f.k,{direction:"row",align:"center",children:[(0,n.jsx)(m.I,{type:"number",ml:5,value:en,onChange:e=>el(Number(e.target.value)),placeholder:"Enter thread count",width:"100px"}),(0,n.jsx)(g.z,{margin:5,onClick:function(){let e=0,t=eC.reverse().filter((e,t,a)=>t===a.findIndex(t=>t.tokenid===e.tokenid&&"claimed"!==t.status&&"deleted"!==t.status)),a=t.length,n=Math.ceil(a/en),l=async function(o,r){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=o+r*n;if(c>=a)return;let s=t[c];if(s&&s.tokenid){console.log("Refreshing balance for vault",s.tokenid,"at index",c,"of",a,"vaults","thread #",r),ew("".concat(e," of ").concat(a," vaults * ").concat(en," threads"));try{await M.SZ.refreshBalance(s.tokenid),e+=1,setTimeout(()=>l(o+1,r),5e3)}catch(e){if(console.error("Error refreshing balance:",e),i<7){let e=1e3*Math.pow(2,i);console.log("Retrying in",e,"ms"),setTimeout(()=>l(o,r,i+1),e)}else console.log("Failed to refresh balance after 7 attempts, moving to next index"),setTimeout(()=>l(o+1,r),5e3)}}else setTimeout(()=>l(o+1,r),0);e>=a&&ew("complete")};for(let e=0;e<en;e++)e*n<a&&l(0,e)},children:(0,n.jsxs)("div",{children:["Refresh Internal Balances ",ej]})}),"|",(0,n.jsx)(g.z,{isDisabled:!es,margin:5,onClick:()=>{!function(e){if(!es)return alert("Target contract is not defined");let t=document.querySelectorAll(".MuiDataGrid-row.Mui-selected"),a=[];!function n(l){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],l>=t.length)return e6.log("Migratable vaults:",a.length),eL?e4(a):e8(a);let o=t[l],r=Array.from(o.children).find(t=>t.getAttribute("data-field")===e),i=r?r.getAttribute("data-value"):null,c=eC.find(e=>e.tokenid===i),s=o.classList.contains("internal-balance-row");if(c){e6.log("Migrating vault:",c.tokenid);let e="http://localhost:3001/jump/".concat(c.tokenid,"/").concat(es,"/").concat("mainnet"==c.network?1:99999999999);if(s){let a=Array.from(o.children).find(e=>"asset_name"===e.getAttribute("data-field")),n=a?a.getAttribute("data-value"):null;n?e+="/".concat(encodeURIComponent(n)):e6.log("Warning: Asset name not found for injected row (".concat(l+1,"/").concat(t.length,")"))}fetch(e+="?testOnly=".concat(eL).concat(eG?"&allowEOAOwned=true":""),{method:"GET",headers:{"content-type":"application/json","x-api-key":localStorage.apiKey}}).then(e=>e.json()).then(e=>{e.error?e6.log("Error migrating vault (".concat(l+1,"/").concat(t.length,"):"),e.msg):(e6.log("Successfully migrated vault (".concat(l+1,"/").concat(t.length,"):"),c.tokenid),a.push(e)),n(l+1)}).catch(e=>{alert("Error making API call:', ".concat(e)),n(l+1)})}else n(l+1)}(0)}("tokenid")},children:(0,n.jsx)("div",{children:"Migrate"})}),(0,n.jsx)(g.z,{margin:5,onClick:()=>(function(e){if(!es)return alert("Target contract is not defined");let t=document.querySelectorAll(".MuiDataGrid-row.Mui-selected"),a=[];!function n(l){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],l>=t.length){e6.log("UnJumped vaults:",a.length);return}let o=Array.from(t[l].children).find(t=>t.getAttribute("data-field")===e),r=o?o.getAttribute("data-value"):null,i=eC.find(e=>e.tokenid===r);i?(e6.log("UnJumping vault:",i.tokenid),fetch("http://localhost:3001/unjump/".concat(i.tokenid,"/").concat(es,"/").concat("mainnet"==i.network?1:99999999999),{method:"GET",headers:{"content-type":"application/json","x-api-key":localStorage.apiKey}}).then(e=>e.json()).then(e=>{e.error?e6.log("Error unjumped vault (".concat(l+1,"/").concat(t.length,"):"),e.msg):(e6.log("Successfully unjumped vault (".concat(l+1,"/").concat(t.length,"):"),i.tokenid),a.push(e)),n(l+1)}).catch(e=>{alert("Error making API call:', ".concat(e)),n(l+1)})):n(l+1)}(0)})("tokenid"),children:"UnJump"}),(0,n.jsx)(g.z,{margin:5,onClick:()=>tt(),children:(0,n.jsxs)("div",{children:["Refresh Liveliness ",ey]})}),(0,n.jsx)(p.X,{ml:5,isChecked:eL,onChange:e=>{ez(e.target.checked)},children:"Test Only"}),(0,n.jsx)(p.X,{ml:5,isChecked:eG,onChange:e=>{eZ(e.target.checked)},children:"Allow EOA Owned"}),(0,n.jsx)(v.P,{margin:5,placeholder:"Select contract",onChange:async e=>await tn(e),width:"350px",children:ei&&ei.map((e,t)=>(0,n.jsx)("option",{value:e.name,children:e.name},t))}),"|",(0,n.jsx)(m.I,{placeholder:"Search for Asset Name",onChange:e=>{let t=e.target.value.toLowerCase();eb(eS.filter(e=>e.asset_name.toLowerCase().includes(t)))},width:"300px",ml:5}),(0,n.jsx)(p.X,{ml:5,isChecked:eo,onChange:e=>{er(e.target.checked),eb(e.target.checked?eE:eC.length>eE.length?eC:eS.filter(e=>!eE.includes(e)))},children:"Show Unqualified Vaults"}),(0,n.jsx)(x.g,{placeholder:"Paste TokenIds here (one per line)",value:eQ,onChange:e=>eW(e.target.value),width:"300px",ml:5,rows:4}),(0,n.jsx)(g.z,{ml:2,onClick:function(){q({loaded:!1});let e=eQ.split("\n").filter(e=>""!==e.trim());if(0===e.length){alert("Please paste valid token IDs"),q({loaded:!0});return}fetch("".concat(R.N0,"/vaults"),{method:"POST",headers:{"Content-Type":"application/json","x-api-key":localStorage.apiKey},body:JSON.stringify({tokenIds:e})}).then(e=>e.json()).then(e=>{eb(e),eN(e),q({loaded:!0}),e6.log("Loaded ".concat(e.length," vaults from provided token IDs"))}).catch(e=>{console.error("Error fetching vaults:",e),alert("Error fetching vaults. Please try again."),q({loaded:!0})})},children:"Load"})]}),(0,n.jsxs)(f.k,{alignItems:"center",children:[(0,n.jsx)(g.z,{margin:5,onClick:()=>te(),children:"Marketplace Refresh Selected Records"}),(0,n.jsx)(g.z,{margin:5,onClick:()=>(function(){let e=new Blob([JSON.stringify(eV.length>0?eC.filter(e=>eV.includes(e.tokenid)):eC,null,2)],{type:"application/json"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="exported_records.json",a.click(),URL.revokeObjectURL(t)})(),children:"Export Selected Records"}),(0,n.jsx)(N.xu,{id:"migrationUpdates",marginLeft:5,padding:5,borderWidth:1,borderRadius:"lg",maxHeight:"200px",overflowY:"auto",children:(0,n.jsx)(j.x,{fontSize:"lg",fontWeight:"bold",children:eL?"TEST MODE: updates":"Updates"})}),(0,n.jsx)(g.z,{margin:5,onClick:()=>{eb(eC.reduce((e,t)=>e.find(e=>e.asset_name===t.asset_name)?e:e.concat([t]),[])),e6.log("Filtered to unique vaults by name using reduce")},children:"Unique"})]}),(0,n.jsx)(N.xu,{width:"100%",overflow:"visible",children:(0,n.jsx)(B,{vaults:eC,onAssetNameClick:e2,onProjectClick:e1,onAssetChainClick:e5,onCategoryClick:e9,onStatusClick:e7,getCuratedByContractNetwork:function(e,t){return V&&V.length>0&&"mainnet"===t&&V.find(t=>t.contracts[1]===e)||null},setModalImage:eP,onOpen:eM,selectionModel:eV,onSelectionModelChange:e=>{eF(e)},onContractAddressClick:e3,enableColumnFilter:!0})}),(0,n.jsx)(g.z,{margin:5,onClick:()=>te(),children:"Marketplace Refresh Selected Records"})]}):null}),(0,n.jsx)(d.x,{children:V&&(0,n.jsx)(eT,{style:{backgroundColor:"var(--background-color)",color:"var(--text-color)",margin:"20px",borderRadius:"10px"},columns:[{field:"name",headerName:"Asset Name",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e2(e.value)},children:e.value})},{field:"description",headerName:"Description",width:200},{field:"addressChain",headerName:"Chain",width:100,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),e5(e.value)},children:e.value})},{field:"balanceQty",headerName:"Balance Quantity",width:100},{field:"loadingImages",headerName:"Image",width:200,renderCell:e=>{var t;return(0,n.jsx)(N.xu,{position:"relative",zIndex:"docked",children:(0,n.jsx)(u.E,{src:null==e?void 0:null===(t=e.value)||void 0===t?void 0:t[0],alt:"Asset Image",boxSize:"64px",onClick:()=>{var t;eP(null==e?void 0:null===(t=e.value)||void 0===t?void 0:t[0]),eM()}})})}},{field:"balanceUrl",headerName:"Balance URL",width:400,renderCell:e=>(0,n.jsx)(h.r,{href:null==e?void 0:e.value.toString(),isExternal:!0,style:{fontSize:"8px"},children:null==e?void 0:e.value})},{field:"vaultCollectionType",headerName:"Collection Type",width:200}],rows:V.map((e,t)=>({id:e.id,created_at:e.created_at,name:e.name,description:e.description,addressChain:e.addressChain,balanceQty:e.balanceQty,balanceUrl:e.balanceUrl,loadingImages:e.loadingImages,vaultCollectionType:e.vaultCollectionType})),autoHeight:!0})})]})]}),(0,n.jsxs)(w.u_,{isOpen:eA,onClose:eU,children:[(0,n.jsx)(y.Z,{}),(0,n.jsxs)(k.h,{children:[(0,n.jsx)(C.x,{children:"Asset Image"}),(0,n.jsx)(b.o,{}),(0,n.jsx)(S.f,{children:(0,n.jsx)(u.E,{src:eD,alt:"Asset Image"})})]})]})]})}function J(){return(0,n.jsx)(q,{})}}},function(e){e.O(0,[314,586,793,527,233,838,662,29,149,294,729,888,774,179],function(){return e(e.s=95208)}),_N_E=e.O()}]);