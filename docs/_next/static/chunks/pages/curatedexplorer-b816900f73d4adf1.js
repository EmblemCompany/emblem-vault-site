(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3859],{95208:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/curatedexplorer",function(){return a(80827)}])},80827:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return L}});var n=a(85893),l=a(7335),r=a(45161),o=a(36752),c=a(77458),i=a(35232),d=a(72047),s=a(37365),u=a(6089),h=a(32883),m=a(93717),f=a(33090),p=a(93108),g=a(41731),v=a(89645),j=a(16576),x=a(7636),C=a(70727),w=a(46685),k=a(89693),y=a(89423),b=a(57747),_=a(70758),N=a.n(_),S=a(11163),E=a(67294),I=a(61256),T=a(96084),R=a(83230),A=a(77294),D=a(77044);function U(){let e=(0,S.useRouter)(),{account:t,chainId:a,library:_}=(0,D.Ge)(),{asPath:U}=e,L=new URLSearchParams(window.location.search),P=L.get("tab")?Number(L.get("tab")):0,M=L.get("filterType")||null,z=L.get("filterValue")||null,[G,O]=(0,E.useState)({loaded:!0}),[V,B]=(0,E.useState)(null),[q,H]=(0,E.useState)(null),[Q,F]=(0,E.useState)(null),[J,X]=(0,E.useState)(!1),[Z,K]=(0,E.useState)([]),[W,$]=(0,E.useState)([]),[Y,ee]=(0,E.useState)(1),[et,ea]=(0,E.useState)(!1),[en,el]=(0,E.useState)(null),[er,eo]=(0,E.useState)(null),[ec,ei]=(0,E.useState)([]),[ed,es]=(0,E.useState)([]),[eu,eh]=(0,E.useState)([]),[em,ef]=(0,E.useState)(null),[ep,eg]=(0,E.useState)(null),[ev,ej]=(0,E.useState)([]),[ex,eC]=(0,E.useState)([]),ew=T._$r,[ek,ey]=(0,E.useState)(P),{isOpen:eb,onOpen:e_,onClose:eN}=(0,l.q)(),[eS,eE]=(0,E.useState)(null),{colorMode:eI}=(0,r.If)(),eT="dark"===eI,eR=t=>{ey(t);let a=new URLSearchParams(window.location.search);a.set("tab",t),e.push("".concat(e.pathname,"?").concat(a.toString()))};function eA(e){ef(e),fetch("".concat(I.N0,"/asset_metadata/projects"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project:e})}).then(e=>e.json()).then(e=>{eh(e)})}function eD(t){O({loaded:!1}),ef(t),fetch("".concat(I.N0,"/vaults?project=").concat(t),{method:"GET"}).then(e=>e.json()).then(a=>{ej(a),O({loaded:!0}),e.push("".concat(e.pathname,"?filterType=project&filterValue=").concat(encodeURIComponent(t),"&tab=").concat(ek))})}function eU(t){O({loaded:!1}),ef(t),fetch("".concat(I.N0,"/vaults?asset_name=").concat(encodeURIComponent(t)),{method:"GET"}).then(e=>e.json()).then(a=>{ej(a),O({loaded:!0}),e.push("".concat(e.pathname,"?filterType=asset_name&filterValue=").concat(encodeURIComponent(t),"&tab=").concat(ek))})}function eL(t){O({loaded:!1}),ef(t),fetch("".concat(I.N0,"/vaults?asset_chain=").concat(t),{method:"GET"}).then(e=>e.json()).then(a=>{ej(a),O({loaded:!0}),e.push("".concat(e.pathname,"?filterType=asset_chain&filterValue=").concat(t,"&tab=").concat(ek))})}function eP(t){O({loaded:!1}),ef(t),fetch("".concat(I.N0,"/vaults?category=").concat(t),{method:"GET"}).then(e=>e.json()).then(a=>{ej(a),O({loaded:!0}),e.push("".concat(e.pathname,"?filterType=category&filterValue=").concat(t,"&tab=").concat(ek))})}function eM(t){O({loaded:!1}),ef(t),fetch("".concat(I.N0,"/vaults?status=").concat(t),{method:"GET"}).then(e=>e.json()).then(a=>{ej(a),O({loaded:!0}),e.push("".concat(e.pathname,"?filterType=status&filterValue=").concat(t,"&tab=").concat(ek))})}function ez(e,t){if("mainnet"==t)return q.find(t=>t.contracts[1]==e)||null}async function eG(e){let t=q.find(e=>e.name==er);if(!er||!t)return alert("Target contract address not found");if(0==e.length)return alert("No vaults to migrate");try{let n="ERC1155"==t.collectionType?I.q7.erc1155Abi:I.q7.erc721aAbi,l=new A.CH(t.contracts[a],n).connect(_.getSigner()),r=await l.estimateGas.mintMany(e.map(e=>e.to),e.map(e=>e.tokenId));alert("Estimated gas for mintMany: ".concat(11*r*1e-9))}catch(e){console.error("Error estimating gas for mintMany:",e)}}async function eO(e){if(""===e.target.value||er&&e.target.value!==er){ej(ex),""===e.target.value&&eo(null);return}eo(e.target.value);let t=await R.SZ.fetchCuratedContractByName(e.target.value,en);0===ex.length&&eC(ev);let a=ex.length>0?ex:ev,n=a.filter(e=>{let a=!e.fraud,n="erc721Legacy"===e.category,l=e.balance>=1,r=0===e.jumps_count,o="claimed"!==e.status,c=t.allowed(e.balances,t);return a&&n&&l&&r&&o&&c}),l=a.filter(e=>{let a=!e.fraud,n="erc721Legacy"===e.category,l=e.balance>=1,r=0===e.jumps_count,o="claimed"!==e.status,c=t.allowed(e.balances,t);return!(a&&n&&l&&r&&o&&c)});ej(et?l:n)}return(0,E.useEffect)(()=>{er&&eO({target:{value:er}})},[et]),(0,E.useEffect)(()=>{z&&!em&&(ef(()=>decodeURIComponent(z)),"project"===M?eD(decodeURIComponent(z)):"asset_name"===M?eU(decodeURIComponent(z)):"asset_chain"===M?eL(decodeURIComponent(z)):"category"===M?eP(decodeURIComponent(z)):"status"===M&&eM(decodeURIComponent(z)))},[z,em]),(0,E.useEffect)(()=>{fetch("".concat(I._z,"/curated")).then(e=>e.json()).then(e=>{H(e),F(e)})},[]),(0,E.useEffect)(()=>{en||(0,R.f_)().then(e=>{el(e)})},[]),(0,E.useEffect)(()=>{q&&0===W.length&&fetch("".concat(I.N0,"/v3/deployments")).then(e=>e.json()).then(e=>{$(e.filter((e,t)=>!q.some(t=>t.contracts["1"]==e.address)&&e.name.includes("upgradableERC")))})},[q,W]),(0,E.useEffect)(()=>{fetch("".concat(I.N0,"/asset_metadata/projects/vaulted")).then(e=>e.json()).then(e=>{ei(e)})},[]),(0,E.useEffect)(()=>{fetch("".concat(I.N0,"/asset_metadata/projects")).then(e=>e.json()).then(e=>{es(e)})},[]),(0,n.jsxs)(N(),{loaded:G.loaded,children:[(0,n.jsxs)(o.m,{index:ek,onChange:eR,colorScheme:eT?"white":"black",children:[(0,n.jsx)(c.t,{children:["Tracked Metadata Projects","Metadata Project","Vaulted Projects","Vaults","Curated Collections"].map((e,t)=>(0,n.jsxs)(i.O,{isDisabled:!(0===t||2===t||4===t)&&!em,fontWeight:ek===t?"bold":"normal",color:ek===t?eT?"white":"black":eT?"gray":"black",children:[e," ",em&&(1===t||3===t)?"(: ".concat(em,")"):""]},t))}),(0,n.jsxs)(d.n,{children:[(0,n.jsx)(s.x,{children:ed.length>0&&(0,n.jsx)(ew,{style:{backgroundColor:"var(--background-color)",color:eT?"white":"black",margin:"20px",borderRadius:"10px"},columns:[{field:"project_name",headerName:"Project Name",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eA(e.value),eD(e.value),eR(1)},children:e.value})},{field:"protocol",headerName:"Protocol",width:200},{field:"total_assets_count",headerName:"Total Assets Count",width:200}],rows:ed.map((e,t)=>({id:t,project_name:e.project_name,protocol:e.protocol,total_assets_count:e.total_assets_count})),autoHeight:!0})}),(0,n.jsx)(s.x,{children:eu.length>0&&(0,n.jsx)(ew,{style:{backgroundColor:"var(--background-color)",color:"var(--text-color)",margin:"20px",borderRadius:"10px"},columns:[{field:"asset_name",headerName:"Asset Name",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eU(e.value),eR(1)},children:e.value})},{field:"project_name",headerName:"Project Name",width:200},{field:"chain",headerName:"Chain",width:100},{field:"supply",headerName:"Supply",width:100},{field:"image",headerName:"Image",width:200,renderCell:e=>{var t;return(0,n.jsx)(b.xu,{position:"relative",zIndex:"docked",children:(0,n.jsx)(u.E,{src:null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.toString(),alt:"Asset Image",boxSize:"64px",onClick:()=>{var t;eE(null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.toString()),e_()}})})}},{field:"link",headerName:"Link",width:300,renderCell:e=>{var t,a;return(0,n.jsx)(h.r,{href:null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.toString(),isExternal:!0,children:null==e?void 0:null===(a=e.value)||void 0===a?void 0:a.toString()})}}],rows:eu.map((e,t)=>({id:e.id,created_at:e.created_at,asset_name:e.asset_name,project_name:e.project_name,chain:e.chain,supply:e.supply,link:e.link,image:e.image})),autoHeight:!0})}),(0,n.jsx)(s.x,{children:ec.length>0&&(0,n.jsx)(ew,{style:{backgroundColor:"var(--background-color)",color:"var(--text-color)",margin:"20px",borderRadius:"10px"},columns:[{field:"project",headerName:"Project",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eD(e.value),eA(e.value),eR(3)},children:e.value})},{field:"project_count",headerName:"Project Count",width:200}],rows:ec.map((e,t)=>({id:t,project:e.project,project_count:e.project_count})),autoHeight:!0})}),(0,n.jsx)(s.x,{children:(null==ev?void 0:ev.length)>0||er?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(m.k,{direction:"row",align:"center",children:[(0,n.jsx)(f.I,{type:"number",ml:5,value:Y,onChange:e=>ee(Number(e.target.value)),placeholder:"Enter thread count",width:"100px"}),(0,n.jsx)(p.z,{margin:5,onClick:function(){let e=0,t=ev.reverse().filter((e,t,a)=>t===a.findIndex(t=>t.tokenid===e.tokenid&&"claimed"!==t.status&&"deleted"!==t.status)),a=t.length,n=Math.ceil(a/Y),l=async function(r,o){let c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=r+o*n;if(i>=a)return;let d=t[i];if(d&&d.tokenid){console.log("Refreshing balance for vault",d.tokenid,"at index",i,"of",a,"vaults","thread #",o),eg("".concat(e," of ").concat(a," vaults * ").concat(Y," threads"));try{await R.SZ.refreshBalance(d.tokenid),e+=1,setTimeout(()=>l(r+1,o),5e3)}catch(e){if(console.error("Error refreshing balance:",e),c<7){let e=1e3*Math.pow(2,c);console.log("Retrying in",e,"ms"),setTimeout(()=>l(r,o,c+1),e)}else console.log("Failed to refresh balance after 7 attempts, moving to next index"),setTimeout(()=>l(r+1,o),5e3)}}else setTimeout(()=>l(r+1,o),0);e>=a&&eg("complete")};for(let e=0;e<Y;e++)e*n<a&&l(0,e)},children:(0,n.jsxs)("div",{children:["Refresh Internal Balances ",ep]})}),"|",(0,n.jsx)(p.z,{margin:5,onClick:()=>{!function(e){if(!er)return alert("Target contract is not defined");let t=document.querySelectorAll(".MuiDataGrid-row.Mui-selected"),a=[];!function n(l){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1],l>=t.length)return console.log("Migrated vaults:",a),eG(a);let r=Array.from(t[l].children).find(t=>t.getAttribute("data-field")===e),o=r?r.getAttribute("data-value"):null,c=ev.find(e=>e.tokenid===o);c?(console.log("Migrating vault:",c.tokenid),fetch("".concat(I._z,"/jump/").concat(c.tokenid,"/").concat(er,"/").concat("mainnet"==c.network?1:99999999999,"?testOnly=true"),{method:"GET",headers:{"content-type":"application/json","x-api-key":localStorage.apiKey}}).then(e=>e.json()).then(e=>{e.error?console.error("Error migrating vault:",e.msg):(console.log("Successfully migrated vault:",c.tokenid),a.push(e)),n(l+1)}).catch(e=>{alert("Error making API call:', ".concat(e)),n(l+1)})):n(l+1)}(0)}("tokenid")},children:(0,n.jsx)("div",{children:"Migrate"})}),(0,n.jsx)(g.P,{margin:5,placeholder:"Select contract",onChange:async e=>await eO(e),width:"350px",children:en.map((e,t)=>(0,n.jsx)("option",{value:e.name,children:e.name},t))}),"|",(0,n.jsx)(f.I,{placeholder:"Search for Asset Name",onChange:e=>{let t=e.target.value.toLowerCase();ej(ex.filter(e=>e.asset_name.toLowerCase().includes(t)))},width:"300px",ml:5}),(0,n.jsx)(v.X,{ml:5,onChange:async e=>{ea(e.target.checked)},children:"Show Unqualified Vaults"})]}),(0,n.jsx)(p.z,{margin:5,onClick:()=>(function(){let e;let t=document.querySelectorAll(".MuiDataGrid-row.Mui-selected");if(t.length>0){let a=Array.from(t).map(e=>{let t=Array.from(e.children).find(e=>"tokenid"===e.getAttribute("data-field"));return t?t.getAttribute("data-value"):null}).filter(e=>null!==e);e=ev.filter(e=>a.includes(e.tokenid))}else e=ev;let a=JSON.stringify(e,null,2),n=new Blob([a],{type:"application/json"}),l=URL.createObjectURL(n),r=document.createElement("a");r.href=l,r.download="exported_records.json",r.click(),URL.revokeObjectURL(l)})(),children:"Export Selected Records"}),(0,n.jsx)(ew,{style:{backgroundColor:"var(--background-color)",color:"var(--text-color)",margin:"20px",borderRadius:"10px"},columns:[{field:"asset_name",headerName:"Asset Name",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eU(e.value)},children:e.value})},{field:"project",headerName:"Project",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eD(e.value)},children:e.value})},{field:"asset_chain",headerName:"Chain",width:100,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eL(e.value)},children:e.value})},{field:"network",headerName:"Network",width:150,renderCell:e=>(0,n.jsx)("span",{children:e.value})},{field:"balance",headerName:"Balance",width:100},{field:"image",headerName:"Image",width:100,renderCell:e=>{var t;return(0,n.jsx)(b.xu,{position:"relative",zIndex:"docked",children:(0,n.jsx)(u.E,{src:null==e?void 0:null===(t=e.value)||void 0===t?void 0:t.toString(),alt:"Asset Image",boxSize:"64px",onClick:()=>{eE(null==e?void 0:e.value),e_()}})})}},{field:"tokenid",headerName:"Token ID",width:150,renderCell:e=>(0,n.jsx)(h.r,{href:"erc721Legacy"===e.row.category?"https://emblem.finance/nft?id=".concat(e.value):"https://emblem.finance/nft2?id=".concat(e.value),isExternal:!0,children:e.value})},{field:"category",headerName:"Category",width:150,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eP(e.value)},children:e.value})},{field:"status",headerName:"Status",width:150,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eM(e.value)},children:e.value})},{field:"contract",headerName:"Contract",width:150,renderCell:e=>{var t,a;return(0,n.jsxs)(n.Fragment,{children:["erc721Legacy"!==e.row.category&&(0,n.jsx)(u.E,{src:null===(t=ez(e.value,e.row.network))||void 0===t?void 0:t.loadingImages[0],boxSize:"25px"}),(0,n.jsx)(h.r,{href:"https://etherscan.io/address/".concat(e.value),isExternal:!0,children:"erc721Legacy"===e.row.category?"Legacy":null===(a=ez(e.value,e.row.network))||void 0===a?void 0:a.name})]})}},{field:"fraud",headerName:"\uD83D\uDEA9",width:100,renderCell:e=>e.value?"\uD83D\uDEA9":""},{field:"jumps_count",headerName:"Jumps",width:150,renderCell:e=>(0,n.jsx)("span",{children:e.value})}],rows:ev.map((e,t)=>({id:e.tokenid,asset_name:e.asset_name,project:e.project,asset_chain:e.asset_chain,network:e.network,balance:e.balance,image:e.image,tokenid:e.tokenid,category:e.category,status:e.status,contract:e.contract,fraud:e.fraud,jumps_count:e.jumps_count})),autoHeight:!0,checkboxSelection:!0})]}):null}),(0,n.jsx)(s.x,{children:q&&(0,n.jsx)(ew,{style:{backgroundColor:"var(--background-color)",color:"var(--text-color)",margin:"20px",borderRadius:"10px"},columns:[{field:"name",headerName:"Asset Name",width:200,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eU(e.value)},children:e.value})},{field:"description",headerName:"Description",width:200},{field:"addressChain",headerName:"Chain",width:100,renderCell:e=>(0,n.jsx)("a",{href:"#",onClick:t=>{t.preventDefault(),eL(e.value)},children:e.value})},{field:"balanceQty",headerName:"Balance Quantity",width:100},{field:"loadingImages",headerName:"Image",width:200,renderCell:e=>{var t;return(0,n.jsx)(b.xu,{position:"relative",zIndex:"docked",children:(0,n.jsx)(u.E,{src:null==e?void 0:null===(t=e.value)||void 0===t?void 0:t[0],alt:"Asset Image",boxSize:"64px",onClick:()=>{var t;eE(null==e?void 0:null===(t=e.value)||void 0===t?void 0:t[0]),e_()}})})}},{field:"balanceUrl",headerName:"Balance URL",width:400,renderCell:e=>(0,n.jsx)(h.r,{href:null==e?void 0:e.value.toString(),isExternal:!0,style:{fontSize:"8px"},children:null==e?void 0:e.value})},{field:"vaultCollectionType",headerName:"Collection Type",width:200}],rows:q.map((e,t)=>({id:e.id,created_at:e.created_at,name:e.name,description:e.description,addressChain:e.addressChain,balanceQty:e.balanceQty,balanceUrl:e.balanceUrl,loadingImages:e.loadingImages,vaultCollectionType:e.vaultCollectionType})),autoHeight:!0})})]})]}),(0,n.jsxs)(j.u_,{isOpen:eb,onClose:eN,children:[(0,n.jsx)(x.Z,{}),(0,n.jsxs)(C.h,{children:[(0,n.jsx)(w.x,{children:"Asset Image"}),(0,n.jsx)(k.o,{}),(0,n.jsx)(y.f,{children:(0,n.jsx)(u.E,{src:eS,alt:"Asset Image"})})]})]})]})}function L(){return(0,n.jsx)(U,{})}}},function(e){e.O(0,[4314,758,7119,1793,2344,4745,9645,6566,2916,2083,2888,9774,179],function(){return e(e.s=95208)}),_N_E=e.O()}]);