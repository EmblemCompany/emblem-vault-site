_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[26],{CKsJ:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/nft",function(){return n("Z8wp")}])},Z8wp:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return X}));var a=n("q1tI"),r=n.n(a),o=n("wx14"),i=n("o0o1"),c=n.n(i),s=n("HaE+"),l=n("XZ7F"),u=n("Weur"),d=n("BMxC"),f=n("Yn+B"),p=n("bQFp"),m=n("sK1y"),b=n("FpzS"),h=n("7fKF"),g=n("pboS"),v=n("IP4Q"),w=n("eJLp"),O=n("MKZ1"),j=n("jgTY"),y=n("LqLE"),S=n("8Kt/"),x=n.n(S),C=n("Z6YE"),k=n("nOHt"),T=n("Ute3"),E=n("Y1ui"),_=n.n(E),A=n("a6RD"),I=n.n(A),H=n("iBPG"),N=n("zIq6"),F=n("N39q"),G=n("21eR"),P=n("c+OE"),V=n.n(P),L=n("NFKh"),J=n.n(L),K=n("sd7e"),W=n("IujW"),R=n.n(W),M=n("wH4i"),q=n.n(M),B=r.a.createElement,D=I()((function(){return Promise.all([n.e(10),n.e(16)]).then(n.bind(null,"X/Jl"))}),{loadableGenerated:{webpack:function(){return["X/Jl"]},modules:["./AddrModal"]}}),U=I()((function(){return Promise.all([n.e(10),n.e(17)]).then(n.bind(null,"0bCS"))}),{loadableGenerated:{webpack:function(){return["0bCS"]},modules:["./KeysModal"]}});function Y(){var e,t=Object(C.b)(),n=t.account,i=t.chainId,S=t.library,E=Object(k.useRouter)().query,A=Object(a.useState)(!1),I=A[0],P=A[1],L=Object(a.useState)(E.key),W=L[0],M=L[1],Y=Object(a.useState)(E.framed||!0),z=Y[0],X=(Y[1],Object(a.useState)(E.id)),Z=X[0],Q=(X[1],Object(a.useState)(E.experimental)),$=(Q[0],Q[1],Object(a.useState)("")),ee=$[0],te=$[1],ne=Object(a.useState)(""),ae=ne[0],re=ne[1],oe=Object(a.useState)(""),ie=oe[0],ce=oe[1],se=Object(a.useState)([]),le=se[0],ue=se[1],de=Object(a.useState)([]),fe=de[0],pe=de[1],me=Object(a.useState)([]),be=me[0],he=me[1],ge=Object(a.useState)(!1),ve=ge[0],we=ge[1],Oe=Object(a.useState)(0),je=Oe[0],ye=Oe[1],Se=Object(a.useState)(null),xe=Se[0],Ce=Se[1],ke=Object(a.useState)(null),Te=ke[0],Ee=ke[1],_e=Object(a.useState)(""),Ae=_e[0],Ie=_e[1],He=Object(a.useState)(""),Ne=He[0],Fe=He[1],Ge=Object(a.useState)({loaded:!1}),Pe=Ge[0],Ve=Ge[1],Le=Object(a.useState)(!1),Je=Le[0],Ke=Le[1],We=Object(a.useState)(!1),Re=We[0],Me=We[1],qe=Object(a.useState)("claimed"),Be=qe[0],De=qe[1],Ue=Object(a.useState)(null),Ye=Ue[0],ze=Ue[1],Xe=Object(a.useState)(""),Ze=Xe[0],Qe=Xe[1],$e=Object(a.useState)(""),et=$e[0],tt=$e[1],nt=Object(a.useState)(""),at=nt[0],rt=nt[1],ot=Object(a.useState)([]),it=ot[0],ct=ot[1],st=Object(a.useState)(!1),lt=st[0],ut=st[1],dt=Object(a.useState)(""),ft=dt[0],pt=dt[1],mt=Object(a.useState)(!1),bt=mt[0],ht=mt[1],gt=Object(a.useState)(""),vt=gt[0],wt=gt[1],Ot=Object(a.useState)(!1),jt=Ot[0],yt=Ot[1],St=Object(a.useState)(!1),xt=(St[0],St[1],Object(a.useState)(!1)),Ct=xt[0],kt=xt[1],Tt=Object(a.useState)(!1),Et=Tt[0],_t=Tt[1],At=Object(a.useState)(!1),It=At[0],Ht=At[1],Nt=Object(a.useState)(""),Ft=Nt[0],Gt=Nt[1],Pt=Object(a.useState)(!1),Vt=Pt[0],Lt=Pt[1],Jt=Object(a.useState)(!1),Kt=Jt[0],Wt=Jt[1],Rt=Object(a.useState)(null),Mt=Rt[0],qt=Rt[1],Bt=Object(a.useState)(!1),Dt=Bt[0],Ut=Bt[1],Yt=Object(G.b)(F.p.vaultHandler[i],F.p.vaultHandlerAbi,!0),zt=Object(G.b)(F.p.emblemVault[i],F.p.emblemAbi,!0),Xt=Object(l.a)(),Zt=Xt.isOpen,Qt=Xt.onOpen,$t=Xt.onClose,en=Object(l.a)(),tn=en.isOpen,nn=en.onOpen,an=en.onClose,rn=Object(l.a)(),on=rn.isOpen,cn=rn.onToggle,sn=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return bn(),e.next=3,fetch(F.h+"/meta/"+Z+"?experimental=true",{method:"GET",headers:{"Content-Type":"application/json",service:"evmetadata"}});case 3:return t=e.sent,e.next=6,t.json();case 6:(n=e.sent).name?(un(n),mn(n),ut(!1),yt(!1)):(Ve({loaded:!0}),yt(!0));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ln=function(){var e=Object(s.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(F.h+"/witness/"+Z,{method:"GET",headers:{"Content-Type":"application/json",service:"evmetadata",chainid:i.toString()}});case 2:return n=e.sent,e.next=5,n.json();case 5:if(!(a=e.sent).signature){e.next=11;break}return console.log("witness",a),e.abrupt("return",t(a));case 11:return e.abrupt("return",t(!1));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),un=function(e){z&&!e.image.includes("framed=")&&!e.image.includes("http")&&(e.image=e.image+"&framed="+z),te(e.name),ce(e.image),re(e.description),ye(e.totalValue||0),ue(le.concat(e.values)),pe(e.attributes.filter((function(e){return"key"===e.trait_type}))),re(e.description),he(e.addresses),Ce("mainnet"==e.network?1:"rinkeby"==e.network?4:"mumbai"==e.network?80001:"matic"==e.network?137:97),De(e.status),"claimed"===Be&&ze(e.claimedBy),Ve({loaded:!0});var t=e.addresses.filter((function(e){return e.address.includes("private:")})).length>0;we(t),setTimeout((function(){!t&&pn(e.values,e.addresses.filter((function(e){return"ETH"===e.coin}))[0].address,(function(e){ue(e)}))}),5)},dn=function(){var e=Object(s.a)(c.a.mark((function e(t,n){var a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(F.h+"/eth/balance/"+t,{method:"GET",headers:{"Content-Type":"application/json",service:"evmetadata"}});case 2:return a=e.sent,e.next=5,a.json();case 5:return r=e.sent,ye(Number(je)+Number(r.totalValue)),e.abrupt("return",n(r.values));case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),fn=function(){var e=Object(s.a)(c.a.mark((function e(t,n,a){var r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(F.h+"/btc/balance/"+n,{method:"GET",headers:{"Content-Type":"application/json",service:"evmetadata"}});case 2:return r=e.sent,e.next=5,r.json();case 5:return o=e.sent,e.abrupt("return",a(t.concat(o.values)));case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),pn=function(){var e=Object(s.a)(c.a.mark((function e(t,n,a){var r,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(F.h+"/eth/nft/"+n,{method:"GET",headers:{"Content-Type":"application/json",service:"evmetadata"}});case 2:return r=e.sent,e.next=5,r.json();case 5:if(!((o=e.sent).length>0)){e.next=10;break}return e.abrupt("return",a(t.concat(o)));case 10:return e.abrupt("return",a(t));case 11:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),mn=function(e){localStorage.setItem(n+"_"+i+"_"+Z+"_vault",JSON.stringify(e))},bn=function(){var e=JSON.parse(localStorage.getItem(n+"_"+i+"_"+Z+"_vault"));e&&(Ve({loaded:!0}),un(e),ut(!0))},hn=function(){var e=localStorage.getItem(n+"_"+i+"_"+Z+"_mintPassword");e&&It&&M(e)},gn=function(){var e=Object(s.a)(c.a.mark((function e(t,n,a){var r,o,s,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=new Headers).append("chainId",i.toString()),r.append("service","evmetadata"),r.append("Content-Type","application/json"),o=JSON.stringify({signature:t}),e.next=7,fetch(F.h+"/verify/"+n,{method:"POST",headers:r,body:o,redirect:"follow"});case 7:return s=e.sent,e.next=10,s.json();case 10:return l=e.sent,e.abrupt("return",a(l));case 12:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),vn=function(){var e=Object(s.a)(c.a.mark((function e(){var t,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.prev=1,e.next=4,zt.ownerOf(Z);case 4:return t=e.sent,e.next=7,Yt.getPreTransfer(Z);case 7:return a=e.sent,e.next=10,zt.isApprovedForAll(n,F.p.vaultHandler[i]);case 10:r=e.sent,P(r),Ht("0x0000000000000000000000000000000000000000"!==a._from),Ke(t===n),hn(),e.next=19;break;case 17:e.prev=17,e.t0=e.catch(1);case 19:case"end":return e.stop()}}),e,null,[[1,17]])})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){}));var wn=function(){var e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S.getSigner(n).signMessage("Claim: "+Z).then((function(e){gn(e,Z,(function(e){Qe(e.decrypted.phrase),tt(e.decrypted.keys.filter((function(e){return"btc"===e.coin}))[0].privkey),rt(e.decrypted.keys.filter((function(e){return"eth"===e.coin}))[0].privkey),ct(e.decrypted.values),nn()}))}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),On=function(){var e=Object(s.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:zt.transferFrom(n,F.c,Z).then((function(e){var t=e.hash;Me(!0),setTimeout((function(){Ee(t)}),100)}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),jn=function(){var e=Object(s.a)(c.a.mark((function e(){var t,n,a,r,o,i,s,l,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=function(e){for(var c=0;c<r-i;c++){var u=Math.floor(t.length*Math.random()),d=t.charAt(u);s+=d}o==a-1&&i++,o==a&&(l+=n.charAt(i-1),o=0),pt(l+s),s=""},!bt){e.next=3;break}return e.abrupt("return");case 3:ht(!0),t="abcdefghijklmnopqrstuvwxyz",5,r=(n="Decrypting").length,o=0,i=0,s="",l="",function e(t){setTimeout((function(){--t?e(t):ht(!1),u(t),o+=1}),5)}(r*(a=8)+1);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function yn(e){return e.split("\n\n\n\n")[0].trim()}function Sn(e){vt&&(e=vt),jn();var t=be[0].address.replace("private:","");try{var n=J.a.AES.decrypt(t,e);JSON.parse(n.toString(J.a.enc.Utf8)),we(!1),wt(e),he(function(e){return be.forEach((function(t){var n=t.address.replace("private:","");t.address=function(e,t){var n=J.a.AES.decrypt(e,t);return JSON.parse(n.toString(J.a.enc.Utf8))}(n,e)})),be}(e)),dn(be.filter((function(e){return"ETH"===e.coin}))[0].address,(function(e){fn(e,be.filter((function(e){return"BTC"===e.coin}))[0].address,(function(e){pn(e,be.filter((function(e){return"ETH"===e.coin}))[0].address,(function(e){ue(e.concat(le))}))}))}))}catch(a){}}return Object(a.useEffect)((function(){sn()}),[]),Object(a.useEffect)((function(){n&&i&&xe&&i==xe&&vn()})),B(r.a.Fragment,null,B(x.a,null,B("meta",{name:"twitter:card",content:"summary_large_image"}),B("meta",{name:"twitter:site",content:"Emblem.Finance"}),B("meta",{name:"twitter:title",content:ee}),B("meta",{name:"twitter:description",content:yn(ae)}),B("meta",{name:"twitter:image",content:ie})),B(D,{isOpen:Zt,onClose:$t,addrCoin:Ae,addrAddr:Ne}),B(U,{isOpen:tn,onClose:an,mnemonic:Ze,privKeyBTC:et,privKeyETH:at,privValues:it}),B(_.a,{loaded:Pe.loaded},lt?B(T.a,null):"",jt?B(f.a,{align:"center"},B(p.a,{width:"md",src:"https://starwarsblog.starwars.com/wp-content/uploads/2017/06/25-star-wars-quotes-obi-wan-kenobi-identification-tall.jpg"}),B(m.a,null,"THESE ARE NOT THE VAULTS YOU ARE LOOKING FOR"," ",B(g.a,{color:"#638cd8",href:"../create"},"CREATE ONE HERE!"))):B(V.a,{className:"Tilt",options:{max:0,scale:1}},B(u.a,{width:"full",align:"center",justifyContent:"center"},B(d.a,{maxW:"sm",borderWidth:"1px",borderColor:xe!=i?"orange.500":"claimed"==Be?"green.500":null,rounded:"lg",overflow:"hidden",alignItems:"center",minW:390},xe!=i?B(d.a,{mt:"1",fontWeight:"semibold",as:"h3",lineHeight:"tight",p:2,textAlign:"center",textTransform:"uppercase",alignItems:"center",color:"orange.500"},"BEWARE: Vault is on a different network than you are."):null,B(d.a,{mt:"1",fontWeight:"semibold",as:"h3",lineHeight:"tight",p:2,textAlign:"center",textTransform:"uppercase",alignItems:"center"},ee,ve?null:": ~$"+je),B(f.a,{align:"center"},B(p.a,{src:Object(H.k)(ie)?ie:"https://circuitsofvalue.com/public/coval-logo.png",width:"250px"})),B(f.a,{align:"center"},B(d.a,{mt:"2",ml:"4",lineHeight:"tight"},B(m.a,{mt:2,as:"h4",ml:"4",mr:"4",fontSize:"xs",fontStyle:"italic"},B(R.a,{plugins:[q.a],children:yn(ae)})))),B(d.a,{p:"6"},B(d.a,{d:"flex",alignItems:"baseline"},B(d.a,{color:"gray.500",letterSpacing:"wide",fontSize:"sm",ml:"2"},B(m.a,{as:"h4",fontWeight:"semibold"},"Current Contents:"),ve?B(r.a.Fragment,null,B(m.a,{pb:2,color:ft?"green.500":null},ft||"Contents hidden. Enter password to unlock."),B(b.a,{type:"password",id:"vault-password",onChange:function(e){return Sn(e.target.value)},"aria-describedby":"password-helper-text"})):le.length?le.map((function(e){return B(m.a,{key:e.name,isTruncated:!0},e.address&&"nft"!==e.type?B(h.a,{"aria-label":e.name,hasArrow:!0,label:"Add "+e.symbol+" to wallet",placement:"top"},B(g.a,{onClick:function(){Object(K.addTokenToWallet)({address:e.address,symbol:e.symbol,decimals:e.decimals,image:e.image?e.image:null})}},"+")):null,"(",e.coin.toLowerCase(),")"," ",e.name," :"," ",e.balance?e.balance:"nft"==e.type?B(g.a,{href:e.external_url,isExternal:!0},"View NFT"):null)})):null,fe.length?fe.map((function(e){return B(m.a,null,"Data: ",e.attribute_key)})):fe.length||le.length?null:B(m.a,null,"Nothing in here! Fill 'er up!"))),ve?null:B(d.a,{d:"flex",alignItems:"baseline",justifyContent:"space-between",mt:"4"},B(v.a,{justifyContent:"space-between",spacing:6},be.map((function(e){return B(w.a,{key:e.address,onClick:function(){Ie(e.coin),Fe(e.address),Qt()}},"Put ","ETH"==e.coin?e.coin+"/ERC20":e.coin," In")})))),"claimed"===Be||1!==xe&&4!==xe?null:B(d.a,{d:"flex",alignItems:"baseline",justifyContent:"space-between",mt:"4"},B(w.a,Object(o.a)({width:"100%",as:"a"},{href:"https://"+(4==xe?"rinkeby.":"")+"opensea.io/assets/"+F.p.emblemVault[xe]+"/"+Z,target:"_blank",rel:"noopener noreferrer"}),Je?"Sell (Opensea)":"Make an Offer (Opensea)")),"claimed"!==Be&&Je&&!It?B(r.a.Fragment,null,B(d.a,{d:"flex",alignItems:"baseline",justifyContent:"space-between",mt:"4",width:"100%"},B(f.a,{direction:"column",align:"center",width:"100%"},B(w.a,{width:"100%",onClick:cn},"Transfer Vault"),B(O.a,{isOpen:on},B(d.a,{d:"flex",alignItems:"baseline",justifyContent:"space-between",mt:"2",width:"100%"},B(j.a,{htmlFor:"owner-address"},"Address"),B(b.a,{mt:1,type:"text",id:"transferAddress",value:Mt||"",onChange:function(e){console.log("Transfer to",e.target.value),qt(e.target.value)},autoComplete:"off"})),B(d.a,{d:"flex",alignItems:"baseline",justifyContent:"space-between",mt:"2",width:"100%"},B(w.a,{isDisabled:!Object(H.h)(Mt),onClick:function(){cn(),Ut(!0),zt.transferFrom(n,Mt,Z).then((function(e){var t=e.hash;Ee(t)})).catch((function(e){}))}},"Transfer Now")))))):null,Je&&!It?B(r.a.Fragment,null,B(d.a,{d:"flex",alignItems:"baseline",justifyContent:"space-between",mt:"4"},B(w.a,{width:"100%",onClick:function(){if(!I)return _t(!0),void zt.setApprovalForAll(F.p.vaultHandler[i],!0).then((function(e){var t=e.hash;setTimeout((function(){Ee(t)}),100)})).catch((function(e){4001!==(null===e||void 0===e?void 0:e.code)?console.log("tx failed.",e):_t(!1)}));var t=J.a.lib.WordArray.random(16).toString(),n=J.a.SHA256(t).toString();console.log("plain",t),console.log("sha",n),Gt(t),e=n,setTimeout((function(){console.log("transferImage","0x"+e),Wt(!0),Yt.addPreTransfer(Z,"0x"+e).then((function(e){var t=e.hash;Ee(t),console.log("Set Pre Transfering True",Kt)})).catch((function(e){(null===e||void 0===e?void 0:e.code)&&(console.log("Error?"),Wt(!1),Lt(!1),Gt(""))}))}),500)}}," ",I?"Get Link (Send Vault Via Link)":"Approve Gifting"," "))):null,(Vt||W)&&It?B(d.a,null,B(g.a,{href:location.protocol+"//"+location.host+"/nft?id="+Z+"&key="+(Ft||W)},"Copy Gift Link"),B(m.a,null,"Password: ",Ft||W)):null,It&&Ye!==n?B(r.a.Fragment,null,B(w.a,{mt:2,width:"100%",onClick:function(){console.log(W),kt(!0),ln((function(e){Yt.transferWithCode(Z,W,n,e.nonce,e.signature).then((function(e){var t=e.hash;setTimeout((function(){Ee(t)}),100)})).catch((function(e){kt(!1),4001!==(null===e||void 0===e?void 0:e.code)&&console.log("tx failed.",e)}))}))}},"Accept"),B(b.a,{mt:2,type:"password",id:"mintPassword",minLength:3,maxLength:200,value:W||"",onChange:function(e){console.log("grrr",e.target.value,W),M(e.target.value)},autoComplete:"off"})):null,"claimed"!==Be&&n&&xe===i&&Je?B(d.a,{d:"flex",alignItems:"baseline",justifyContent:"space-between",mt:"4"},B(w.a,{width:"100%",onClick:function(){On()},isDisabled:Re},Re?"Claiming ...":"Claim (Crack Open Vault)")):"claimed"===Be&&Ye===n&&xe===i?B(d.a,{d:"flex",alignItems:"baseline",justifyContent:"space-between",mt:"4"},B(w.a,{width:"100%",onClick:wn},"Get Keys")):null),B(f.a,{direction:"column",align:"center"},"claimed"==Be?B(m.a,{color:"green.500"},"CLAIMED"):null),Te?B(y.a,{status:"info"},B(y.b,null),Ct?"Accepting Your Gift Vault":Re?"Claiming your Vault ...":Et?"Handling Approval Flow ...":Dt?"Transfering Vault ...":"Generating Gift Link ..."):null))),Te?B(N.a,{hash:Te,onComplete:function(){!Re||Ct||Kt?Kt?(localStorage.setItem(n+"_"+i+"_"+Z+"_mintPassword",Ft),Lt(!0),Wt(!1),Ee(null)):Ct?(kt(!1),sn(),Ee(null)):Et?(_t(!1),sn(),Ee(null)):Dt?(Ut(!1),sn(),Ee(null)):(console.log("claiming",Re),console.log("accepting",Ct),console.log("preTransfering",Kt),console.log("approving",Et),console.log("Unknown state")):(console.log(111111),Ee(null),De("claimed"),Me(!1),ze(n),wn())}}):null))}var z=r.a.createElement;function X(){return z(Y,null)}}},[["CKsJ",2,1,5,7,0,3,4,6,9,8,11,12,15,13]]]);