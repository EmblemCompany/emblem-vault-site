(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6003],{96629:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/swap-closed",function(){return n(96107)}])},71114:function(e,t,n){"use strict";var a=n(85893);n(67294);var s=n(93717),l=n(14e3),r=n(81136);t.Z=()=>(0,a.jsxs)(s.k,{pb:2,justify:"center",children:[(0,a.jsx)(l.x,{pr:2,children:"Refreshing "}),(0,a.jsx)(r.$,{})]})},96107:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return A}});var a=n(85893),s=n(14e3),l=n(93717),r=n(51343),i=n(6089),c=n(93108),o=n(57747),h=n(36752),d=n(77458),u=n(35232),x=n(72047),f=n(37365),j=n(70758),m=n.n(j),g=n(71114),p=n(11163),S=n(77044),w=n(67294),b=n(62850),v=n(80902),Z=n(31238),y=n(64541),C=n(41120),T=n(82302),N=n(99613),k=n(88222),E=n(56847),H=n(83750),_=n(57394),I=n(79895);let z=(0,C.Z)({table:{minWidth:650}});function q(e){let{account:t}=(0,S.Ge)(),[n,s]=(0,w.useState)(!1),[l,r]=(0,w.useState)(!1),[i,c]=(0,w.useState)([]),[o,h]=(0,w.useState)(e.chainId),d=z();return w.useEffect(()=>{console.log(o,e.chainId),o!==e.chainId&&(h(e.chainId),console.log("refresh data"),r(!1))}),l||u(e=>{r(!0),c(e)}),(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(E.Z,{component:I.Z,children:(0,a.jsxs)(T.Z,{className:d.table,"aria-label":"simple table",children:[(0,a.jsx)(H.Z,{children:(0,a.jsxs)(_.Z,{children:[(0,a.jsx)(k.Z,{children:"Amount "}),(0,a.jsx)(k.Z,{align:"right",children:"For"}),(0,a.jsx)(k.Z,{align:"left",children:"Hash"}),(0,a.jsx)(k.Z,{align:"right",children:"To Chain"}),(0,a.jsx)(k.Z,{align:"right",children:"Status"})]})}),(0,a.jsx)(N.Z,{children:i.sort((e,t)=>t.blockNumber>e.blockNumber?1:-1).map(e=>2e14>Number(e.returnValues.amount)?(0,a.jsxs)(_.Z,{className:t==e.returnValues.sender?"MyRow":"",children:[(0,a.jsx)(k.Z,{component:"th",scope:"row",children:Number(10*(0,b.aU)(e.returnValues.amount,"gwei")).toLocaleString()}),(0,a.jsx)(k.Z,{align:"right",children:e.returnValues.sender}),(0,a.jsx)(k.Z,{align:"left",children:e.transactionHash}),(0,a.jsx)(k.Z,{align:"right",children:b.zh[e.returnValues.chainId]}),(0,a.jsx)(k.Z,{align:"right",children:"true"==e.transferred?"Complete":"Pending"})]},e.name):null)})]})})});async function u(e){let t=await fetch(Z.HP+"/web3/transfersOutDb?pending="+n,{method:"GET",headers:{"Content-Type":"application/json",chainid:o.toString(),service:"evmetadata"}}),a=await t.json();return e(a)}}function O(){let{query:e}=(0,p.useRouter)(),{account:t,chainId:n}=(0,S.Ge)(),[j,C]=(0,w.useState)({loaded:!1}),[T,N]=(0,w.useState)(!1),[k,E]=(0,w.useState)(!1),[H,_]=(0,w.useState)(!1),[I,z]=(0,w.useState)(null),[O,P]=(0,w.useState)(e.address),[A,F]=(0,w.useState)(e.experimental),[G,W]=(0,w.useState)(null),[V,L]=(0,w.useState)(null),[M,D]=(0,w.useState)(0),[K,R]=(0,w.useState)(0),[X,$]=(0,w.useState)(null),[B,U]=(0,w.useState)(0),[Y,J]=(0,w.useState)(!1),[Q,ee]=(0,w.useState)(!0),et=(0,v.cq)(Z.q7.vaultHandler[n],Z.q7.vaultHandlerAbi,!0),en=(0,v.cq)(Z.q7.coval[n],Z.q7.covalAbi,!0),ea=async()=>{_(!0),et.transferToChain(M,B.toString()).then(e=>{let{hash:t}=e;$(t)}).catch(e=>{(null==e?void 0:e.code)==4001&&_(!1)})},es=async()=>{$(null),W(await en.decimals()),L(await en.allowance(t,Z.q7.vaultHandler[n]).then(e=>e.toString())),z(await en.balanceOf(t).then(e=>e.toString())),Number(V)>=Number(0)&&R(V),C({loaded:!0})},el=async()=>{console.log("getting logs"),fetch(Z.HP+"/web3/transfersOut",{method:"GET",headers:{"Content-Type":"application/json",service:"evmetadata",chainid:n.toString()}}).then(async function(e){console.log("getting logs"),fetch(Z.HP+"/web3/bridgeLogs?chainId="+n.toString(),{method:"GET",headers:{"Content-Type":"application/json",service:"evmetadata"}}).then(async function(e){console.log("trnsfer log",e),fetch(Z.HP+"/web3/bridgeTransfer",{method:"GET",headers:{"Content-Type":"application/json",service:"evmetadata"}}).then(async function(e){console.log("bridge transfer",e),es()})})})};function er(e){let{children:t,...n}=e;return(0,a.jsx)(s.x,{fontSize:"2xl",lineHeight:1,py:"0.3rem",...n,children:t})}let[ei,ec]=(0,w.useState)("");(0,w.useEffect)(()=>{t&&ei!=t&&(ec(t),C({loaded:!1}),es())},[t,ei]);let[eo,eh]=(0,w.useState)(n);return(0,w.useEffect)(()=>{n&&eo!=n&&(eh(n),C({loaded:!1}),es())},[n,eo]),(0,w.useEffect)(()=>{t&&n&&C({loaded:!0})},[]),(0,a.jsxs)(m(),{loaded:j.loaded,children:[T?(0,a.jsx)(g.Z,{}):"",(0,a.jsx)(l.k,{w:"100%",justify:"center",mt:10,children:(0,a.jsxs)(r.K,{align:"center",children:[(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r.K,{direction:"row",align:"flex-start",spacing:"1rem",flexWrap:"wrap",shouldWrapChildren:!0,children:[(0,a.jsx)(er,{children:"I want to transfer "}),(0,a.jsx)(er,{children:"$Coval"})]}),(0,a.jsxs)(r.K,{direction:"row",align:"flex-start",spacing:"1rem",flexWrap:"wrap",shouldWrapChildren:!0,children:[(0,a.jsx)(er,{children:(0,a.jsxs)(l.k,{width:"full",align:"center",justifyContent:"center",flexWrap:"wrap",children:[(0,a.jsxs)(s.x,{float:"left",children:["from ",137==n?"Polygon (Matic)":100==n?"xDai":56==n?"Binance Smart Chain":250==n?"Fantom":"Ethereum"," to"]}),(0,a.jsx)(i.E,{float:"left",margin:2,w:3,src:"./next.png"})]})}),0!=M&&B>0?(0,a.jsx)(c.z,{isDisabled:Y,onClick:ea,children:Y?"Invalid Transfer Amount":"Transfer Now"}):null]})]}),0==V&&I>0&&!k?(0,a.jsx)(o.xu,{mt:"2",ml:"4",lineHeight:"tight",children:(0,a.jsx)(s.x,{mt:2,as:"h4",ml:"4",mr:"4",fontSize:"s",fontStyle:"italic",children:(0,a.jsx)(c.z,{onClick:()=>{E(!0),en.approve(Z.q7.vaultHandler[n],1e7*Math.pow(10,+G)).then(e=>{let{hash:t}=e;$(t)}).catch(e=>{(null==e?void 0:e.code)==4001&&E(!1)})},type:"submit",children:"Approve Transfer"})})}):0==I?(0,a.jsx)(o.xu,{mt:"2",ml:"4",lineHeight:"tight",children:(0,a.jsx)(s.x,{mt:2,as:"h4",ml:"4",mr:"4",fontSize:"s",fontStyle:"italic",children:"You have no Coval to transfer"})}):k?null:(0,a.jsx)(o.xu,{mt:"2",ml:"4",lineHeight:"tight",children:(0,a.jsxs)(s.x,{mt:2,as:"h4",ml:"4",mr:"4",fontSize:"s",fontStyle:"italic",children:["Approved to transfer up to ",V*Math.pow(10,-G)," Coval. Note: Swaps between networks can take up to 25 minutes."]})}),(0,a.jsxs)(h.m,{children:[(0,a.jsxs)(d.t,{className:"TabList",children:[(0,a.jsxs)(u.O,{className:"Tab",children:["From ",b.zh[n]]}),M>0?(0,a.jsxs)(u.O,{className:"Tab",children:["From ",b.zh[M]]}):null]}),(0,a.jsxs)(x.n,{children:[(0,a.jsx)(f.x,{children:(0,a.jsx)(q,{chainId:n})}),(0,a.jsx)(f.x,{children:M&&Q?(0,a.jsx)(q,{chainId:M}):null})]})]})]})}),X?(0,a.jsx)(y.Z,{hash:X,onComplete:()=>{H?(_(!1),el()):(E(!1),es())}}):null]})}var P=n(51704);function A(){return(0,a.jsx)(w.Suspense,{fallback:(0,a.jsx)("h1",{children:"Loading vaults..."}),children:(0,a.jsx)(P.Z,{fallback:(0,a.jsx)("h2",{children:"Oops! Something went wrong."}),children:(0,a.jsx)(O,{})})})}}},function(e){e.O(0,[758,6377,8585,8703,9774,2888,179],function(){return e(e.s=96629)}),_N_E=e.O()}]);