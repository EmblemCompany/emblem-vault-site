graph LR
  subgraph User
    U((User))
  end
  subgraph Metamask
    M((Metamask))
  end
  subgraph Claimed_Contract
    C((Claimed_Contract))
  end
  subgraph Database
    D((Database))
  end
  subgraph Serverless
    S((Serverless))
  end
  subgraph Web3Auth
    W((Web3Auth))
  end
  subgraph Signer
    SI((Signer))
  end

  U -- 1: Signature Request <--> M
  U -- 2: Get Keys --> S
  S -- 3: Get Vault Data <--> D
  S -- 4: Claimed and By User from Signature? <--> C
  S -- 5: Get Auth JWT <--> SI
  S -- 6: Give JWT to user --> U
  U -- 7: Request Auth with JWT <--> W
  U -- 8: Get Keys from cluster <--> web3Auth_Cluster
