graph LR
  subgraph User
    U((User))
  end
  subgraph Database
    D((Database))
  end
  subgraph Metamask
    M((Metamask))
  end
  subgraph Serverless
    S((Serverless))
  end
  subgraph Web3Auth
    W((Web3Auth))
  end
  subgraph Signer
    SI((Signer))
  end
  subgraph EmblemVault_Contract
    E((EmblemVault_Contract))
  end
    subgraph Claimed_Contract
    C((Claimed_Contract))
  end

  U -- 1: Sign Request <--> M
  U -- 2: Create Vault Request <--> S 
  S -- 3: ID Minted Before? <--> E <--> ownerOf
  S -- 4: ID Claimed Before? <--> C <--> claimedBy
  S -- 5: web3Auth Signature <--> SI
  S -- 6: Get vault Encryption Key <--> W
  S -- 7: Store Encrypted Vault data --> D